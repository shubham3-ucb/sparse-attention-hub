{"timestamp": "2025-11-09T21:35:06.726956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:06.966939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:07.033786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:07.084527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.066394805908203e-07, "l2_diff": 0.1181640625, "l2_diff_relative": 0.0027640716374269006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:07.244666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2285599451009596, "overlap_percentage": 0.3720778070494186, "num_intersection": 1638333, "num_union": 7168067, "num_only_computed": 2764867, "num_only_roped": 2764867, "total_diff": 5529734, "diff_percentage": 0.7714400548990404, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:08.943382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5697747067412219, "overlap_percentage": 0.7259318223110465, "num_intersection": 3196423, "num_union": 5609977, "num_only_computed": 1206777, "num_only_roped": 1206777, "total_diff": 2413554, "diff_percentage": 0.43022529325877806, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:09.433693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35096783259436937, "overlap_percentage": 0.5195798510174419, "num_intersection": 2287814, "num_union": 6518586, "num_only_computed": 2115386, "num_only_roped": 2115386, "total_diff": 4230772, "diff_percentage": 0.6490321674056306, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:09.541967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 2.6226043701171875e-06, "l2_diff": 0.58984375, "l2_diff_relative": 0.013797514619883041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:09.714083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18173102072744962, "overlap_percentage": 0.30756748793067934, "num_intersection": 1352787, "num_union": 7443897, "num_only_computed": 3045555, "num_only_roped": 3045555, "total_diff": 6091110, "diff_percentage": 0.8182689792725504, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:11.599167", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5284896235509495, "overlap_percentage": 0.6915187586595131, "num_intersection": 3041536, "num_union": 5755148, "num_only_computed": 1356806, "num_only_roped": 1356806, "total_diff": 2713612, "diff_percentage": 0.4715103764490505, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.149705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2872279340105534, "overlap_percentage": 0.4462736185589934, "num_intersection": 1962864, "num_union": 6833820, "num_only_computed": 2435478, "num_only_roped": 2435478, "total_diff": 4870956, "diff_percentage": 0.7127720659894466, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.275609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 2.473592758178711e-06, "l2_diff": 0.65625, "l2_diff_relative": 0.017736486486486486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "attention_shape": [1, 32, 3162, 11354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.304551", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1714461501523132, "overlap_percentage": 0.2927085468333675, "num_intersection": 11425, "num_union": 66639, "num_only_computed": 27607, "num_only_roped": 27607, "total_diff": 55214, "diff_percentage": 0.8285538498476868, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.380587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.613525970939005, "overlap_percentage": 0.7604785816765731, "num_intersection": 29683, "num_union": 48381, "num_only_computed": 9349, "num_only_roped": 9349, "total_diff": 18698, "diff_percentage": 0.38647402906099504, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.398610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.329608938547486, "overlap_percentage": 0.4957983193277311, "num_intersection": 19352, "num_union": 58712, "num_only_computed": 19680, "num_only_roped": 19680, "total_diff": 39360, "diff_percentage": 0.6703910614525139, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.404532", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.867813110351562e-06, "l2_diff": 0.057861328125, "l2_diff_relative": 0.02023565573770492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "attention_shape": [1, 32, 28, 11382]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.414479", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16995383969785985, "overlap_percentage": 0.29053084648493543, "num_intersection": 405, "num_union": 2383, "num_only_computed": 989, "num_only_roped": 989, "total_diff": 1978, "diff_percentage": 0.8300461603021402, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.460254", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5636567582725743, "overlap_percentage": 0.7209469153515065, "num_intersection": 1005, "num_union": 1783, "num_only_computed": 389, "num_only_roped": 389, "total_diff": 778, "diff_percentage": 0.43634324172742567, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.474389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3314231136580707, "overlap_percentage": 0.49784791965566716, "num_intersection": 694, "num_union": 2094, "num_only_computed": 700, "num_only_roped": 700, "total_diff": 1400, "diff_percentage": 0.6685768863419294, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.477453", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.5299530029296875e-06, "l2_diff": 0.01507568359375, "l2_diff_relative": 0.028587962962962964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "attention_shape": [1, 32, 1, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.483834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1679932970255551, "overlap_percentage": 0.28766140602582496, "num_intersection": 401, "num_union": 2387, "num_only_computed": 993, "num_only_roped": 993, "total_diff": 1986, "diff_percentage": 0.8320067029744449, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.530385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6979293544457978, "overlap_percentage": 0.8220946915351507, "num_intersection": 1146, "num_union": 1642, "num_only_computed": 248, "num_only_roped": 248, "total_diff": 496, "diff_percentage": 0.3020706455542022, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.545799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3953953953953954, "overlap_percentage": 0.5667144906743186, "num_intersection": 790, "num_union": 1998, "num_only_computed": 604, "num_only_roped": 604, "total_diff": 1208, "diff_percentage": 0.6046046046046046, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.549955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.2665987014770508e-06, "l2_diff": 0.00341796875, "l2_diff_relative": 0.00625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.555731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17537942664418213, "overlap_percentage": 0.2984218077474892, "num_intersection": 416, "num_union": 2372, "num_only_computed": 978, "num_only_roped": 978, "total_diff": 1956, "diff_percentage": 0.8246205733558178, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.602959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5310269082921472, "overlap_percentage": 0.693687230989957, "num_intersection": 967, "num_union": 1821, "num_only_computed": 427, "num_only_roped": 427, "total_diff": 854, "diff_percentage": 0.46897309170785284, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.618284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.328884652049571, "overlap_percentage": 0.4949784791965567, "num_intersection": 690, "num_union": 2098, "num_only_computed": 704, "num_only_roped": 704, "total_diff": 1408, "diff_percentage": 0.6711153479504289, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.622454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.259148120880127e-06, "l2_diff": 0.00341796875, "l2_diff_relative": 0.0062056737588652485}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.628296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18185671894870709, "overlap_percentage": 0.30774748923959827, "num_intersection": 429, "num_union": 2359, "num_only_computed": 965, "num_only_roped": 965, "total_diff": 1930, "diff_percentage": 0.818143281051293, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.675731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6516587677725119, "overlap_percentage": 0.7890961262553802, "num_intersection": 1100, "num_union": 1688, "num_only_computed": 294, "num_only_roped": 294, "total_diff": 588, "diff_percentage": 0.34834123222748814, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.690986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32007575757575757, "overlap_percentage": 0.48493543758967, "num_intersection": 676, "num_union": 2112, "num_only_computed": 718, "num_only_roped": 718, "total_diff": 1436, "diff_percentage": 0.6799242424242424, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:12.694972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 6.705522537231445e-06, "l2_diff": 0.0218505859375, "l2_diff_relative": 0.041744402985074626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:13.834129", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:14.073728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:14.145756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:14.187252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.140900611877441e-07, "l2_diff": 0.11767578125, "l2_diff_relative": 0.002768841911764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:17.106933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23432062818263583, "overlap_percentage": 0.3796754632994186, "num_intersection": 1671787, "num_union": 7134613, "num_only_computed": 2731413, "num_only_roped": 2731413, "total_diff": 5462826, "diff_percentage": 0.7656793718173641, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:18.823360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6357165119623286, "overlap_percentage": 0.7772942405523255, "num_intersection": 3422582, "num_union": 5383818, "num_only_computed": 980618, "num_only_roped": 980618, "total_diff": 1961236, "diff_percentage": 0.3642834880376714, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:19.314661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3437374926777568, "overlap_percentage": 0.5116140534156977, "num_intersection": 2252739, "num_union": 6553661, "num_only_computed": 2150461, "num_only_roped": 2150461, "total_diff": 4300922, "diff_percentage": 0.6562625073222432, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:19.423325", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.11434268951416e-06, "l2_diff": 0.64453125, "l2_diff_relative": 0.0152551775147929}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:19.644361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17801493472477584, "overlap_percentage": 0.30222865513392855, "num_intersection": 1837086, "num_union": 10319842, "num_only_computed": 4241378, "num_only_roped": 4241378, "total_diff": 8482756, "diff_percentage": 0.8219850652752242, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:22.775050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5237587190173284, "overlap_percentage": 0.6874562389445755, "num_intersection": 4178678, "num_union": 7978250, "num_only_computed": 1899786, "num_only_roped": 1899786, "total_diff": 3799572, "diff_percentage": 0.47624128098267166, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:24.126853", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26924901608344415, "overlap_percentage": 0.4242650774932615, "num_intersection": 2578880, "num_union": 9578048, "num_only_computed": 3499584, "num_only_roped": 3499584, "total_diff": 6999168, "diff_percentage": 0.7307509839165559, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:24.939847", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 2.086162567138672e-06, "l2_diff": 0.69140625, "l2_diff_relative": 0.0163646449704142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:25.463908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15096812353851818, "overlap_percentage": 0.26233241468822643, "num_intersection": 1971442, "num_union": 13058664, "num_only_computed": 5543611, "num_only_roped": 5543611, "total_diff": 11087222, "diff_percentage": 0.8490318764614818, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:29.239001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5015944462777154, "overlap_percentage": 0.6680824473227268, "num_intersection": 5020675, "num_union": 10009431, "num_only_computed": 2494378, "num_only_roped": 2494378, "total_diff": 4988756, "diff_percentage": 0.4984055537222845, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:32.782640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2481612795697121, "overlap_percentage": 0.39764297071491045, "num_intersection": 2988308, "num_union": 12041798, "num_only_computed": 4526745, "num_only_roped": 4526745, "total_diff": 9053490, "diff_percentage": 0.7518387204302879, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:33.893393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 1.5795230865478516e-06, "l2_diff": 0.640625, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "attention_shape": [1, 32, 3991, 16279]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:33.950743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13948969589401822, "overlap_percentage": 0.24482835851284765, "num_intersection": 24049, "num_union": 172407, "num_only_computed": 74179, "num_only_roped": 74179, "total_diff": 148358, "diff_percentage": 0.8605103041059817, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.069526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6107703912629956, "overlap_percentage": 0.7583581056317954, "num_intersection": 74492, "num_union": 121964, "num_only_computed": 23736, "num_only_roped": 23736, "total_diff": 47472, "diff_percentage": 0.38922960873700435, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.094268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2815133724722766, "overlap_percentage": 0.4393451968888708, "num_intersection": 43156, "num_union": 153300, "num_only_computed": 55072, "num_only_roped": 55072, "total_diff": 110144, "diff_percentage": 0.7184866275277234, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.099621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 4.1425228118896484e-06, "l2_diff": 0.091796875, "l2_diff_relative": 0.0235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "attention_shape": [1, 32, 52, 16331]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.105471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1321546299071022, "overlap_percentage": 0.23345685547908945, "num_intersection": 441, "num_union": 3337, "num_only_computed": 1448, "num_only_roped": 1448, "total_diff": 2896, "diff_percentage": 0.8678453700928979, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.157991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7211845102505695, "overlap_percentage": 0.838009528851244, "num_intersection": 1583, "num_union": 2195, "num_only_computed": 306, "num_only_roped": 306, "total_diff": 612, "diff_percentage": 0.27881548974943055, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.173809", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34688057040998216, "overlap_percentage": 0.5150873478030704, "num_intersection": 973, "num_union": 2805, "num_only_computed": 916, "num_only_roped": 916, "total_diff": 1832, "diff_percentage": 0.6531194295900178, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.179385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.8461217880249023e-06, "l2_diff": 0.01220703125, "l2_diff_relative": 0.023148148148148147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "attention_shape": [1, 32, 1, 16332]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.185467", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1362406015037594, "overlap_percentage": 0.23980942297511912, "num_intersection": 453, "num_union": 3325, "num_only_computed": 1436, "num_only_roped": 1436, "total_diff": 2872, "diff_percentage": 0.8637593984962406, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.235444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7580269892973476, "overlap_percentage": 0.8623610375860243, "num_intersection": 1629, "num_union": 2149, "num_only_computed": 260, "num_only_roped": 260, "total_diff": 520, "diff_percentage": 0.2419730107026524, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.251556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42190440346255176, "overlap_percentage": 0.5934356802541026, "num_intersection": 1121, "num_union": 2657, "num_only_computed": 768, "num_only_roped": 768, "total_diff": 1536, "diff_percentage": 0.5780955965374482, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.256128", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0155029296875, "l2_diff_relative": 0.031127450980392157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "attention_shape": [1, 32, 1, 16333]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.262325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14589020321504398, "overlap_percentage": 0.25463208046585495, "num_intersection": 481, "num_union": 3297, "num_only_computed": 1408, "num_only_roped": 1408, "total_diff": 2816, "diff_percentage": 0.854109796784956, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.312113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7490740740740741, "overlap_percentage": 0.8565378507146638, "num_intersection": 1618, "num_union": 2160, "num_only_computed": 271, "num_only_roped": 271, "total_diff": 542, "diff_percentage": 0.25092592592592594, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.329359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34640057020669995, "overlap_percentage": 0.5145579671784013, "num_intersection": 972, "num_union": 2806, "num_only_computed": 917, "num_only_roped": 917, "total_diff": 1834, "diff_percentage": 0.6535994297933001, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.333869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 1.7136335372924805e-06, "l2_diff": 0.006439208984375, "l2_diff_relative": 0.012210648148148148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "attention_shape": [1, 32, 1, 16334]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.339900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15042630937880633, "overlap_percentage": 0.26151402858655376, "num_intersection": 494, "num_union": 3284, "num_only_computed": 1395, "num_only_roped": 1395, "total_diff": 2790, "diff_percentage": 0.8495736906211937, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.389710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7306459001374256, "overlap_percentage": 0.8443620963472737, "num_intersection": 1595, "num_union": 2183, "num_only_computed": 294, "num_only_roped": 294, "total_diff": 588, "diff_percentage": 0.2693540998625744, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.406043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3177537495640042, "overlap_percentage": 0.4822657490735839, "num_intersection": 911, "num_union": 2867, "num_only_computed": 978, "num_only_roped": 978, "total_diff": 1956, "diff_percentage": 0.6822462504359958, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:34.410602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.900859832763672e-06, "l2_diff": 0.02783203125, "l2_diff_relative": 0.05317164179104478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "attention_shape": [1, 32, 1, 16335]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:35.493405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:35.733064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:35.797400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:35.827613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.029141902923584e-07, "l2_diff": 0.1181640625, "l2_diff_relative": 0.0027640716374269006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:35.978661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23472576480538038, "overlap_percentage": 0.38020712209302326, "num_intersection": 1674128, "num_union": 7132272, "num_only_computed": 2729072, "num_only_roped": 2729072, "total_diff": 5458144, "diff_percentage": 0.7652742351946196, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:37.675239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5980903633140413, "overlap_percentage": 0.7485063135901163, "num_intersection": 3295823, "num_union": 5510577, "num_only_computed": 1107377, "num_only_roped": 1107377, "total_diff": 2214754, "diff_percentage": 0.40190963668595864, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:38.166800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33144103727336405, "overlap_percentage": 0.4978681413517442, "num_intersection": 2192213, "num_union": 6614187, "num_only_computed": 2210987, "num_only_roped": 2210987, "total_diff": 4421974, "diff_percentage": 0.668558962726636, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:38.274771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.7120113372802734e-06, "l2_diff": 0.56640625, "l2_diff_relative": 0.013406065088757397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:38.495111", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17502699572127967, "overlap_percentage": 0.2979114460495283, "num_intersection": 1810844, "num_union": 10346084, "num_only_computed": 4267620, "num_only_roped": 4267620, "total_diff": 8535240, "diff_percentage": 0.8249730042787203, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:41.623941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.503641314672915, "overlap_percentage": 0.6698955525606469, "num_intersection": 4071936, "num_union": 8084992, "num_only_computed": 2006528, "num_only_roped": 2006528, "total_diff": 4013056, "diff_percentage": 0.49635868532708505, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:43.021192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2641550694977447, "overlap_percentage": 0.41791561157555596, "num_intersection": 2540285, "num_union": 9616643, "num_only_computed": 3538179, "num_only_roped": 3538179, "total_diff": 7076358, "diff_percentage": 0.7358449305022553, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:45.708641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.8924474716186523e-06, "l2_diff": 0.59375, "l2_diff_relative": 0.013970588235294118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:46.468439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14837370763161395, "overlap_percentage": 0.258406660907654, "num_intersection": 1967099, "num_union": 13257733, "num_only_computed": 5645317, "num_only_roped": 5645317, "total_diff": 11290634, "diff_percentage": 0.851626292368386, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:50.272341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49497799682324717, "overlap_percentage": 0.6621876681463545, "num_intersection": 5040848, "num_union": 10183984, "num_only_computed": 2571568, "num_only_roped": 2571568, "total_diff": 5143136, "diff_percentage": 0.5050220031767528, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:52.119458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2510658417950006, "overlap_percentage": 0.40136311520547485, "num_intersection": 3055343, "num_union": 12169489, "num_only_computed": 4557073, "num_only_roped": 4557073, "total_diff": 9114146, "diff_percentage": 0.7489341582049994, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.271057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 1.3560056686401367e-06, "l2_diff": 0.59765625, "l2_diff_relative": 0.014145710059171597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "attention_shape": [1, 32, 4032, 16320]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.306735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13869931754315537, "overlap_percentage": 0.243610082848581, "num_intersection": 13820, "num_union": 99640, "num_only_computed": 42910, "num_only_roped": 42910, "total_diff": 85820, "diff_percentage": 0.8613006824568447, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.392472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.568600342863463, "overlap_percentage": 0.7249779658029262, "num_intersection": 41128, "num_union": 72332, "num_only_computed": 15602, "num_only_roped": 15602, "total_diff": 31204, "diff_percentage": 0.43139965713653705, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.412283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2713602187286398, "overlap_percentage": 0.4268817204301075, "num_intersection": 24217, "num_union": 89243, "num_only_computed": 32513, "num_only_roped": 32513, "total_diff": 65026, "diff_percentage": 0.7286397812713602, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.415448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.06005859375, "l2_diff_relative": 0.020337301587301588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "attention_shape": [1, 32, 30, 16350]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.421273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1412190706095353, "overlap_percentage": 0.2474881015335801, "num_intersection": 468, "num_union": 3314, "num_only_computed": 1423, "num_only_roped": 1423, "total_diff": 2846, "diff_percentage": 0.8587809293904647, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.471222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6259673258813414, "overlap_percentage": 0.7699629825489159, "num_intersection": 1456, "num_union": 2326, "num_only_computed": 435, "num_only_roped": 435, "total_diff": 870, "diff_percentage": 0.37403267411865865, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.488441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24489795918367346, "overlap_percentage": 0.39344262295081966, "num_intersection": 744, "num_union": 3038, "num_only_computed": 1147, "num_only_roped": 1147, "total_diff": 2294, "diff_percentage": 0.7551020408163265, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:53.492968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 2.250075340270996e-06, "l2_diff": 0.00933837890625, "l2_diff_relative": 0.017708333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "attention_shape": [1, 32, 1, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:54.595005", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:54.837331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:54.905988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:54.936205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.140900611877441e-07, "l2_diff": 0.11767578125, "l2_diff_relative": 0.002768841911764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:55.087218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23957036747805618, "overlap_percentage": 0.3865377452761628, "num_intersection": 1702003, "num_union": 7104397, "num_only_computed": 2701197, "num_only_roped": 2701197, "total_diff": 5402394, "diff_percentage": 0.7604296325219438, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:56.783006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.616752956278237, "overlap_percentage": 0.762952625363372, "num_intersection": 3359433, "num_union": 5446967, "num_only_computed": 1043767, "num_only_roped": 1043767, "total_diff": 2087534, "diff_percentage": 0.38324704372176294, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:57.274414", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34228065164262633, "overlap_percentage": 0.5099986373546511, "num_intersection": 2245626, "num_union": 6560774, "num_only_computed": 2157574, "num_only_roped": 2157574, "total_diff": 4315148, "diff_percentage": 0.6577193483573737, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:57.384560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.60546875, "l2_diff_relative": 0.014246323529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:35:57.617604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18977055505469043, "overlap_percentage": 0.3190036167031671, "num_intersection": 1939052, "num_union": 10217876, "num_only_computed": 4139412, "num_only_roped": 4139412, "total_diff": 8278824, "diff_percentage": 0.8102294449453096, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:02.869524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5162987174808313, "overlap_percentage": 0.6809986865102763, "num_intersection": 4139426, "num_union": 8017502, "num_only_computed": 1939038, "num_only_roped": 1939038, "total_diff": 3878076, "diff_percentage": 0.48370128251916866, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:04.327572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27889125772657086, "overlap_percentage": 0.4361453814647911, "num_intersection": 2651094, "num_union": 9505834, "num_only_computed": 3427370, "num_only_roped": 3427370, "total_diff": 6854740, "diff_percentage": 0.7211087422734291, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:04.788106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 2.205371856689453e-06, "l2_diff": 0.6953125, "l2_diff_relative": 0.016754518072289157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:05.304075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1764150492975918, "overlap_percentage": 0.2999197424462138, "num_intersection": 2301971, "num_union": 13048609, "num_only_computed": 5373319, "num_only_roped": 5373319, "total_diff": 10746638, "diff_percentage": 0.8235849507024082, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:09.458878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5013940430456393, "overlap_percentage": 0.6679046654914668, "num_intersection": 5126362, "num_union": 10224218, "num_only_computed": 2548928, "num_only_roped": 2548928, "total_diff": 5097856, "diff_percentage": 0.4986059569543607, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:11.351288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24980846493007117, "overlap_percentage": 0.3997547975385946, "num_intersection": 3068234, "num_union": 12282346, "num_only_computed": 4607056, "num_only_roped": 4607056, "total_diff": 9214112, "diff_percentage": 0.7501915350699289, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:12.517702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 1.4454126358032227e-06, "l2_diff": 0.62890625, "l2_diff_relative": 0.014973958333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "attention_shape": [1, 32, 4061, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:12.572214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16617508317195492, "overlap_percentage": 0.28499165446060565, "num_intersection": 16733, "num_union": 100695, "num_only_computed": 41981, "num_only_roped": 41981, "total_diff": 83962, "diff_percentage": 0.833824916828045, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:13.303839", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6083383553388484, "overlap_percentage": 0.7564805668154103, "num_intersection": 44416, "num_union": 73012, "num_only_computed": 14298, "num_only_roped": 14298, "total_diff": 28596, "diff_percentage": 0.3916616446611516, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:13.324082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2910276284398122, "overlap_percentage": 0.45084647613857004, "num_intersection": 26471, "num_union": 90957, "num_only_computed": 32243, "num_only_roped": 32243, "total_diff": 64486, "diff_percentage": 0.7089723715601878, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:13.691011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.054443359375, "l2_diff_relative": 0.01796069587628866}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "attention_shape": [1, 32, 31, 16380]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:13.697073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16089488201041985, "overlap_percentage": 0.2771911298838437, "num_intersection": 525, "num_union": 3263, "num_only_computed": 1369, "num_only_roped": 1369, "total_diff": 2738, "diff_percentage": 0.8391051179895801, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:15.577218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.817658349328215, "overlap_percentage": 0.8996832101372756, "num_intersection": 1704, "num_union": 2084, "num_only_computed": 190, "num_only_roped": 190, "total_diff": 380, "diff_percentage": 0.18234165067178504, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:15.592832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3044077134986226, "overlap_percentage": 0.46673706441393875, "num_intersection": 884, "num_union": 2904, "num_only_computed": 1010, "num_only_roped": 1010, "total_diff": 2020, "diff_percentage": 0.6955922865013774, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:36:15.595284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.86102294921875e-06, "l2_diff": 0.0125732421875, "l2_diff_relative": 0.02332427536231884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "attention_shape": [1, 32, 1, 16381]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
