{"timestamp": "2025-11-16T02:50:49.161454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:50:49.209908", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.407499313354492e-06, "l2_diff": 0.022216796875, "l2_diff_relative": 0.0031181469298245616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:50:52.586820", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6884614676025719, "overlap_percentage": 0.8154896997206704, "num_intersection": 149476, "num_union": 217116, "num_only_computed": 33820, "num_only_roped": 33820, "total_diff": 67640, "diff_percentage": 0.3115385323974281, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:50:52.805058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 0.0001678466796875, "l2_diff": 0.609375, "l2_diff_relative": 0.09948979591836735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:01.073731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5616100225582132, "overlap_percentage": 0.7192705149755502, "num_intersection": 150621, "num_union": 268195, "num_only_computed": 58787, "num_only_roped": 58787, "total_diff": 117574, "diff_percentage": 0.43838997744178676, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:01.366475", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.310546875, "l2_diff_relative": 0.045376712328767124}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:11.843171", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4968238886788076, "overlap_percentage": 0.6638374660326087, "num_intersection": 156347, "num_union": 314693, "num_only_computed": 79173, "num_only_roped": 79173, "total_diff": 158346, "diff_percentage": 0.5031761113211924, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:12.205415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.10440340909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:24.922003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4344444170845885, "overlap_percentage": 0.6057319641113281, "num_intersection": 158789, "num_union": 365499, "num_only_computed": 103355, "num_only_roped": 103355, "total_diff": 206710, "diff_percentage": 0.5655555829154115, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:25.361093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 9.1552734375e-05, "l2_diff": 0.75, "l2_diff_relative": 0.12903225806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:40.284170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39607508863015556, "overlap_percentage": 0.5674123001776199, "num_intersection": 163560, "num_union": 412952, "num_only_computed": 124696, "num_only_roped": 124696, "total_diff": 249392, "diff_percentage": 0.6039249113698444, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:40.813903", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 0.00011444091796875, "l2_diff": 1.0546875, "l2_diff_relative": 0.2109375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:58.274932", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3664431047147955, "overlap_percentage": 0.5363459385179153, "num_intersection": 168610, "num_union": 460126, "num_only_computed": 145758, "num_only_roped": 145758, "total_diff": 291516, "diff_percentage": 0.6335568952852045, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:58.890324", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.1514945652173913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:52:19.003607", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34142305570877, "overlap_percentage": 0.509046052631579, "num_intersection": 173320, "num_union": 507640, "num_only_computed": 167160, "num_only_roped": 167160, "total_diff": 334320, "diff_percentage": 0.65857694429123, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:52:21.310996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.814697265625e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.08974358974358974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:52:45.108495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31080670363894464, "overlap_percentage": 0.4742220233938548, "num_intersection": 173846, "num_union": 559338, "num_only_computed": 192746, "num_only_roped": 192746, "total_diff": 385492, "diff_percentage": 0.6891932963610554, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:52:45.892162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.888938903808594e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.14839181286549707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:53:14.602996", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2825278992284597, "overlap_percentage": 0.44057973225911456, "num_intersection": 173243, "num_union": 613189, "num_only_computed": 219973, "num_only_roped": 219973, "total_diff": 439946, "diff_percentage": 0.7174721007715402, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:53:18.169524", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.23776223776223776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:53:45.987824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26838475499092557, "overlap_percentage": 0.42319139194139194, "num_intersection": 177456, "num_union": 661200, "num_only_computed": 241872, "num_only_roped": 241872, "total_diff": 483744, "diff_percentage": 0.7316152450090744, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:53:47.068610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 7.2479248046875e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.26573426573426573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:54:17.573695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25560057785137946, "overlap_percentage": 0.4071367636494253, "num_intersection": 181355, "num_union": 709525, "num_only_computed": 264085, "num_only_roped": 264085, "total_diff": 528170, "diff_percentage": 0.7443994221486205, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:54:18.592530", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.494140625, "l2_diff_relative": 0.07751225490196079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:54:51.595203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2497618028509449, "overlap_percentage": 0.39969504953854507, "num_intersection": 188477, "num_union": 754627, "num_only_computed": 283075, "num_only_roped": 283075, "total_diff": 566150, "diff_percentage": 0.750238197149055, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:54:52.683110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.8125, "l2_diff_relative": 0.15853658536585366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:55:30.027897", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24261449821784156, "overlap_percentage": 0.39049037101337447, "num_intersection": 194333, "num_union": 800995, "num_only_computed": 303331, "num_only_roped": 303331, "total_diff": 606662, "diff_percentage": 0.7573855017821585, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:55:31.191115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.09414893617021276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:56:10.785293", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22678347466352183, "overlap_percentage": 0.369720458984375, "num_intersection": 193840, "num_union": 854736, "num_only_computed": 330448, "num_only_roped": 330448, "total_diff": 660896, "diff_percentage": 0.7732165253364781, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:56:12.064217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.12042682926829268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:56:53.891737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22033687860707768, "overlap_percentage": 0.36110828488372093, "num_intersection": 198754, "num_union": 902046, "num_only_computed": 351646, "num_only_roped": 351646, "total_diff": 703292, "diff_percentage": 0.7796631213929223, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:56:55.261338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05517578125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.19172297297297297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:57:40.039527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20758511046084174, "overlap_percentage": 0.34380203707815277, "num_intersection": 198206, "num_union": 954818, "num_only_computed": 378306, "num_only_roped": 378306, "total_diff": 756612, "diff_percentage": 0.7924148895391583, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:57:43.822499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.25, "l2_diff_relative": 0.24691358024691357}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:58:31.683350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1879069345691594, "overlap_percentage": 0.31636642417162275, "num_intersection": 190650, "num_union": 1014598, "num_only_computed": 411974, "num_only_roped": 411974, "total_diff": 823948, "diff_percentage": 0.8120930654308406, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:58:33.244830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4927007299270073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:59:23.968256", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17742808399392498, "overlap_percentage": 0.3013824562296417, "num_intersection": 189490, "num_union": 1067982, "num_only_computed": 439246, "num_only_roped": 439246, "total_diff": 878492, "diff_percentage": 0.822571916006075, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:59:25.680822", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 0.0001010894775390625, "l2_diff": 2.953125, "l2_diff_relative": 0.984375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:00:19.785175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1675097513679528, "overlap_percentage": 0.28695220947265626, "num_intersection": 188057, "num_union": 1122663, "num_only_computed": 467303, "num_only_roped": 467303, "total_diff": 934606, "diff_percentage": 0.8324902486320472, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:00:21.548662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 0.00010061264038085938, "l2_diff": 3.015625, "l2_diff_relative": 1.0157894736842106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:01:18.805947", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16082666519037744, "overlap_percentage": 0.2770898877723516, "num_intersection": 188829, "num_union": 1174115, "num_only_computed": 492643, "num_only_roped": 492643, "total_diff": 985286, "diff_percentage": 0.8391733348096225, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:01:20.661978", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.5394736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:02:20.577566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1555476441466416, "overlap_percentage": 0.2692189195911722, "num_intersection": 190495, "num_union": 1224673, "num_only_computed": 517089, "num_only_roped": 517089, "total_diff": 1034178, "diff_percentage": 0.8444523558533584, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:02:24.580708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.5113636363636364}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:03:22.199509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1519481099853804, "overlap_percentage": 0.2638106849922412, "num_intersection": 23801, "num_union": 156639, "num_only_computed": 66419, "num_only_roped": 66419, "total_diff": 132838, "diff_percentage": 0.8480518900146196, "num_computed": 90220, "num_roped": 90220}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:03:23.891804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.33406113537117904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:04:15.995199", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15160923108765395, "overlap_percentage": 0.2632997843278217, "num_intersection": 10255, "num_union": 67641, "num_only_computed": 28693, "num_only_roped": 28693, "total_diff": 57386, "diff_percentage": 0.8483907689123461, "num_computed": 38948, "num_roped": 38948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:04:18.474611", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.29833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:05:05.821620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1373671300081766, "overlap_percentage": 0.2415528396836808, "num_intersection": 336, "num_union": 2446, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.8626328699918234, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:05:07.185358", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.12059859154929578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:05:48.815494", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13969684555510037, "overlap_percentage": 0.24514737598849748, "num_intersection": 341, "num_union": 2441, "num_only_computed": 1050, "num_only_roped": 1050, "total_diff": 2100, "diff_percentage": 0.8603031544448996, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:05:50.120494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.060546875, "l2_diff_relative": 0.27074235807860264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:06:32.014944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14898885678910442, "overlap_percentage": 0.2593390804597701, "num_intersection": 361, "num_union": 2423, "num_only_computed": 1031, "num_only_roped": 1031, "total_diff": 2062, "diff_percentage": 0.8510111432108955, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:06:33.333491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.0947265625, "l2_diff_relative": 0.35144927536231885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:07:14.895530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1423881821912187, "overlap_percentage": 0.2492816091954023, "num_intersection": 347, "num_union": 2437, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8576118178087813, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:07:16.633637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.06494140625, "l2_diff_relative": 0.46830985915492956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:07:59.925560", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14662273476112025, "overlap_percentage": 0.2557471264367816, "num_intersection": 356, "num_union": 2428, "num_only_computed": 1036, "num_only_roped": 1036, "total_diff": 2072, "diff_percentage": 0.8533772652388797, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "mask_shape": [1, 32, 1, 11362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:01.579728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.11485042735042734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "attention_shape": [1, 32, 1, 11362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:47:39.628775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:47:39.645968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.0218505859375, "l2_diff_relative": 0.0030269209956709955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:48:02.510272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6877229974540884, "overlap_percentage": 0.8149714123603352, "num_intersection": 149381, "num_union": 217211, "num_only_computed": 33915, "num_only_roped": 33915, "total_diff": 67830, "diff_percentage": 0.31227700254591156, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:48:05.898104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 8.440017700195312e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.05476190476190476}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:48:49.880583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5737980895692888, "overlap_percentage": 0.7291889517114915, "num_intersection": 152698, "num_union": 266118, "num_only_computed": 56710, "num_only_roped": 56710, "total_diff": 113420, "diff_percentage": 0.4262019104307112, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:48:51.282165", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 0.00010538101196289062, "l2_diff": 0.6328125, "l2_diff_relative": 0.0916289592760181}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:49:37.785038", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49585895025659266, "overlap_percentage": 0.6629755434782608, "num_intersection": 156144, "num_union": 314896, "num_only_computed": 79376, "num_only_roped": 79376, "total_diff": 158752, "diff_percentage": 0.5041410497434073, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:49:39.313866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.1076555023923445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:50:27.778936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43477023447249163, "overlap_percentage": 0.606048583984375, "num_intersection": 158872, "num_union": 365416, "num_only_computed": 103272, "num_only_roped": 103272, "total_diff": 206544, "diff_percentage": 0.5652297655275084, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:50:29.703833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.12169312169312169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:31.142972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39271599331316975, "overlap_percentage": 0.5639570381882771, "num_intersection": 162564, "num_union": 413948, "num_only_computed": 125692, "num_only_roped": 125692, "total_diff": 251384, "diff_percentage": 0.6072840066868302, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:51:33.301921", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.875, "l2_diff_relative": 0.14659685863874344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:52:34.288379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.349827175336525, "overlap_percentage": 0.5183288375407166, "num_intersection": 162946, "num_union": 465790, "num_only_computed": 151422, "num_only_roped": 151422, "total_diff": 302844, "diff_percentage": 0.6501728246634749, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:52:37.213943", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.1453804347826087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:53:33.784706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3232262189067294, "overlap_percentage": 0.48854264567669176, "num_intersection": 166339, "num_union": 514621, "num_only_computed": 174141, "num_only_roped": 174141, "total_diff": 348282, "diff_percentage": 0.6767737810932706, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:53:35.567356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 5.7697296142578125e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.13353658536585367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:54:35.440675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3001168570248095, "overlap_percentage": 0.4616767414455307, "num_intersection": 169247, "num_union": 563937, "num_only_computed": 197345, "num_only_roped": 197345, "total_diff": 394690, "diff_percentage": 0.6998831429751905, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:54:37.483244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.9114227294921875e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.1356951871657754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:55:41.094702", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2790340628171433, "overlap_percentage": 0.4363199869791667, "num_intersection": 171568, "num_union": 614864, "num_only_computed": 221648, "num_only_roped": 221648, "total_diff": 443296, "diff_percentage": 0.7209659371828567, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:55:43.134011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.24561403508771928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:56:48.635605", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26026318597183007, "overlap_percentage": 0.41302989545177043, "num_intersection": 173195, "num_union": 665461, "num_only_computed": 246133, "num_only_roped": 246133, "total_diff": 492266, "diff_percentage": 0.7397368140281699, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:56:50.662646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08544921875, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.22699386503067484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:57:57.155768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.248845258304678, "overlap_percentage": 0.3985205639367816, "num_intersection": 177517, "num_union": 713363, "num_only_computed": 267923, "num_only_roped": 267923, "total_diff": 535846, "diff_percentage": 0.751154741695322, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:58:00.198282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.1859903381642512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:59:10.707184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25067499827603584, "overlap_percentage": 0.4008635314875136, "num_intersection": 189028, "num_union": 754076, "num_only_computed": 282524, "num_only_roped": 282524, "total_diff": 565048, "diff_percentage": 0.7493250017239642, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T02:59:12.908935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.17081447963800905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:00:29.809615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23327633633187123, "overlap_percentage": 0.37830343364197533, "num_intersection": 188268, "num_union": 807060, "num_only_computed": 309396, "num_only_roped": 309396, "total_diff": 618792, "diff_percentage": 0.7667236636681287, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:00:35.139504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.875, "l2_diff_relative": 0.14659685863874344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:01:54.498780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21658378794804978, "overlap_percentage": 0.3560523986816406, "num_intersection": 186674, "num_union": 861902, "num_only_computed": 337614, "num_only_roped": 337614, "total_diff": 675228, "diff_percentage": 0.7834162120519502, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:01:59.290691", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1853448275862069}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:03:25.805960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20806665437529082, "overlap_percentage": 0.3444622093023256, "num_intersection": 189592, "num_union": 911208, "num_only_computed": 360808, "num_only_roped": 360808, "total_diff": 721616, "diff_percentage": 0.7919333456247092, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:03:28.677694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1868421052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:04:53.511731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20250591593480113, "overlap_percentage": 0.336806519205151, "num_intersection": 194173, "num_union": 958851, "num_only_computed": 382339, "num_only_roped": 382339, "total_diff": 764678, "diff_percentage": 0.7974940840651988, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:04:58.795095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 5.340576171875e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.33093525179856115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:06:27.374337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19222650214358775, "overlap_percentage": 0.3224664135514019, "num_intersection": 194326, "num_union": 1010922, "num_only_computed": 408298, "num_only_roped": 408298, "total_diff": 816596, "diff_percentage": 0.8077734978564123, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:06:30.388425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.677078247070312e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.5708661417322834}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:07:54.373953", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18706665751355805, "overlap_percentage": 0.3151746472357159, "num_intersection": 8175, "num_union": 43701, "num_only_computed": 17763, "num_only_roped": 17763, "total_diff": 35526, "diff_percentage": 0.812933342486442, "num_computed": 25938, "num_roped": 25938}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "mask_shape": [1, 32, 22, 9238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:07:56.958063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.2294921875, "l2_diff_relative": 0.18710191082802546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "attention_shape": [1, 32, 22, 9238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:17.873710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18560302222682226, "overlap_percentage": 0.313094718463553, "num_intersection": 21519, "num_union": 115941, "num_only_computed": 47211, "num_only_roped": 47211, "total_diff": 94422, "diff_percentage": 0.8143969777731778, "num_computed": 68730, "num_roped": 68730}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "mask_shape": [1, 32, 58, 9296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:20.403002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.5487804878048781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "attention_shape": [1, 32, 58, 9296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:37.900469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1975745325922183, "overlap_percentage": 0.329957805907173, "num_intersection": 391, "num_union": 1979, "num_only_computed": 794, "num_only_roped": 794, "total_diff": 1588, "diff_percentage": 0.8024254674077818, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "mask_shape": [1, 32, 1, 9297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:40.150223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.000141143798828125, "l2_diff": 0.1259765625, "l2_diff_relative": 2.023529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "attention_shape": [1, 32, 1, 9297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:11:50.226466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20795107033639143, "overlap_percentage": 0.34430379746835443, "num_intersection": 408, "num_union": 1962, "num_only_computed": 777, "num_only_roped": 777, "total_diff": 1554, "diff_percentage": 0.7920489296636085, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "mask_shape": [1, 32, 1, 9298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:11:52.383519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 0.000110626220703125, "l2_diff": 0.08447265625, "l2_diff_relative": 1.0484848484848486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "attention_shape": [1, 32, 1, 9298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:28.496735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:28.509133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.0228271484375, "l2_diff_relative": 0.003121661324786325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:31.815020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6793114031672156, "overlap_percentage": 0.809035658170391, "num_intersection": 148293, "num_union": 218299, "num_only_computed": 35003, "num_only_roped": 35003, "total_diff": 70006, "diff_percentage": 0.3206885968327844, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:32.038034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 0.00017642974853515625, "l2_diff": 0.58203125, "l2_diff_relative": 0.10891812865497076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:39.881128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5643573232134587, "overlap_percentage": 0.7215197127139364, "num_intersection": 151092, "num_union": 267724, "num_only_computed": 58316, "num_only_roped": 58316, "total_diff": 116632, "diff_percentage": 0.43564267678654134, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:42.213679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 0.00011014938354492188, "l2_diff": 0.62890625, "l2_diff_relative": 0.10536649214659685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:52.437583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4866997437159919, "overlap_percentage": 0.6547384510869565, "num_intersection": 154204, "num_union": 316836, "num_only_computed": 81316, "num_only_roped": 81316, "total_diff": 162632, "diff_percentage": 0.5133002562840081, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:08:52.810573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.462890625, "l2_diff_relative": 0.06468340611353712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:08.104235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4278190062500851, "overlap_percentage": 0.5992622375488281, "num_intersection": 157093, "num_union": 367195, "num_only_computed": 105051, "num_only_roped": 105051, "total_diff": 210102, "diff_percentage": 0.5721809937499149, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:10.389070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.07906976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:25.382376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3758382534735315, "overlap_percentage": 0.5463407526642984, "num_intersection": 157486, "num_union": 419026, "num_only_computed": 130770, "num_only_roped": 130770, "total_diff": 261540, "diff_percentage": 0.6241617465264685, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:25.903285", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.671875, "l2_diff_relative": 0.10696517412935323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:43.908748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34453608996991164, "overlap_percentage": 0.5124980914087948, "num_intersection": 161113, "num_union": 467623, "num_only_computed": 153255, "num_only_roped": 153255, "total_diff": 306510, "diff_percentage": 0.6554639100300883, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:09:44.529217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.14778645833333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:04.725613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3195364880052707, "overlap_percentage": 0.48431625939849626, "num_intersection": 164900, "num_union": 516060, "num_only_computed": 175580, "num_only_roped": 175580, "total_diff": 351160, "diff_percentage": 0.6804635119947293, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:06.873298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.1846590909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:29.811711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30484861859574436, "overlap_percentage": 0.4672551501396648, "num_intersection": 171292, "num_union": 561892, "num_only_computed": 195300, "num_only_roped": 195300, "total_diff": 390600, "diff_percentage": 0.6951513814042556, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:30.590193", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 6.961822509765625e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.18072289156626506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:57.513880", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29290378583124543, "overlap_percentage": 0.453094482421875, "num_intersection": 178164, "num_union": 608268, "num_only_computed": 215052, "num_only_roped": 215052, "total_diff": 430104, "diff_percentage": 0.7070962141687546, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:10:58.346964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.1842485549132948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:11:28.284788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27666998016468036, "overlap_percentage": 0.4334244314713065, "num_intersection": 181747, "num_union": 656909, "num_only_computed": 237581, "num_only_roped": 237581, "total_diff": 475162, "diff_percentage": 0.7233300198353196, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:11:30.415933", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.16214285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:12:01.166288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2587388874131763, "overlap_percentage": 0.41110811781609197, "num_intersection": 183124, "num_union": 707756, "num_only_computed": 262316, "num_only_roped": 262316, "total_diff": 524632, "diff_percentage": 0.7412611125868237, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:12:02.200318", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 5.936622619628906e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.2134502923976608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:12:35.376224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24638251926525725, "overlap_percentage": 0.3953561855320304, "num_intersection": 186431, "num_union": 756673, "num_only_computed": 285121, "num_only_roped": 285121, "total_diff": 570242, "diff_percentage": 0.7536174807347428, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:12:36.454712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.887580871582031e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.19219653179190752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:13.804627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22938737396756229, "overlap_percentage": 0.3731734664351852, "num_intersection": 185715, "num_union": 809613, "num_only_computed": 311949, "num_only_roped": 311949, "total_diff": 623898, "diff_percentage": 0.7706126260324377, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:14.996554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.1994219653179191}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:54.014963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21866508606162036, "overlap_percentage": 0.3588600158691406, "num_intersection": 188146, "num_union": 860430, "num_only_computed": 336142, "num_only_roped": 336142, "total_diff": 672284, "diff_percentage": 0.7813349139383796, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:55.297956", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.18235294117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:14:38.158728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21054165360781663, "overlap_percentage": 0.3478470203488372, "num_intersection": 191455, "num_union": 909345, "num_only_computed": 358945, "num_only_roped": 358945, "total_diff": 717890, "diff_percentage": 0.7894583463921834, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:14:39.531672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.1541005291005291}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:15:24.278090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20234290356117587, "overlap_percentage": 0.33658102519982236, "num_intersection": 194043, "num_union": 958981, "num_only_computed": 382469, "num_only_roped": 382469, "total_diff": 764938, "diff_percentage": 0.7976570964388241, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:15:27.430250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.2514367816091954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:16:15.443902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1897350447514854, "overlap_percentage": 0.31895344360662703, "num_intersection": 192209, "num_union": 1013039, "num_only_computed": 410415, "num_only_roped": 410415, "total_diff": 820830, "diff_percentage": 0.8102649552485146, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:16:17.051588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.8671875, "l2_diff_relative": 0.3956953642384106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:17:08.001146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1722898990642914, "overlap_percentage": 0.29393736003664495, "num_intersection": 184809, "num_union": 1072663, "num_only_computed": 443927, "num_only_roped": 443927, "total_diff": 887854, "diff_percentage": 0.8277101009357086, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:17:09.674247", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.5763358778625954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:18:03.530599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16516212191923907, "overlap_percentage": 0.28350067138671875, "num_intersection": 185795, "num_union": 1124925, "num_only_computed": 469565, "num_only_roped": 469565, "total_diff": 939130, "diff_percentage": 0.8348378780807609, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:18:05.418713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5463576158940397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:19:03.625691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1619538677688205, "overlap_percentage": 0.27876126972201354, "num_intersection": 189968, "num_union": 1172976, "num_only_computed": 491504, "num_only_roped": 491504, "total_diff": 983008, "diff_percentage": 0.8380461322311795, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:19:05.545585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.5859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:20:05.641223", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17153063209612862, "overlap_percentage": 0.29283166380246023, "num_intersection": 207203, "num_union": 1207965, "num_only_computed": 500381, "num_only_roped": 500381, "total_diff": 1000762, "diff_percentage": 0.8284693679038714, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:20:09.965712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 8.392333984375e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.9052631578947369}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:21:12.789175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15514844454800655, "overlap_percentage": 0.26862079117236565, "num_intersection": 197086, "num_union": 1270306, "num_only_computed": 536610, "num_only_roped": 536610, "total_diff": 1073220, "diff_percentage": 0.8448515554519934, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:21:14.949861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.7258883248730964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:22:23.713608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14730688475032597, "overlap_percentage": 0.25678724098719674, "num_intersection": 195109, "num_union": 1324507, "num_only_computed": 564699, "num_only_roped": 564699, "total_diff": 1129398, "diff_percentage": 0.8526931152496741, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:22:25.939072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.5434782608695652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:23:38.109893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1429742427050065, "overlap_percentage": 0.2501792907714844, "num_intersection": 196749, "num_union": 1376115, "num_only_computed": 589683, "num_only_roped": 589683, "total_diff": 1179366, "diff_percentage": 0.8570257572949935, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:23:41.354194", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.5211267605633803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:24:55.770698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14243855595150137, "overlap_percentage": 0.24935880395400126, "num_intersection": 202615, "num_union": 1422473, "num_only_computed": 609929, "num_only_roped": 609929, "total_diff": 1219858, "diff_percentage": 0.8575614440484987, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:24:58.213762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.690677966101695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:26:17.663880", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14242979654637627, "overlap_percentage": 0.2493453811813187, "num_intersection": 209115, "num_union": 1468197, "num_only_computed": 629541, "num_only_roped": 629541, "total_diff": 1259082, "diff_percentage": 0.8575702034536238, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:26:20.238203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.7711442786069652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:27:40.076702", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14254458110213125, "overlap_percentage": 0.24952125888099466, "num_intersection": 215778, "num_union": 1513758, "num_only_computed": 648990, "num_only_roped": 648990, "total_diff": 1297980, "diff_percentage": 0.8574554188978687, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:27:42.730682", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.92}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:29:05.391942", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13808591853733068, "overlap_percentage": 0.24266343390804598, "num_intersection": 216184, "num_union": 1565576, "num_only_computed": 674696, "num_only_roped": 674696, "total_diff": 1349392, "diff_percentage": 0.8619140814626693, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:29:08.118971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.515625, "l2_diff_relative": 1.0125786163522013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:30:33.936744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13618705953594237, "overlap_percentage": 0.23972647530691965, "num_intersection": 219950, "num_union": 1615058, "num_only_computed": 697554, "num_only_roped": 697554, "total_diff": 1395108, "diff_percentage": 0.8638129404640577, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:30:38.738487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 6.723403930664062e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.8571428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:32:09.869252", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13125500520301342, "overlap_percentage": 0.23205202116115028, "num_intersection": 218968, "num_union": 1668264, "num_only_computed": 724648, "num_only_roped": 724648, "total_diff": 1449296, "diff_percentage": 0.8687449947969865, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:32:12.874097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.8046511627906977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:33:44.965909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1328815210784843, "overlap_percentage": 0.23459032318222178, "num_intersection": 168563, "num_union": 1268521, "num_only_computed": 549979, "num_only_roped": 549979, "total_diff": 1099958, "diff_percentage": 0.8671184789215157, "num_computed": 718542, "num_roped": 718542}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 382, "seq_len_k": 16254, "queries_shape": [1, 32, 382, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 382, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:33:48.084482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.8715083798882681}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 382, "seq_len_k": 16254, "queries_shape": [1, 32, 382, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 382, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:35:16.783557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.126798106530631, "overlap_percentage": 0.22505914022350926, "num_intersection": 22072, "num_union": 174072, "num_only_computed": 76000, "num_only_roped": 76000, "total_diff": 152000, "diff_percentage": 0.873201893469369, "num_computed": 98072, "num_roped": 98072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:35:19.379245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.484375, "l2_diff_relative": 0.38271604938271603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:36:29.422750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13682941531042797, "overlap_percentage": 0.24072110286320256, "num_intersection": 454, "num_union": 3318, "num_only_computed": 1432, "num_only_roped": 1432, "total_diff": 2864, "diff_percentage": 0.8631705846895721, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:36:31.294356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.032958984375, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.602510460251046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:37:30.438479", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14511232544019428, "overlap_percentage": 0.25344644750795337, "num_intersection": 478, "num_union": 3294, "num_only_computed": 1408, "num_only_roped": 1408, "total_diff": 2816, "diff_percentage": 0.8548876745598057, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:37:33.199428", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0169677734375, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.38306451612903225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:38:34.897940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1310344827586207, "overlap_percentage": 0.23170731707317074, "num_intersection": 437, "num_union": 3335, "num_only_computed": 1449, "num_only_roped": 1449, "total_diff": 2898, "diff_percentage": 0.8689655172413793, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:38:36.834581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.24338624338624337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:12:39.670437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:12:39.686158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.022705078125, "l2_diff_relative": 0.0031727620087336245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:00.477759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.690236435395227, "overlap_percentage": 0.8167335893854749, "num_intersection": 149704, "num_union": 216888, "num_only_computed": 33592, "num_only_roped": 33592, "total_diff": 67184, "diff_percentage": 0.30976356460477295, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:01.791161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 0.00020599365234375, "l2_diff": 0.7265625, "l2_diff_relative": 0.13839285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:45.149378", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.578614882437638, "overlap_percentage": 0.7330665495110025, "num_intersection": 153510, "num_union": 265306, "num_only_computed": 55898, "num_only_roped": 55898, "total_diff": 111796, "diff_percentage": 0.42138511756236197, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:13:49.268258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00017833709716796875, "l2_diff": 0.90234375, "l2_diff_relative": 0.17085798816568049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:14:36.382622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4875871238319011, "overlap_percentage": 0.6555409307065218, "num_intersection": 154393, "num_union": 316647, "num_only_computed": 81127, "num_only_roped": 81127, "total_diff": 162254, "diff_percentage": 0.5124128761680988, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:14:37.867977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 0.00018405914306640625, "l2_diff": 1.171875, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:15:25.195465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4325708992641614, "overlap_percentage": 0.6039085388183594, "num_intersection": 158311, "num_union": 365977, "num_only_computed": 103833, "num_only_roped": 103833, "total_diff": 207666, "diff_percentage": 0.5674291007358386, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:15:29.099154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 0.0001430511474609375, "l2_diff": 1.0703125, "l2_diff_relative": 0.23299319727891157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:16:19.935581", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38975818951905483, "overlap_percentage": 0.5609007271314387, "num_intersection": 161683, "num_union": 414829, "num_only_computed": 126573, "num_only_roped": 126573, "total_diff": 253146, "diff_percentage": 0.6102418104809452, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:16:23.414047", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08056640625, "mean_diff": 0.00011873245239257812, "l2_diff": 1.125, "l2_diff_relative": 0.23684210526315788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:17:16.679259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3603939658828315, "overlap_percentage": 0.5298376425081434, "num_intersection": 166564, "num_union": 462172, "num_only_computed": 147804, "num_only_roped": 147804, "total_diff": 295608, "diff_percentage": 0.6396060341171685, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:17:20.965366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.1901840490797546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:18:17.303214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3290473430177978, "overlap_percentage": 0.4951627114661654, "num_intersection": 168593, "num_union": 512367, "num_only_computed": 171887, "num_only_roped": 171887, "total_diff": 343774, "diff_percentage": 0.6709526569822022, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:18:19.130210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 9.870529174804688e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.24647887323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:19:18.133104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30573166735528357, "overlap_percentage": 0.4682917248603352, "num_intersection": 171672, "num_union": 561512, "num_only_computed": 194920, "num_only_roped": 194920, "total_diff": 389840, "diff_percentage": 0.6942683326447164, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:19:20.121931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.2395104895104895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:20:21.249688", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28659421416079484, "overlap_percentage": 0.44550832112630206, "num_intersection": 175181, "num_union": 611251, "num_only_computed": 218035, "num_only_roped": 218035, "total_diff": 436070, "diff_percentage": 0.7134057858392052, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:20:24.167664", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.19912790697674418}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:21:28.525139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2716272891856731, "overlap_percentage": 0.4272121108058608, "num_intersection": 179142, "num_union": 659514, "num_only_computed": 240186, "num_only_roped": 240186, "total_diff": 480372, "diff_percentage": 0.7283727108143269, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:21:32.965988", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.482421875, "l2_diff_relative": 0.08435792349726776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:22:42.169242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25301340384534243, "overlap_percentage": 0.40384788074712646, "num_intersection": 179890, "num_union": 710990, "num_only_computed": 265550, "num_only_roped": 265550, "total_diff": 531100, "diff_percentage": 0.7469865961546576, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:22:45.530888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.12888198757763975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:23:56.461066", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23754261374819902, "overlap_percentage": 0.38389403501628666, "num_intersection": 181026, "num_union": 762078, "num_only_computed": 290526, "num_only_roped": 290526, "total_diff": 581052, "diff_percentage": 0.762457386251801, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:23:58.641273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.20993589743589744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:25:10.860248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.238230424056798, "overlap_percentage": 0.38479174704218105, "num_intersection": 191497, "num_union": 803831, "num_only_computed": 306167, "num_only_roped": 306167, "total_diff": 612334, "diff_percentage": 0.7617695759432019, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:25:13.157963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.8515625, "l2_diff_relative": 0.16029411764705884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:26:29.983505", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2374228068167201, "overlap_percentage": 0.38373756408691406, "num_intersection": 201189, "num_union": 847387, "num_only_computed": 323099, "num_only_roped": 323099, "total_diff": 646198, "diff_percentage": 0.7625771931832799, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:26:32.543473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.11381578947368422}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:27:50.411975", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23196483170160664, "overlap_percentage": 0.3765770348837209, "num_intersection": 207268, "num_union": 893532, "num_only_computed": 343132, "num_only_roped": 343132, "total_diff": 686264, "diff_percentage": 0.7680351682983934, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:27:53.997608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:29:15.416488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21176554663886565, "overlap_percentage": 0.34951570825932504, "num_intersection": 201500, "num_union": 951524, "num_only_computed": 375012, "num_only_roped": 375012, "total_diff": 750024, "diff_percentage": 0.7882344533611344, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:29:18.060572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 5.340576171875e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.3125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:30:25.425221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19280938374629364, "overlap_percentage": 0.3232861618521665, "num_intersection": 194820, "num_union": 1010428, "num_only_computed": 407804, "num_only_roped": 407804, "total_diff": 815608, "diff_percentage": 0.8071906162537064, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:30:27.101445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 7.724761962890625e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.5633187772925764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:31:18.440338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1716541889316978, "overlap_percentage": 0.29301169330211724, "num_intersection": 184227, "num_union": 1073245, "num_only_computed": 444509, "num_only_roped": 444509, "total_diff": 889018, "diff_percentage": 0.8283458110683022, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:31:21.842187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 9.059906005859375e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.8342245989304813}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:32:15.732436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16308497214566248, "overlap_percentage": 0.2804351806640625, "num_intersection": 183786, "num_union": 1126934, "num_only_computed": 471574, "num_only_roped": 471574, "total_diff": 943148, "diff_percentage": 0.8369150278543375, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:32:17.885700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 9.5367431640625e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.9532163742690059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:33:14.907809", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1553868416122505, "overlap_percentage": 0.2689780357813674, "num_intersection": 183301, "num_union": 1179643, "num_only_computed": 498171, "num_only_roped": 498171, "total_diff": 996342, "diff_percentage": 0.8446131583877495, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:33:16.838716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 8.20159912109375e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.7428571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:34:17.222282", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15351315134170665, "overlap_percentage": 0.2661662784913169, "num_intersection": 188335, "num_union": 1226833, "num_only_computed": 519249, "num_only_roped": 519249, "total_diff": 1038498, "diff_percentage": 0.8464868486582934, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:34:21.310346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.6}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:35:24.355259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1529556336733395, "overlap_percentage": 0.2653278742149337, "num_intersection": 194670, "num_union": 1272722, "num_only_computed": 539026, "num_only_roped": 539026, "total_diff": 1078052, "diff_percentage": 0.8470443663266605, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:35:26.454333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.7090909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:36:33.844279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14749921655836923, "overlap_percentage": 0.2570794200640162, "num_intersection": 195331, "num_union": 1324285, "num_only_computed": 564477, "num_only_roped": 564477, "total_diff": 1128954, "diff_percentage": 0.8525007834416307, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:36:36.070059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4963235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:37:47.796202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14654356112378275, "overlap_percentage": 0.2556266784667969, "num_intersection": 201033, "num_union": 1371831, "num_only_computed": 585399, "num_only_roped": 585399, "total_diff": 1170798, "diff_percentage": 0.8534564388762172, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:37:51.058954", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 7.295608520507812e-05, "l2_diff": 2.25, "l2_diff_relative": 0.7384615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:07.011959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14159829155895245, "overlap_percentage": 0.24807025834908633, "num_intersection": 201568, "num_union": 1423520, "num_only_computed": 610976, "num_only_roped": 610976, "total_diff": 1221952, "diff_percentage": 0.8584017084410476, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:09.482866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.7823834196891192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:26.820029", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1391377577354595, "overlap_percentage": 0.24428609584859584, "num_intersection": 204872, "num_union": 1472440, "num_only_computed": 633784, "num_only_roped": 633784, "total_diff": 1267568, "diff_percentage": 0.8608622422645404, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:29.406147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 6.723403930664062e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.6859903381642513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:41:49.340344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13599468238131582, "overlap_percentage": 0.23942837847838958, "num_intersection": 207050, "num_union": 1522486, "num_only_computed": 657718, "num_only_roped": 657718, "total_diff": 1315436, "diff_percentage": 0.8640053176186842, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:41:52.051526", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.7473118279569892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:43:16.643232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13319218462708693, "overlap_percentage": 0.23507430854885059, "num_intersection": 209423, "num_union": 1572337, "num_only_computed": 681457, "num_only_roped": 681457, "total_diff": 1362914, "diff_percentage": 0.8668078153729131, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:43:19.520601", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.8068181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:44:48.161498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13000131165792947, "overlap_percentage": 0.2300905500139509, "num_intersection": 211109, "num_union": 1623899, "num_only_computed": 706395, "num_only_roped": 706395, "total_diff": 1412790, "diff_percentage": 0.8699986883420705, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:44:51.103235", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.8961748633879781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:46:20.907455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1276845691722845, "overlap_percentage": 0.22645440518176885, "num_intersection": 213686, "num_union": 1673546, "num_only_computed": 729930, "num_only_roped": 729930, "total_diff": 1459860, "diff_percentage": 0.8723154308277156, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:46:24.205522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.8920454545454546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:47:57.188068", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12900534633687796, "overlap_percentage": 0.22852920361350484, "num_intersection": 175664, "num_union": 1361680, "num_only_computed": 593008, "num_only_roped": 593008, "total_diff": 1186016, "diff_percentage": 0.870994653663122, "num_computed": 768672, "num_roped": 768672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 408, "seq_len_k": 16280, "queries_shape": [1, 32, 408, 128], "keys_shape": [1, 8, 16280, 128], "mask_shape": [1, 32, 408, 16280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:48:02.080464", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1826171875, "mean_diff": 6.723403930664062e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.930635838150289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 408, "seq_len_k": 16280, "queries_shape": [1, 32, 408, 128], "keys_shape": [1, 8, 16280, 128], "attention_shape": [1, 32, 408, 16280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:49:29.527251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13019390581717452, "overlap_percentage": 0.23039215686274508, "num_intersection": 13912, "num_union": 106856, "num_only_computed": 46472, "num_only_roped": 46472, "total_diff": 92944, "diff_percentage": 0.8698060941828255, "num_computed": 60384, "num_roped": 60384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "mask_shape": [1, 32, 32, 16312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:49:32.050446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.43097014925373134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "attention_shape": [1, 32, 32, 16312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:50:42.466684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14294367050272563, "overlap_percentage": 0.25013248542660305, "num_intersection": 472, "num_union": 3302, "num_only_computed": 1415, "num_only_roped": 1415, "total_diff": 2830, "diff_percentage": 0.8570563294972744, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "mask_shape": [1, 32, 1, 16313], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:50:44.397949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.3541666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "attention_shape": [1, 32, 1, 16313]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:51:44.261893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1357207342762564, "overlap_percentage": 0.2390037095919449, "num_intersection": 451, "num_union": 3323, "num_only_computed": 1436, "num_only_roped": 1436, "total_diff": 2872, "diff_percentage": 0.8642792657237436, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "mask_shape": [1, 32, 1, 16314], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:51:48.535492", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.053466796875, "l2_diff_relative": 0.3093220338983051}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "attention_shape": [1, 32, 1, 16314]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:22.284119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:22.297704", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.02294921875, "l2_diff_relative": 0.003034607438016529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:25.655642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6858059947208196, "overlap_percentage": 0.8136238652234636, "num_intersection": 149134, "num_union": 217458, "num_only_computed": 34162, "num_only_roped": 34162, "total_diff": 68324, "diff_percentage": 0.31419400527918034, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:28.664015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 0.0001049041748046875, "l2_diff": 0.404296875, "l2_diff_relative": 0.06501256281407035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:36.639504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5761138311123822, "overlap_percentage": 0.7310561201100244, "num_intersection": 153089, "num_union": 265727, "num_only_computed": 56319, "num_only_roped": 56319, "total_diff": 112638, "diff_percentage": 0.42388616888761776, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:36.936219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 0.00011777877807617188, "l2_diff": 0.6328125, "l2_diff_relative": 0.11312849162011174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:47.553911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5055406221733558, "overlap_percentage": 0.6715735394021739, "num_intersection": 158169, "num_union": 312871, "num_only_computed": 77351, "num_only_roped": 77351, "total_diff": 154702, "diff_percentage": 0.49445937782664423, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:52:47.926144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.09068627450980392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:01.081125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4440251849485229, "overlap_percentage": 0.6149826049804688, "num_intersection": 161214, "num_union": 363074, "num_only_computed": 100930, "num_only_roped": 100930, "total_diff": 201860, "diff_percentage": 0.5559748150514771, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:01.531328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.10140306122448979}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:17.500265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40543439573673457, "overlap_percentage": 0.5769524311722913, "num_intersection": 166310, "num_union": 410202, "num_only_computed": 121946, "num_only_roped": 121946, "total_diff": 243892, "diff_percentage": 0.5945656042632654, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:18.030999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 9.202957153320312e-05, "l2_diff": 0.94921875, "l2_diff_relative": 0.1696927374301676}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:36.392440", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36553201008615804, "overlap_percentage": 0.5353693760179153, "num_intersection": 168303, "num_union": 460433, "num_only_computed": 146065, "num_only_roped": 146065, "total_diff": 292130, "diff_percentage": 0.634467989913842, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:39.234298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.000102996826171875, "l2_diff": 1.1328125, "l2_diff_relative": 0.21706586826347304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:00.058909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.336712279827022, "overlap_percentage": 0.5037917058270677, "num_intersection": 171531, "num_union": 509429, "num_only_computed": 168949, "num_only_roped": 168949, "total_diff": 337898, "diff_percentage": 0.663287720172978, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:00.744145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.09316037735849056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:23.685131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3046303644574776, "overlap_percentage": 0.4669987342877095, "num_intersection": 171198, "num_union": 561986, "num_only_computed": 195394, "num_only_roped": 195394, "total_diff": 390788, "diff_percentage": 0.6953696355425224, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:24.498794", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.18859649122807018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:50.329614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2797271415111687, "overlap_percentage": 0.43716684977213544, "num_intersection": 171901, "num_union": 614531, "num_only_computed": 221315, "num_only_roped": 221315, "total_diff": 442630, "diff_percentage": 0.7202728584888313, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:51.198055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.25833333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:55:19.561113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2638965078637868, "overlap_percentage": 0.41759195665445664, "num_intersection": 175108, "num_union": 663548, "num_only_computed": 244220, "num_only_roped": 244220, "total_diff": 488440, "diff_percentage": 0.7361034921362132, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:55:20.525775", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.15328947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:55:51.602470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2488102463893869, "overlap_percentage": 0.39847566451149424, "num_intersection": 177497, "num_union": 713383, "num_only_computed": 267943, "num_only_roped": 267943, "total_diff": 535886, "diff_percentage": 0.7511897536106131, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:55:52.645044", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.22633136094674555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:56:26.328946", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23424353664042716, "overlap_percentage": 0.3795742569218241, "num_intersection": 178989, "num_union": 764115, "num_only_computed": 292563, "num_only_roped": 292563, "total_diff": 585126, "diff_percentage": 0.7657564633595728, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:56:28.115102", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 5.745887756347656e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.2469325153374233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:57:04.470063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2350760159030332, "overlap_percentage": 0.3806664737654321, "num_intersection": 189444, "num_union": 805884, "num_only_computed": 308220, "num_only_roped": 308220, "total_diff": 616440, "diff_percentage": 0.7649239840969668, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:57:05.681166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1878453038674033}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:57:45.362858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23158019607543748, "overlap_percentage": 0.3760700225830078, "num_intersection": 197169, "num_union": 851407, "num_only_computed": 327119, "num_only_roped": 327119, "total_diff": 654238, "diff_percentage": 0.7684198039245626, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:57:46.696821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.1424731182795699}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:58:28.825946", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22302957580605737, "overlap_percentage": 0.3647165697674419, "num_intersection": 200740, "num_union": 900060, "num_only_computed": 349660, "num_only_roped": 349660, "total_diff": 699320, "diff_percentage": 0.7769704241939426, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:58:30.250490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.875, "l2_diff_relative": 0.1696969696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:59:15.578507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21833015108881368, "overlap_percentage": 0.3584088449156306, "num_intersection": 206627, "num_union": 946397, "num_only_computed": 369885, "num_only_roped": 369885, "total_diff": 739770, "diff_percentage": 0.7816698489111863, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:59:16.977997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.2353896103896104}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:00:03.053962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20175929277307975, "overlap_percentage": 0.33577321845794394, "num_intersection": 202345, "num_union": 1002903, "num_only_computed": 400279, "num_only_roped": 400279, "total_diff": 800558, "diff_percentage": 0.7982407072269202, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:00:04.530442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.103515625e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.3977272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:00:54.124644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16935568472438794, "overlap_percentage": 0.28965640982761265, "num_intersection": 166279, "num_union": 981833, "num_only_computed": 407777, "num_only_roped": 407777, "total_diff": 815554, "diff_percentage": 0.830644315275612, "num_computed": 574056, "num_roped": 574056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "mask_shape": [1, 32, 469, 9685], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:00:55.776594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.0, "l2_diff_relative": 0.5311203319502075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "attention_shape": [1, 32, 469, 9685]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:01:43.417374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1567856581223463, "overlap_percentage": 0.27107123436650354, "num_intersection": 7976, "num_union": 50872, "num_only_computed": 21448, "num_only_roped": 21448, "total_diff": 42896, "diff_percentage": 0.8432143418776538, "num_computed": 29424, "num_roped": 29424}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "mask_shape": [1, 32, 24, 9709], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:01:44.791891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.234375, "l2_diff_relative": 0.2054794520547945}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "attention_shape": [1, 32, 24, 9709]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:02:23.954944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15591144606688648, "overlap_percentage": 0.2697636511817441, "num_intersection": 331, "num_union": 2123, "num_only_computed": 896, "num_only_roped": 896, "total_diff": 1792, "diff_percentage": 0.8440885539331136, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 1, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:02:25.104585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.21033653846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 1, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:00.743105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.162482235907153, "overlap_percentage": 0.2795436022819886, "num_intersection": 343, "num_union": 2111, "num_only_computed": 884, "num_only_roped": 884, "total_diff": 1768, "diff_percentage": 0.837517764092847, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "mask_shape": [1, 32, 1, 9711], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:01.890688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.021484375, "l2_diff_relative": 0.09401709401709402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "attention_shape": [1, 32, 1, 9711]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:20.962691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:20.972986", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.0031412760416666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:24.263035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6820776360466183, "overlap_percentage": 0.8109942388268156, "num_intersection": 148652, "num_union": 217940, "num_only_computed": 34644, "num_only_roped": 34644, "total_diff": 69288, "diff_percentage": 0.31792236395338164, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:24.481530", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.0001735687255859375, "l2_diff": 0.640625, "l2_diff_relative": 0.10789473684210527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:32.879102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5763807860524989, "overlap_percentage": 0.7312710116136919, "num_intersection": 153134, "num_union": 265682, "num_only_computed": 56274, "num_only_roped": 56274, "total_diff": 112548, "diff_percentage": 0.4236192139475011, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:33.172057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.0891990291262136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:43.281105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5002420567177109, "overlap_percentage": 0.6668817934782608, "num_intersection": 157064, "num_union": 313976, "num_only_computed": 78456, "num_only_roped": 78456, "total_diff": 156912, "diff_percentage": 0.4997579432822891, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:43.648905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 7.200241088867188e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.09478021978021978}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:56.091899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4359294590012626, "overlap_percentage": 0.6071739196777344, "num_intersection": 159167, "num_union": 365121, "num_only_computed": 102977, "num_only_roped": 102977, "total_diff": 205954, "diff_percentage": 0.5640705409987374, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:03:57.022904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 9.5367431640625e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.14794303797468356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:11.847569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39464650740852736, "overlap_percentage": 0.5659448545737122, "num_intersection": 163137, "num_union": 413375, "num_only_computed": 125119, "num_only_roped": 125119, "total_diff": 250238, "diff_percentage": 0.6053534925914726, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:12.377249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 9.489059448242188e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.1737012987012987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:27.234655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.405452946350044, "overlap_percentage": 0.5769712140175219, "num_intersection": 5532, "num_union": 13644, "num_only_computed": 4056, "num_only_roped": 4056, "total_diff": 8112, "diff_percentage": 0.594547053649956, "num_computed": 9588, "num_roped": 9588}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "mask_shape": [1, 32, 17, 3089], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:27.670397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.12060546875, "l2_diff_relative": 0.1072048611111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "attention_shape": [1, 32, 17, 3089]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:41.625475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39193654990085924, "overlap_percentage": 0.5631528964862298, "num_intersection": 8302, "num_union": 21182, "num_only_computed": 6440, "num_only_roped": 6440, "total_diff": 12880, "diff_percentage": 0.6080634500991408, "num_computed": 14742, "num_roped": 14742}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "mask_shape": [1, 32, 26, 3115], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:42.087673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 9.34600830078125e-05, "l2_diff": 0.181640625, "l2_diff_relative": 0.15604026845637584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "attention_shape": [1, 32, 26, 3115]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:55.545196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37122128174123337, "overlap_percentage": 0.5414462081128748, "num_intersection": 307, "num_union": 827, "num_only_computed": 260, "num_only_roped": 260, "total_diff": 520, "diff_percentage": 0.6287787182587666, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "mask_shape": [1, 32, 1, 3116], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:55.956822", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 9.632110595703125e-05, "l2_diff": 0.04345703125, "l2_diff_relative": 0.1831275720164609}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "attention_shape": [1, 32, 1, 3116]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:05:08.603186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34360189573459715, "overlap_percentage": 0.5114638447971781, "num_intersection": 290, "num_union": 844, "num_only_computed": 277, "num_only_roped": 277, "total_diff": 554, "diff_percentage": 0.6563981042654028, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "mask_shape": [1, 32, 1, 3117], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:05:09.014130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 8.916854858398438e-05, "l2_diff": 0.038330078125, "l2_diff_relative": 0.1551383399209486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "attention_shape": [1, 32, 1, 3117]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:13.298817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:13.311396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.0234375, "l2_diff_relative": 0.0031779661016949155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:16.570797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6761939599003224, "overlap_percentage": 0.8068206616620112, "num_intersection": 147887, "num_union": 218705, "num_only_computed": 35409, "num_only_roped": 35409, "total_diff": 70818, "diff_percentage": 0.32380604009967767, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:16.791587", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 0.00014972686767578125, "l2_diff": 0.5390625, "l2_diff_relative": 0.09636871508379888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:24.616292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5594702174163977, "overlap_percentage": 0.717513180012225, "num_intersection": 150253, "num_union": 268563, "num_only_computed": 59155, "num_only_roped": 59155, "total_diff": 118310, "diff_percentage": 0.44052978258360237, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:26.865681", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 9.72747802734375e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.10076530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:36.876516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4801547274515534, "overlap_percentage": 0.6487899116847826, "num_intersection": 152803, "num_union": 318237, "num_only_computed": 82717, "num_only_roped": 82717, "total_diff": 165434, "diff_percentage": 0.5198452725484466, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:37.237554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 0.00013637542724609375, "l2_diff": 0.953125, "l2_diff_relative": 0.17329545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:49.642602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42867497785952724, "overlap_percentage": 0.6001014709472656, "num_intersection": 157313, "num_union": 366975, "num_only_computed": 104831, "num_only_roped": 104831, "total_diff": 209662, "diff_percentage": 0.5713250221404728, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:39:50.089894", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 0.00013256072998046875, "l2_diff": 1.1171875, "l2_diff_relative": 0.20784883720930233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:04.908673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39411027871952486, "overlap_percentage": 0.5653932615452931, "num_intersection": 162978, "num_union": 413534, "num_only_computed": 125278, "num_only_roped": 125278, "total_diff": 250556, "diff_percentage": 0.6058897212804751, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:08.152425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 9.34600830078125e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.17613636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:25.966048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3666361634652796, "overlap_percentage": 0.5365527025651465, "num_intersection": 168675, "num_union": 460061, "num_only_computed": 145693, "num_only_roped": 145693, "total_diff": 291386, "diff_percentage": 0.6333638365347204, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:26.573148", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 8.535385131835938e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.18787878787878787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:46.385457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3368513632365875, "overlap_percentage": 0.5039473684210526, "num_intersection": 171584, "num_union": 509376, "num_only_computed": 168896, "num_only_roped": 168896, "total_diff": 337792, "diff_percentage": 0.6631486367634125, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:40:47.077742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.0979381443298969}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:41:11.435774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3241825721344873, "overlap_percentage": 0.4896342527932961, "num_intersection": 179496, "num_union": 553688, "num_only_computed": 187096, "num_only_roped": 187096, "total_diff": 374192, "diff_percentage": 0.6758174278655127, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:41:12.197319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.054206161137440756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:41:37.005643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2932248235125806, "overlap_percentage": 0.45347849527994794, "num_intersection": 178315, "num_union": 608117, "num_only_computed": 214901, "num_only_roped": 214901, "total_diff": 429802, "diff_percentage": 0.7067751764874194, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:41:37.844090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.09605263157894736}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:42:05.238837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26762364400080413, "overlap_percentage": 0.42224463904151405, "num_intersection": 177059, "num_union": 661597, "num_only_computed": 242269, "num_only_roped": 242269, "total_diff": 484538, "diff_percentage": 0.7323763559991959, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:42:06.155364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.16188524590163936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:42:36.452302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24891353718646786, "overlap_percentage": 0.39860811781609196, "num_intersection": 177556, "num_union": 713324, "num_only_computed": 267884, "num_only_roped": 267884, "total_diff": 535768, "diff_percentage": 0.7510864628135321, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:42:37.446390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.13058659217877094}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:43:10.927809", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24567298548151906, "overlap_percentage": 0.39444218241042345, "num_intersection": 186000, "num_union": 757104, "num_only_computed": 285552, "num_only_roped": 285552, "total_diff": 571104, "diff_percentage": 0.7543270145184809, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:43:12.036747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.1424731182795699}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:43:47.798921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23499173014334832, "overlap_percentage": 0.3805559574331276, "num_intersection": 189389, "num_union": 805939, "num_only_computed": 308275, "num_only_roped": 308275, "total_diff": 616550, "diff_percentage": 0.7650082698566517, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:43:51.097919", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.78515625, "l2_diff_relative": 0.14779411764705883}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:44:30.056401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22524248928793858, "overlap_percentage": 0.36767005920410156, "num_intersection": 192765, "num_union": 855811, "num_only_computed": 331523, "num_only_roped": 331523, "total_diff": 663046, "diff_percentage": 0.7747575107120614, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:44:33.898262", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.1270053475935829}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:45:15.170924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21120363361090083, "overlap_percentage": 0.34875, "num_intersection": 191952, "num_union": 908848, "num_only_computed": 358448, "num_only_roped": 358448, "total_diff": 716896, "diff_percentage": 0.7887963663890991, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:45:16.542809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.15606508875739644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:46:01.236495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20588644404771989, "overlap_percentage": 0.3414690414076377, "num_intersection": 196861, "num_union": 956163, "num_only_computed": 379651, "num_only_roped": 379651, "total_diff": 759302, "diff_percentage": 0.7941135559522801, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:46:02.721827", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.2692307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:46:50.377125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18743879298284333, "overlap_percentage": 0.3157026603653356, "num_intersection": 190250, "num_union": 1014998, "num_only_computed": 412374, "num_only_roped": 412374, "total_diff": 824748, "diff_percentage": 0.8125612070171567, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:46:54.154146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4927007299270073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:47:45.278003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1696119220290963, "overlap_percentage": 0.29003111003664495, "num_intersection": 182353, "num_union": 1075119, "num_only_computed": 446383, "num_only_roped": 446383, "total_diff": 892766, "diff_percentage": 0.8303880779709036, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:47:48.178388", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 9.107589721679688e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.7894736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:48:42.268194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1607088300902996, "overlap_percentage": 0.27691497802734377, "num_intersection": 181479, "num_union": 1129241, "num_only_computed": 473881, "num_only_roped": 473881, "total_diff": 947762, "diff_percentage": 0.8392911699097004, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:48:45.608808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 7.867813110351562e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.6790123456790124}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:49:42.600230", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15489439442238503, "overlap_percentage": 0.2682399276859504, "num_intersection": 182798, "num_union": 1180146, "num_only_computed": 498674, "num_only_roped": 498674, "total_diff": 997348, "diff_percentage": 0.8451056055776149, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:49:44.482009", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.344650268554688e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.8325123152709359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:50:44.373454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14689819103353652, "overlap_percentage": 0.256166052369754, "num_intersection": 181259, "num_union": 1233909, "num_only_computed": 526325, "num_only_roped": 526325, "total_diff": 1052650, "diff_percentage": 0.8531018089664635, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:50:46.359259", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.5735294117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:51:51.704929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14899151445486813, "overlap_percentage": 0.25934310668178645, "num_intersection": 190279, "num_union": 1277113, "num_only_computed": 543417, "num_only_roped": 543417, "total_diff": 1086834, "diff_percentage": 0.8510084855451319, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:51:53.822059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.6666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:00.945505", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14158133944333848, "overlap_percentage": 0.24804424275606468, "num_intersection": 188466, "num_union": 1331150, "num_only_computed": 571342, "num_only_roped": 571342, "total_diff": 1142684, "diff_percentage": 0.8584186605566615, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:53:03.176169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.7695652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:12.650863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1381243853922527, "overlap_percentage": 0.24272282918294272, "num_intersection": 190885, "num_union": 1381979, "num_only_computed": 595547, "num_only_roped": 595547, "total_diff": 1191094, "diff_percentage": 0.8618756146077473, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:54:14.935033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.724761962890625e-05, "l2_diff": 3.25, "l2_diff_relative": 0.8188976377952756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:55:27.190558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13640689695200706, "overlap_percentage": 0.24006699944864524, "num_intersection": 195065, "num_union": 1430023, "num_only_computed": 617479, "num_only_roped": 617479, "total_diff": 1234958, "diff_percentage": 0.863593103047993, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:55:31.120783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 7.200241088867188e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.7423076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:56:48.373509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13936912293048018, "overlap_percentage": 0.24464261866605616, "num_intersection": 205171, "num_union": 1472141, "num_only_computed": 633485, "num_only_roped": 633485, "total_diff": 1266970, "diff_percentage": 0.8606308770695198, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:56:51.009731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.7195121951219512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:58:14.628282", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13471946211677363, "overlap_percentage": 0.23744981312907046, "num_intersection": 205339, "num_union": 1524197, "num_only_computed": 659429, "num_only_roped": 659429, "total_diff": 1318858, "diff_percentage": 0.8652805378832263, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:58:19.374488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.9365079365079365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:59:44.041716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1340706846521492, "overlap_percentage": 0.23644149604885056, "num_intersection": 210641, "num_union": 1571119, "num_only_computed": 680239, "num_only_roped": 680239, "total_diff": 1360478, "diff_percentage": 0.8659293153478508, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T03:59:46.889128", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.246566772460938e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.7511111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:01:14.741838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13404894496827457, "overlap_percentage": 0.2364076886858259, "num_intersection": 216905, "num_union": 1618103, "num_only_computed": 700599, "num_only_roped": 700599, "total_diff": 1401198, "diff_percentage": 0.8659510550317254, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:01:17.708835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.103515625e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.806282722513089}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:02:50.389610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12706700595952256, "overlap_percentage": 0.22548261157080846, "num_intersection": 212769, "num_union": 1674463, "num_only_computed": 730847, "num_only_roped": 730847, "total_diff": 1461694, "diff_percentage": 0.8729329940404774, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:02:53.502998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 7.581710815429688e-05, "l2_diff": 3.078125, "l2_diff_relative": 1.2389937106918238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:29.036521", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12682276412193944, "overlap_percentage": 0.22509798019702643, "num_intersection": 179483, "num_union": 1415227, "num_only_computed": 617872, "num_only_roped": 617872, "total_diff": 1235744, "diff_percentage": 0.8731772358780605, "num_computed": 797355, "num_roped": 797355}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 423, "seq_len_k": 16295, "queries_shape": [1, 32, 423, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 423, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:04:32.191994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 5.745887756347656e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.7443946188340808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 423, "seq_len_k": 16295, "queries_shape": [1, 32, 423, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 423, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:05:58.328225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12665970460987616, "overlap_percentage": 0.22484110169491525, "num_intersection": 12735, "num_union": 100545, "num_only_computed": 43905, "num_only_roped": 43905, "total_diff": 87810, "diff_percentage": 0.8733402953901238, "num_computed": 56640, "num_roped": 56640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:06:01.034836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.390625, "l2_diff_relative": 0.352112676056338}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:07:09.523072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1308775082359988, "overlap_percentage": 0.23146186440677965, "num_intersection": 437, "num_union": 3339, "num_only_computed": 1451, "num_only_roped": 1451, "total_diff": 2902, "diff_percentage": 0.8691224917640012, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:07:12.847770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.5703125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:08:11.770259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12750074649148999, "overlap_percentage": 0.22616525423728814, "num_intersection": 427, "num_union": 3349, "num_only_computed": 1461, "num_only_roped": 1461, "total_diff": 2922, "diff_percentage": 0.87249925350851, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "mask_shape": [1, 32, 1, 16327], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T04:08:13.690906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037353515625, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.08349609375, "l2_diff_relative": 0.7668161434977578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "attention_shape": [1, 32, 1, 16327]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
