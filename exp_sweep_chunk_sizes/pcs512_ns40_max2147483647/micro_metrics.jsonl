{"timestamp": "2025-11-16T06:39:18.603869", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:18.650776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.407499313354492e-06, "l2_diff": 0.022216796875, "l2_diff_relative": 0.0031181469298245616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:22.023804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6884614676025719, "overlap_percentage": 0.8154896997206704, "num_intersection": 149476, "num_union": 217116, "num_only_computed": 33820, "num_only_roped": 33820, "total_diff": 67640, "diff_percentage": 0.3115385323974281, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:22.261410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 0.0001678466796875, "l2_diff": 0.609375, "l2_diff_relative": 0.09948979591836735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:30.179723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5616100225582132, "overlap_percentage": 0.7192705149755502, "num_intersection": 150621, "num_union": 268195, "num_only_computed": 58787, "num_only_roped": 58787, "total_diff": 117574, "diff_percentage": 0.43838997744178676, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:30.504407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.310546875, "l2_diff_relative": 0.045376712328767124}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:40.692730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4968238886788076, "overlap_percentage": 0.6638374660326087, "num_intersection": 156347, "num_union": 314693, "num_only_computed": 79173, "num_only_roped": 79173, "total_diff": 158346, "diff_percentage": 0.5031761113211924, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:41.055381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.10440340909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:53.668029", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4344444170845885, "overlap_percentage": 0.6057319641113281, "num_intersection": 158789, "num_union": 365499, "num_only_computed": 103355, "num_only_roped": 103355, "total_diff": 206710, "diff_percentage": 0.5655555829154115, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:39:54.107914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 9.1552734375e-05, "l2_diff": 0.75, "l2_diff_relative": 0.12903225806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:40:09.109566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39607508863015556, "overlap_percentage": 0.5674123001776199, "num_intersection": 163560, "num_union": 412952, "num_only_computed": 124696, "num_only_roped": 124696, "total_diff": 249392, "diff_percentage": 0.6039249113698444, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:40:09.633915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 0.00011444091796875, "l2_diff": 1.0546875, "l2_diff_relative": 0.2109375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:40:27.156732", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3664431047147955, "overlap_percentage": 0.5363459385179153, "num_intersection": 168610, "num_union": 460126, "num_only_computed": 145758, "num_only_roped": 145758, "total_diff": 291516, "diff_percentage": 0.6335568952852045, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:40:27.776030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.1514945652173913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:40:48.478572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34142305570877, "overlap_percentage": 0.509046052631579, "num_intersection": 173320, "num_union": 507640, "num_only_computed": 167160, "num_only_roped": 167160, "total_diff": 334320, "diff_percentage": 0.65857694429123, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:40:50.182812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.814697265625e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.08974358974358974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:41:13.285554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31080670363894464, "overlap_percentage": 0.4742220233938548, "num_intersection": 173846, "num_union": 559338, "num_only_computed": 192746, "num_only_roped": 192746, "total_diff": 385492, "diff_percentage": 0.6891932963610554, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:41:18.461632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.888938903808594e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.14839181286549707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:41:43.833291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2825278992284597, "overlap_percentage": 0.44057973225911456, "num_intersection": 173243, "num_union": 613189, "num_only_computed": 219973, "num_only_roped": 219973, "total_diff": 439946, "diff_percentage": 0.7174721007715402, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:41:48.587528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.23776223776223776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:42:18.446562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26838475499092557, "overlap_percentage": 0.42319139194139194, "num_intersection": 177456, "num_union": 661200, "num_only_computed": 241872, "num_only_roped": 241872, "total_diff": 483744, "diff_percentage": 0.7316152450090744, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:42:19.406627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 7.2479248046875e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.26573426573426573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:42:50.298895", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25560057785137946, "overlap_percentage": 0.4071367636494253, "num_intersection": 181355, "num_union": 709525, "num_only_computed": 264085, "num_only_roped": 264085, "total_diff": 528170, "diff_percentage": 0.7443994221486205, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:42:51.337799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.494140625, "l2_diff_relative": 0.07751225490196079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:43:24.668727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2497618028509449, "overlap_percentage": 0.39969504953854507, "num_intersection": 188477, "num_union": 754627, "num_only_computed": 283075, "num_only_roped": 283075, "total_diff": 566150, "diff_percentage": 0.750238197149055, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:43:27.204174", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.8125, "l2_diff_relative": 0.15853658536585366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:44:03.331750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24261449821784156, "overlap_percentage": 0.39049037101337447, "num_intersection": 194333, "num_union": 800995, "num_only_computed": 303331, "num_only_roped": 303331, "total_diff": 606662, "diff_percentage": 0.7573855017821585, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:44:04.534001", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.09414893617021276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:44:45.266699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22678347466352183, "overlap_percentage": 0.369720458984375, "num_intersection": 193840, "num_union": 854736, "num_only_computed": 330448, "num_only_roped": 330448, "total_diff": 660896, "diff_percentage": 0.7732165253364781, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:44:48.687185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.12042682926829268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:45:29.180696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22033687860707768, "overlap_percentage": 0.36110828488372093, "num_intersection": 198754, "num_union": 902046, "num_only_computed": 351646, "num_only_roped": 351646, "total_diff": 703292, "diff_percentage": 0.7796631213929223, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:45:30.534409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05517578125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.19172297297297297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:46:14.658989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20758511046084174, "overlap_percentage": 0.34380203707815277, "num_intersection": 198206, "num_union": 954818, "num_only_computed": 378306, "num_only_roped": 378306, "total_diff": 756612, "diff_percentage": 0.7924148895391583, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:46:16.104705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.25, "l2_diff_relative": 0.24691358024691357}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:47:02.892257", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1879069345691594, "overlap_percentage": 0.31636642417162275, "num_intersection": 190650, "num_union": 1014598, "num_only_computed": 411974, "num_only_roped": 411974, "total_diff": 823948, "diff_percentage": 0.8120930654308406, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:47:04.923150", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4927007299270073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:47:55.958775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17742808399392498, "overlap_percentage": 0.3013824562296417, "num_intersection": 189490, "num_union": 1067982, "num_only_computed": 439246, "num_only_roped": 439246, "total_diff": 878492, "diff_percentage": 0.822571916006075, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:47:58.561030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 0.0001010894775390625, "l2_diff": 2.953125, "l2_diff_relative": 0.984375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:48:51.664481", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1675097513679528, "overlap_percentage": 0.28695220947265626, "num_intersection": 188057, "num_union": 1122663, "num_only_computed": 467303, "num_only_roped": 467303, "total_diff": 934606, "diff_percentage": 0.8324902486320472, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:48:53.414538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 0.00010061264038085938, "l2_diff": 3.015625, "l2_diff_relative": 1.0157894736842106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:49:49.692298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16082666519037744, "overlap_percentage": 0.2770898877723516, "num_intersection": 188829, "num_union": 1174115, "num_only_computed": 492643, "num_only_roped": 492643, "total_diff": 985286, "diff_percentage": 0.8391733348096225, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:49:51.549067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.5394736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:50:50.810768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1555476441466416, "overlap_percentage": 0.2692189195911722, "num_intersection": 190495, "num_union": 1224673, "num_only_computed": 517089, "num_only_roped": 517089, "total_diff": 1034178, "diff_percentage": 0.8444523558533584, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:50:53.775189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.5113636363636364}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:51:50.802622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1519481099853804, "overlap_percentage": 0.2638106849922412, "num_intersection": 23801, "num_union": 156639, "num_only_computed": 66419, "num_only_roped": 66419, "total_diff": 132838, "diff_percentage": 0.8480518900146196, "num_computed": 90220, "num_roped": 90220}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:51:52.491729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.33406113537117904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:52:43.426021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15160923108765395, "overlap_percentage": 0.2632997843278217, "num_intersection": 10255, "num_union": 67641, "num_only_computed": 28693, "num_only_roped": 28693, "total_diff": 57386, "diff_percentage": 0.8483907689123461, "num_computed": 38948, "num_roped": 38948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:52:44.996277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.29833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:53:29.816060", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1373671300081766, "overlap_percentage": 0.2415528396836808, "num_intersection": 336, "num_union": 2446, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.8626328699918234, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:53:31.097076", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.12059859154929578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:54:11.309876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13969684555510037, "overlap_percentage": 0.24514737598849748, "num_intersection": 341, "num_union": 2441, "num_only_computed": 1050, "num_only_roped": 1050, "total_diff": 2100, "diff_percentage": 0.8603031544448996, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:54:14.076749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.060546875, "l2_diff_relative": 0.27074235807860264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:54:55.160719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14898885678910442, "overlap_percentage": 0.2593390804597701, "num_intersection": 361, "num_union": 2423, "num_only_computed": 1031, "num_only_roped": 1031, "total_diff": 2062, "diff_percentage": 0.8510111432108955, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:54:56.667750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.0947265625, "l2_diff_relative": 0.35144927536231885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:55:37.625711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1423881821912187, "overlap_percentage": 0.2492816091954023, "num_intersection": 347, "num_union": 2437, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8576118178087813, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:55:38.947946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.06494140625, "l2_diff_relative": 0.46830985915492956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:56:20.042966", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14662273476112025, "overlap_percentage": 0.2557471264367816, "num_intersection": 356, "num_union": 2428, "num_only_computed": 1036, "num_only_roped": 1036, "total_diff": 2072, "diff_percentage": 0.8533772652388797, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "mask_shape": [1, 32, 1, 11362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:56:21.395835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.11485042735042734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "attention_shape": [1, 32, 1, 11362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:56:48.585283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:56:48.597726", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.0228271484375, "l2_diff_relative": 0.003121661324786325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:56:51.883410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6793114031672156, "overlap_percentage": 0.809035658170391, "num_intersection": 148293, "num_union": 218299, "num_only_computed": 35003, "num_only_roped": 35003, "total_diff": 70006, "diff_percentage": 0.3206885968327844, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:56:52.105310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 0.00017642974853515625, "l2_diff": 0.58203125, "l2_diff_relative": 0.10891812865497076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:00.064367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5643573232134587, "overlap_percentage": 0.7215197127139364, "num_intersection": 151092, "num_union": 267724, "num_only_computed": 58316, "num_only_roped": 58316, "total_diff": 116632, "diff_percentage": 0.43564267678654134, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:00.363145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 0.00011014938354492188, "l2_diff": 0.62890625, "l2_diff_relative": 0.10536649214659685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:10.584692", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4866997437159919, "overlap_percentage": 0.6547384510869565, "num_intersection": 154204, "num_union": 316836, "num_only_computed": 81316, "num_only_roped": 81316, "total_diff": 162632, "diff_percentage": 0.5133002562840081, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:10.939309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.462890625, "l2_diff_relative": 0.06468340611353712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:23.403085", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4278190062500851, "overlap_percentage": 0.5992622375488281, "num_intersection": 157093, "num_union": 367195, "num_only_computed": 105051, "num_only_roped": 105051, "total_diff": 210102, "diff_percentage": 0.5721809937499149, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:24.277161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.07906976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:39.187178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3758382534735315, "overlap_percentage": 0.5463407526642984, "num_intersection": 157486, "num_union": 419026, "num_only_computed": 130770, "num_only_roped": 130770, "total_diff": 261540, "diff_percentage": 0.6241617465264685, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:39.710835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.671875, "l2_diff_relative": 0.10696517412935323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:57.457501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34453608996991164, "overlap_percentage": 0.5124980914087948, "num_intersection": 161113, "num_union": 467623, "num_only_computed": 153255, "num_only_roped": 153255, "total_diff": 306510, "diff_percentage": 0.6554639100300883, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:57:58.066344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.14778645833333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:58:18.034940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3195364880052707, "overlap_percentage": 0.48431625939849626, "num_intersection": 164900, "num_union": 516060, "num_only_computed": 175580, "num_only_roped": 175580, "total_diff": 351160, "diff_percentage": 0.6804635119947293, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:58:18.709644", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.1846590909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:58:41.486182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30484861859574436, "overlap_percentage": 0.4672551501396648, "num_intersection": 171292, "num_union": 561892, "num_only_computed": 195300, "num_only_roped": 195300, "total_diff": 390600, "diff_percentage": 0.6951513814042556, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:58:42.256525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 6.961822509765625e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.18072289156626506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:59:07.863717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29290378583124543, "overlap_percentage": 0.453094482421875, "num_intersection": 178164, "num_union": 608268, "num_only_computed": 215052, "num_only_roped": 215052, "total_diff": 430104, "diff_percentage": 0.7070962141687546, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:59:08.697663", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.1842485549132948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:59:39.181344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27666998016468036, "overlap_percentage": 0.4334244314713065, "num_intersection": 181747, "num_union": 656909, "num_only_computed": 237581, "num_only_roped": 237581, "total_diff": 475162, "diff_percentage": 0.7233300198353196, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T06:59:40.114125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.16214285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:00:11.117743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2587388874131763, "overlap_percentage": 0.41110811781609197, "num_intersection": 183124, "num_union": 707756, "num_only_computed": 262316, "num_only_roped": 262316, "total_diff": 524632, "diff_percentage": 0.7412611125868237, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:00:12.149357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 5.936622619628906e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.2134502923976608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:00:45.203754", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24638251926525725, "overlap_percentage": 0.3953561855320304, "num_intersection": 186431, "num_union": 756673, "num_only_computed": 285121, "num_only_roped": 285121, "total_diff": 570242, "diff_percentage": 0.7536174807347428, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:00:48.103400", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.887580871582031e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.19219653179190752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:01:24.015438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22938737396756229, "overlap_percentage": 0.3731734664351852, "num_intersection": 185715, "num_union": 809613, "num_only_computed": 311949, "num_only_roped": 311949, "total_diff": 623898, "diff_percentage": 0.7706126260324377, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:01:27.383372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.1994219653179191}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:02:06.155680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21866508606162036, "overlap_percentage": 0.3588600158691406, "num_intersection": 188146, "num_union": 860430, "num_only_computed": 336142, "num_only_roped": 336142, "total_diff": 672284, "diff_percentage": 0.7813349139383796, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:02:08.999253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.18235294117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:02:51.281116", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21054165360781663, "overlap_percentage": 0.3478470203488372, "num_intersection": 191455, "num_union": 909345, "num_only_computed": 358945, "num_only_roped": 358945, "total_diff": 717890, "diff_percentage": 0.7894583463921834, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:02:52.675366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.1541005291005291}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:03:38.034770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20234290356117587, "overlap_percentage": 0.33658102519982236, "num_intersection": 194043, "num_union": 958981, "num_only_computed": 382469, "num_only_roped": 382469, "total_diff": 764938, "diff_percentage": 0.7976570964388241, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:03:39.553533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.2514367816091954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:04:28.725285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1897350447514854, "overlap_percentage": 0.31895344360662703, "num_intersection": 192209, "num_union": 1013039, "num_only_computed": 410415, "num_only_roped": 410415, "total_diff": 820830, "diff_percentage": 0.8102649552485146, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:04:30.368022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.8671875, "l2_diff_relative": 0.3956953642384106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:05:23.308264", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1722898990642914, "overlap_percentage": 0.29393736003664495, "num_intersection": 184809, "num_union": 1072663, "num_only_computed": 443927, "num_only_roped": 443927, "total_diff": 887854, "diff_percentage": 0.8277101009357086, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:05:25.014340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.5763358778625954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:06:19.727720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16516212191923907, "overlap_percentage": 0.28350067138671875, "num_intersection": 185795, "num_union": 1124925, "num_only_computed": 469565, "num_only_roped": 469565, "total_diff": 939130, "diff_percentage": 0.8348378780807609, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:06:21.525688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5463576158940397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:07:21.008582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1619538677688205, "overlap_percentage": 0.27876126972201354, "num_intersection": 189968, "num_union": 1172976, "num_only_computed": 491504, "num_only_roped": 491504, "total_diff": 983008, "diff_percentage": 0.8380461322311795, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:07:22.927856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.5859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:08:23.478106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17153063209612862, "overlap_percentage": 0.29283166380246023, "num_intersection": 207203, "num_union": 1207965, "num_only_computed": 500381, "num_only_roped": 500381, "total_diff": 1000762, "diff_percentage": 0.8284693679038714, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:08:25.383108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 8.392333984375e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.9052631578947369}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:09:27.306385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15514844454800655, "overlap_percentage": 0.26862079117236565, "num_intersection": 197086, "num_union": 1270306, "num_only_computed": 536610, "num_only_roped": 536610, "total_diff": 1073220, "diff_percentage": 0.8448515554519934, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:09:29.356210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.7258883248730964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:10:34.368930", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14730688475032597, "overlap_percentage": 0.25678724098719674, "num_intersection": 195109, "num_union": 1324507, "num_only_computed": 564699, "num_only_roped": 564699, "total_diff": 1129398, "diff_percentage": 0.8526931152496741, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:10:36.527342", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.5434782608695652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:11:46.187205", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1429742427050065, "overlap_percentage": 0.2501792907714844, "num_intersection": 196749, "num_union": 1376115, "num_only_computed": 589683, "num_only_roped": 589683, "total_diff": 1179366, "diff_percentage": 0.8570257572949935, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:11:48.511659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.5211267605633803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:13:01.068319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14243855595150137, "overlap_percentage": 0.24935880395400126, "num_intersection": 202615, "num_union": 1422473, "num_only_computed": 609929, "num_only_roped": 609929, "total_diff": 1219858, "diff_percentage": 0.8575614440484987, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:13:04.103464", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.690677966101695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:14:20.990201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14242979654637627, "overlap_percentage": 0.2493453811813187, "num_intersection": 209115, "num_union": 1468197, "num_only_computed": 629541, "num_only_roped": 629541, "total_diff": 1259082, "diff_percentage": 0.8575702034536238, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:14:23.563478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.7711442786069652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:15:45.097757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14254458110213125, "overlap_percentage": 0.24952125888099466, "num_intersection": 215778, "num_union": 1513758, "num_only_computed": 648990, "num_only_roped": 648990, "total_diff": 1297980, "diff_percentage": 0.8574554188978687, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:15:48.728685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.92}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:17:12.796429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13808591853733068, "overlap_percentage": 0.24266343390804598, "num_intersection": 216184, "num_union": 1565576, "num_only_computed": 674696, "num_only_roped": 674696, "total_diff": 1349392, "diff_percentage": 0.8619140814626693, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:17:16.710056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.515625, "l2_diff_relative": 1.0125786163522013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:18:42.988515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13618705953594237, "overlap_percentage": 0.23972647530691965, "num_intersection": 219950, "num_union": 1615058, "num_only_computed": 697554, "num_only_roped": 697554, "total_diff": 1395108, "diff_percentage": 0.8638129404640577, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:18:45.958510", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 6.723403930664062e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.8571428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:20:18.817571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13125500520301342, "overlap_percentage": 0.23205202116115028, "num_intersection": 218968, "num_union": 1668264, "num_only_computed": 724648, "num_only_roped": 724648, "total_diff": 1449296, "diff_percentage": 0.8687449947969865, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:20:22.117099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.8046511627906977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:21:54.144575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1328815210784843, "overlap_percentage": 0.23459032318222178, "num_intersection": 168563, "num_union": 1268521, "num_only_computed": 549979, "num_only_roped": 549979, "total_diff": 1099958, "diff_percentage": 0.8671184789215157, "num_computed": 718542, "num_roped": 718542}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 382, "seq_len_k": 16254, "queries_shape": [1, 32, 382, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 382, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:21:59.374272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.8715083798882681}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 382, "seq_len_k": 16254, "queries_shape": [1, 32, 382, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 382, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:23:27.105962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.126798106530631, "overlap_percentage": 0.22505914022350926, "num_intersection": 22072, "num_union": 174072, "num_only_computed": 76000, "num_only_roped": 76000, "total_diff": 152000, "diff_percentage": 0.873201893469369, "num_computed": 98072, "num_roped": 98072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:23:30.375635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.484375, "l2_diff_relative": 0.38271604938271603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:24:40.847000", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13682941531042797, "overlap_percentage": 0.24072110286320256, "num_intersection": 454, "num_union": 3318, "num_only_computed": 1432, "num_only_roped": 1432, "total_diff": 2864, "diff_percentage": 0.8631705846895721, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:24:42.732419", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.032958984375, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.602510460251046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:25:40.951967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14511232544019428, "overlap_percentage": 0.25344644750795337, "num_intersection": 478, "num_union": 3294, "num_only_computed": 1408, "num_only_roped": 1408, "total_diff": 2816, "diff_percentage": 0.8548876745598057, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:25:43.657347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0169677734375, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.38306451612903225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:26:43.862215", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1310344827586207, "overlap_percentage": 0.23170731707317074, "num_intersection": 437, "num_union": 3335, "num_only_computed": 1449, "num_only_roped": 1449, "total_diff": 2898, "diff_percentage": 0.8689655172413793, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:26:45.811780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.24338624338624337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:23.882594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:23.898214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.0234375, "l2_diff_relative": 0.0031779661016949155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:27.222147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6761939599003224, "overlap_percentage": 0.8068206616620112, "num_intersection": 147887, "num_union": 218705, "num_only_computed": 35409, "num_only_roped": 35409, "total_diff": 70818, "diff_percentage": 0.32380604009967767, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:27.442641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 0.00014972686767578125, "l2_diff": 0.5390625, "l2_diff_relative": 0.09636871508379888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:35.281773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5594702174163977, "overlap_percentage": 0.717513180012225, "num_intersection": 150253, "num_union": 268563, "num_only_computed": 59155, "num_only_roped": 59155, "total_diff": 118310, "diff_percentage": 0.44052978258360237, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:35.575062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 9.72747802734375e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.10076530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:45.912678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4801547274515534, "overlap_percentage": 0.6487899116847826, "num_intersection": 152803, "num_union": 318237, "num_only_computed": 82717, "num_only_roped": 82717, "total_diff": 165434, "diff_percentage": 0.5198452725484466, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:27:47.688288", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 0.00013637542724609375, "l2_diff": 0.953125, "l2_diff_relative": 0.17329545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:00.400156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42867497785952724, "overlap_percentage": 0.6001014709472656, "num_intersection": 157313, "num_union": 366975, "num_only_computed": 104831, "num_only_roped": 104831, "total_diff": 209662, "diff_percentage": 0.5713250221404728, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:01.123858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 0.00013256072998046875, "l2_diff": 1.1171875, "l2_diff_relative": 0.20784883720930233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:16.449770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39411027871952486, "overlap_percentage": 0.5653932615452931, "num_intersection": 162978, "num_union": 413534, "num_only_computed": 125278, "num_only_roped": 125278, "total_diff": 250556, "diff_percentage": 0.6058897212804751, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:16.984347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 9.34600830078125e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.17613636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:34.471093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3666361634652796, "overlap_percentage": 0.5365527025651465, "num_intersection": 168675, "num_union": 460061, "num_only_computed": 145693, "num_only_roped": 145693, "total_diff": 291386, "diff_percentage": 0.6333638365347204, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:35.135347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 8.535385131835938e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.18787878787878787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:55.109703", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3368513632365875, "overlap_percentage": 0.5039473684210526, "num_intersection": 171584, "num_union": 509376, "num_only_computed": 168896, "num_only_roped": 168896, "total_diff": 337792, "diff_percentage": 0.6631486367634125, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:28:55.791208", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.0979381443298969}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:29:18.656717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3241825721344873, "overlap_percentage": 0.4896342527932961, "num_intersection": 179496, "num_union": 553688, "num_only_computed": 187096, "num_only_roped": 187096, "total_diff": 374192, "diff_percentage": 0.6758174278655127, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:29:21.582716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.054206161137440756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:29:47.150962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2932248235125806, "overlap_percentage": 0.45347849527994794, "num_intersection": 178315, "num_union": 608117, "num_only_computed": 214901, "num_only_roped": 214901, "total_diff": 429802, "diff_percentage": 0.7067751764874194, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:29:49.605646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.09605263157894736}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:30:17.094591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26762364400080413, "overlap_percentage": 0.42224463904151405, "num_intersection": 177059, "num_union": 661597, "num_only_computed": 242269, "num_only_roped": 242269, "total_diff": 484538, "diff_percentage": 0.7323763559991959, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:30:18.024553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.16188524590163936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:30:48.163747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24891353718646786, "overlap_percentage": 0.39860811781609196, "num_intersection": 177556, "num_union": 713324, "num_only_computed": 267884, "num_only_roped": 267884, "total_diff": 535768, "diff_percentage": 0.7510864628135321, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:30:49.187713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.13058659217877094}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:31:22.105407", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24567298548151906, "overlap_percentage": 0.39444218241042345, "num_intersection": 186000, "num_union": 757104, "num_only_computed": 285552, "num_only_roped": 285552, "total_diff": 571104, "diff_percentage": 0.7543270145184809, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:31:24.625816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.1424731182795699}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:32:00.694924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23499173014334832, "overlap_percentage": 0.3805559574331276, "num_intersection": 189389, "num_union": 805939, "num_only_computed": 308275, "num_only_roped": 308275, "total_diff": 616550, "diff_percentage": 0.7650082698566517, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:32:01.888230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.78515625, "l2_diff_relative": 0.14779411764705883}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:32:42.655808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22524248928793858, "overlap_percentage": 0.36767005920410156, "num_intersection": 192765, "num_union": 855811, "num_only_computed": 331523, "num_only_roped": 331523, "total_diff": 663046, "diff_percentage": 0.7747575107120614, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:32:46.224812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.1270053475935829}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:33:27.000721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21120363361090083, "overlap_percentage": 0.34875, "num_intersection": 191952, "num_union": 908848, "num_only_computed": 358448, "num_only_roped": 358448, "total_diff": 716896, "diff_percentage": 0.7887963663890991, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:33:28.729812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.15606508875739644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:34:12.111516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20588644404771989, "overlap_percentage": 0.3414690414076377, "num_intersection": 196861, "num_union": 956163, "num_only_computed": 379651, "num_only_roped": 379651, "total_diff": 759302, "diff_percentage": 0.7941135559522801, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:34:13.604242", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.2692307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:35:00.519186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18743879298284333, "overlap_percentage": 0.3157026603653356, "num_intersection": 190250, "num_union": 1014998, "num_only_computed": 412374, "num_only_roped": 412374, "total_diff": 824748, "diff_percentage": 0.8125612070171567, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:35:03.239442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4927007299270073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:35:52.780371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1696119220290963, "overlap_percentage": 0.29003111003664495, "num_intersection": 182353, "num_union": 1075119, "num_only_computed": 446383, "num_only_roped": 446383, "total_diff": 892766, "diff_percentage": 0.8303880779709036, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:35:54.438065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 9.107589721679688e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.7894736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:36:48.693410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1607088300902996, "overlap_percentage": 0.27691497802734377, "num_intersection": 181479, "num_union": 1129241, "num_only_computed": 473881, "num_only_roped": 473881, "total_diff": 947762, "diff_percentage": 0.8392911699097004, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:36:51.959417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 7.867813110351562e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.6790123456790124}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:37:48.286265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15489439442238503, "overlap_percentage": 0.2682399276859504, "num_intersection": 182798, "num_union": 1180146, "num_only_computed": 498674, "num_only_roped": 498674, "total_diff": 997348, "diff_percentage": 0.8451056055776149, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:37:50.134628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.344650268554688e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.8325123152709359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:38:49.479192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14689819103353652, "overlap_percentage": 0.256166052369754, "num_intersection": 181259, "num_union": 1233909, "num_only_computed": 526325, "num_only_roped": 526325, "total_diff": 1052650, "diff_percentage": 0.8531018089664635, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:38:51.485318", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.5735294117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:39:54.085061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14899151445486813, "overlap_percentage": 0.25934310668178645, "num_intersection": 190279, "num_union": 1277113, "num_only_computed": 543417, "num_only_roped": 543417, "total_diff": 1086834, "diff_percentage": 0.8510084855451319, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:39:56.154754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.6666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:41:03.043360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14158133944333848, "overlap_percentage": 0.24804424275606468, "num_intersection": 188466, "num_union": 1331150, "num_only_computed": 571342, "num_only_roped": 571342, "total_diff": 1142684, "diff_percentage": 0.8584186605566615, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:41:05.277963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.7695652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:42:14.891869", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1381243853922527, "overlap_percentage": 0.24272282918294272, "num_intersection": 190885, "num_union": 1381979, "num_only_computed": 595547, "num_only_roped": 595547, "total_diff": 1191094, "diff_percentage": 0.8618756146077473, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:42:18.715297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.724761962890625e-05, "l2_diff": 3.25, "l2_diff_relative": 0.8188976377952756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:43:29.854516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13640689695200706, "overlap_percentage": 0.24006699944864524, "num_intersection": 195065, "num_union": 1430023, "num_only_computed": 617479, "num_only_roped": 617479, "total_diff": 1234958, "diff_percentage": 0.863593103047993, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:43:32.241912", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 7.200241088867188e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.7423076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:44:47.379926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13936912293048018, "overlap_percentage": 0.24464261866605616, "num_intersection": 205171, "num_union": 1472141, "num_only_computed": 633485, "num_only_roped": 633485, "total_diff": 1266970, "diff_percentage": 0.8606308770695198, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:44:52.244423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.7195121951219512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:46:10.894789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13471946211677363, "overlap_percentage": 0.23744981312907046, "num_intersection": 205339, "num_union": 1524197, "num_only_computed": 659429, "num_only_roped": 659429, "total_diff": 1318858, "diff_percentage": 0.8652805378832263, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:46:15.613765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.9365079365079365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:47:37.480577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1340706846521492, "overlap_percentage": 0.23644149604885056, "num_intersection": 210641, "num_union": 1571119, "num_only_computed": 680239, "num_only_roped": 680239, "total_diff": 1360478, "diff_percentage": 0.8659293153478508, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:47:40.230520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.246566772460938e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.7511111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:49:05.609449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13404894496827457, "overlap_percentage": 0.2364076886858259, "num_intersection": 216905, "num_union": 1618103, "num_only_computed": 700599, "num_only_roped": 700599, "total_diff": 1401198, "diff_percentage": 0.8659510550317254, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:49:08.451598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.103515625e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.806282722513089}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:50:40.239832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12706700595952256, "overlap_percentage": 0.22548261157080846, "num_intersection": 212769, "num_union": 1674463, "num_only_computed": 730847, "num_only_roped": 730847, "total_diff": 1461694, "diff_percentage": 0.8729329940404774, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:50:43.327657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 7.581710815429688e-05, "l2_diff": 3.078125, "l2_diff_relative": 1.2389937106918238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:52:19.786320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12682276412193944, "overlap_percentage": 0.22509798019702643, "num_intersection": 179483, "num_union": 1415227, "num_only_computed": 617872, "num_only_roped": 617872, "total_diff": 1235744, "diff_percentage": 0.8731772358780605, "num_computed": 797355, "num_roped": 797355}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 423, "seq_len_k": 16295, "queries_shape": [1, 32, 423, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 423, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:52:24.251204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 5.745887756347656e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.7443946188340808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 423, "seq_len_k": 16295, "queries_shape": [1, 32, 423, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 423, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:53:51.525194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12665970460987616, "overlap_percentage": 0.22484110169491525, "num_intersection": 12735, "num_union": 100545, "num_only_computed": 43905, "num_only_roped": 43905, "total_diff": 87810, "diff_percentage": 0.8733402953901238, "num_computed": 56640, "num_roped": 56640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:53:54.006101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.390625, "l2_diff_relative": 0.352112676056338}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:55:04.284334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1308775082359988, "overlap_percentage": 0.23146186440677965, "num_intersection": 437, "num_union": 3339, "num_only_computed": 1451, "num_only_roped": 1451, "total_diff": 2902, "diff_percentage": 0.8691224917640012, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:55:06.219638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.5703125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:07.007583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12750074649148999, "overlap_percentage": 0.22616525423728814, "num_intersection": 427, "num_union": 3349, "num_only_computed": 1461, "num_only_roped": 1461, "total_diff": 2922, "diff_percentage": 0.87249925350851, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "mask_shape": [1, 32, 1, 16327], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:08.955484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037353515625, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.08349609375, "l2_diff_relative": 0.7668161434977578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "attention_shape": [1, 32, 1, 16327]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:46.266486", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:46.280023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.079673767089844e-06, "l2_diff": 0.02099609375, "l2_diff_relative": 0.002859042553191489}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:49.607907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6800117319255022, "overlap_percentage": 0.809532122905028, "num_intersection": 148384, "num_union": 218208, "num_only_computed": 34912, "num_only_roped": 34912, "total_diff": 69824, "diff_percentage": 0.3199882680744977, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:49.830337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.00014591217041015625, "l2_diff": 0.58984375, "l2_diff_relative": 0.0877906976744186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:58.027990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5746442334805902, "overlap_percentage": 0.7298718291564792, "num_intersection": 152841, "num_union": 265975, "num_only_computed": 56567, "num_only_roped": 56567, "total_diff": 113134, "diff_percentage": 0.4253557665194097, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:56:59.541965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 8.440017700195312e-05, "l2_diff": 0.51953125, "l2_diff_relative": 0.08271144278606965}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:57:09.776376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4983856345331064, "overlap_percentage": 0.6652301290760869, "num_intersection": 156675, "num_union": 314365, "num_only_computed": 78845, "num_only_roped": 78845, "total_diff": 157690, "diff_percentage": 0.5016143654668935, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:57:10.148373", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 9.965896606445312e-05, "l2_diff": 0.78515625, "l2_diff_relative": 0.12818877551020408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:57:25.084399", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44042683546668643, "overlap_percentage": 0.6115226745605469, "num_intersection": 160307, "num_union": 363981, "num_only_computed": 101837, "num_only_roped": 101837, "total_diff": 203674, "diff_percentage": 0.5595731645333135, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:57:27.071572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.0001201629638671875, "l2_diff": 0.9375, "l2_diff_relative": 0.1986754966887417}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:57:42.095283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39502447593905093, "overlap_percentage": 0.5663333980905861, "num_intersection": 163249, "num_union": 413263, "num_only_computed": 125007, "num_only_roped": 125007, "total_diff": 250014, "diff_percentage": 0.6049755240609491, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:57:42.632842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 0.00011730194091796875, "l2_diff": 1.09375, "l2_diff_relative": 0.22727272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:58:01.265872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3685072001950234, "overlap_percentage": 0.5385535423452769, "num_intersection": 169304, "num_union": 459432, "num_only_computed": 145064, "num_only_roped": 145064, "total_diff": 290128, "diff_percentage": 0.6314927998049766, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:58:01.894827", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 0.00010395050048828125, "l2_diff": 1.0703125, "l2_diff_relative": 0.24640287769784172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:58:22.423733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3413569972324269, "overlap_percentage": 0.5089726268796992, "num_intersection": 173295, "num_union": 507665, "num_only_computed": 167185, "num_only_roped": 167185, "total_diff": 334370, "diff_percentage": 0.6586430027675731, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:58:23.125832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.20112179487179488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:58:46.892652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30947227044443015, "overlap_percentage": 0.47266716131284914, "num_intersection": 173276, "num_union": 559908, "num_only_computed": 193316, "num_only_roped": 193316, "total_diff": 386632, "diff_percentage": 0.6905277295555698, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:58:49.979050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 8.630752563476562e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.25166666666666665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:59:16.247163", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29371838423386004, "overlap_percentage": 0.45406850179036456, "num_intersection": 178547, "num_union": 607885, "num_only_computed": 214669, "num_only_roped": 214669, "total_diff": 429338, "diff_percentage": 0.70628161576614, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:59:17.708183", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.21217105263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:59:45.880267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2755631738808388, "overlap_percentage": 0.4320651137057387, "num_intersection": 181177, "num_union": 657479, "num_only_computed": 238151, "num_only_roped": 238151, "total_diff": 476302, "diff_percentage": 0.7244368261191613, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T07:59:46.836838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 7.390975952148438e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:00:17.826618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26511490523140807, "overlap_percentage": 0.41911593031609196, "num_intersection": 186691, "num_union": 704189, "num_only_computed": 258749, "num_only_roped": 258749, "total_diff": 517498, "diff_percentage": 0.734885094768592, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:00:18.883081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.25333333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:00:52.546680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24883505674753406, "overlap_percentage": 0.3985074816775244, "num_intersection": 187917, "num_union": 755187, "num_only_computed": 283635, "num_only_roped": 283635, "total_diff": 567270, "diff_percentage": 0.751164943252466, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:00:54.396124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09716796875, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.2892857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:01:30.950363", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2357031565225488, "overlap_percentage": 0.3814883134002058, "num_intersection": 189853, "num_union": 805475, "num_only_computed": 307811, "num_only_roped": 307811, "total_diff": 615622, "diff_percentage": 0.7642968434774512, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:01:32.152712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.28040540540540543}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:02:13.426546", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23097729108360412, "overlap_percentage": 0.375274658203125, "num_intersection": 196752, "num_union": 851824, "num_only_computed": 327536, "num_only_roped": 327536, "total_diff": 655072, "diff_percentage": 0.7690227089163959, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:02:16.328352", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 5.412101745605469e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.2654109589041096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:02:58.480978", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22765205967406105, "overlap_percentage": 0.37087390988372093, "num_intersection": 204129, "num_union": 896671, "num_only_computed": 346271, "num_only_roped": 346271, "total_diff": 692542, "diff_percentage": 0.7723479403259389, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:02:59.881492", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0966796875, "mean_diff": 5.0067901611328125e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.24486301369863014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:03:45.423876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21163439036513257, "overlap_percentage": 0.34933704762433393, "num_intersection": 201397, "num_union": 951627, "num_only_computed": 375115, "num_only_roped": 375115, "total_diff": 750230, "diff_percentage": 0.7883656096348675, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:03:46.955971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:04:35.052650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18673960905714476, "overlap_percentage": 0.31471033347493627, "num_intersection": 189652, "num_union": 1015596, "num_only_computed": 412972, "num_only_roped": 412972, "total_diff": 825944, "diff_percentage": 0.8132603909428552, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:04:36.687519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.7734375, "l2_diff_relative": 0.43320610687022904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:05:28.589578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.168513097859924, "overlap_percentage": 0.2884231219462541, "num_intersection": 181342, "num_union": 1076130, "num_only_computed": 447394, "num_only_roped": 447394, "total_diff": 894788, "diff_percentage": 0.831486902140076, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:05:30.368214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 8.440017700195312e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.7327188940092166}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:06:26.361825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16193431142236603, "overlap_percentage": 0.2787322998046875, "num_intersection": 182670, "num_union": 1128050, "num_only_computed": 472690, "num_only_roped": 472690, "total_diff": 945380, "diff_percentage": 0.838065688577634, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:06:28.206138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 8.58306884765625e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.7568807339449541}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:07:27.244454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15000552666595227, "overlap_percentage": 0.26087792308414726, "num_intersection": 177781, "num_union": 1185163, "num_only_computed": 503691, "num_only_roped": 503691, "total_diff": 1007382, "diff_percentage": 0.8499944733340478, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:07:31.679305", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.7339055793991416}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:08:34.667584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15395805473107407, "overlap_percentage": 0.2668347503617945, "num_intersection": 188808, "num_union": 1226360, "num_only_computed": 518776, "num_only_roped": 518776, "total_diff": 1037552, "diff_percentage": 0.846041945268926, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:08:36.768399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.6744186046511628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:09:41.907704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15918453759154677, "overlap_percentage": 0.27464917349965107, "num_intersection": 201509, "num_union": 1265883, "num_only_computed": 532187, "num_only_roped": 532187, "total_diff": 1064374, "diff_percentage": 0.8408154624084533, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:09:44.025544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 8.0108642578125e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.774869109947644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:10:51.681534", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15863158480619657, "overlap_percentage": 0.2738257559804582, "num_intersection": 208055, "num_union": 1311561, "num_only_computed": 551753, "num_only_roped": 551753, "total_diff": 1103506, "diff_percentage": 0.8413684151938035, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:10:53.915658", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.46875, "l2_diff_relative": 0.6899563318777293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:12:04.300409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15463796437270502, "overlap_percentage": 0.26785532633463544, "num_intersection": 210650, "num_union": 1362214, "num_only_computed": 575782, "num_only_roped": 575782, "total_diff": 1151564, "diff_percentage": 0.845362035627295, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:12:08.011516", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.49280575539568344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:13:21.150128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14523547937665918, "overlap_percentage": 0.25363426472904854, "num_intersection": 206089, "num_union": 1418999, "num_only_computed": 606455, "num_only_roped": 606455, "total_diff": 1212910, "diff_percentage": 0.8547645206233409, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:13:23.550216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.625, "l2_diff_relative": 0.8038277511961722}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:14:40.143053", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14533409265033043, "overlap_percentage": 0.2537846268315018, "num_intersection": 212838, "num_union": 1464474, "num_only_computed": 625818, "num_only_roped": 625818, "total_diff": 1251636, "diff_percentage": 0.8546659073496696, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:14:42.675080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.84375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:16:03.032140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14132466133817614, "overlap_percentage": 0.24765023682652457, "num_intersection": 214160, "num_union": 1515376, "num_only_computed": 650608, "num_only_roped": 650608, "total_diff": 1301216, "diff_percentage": 0.8586753386618239, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:16:05.682735", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.5, "l2_diff_relative": 0.8205128205128205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:17:29.073214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13331976389171585, "overlap_percentage": 0.23527298850574713, "num_intersection": 209600, "num_union": 1572160, "num_only_computed": 681280, "num_only_roped": 681280, "total_diff": 1362560, "diff_percentage": 0.8666802361082842, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:17:31.838067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 6.008148193359375e-05, "l2_diff": 2.125, "l2_diff_relative": 0.6507177033492823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:18:58.663879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13327433333189231, "overlap_percentage": 0.2352022443498884, "num_intersection": 215799, "num_union": 1619209, "num_only_computed": 701705, "num_only_roped": 701705, "total_diff": 1403410, "diff_percentage": 0.8667256666681077, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:19:02.993982", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.6177777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:20:33.788982", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12715788065420874, "overlap_percentage": 0.22562567824199675, "num_intersection": 212904, "num_union": 1674328, "num_only_computed": 730712, "num_only_roped": 730712, "total_diff": 1461424, "diff_percentage": 0.8728421193457913, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:20:38.629649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.9341317365269461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:22:09.940629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13378554057276779, "overlap_percentage": 0.23599796572671367, "num_intersection": 201395, "num_union": 1505357, "num_only_computed": 651981, "num_only_roped": 651981, "total_diff": 1303962, "diff_percentage": 0.8662144594272322, "num_computed": 853376, "num_roped": 853376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 452, "seq_len_k": 16324, "queries_shape": [1, 32, 452, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 452, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:22:14.387194", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.81}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 452, "seq_len_k": 16324, "queries_shape": [1, 32, 452, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 452, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:23:39.242246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1323025216576688, "overlap_percentage": 0.2336875863598369, "num_intersection": 13699, "num_union": 103543, "num_only_computed": 44922, "num_only_roped": 44922, "total_diff": 89844, "diff_percentage": 0.8676974783423312, "num_computed": 58621, "num_roped": 58621}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:23:41.649125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.315376281738281e-05, "l2_diff": 0.345703125, "l2_diff_relative": 0.3010204081632653}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:24:49.438086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13675984370303576, "overlap_percentage": 0.24061343204653624, "num_intersection": 455, "num_union": 3327, "num_only_computed": 1436, "num_only_roped": 1436, "total_diff": 2872, "diff_percentage": 0.8632401562969643, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:24:51.312827", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.05859375, "l2_diff_relative": 0.3870967741935484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:27.851688", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:27.864152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.930662155151367e-06, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.003076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:31.117933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7046033665023714, "overlap_percentage": 0.826706529329609, "num_intersection": 151532, "num_union": 215060, "num_only_computed": 31764, "num_only_roped": 31764, "total_diff": 63528, "diff_percentage": 0.29539663349762857, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:31.329458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 6.866455078125e-05, "l2_diff": 0.322265625, "l2_diff_relative": 0.04523026315789474}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:39.480200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5915364504164893, "overlap_percentage": 0.7433526894865525, "num_intersection": 155664, "num_union": 263152, "num_only_computed": 53744, "num_only_roped": 53744, "total_diff": 107488, "diff_percentage": 0.40846354958351067, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:39.777540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 7.104873657226562e-05, "l2_diff": 0.453125, "l2_diff_relative": 0.06775700934579439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:50.027675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5293407185667626, "overlap_percentage": 0.6922469429347826, "num_intersection": 163038, "num_union": 308002, "num_only_computed": 72482, "num_only_roped": 72482, "total_diff": 144964, "diff_percentage": 0.47065928143323743, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:25:51.198650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.07720588235294118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:26:03.453323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4435123057904257, "overlap_percentage": 0.6144905090332031, "num_intersection": 161085, "num_union": 363203, "num_only_computed": 101059, "num_only_roped": 101059, "total_diff": 202118, "diff_percentage": 0.5564876942095742, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:26:05.686799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.05919603524229075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:26:20.303974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3876975291554839, "overlap_percentage": 0.5587637377886323, "num_intersection": 161067, "num_union": 415445, "num_only_computed": 127189, "num_only_roped": 127189, "total_diff": 254378, "diff_percentage": 0.6123024708445162, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:26:20.822157", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 7.581710815429688e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.1387434554973822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:26:37.929702", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35555157894282946, "overlap_percentage": 0.5245858357084691, "num_intersection": 164913, "num_union": 463823, "num_only_computed": 149455, "num_only_roped": 149455, "total_diff": 298910, "diff_percentage": 0.6444484210571705, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:26:38.537241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 7.104873657226562e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.14195979899497488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:26:58.204472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33551159374528083, "overlap_percentage": 0.5024465460526316, "num_intersection": 171073, "num_union": 509887, "num_only_computed": 169407, "num_only_roped": 169407, "total_diff": 338814, "diff_percentage": 0.6644884062547192, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:27:00.686718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.0992489270386266}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:27:23.742635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30829227730263215, "overlap_percentage": 0.47128960806564246, "num_intersection": 172771, "num_union": 560413, "num_only_computed": 193821, "num_only_roped": 193821, "total_diff": 387642, "diff_percentage": 0.6917077226973678, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:27:24.495258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.08435960591133004}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:27:49.688877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2870195352582199, "overlap_percentage": 0.44602203369140625, "num_intersection": 175383, "num_union": 611049, "num_only_computed": 217833, "num_only_roped": 217833, "total_diff": 435666, "diff_percentage": 0.7129804647417801, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:27:50.526397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.13355263157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:28:17.736312", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2690161922674773, "overlap_percentage": 0.42397598061660563, "num_intersection": 177785, "num_union": 660871, "num_only_computed": 241543, "num_only_roped": 241543, "total_diff": 483086, "diff_percentage": 0.7309838077325227, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:28:18.668909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.1400523560209424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:28:48.876776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24998246140808233, "overlap_percentage": 0.3999775502873563, "num_intersection": 178166, "num_union": 712714, "num_only_computed": 267274, "num_only_roped": 267274, "total_diff": 534548, "diff_percentage": 0.7500175385919177, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:28:51.316724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 5.7697296142578125e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.20977011494252873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:29:24.777420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23718545765566748, "overlap_percentage": 0.3834274904994571, "num_intersection": 180806, "num_union": 762298, "num_only_computed": 290746, "num_only_roped": 290746, "total_diff": 581492, "diff_percentage": 0.7628145423443325, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:29:25.883245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 5.3882598876953125e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.2161764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:30:01.917071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23139200415689817, "overlap_percentage": 0.37582183963477367, "num_intersection": 187033, "num_union": 808295, "num_only_computed": 310631, "num_only_roped": 310631, "total_diff": 621262, "diff_percentage": 0.7686079958431018, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:30:03.108291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.25949367088607594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:30:41.785798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2203060028652128, "overlap_percentage": 0.3610668182373047, "num_intersection": 189303, "num_union": 859273, "num_only_computed": 334985, "num_only_roped": 334985, "total_diff": 669970, "diff_percentage": 0.7796939971347872, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:30:43.056442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 5.269050598144531e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.2531847133757962}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:31:25.681589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21254846669016567, "overlap_percentage": 0.3505813953488372, "num_intersection": 192960, "num_union": 907840, "num_only_computed": 357440, "num_only_roped": 357440, "total_diff": 714880, "diff_percentage": 0.7874515333098343, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:31:27.093564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.23802395209580837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:32:12.672100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20525618739305274, "overlap_percentage": 0.3406017567717584, "num_intersection": 196361, "num_union": 956663, "num_only_computed": 380151, "num_only_roped": 380151, "total_diff": 760302, "diff_percentage": 0.7947438126069473, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:32:16.349834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 5.888938903808594e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.33614864864864863}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:33:04.693659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19030256104353735, "overlap_percentage": 0.3197549384027188, "num_intersection": 192692, "num_union": 1012556, "num_only_computed": 409932, "num_only_roped": 409932, "total_diff": 819864, "diff_percentage": 0.8096974389564626, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:33:06.511550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.4807692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:33:58.087498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16918562432183398, "overlap_percentage": 0.28940763690960913, "num_intersection": 181961, "num_union": 1075511, "num_only_computed": 446775, "num_only_roped": 446775, "total_diff": 893550, "diff_percentage": 0.830814375678166, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:33:59.816451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 8.869171142578125e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.7782608695652173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:34:54.947879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15971983818850402, "overlap_percentage": 0.275445556640625, "num_intersection": 180516, "num_union": 1130204, "num_only_computed": 474844, "num_only_roped": 474844, "total_diff": 949688, "diff_percentage": 0.840280161811496, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:34:56.793728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 9.72747802734375e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.9414634146341463}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:35:56.663843", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15439454473229736, "overlap_percentage": 0.26749008029676935, "num_intersection": 182287, "num_union": 1180657, "num_only_computed": 499185, "num_only_roped": 499185, "total_diff": 998370, "diff_percentage": 0.8456054552677026, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:35:58.590733", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 9.393692016601562e-05, "l2_diff": 3.09375, "l2_diff_relative": 0.9209302325581395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:36:59.701078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15011576999440046, "overlap_percentage": 0.2610446250904486, "num_intersection": 184711, "num_union": 1230457, "num_only_computed": 522873, "num_only_roped": 522873, "total_diff": 1045746, "diff_percentage": 0.8498842300055995, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:37:01.725118", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 8.916854858398438e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:38:06.923326", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15648673272195934, "overlap_percentage": 0.2706243457780879, "num_intersection": 198556, "num_union": 1268836, "num_only_computed": 535140, "num_only_roped": 535140, "total_diff": 1070280, "diff_percentage": 0.8435132672780407, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:38:09.079150", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 8.630752563476562e-05, "l2_diff": 3.078125, "l2_diff_relative": 0.9248826291079812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:39:17.069083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1524876133155057, "overlap_percentage": 0.26462343118261455, "num_intersection": 201063, "num_union": 1318553, "num_only_computed": 558745, "num_only_roped": 558745, "total_diff": 1117490, "diff_percentage": 0.8475123866844942, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:39:19.319404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.296966552734375e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.8883495145631068}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:40:31.063868", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14719583735397151, "overlap_percentage": 0.2566184997558594, "num_intersection": 201813, "num_union": 1371051, "num_only_computed": 584619, "num_only_roped": 584619, "total_diff": 1169238, "diff_percentage": 0.8528041626460284, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:40:33.909300", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 8.249282836914062e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.898989898989899}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:41:49.182220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15377045967985847, "overlap_percentage": 0.26655294974795213, "num_intersection": 216586, "num_union": 1408502, "num_only_computed": 595958, "num_only_roped": 595958, "total_diff": 1191916, "diff_percentage": 0.8462295403201415, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:41:51.605768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.8035714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:43:07.664921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1510181562156457, "overlap_percentage": 0.262407947954823, "num_intersection": 220070, "num_union": 1457242, "num_only_computed": 618586, "num_only_roped": 618586, "total_diff": 1237172, "diff_percentage": 0.8489818437843543, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:43:10.193637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.7007575757575758}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:44:29.665023", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14509990863226474, "overlap_percentage": 0.2534275088809947, "num_intersection": 219156, "num_union": 1510380, "num_only_computed": 645612, "num_only_roped": 645612, "total_diff": 1291224, "diff_percentage": 0.8549000913677353, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:44:32.328124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.4849853515625e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.7489539748953975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:45:54.081674", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14195858564842698, "overlap_percentage": 0.24862300162631562, "num_intersection": 64819, "num_union": 456605, "num_only_computed": 195893, "num_only_roped": 195893, "total_diff": 391786, "diff_percentage": 0.858041414351573, "num_computed": 260712, "num_roped": 260712}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:45:56.620771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.5328947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:47:11.949412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13837945981994, "overlap_percentage": 0.24311657879320445, "num_intersection": 9960, "num_union": 71976, "num_only_computed": 31008, "num_only_roped": 31008, "total_diff": 62016, "diff_percentage": 0.8616205401800601, "num_computed": 40968, "num_roped": 40968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:47:14.184024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.48804780876494025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:48:15.702671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13535084802128367, "overlap_percentage": 0.23842999414176919, "num_intersection": 407, "num_union": 3007, "num_only_computed": 1300, "num_only_roped": 1300, "total_diff": 2600, "diff_percentage": 0.8646491519787163, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:48:18.891564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.315376281738281e-05, "l2_diff": 0.06884765625, "l2_diff_relative": 0.3078602620087336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:48:50.866849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:48:50.879357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.0030257428278688526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:48:54.229893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6842182640136357, "overlap_percentage": 0.8125054556564246, "num_intersection": 148929, "num_union": 217663, "num_only_computed": 34367, "num_only_roped": 34367, "total_diff": 68734, "diff_percentage": 0.3157817359863642, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:48:54.451368", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 9.918212890625e-05, "l2_diff": 0.40625, "l2_diff_relative": 0.06220095693779904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:02.688862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5708348961068187, "overlap_percentage": 0.726791717603912, "num_intersection": 152196, "num_union": 266620, "num_only_computed": 57212, "num_only_roped": 57212, "total_diff": 114424, "diff_percentage": 0.4291651038931813, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:02.986023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 8.440017700195312e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.07752403846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:13.314095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5024768028988004, "overlap_percentage": 0.6688646399456522, "num_intersection": 157531, "num_union": 313509, "num_only_computed": 77989, "num_only_roped": 77989, "total_diff": 155978, "diff_percentage": 0.49752319710119963, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:14.158380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.00010633468627929688, "l2_diff": 0.87890625, "l2_diff_relative": 0.13719512195121952}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:26.825501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43978601813024004, "overlap_percentage": 0.6109046936035156, "num_intersection": 160145, "num_union": 364143, "num_only_computed": 101999, "num_only_roped": 101999, "total_diff": 203998, "diff_percentage": 0.5602139818697599, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:27.986101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.08964646464646464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:43.026562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3944238718462852, "overlap_percentage": 0.5657158914298401, "num_intersection": 163071, "num_union": 413441, "num_only_computed": 125185, "num_only_roped": 125185, "total_diff": 250370, "diff_percentage": 0.6055761281537148, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:49:43.562642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.12699468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:50:01.643736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3555106643066422, "overlap_percentage": 0.5245413019136808, "num_intersection": 164899, "num_union": 463837, "num_only_computed": 149469, "num_only_roped": 149469, "total_diff": 298938, "diff_percentage": 0.6444893356933578, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:50:02.262397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 8.487701416015625e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.17613636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:50:22.432254", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3344464171634391, "overlap_percentage": 0.5012511748120301, "num_intersection": 170666, "num_union": 510294, "num_only_computed": 169814, "num_only_roped": 169814, "total_diff": 339628, "diff_percentage": 0.6655535828365609, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:50:23.724465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.80078125, "l2_diff_relative": 0.14157458563535913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:50:46.638758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3082665981471172, "overlap_percentage": 0.47125960195530725, "num_intersection": 172760, "num_union": 560424, "num_only_computed": 193832, "num_only_roped": 193832, "total_diff": 387664, "diff_percentage": 0.6917334018528828, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:50:47.420985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 7.390975952148438e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.2120253164556962}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:51:13.279972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29716035046975614, "overlap_percentage": 0.4581705729166667, "num_intersection": 180160, "num_union": 606272, "num_only_computed": 213056, "num_only_roped": 213056, "total_diff": 426112, "diff_percentage": 0.7028396495302438, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:51:14.146238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.8671875, "l2_diff_relative": 0.15416666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:51:42.560471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27921123117003555, "overlap_percentage": 0.4365365537240537, "num_intersection": 183052, "num_union": 655604, "num_only_computed": 236276, "num_only_roped": 236276, "total_diff": 472552, "diff_percentage": 0.7207887688299645, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:51:45.700896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.57763671875e-05, "l2_diff": 0.890625, "l2_diff_relative": 0.1557377049180328}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:52:16.934141", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2616445223656968, "overlap_percentage": 0.41476742097701147, "num_intersection": 184754, "num_union": 706126, "num_only_computed": 260686, "num_only_roped": 260686, "total_diff": 521372, "diff_percentage": 0.7383554776343032, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:52:17.992594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.15878378378378377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:52:52.155589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2503864766324163, "overlap_percentage": 0.4004945371878393, "num_intersection": 188854, "num_union": 754250, "num_only_computed": 282698, "num_only_roped": 282698, "total_diff": 565396, "diff_percentage": 0.7496135233675837, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:52:54.869124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.19915254237288135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:53:31.844229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2341785807283594, "overlap_percentage": 0.37948897247942387, "num_intersection": 188858, "num_union": 806470, "num_only_computed": 308806, "num_only_roped": 308806, "total_diff": 617612, "diff_percentage": 0.7658214192716406, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:53:33.067597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.15460526315789475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:54:14.335209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23115651050839497, "overlap_percentage": 0.37551116943359375, "num_intersection": 196876, "num_union": 851700, "num_only_computed": 327412, "num_only_roped": 327412, "total_diff": 654824, "diff_percentage": 0.768843489491605, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:54:17.529972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.1766304347826087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:55:00.803148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2157423615751197, "overlap_percentage": 0.3549146075581395, "num_intersection": 195345, "num_union": 905455, "num_only_computed": 355055, "num_only_roped": 355055, "total_diff": 710110, "diff_percentage": 0.7842576384248803, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:55:02.247855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.13079896907216496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:55:49.077925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2005401797753277, "overlap_percentage": 0.3340832454484902, "num_intersection": 192603, "num_union": 960421, "num_only_computed": 383909, "num_only_roped": 383909, "total_diff": 767818, "diff_percentage": 0.7994598202246723, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:55:50.593518", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.26212121212121214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:56:40.584804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18185437451093064, "overlap_percentage": 0.30774413232795245, "num_intersection": 185454, "num_union": 1019794, "num_only_computed": 417170, "num_only_roped": 417170, "total_diff": 834340, "diff_percentage": 0.8181456254890693, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:56:42.154924", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.772445678710938e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.5639097744360902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:57:32.603737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16471308518294508, "overlap_percentage": 0.28283890217833874, "num_intersection": 177831, "num_union": 1079641, "num_only_computed": 450905, "num_only_roped": 450905, "total_diff": 901810, "diff_percentage": 0.835286914817055, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:57:34.287469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 9.775161743164062e-05, "l2_diff": 3.0625, "l2_diff_relative": 0.8789237668161435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:58:27.958646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15419499935717595, "overlap_percentage": 0.2671905517578125, "num_intersection": 175106, "num_union": 1135614, "num_only_computed": 480254, "num_only_roped": 480254, "total_diff": 960508, "diff_percentage": 0.845805000642824, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:58:29.747598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 0.00010156631469726562, "l2_diff": 3.234375, "l2_diff_relative": 1.0097560975609756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:59:26.580503", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15211404284383523, "overlap_percentage": 0.26406073910593536, "num_intersection": 179950, "num_union": 1182994, "num_only_computed": 501522, "num_only_roped": 501522, "total_diff": 1003044, "diff_percentage": 0.8478859571561648, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T08:59:28.454564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 9.012222290039062e-05, "l2_diff": 3.15625, "l2_diff_relative": 0.8347107438016529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:00:28.131608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14825777639299995, "overlap_percentage": 0.25823082489146165, "num_intersection": 182720, "num_union": 1232448, "num_only_computed": 524864, "num_only_roped": 524864, "total_diff": 1049728, "diff_percentage": 0.851742223607, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:00:30.547456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1982421875, "mean_diff": 7.772445678710938e-05, "l2_diff": 2.875, "l2_diff_relative": 0.6666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:01:31.866245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14445889042881177, "overlap_percentage": 0.2524492432833217, "num_intersection": 185221, "num_union": 1282171, "num_only_computed": 548475, "num_only_roped": 548475, "total_diff": 1096950, "diff_percentage": 0.8555411095711882, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:01:33.870588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.6392857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:02:40.793695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15053043770574714, "overlap_percentage": 0.26167136960916443, "num_intersection": 198820, "num_union": 1320796, "num_only_computed": 560988, "num_only_roped": 560988, "total_diff": 1121976, "diff_percentage": 0.8494695622942529, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:02:43.008469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.7178423236514523}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:03:55.149323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15087750107012327, "overlap_percentage": 0.2621955871582031, "num_intersection": 206199, "num_union": 1366665, "num_only_computed": 580233, "num_only_roped": 580233, "total_diff": 1160466, "diff_percentage": 0.8491224989298768, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:03:57.967705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 7.295608520507812e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.7541666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:05:09.920987", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14865229739224103, "overlap_percentage": 0.25882906033396347, "num_intersection": 210310, "num_union": 1414778, "num_only_computed": 602234, "num_only_roped": 602234, "total_diff": 1204468, "diff_percentage": 0.8513477026077589, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:05:12.323131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.6033755274261603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:06:27.992304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13883225208526415, "overlap_percentage": 0.24381510416666666, "num_intersection": 204477, "num_union": 1472835, "num_only_computed": 634179, "num_only_roped": 634179, "total_diff": 1268358, "diff_percentage": 0.8611677479147358, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:06:30.557933", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.6596638655462185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:07:52.101082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13752933376829743, "overlap_percentage": 0.24180358200118413, "num_intersection": 209104, "num_union": 1520432, "num_only_computed": 655664, "num_only_roped": 655664, "total_diff": 1311328, "diff_percentage": 0.8624706662317025, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:07:54.862227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 6.580352783203125e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.8181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:09:15.831064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13673489528847482, "overlap_percentage": 0.24057481802522643, "num_intersection": 103911, "num_union": 759945, "num_only_computed": 328017, "num_only_roped": 328017, "total_diff": 656034, "diff_percentage": 0.8632651047115252, "num_computed": 431928, "num_roped": 431928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:09:18.469473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.103515625e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.6358381502890174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:10:36.152919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.128360904724765, "overlap_percentage": 0.2275174621653085, "num_intersection": 12508, "num_union": 97444, "num_only_computed": 42468, "num_only_roped": 42468, "total_diff": 84936, "diff_percentage": 0.871639095275235, "num_computed": 54976, "num_roped": 54976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:10:38.393300", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10693359375, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.453125, "l2_diff_relative": 0.4233576642335766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:11:41.544756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13661925239827985, "overlap_percentage": 0.24039580908032596, "num_intersection": 413, "num_union": 3023, "num_only_computed": 1305, "num_only_roped": 1305, "total_diff": 2610, "diff_percentage": 0.8633807476017201, "num_computed": 1718, "num_roped": 1718}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:11:43.307588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 7.486343383789062e-05, "l2_diff": 0.1044921875, "l2_diff_relative": 0.8699186991869918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:15.901644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:15.917263", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.258487701416016e-06, "l2_diff": 0.023193359375, "l2_diff_relative": 0.0031315928270042193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:19.174507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6734546682917699, "overlap_percentage": 0.8048675366620112, "num_intersection": 147529, "num_union": 219063, "num_only_computed": 35767, "num_only_roped": 35767, "total_diff": 71534, "diff_percentage": 0.3265453317082301, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:19.389053", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 0.00018405914306640625, "l2_diff": 0.62890625, "l2_diff_relative": 0.11306179775280899}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:27.140119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5431516969230259, "overlap_percentage": 0.7039511384474327, "num_intersection": 147413, "num_union": 271403, "num_only_computed": 61995, "num_only_roped": 61995, "total_diff": 123990, "diff_percentage": 0.4568483030769741, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:27.431227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.0001983642578125, "l2_diff": 1.0390625, "l2_diff_relative": 0.18070652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:38.016667", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4829693388281444, "overlap_percentage": 0.6513544497282608, "num_intersection": 153407, "num_union": 317633, "num_only_computed": 82113, "num_only_roped": 82113, "total_diff": 164226, "diff_percentage": 0.5170306611718556, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:38.375668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 0.00010633468627929688, "l2_diff": 0.84375, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:51.111279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4376185932238711, "overlap_percentage": 0.6088104248046875, "num_intersection": 159596, "num_union": 364692, "num_only_computed": 102548, "num_only_roped": 102548, "total_diff": 205096, "diff_percentage": 0.5623814067761289, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:12:51.544180", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 5.0067901611328125e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.07778532608695653}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:13:07.072073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42520370223874693, "overlap_percentage": 0.5966918294849023, "num_intersection": 172000, "num_union": 404512, "num_only_computed": 116256, "num_only_roped": 116256, "total_diff": 232512, "diff_percentage": 0.5747962977612531, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:13:07.585373", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.0875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:13:24.677213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3808328446778278, "overlap_percentage": 0.551598763232899, "num_intersection": 173405, "num_union": 455331, "num_only_computed": 140963, "num_only_roped": 140963, "total_diff": 281926, "diff_percentage": 0.6191671553221723, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:13:25.272841", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.10112359550561797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:13:47.019370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33271749426565106, "overlap_percentage": 0.4993068609022556, "num_intersection": 170004, "num_union": 510956, "num_only_computed": 170476, "num_only_roped": 170476, "total_diff": 340952, "diff_percentage": 0.667282505734349, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:13:47.710660", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.8671875, "l2_diff_relative": 0.15589887640449437}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:14:09.958419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3003474408383983, "overlap_percentage": 0.4619495242667598, "num_intersection": 169347, "num_union": 563837, "num_only_computed": 197245, "num_only_roped": 197245, "total_diff": 394490, "diff_percentage": 0.6996525591616016, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:14:10.707042", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.11588541666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:14:35.381000", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26665109724179586, "overlap_percentage": 0.42103322347005206, "num_intersection": 165557, "num_union": 620875, "num_only_computed": 227659, "num_only_roped": 227659, "total_diff": 455318, "diff_percentage": 0.7333489027582042, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:14:36.421362", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.095703125, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.14673913043478262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:15:03.584919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25175152913642973, "overlap_percentage": 0.4022388202075702, "num_intersection": 168670, "num_union": 669986, "num_only_computed": 250658, "num_only_roped": 250658, "total_diff": 501316, "diff_percentage": 0.7482484708635703, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:15:04.476529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06494140625, "mean_diff": 5.14984130859375e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.17287234042553193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:15:34.316518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24733627731278335, "overlap_percentage": 0.3965831537356322, "num_intersection": 176654, "num_union": 714226, "num_only_computed": 268786, "num_only_roped": 268786, "total_diff": 537572, "diff_percentage": 0.7526637226872166, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:15:35.290464", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 5.173683166503906e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.19491525423728814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:16:07.618996", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24442544364878613, "overlap_percentage": 0.39283260382736157, "num_intersection": 185241, "num_union": 757863, "num_only_computed": 286311, "num_only_roped": 286311, "total_diff": 572622, "diff_percentage": 0.7555745563512138, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:16:11.032655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 5.91278076171875e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.2532051282051282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:16:45.994739", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23622651633144295, "overlap_percentage": 0.3821735146604938, "num_intersection": 190194, "num_union": 805134, "num_only_computed": 307470, "num_only_roped": 307470, "total_diff": 614940, "diff_percentage": 0.763773483668557, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:16:47.181363", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.6253204345703125e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.21122994652406418}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:17:26.136402", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2326022891709308, "overlap_percentage": 0.37741661071777344, "num_intersection": 197875, "num_union": 850701, "num_only_computed": 326413, "num_only_roped": 326413, "total_diff": 652826, "diff_percentage": 0.7673977108290692, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:17:27.426286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 4.458427429199219e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.2062146892655367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:18:09.120979", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22789307246554638, "overlap_percentage": 0.3711936773255814, "num_intersection": 204305, "num_union": 896495, "num_only_computed": 346095, "num_only_roped": 346095, "total_diff": 692190, "diff_percentage": 0.7721069275344536, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:18:10.512613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.14754098360655737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:18:56.215035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20796844470752163, "overlap_percentage": 0.3443276115674956, "num_intersection": 198509, "num_union": 954515, "num_only_computed": 378003, "num_only_roped": 378003, "total_diff": 756006, "diff_percentage": 0.7920315552924784, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:18:57.695560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 5.53131103515625e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.33053691275167785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:19:46.019120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1861042769697089, "overlap_percentage": 0.31380761469838575, "num_intersection": 189108, "num_union": 1016140, "num_only_computed": 413516, "num_only_roped": 413516, "total_diff": 827032, "diff_percentage": 0.8138957230302911, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:19:49.728659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 8.0108642578125e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.6278026905829597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:20:40.241378", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16472063680839988, "overlap_percentage": 0.2828500356270358, "num_intersection": 177838, "num_union": 1079634, "num_only_computed": 450898, "num_only_roped": 450898, "total_diff": 901796, "diff_percentage": 0.8352793631916001, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:20:41.916838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 0.00010347366333007812, "l2_diff": 3.03125, "l2_diff_relative": 1.1149425287356323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:21:37.025455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15514302685686387, "overlap_percentage": 0.2686126708984375, "num_intersection": 176038, "num_union": 1134682, "num_only_computed": 479322, "num_only_roped": 479322, "total_diff": 958644, "diff_percentage": 0.8448569731431361, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:21:40.558453", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.5601503759398496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:22:37.193510", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15106416580734464, "overlap_percentage": 0.26247740185950413, "num_intersection": 178871, "num_union": 1184073, "num_only_computed": 502601, "num_only_roped": 502601, "total_diff": 1005202, "diff_percentage": 0.8489358341926554, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:22:39.049490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.6521739130434783}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:23:38.262872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1499830570315757, "overlap_percentage": 0.2608439422033285, "num_intersection": 184569, "num_union": 1230599, "num_only_computed": 523015, "num_only_roped": 523015, "total_diff": 1046030, "diff_percentage": 0.8500169429684243, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:23:41.359348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 8.535385131835938e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.8551401869158879}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:24:44.038480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1475242151295097, "overlap_percentage": 0.25711738921842286, "num_intersection": 188646, "num_union": 1278746, "num_only_computed": 545050, "num_only_roped": 545050, "total_diff": 1090100, "diff_percentage": 0.8524757848704904, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:24:46.120734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.7807017543859649}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:25:53.479523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14898546166106647, "overlap_percentage": 0.25933393699460916, "num_intersection": 197044, "num_union": 1322572, "num_only_computed": 562764, "num_only_roped": 562764, "total_diff": 1125528, "diff_percentage": 0.8510145383389335, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:25:56.814563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.7431192660550459}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:27:06.459372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1500940336181153, "overlap_percentage": 0.2610117594401042, "num_intersection": 205268, "num_union": 1367596, "num_only_computed": 581164, "num_only_roped": 581164, "total_diff": 1162328, "diff_percentage": 0.8499059663818848, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:27:08.819237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.7128205128205128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:28:22.162720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15192623534740568, "overlap_percentage": 0.2637777154221802, "num_intersection": 214331, "num_union": 1410757, "num_only_computed": 598213, "num_only_roped": 598213, "total_diff": 1196426, "diff_percentage": 0.8480737646525943, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:28:26.521469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.7112299465240641}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:29:43.558436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14698587561928794, "overlap_percentage": 0.2562993646978022, "num_intersection": 214947, "num_union": 1462365, "num_only_computed": 623709, "num_only_roped": 623709, "total_diff": 1247418, "diff_percentage": 0.8530141243807121, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:29:46.116033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.8504672897196262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:31:05.901369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13848029374089135, "overlap_percentage": 0.2432721839846063, "num_intersection": 210374, "num_union": 1519162, "num_only_computed": 654394, "num_only_roped": 654394, "total_diff": 1308788, "diff_percentage": 0.8615197062591087, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:31:08.522414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.626678466796875e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.6184738955823293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:32:30.073501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12893016607393018, "overlap_percentage": 0.2284112338362069, "num_intersection": 203487, "num_union": 1578273, "num_only_computed": 687393, "num_only_roped": 687393, "total_diff": 1374786, "diff_percentage": 0.8710698339260698, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:32:32.837384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.46008403361344535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:33:57.152979", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12605985703090913, "overlap_percentage": 0.2238954816545759, "num_intersection": 205425, "num_union": 1629583, "num_only_computed": 712079, "num_only_roped": 712079, "total_diff": 1424158, "diff_percentage": 0.8739401429690908, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:33:59.991130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.0, "l2_diff_relative": 0.46715328467153283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:35:27.831442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1301402702395251, "overlap_percentage": 0.23030817265177675, "num_intersection": 186475, "num_union": 1432877, "num_only_computed": 623201, "num_only_roped": 623201, "total_diff": 1246402, "diff_percentage": 0.8698597297604749, "num_computed": 809676, "num_roped": 809676}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 441, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:35:30.776591", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.6336206896551724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 441, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:36:52.904597", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13212195873113644, "overlap_percentage": 0.23340587595212187, "num_intersection": 10296, "num_union": 77928, "num_only_computed": 33816, "num_only_roped": 33816, "total_diff": 67632, "diff_percentage": 0.8678780412688636, "num_computed": 44112, "num_roped": 44112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:36:55.191318", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.1748046875, "l2_diff_relative": 0.1543103448275862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:38:01.554001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1373762376237624, "overlap_percentage": 0.24156692056583243, "num_intersection": 444, "num_union": 3232, "num_only_computed": 1394, "num_only_roped": 1394, "total_diff": 2788, "diff_percentage": 0.8626237623762376, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:38:03.307560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.0810546875, "l2_diff_relative": 0.664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:38:59.913108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13316892725030827, "overlap_percentage": 0.235038084874864, "num_intersection": 432, "num_union": 3244, "num_only_computed": 1406, "num_only_roped": 1406, "total_diff": 2812, "diff_percentage": 0.8668310727496917, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:39:01.708356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.061767578125, "l2_diff_relative": 0.331151832460733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:39:57.904588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13702443550881535, "overlap_percentage": 0.2410228509249184, "num_intersection": 443, "num_union": 3233, "num_only_computed": 1395, "num_only_roped": 1395, "total_diff": 2790, "diff_percentage": 0.8629755644911846, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:39:59.730127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0159912109375, "mean_diff": 2.777576446533203e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.15777777777777777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:31.786170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:31.797481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.0234375, "l2_diff_relative": 0.0030991735537190084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:35.073792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6753589806867933, "overlap_percentage": 0.8062259951117319, "num_intersection": 147778, "num_union": 218814, "num_only_computed": 35518, "num_only_roped": 35518, "total_diff": 71036, "diff_percentage": 0.32464101931320666, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:35.294099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 0.00021457672119140625, "l2_diff": 0.73046875, "l2_diff_relative": 0.13590116279069767}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:43.154737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5625888436612729, "overlap_percentage": 0.7200727765892421, "num_intersection": 150789, "num_union": 268027, "num_only_computed": 58619, "num_only_roped": 58619, "total_diff": 117238, "diff_percentage": 0.43741115633872707, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:45.044334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 7.82012939453125e-05, "l2_diff": 0.5, "l2_diff_relative": 0.07582938388625593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:55.131299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5014806338196528, "overlap_percentage": 0.6679814877717392, "num_intersection": 157323, "num_union": 313717, "num_only_computed": 78197, "num_only_roped": 78197, "total_diff": 156394, "diff_percentage": 0.49851936618034726, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:40:55.496037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.00010919570922851562, "l2_diff": 0.77734375, "l2_diff_relative": 0.14214285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:06.798233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4608593872353053, "overlap_percentage": 0.6309428426338656, "num_intersection": 55911, "num_union": 121319, "num_only_computed": 32704, "num_only_roped": 32704, "total_diff": 65408, "diff_percentage": 0.5391406127646947, "num_computed": 88615, "num_roped": 88615}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:07.177709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.00013065338134765625, "l2_diff": 0.578125, "l2_diff_relative": 0.18877551020408162}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:18.237748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47274954072259645, "overlap_percentage": 0.641995841995842, "num_intersection": 7720, "num_union": 16330, "num_only_computed": 4305, "num_only_roped": 4305, "total_diff": 8610, "diff_percentage": 0.5272504592774035, "num_computed": 12025, "num_roped": 12025}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:18.581900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 0.00012493133544921875, "l2_diff": 0.17578125, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:28.726286", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45317220543806647, "overlap_percentage": 0.6237006237006237, "num_intersection": 300, "num_union": 662, "num_only_computed": 181, "num_only_roped": 181, "total_diff": 362, "diff_percentage": 0.5468277945619335, "num_computed": 481, "num_roped": 481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:29.037533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.01531982421875, "l2_diff_relative": 0.05810185185185185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:38.677861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4695121951219512, "overlap_percentage": 0.6390041493775933, "num_intersection": 308, "num_union": 656, "num_only_computed": 174, "num_only_roped": 174, "total_diff": 348, "diff_percentage": 0.5304878048780488, "num_computed": 482, "num_roped": 482}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:39.959215", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.0076904296875, "l2_diff_relative": 0.03336864406779661}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:48.515144", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:48.528581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.02392578125, "l2_diff_relative": 0.003099696356275304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:51.825507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6857827380541798, "overlap_percentage": 0.81360749825419, "num_intersection": 149131, "num_union": 217461, "num_only_computed": 34165, "num_only_roped": 34165, "total_diff": 68330, "diff_percentage": 0.31421726194582017, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:41:53.548077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 0.00015926361083984375, "l2_diff": 0.62890625, "l2_diff_relative": 0.10113065326633165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:01.335009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5690576273218393, "overlap_percentage": 0.7253495568459658, "num_intersection": 151894, "num_union": 266922, "num_only_computed": 57514, "num_only_roped": 57514, "total_diff": 115028, "diff_percentage": 0.43094237267816066, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:01.621253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 0.0001392364501953125, "l2_diff": 0.8046875, "l2_diff_relative": 0.13005050505050506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:12.236837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4900859178276329, "overlap_percentage": 0.6577955163043478, "num_intersection": 154924, "num_union": 316116, "num_only_computed": 80596, "num_only_roped": 80596, "total_diff": 161192, "diff_percentage": 0.5099140821723671, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:12.601014", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.625, "l2_diff_relative": 0.11428571428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:25.460172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4295007947911867, "overlap_percentage": 0.6009101867675781, "num_intersection": 157525, "num_union": 366763, "num_only_computed": 104619, "num_only_roped": 104619, "total_diff": 209238, "diff_percentage": 0.5704992052088134, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:25.914015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 0.00011587142944335938, "l2_diff": 0.984375, "l2_diff_relative": 0.1810344827586207}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:41.394103", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3881653242797462, "overlap_percentage": 0.5592494171847247, "num_intersection": 161207, "num_union": 415305, "num_only_computed": 127049, "num_only_roped": 127049, "total_diff": 254098, "diff_percentage": 0.6118346757202537, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:41.906496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.09359605911330049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:42:59.203285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3590207483588716, "overlap_percentage": 0.5283521223534202, "num_intersection": 166097, "num_union": 462639, "num_only_computed": 148271, "num_only_roped": 148271, "total_diff": 296542, "diff_percentage": 0.6409792516411283, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:43:01.894113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.09765625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:43:22.121926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33445687746183544, "overlap_percentage": 0.5012629229323309, "num_intersection": 170670, "num_union": 510290, "num_only_computed": 169810, "num_only_roped": 169810, "total_diff": 339620, "diff_percentage": 0.6655431225381646, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:43:22.852677", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.6328125, "l2_diff_relative": 0.09975369458128079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:43:46.200355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32001764382871084, "overlap_percentage": 0.48486873690642457, "num_intersection": 177749, "num_union": 555435, "num_only_computed": 188843, "num_only_roped": 188843, "total_diff": 377686, "diff_percentage": 0.6799823561712892, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:43:46.971279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.83203125, "l2_diff_relative": 0.14087301587301587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:44:12.493704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2976333674888747, "overlap_percentage": 0.45873260498046875, "num_intersection": 180381, "num_union": 606051, "num_only_computed": 212835, "num_only_roped": 212835, "total_diff": 425670, "diff_percentage": 0.7023666325111253, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:44:13.346086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.11061946902654868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:44:41.609779", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.274888382507863, "overlap_percentage": 0.43123521443833945, "num_intersection": 180829, "num_union": 657827, "num_only_computed": 238499, "num_only_roped": 238499, "total_diff": 476998, "diff_percentage": 0.725111617492137, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:44:42.555759", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.81640625, "l2_diff_relative": 0.13678010471204188}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:45:13.644303", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27728576774354496, "overlap_percentage": 0.4341796875, "num_intersection": 193401, "num_union": 697479, "num_only_computed": 252039, "num_only_roped": 252039, "total_diff": 504078, "diff_percentage": 0.722714232256455, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:45:14.650628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.4921875, "l2_diff_relative": 0.06759656652360516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:45:49.114010", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2598943568835013, "overlap_percentage": 0.41256531623235615, "num_intersection": 194546, "num_union": 748558, "num_only_computed": 277006, "num_only_roped": 277006, "total_diff": 554012, "diff_percentage": 0.7401056431164986, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:45:50.262207", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.62890625, "l2_diff_relative": 0.09404205607476636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:46:27.497233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23609755370595292, "overlap_percentage": 0.38200472608024694, "num_intersection": 190110, "num_union": 805218, "num_only_computed": 307554, "num_only_roped": 307554, "total_diff": 615108, "diff_percentage": 0.7639024462940471, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:46:28.738499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.125, "l2_diff_relative": 0.1925133689839572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:47:08.893044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2271409629403373, "overlap_percentage": 0.3701953887939453, "num_intersection": 194089, "num_union": 854487, "num_only_computed": 330199, "num_only_roped": 330199, "total_diff": 660398, "diff_percentage": 0.7728590370596627, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:47:10.201033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16927083333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:47:53.619232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21821658757702386, "overlap_percentage": 0.3582558139534884, "num_intersection": 197184, "num_union": 903616, "num_only_computed": 353216, "num_only_roped": 353216, "total_diff": 706432, "diff_percentage": 0.7817834124229761, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:47:55.047447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.22685185185185186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:48:40.372556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20680780337292096, "overlap_percentage": 0.3427352769760213, "num_intersection": 197591, "num_union": 955433, "num_only_computed": 378921, "num_only_roped": 378921, "total_diff": 757842, "diff_percentage": 0.7931921966270791, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:48:43.306055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08837890625, "mean_diff": 5.435943603515625e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.29141104294478526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:49:30.550955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1889158627928151, "overlap_percentage": 0.3177951757646559, "num_intersection": 191511, "num_union": 1013737, "num_only_computed": 411113, "num_only_roped": 411113, "total_diff": 822226, "diff_percentage": 0.8110841372071849, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:49:32.323096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:50:22.585525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16442188291442536, "overlap_percentage": 0.28240946915716614, "num_intersection": 177561, "num_union": 1079911, "num_only_computed": 451175, "num_only_roped": 451175, "total_diff": 902350, "diff_percentage": 0.8355781170855746, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:50:24.267018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 0.00010061264038085938, "l2_diff": 2.90625, "l2_diff_relative": 1.0}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:51:17.606692", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1509103441614604, "overlap_percentage": 0.26224517822265625, "num_intersection": 171865, "num_union": 1138855, "num_only_computed": 483495, "num_only_roped": 483495, "total_diff": 966990, "diff_percentage": 0.8490896558385396, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:51:19.399760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1953125, "mean_diff": 9.202957153320312e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.8340807174887892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:52:16.397055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14917648804655578, "overlap_percentage": 0.25962328606311047, "num_intersection": 176926, "num_union": 1186018, "num_only_computed": 504546, "num_only_roped": 504546, "total_diff": 1009092, "diff_percentage": 0.8508235119534442, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:52:18.330392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.6382978723404256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:53:19.971179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1495673590870838, "overlap_percentage": 0.2602150416063676, "num_intersection": 184124, "num_union": 1231044, "num_only_computed": 523460, "num_only_roped": 523460, "total_diff": 1046920, "diff_percentage": 0.8504326409129161, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:53:21.986877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 8.869171142578125e-05, "l2_diff": 3.125, "l2_diff_relative": 0.8849557522123894}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:54:24.776346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14088364929260008, "overlap_percentage": 0.2469728606943475, "num_intersection": 181203, "num_union": 1286189, "num_only_computed": 552493, "num_only_roped": 552493, "total_diff": 1104986, "diff_percentage": 0.8591163507073999, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:54:26.848694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 9.965896606445312e-05, "l2_diff": 3.375, "l2_diff_relative": 1.180327868852459}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:55:30.514510", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14255709027495522, "overlap_percentage": 0.24954042382363403, "num_intersection": 125564, "num_union": 880798, "num_only_computed": 377617, "num_only_roped": 377617, "total_diff": 755234, "diff_percentage": 0.8574429097250448, "num_computed": 503181, "num_roped": 503181}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 343, "seq_len_k": 12119, "queries_shape": [1, 32, 343, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 343, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:55:34.969916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 9.679794311523438e-05, "l2_diff": 2.65625, "l2_diff_relative": 1.069182389937107}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 343, "seq_len_k": 12119, "queries_shape": [1, 32, 343, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 343, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:56:35.389583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14589858247189383, "overlap_percentage": 0.2546448432760364, "num_intersection": 16118, "num_union": 110474, "num_only_computed": 47178, "num_only_roped": 47178, "total_diff": 94356, "diff_percentage": 0.8541014175281062, "num_computed": 63296, "num_roped": 63296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:56:37.158359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.48427672955974843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:57:26.854048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1599684791174153, "overlap_percentage": 0.2758152173913043, "num_intersection": 406, "num_union": 2538, "num_only_computed": 1066, "num_only_roped": 1066, "total_diff": 2132, "diff_percentage": 0.8400315208825847, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:57:28.248246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.045654296875, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.107421875, "l2_diff_relative": 0.9166666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:58:11.582430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16501780767708746, "overlap_percentage": 0.28328804347826086, "num_intersection": 417, "num_union": 2527, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.8349821923229126, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:58:12.975126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06396484375, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.119140625, "l2_diff_relative": 0.9312977099236641}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:58:55.787078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14597119501751654, "overlap_percentage": 0.2547554347826087, "num_intersection": 375, "num_union": 2569, "num_only_computed": 1097, "num_only_roped": 1097, "total_diff": 2194, "diff_percentage": 0.8540288049824835, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:58:58.853452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 3.0279159545898438e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.1853448275862069}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:25.165134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:25.177624", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.990266799926758e-06, "l2_diff": 0.022216796875, "l2_diff_relative": 0.0029256687242798355}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:28.447821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6815066922307742, "overlap_percentage": 0.8105905202513967, "num_intersection": 148578, "num_union": 218014, "num_only_computed": 34718, "num_only_roped": 34718, "total_diff": 69436, "diff_percentage": 0.31849330776922585, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:28.665648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 0.00016307830810546875, "l2_diff": 0.62109375, "l2_diff_relative": 0.099375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:36.439920", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5672726456257999, "overlap_percentage": 0.7238978453545232, "num_intersection": 151590, "num_union": 267226, "num_only_computed": 57818, "num_only_roped": 57818, "total_diff": 115636, "diff_percentage": 0.4327273543742001, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:39.025300", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.0001354217529296875, "l2_diff": 0.70703125, "l2_diff_relative": 0.11970899470899471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:49.109205", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4917895203559722, "overlap_percentage": 0.6593282948369565, "num_intersection": 155285, "num_union": 315755, "num_only_computed": 80235, "num_only_roped": 80235, "total_diff": 160470, "diff_percentage": 0.5082104796440278, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T09:59:49.474313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 0.0001125335693359375, "l2_diff": 0.8984375, "l2_diff_relative": 0.14743589743589744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:00:01.910855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4315890647356292, "overlap_percentage": 0.6029510498046875, "num_intersection": 158060, "num_union": 366228, "num_only_computed": 104084, "num_only_roped": 104084, "total_diff": 208168, "diff_percentage": 0.5684109352643708, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:00:02.351781", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.0983910891089109}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:00:17.417609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3907237161101073, "overlap_percentage": 0.5618998390319716, "num_intersection": 161971, "num_union": 414541, "num_only_computed": 126285, "num_only_roped": 126285, "total_diff": 252570, "diff_percentage": 0.6092762838898926, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:00:17.952996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.75, "l2_diff_relative": 0.15584415584415584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:00:37.700623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3559520882666287, "overlap_percentage": 0.5250216307003257, "num_intersection": 165050, "num_union": 463686, "num_only_computed": 149318, "num_only_roped": 149318, "total_diff": 298636, "diff_percentage": 0.6440479117333713, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:00:38.326067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 8.296966552734375e-05, "l2_diff": 1.0, "l2_diff_relative": 0.17486338797814208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:00:58.762960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3305041363329074, "overlap_percentage": 0.4968103853383459, "num_intersection": 169154, "num_union": 511806, "num_only_computed": 171326, "num_only_roped": 171326, "total_diff": 342652, "diff_percentage": 0.6694958636670926, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:01:01.365455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 5.364418029785156e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:01:24.773912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32547767591616694, "overlap_percentage": 0.4911100078561452, "num_intersection": 180037, "num_union": 553147, "num_only_computed": 186555, "num_only_roped": 186555, "total_diff": 373110, "diff_percentage": 0.6745223240838331, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:01:25.560480", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.09536082474226804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:01:54.180362", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30445859872611464, "overlap_percentage": 0.466796875, "num_intersection": 183552, "num_union": 602880, "num_only_computed": 209664, "num_only_roped": 209664, "total_diff": 419328, "diff_percentage": 0.6955414012738853, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:01:57.117649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.12165775401069519}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:02:25.446257", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28242509874442057, "overlap_percentage": 0.4404547275641026, "num_intersection": 184695, "num_union": 653961, "num_only_computed": 234633, "num_only_roped": 234633, "total_diff": 469266, "diff_percentage": 0.7175749012555794, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:02:26.393963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.14732142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:02:57.624721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26865140282473166, "overlap_percentage": 0.423522808908046, "num_intersection": 188654, "num_union": 702226, "num_only_computed": 256786, "num_only_roped": 256786, "total_diff": 513572, "diff_percentage": 0.7313485971752683, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:02:58.651328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.81640625, "l2_diff_relative": 0.13397435897435897}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:03:33.194068", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.255174194441376, "overlap_percentage": 0.40659566707383277, "num_intersection": 191731, "num_union": 751373, "num_only_computed": 279821, "num_only_roped": 279821, "total_diff": 559642, "diff_percentage": 0.744825805558624, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:03:34.330322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.12907608695652173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:04:11.302674", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25030996212620826, "overlap_percentage": 0.40039665316358025, "num_intersection": 199263, "num_union": 796065, "num_only_computed": 298401, "num_only_roped": 298401, "total_diff": 596802, "diff_percentage": 0.7496900378737917, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:04:14.404265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:04:54.164572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23312992378315892, "overlap_percentage": 0.3781108856201172, "num_intersection": 198239, "num_union": 850337, "num_only_computed": 326049, "num_only_roped": 326049, "total_diff": 652098, "diff_percentage": 0.7668700762168411, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:04:55.471008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 5.4836273193359375e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.23919753086419754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:05:38.061388", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21418549860139244, "overlap_percentage": 0.35280523255813956, "num_intersection": 194184, "num_union": 906616, "num_only_computed": 356216, "num_only_roped": 356216, "total_diff": 712432, "diff_percentage": 0.7858145013986075, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:05:39.477743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 5.3882598876953125e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.283203125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:06:24.643682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20372489247087316, "overlap_percentage": 0.3384907859680284, "num_intersection": 195144, "num_union": 957880, "num_only_computed": 381368, "num_only_roped": 381368, "total_diff": 762736, "diff_percentage": 0.7962751075291268, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:06:26.098575", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.6015625, "l2_diff_relative": 0.3583916083916084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:07:08.142076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18142427842616535, "overlap_percentage": 0.30712806861875186, "num_intersection": 5192, "num_union": 28618, "num_only_computed": 11713, "num_only_roped": 11713, "total_diff": 23426, "diff_percentage": 0.8185757215738346, "num_computed": 16905, "num_roped": 16905}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 15, "seq_len_k": 8719, "queries_shape": [1, 32, 15, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 15, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:07:10.889031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.1005859375, "l2_diff_relative": 0.09131205673758866}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 15, "seq_len_k": 8719, "queries_shape": [1, 32, 15, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 15, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:07:48.139198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1872316060692814, "overlap_percentage": 0.31540872920183266, "num_intersection": 11772, "num_union": 62874, "num_only_computed": 25551, "num_only_roped": 25551, "total_diff": 51102, "diff_percentage": 0.8127683939307185, "num_computed": 37323, "num_roped": 37323}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:07:51.024779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.35130718954248363}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:08:27.032185", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2012745618693574, "overlap_percentage": 0.33510167992926615, "num_intersection": 379, "num_union": 1883, "num_only_computed": 752, "num_only_roped": 752, "total_diff": 1504, "diff_percentage": 0.7987254381306426, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:08:28.075947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 9.775161743164062e-05, "l2_diff": 0.07763671875, "l2_diff_relative": 0.7162162162162162}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:09:00.232263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20511454448588173, "overlap_percentage": 0.34040671971706454, "num_intersection": 385, "num_union": 1877, "num_only_computed": 746, "num_only_roped": 746, "total_diff": 1492, "diff_percentage": 0.7948854555141183, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:09:01.275605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.35135135135135137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:09:33.536036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1949286846275753, "overlap_percentage": 0.32625994694960214, "num_intersection": 369, "num_union": 1893, "num_only_computed": 762, "num_only_roped": 762, "total_diff": 1524, "diff_percentage": 0.8050713153724247, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:09:34.658055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.053466796875, "l2_diff_relative": 0.27103960396039606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:09:57.384186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:09:57.396622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.0031685890557939913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:00.654009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6728437595542637, "overlap_percentage": 0.8044310841480447, "num_intersection": 147449, "num_union": 219143, "num_only_computed": 35847, "num_only_roped": 35847, "total_diff": 71694, "diff_percentage": 0.3271562404457363, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:00.869275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 0.0001468658447265625, "l2_diff": 0.546875, "l2_diff_relative": 0.09020618556701031}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:08.676543", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5645852401143134, "overlap_percentage": 0.721705952017115, "num_intersection": 151131, "num_union": 267685, "num_only_computed": 58277, "num_only_roped": 58277, "total_diff": 116554, "diff_percentage": 0.4354147598856865, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:08.965640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 0.00014591217041015625, "l2_diff": 0.7734375, "l2_diff_relative": 0.13983050847457626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:19.105148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48796775395967984, "overlap_percentage": 0.6558848505434782, "num_intersection": 154474, "num_union": 316566, "num_only_computed": 81046, "num_only_roped": 81046, "total_diff": 162092, "diff_percentage": 0.5120322460403202, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:19.816598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 0.00010776519775390625, "l2_diff": 0.8046875, "l2_diff_relative": 0.1407103825136612}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:32.115090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4365865287132077, "overlap_percentage": 0.6078109741210938, "num_intersection": 159334, "num_union": 364954, "num_only_computed": 102810, "num_only_roped": 102810, "total_diff": 205620, "diff_percentage": 0.5634134712867923, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:33.446926", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.00011491775512695312, "l2_diff": 0.99609375, "l2_diff_relative": 0.17229729729729729}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:48.139179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40799843694667304, "overlap_percentage": 0.5795438776642984, "num_intersection": 167057, "num_union": 409455, "num_only_computed": 121199, "num_only_roped": 121199, "total_diff": 242398, "diff_percentage": 0.592001563053327, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:10:48.653018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 0.0001010894775390625, "l2_diff": 0.9609375, "l2_diff_relative": 0.18636363636363637}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:11:05.740683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37642543931662104, "overlap_percentage": 0.5469608866042345, "num_intersection": 171947, "num_union": 456789, "num_only_computed": 142421, "num_only_roped": 142421, "total_diff": 284842, "diff_percentage": 0.623574560683379, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:11:06.340857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 8.821487426757812e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.1751453488372093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:11:26.067895", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3384673746611867, "overlap_percentage": 0.5057536419172932, "num_intersection": 172199, "num_union": 508761, "num_only_computed": 168281, "num_only_roped": 168281, "total_diff": 336562, "diff_percentage": 0.6615326253388133, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:11:27.717443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.9609375, "l2_diff_relative": 0.17982456140350878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:11:50.387158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3179201141790951, "overlap_percentage": 0.4824573367667598, "num_intersection": 176865, "num_union": 556319, "num_only_computed": 189727, "num_only_roped": 189727, "total_diff": 379454, "diff_percentage": 0.682079885820905, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:11:51.153952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 7.200241088867188e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.1985759493670886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:12:16.995121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2881684640886874, "overlap_percentage": 0.4474080403645833, "num_intersection": 175928, "num_union": 610504, "num_only_computed": 217288, "num_only_roped": 217288, "total_diff": 434576, "diff_percentage": 0.7118315359113127, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:12:17.847359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.9609375, "l2_diff_relative": 0.20230263157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:12:45.358781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27292044854320596, "overlap_percentage": 0.4288099053724054, "num_intersection": 179812, "num_union": 658844, "num_only_computed": 239516, "num_only_roped": 239516, "total_diff": 479032, "diff_percentage": 0.727079551456794, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:12:46.298672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.22301136363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:13:17.631626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2581575888702313, "overlap_percentage": 0.4103740122126437, "num_intersection": 182797, "num_union": 708083, "num_only_computed": 262643, "num_only_roped": 262643, "total_diff": 525286, "diff_percentage": 0.7418424111297687, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:13:18.636816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.22682119205298013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:13:51.336133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24513520043409895, "overlap_percentage": 0.3937487276058632, "num_intersection": 185673, "num_union": 757431, "num_only_computed": 285879, "num_only_roped": 285879, "total_diff": 571758, "diff_percentage": 0.754864799565901, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:13:52.427179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.17307692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:14:28.145478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22985372652618416, "overlap_percentage": 0.37379034850823045, "num_intersection": 186022, "num_union": 809306, "num_only_computed": 311642, "num_only_roped": 311642, "total_diff": 623284, "diff_percentage": 0.7701462734738158, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:14:29.322277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.507469177246094e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.24542682926829268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:15:09.216358", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2286406606643201, "overlap_percentage": 0.37218475341796875, "num_intersection": 195132, "num_union": 853444, "num_only_computed": 329156, "num_only_roped": 329156, "total_diff": 658312, "diff_percentage": 0.7713593393356799, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:15:10.487915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.10824742268041238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:15:52.598515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21892883085590772, "overlap_percentage": 0.35921511627906977, "num_intersection": 197712, "num_union": 903088, "num_only_computed": 352688, "num_only_roped": 352688, "total_diff": 705376, "diff_percentage": 0.7810711691440922, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:15:54.012355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.16691176470588234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:16:39.566786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21187889871614982, "overlap_percentage": 0.34967008492451157, "num_intersection": 201589, "num_union": 951435, "num_only_computed": 374923, "num_only_roped": 374923, "total_diff": 749846, "diff_percentage": 0.7881211012838502, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:16:41.073609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 5.030632019042969e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.29464285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:17:30.487533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18444092624859101, "overlap_percentage": 0.31143963731945623, "num_intersection": 187681, "num_union": 1017567, "num_only_computed": 414943, "num_only_roped": 414943, "total_diff": 829886, "diff_percentage": 0.815559073751409, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:17:33.682372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 5.14984130859375e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.3078034682080925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:18:25.565524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16312941039356735, "overlap_percentage": 0.2805008779519544, "num_intersection": 176361, "num_union": 1081111, "num_only_computed": 452375, "num_only_roped": 452375, "total_diff": 904750, "diff_percentage": 0.8368705896064327, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:18:29.676984", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.6065573770491803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:19:24.439050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1502074062503565, "overlap_percentage": 0.26118316650390627, "num_intersection": 171169, "num_union": 1139551, "num_only_computed": 484191, "num_only_roped": 484191, "total_diff": 968382, "diff_percentage": 0.8497925937496436, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:19:26.254380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.29425048828125e-05, "l2_diff": 2.0, "l2_diff_relative": 0.45714285714285713}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:20:24.014923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14722932314055778, "overlap_percentage": 0.256669386269722, "num_intersection": 174913, "num_union": 1188031, "num_only_computed": 506559, "num_only_roped": 506559, "total_diff": 1013118, "diff_percentage": 0.8527706768594422, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:20:25.935401", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.793571472167969e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.4318181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:21:27.757430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14289683087700256, "overlap_percentage": 0.2500607701700434, "num_intersection": 176939, "num_union": 1238229, "num_only_computed": 530645, "num_only_roped": 530645, "total_diff": 1061290, "diff_percentage": 0.8571031691229974, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:21:29.754135", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 5.984306335449219e-05, "l2_diff": 1.9765625, "l2_diff_relative": 0.47201492537313433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:22:33.206711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14350104617590562, "overlap_percentage": 0.25098542175505933, "num_intersection": 184147, "num_union": 1283245, "num_only_computed": 549549, "num_only_roped": 549549, "total_diff": 1099098, "diff_percentage": 0.8564989538240944, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:22:35.321564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.6587301587301587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:23:42.623187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1412649763165227, "overlap_percentage": 0.24755859375, "num_intersection": 188097, "num_union": 1331519, "num_only_computed": 571711, "num_only_roped": 571711, "total_diff": 1143422, "diff_percentage": 0.8587350236834773, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:23:44.897535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 7.915496826171875e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.81}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:24:56.577569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14101494546884316, "overlap_percentage": 0.2471745808919271, "num_intersection": 194386, "num_union": 1378478, "num_only_computed": 592046, "num_only_roped": 592046, "total_diff": 1184092, "diff_percentage": 0.8589850545311568, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:24:58.965060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.677078247070312e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.8535353535353535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:26:15.557145", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13845050215208035, "overlap_percentage": 0.2432262129804663, "num_intersection": 197632, "num_union": 1427456, "num_only_computed": 614912, "num_only_roped": 614912, "total_diff": 1229824, "diff_percentage": 0.8615494978479197, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:26:18.057246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.8207547169811321}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:27:35.871719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13547555526070124, "overlap_percentage": 0.2386234642094017, "num_intersection": 200123, "num_union": 1477189, "num_only_computed": 638533, "num_only_roped": 638533, "total_diff": 1277066, "diff_percentage": 0.8645244447392988, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:27:38.493050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2412109375, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.8199052132701422}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:28:59.908972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1361297506084523, "overlap_percentage": 0.2396376831705151, "num_intersection": 207231, "num_union": 1522305, "num_only_computed": 657537, "num_only_roped": 657537, "total_diff": 1315074, "diff_percentage": 0.8638702493915477, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:29:02.621338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.75, "l2_diff_relative": 0.775330396475771}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:30:27.368549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12540976876093507, "overlap_percentage": 0.22286952227011494, "num_intersection": 198550, "num_union": 1583210, "num_only_computed": 692330, "num_only_roped": 692330, "total_diff": 1384660, "diff_percentage": 0.874590231239065, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:30:30.799861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.375, "l2_diff_relative": 0.6359832635983264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:31:58.674745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12251236134585893, "overlap_percentage": 0.21828242710658483, "num_intersection": 200275, "num_union": 1634733, "num_only_computed": 717229, "num_only_roped": 717229, "total_diff": 1434458, "diff_percentage": 0.877487638654141, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:32:01.594224", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 5.53131103515625e-05, "l2_diff": 2.375, "l2_diff_relative": 0.5891472868217055}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:33:34.357454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1267675597704471, "overlap_percentage": 0.22501102143244708, "num_intersection": 212324, "num_union": 1674908, "num_only_computed": 731292, "num_only_roped": 731292, "total_diff": 1462584, "diff_percentage": 0.8732324402295529, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:33:37.525909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 5.984306335449219e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.7759336099585062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:35:10.926799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12267133336162642, "overlap_percentage": 0.21853472110009325, "num_intersection": 147415, "num_union": 1201707, "num_only_computed": 527146, "num_only_roped": 527146, "total_diff": 1054292, "diff_percentage": 0.8773286666383736, "num_computed": 674561, "num_roped": 674561}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 359, "seq_len_k": 16231, "queries_shape": [1, 32, 359, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 359, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:35:14.018298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.412101745605469e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.6255707762557078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 359, "seq_len_k": 16231, "queries_shape": [1, 32, 359, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 359, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:36:41.308770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11459875629256737, "overlap_percentage": 0.20563230605738575, "num_intersection": 13158, "num_union": 114818, "num_only_computed": 50830, "num_only_roped": 50830, "total_diff": 101660, "diff_percentage": 0.8854012437074327, "num_computed": 63988, "num_roped": 63988}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:36:43.851042", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 4.57763671875e-05, "l2_diff": 0.474609375, "l2_diff_relative": 0.4278169014084507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:37:54.554364", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11957168352171327, "overlap_percentage": 0.21360255047821466, "num_intersection": 402, "num_union": 3362, "num_only_computed": 1480, "num_only_roped": 1480, "total_diff": 2960, "diff_percentage": 0.8804283164782868, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:37:56.502131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.05908203125, "l2_diff_relative": 0.2965686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:38:57.928738", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10446009389671361, "overlap_percentage": 0.1891604675876727, "num_intersection": 356, "num_union": 3408, "num_only_computed": 1526, "num_only_roped": 1526, "total_diff": 3052, "diff_percentage": 0.8955399061032864, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:38:59.863356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.2932098765432099}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:39:59.854228", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10901591043017089, "overlap_percentage": 0.19659936238044634, "num_intersection": 370, "num_union": 3394, "num_only_computed": 1512, "num_only_roped": 1512, "total_diff": 3024, "diff_percentage": 0.8909840895698291, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:40:02.904440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.728534698486328e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.11607142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:41:03.085187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12224209898628503, "overlap_percentage": 0.21785334750265675, "num_intersection": 410, "num_union": 3354, "num_only_computed": 1472, "num_only_roped": 1472, "total_diff": 2944, "diff_percentage": 0.877757901013715, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:41:05.034431", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.0546875, "l2_diff_relative": 0.22310756972111553}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:42:04.921560", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11585185185185186, "overlap_percentage": 0.20764737121614446, "num_intersection": 391, "num_union": 3375, "num_only_computed": 1492, "num_only_roped": 1492, "total_diff": 2984, "diff_percentage": 0.8841481481481481, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:42:07.956027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.0791015625, "l2_diff_relative": 0.43315508021390375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:43:07.996134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11387163561076605, "overlap_percentage": 0.20446096654275092, "num_intersection": 385, "num_union": 3381, "num_only_computed": 1498, "num_only_roped": 1498, "total_diff": 2996, "diff_percentage": 0.8861283643892339, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:43:09.944438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.23202614379084968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:44:12.275392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12317327766179541, "overlap_percentage": 0.21933085501858737, "num_intersection": 413, "num_union": 3353, "num_only_computed": 1470, "num_only_roped": 1470, "total_diff": 2940, "diff_percentage": 0.8768267223382046, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:44:14.299774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0120849609375, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.0996900826446281}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:44:53.176478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:44:53.190031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.0238037109375, "l2_diff_relative": 0.0030964176829268294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:44:56.453824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6859533018455751, "overlap_percentage": 0.8137275226955307, "num_intersection": 149153, "num_union": 217439, "num_only_computed": 34143, "num_only_roped": 34143, "total_diff": 68286, "diff_percentage": 0.31404669815442493, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:44:56.672419", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 0.00012493133544921875, "l2_diff": 0.51171875, "l2_diff_relative": 0.07651869158878505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:04.429944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5613364051863615, "overlap_percentage": 0.7190460727383863, "num_intersection": 150574, "num_union": 268242, "num_only_computed": 58834, "num_only_roped": 58834, "total_diff": 117668, "diff_percentage": 0.4386635948136384, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:04.715298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 0.00014495849609375, "l2_diff": 0.79296875, "l2_diff_relative": 0.12880710659898478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:14.848499", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4849375181266787, "overlap_percentage": 0.6531419836956521, "num_intersection": 153828, "num_union": 317212, "num_only_computed": 81692, "num_only_roped": 81692, "total_diff": 163384, "diff_percentage": 0.5150624818733213, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:17.331730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 0.00011491775512695312, "l2_diff": 0.90234375, "l2_diff_relative": 0.14224137931034483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:29.777812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4349076717180149, "overlap_percentage": 0.6061820983886719, "num_intersection": 158907, "num_union": 365381, "num_only_computed": 103237, "num_only_roped": 103237, "total_diff": 206474, "diff_percentage": 0.5650923282819851, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:31.645329", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.11761083743842364}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:46.419763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39211401333407386, "overlap_percentage": 0.5633360623889876, "num_intersection": 162385, "num_union": 414127, "num_only_computed": 125871, "num_only_roped": 125871, "total_diff": 251742, "diff_percentage": 0.6078859866659262, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:45:46.931644", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 7.200241088867188e-05, "l2_diff": 0.8046875, "l2_diff_relative": 0.12320574162679426}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:46:04.201709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36998324388750525, "overlap_percentage": 0.5401281300895765, "num_intersection": 169799, "num_union": 458937, "num_only_computed": 144569, "num_only_roped": 144569, "total_diff": 289138, "diff_percentage": 0.6300167561124947, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:46:04.810218", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.46484375, "l2_diff_relative": 0.07083333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:46:24.604767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34538521569905856, "overlap_percentage": 0.5134369125939849, "num_intersection": 174815, "num_union": 506145, "num_only_computed": 165665, "num_only_roped": 165665, "total_diff": 331330, "diff_percentage": 0.6546147843009414, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:46:25.847131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.498046875, "l2_diff_relative": 0.09265988372093023}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:46:48.829170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3201626291472053, "overlap_percentage": 0.4850351344273743, "num_intersection": 177810, "num_union": 555374, "num_only_computed": 188782, "num_only_roped": 188782, "total_diff": 377564, "diff_percentage": 0.6798373708527947, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:46:49.601519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.1132596685082873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:47:15.112810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29138792279574766, "overlap_percentage": 0.4512786865234375, "num_intersection": 177450, "num_union": 608982, "num_only_computed": 215766, "num_only_roped": 215766, "total_diff": 431532, "diff_percentage": 0.7086120772042523, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:47:15.950378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.6702880859375e-05, "l2_diff": 0.490234375, "l2_diff_relative": 0.07505980861244019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:47:43.408728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.273486791455787, "overlap_percentage": 0.4295086423992674, "num_intersection": 180105, "num_union": 658551, "num_only_computed": 239223, "num_only_roped": 239223, "total_diff": 478446, "diff_percentage": 0.726513208544213, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:47:44.342228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.10328638497652583}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:48:15.610037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25496383216999935, "overlap_percentage": 0.4063285739942529, "num_intersection": 180995, "num_union": 709885, "num_only_computed": 264445, "num_only_roped": 264445, "total_diff": 528890, "diff_percentage": 0.7450361678300006, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:48:16.627034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.09491978609625669}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:48:49.726205", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24595768967052478, "overlap_percentage": 0.39480905605320304, "num_intersection": 186173, "num_union": 756931, "num_only_computed": 285379, "num_only_roped": 285379, "total_diff": 570758, "diff_percentage": 0.7540423103294752, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:48:50.856256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.15684713375796178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:49:26.827194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23161903913401785, "overlap_percentage": 0.37612123842592593, "num_intersection": 187182, "num_union": 808146, "num_only_computed": 310482, "num_only_roped": 310482, "total_diff": 620964, "diff_percentage": 0.7683809608659822, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:49:28.111231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.00543212890625e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.1849112426035503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:50:07.148274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21973678394368099, "overlap_percentage": 0.3603019714355469, "num_intersection": 188902, "num_union": 859674, "num_only_computed": 335386, "num_only_roped": 335386, "total_diff": 670772, "diff_percentage": 0.780263216056319, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:50:08.455881", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.16794478527607362}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:50:50.731669", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20380344146932258, "overlap_percentage": 0.33859920058139537, "num_intersection": 186365, "num_union": 914435, "num_only_computed": 364035, "num_only_roped": 364035, "total_diff": 728070, "diff_percentage": 0.7961965585306774, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:50:52.117631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.22916666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:51:37.038038", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20019652418663136, "overlap_percentage": 0.3336062388987567, "num_intersection": 192328, "num_union": 960696, "num_only_computed": 384184, "num_only_roped": 384184, "total_diff": 768368, "diff_percentage": 0.7998034758133686, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:51:40.365110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 5.555152893066406e-05, "l2_diff": 1.4765625, "l2_diff_relative": 0.3236301369863014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:52:28.926906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.183847587166786, "overlap_percentage": 0.3105933384664401, "num_intersection": 187171, "num_union": 1018077, "num_only_computed": 415453, "num_only_roped": 415453, "total_diff": 830906, "diff_percentage": 0.8161524128332139, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:52:30.552197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 7.963180541992188e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.57421875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:53:23.208876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1650389729269488, "overlap_percentage": 0.28331923096498374, "num_intersection": 178133, "num_union": 1079339, "num_only_computed": 450603, "num_only_roped": 450603, "total_diff": 901206, "diff_percentage": 0.8349610270730512, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:53:24.984327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 0.00010347366333007812, "l2_diff": 3.109375, "l2_diff_relative": 1.0101522842639594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:54:20.799543", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15959671740138226, "overlap_percentage": 0.275262451171875, "num_intersection": 180396, "num_union": 1130324, "num_only_computed": 474964, "num_only_roped": 474964, "total_diff": 949928, "diff_percentage": 0.8404032825986177, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:54:24.412686", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 8.630752563476562e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.73046875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:55:23.213507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15567290823512253, "overlap_percentage": 0.2694065200037566, "num_intersection": 183593, "num_union": 1179351, "num_only_computed": 497879, "num_only_roped": 497879, "total_diff": 995758, "diff_percentage": 0.8443270917648774, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:55:25.107057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 7.677078247070312e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.7192307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:56:25.944291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14993446557959975, "overlap_percentage": 0.260770452695369, "num_intersection": 184517, "num_union": 1230651, "num_only_computed": 523067, "num_only_roped": 523067, "total_diff": 1046134, "diff_percentage": 0.8500655344204002, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:56:30.104166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.6867469879518072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:57:33.807711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14452851704205544, "overlap_percentage": 0.2525555543440335, "num_intersection": 185299, "num_union": 1282093, "num_only_computed": 548397, "num_only_roped": 548397, "total_diff": 1096794, "diff_percentage": 0.8554714829579445, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:57:36.868979", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.866455078125e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.5985915492957746}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:58:44.046003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1422755519073681, "overlap_percentage": 0.24910898542789758, "num_intersection": 189275, "num_union": 1330341, "num_only_computed": 570533, "num_only_roped": 570533, "total_diff": 1141066, "diff_percentage": 0.8577244480926319, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:58:47.149072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.915496826171875e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.8571428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T10:59:57.680104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14311379726108636, "overlap_percentage": 0.2503929138183594, "num_intersection": 196917, "num_union": 1375947, "num_only_computed": 589515, "num_only_roped": 589515, "total_diff": 1179030, "diff_percentage": 0.8568862027389136, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:00:00.038245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.7874396135265701}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:01:13.866158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14603746387532915, "overlap_percentage": 0.2548563523944549, "num_intersection": 207082, "num_union": 1418006, "num_only_computed": 605462, "num_only_roped": 605462, "total_diff": 1210924, "diff_percentage": 0.8539625361246709, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:01:17.113775", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.848780487804878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:02:35.879507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14557267637820498, "overlap_percentage": 0.25414830395299143, "num_intersection": 213143, "num_union": 1464169, "num_only_computed": 625513, "num_only_roped": 625513, "total_diff": 1251026, "diff_percentage": 0.8544273236217951, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:02:38.825077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.0625, "l2_diff_relative": 0.9607843137254902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:03:59.804664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13613945287763451, "overlap_percentage": 0.23965271610420366, "num_intersection": 207244, "num_union": 1522292, "num_only_computed": 657524, "num_only_roped": 657524, "total_diff": 1315048, "diff_percentage": 0.8638605471223655, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:04:02.521063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.8026315789473685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:05:26.952339", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13221934716411385, "overlap_percentage": 0.2335578304597701, "num_intersection": 208072, "num_union": 1573688, "num_only_computed": 682808, "num_only_roped": 682808, "total_diff": 1365616, "diff_percentage": 0.8677806528358861, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:05:29.891600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 6.866455078125e-05, "l2_diff": 2.875, "l2_diff_relative": 0.8518518518518519}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:07:00.063804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12593756135872766, "overlap_percentage": 0.22370256696428573, "num_intersection": 205248, "num_union": 1629760, "num_only_computed": 712256, "num_only_roped": 712256, "total_diff": 1424512, "diff_percentage": 0.8740624386412723, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:07:02.974929", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.9689119170984456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:08:34.453382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1286574004826984, "overlap_percentage": 0.22798308933725123, "num_intersection": 209019, "num_union": 1624617, "num_only_computed": 707799, "num_only_roped": 707799, "total_diff": 1415598, "diff_percentage": 0.8713425995173016, "num_computed": 916818, "num_roped": 916818}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 498, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:08:37.580335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.875, "l2_diff_relative": 0.8177777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 498, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:10:00.882125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12135280841061384, "overlap_percentage": 0.21644001334890706, "num_intersection": 10377, "num_union": 85511, "num_only_computed": 37567, "num_only_roped": 37567, "total_diff": 75134, "diff_percentage": 0.8786471915893862, "num_computed": 47944, "num_roped": 47944}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:10:04.106248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08837890625, "mean_diff": 4.9591064453125e-05, "l2_diff": 0.40234375, "l2_diff_relative": 0.40551181102362205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:11:09.663234", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12267884322678843, "overlap_percentage": 0.2185466377440347, "num_intersection": 403, "num_union": 3285, "num_only_computed": 1441, "num_only_roped": 1441, "total_diff": 2882, "diff_percentage": 0.8773211567732115, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:11:13.673959", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.059326171875, "l2_diff_relative": 0.38207547169811323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:12:09.619689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11487303506650544, "overlap_percentage": 0.20607375271149675, "num_intersection": 380, "num_union": 3308, "num_only_computed": 1464, "num_only_roped": 1464, "total_diff": 2928, "diff_percentage": 0.8851269649334945, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 1, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:12:11.446841", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.064453125, "l2_diff_relative": 0.37714285714285717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 1, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:12:46.533481", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:12:47.636006", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.023681640625, "l2_diff_relative": 0.002960205078125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:12:51.004063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6888581761223597, "overlap_percentage": 0.815767938198324, "num_intersection": 149527, "num_union": 217065, "num_only_computed": 33769, "num_only_roped": 33769, "total_diff": 67538, "diff_percentage": 0.31114182387764033, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:12:51.224404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.00013446807861328125, "l2_diff": 0.55078125, "l2_diff_relative": 0.08555825242718447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:12:59.728456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.56683289624805, "overlap_percentage": 0.7235396928484108, "num_intersection": 151515, "num_union": 267301, "num_only_computed": 57893, "num_only_roped": 57893, "total_diff": 115786, "diff_percentage": 0.43316710375195006, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:13:01.520593", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 0.00010919570922851562, "l2_diff": 0.625, "l2_diff_relative": 0.10101010101010101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:13:11.800109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48721138393632374, "overlap_percentage": 0.6552012567934783, "num_intersection": 154313, "num_union": 316727, "num_only_computed": 81207, "num_only_roped": 81207, "total_diff": 162414, "diff_percentage": 0.5127886160636763, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:13:12.174717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.00013065338134765625, "l2_diff": 0.95703125, "l2_diff_relative": 0.15867875647668395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:13:27.009754", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4406564025906579, "overlap_percentage": 0.6117439270019531, "num_intersection": 160365, "num_union": 363923, "num_only_computed": 101779, "num_only_roped": 101779, "total_diff": 203558, "diff_percentage": 0.5593435974093421, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:13:29.384506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.00012302398681640625, "l2_diff": 0.99609375, "l2_diff_relative": 0.18110795454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:13:44.495217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3939821844805741, "overlap_percentage": 0.5652614342806395, "num_intersection": 162940, "num_union": 413572, "num_only_computed": 125316, "num_only_roped": 125316, "total_diff": 250632, "diff_percentage": 0.6060178155194259, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:13:45.032205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 9.584426879882812e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.16835260115606937}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:14:03.212025", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3670997271175569, "overlap_percentage": 0.5370489362785016, "num_intersection": 168831, "num_union": 459905, "num_only_computed": 145537, "num_only_roped": 145537, "total_diff": 291074, "diff_percentage": 0.6329002728824431, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:14:03.829155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 9.584426879882812e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.20426829268292682}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:14:23.844691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3472777850322693, "overlap_percentage": 0.5155251409774436, "num_intersection": 175526, "num_union": 505434, "num_only_computed": 164954, "num_only_roped": 164954, "total_diff": 329908, "diff_percentage": 0.6527222149677308, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:14:24.528874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.8515625, "l2_diff_relative": 0.1505524861878453}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:14:47.650454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3218906405504031, "overlap_percentage": 0.4870155377094972, "num_intersection": 178536, "num_union": 554648, "num_only_computed": 188056, "num_only_roped": 188056, "total_diff": 376112, "diff_percentage": 0.6781093594495968, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:14:50.831501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.8671875, "l2_diff_relative": 0.15589887640449437}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:15:16.403155", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29834461194052025, "overlap_percentage": 0.45957692464192706, "num_intersection": 180713, "num_union": 605719, "num_only_computed": 212503, "num_only_roped": 212503, "total_diff": 425006, "diff_percentage": 0.7016553880594797, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:15:17.998280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06494140625, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.9453125, "l2_diff_relative": 0.1671270718232044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:15:45.981211", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2710645250270534, "overlap_percentage": 0.42651575854700857, "num_intersection": 178850, "num_union": 659806, "num_only_computed": 240478, "num_only_roped": 240478, "total_diff": 480956, "diff_percentage": 0.7289354749729466, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:15:46.930776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.20481927710843373}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:16:17.866263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25382108054246677, "overlap_percentage": 0.4048760775862069, "num_intersection": 180348, "num_union": 710532, "num_only_computed": 265092, "num_only_roped": 265092, "total_diff": 530184, "diff_percentage": 0.7461789194575332, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:16:18.897600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 6.008148193359375e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.2196969696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:16:53.053954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24123335772533205, "overlap_percentage": 0.3886994435396308, "num_intersection": 183292, "num_union": 759812, "num_only_computed": 288260, "num_only_roped": 288260, "total_diff": 576520, "diff_percentage": 0.758766642274668, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:16:54.181580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.21929824561403508}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:17:30.856364", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23859869187348803, "overlap_percentage": 0.38527199074074076, "num_intersection": 191736, "num_union": 803592, "num_only_computed": 305928, "num_only_roped": 305928, "total_diff": 611856, "diff_percentage": 0.761401308126512, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:17:34.338416", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.18979057591623036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:18:13.304681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24228117710198052, "overlap_percentage": 0.3900585174560547, "num_intersection": 204503, "num_union": 844073, "num_only_computed": 319785, "num_only_roped": 319785, "total_diff": 639570, "diff_percentage": 0.7577188228980195, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:18:16.373422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.1580188679245283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:18:57.792442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2208958633945297, "overlap_percentage": 0.36185864825581393, "num_intersection": 199167, "num_union": 901633, "num_only_computed": 351233, "num_only_roped": 351233, "total_diff": 702466, "diff_percentage": 0.7791041366054703, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:18:59.179668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.12918994413407822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:19:43.982801", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20241562669786833, "overlap_percentage": 0.33668163021758435, "num_intersection": 194101, "num_union": 958923, "num_only_computed": 382411, "num_only_roped": 382411, "total_diff": 764822, "diff_percentage": 0.7975843733021316, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:19:45.441319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.078315734863281e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.3029197080291971}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:20:32.781771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1830806184520637, "overlap_percentage": 0.30949812818606626, "num_intersection": 186511, "num_union": 1018737, "num_only_computed": 416113, "num_only_roped": 416113, "total_diff": 832226, "diff_percentage": 0.8169193815479363, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:20:34.370977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.8359375, "l2_diff_relative": 0.4681274900398406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:21:24.914237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16354161269070477, "overlap_percentage": 0.28111003664495116, "num_intersection": 176744, "num_union": 1080728, "num_only_computed": 451992, "num_only_roped": 451992, "total_diff": 903984, "diff_percentage": 0.8364583873092952, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:21:27.471856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 8.392333984375e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.7035398230088495}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:22:21.518705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15099018595404187, "overlap_percentage": 0.26236572265625, "num_intersection": 171944, "num_union": 1138776, "num_only_computed": 483416, "num_only_roped": 483416, "total_diff": 966832, "diff_percentage": 0.8490098140459581, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:22:23.297740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.375, "l2_diff_relative": 0.5671641791044776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:23:21.008672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15198550281204198, "overlap_percentage": 0.26386704075882794, "num_intersection": 179818, "num_union": 1183126, "num_only_computed": 501654, "num_only_roped": 501654, "total_diff": 1003308, "diff_percentage": 0.848014497187958, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:23:22.953461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.869171142578125e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.9068627450980392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:24:24.990331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14823634795463747, "overlap_percentage": 0.25819831991678727, "num_intersection": 182697, "num_union": 1232471, "num_only_computed": 524887, "num_only_roped": 524887, "total_diff": 1049774, "diff_percentage": 0.8517636520453625, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:24:27.010066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 8.58306884765625e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.8457943925233645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:25:31.718585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14568036951789656, "overlap_percentage": 0.2543124127704117, "num_intersection": 186588, "num_union": 1280804, "num_only_computed": 547108, "num_only_roped": 547108, "total_diff": 1094216, "diff_percentage": 0.8543196304821035, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:25:33.878915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2021484375, "mean_diff": 8.630752563476562e-05, "l2_diff": 3.15625, "l2_diff_relative": 0.9017857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:26:41.965798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14505482581726334, "overlap_percentage": 0.2533587432614555, "num_intersection": 192504, "num_union": 1327112, "num_only_computed": 567304, "num_only_roped": 567304, "total_diff": 1134608, "diff_percentage": 0.8549451741827366, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:26:44.283211", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.7300884955752213}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:27:55.640835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14280565973851972, "overlap_percentage": 0.2499211629231771, "num_intersection": 196546, "num_union": 1376318, "num_only_computed": 589886, "num_only_roped": 589886, "total_diff": 1179772, "diff_percentage": 0.8571943402614802, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:27:58.008963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 8.726119995117188e-05, "l2_diff": 3.125, "l2_diff_relative": 1.0471204188481675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:29:14.050916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13989667834559094, "overlap_percentage": 0.24545501535916825, "num_intersection": 199443, "num_union": 1425645, "num_only_computed": 613101, "num_only_roped": 613101, "total_diff": 1226202, "diff_percentage": 0.8601033216544091, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:29:16.553333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.267578125, "mean_diff": 8.58306884765625e-05, "l2_diff": 3.328125, "l2_diff_relative": 1.0812182741116751}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:30:36.029597", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1388399843837523, "overlap_percentage": 0.24382702800671552, "num_intersection": 204487, "num_union": 1472825, "num_only_computed": 634169, "num_only_roped": 634169, "total_diff": 1268338, "diff_percentage": 0.8611600156162477, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:30:39.032224", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.8717948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:32:00.721952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13152280368438923, "overlap_percentage": 0.23247044293960922, "num_intersection": 201033, "num_union": 1528503, "num_only_computed": 663735, "num_only_roped": 663735, "total_diff": 1327470, "diff_percentage": 0.8684771963156107, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:32:03.475867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.8240740740740741}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:33:29.462723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12588907930056567, "overlap_percentage": 0.2236260775862069, "num_intersection": 199224, "num_union": 1582536, "num_only_computed": 691656, "num_only_roped": 691656, "total_diff": 1383312, "diff_percentage": 0.8741109206994343, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:33:32.220428", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.6356589147286822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:35:03.367350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12346901228830967, "overlap_percentage": 0.2197995867047991, "num_intersection": 201667, "num_union": 1633341, "num_only_computed": 715837, "num_only_roped": 715837, "total_diff": 1431674, "diff_percentage": 0.8765309877116904, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:35:06.342974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.8773584905660378}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:36:34.412663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1221028438512447, "overlap_percentage": 0.21763217965327905, "num_intersection": 35276, "num_union": 288904, "num_only_computed": 126814, "num_only_roped": 126814, "total_diff": 253628, "diff_percentage": 0.8778971561487553, "num_computed": 162090, "num_roped": 162090}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:36:37.134327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 6.29425048828125e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.6772727272727272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:37:57.652673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.113227372037559, "overlap_percentage": 0.20342182537304487, "num_intersection": 13578, "num_union": 119918, "num_only_computed": 53170, "num_only_roped": 53170, "total_diff": 106340, "diff_percentage": 0.886772627962441, "num_computed": 66748, "num_roped": 66748}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:38:00.138012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.7695652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:39:06.858406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11702786377708978, "overlap_percentage": 0.20953436807095344, "num_intersection": 378, "num_union": 3230, "num_only_computed": 1426, "num_only_roped": 1426, "total_diff": 2852, "diff_percentage": 0.8829721362229103, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:39:08.752925", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 8.20159912109375e-05, "l2_diff": 0.1279296875, "l2_diff_relative": 1.6582278481012658}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:40:04.322494", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12433779993767528, "overlap_percentage": 0.2211751662971175, "num_intersection": 399, "num_union": 3209, "num_only_computed": 1405, "num_only_roped": 1405, "total_diff": 2810, "diff_percentage": 0.8756622000623248, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:40:06.106329", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 5.125999450683594e-05, "l2_diff": 0.09033203125, "l2_diff_relative": 0.5346820809248555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:01.052485", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1242603550295858, "overlap_percentage": 0.22105263157894736, "num_intersection": 399, "num_union": 3211, "num_only_computed": 1406, "num_only_roped": 1406, "total_diff": 2812, "diff_percentage": 0.8757396449704142, "num_computed": 1805, "num_roped": 1805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:02.801802", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.06591796875, "l2_diff_relative": 0.2848101265822785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:36.129991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:36.142319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.3478946685791016e-06, "l2_diff": 0.022216796875, "l2_diff_relative": 0.003077651515151515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:39.428970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6790422013978583, "overlap_percentage": 0.8088447101955307, "num_intersection": 148258, "num_union": 218334, "num_only_computed": 35038, "num_only_roped": 35038, "total_diff": 70076, "diff_percentage": 0.3209577986021417, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:39.645237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 0.000148773193359375, "l2_diff": 0.53515625, "l2_diff_relative": 0.09206989247311828}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:47.417074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5729292246446209, "overlap_percentage": 0.728486972799511, "num_intersection": 152551, "num_union": 266265, "num_only_computed": 56857, "num_only_roped": 56857, "total_diff": 113714, "diff_percentage": 0.427070775355379, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:47.701423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 0.00015354156494140625, "l2_diff": 0.87109375, "l2_diff_relative": 0.139375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:41:57.760326", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5058390263707246, "overlap_percentage": 0.6718367866847826, "num_intersection": 158231, "num_union": 312809, "num_only_computed": 77289, "num_only_roped": 77289, "total_diff": 154578, "diff_percentage": 0.49416097362927536, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:42:00.387904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 0.0001277923583984375, "l2_diff": 0.95703125, "l2_diff_relative": 0.16034031413612565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:42:12.759461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45361387826848804, "overlap_percentage": 0.6241188049316406, "num_intersection": 163609, "num_union": 360679, "num_only_computed": 98535, "num_only_roped": 98535, "total_diff": 197070, "diff_percentage": 0.5463861217315119, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:42:14.560582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 9.5367431640625e-05, "l2_diff": 0.8671875, "l2_diff_relative": 0.15416666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:42:29.225516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42057861808791386, "overlap_percentage": 0.5921229740230906, "num_intersection": 170683, "num_union": 405829, "num_only_computed": 117573, "num_only_roped": 117573, "total_diff": 235146, "diff_percentage": 0.5794213819120861, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:42:29.736050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.14325842696629212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:42:46.974543", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3700996735658033, "overlap_percentage": 0.5402521885179153, "num_intersection": 169838, "num_union": 458898, "num_only_computed": 144530, "num_only_roped": 144530, "total_diff": 289060, "diff_percentage": 0.6299003264341967, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:42:47.589643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.1183252427184466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:43:07.291366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3368828578384024, "overlap_percentage": 0.5039826127819549, "num_intersection": 171596, "num_union": 509364, "num_only_computed": 168884, "num_only_roped": 168884, "total_diff": 337768, "diff_percentage": 0.6631171421615976, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:43:09.905010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.07733585858585859}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:43:32.545411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3140934761685417, "overlap_percentage": 0.47803825506284914, "num_intersection": 175245, "num_union": 557939, "num_only_computed": 191347, "num_only_roped": 191347, "total_diff": 382694, "diff_percentage": 0.6859065238314582, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:43:33.309597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.10902777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:43:58.799526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2930313313866309, "overlap_percentage": 0.4532470703125, "num_intersection": 178224, "num_union": 608208, "num_only_computed": 214992, "num_only_roped": 214992, "total_diff": 429984, "diff_percentage": 0.7069686686133692, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:43:59.655096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 5.6743621826171875e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.1712121212121212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:44:27.670278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28173715291787405, "overlap_percentage": 0.439617673992674, "num_intersection": 184344, "num_union": 654312, "num_only_computed": 234984, "num_only_roped": 234984, "total_diff": 469968, "diff_percentage": 0.718262847082126, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:44:30.647542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.875, "l2_diff_relative": 0.16091954022988506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:45:01.453652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26965305726892336, "overlap_percentage": 0.42476652298850576, "num_intersection": 189208, "num_union": 701672, "num_only_computed": 256232, "num_only_roped": 256232, "total_diff": 512464, "diff_percentage": 0.7303469427310766, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:45:02.474738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.16032608695652173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:45:35.948457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2493181170891316, "overlap_percentage": 0.3991267134907709, "num_intersection": 188209, "num_union": 754895, "num_only_computed": 283343, "num_only_roped": 283343, "total_diff": 566686, "diff_percentage": 0.7506818829108683, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:45:38.951413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.1172279792746114}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:46:15.520011", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24366564290694448, "overlap_percentage": 0.3918507265946502, "num_intersection": 195010, "num_union": 800318, "num_only_computed": 302654, "num_only_roped": 302654, "total_diff": 605308, "diff_percentage": 0.7563343570930555, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:46:16.729839", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.09}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:46:55.414617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2289560198072021, "overlap_percentage": 0.3726024627685547, "num_intersection": 195351, "num_union": 853225, "num_only_computed": 328937, "num_only_roped": 328937, "total_diff": 657874, "diff_percentage": 0.771043980192798, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:46:56.684236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.13743093922651933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:47:37.804599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21789446316057332, "overlap_percentage": 0.3578215843023256, "num_intersection": 196945, "num_union": 903855, "num_only_computed": 353455, "num_only_roped": 353455, "total_diff": 706910, "diff_percentage": 0.7821055368394266, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:47:39.178699", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.20186335403726707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:48:23.449240", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19938253369227377, "overlap_percentage": 0.33247529973357015, "num_intersection": 191676, "num_union": 961348, "num_only_computed": 384836, "num_only_roped": 384836, "total_diff": 769672, "diff_percentage": 0.8006174663077262, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:48:25.413577", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 1.375, "l2_diff_relative": 0.2913907284768212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:49:13.946721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1812196302808274, "overlap_percentage": 0.306834775913339, "num_intersection": 184906, "num_union": 1020342, "num_only_computed": 417718, "num_only_roped": 417718, "total_diff": 835436, "diff_percentage": 0.8187803697191726, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:49:15.585193", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 5.602836608886719e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.3503787878787879}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:50:08.554874", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16388515830578976, "overlap_percentage": 0.28161740380700323, "num_intersection": 177063, "num_union": 1080409, "num_only_computed": 451673, "num_only_roped": 451673, "total_diff": 903346, "diff_percentage": 0.8361148416942102, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:50:10.248086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 8.0108642578125e-05, "l2_diff": 2.609375, "l2_diff_relative": 0.6374045801526718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:51:05.844840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15296042504156293, "overlap_percentage": 0.2653350830078125, "num_intersection": 173890, "num_union": 1136830, "num_only_computed": 481470, "num_only_roped": 481470, "total_diff": 962940, "diff_percentage": 0.8470395749584371, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:51:08.391996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.25, "l2_diff_relative": 0.5950413223140496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:51:58.523282", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14814376143287666, "overlap_percentage": 0.25805786071248454, "num_intersection": 11257, "num_union": 75987, "num_only_computed": 32365, "num_only_roped": 32365, "total_diff": 64730, "diff_percentage": 0.8518562385671233, "num_computed": 43622, "num_roped": 43622}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "mask_shape": [1, 32, 34, 10274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:51:59.922035", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 4.00543212890625e-05, "l2_diff": 0.3203125, "l2_diff_relative": 0.22527472527472528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "attention_shape": [1, 32, 34, 10274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:52:45.583978", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15209439104863004, "overlap_percentage": 0.26403112840466925, "num_intersection": 8482, "num_union": 55768, "num_only_computed": 23643, "num_only_roped": 23643, "total_diff": 47286, "diff_percentage": 0.84790560895137, "num_computed": 32125, "num_roped": 32125}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 25, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:52:47.188162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 7.2479248046875e-05, "l2_diff": 0.4453125, "l2_diff_relative": 0.4596774193548387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 25, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:53:32.308932", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1559550561797753, "overlap_percentage": 0.2698289269051322, "num_intersection": 347, "num_union": 2225, "num_only_computed": 939, "num_only_roped": 939, "total_diff": 1878, "diff_percentage": 0.8440449438202248, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "mask_shape": [1, 32, 1, 10300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:53:33.617773", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033447265625, "mean_diff": 9.012222290039062e-05, "l2_diff": 0.08203125, "l2_diff_relative": 0.875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "attention_shape": [1, 32, 1, 10300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:54:14.221859", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14821428571428572, "overlap_percentage": 0.2581648522550544, "num_intersection": 332, "num_union": 2240, "num_only_computed": 954, "num_only_roped": 954, "total_diff": 1908, "diff_percentage": 0.8517857142857143, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "mask_shape": [1, 32, 1, 10301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:54:15.546773", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.042236328125, "mean_diff": 0.00010395050048828125, "l2_diff": 0.09375, "l2_diff_relative": 1.1636363636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "attention_shape": [1, 32, 1, 10301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:54:53.968713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15699505173189385, "overlap_percentage": 0.2713841368584759, "num_intersection": 349, "num_union": 2223, "num_only_computed": 937, "num_only_roped": 937, "total_diff": 1874, "diff_percentage": 0.8430049482681061, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "mask_shape": [1, 32, 1, 10302], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:54:55.187496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 5.340576171875e-05, "l2_diff": 0.054443359375, "l2_diff_relative": 0.34627329192546585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "attention_shape": [1, 32, 1, 10302]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:20.489600", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:20.503151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.811452865600586e-06, "l2_diff": 0.023193359375, "l2_diff_relative": 0.003017022357723577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:23.846729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6798192757282354, "overlap_percentage": 0.8093957314944135, "num_intersection": 148359, "num_union": 218233, "num_only_computed": 34937, "num_only_roped": 34937, "total_diff": 69874, "diff_percentage": 0.3201807242717646, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:24.068186", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 0.00014972686767578125, "l2_diff": 0.5625, "l2_diff_relative": 0.09375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:31.954369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5578923875239459, "overlap_percentage": 0.7162142802567237, "num_intersection": 149981, "num_union": 268835, "num_only_computed": 59427, "num_only_roped": 59427, "total_diff": 118854, "diff_percentage": 0.44210761247605407, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:32.251194", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.00018215179443359375, "l2_diff": 0.82421875, "l2_diff_relative": 0.17016129032258065}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:42.518036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48043384656967664, "overlap_percentage": 0.6490446671195652, "num_intersection": 152863, "num_union": 318177, "num_only_computed": 82657, "num_only_roped": 82657, "total_diff": 165314, "diff_percentage": 0.5195661534303234, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:42.885057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 0.00012493133544921875, "l2_diff": 0.90625, "l2_diff_relative": 0.1638418079096045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:55.579252", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4248466549444099, "overlap_percentage": 0.5963401794433594, "num_intersection": 156327, "num_union": 367961, "num_only_computed": 105817, "num_only_roped": 105817, "total_diff": 211634, "diff_percentage": 0.5751533450555901, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:55:56.018855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 0.00011110305786132812, "l2_diff": 0.953125, "l2_diff_relative": 0.17630057803468208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:56:11.031440", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3874036478450568, "overlap_percentage": 0.5584584535968028, "num_intersection": 160979, "num_union": 415533, "num_only_computed": 127277, "num_only_roped": 127277, "total_diff": 254554, "diff_percentage": 0.6125963521549431, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:56:11.564187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.90234375, "l2_diff_relative": 0.15778688524590165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:56:29.763952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36442075658408707, "overlap_percentage": 0.534176506514658, "num_intersection": 167928, "num_union": 460808, "num_only_computed": 146440, "num_only_roped": 146440, "total_diff": 292880, "diff_percentage": 0.6355792434159129, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:56:30.385844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.14908854166666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:56:50.580359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32351940789921224, "overlap_percentage": 0.48887746710526314, "num_intersection": 166453, "num_union": 514507, "num_only_computed": 174027, "num_only_roped": 174027, "total_diff": 348054, "diff_percentage": 0.6764805921007877, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:56:51.267960", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 6.580352783203125e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.14248704663212436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:57:14.696368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30626439781714393, "overlap_percentage": 0.4689163975209497, "num_intersection": 171901, "num_union": 561283, "num_only_computed": 194691, "num_only_roped": 194691, "total_diff": 389382, "diff_percentage": 0.693735602182856, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:57:17.463715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.17291666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:57:43.230572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28647845759734075, "overlap_percentage": 0.4453684488932292, "num_intersection": 175126, "num_union": 611306, "num_only_computed": 218090, "num_only_roped": 218090, "total_diff": 436180, "diff_percentage": 0.7135215424026592, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:57:44.679174", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 5.841255187988281e-05, "l2_diff": 0.9609375, "l2_diff_relative": 0.17672413793103448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:58:12.460746", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2757610929497077, "overlap_percentage": 0.43230836004273504, "num_intersection": 181279, "num_union": 657377, "num_only_computed": 238049, "num_only_roped": 238049, "total_diff": 476098, "diff_percentage": 0.7242389070502923, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:58:13.388420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1919889502762431}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:58:43.940905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2717028696393216, "overlap_percentage": 0.4273055854885057, "num_intersection": 190339, "num_union": 700541, "num_only_computed": 255101, "num_only_roped": 255101, "total_diff": 510202, "diff_percentage": 0.7282971303606783, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:58:44.964065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.18055555555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:59:18.481619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2661000498060785, "overlap_percentage": 0.42034600637893593, "num_intersection": 198215, "num_union": 744889, "num_only_computed": 273337, "num_only_roped": 273337, "total_diff": 546674, "diff_percentage": 0.7338999501939215, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:59:20.837303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 5.53131103515625e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.2328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T11:59:57.844303", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24699691798842366, "overlap_percentage": 0.3961467978395062, "num_intersection": 197148, "num_union": 798180, "num_only_computed": 300516, "num_only_roped": 300516, "total_diff": 601032, "diff_percentage": 0.7530030820115763, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:00:00.499473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.17791411042944785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:00:39.905355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22627129446738542, "overlap_percentage": 0.36903953552246094, "num_intersection": 193483, "num_union": 855093, "num_only_computed": 330805, "num_only_roped": 330805, "total_diff": 661610, "diff_percentage": 0.7737287055326146, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:00:43.438576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.1842948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:01:25.741472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2063574864191632, "overlap_percentage": 0.34211664244186046, "num_intersection": 188301, "num_union": 912499, "num_only_computed": 362099, "num_only_roped": 362099, "total_diff": 724198, "diff_percentage": 0.7936425135808368, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:01:27.156621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.22258064516129034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:02:12.498641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1971422846149134, "overlap_percentage": 0.32935480961367675, "num_intersection": 189877, "num_union": 963147, "num_only_computed": 386635, "num_only_roped": 386635, "total_diff": 773270, "diff_percentage": 0.8028577153850865, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:02:13.987636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.2517857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:03:02.146707", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18488340885205964, "overlap_percentage": 0.3120702129354291, "num_intersection": 188061, "num_union": 1017187, "num_only_computed": 414563, "num_only_roped": 414563, "total_diff": 829126, "diff_percentage": 0.8151165911479403, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:03:03.756175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.84375, "l2_diff_relative": 0.4627450980392157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:03:55.677606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17222433004606036, "overlap_percentage": 0.29384193047638435, "num_intersection": 184749, "num_union": 1072723, "num_only_computed": 443987, "num_only_roped": 443987, "total_diff": 887974, "diff_percentage": 0.8277756699539397, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:03:57.397298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 8.678436279296875e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.751131221719457}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:04:52.300341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1588718611603042, "overlap_percentage": 0.27418365478515627, "num_intersection": 179689, "num_union": 1131031, "num_only_computed": 475671, "num_only_roped": 475671, "total_diff": 951342, "diff_percentage": 0.8411281388396958, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:04:54.126476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 8.0108642578125e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.7073170731707317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:05:50.913024", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15634356438247612, "overlap_percentage": 0.27041022962058603, "num_intersection": 184277, "num_union": 1178667, "num_only_computed": 497195, "num_only_roped": 497195, "total_diff": 994390, "diff_percentage": 0.8436564356175239, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:05:52.784245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 8.296966552734375e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.7543859649122807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:06:53.325858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15454457195956392, "overlap_percentage": 0.26771521119753977, "num_intersection": 189431, "num_union": 1225737, "num_only_computed": 518153, "num_only_roped": 518153, "total_diff": 1036306, "diff_percentage": 0.845455428040436, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:06:55.259479", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 8.440017700195312e-05, "l2_diff": 3.15625, "l2_diff_relative": 0.8859649122807017}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:07:57.806053", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1462012057283815, "overlap_percentage": 0.2551056568387997, "num_intersection": 187170, "num_union": 1280222, "num_only_computed": 546526, "num_only_roped": 546526, "total_diff": 1093052, "diff_percentage": 0.8537987942716185, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:08:02.214653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 8.58306884765625e-05, "l2_diff": 3.09375, "l2_diff_relative": 0.9850746268656716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:09:07.680011", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14145528758796871, "overlap_percentage": 0.24785077282681942, "num_intersection": 188319, "num_union": 1331297, "num_only_computed": 571489, "num_only_roped": 571489, "total_diff": 1142978, "diff_percentage": 0.8585447124120312, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:09:11.091670", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.295608520507812e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.7268722466960352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:10:20.711759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1443688256581963, "overlap_percentage": 0.25231170654296875, "num_intersection": 198426, "num_union": 1374438, "num_only_computed": 588006, "num_only_roped": 588006, "total_diff": 1176012, "diff_percentage": 0.8556311743418037, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:10:22.981974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 6.866455078125e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:11:34.973373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14092745007045285, "overlap_percentage": 0.24704016028670447, "num_intersection": 200731, "num_union": 1424357, "num_only_computed": 611813, "num_only_roped": 611813, "total_diff": 1223626, "diff_percentage": 0.8590725499295472, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:11:37.990595", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.8447488584474886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:12:56.300890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1397182830623297, "overlap_percentage": 0.24518038385225885, "num_intersection": 205622, "num_union": 1471690, "num_only_computed": 633034, "num_only_roped": 633034, "total_diff": 1266068, "diff_percentage": 0.8602817169376703, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:12:58.811038", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 6.008148193359375e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.5959183673469388}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:14:17.887311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1342424572315223, "overlap_percentage": 0.23670857386027236, "num_intersection": 204698, "num_union": 1524838, "num_only_computed": 660070, "num_only_roped": 660070, "total_diff": 1320140, "diff_percentage": 0.8657575427684777, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:14:20.522289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 4.9591064453125e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.49236641221374045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:15:44.174797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1320172125372228, "overlap_percentage": 0.23324241199712645, "num_intersection": 207791, "num_union": 1573969, "num_only_computed": 683089, "num_only_roped": 683089, "total_diff": 1366178, "diff_percentage": 0.8679827874627772, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:15:48.395709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 5.364418029785156e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.5732758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:17:15.725291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12687030485546955, "overlap_percentage": 0.22517286028180802, "num_intersection": 206597, "num_union": 1628411, "num_only_computed": 710907, "num_only_roped": 710907, "total_diff": 1421814, "diff_percentage": 0.8731296951445304, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:17:18.607127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 6.0558319091796875e-05, "l2_diff": 2.25, "l2_diff_relative": 0.7309644670050761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:18:48.942346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12733091965633478, "overlap_percentage": 0.22589803479381443, "num_intersection": 213161, "num_union": 1674071, "num_only_computed": 730455, "num_only_roped": 730455, "total_diff": 1460910, "diff_percentage": 0.8726690803436652, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:18:51.990613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 5.7220458984375e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.6915422885572139}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:20:25.416673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12919278779993376, "overlap_percentage": 0.22882326064382139, "num_intersection": 137723, "num_union": 1066027, "num_only_computed": 464152, "num_only_roped": 464152, "total_diff": 928304, "diff_percentage": 0.8708072122000662, "num_computed": 601875, "num_roped": 601875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 321, "seq_len_k": 16193, "queries_shape": [1, 32, 321, 128], "keys_shape": [1, 8, 16193, 128], "mask_shape": [1, 32, 321, 16193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:20:28.477229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 5.817413330078125e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.7034883720930233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 321, "seq_len_k": 16193, "queries_shape": [1, 32, 321, 128], "keys_shape": [1, 8, 16193, 128], "attention_shape": [1, 32, 321, 16193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:21:57.095147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13045135788597167, "overlap_percentage": 0.23079517216897408, "num_intersection": 13003, "num_union": 99677, "num_only_computed": 43337, "num_only_roped": 43337, "total_diff": 86674, "diff_percentage": 0.8695486421140283, "num_computed": 56340, "num_roped": 56340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "mask_shape": [1, 32, 30, 16223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:21:59.567698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.5098814229249012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "attention_shape": [1, 32, 30, 16223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:23:09.126311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13887204366282596, "overlap_percentage": 0.24387646432374868, "num_intersection": 458, "num_union": 3298, "num_only_computed": 1420, "num_only_roped": 1420, "total_diff": 2840, "diff_percentage": 0.8611279563371741, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "mask_shape": [1, 32, 1, 16224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:23:11.064368", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.06689453125, "l2_diff_relative": 0.3784530386740331}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "attention_shape": [1, 32, 1, 16224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:24:10.966666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13064419024683926, "overlap_percentage": 0.23109691160809373, "num_intersection": 434, "num_union": 3322, "num_only_computed": 1444, "num_only_roped": 1444, "total_diff": 2888, "diff_percentage": 0.8693558097531607, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "mask_shape": [1, 32, 1, 16225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:24:14.740109", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.06689453125, "l2_diff_relative": 0.3936781609195402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "attention_shape": [1, 32, 1, 16225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:24:49.066269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:24:49.079764", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.0218505859375, "l2_diff_relative": 0.003066748903508772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:24:52.393141", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.678565541493434, "overlap_percentage": 0.8085064594972067, "num_intersection": 148196, "num_union": 218396, "num_only_computed": 35100, "num_only_roped": 35100, "total_diff": 70200, "diff_percentage": 0.32143445850656605, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:24:54.367415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 0.000194549560546875, "l2_diff": 0.66015625, "l2_diff_relative": 0.12071428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:02.117840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5624081355527535, "overlap_percentage": 0.7199247402200489, "num_intersection": 150758, "num_union": 268058, "num_only_computed": 58650, "num_only_roped": 58650, "total_diff": 117300, "diff_percentage": 0.4375918644472465, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:02.409227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 0.000148773193359375, "l2_diff": 0.75390625, "l2_diff_relative": 0.13255494505494506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:12.992658", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49146359997973554, "overlap_percentage": 0.6590353260869565, "num_intersection": 155216, "num_union": 315824, "num_only_computed": 80304, "num_only_roped": 80304, "total_diff": 160608, "diff_percentage": 0.5085364000202645, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:13.356893", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.431640625, "l2_diff_relative": 0.07083333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:25.624726", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44338116266008876, "overlap_percentage": 0.6143646240234375, "num_intersection": 161052, "num_union": 363236, "num_only_computed": 101092, "num_only_roped": 101092, "total_diff": 202184, "diff_percentage": 0.5566188373399112, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:26.060955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 8.153915405273438e-05, "l2_diff": 0.625, "l2_diff_relative": 0.12738853503184713}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:40.662383", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3873936313580532, "overlap_percentage": 0.5584480461811723, "num_intersection": 160976, "num_union": 415536, "num_only_computed": 127280, "num_only_roped": 127280, "total_diff": 254560, "diff_percentage": 0.6126063686419468, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:41.175844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.10310734463276836}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:58.955067", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3411861575840833, "overlap_percentage": 0.508782700529316, "num_intersection": 159945, "num_union": 468791, "num_only_computed": 154423, "num_only_roped": 154423, "total_diff": 308846, "diff_percentage": 0.6588138424159167, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:25:59.557274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.482421875, "l2_diff_relative": 0.07316350710900474}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:26:19.476202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32370464684556843, "overlap_percentage": 0.4890889332706767, "num_intersection": 166525, "num_union": 514435, "num_only_computed": 173955, "num_only_roped": 173955, "total_diff": 347910, "diff_percentage": 0.6762953531544316, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:26:20.154653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.9802322387695312e-05, "l2_diff": 0.412109375, "l2_diff_relative": 0.06464460784313726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:26:42.319393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30247034203916023, "overlap_percentage": 0.4644563983938548, "num_intersection": 170266, "num_union": 562918, "num_only_computed": 196326, "num_only_roped": 196326, "total_diff": 392652, "diff_percentage": 0.6975296579608398, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:26:45.465724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.10961538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:27:11.105012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28216825001915674, "overlap_percentage": 0.44014231363932294, "num_intersection": 173071, "num_union": 613361, "num_only_computed": 220145, "num_only_roped": 220145, "total_diff": 440290, "diff_percentage": 0.7178317499808432, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:27:13.387498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 4.1961669921875e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.12437810945273632}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:27:40.811758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26610607044188467, "overlap_percentage": 0.420353518009768, "num_intersection": 176266, "num_union": 662390, "num_only_computed": 243062, "num_only_roped": 243062, "total_diff": 486124, "diff_percentage": 0.7338939295581153, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:27:41.720684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 5.078315734863281e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.17057291666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:28:11.774517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2565781771661262, "overlap_percentage": 0.40837598778735634, "num_intersection": 181907, "num_union": 708973, "num_only_computed": 263533, "num_only_roped": 263533, "total_diff": 527066, "diff_percentage": 0.7434218228338738, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:28:12.776961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.890625, "l2_diff_relative": 0.15833333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:28:45.697203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.251989953324377, "overlap_percentage": 0.4025430917480999, "num_intersection": 189820, "num_union": 753284, "num_only_computed": 281732, "num_only_roped": 281732, "total_diff": 563464, "diff_percentage": 0.748010046675623, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:28:49.034027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.16277472527472528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:29:26.444182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23978047547040082, "overlap_percentage": 0.38681118184156377, "num_intersection": 192502, "num_union": 802826, "num_only_computed": 305162, "num_only_roped": 305162, "total_diff": 610324, "diff_percentage": 0.7602195245295992, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:29:29.664730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.719329833984375e-05, "l2_diff": 1.0, "l2_diff_relative": 0.17204301075268819}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:30:08.558752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23056268490842155, "overlap_percentage": 0.3747272491455078, "num_intersection": 196465, "num_union": 852111, "num_only_computed": 327823, "num_only_roped": 327823, "total_diff": 655646, "diff_percentage": 0.7694373150915784, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:30:12.221896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.15299479166666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:30:53.576678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22163835820150152, "overlap_percentage": 0.36285428779069767, "num_intersection": 199715, "num_union": 901085, "num_only_computed": 350685, "num_only_roped": 350685, "total_diff": 701370, "diff_percentage": 0.7783616417984984, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:30:54.916002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.7890625, "l2_diff_relative": 0.1434659090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:31:40.512676", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2203662504313, "overlap_percentage": 0.3611477297957371, "num_intersection": 208206, "num_union": 944818, "num_only_computed": 368306, "num_only_roped": 368306, "total_diff": 736612, "diff_percentage": 0.7796337495687, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:31:41.979440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.22685185185185186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:32:28.892145", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20056340160692976, "overlap_percentage": 0.3341154683517417, "num_intersection": 201346, "num_union": 1003902, "num_only_computed": 401278, "num_only_roped": 401278, "total_diff": 802556, "diff_percentage": 0.7994365983930702, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:32:31.483129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11865234375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.3967391304347826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:33:22.305721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1762947247502598, "overlap_percentage": 0.29974583927117265, "num_intersection": 188461, "num_union": 1069011, "num_only_computed": 440275, "num_only_roped": 440275, "total_diff": 880550, "diff_percentage": 0.8237052752497401, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:33:25.868951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 8.440017700195312e-05, "l2_diff": 2.75, "l2_diff_relative": 0.6821705426356589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:34:20.029359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16317993117047466, "overlap_percentage": 0.2805755615234375, "num_intersection": 183878, "num_union": 1126842, "num_only_computed": 471482, "num_only_roped": 471482, "total_diff": 942964, "diff_percentage": 0.8368200688295253, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:34:22.984447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 6.866455078125e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.53125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:35:18.781159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1609591637343364, "overlap_percentage": 0.27728652094290007, "num_intersection": 188963, "num_union": 1173981, "num_only_computed": 492509, "num_only_roped": 492509, "total_diff": 985018, "diff_percentage": 0.8390408362656636, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:35:20.630956", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.5991735537190083}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:36:19.453286", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16306733894662442, "overlap_percentage": 0.28040911043777134, "num_intersection": 198413, "num_union": 1216755, "num_only_computed": 509171, "num_only_roped": 509171, "total_diff": 1018342, "diff_percentage": 0.8369326610533756, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:36:21.409026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.6506024096385542}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:37:24.165063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16183976120159305, "overlap_percentage": 0.27859222348220514, "num_intersection": 204402, "num_union": 1262990, "num_only_computed": 529294, "num_only_roped": 529294, "total_diff": 1058588, "diff_percentage": 0.838160238798407, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:37:26.240669", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.7475728155339806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:38:30.814502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16104298696931707, "overlap_percentage": 0.27741089481913034, "num_intersection": 181513, "num_union": 1127109, "num_only_computed": 472798, "num_only_roped": 472798, "total_diff": 945596, "diff_percentage": 0.8389570130306829, "num_computed": 654311, "num_roped": 654311}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 443, "seq_len_k": 12219, "queries_shape": [1, 32, 443, 128], "keys_shape": [1, 8, 12219, 128], "mask_shape": [1, 32, 443, 12219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:38:33.583063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 7.295608520507812e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.7342342342342343}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 443, "seq_len_k": 12219, "queries_shape": [1, 32, 443, 128], "keys_shape": [1, 8, 12219, 128], "attention_shape": [1, 32, 443, 12219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:39:34.517017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1658625103743195, "overlap_percentage": 0.28453185328185326, "num_intersection": 11791, "num_union": 71089, "num_only_computed": 29649, "num_only_roped": 29649, "total_diff": 59298, "diff_percentage": 0.8341374896256805, "num_computed": 41440, "num_roped": 41440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "mask_shape": [1, 32, 28, 12247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:39:36.275434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 5.412101745605469e-05, "l2_diff": 0.33203125, "l2_diff_relative": 0.2992957746478873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "attention_shape": [1, 32, 28, 12247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:40:25.974175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17227722772277226, "overlap_percentage": 0.2939189189189189, "num_intersection": 435, "num_union": 2525, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8277227722772277, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "mask_shape": [1, 32, 1, 12248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:40:27.380920", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.068359375, "l2_diff_relative": 0.546875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "attention_shape": [1, 32, 1, 12248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:41:10.967411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16949822204662188, "overlap_percentage": 0.28986486486486485, "num_intersection": 429, "num_union": 2531, "num_only_computed": 1051, "num_only_roped": 1051, "total_diff": 2102, "diff_percentage": 0.8305017779533781, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "mask_shape": [1, 32, 1, 12249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:41:12.475265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 7.104873657226562e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.4962962962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "attention_shape": [1, 32, 1, 12249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:41:55.956963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1707509881422925, "overlap_percentage": 0.29169480081026333, "num_intersection": 432, "num_union": 2530, "num_only_computed": 1049, "num_only_roped": 1049, "total_diff": 2098, "diff_percentage": 0.8292490118577075, "num_computed": 1481, "num_roped": 1481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "mask_shape": [1, 32, 1, 12250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:41:58.071561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.15610859728506787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "attention_shape": [1, 32, 1, 12250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:23.444262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:23.455589", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.02392578125, "l2_diff_relative": 0.0032579787234042553}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:26.698658", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6862867762056339, "overlap_percentage": 0.8139621159217877, "num_intersection": 149196, "num_union": 217396, "num_only_computed": 34100, "num_only_roped": 34100, "total_diff": 68200, "diff_percentage": 0.31371322379436606, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:27.049043", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 0.00011730194091796875, "l2_diff": 0.453125, "l2_diff_relative": 0.0728643216080402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:34.743703", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5645677056872179, "overlap_percentage": 0.7216916259168704, "num_intersection": 151128, "num_union": 267688, "num_only_computed": 58280, "num_only_roped": 58280, "total_diff": 116560, "diff_percentage": 0.435432294312782, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:35.032622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 9.870529174804688e-05, "l2_diff": 0.55078125, "l2_diff_relative": 0.09425133689839572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:45.543160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4900670631405795, "overlap_percentage": 0.6577785326086957, "num_intersection": 154920, "num_union": 316120, "num_only_computed": 80600, "num_only_roped": 80600, "total_diff": 161200, "diff_percentage": 0.5099329368594204, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:45.904093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 9.489059448242188e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.12430167597765363}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:58.194563", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43328366981506033, "overlap_percentage": 0.6046028137207031, "num_intersection": 158493, "num_union": 365795, "num_only_computed": 103651, "num_only_roped": 103651, "total_diff": 207302, "diff_percentage": 0.5667163301849396, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:42:58.635519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.453125, "l2_diff_relative": 0.07073170731707316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:43:14.999082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4036926208453146, "overlap_percentage": 0.5751866396536413, "num_intersection": 165801, "num_union": 410711, "num_only_computed": 122455, "num_only_roped": 122455, "total_diff": 244910, "diff_percentage": 0.5963073791546855, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:43:15.520021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.1961669921875e-05, "l2_diff": 0.5078125, "l2_diff_relative": 0.07286995515695067}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:43:32.549088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35748908047093775, "overlap_percentage": 0.526691648004886, "num_intersection": 165575, "num_union": 463161, "num_only_computed": 148793, "num_only_roped": 148793, "total_diff": 297586, "diff_percentage": 0.6425109195290623, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:43:34.966675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 8.249282836914062e-05, "l2_diff": 0.95703125, "l2_diff_relative": 0.17805232558139536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:43:54.563698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32831366429337755, "overlap_percentage": 0.4943315319548872, "num_intersection": 168310, "num_union": 512650, "num_only_computed": 172170, "num_only_roped": 172170, "total_diff": 344340, "diff_percentage": 0.6716863357066225, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:43:55.241290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.15658602150537634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:44:17.423072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3081522214272588, "overlap_percentage": 0.471125938372905, "num_intersection": 172711, "num_union": 560473, "num_only_computed": 193881, "num_only_roped": 193881, "total_diff": 387762, "diff_percentage": 0.6918477785727413, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:44:18.175129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.13466850828729282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:44:43.416040", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2822811414185718, "overlap_percentage": 0.44027964274088544, "num_intersection": 173125, "num_union": 613307, "num_only_computed": 220091, "num_only_roped": 220091, "total_diff": 440182, "diff_percentage": 0.7177188585814283, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:44:44.656141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.8125, "l2_diff_relative": 0.15476190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:45:12.318824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26729609168167695, "overlap_percentage": 0.4218368437118437, "num_intersection": 176888, "num_union": 661768, "num_only_computed": 242440, "num_only_roped": 242440, "total_diff": 484880, "diff_percentage": 0.732703908318323, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:45:13.250835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.17214285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:45:43.652280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2564027348421599, "overlap_percentage": 0.40815373563218393, "num_intersection": 181808, "num_union": 709072, "num_only_computed": 263632, "num_only_roped": 263632, "total_diff": 527264, "diff_percentage": 0.7435972651578401, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:45:44.667674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1762295081967213}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:46:13.517627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30506360688450984, "overlap_percentage": 0.4675076452599388, "num_intersection": 9784, "num_union": 32072, "num_only_computed": 11144, "num_only_roped": 11144, "total_diff": 22288, "diff_percentage": 0.6949363931154902, "num_computed": 20928, "num_roped": 20928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "mask_shape": [1, 32, 24, 6168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:46:14.334037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 1.3172626495361328e-05, "l2_diff": 0.072265625, "l2_diff_relative": 0.050824175824175824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "attention_shape": [1, 32, 24, 6168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:46:40.998807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27944017964384565, "overlap_percentage": 0.43681632653061225, "num_intersection": 10702, "num_union": 38298, "num_only_computed": 13798, "num_only_roped": 13798, "total_diff": 27596, "diff_percentage": 0.7205598203561544, "num_computed": 24500, "num_roped": 24500}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "mask_shape": [1, 32, 28, 6196], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:46:41.887075", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.2431640625, "l2_diff_relative": 0.21173469387755103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "attention_shape": [1, 32, 28, 6196]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:47:06.698327", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27180232558139533, "overlap_percentage": 0.42742857142857144, "num_intersection": 374, "num_union": 1376, "num_only_computed": 501, "num_only_roped": 501, "total_diff": 1002, "diff_percentage": 0.7281976744186046, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "mask_shape": [1, 32, 1, 6197], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:47:07.421740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.23529411764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "attention_shape": [1, 32, 1, 6197]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:47:29.828747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2896094325718497, "overlap_percentage": 0.4491428571428571, "num_intersection": 393, "num_union": 1357, "num_only_computed": 482, "num_only_roped": 482, "total_diff": 964, "diff_percentage": 0.7103905674281503, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "mask_shape": [1, 32, 1, 6198], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:47:30.552618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 9.059906005859375e-05, "l2_diff": 0.056884765625, "l2_diff_relative": 0.39093959731543626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "attention_shape": [1, 32, 1, 6198]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:47:53.016454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26262626262626265, "overlap_percentage": 0.416, "num_intersection": 364, "num_union": 1386, "num_only_computed": 511, "num_only_roped": 511, "total_diff": 1022, "diff_percentage": 0.7373737373737373, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "mask_shape": [1, 32, 1, 6199], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:47:54.701376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.13185654008438819}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "attention_shape": [1, 32, 1, 6199]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:13.920427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:13.932841", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.0223388671875, "l2_diff_relative": 0.0030812230603448278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:17.218585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6860773699194658, "overlap_percentage": 0.813814813198324, "num_intersection": 149169, "num_union": 217423, "num_only_computed": 34127, "num_only_roped": 34127, "total_diff": 68254, "diff_percentage": 0.3139226300805343, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:17.437630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 7.62939453125e-05, "l2_diff": 0.318359375, "l2_diff_relative": 0.04760514018691589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:25.697986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5795793983646622, "overlap_percentage": 0.7338401589242054, "num_intersection": 153672, "num_union": 265144, "num_only_computed": 55736, "num_only_roped": 55736, "total_diff": 111472, "diff_percentage": 0.4204206016353378, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:25.989262", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.416015625, "l2_diff_relative": 0.06078767123287671}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:36.286595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49817594280061955, "overlap_percentage": 0.665043308423913, "num_intersection": 156631, "num_union": 314409, "num_only_computed": 78889, "num_only_roped": 78889, "total_diff": 157778, "diff_percentage": 0.5018240571993804, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:36.678087", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.51171875, "l2_diff_relative": 0.07511467889908256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:49.043069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4390865173473869, "overlap_percentage": 0.6102294921875, "num_intersection": 159968, "num_union": 364320, "num_only_computed": 102176, "num_only_roped": 102176, "total_diff": 204352, "diff_percentage": 0.5609134826526131, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:48:50.238127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.10596446700507614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:49:05.188262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39075391043393515, "overlap_percentage": 0.5619310612788633, "num_intersection": 161980, "num_union": 414532, "num_only_computed": 126276, "num_only_roped": 126276, "total_diff": 252552, "diff_percentage": 0.6092460895660649, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:49:05.719008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 9.107589721679688e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.16739766081871346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:49:23.834764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3645303198334965, "overlap_percentage": 0.5342942029723127, "num_intersection": 167965, "num_union": 460771, "num_only_computed": 146403, "num_only_roped": 146403, "total_diff": 292806, "diff_percentage": 0.6354696801665035, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:49:24.454639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.200241088867188e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.15293296089385475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:49:44.672174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33814648946810955, "overlap_percentage": 0.5053953242481203, "num_intersection": 172077, "num_union": 508883, "num_only_computed": 168403, "num_only_roped": 168403, "total_diff": 336806, "diff_percentage": 0.6618535105318905, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:49:45.359506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 7.486343383789062e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.15492021276595744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:50:08.468003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31876401846885494, "overlap_percentage": 0.4834284436103352, "num_intersection": 177221, "num_union": 555963, "num_only_computed": 189371, "num_only_roped": 189371, "total_diff": 378742, "diff_percentage": 0.6812359815311451, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:50:09.227906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.507469177246094e-05, "l2_diff": 0.7890625, "l2_diff_relative": 0.14185393258426968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:50:35.122618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2983381815420275, "overlap_percentage": 0.4595692952473958, "num_intersection": 180710, "num_union": 605722, "num_only_computed": 212506, "num_only_roped": 212506, "total_diff": 425012, "diff_percentage": 0.7016618184579725, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:50:35.970344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.698204040527344e-05, "l2_diff": 0.8671875, "l2_diff_relative": 0.15502793296089384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:51:06.114797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28514883346741754, "overlap_percentage": 0.443760016025641, "num_intersection": 186081, "num_union": 652575, "num_only_computed": 233247, "num_only_roped": 233247, "total_diff": 466494, "diff_percentage": 0.7148511665325825, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:51:07.031633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 6.103515625e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.21012269938650308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:51:37.359623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26598683537396406, "overlap_percentage": 0.42020474137931035, "num_intersection": 187176, "num_union": 703704, "num_only_computed": 258264, "num_only_roped": 258264, "total_diff": 516528, "diff_percentage": 0.7340131646260359, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:51:38.371387", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.19916666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:52:11.401483", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25760446767059464, "overlap_percentage": 0.40967486088490773, "num_intersection": 193183, "num_union": 749921, "num_only_computed": 278369, "num_only_roped": 278369, "total_diff": 556738, "diff_percentage": 0.7423955323294054, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:52:14.005133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.9591064453125e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.19345238095238096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:52:50.228966", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24276189287052066, "overlap_percentage": 0.3906812628600823, "num_intersection": 194428, "num_union": 800900, "num_only_computed": 303236, "num_only_roped": 303236, "total_diff": 606472, "diff_percentage": 0.7572381071294794, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:52:51.451326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.94921875, "l2_diff_relative": 0.17357142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:53:32.525197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23278343146291455, "overlap_percentage": 0.377655029296875, "num_intersection": 198000, "num_union": 850576, "num_only_computed": 326288, "num_only_roped": 326288, "total_diff": 652576, "diff_percentage": 0.7672165685370854, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:53:35.680567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.1957142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:54:17.970847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21483672320748678, "overlap_percentage": 0.35368822674418604, "num_intersection": 194670, "num_union": 906130, "num_only_computed": 355730, "num_only_roped": 355730, "total_diff": 711460, "diff_percentage": 0.7851632767925132, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:54:19.556041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.1760752688172043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:55:04.846411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19739589986115483, "overlap_percentage": 0.32970866174511543, "num_intersection": 190081, "num_union": 962943, "num_only_computed": 386431, "num_only_roped": 386431, "total_diff": 772862, "diff_percentage": 0.8026041001388452, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:55:06.306376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 5.602836608886719e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.32305194805194803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:55:53.694009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17388301959932562, "overlap_percentage": 0.2962527214316058, "num_intersection": 178529, "num_union": 1026719, "num_only_computed": 424095, "num_only_roped": 424095, "total_diff": 848190, "diff_percentage": 0.8261169804006744, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:55:55.263062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.43790849673202614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:56:45.849724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15440022179666313, "overlap_percentage": 0.2674986003664495, "num_intersection": 168186, "num_union": 1089286, "num_only_computed": 460550, "num_only_roped": 460550, "total_diff": 921100, "diff_percentage": 0.8455997782033369, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:56:49.363156", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 9.202957153320312e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.7982832618025751}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:57:43.358317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14220580828106183, "overlap_percentage": 0.2490020751953125, "num_intersection": 163186, "num_union": 1147534, "num_only_computed": 492174, "num_only_roped": 492174, "total_diff": 984348, "diff_percentage": 0.8577941917189382, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:57:45.098753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 8.535385131835938e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.7192982456140351}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:58:41.949486", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13969296430181113, "overlap_percentage": 0.24514139979338842, "num_intersection": 167057, "num_union": 1195887, "num_only_computed": 514415, "num_only_roped": 514415, "total_diff": 1028830, "diff_percentage": 0.8603070356981889, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:58:43.834421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 9.72747802734375e-05, "l2_diff": 2.984375, "l2_diff_relative": 1.0}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:59:43.372492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13677243152060406, "overlap_percentage": 0.24063291425470332, "num_intersection": 170268, "num_union": 1244900, "num_only_computed": 537316, "num_only_roped": 537316, "total_diff": 1074632, "diff_percentage": 0.863227568479396, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T12:59:47.343443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 7.772445678710938e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.7705627705627706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:00:50.175263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13575759639750648, "overlap_percentage": 0.23906086444521982, "num_intersection": 175398, "num_union": 1291994, "num_only_computed": 558298, "num_only_roped": 558298, "total_diff": 1116596, "diff_percentage": 0.8642424036024935, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:00:54.502914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 7.724761962890625e-05, "l2_diff": 2.625, "l2_diff_relative": 0.7777777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:02:02.480167", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13600011960917702, "overlap_percentage": 0.23943680508760107, "num_intersection": 181926, "num_union": 1337690, "num_only_computed": 577882, "num_only_roped": 577882, "total_diff": 1155764, "diff_percentage": 0.863999880390823, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:02:05.625414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19140625, "mean_diff": 7.295608520507812e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.7521739130434782}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:03:17.266850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13256636671104674, "overlap_percentage": 0.23409907023111978, "num_intersection": 184103, "num_union": 1388761, "num_only_computed": 602329, "num_only_roped": 602329, "total_diff": 1204658, "diff_percentage": 0.8674336332889533, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:03:19.608120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.7224669603524229}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:04:33.702492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12755064162830312, "overlap_percentage": 0.22624374803087588, "num_intersection": 183833, "num_union": 1441255, "num_only_computed": 628711, "num_only_roped": 628711, "total_diff": 1257422, "diff_percentage": 0.8724493583716969, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:04:36.390708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19140625, "mean_diff": 7.963180541992188e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.9333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:05:54.628561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13617778789332077, "overlap_percentage": 0.2397121108058608, "num_intersection": 201036, "num_union": 1476276, "num_only_computed": 637620, "num_only_roped": 637620, "total_diff": 1275240, "diff_percentage": 0.8638222121066792, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:05:58.137743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.6328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:07:20.212862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13065437997694937, "overlap_percentage": 0.23111285338957963, "num_intersection": 199859, "num_union": 1529677, "num_only_computed": 664909, "num_only_roped": 664909, "total_diff": 1329818, "diff_percentage": 0.8693456200230506, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:07:23.034152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.6653846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:08:46.849269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12551995982451652, "overlap_percentage": 0.22304350754310345, "num_intersection": 198705, "num_union": 1583055, "num_only_computed": 692175, "num_only_roped": 692175, "total_diff": 1384350, "diff_percentage": 0.8744800401754835, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:08:49.684077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.8051282051282052}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:10:18.741427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12212658878061756, "overlap_percentage": 0.2176698957170759, "num_intersection": 199713, "num_union": 1635295, "num_only_computed": 717791, "num_only_roped": 717791, "total_diff": 1435582, "diff_percentage": 0.8778734112193824, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:10:21.665953", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 6.532669067382812e-05, "l2_diff": 2.46875, "l2_diff_relative": 0.8315789473684211}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:11:53.010743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12692365568026293, "overlap_percentage": 0.22525688415626696, "num_intersection": 212556, "num_union": 1674676, "num_only_computed": 731060, "num_only_roped": 731060, "total_diff": 1462120, "diff_percentage": 0.873076344319737, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:11:56.013643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.9944444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:13:29.653593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1257783766344676, "overlap_percentage": 0.22345139904087347, "num_intersection": 165691, "num_union": 1317325, "num_only_computed": 575817, "num_only_roped": 575817, "total_diff": 1151634, "diff_percentage": 0.8742216233655324, "num_computed": 741508, "num_roped": 741508}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 394, "seq_len_k": 16266, "queries_shape": [1, 32, 394, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 394, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:13:32.699057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 6.29425048828125e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.8157894736842105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 394, "seq_len_k": 16266, "queries_shape": [1, 32, 394, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 394, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:14:59.090231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12507327471356247, "overlap_percentage": 0.22233800682076543, "num_intersection": 11735, "num_union": 93825, "num_only_computed": 41045, "num_only_roped": 41045, "total_diff": 82090, "diff_percentage": 0.8749267252864376, "num_computed": 52780, "num_roped": 52780}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 28, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:15:01.723119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12353515625, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.55859375, "l2_diff_relative": 0.5542635658914729}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 28, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:16:11.529561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1375980687990344, "overlap_percentage": 0.24190981432360742, "num_intersection": 456, "num_union": 3314, "num_only_computed": 1429, "num_only_roped": 1429, "total_diff": 2858, "diff_percentage": 0.8624019312009656, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:16:13.462765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.0751953125, "l2_diff_relative": 0.3615023474178404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:17:12.943470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13145258103241297, "overlap_percentage": 0.2323607427055703, "num_intersection": 438, "num_union": 3332, "num_only_computed": 1447, "num_only_roped": 1447, "total_diff": 2894, "diff_percentage": 0.868547418967587, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:17:14.874898", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.049560546875, "l2_diff_relative": 0.2713903743315508}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:17:50.374533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:17:50.388072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.020069122314453e-06, "l2_diff": 0.024169921875, "l2_diff_relative": 0.00318287037037037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:17:53.764591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6891305349490854, "overlap_percentage": 0.8159588861731844, "num_intersection": 149562, "num_union": 217030, "num_only_computed": 33734, "num_only_roped": 33734, "total_diff": 67468, "diff_percentage": 0.3108694650509146, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:17:53.996175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 0.00010395050048828125, "l2_diff": 0.43359375, "l2_diff_relative": 0.069375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:02.588663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5553814215524253, "overlap_percentage": 0.7141417710880196, "num_intersection": 149547, "num_union": 269269, "num_only_computed": 59861, "num_only_roped": 59861, "total_diff": 119722, "diff_percentage": 0.44461857844757474, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:02.885902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 0.00017452239990234375, "l2_diff": 0.97265625, "l2_diff_relative": 0.16733870967741934}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:13.248221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4797176523806981, "overlap_percentage": 0.6483907948369565, "num_intersection": 152709, "num_union": 318331, "num_only_computed": 82811, "num_only_roped": 82811, "total_diff": 165622, "diff_percentage": 0.5202823476193019, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:13.920657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 0.00013065338134765625, "l2_diff": 1.0546875, "l2_diff_relative": 0.1804812834224599}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:26.561665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42986726448104423, "overlap_percentage": 0.6012687683105469, "num_intersection": 157619, "num_union": 366669, "num_only_computed": 104525, "num_only_roped": 104525, "total_diff": 209050, "diff_percentage": 0.5701327355189558, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:27.594457", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 0.0001239776611328125, "l2_diff": 1.0625, "l2_diff_relative": 0.17894736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:42.528462", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39970185635691774, "overlap_percentage": 0.5711242784191829, "num_intersection": 164630, "num_union": 411882, "num_only_computed": 123626, "num_only_roped": 123626, "total_diff": 247252, "diff_percentage": 0.6002981436430822, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:18:43.058432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 0.0001373291015625, "l2_diff": 1.3828125, "l2_diff_relative": 0.27314814814814814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:19:00.569685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3600114211056842, "overlap_percentage": 0.5294241144136808, "num_intersection": 166434, "num_union": 462302, "num_only_computed": 147934, "num_only_roped": 147934, "total_diff": 295868, "diff_percentage": 0.6399885788943158, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:19:01.181382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 0.00012302398681640625, "l2_diff": 1.4140625, "l2_diff_relative": 0.2776073619631902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:19:21.262937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33046254361867994, "overlap_percentage": 0.4967633928571429, "num_intersection": 169138, "num_union": 511822, "num_only_computed": 171342, "num_only_roped": 171342, "total_diff": 342684, "diff_percentage": 0.6695374563813201, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:19:22.323991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.19230769230769232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:19:44.954274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30521563587035855, "overlap_percentage": 0.46768614699720673, "num_intersection": 171450, "num_union": 561734, "num_only_computed": 195142, "num_only_roped": 195142, "total_diff": 390284, "diff_percentage": 0.6947843641296414, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:19:45.735700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.1793831168831169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:20:11.154145", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28279567612358314, "overlap_percentage": 0.44090525309244794, "num_intersection": 173371, "num_union": 613061, "num_only_computed": 219845, "num_only_roped": 219845, "total_diff": 439690, "diff_percentage": 0.7172043238764169, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:20:12.005200", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.24166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:20:39.961656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25847417569143183, "overlap_percentage": 0.4107739049145299, "num_intersection": 172249, "num_union": 666407, "num_only_computed": 247079, "num_only_roped": 247079, "total_diff": 494158, "diff_percentage": 0.7415258243085682, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:20:40.901610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.22580645161290322}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:21:11.496271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25133437461373365, "overlap_percentage": 0.4017061781609195, "num_intersection": 178936, "num_union": 711944, "num_only_computed": 266504, "num_only_roped": 266504, "total_diff": 533008, "diff_percentage": 0.7486656253862664, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:21:13.233324", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.15056818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:21:46.517368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24782877919438578, "overlap_percentage": 0.3972160016286645, "num_intersection": 187308, "num_union": 755796, "num_only_computed": 284244, "num_only_roped": 284244, "total_diff": 568488, "diff_percentage": 0.7521712208056142, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:21:47.651713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.095703125, "mean_diff": 5.221366882324219e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.22205882352941175}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:22:24.235400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2452215513725451, "overlap_percentage": 0.3938601144547325, "num_intersection": 196010, "num_union": 799318, "num_only_computed": 301654, "num_only_roped": 301654, "total_diff": 603308, "diff_percentage": 0.7547784486274549, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:22:25.446579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07080078125, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.20238095238095238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:23:04.585209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23199404080030925, "overlap_percentage": 0.3766155242919922, "num_intersection": 197455, "num_union": 851121, "num_only_computed": 326833, "num_only_roped": 326833, "total_diff": 653666, "diff_percentage": 0.7680059591996907, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:23:05.862209", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.98828125, "l2_diff_relative": 0.18071428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:23:48.028954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22744946304661254, "overlap_percentage": 0.3706050145348837, "num_intersection": 203981, "num_union": 896819, "num_only_computed": 346419, "num_only_roped": 346419, "total_diff": 692838, "diff_percentage": 0.7725505369533875, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:23:49.402878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.16522988505747127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:24:34.148256", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22077325323477004, "overlap_percentage": 0.36169411911634103, "num_intersection": 208521, "num_union": 944503, "num_only_computed": 367991, "num_only_roped": 367991, "total_diff": 735982, "diff_percentage": 0.77922674676523, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:24:36.916569", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 5.269050598144531e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.2893081761006289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:25:25.182322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2047022698717481, "overlap_percentage": 0.33983877177145283, "num_intersection": 204795, "num_union": 1000453, "num_only_computed": 397829, "num_only_roped": 397829, "total_diff": 795658, "diff_percentage": 0.7952977301282519, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:25:26.755206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.48188405797101447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:26:16.915700", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18941037037597555, "overlap_percentage": 0.3184945668770358, "num_intersection": 200249, "num_union": 1057223, "num_only_computed": 428487, "num_only_roped": 428487, "total_diff": 856974, "diff_percentage": 0.8105896296240245, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:26:18.581012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.916854858398438e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.7777777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:27:11.181623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17367154711493604, "overlap_percentage": 0.29594573974609373, "num_intersection": 193951, "num_union": 1116769, "num_only_computed": 461409, "num_only_roped": 461409, "total_diff": 922818, "diff_percentage": 0.826328452885064, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:27:12.944062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.5807692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:28:09.439829", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16329371599274511, "overlap_percentage": 0.28074374295642374, "num_intersection": 191319, "num_union": 1171625, "num_only_computed": 490153, "num_only_roped": 490153, "total_diff": 980306, "diff_percentage": 0.8367062840072549, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:28:11.318034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.60546875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:29:12.862750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15820608219258803, "overlap_percentage": 0.27319159280028943, "num_intersection": 193306, "num_union": 1221862, "num_only_computed": 514278, "num_only_roped": 514278, "total_diff": 1028556, "diff_percentage": 0.841793917807412, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:29:14.891482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 8.535385131835938e-05, "l2_diff": 3.0625, "l2_diff_relative": 0.8828828828828829}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:30:18.744153", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15324650012063806, "overlap_percentage": 0.26576538511863224, "num_intersection": 194991, "num_union": 1272401, "num_only_computed": 538705, "num_only_roped": 538705, "total_diff": 1077410, "diff_percentage": 0.8467534998793619, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:30:20.839450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.197265625, "mean_diff": 9.107589721679688e-05, "l2_diff": 3.21875, "l2_diff_relative": 1.0098039215686274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:31:26.889655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15026917044635665, "overlap_percentage": 0.26127653301886794, "num_intersection": 198520, "num_union": 1321096, "num_only_computed": 561288, "num_only_roped": 561288, "total_diff": 1122576, "diff_percentage": 0.8497308295536433, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:31:29.074206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 8.630752563476562e-05, "l2_diff": 3.34375, "l2_diff_relative": 0.9264069264069265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:32:38.813285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1497434600402189, "overlap_percentage": 0.2604815165201823, "num_intersection": 204851, "num_union": 1368013, "num_only_computed": 581581, "num_only_roped": 581581, "total_diff": 1163162, "diff_percentage": 0.8502565399597811, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:32:41.085235", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.724761962890625e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.7811158798283262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:33:54.064749", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14847208480565371, "overlap_percentage": 0.2585558443604285, "num_intersection": 210088, "num_union": 1415000, "num_only_computed": 602456, "num_only_roped": 602456, "total_diff": 1204912, "diff_percentage": 0.8515279151943463, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:33:58.147288", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.296966552734375e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.9888268156424581}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:35:13.527889", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14346095401578732, "overlap_percentage": 0.2509240976037851, "num_intersection": 210439, "num_union": 1466873, "num_only_computed": 628217, "num_only_roped": 628217, "total_diff": 1256434, "diff_percentage": 0.8565390459842127, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:35:16.017748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 6.246566772460938e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.6186440677966102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:36:30.015334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13998723704392024, "overlap_percentage": 0.24559439350727916, "num_intersection": 62519, "num_union": 446605, "num_only_computed": 192043, "num_only_roped": 192043, "total_diff": 384086, "diff_percentage": 0.8600127629560798, "num_computed": 254562, "num_roped": 254562}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 154, "seq_len_k": 13978, "queries_shape": [1, 32, 154, 128], "keys_shape": [1, 8, 13978, 128], "mask_shape": [1, 32, 154, 13978], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:36:32.423697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.83203125, "l2_diff_relative": 0.2941988950276243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 154, "seq_len_k": 13978, "queries_shape": [1, 32, 154, 128], "keys_shape": [1, 8, 13978, 128], "attention_shape": [1, 32, 154, 13978]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:37:41.600226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14334437347212364, "overlap_percentage": 0.25074575394430554, "num_intersection": 14542, "num_union": 101448, "num_only_computed": 43453, "num_only_roped": 43453, "total_diff": 86906, "diff_percentage": 0.8566556265278763, "num_computed": 57995, "num_roped": 57995}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "mask_shape": [1, 32, 35, 14013], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:37:43.721284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08447265625, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.40344827586206894}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "attention_shape": [1, 32, 35, 14013]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:38:42.002196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16280701754385965, "overlap_percentage": 0.28002414001207, "num_intersection": 464, "num_union": 2850, "num_only_computed": 1193, "num_only_roped": 1193, "total_diff": 2386, "diff_percentage": 0.8371929824561404, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "mask_shape": [1, 32, 1, 14014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:38:45.924576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 6.4849853515625e-05, "l2_diff": 0.06640625, "l2_diff_relative": 0.49635036496350365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "attention_shape": [1, 32, 1, 14014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:39:35.802316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15995799789989498, "overlap_percentage": 0.27579963789981893, "num_intersection": 457, "num_union": 2857, "num_only_computed": 1200, "num_only_roped": 1200, "total_diff": 2400, "diff_percentage": 0.840042002100105, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "mask_shape": [1, 32, 1, 14015], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:39:38.830201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.09130859375, "l2_diff_relative": 0.603225806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "attention_shape": [1, 32, 1, 14015]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:10.915108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:10.927595", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.9604644775390625e-06, "l2_diff": 0.02294921875, "l2_diff_relative": 0.003022119341563786}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:14.190967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6809284283022069, "overlap_percentage": 0.810181346019553, "num_intersection": 148503, "num_union": 218089, "num_only_computed": 34793, "num_only_roped": 34793, "total_diff": 69586, "diff_percentage": 0.3190715716977931, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:14.407099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 0.00010156631469726562, "l2_diff": 0.43359375, "l2_diff_relative": 0.069375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:22.282614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5678358851495526, "overlap_percentage": 0.7243562805623472, "num_intersection": 151686, "num_union": 267130, "num_only_computed": 57722, "num_only_roped": 57722, "total_diff": 115444, "diff_percentage": 0.43216411485044737, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:22.571881", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 0.0001468658447265625, "l2_diff": 0.7109375, "l2_diff_relative": 0.1315028901734104}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:32.653128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4897324718287364, "overlap_percentage": 0.6574770720108696, "num_intersection": 154849, "num_union": 316191, "num_only_computed": 80671, "num_only_roped": 80671, "total_diff": 161342, "diff_percentage": 0.5102675281712635, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:33.567041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 9.250640869140625e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.1159090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:45.924767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42797845045948024, "overlap_percentage": 0.5994186401367188, "num_intersection": 157134, "num_union": 367154, "num_only_computed": 105010, "num_only_roped": 105010, "total_diff": 210020, "diff_percentage": 0.5720215495405198, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:40:47.237932", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 5.412101745605469e-05, "l2_diff": 0.5078125, "l2_diff_relative": 0.07888349514563107}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:41:01.898530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3910022245921179, "overlap_percentage": 0.5621877775310835, "num_intersection": 162054, "num_union": 414458, "num_only_computed": 126202, "num_only_roped": 126202, "total_diff": 252404, "diff_percentage": 0.6089977754078821, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:41:02.420245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 8.487701416015625e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.1523224043715847}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:41:19.598519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35779396488985155, "overlap_percentage": 0.527022470480456, "num_intersection": 165679, "num_union": 463057, "num_only_computed": 148689, "num_only_roped": 148689, "total_diff": 297378, "diff_percentage": 0.6422060351101484, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:41:20.202534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 8.153915405273438e-05, "l2_diff": 0.9296875, "l2_diff_relative": 0.16346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:41:39.910034", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33181042980301345, "overlap_percentage": 0.4982847744360902, "num_intersection": 169656, "num_union": 511304, "num_only_computed": 170824, "num_only_roped": 170824, "total_diff": 341648, "diff_percentage": 0.6681895701969865, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:41:41.765312", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.12708333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:42:04.453660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31332375605893964, "overlap_percentage": 0.47714625523743015, "num_intersection": 174918, "num_union": 558266, "num_only_computed": 191674, "num_only_roped": 191674, "total_diff": 383348, "diff_percentage": 0.6866762439410603, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:42:05.208423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 5.269050598144531e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.13866120218579234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:42:32.836783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2826429459139438, "overlap_percentage": 0.4407196044921875, "num_intersection": 173298, "num_union": 613134, "num_only_computed": 219918, "num_only_roped": 219918, "total_diff": 439836, "diff_percentage": 0.7173570540860562, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:42:35.560655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.18785310734463276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:43:03.235687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27434983779184174, "overlap_percentage": 0.43057224893162394, "num_intersection": 180551, "num_union": 658105, "num_only_computed": 238777, "num_only_roped": 238777, "total_diff": 477554, "diff_percentage": 0.7256501622081583, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:43:04.201301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.20555555555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:43:34.759523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2626673507626631, "overlap_percentage": 0.4160515445402299, "num_intersection": 185326, "num_union": 705554, "num_only_computed": 260114, "num_only_roped": 260114, "total_diff": 520228, "diff_percentage": 0.7373326492373369, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:43:35.818062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.408203125, "l2_diff_relative": 0.061615566037735846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:44:09.569320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2424319471359371, "overlap_percentage": 0.39025388504343106, "num_intersection": 184025, "num_union": 759079, "num_only_computed": 287527, "num_only_roped": 287527, "total_diff": 575054, "diff_percentage": 0.7575680528640629, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:44:11.986302", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.1448087431693989}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:44:48.621447", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2297245706957453, "overlap_percentage": 0.37361955054012347, "num_intersection": 185937, "num_union": 809391, "num_only_computed": 311727, "num_only_roped": 311727, "total_diff": 623454, "diff_percentage": 0.7702754293042546, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:44:51.496214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.18098958333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:45:31.158517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21860843492509907, "overlap_percentage": 0.3587837219238281, "num_intersection": 188106, "num_union": 860470, "num_only_computed": 336182, "num_only_roped": 336182, "total_diff": 672364, "diff_percentage": 0.7813915650749009, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:45:33.583961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 4.076957702636719e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.1882183908045977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:46:15.843881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2115929012631032, "overlap_percentage": 0.34928052325581394, "num_intersection": 192244, "num_union": 908556, "num_only_computed": 358156, "num_only_roped": 358156, "total_diff": 716312, "diff_percentage": 0.7884070987368967, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:46:17.247914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.8203125, "l2_diff_relative": 0.15261627906976744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:47:02.945141", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20264764721957407, "overlap_percentage": 0.3370025255328597, "num_intersection": 194286, "num_union": 958738, "num_only_computed": 382226, "num_only_roped": 382226, "total_diff": 764452, "diff_percentage": 0.7973523527804259, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:47:04.525938", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.31543624161073824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:47:54.288660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1883250627809367, "overlap_percentage": 0.3169588333687341, "num_intersection": 191007, "num_union": 1014241, "num_only_computed": 411617, "num_only_roped": 411617, "total_diff": 823234, "diff_percentage": 0.8116749372190634, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:47:55.892774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 6.29425048828125e-05, "l2_diff": 1.875, "l2_diff_relative": 0.40540540540540543}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:48:47.517508", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17371565113500598, "overlap_percentage": 0.2960097719869707, "num_intersection": 186112, "num_union": 1071360, "num_only_computed": 442624, "num_only_roped": 442624, "total_diff": 885248, "diff_percentage": 0.826284348864994, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:48:49.248002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 8.487701416015625e-05, "l2_diff": 2.75, "l2_diff_relative": 0.704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:49:44.006490", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15876121325495807, "overlap_percentage": 0.27401885986328123, "num_intersection": 179581, "num_union": 1131139, "num_only_computed": 475779, "num_only_roped": 475779, "total_diff": 951558, "diff_percentage": 0.8412387867450419, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:49:45.807901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.5571428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:50:43.102337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1571112629840774, "overlap_percentage": 0.2715577455860255, "num_intersection": 185059, "num_union": 1177885, "num_only_computed": 496413, "num_only_roped": 496413, "total_diff": 992826, "diff_percentage": 0.8428887370159226, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:50:45.737724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.60546875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:51:46.266585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15421876006763, "overlap_percentage": 0.26722622331765555, "num_intersection": 189085, "num_union": 1226083, "num_only_computed": 518499, "num_only_roped": 518499, "total_diff": 1036998, "diff_percentage": 0.84578123993237, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:51:48.260891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 8.0108642578125e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.806930693069307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:52:52.863873", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15305166680286905, "overlap_percentage": 0.2654723482205164, "num_intersection": 194776, "num_union": 1272616, "num_only_computed": 538920, "num_only_roped": 538920, "total_diff": 1077840, "diff_percentage": 0.8469483331971309, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:52:54.988403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 8.440017700195312e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.9836956521739131}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:54:02.711691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1505130161960485, "overlap_percentage": 0.2616450471698113, "num_intersection": 198800, "num_union": 1320816, "num_only_computed": 561008, "num_only_roped": 561008, "total_diff": 1122016, "diff_percentage": 0.8494869838039515, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:54:04.970070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2236328125, "mean_diff": 8.96453857421875e-05, "l2_diff": 2.90625, "l2_diff_relative": 1.0449438202247192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:55:15.939829", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14665640200160968, "overlap_percentage": 0.25579833984375, "num_intersection": 201168, "num_union": 1371696, "num_only_computed": 585264, "num_only_roped": 585264, "total_diff": 1170528, "diff_percentage": 0.8533435979983903, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:55:18.328214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.487701416015625e-05, "l2_diff": 2.859375, "l2_diff_relative": 1.0517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:56:33.606994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14355439681651697, "overlap_percentage": 0.2510670191398866, "num_intersection": 204003, "num_union": 1421085, "num_only_computed": 608541, "num_only_roped": 608541, "total_diff": 1217082, "diff_percentage": 0.8564456031834831, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:56:36.094476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 8.726119995117188e-05, "l2_diff": 2.796875, "l2_diff_relative": 1.1401273885350318}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:57:54.776827", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14264771100818371, "overlap_percentage": 0.2496792487026862, "num_intersection": 209395, "num_union": 1467917, "num_only_computed": 629261, "num_only_roped": 629261, "total_diff": 1258522, "diff_percentage": 0.8573522889918163, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:57:57.451861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 7.724761962890625e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.9543147208121827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:59:21.464274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13525275339830298, "overlap_percentage": 0.23827778086145648, "num_intersection": 206055, "num_union": 1523481, "num_only_computed": 658713, "num_only_roped": 658713, "total_diff": 1317426, "diff_percentage": 0.864747246601697, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T13:59:26.509620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1962890625, "mean_diff": 7.963180541992188e-05, "l2_diff": 3.140625, "l2_diff_relative": 1.0691489361702127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:00:51.201517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1334351145038168, "overlap_percentage": 0.23545258620689655, "num_intersection": 209760, "num_union": 1572000, "num_only_computed": 681120, "num_only_roped": 681120, "total_diff": 1362240, "diff_percentage": 0.8665648854961832, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:00:54.043380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.9836956521739131}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:02:21.925355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13477900043412064, "overlap_percentage": 0.23754228864397323, "num_intersection": 217946, "num_union": 1617062, "num_only_computed": 699558, "num_only_roped": 699558, "total_diff": 1399116, "diff_percentage": 0.8652209995658794, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:02:26.425915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.8125, "l2_diff_relative": 1.0650887573964498}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:03:50.412147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13077054691582388, "overlap_percentage": 0.23129457567231565, "num_intersection": 28279, "num_union": 216249, "num_only_computed": 93985, "num_only_roped": 93985, "total_diff": 187970, "diff_percentage": 0.8692294530841761, "num_computed": 122264, "num_roped": 122264}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "mask_shape": [1, 32, 68, 15428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:03:53.016418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09912109375, "mean_diff": 5.269050598144531e-05, "l2_diff": 0.6328125, "l2_diff_relative": 0.3932038834951456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "attention_shape": [1, 32, 68, 15428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:05:09.104126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12882620374149337, "overlap_percentage": 0.22824807452998352, "num_intersection": 13573, "num_union": 105359, "num_only_computed": 45893, "num_only_roped": 45893, "total_diff": 91786, "diff_percentage": 0.8711737962585067, "num_computed": 59466, "num_roped": 59466}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "mask_shape": [1, 32, 33, 15461], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:05:11.461050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.3984375, "l2_diff_relative": 0.3722627737226277}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "attention_shape": [1, 32, 33, 15461]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:06:17.396753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13762626262626262, "overlap_percentage": 0.24195338512763595, "num_intersection": 436, "num_union": 3168, "num_only_computed": 1366, "num_only_roped": 1366, "total_diff": 2732, "diff_percentage": 0.8623737373737373, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "mask_shape": [1, 32, 1, 15462], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:06:19.198047", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 6.008148193359375e-05, "l2_diff": 0.05810546875, "l2_diff_relative": 0.536036036036036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "attention_shape": [1, 32, 1, 15462]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:07:15.259797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13726727674345218, "overlap_percentage": 0.2413984461709212, "num_intersection": 435, "num_union": 3169, "num_only_computed": 1367, "num_only_roped": 1367, "total_diff": 2734, "diff_percentage": 0.8627327232565478, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "mask_shape": [1, 32, 1, 15463], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:07:17.081168", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025634765625, "mean_diff": 4.1961669921875e-05, "l2_diff": 0.049072265625, "l2_diff_relative": 0.337248322147651}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "attention_shape": [1, 32, 1, 15463]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:07:49.322243", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:07:51.654539", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.16908073425293e-06, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.0030634076763485477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:07:54.978694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6836922624706634, "overlap_percentage": 0.812134471019553, "num_intersection": 148861, "num_union": 217731, "num_only_computed": 34435, "num_only_roped": 34435, "total_diff": 68870, "diff_percentage": 0.31630773752933666, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:07:55.197320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 0.00013828277587890625, "l2_diff": 0.54296875, "l2_diff_relative": 0.09096858638743456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:03.206079", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5577185576404515, "overlap_percentage": 0.7160710192542787, "num_intersection": 149951, "num_union": 268865, "num_only_computed": 59457, "num_only_roped": 59457, "total_diff": 118914, "diff_percentage": 0.44228144235954847, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:05.536654", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.08717948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:15.789637", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47386997252764446, "overlap_percentage": 0.6430281929347826, "num_intersection": 151446, "num_union": 319594, "num_only_computed": 84074, "num_only_roped": 84074, "total_diff": 168148, "diff_percentage": 0.5261300274723556, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:16.162080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.11202185792349727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:28.796716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42519524507232154, "overlap_percentage": 0.5966835021972656, "num_intersection": 156417, "num_union": 367871, "num_only_computed": 105727, "num_only_roped": 105727, "total_diff": 211454, "diff_percentage": 0.5748047549276785, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:29.243283", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 9.34600830078125e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.14924242424242423}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:44.424463", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38327910704173984, "overlap_percentage": 0.5541601909413855, "num_intersection": 159740, "num_union": 416772, "num_only_computed": 128516, "num_only_roped": 128516, "total_diff": 257032, "diff_percentage": 0.6167208929582602, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:08:46.915230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.1987179487179487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:09:05.683437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35211170680619264, "overlap_percentage": 0.520832273004886, "num_intersection": 163733, "num_union": 465003, "num_only_computed": 150635, "num_only_roped": 150635, "total_diff": 301270, "diff_percentage": 0.6478882931938074, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:09:06.307418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.10758706467661691}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:09:26.505552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3257353785771162, "overlap_percentage": 0.4914033129699248, "num_intersection": 167313, "num_union": 513647, "num_only_computed": 173167, "num_only_roped": 173167, "total_diff": 346334, "diff_percentage": 0.6742646214228838, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:09:28.647077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.13674033149171272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:09:51.772985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3014184208330893, "overlap_percentage": 0.46321523655726254, "num_intersection": 169811, "num_union": 563373, "num_only_computed": 196781, "num_only_roped": 196781, "total_diff": 393562, "diff_percentage": 0.6985815791669108, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:09:52.542900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.12962962962962962}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:10:18.418240", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29329500529532104, "overlap_percentage": 0.4535624186197917, "num_intersection": 178348, "num_union": 608084, "num_only_computed": 214868, "num_only_roped": 214868, "total_diff": 429736, "diff_percentage": 0.706704994704679, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:10:19.278423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.4921875, "l2_diff_relative": 0.07682926829268293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:10:47.277639", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28121042315618694, "overlap_percentage": 0.4389761713980464, "num_intersection": 184075, "num_union": 654581, "num_only_computed": 235253, "num_only_roped": 235253, "total_diff": 470506, "diff_percentage": 0.7187895768438131, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:10:49.943598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.10842541436464088}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:11:20.874291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26079997282758677, "overlap_percentage": 0.4137055495689655, "num_intersection": 184281, "num_union": 706599, "num_only_computed": 261159, "num_only_roped": 261159, "total_diff": 522318, "diff_percentage": 0.7392000271724132, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:11:21.916868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.555152893066406e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.2059748427672956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:11:55.415708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2470780203927003, "overlap_percentage": 0.39625110274158526, "num_intersection": 186853, "num_union": 756251, "num_only_computed": 284699, "num_only_roped": 284699, "total_diff": 569398, "diff_percentage": 0.7529219796072997, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:11:57.885234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.1816860465116279}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:12:34.157431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24044641354943638, "overlap_percentage": 0.38767722800925924, "num_intersection": 192933, "num_union": 802395, "num_only_computed": 304731, "num_only_roped": 304731, "total_diff": 609462, "diff_percentage": 0.7595535864505636, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:12:35.360854", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.08183856502242152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:13:14.626313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23202154383375906, "overlap_percentage": 0.3766517639160156, "num_intersection": 197474, "num_union": 851102, "num_only_computed": 326814, "num_only_roped": 326814, "total_diff": 653628, "diff_percentage": 0.7679784561662409, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:13:15.920442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.484375, "l2_diff_relative": 0.07560975609756097}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:13:58.279219", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22210898174607932, "overlap_percentage": 0.363484738372093, "num_intersection": 200062, "num_union": 900738, "num_only_computed": 350338, "num_only_roped": 350338, "total_diff": 700676, "diff_percentage": 0.7778910182539207, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:14:01.323209", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.0517578125e-05, "l2_diff": 0.7890625, "l2_diff_relative": 0.14511494252873564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:14:46.856306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20720833909179617, "overlap_percentage": 0.34328513543516875, "num_intersection": 197908, "num_union": 955116, "num_only_computed": 378604, "num_only_roped": 378604, "total_diff": 757208, "diff_percentage": 0.7927916609082039, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:14:48.571170", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 4.696846008300781e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.25606060606060604}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:15:36.867406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19108716469889483, "overlap_percentage": 0.3208617645497026, "num_intersection": 193359, "num_union": 1011889, "num_only_computed": 409265, "num_only_roped": 409265, "total_diff": 818530, "diff_percentage": 0.8089128353011051, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:15:39.404146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 5.53131103515625e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.3669064748201439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:16:30.728395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1737003138026497, "overlap_percentage": 0.29598750508957655, "num_intersection": 186098, "num_union": 1071374, "num_only_computed": 442638, "num_only_roped": 442638, "total_diff": 885276, "diff_percentage": 0.8262996861973503, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:16:33.852019", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 8.440017700195312e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.7738693467336684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:17:28.299251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1608373276085008, "overlap_percentage": 0.277105712890625, "num_intersection": 181604, "num_union": 1129116, "num_only_computed": 473756, "num_only_roped": 473756, "total_diff": 947512, "diff_percentage": 0.8391626723914992, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:17:30.117098", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.625, "l2_diff_relative": 0.672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:18:27.709672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1594530355438424, "overlap_percentage": 0.27504871806912096, "num_intersection": 187438, "num_union": 1175506, "num_only_computed": 494034, "num_only_roped": 494034, "total_diff": 988068, "diff_percentage": 0.8405469644561576, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:18:29.608716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 9.298324584960938e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.9015544041450777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:19:29.007526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15504932449883613, "overlap_percentage": 0.2684722136279512, "num_intersection": 95451, "num_union": 615617, "num_only_computed": 260083, "num_only_roped": 260083, "total_diff": 520166, "diff_percentage": 0.8449506755011639, "num_computed": 355534, "num_roped": 355534}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 262, "seq_len_k": 11014, "queries_shape": [1, 32, 262, 128], "keys_shape": [1, 8, 11014, 128], "mask_shape": [1, 32, 262, 11014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:19:31.746304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 8.487701416015625e-05, "l2_diff": 1.796875, "l2_diff_relative": 0.7718120805369127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 262, "seq_len_k": 11014, "queries_shape": [1, 32, 262, 128], "keys_shape": [1, 8, 11014, 128], "attention_shape": [1, 32, 262, 11014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:20:27.201311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1593405837950805, "overlap_percentage": 0.2748814041745731, "num_intersection": 11589, "num_union": 72731, "num_only_computed": 30571, "num_only_roped": 30571, "total_diff": 61142, "diff_percentage": 0.8406594162049195, "num_computed": 42160, "num_roped": 42160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "mask_shape": [1, 32, 31, 11045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:20:28.839099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08154296875, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.4140625, "l2_diff_relative": 0.39849624060150374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "attention_shape": [1, 32, 31, 11045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:21:15.202648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16938950988822013, "overlap_percentage": 0.2897058823529412, "num_intersection": 394, "num_union": 2326, "num_only_computed": 966, "num_only_roped": 966, "total_diff": 1932, "diff_percentage": 0.8306104901117799, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "mask_shape": [1, 32, 1, 11046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:21:16.958463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.040771484375, "mean_diff": 7.915496826171875e-05, "l2_diff": 0.07861328125, "l2_diff_relative": 0.6851063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "attention_shape": [1, 32, 1, 11046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:21:58.436919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15991471215351813, "overlap_percentage": 0.2757352941176471, "num_intersection": 375, "num_union": 2345, "num_only_computed": 985, "num_only_roped": 985, "total_diff": 1970, "diff_percentage": 0.8400852878464818, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "mask_shape": [1, 32, 1, 11047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:22:00.997385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 7.390975952148438e-05, "l2_diff": 0.07958984375, "l2_diff_relative": 0.5620689655172414}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "attention_shape": [1, 32, 1, 11047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:22:41.680302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15892628887942054, "overlap_percentage": 0.27426470588235297, "num_intersection": 373, "num_union": 2347, "num_only_computed": 987, "num_only_roped": 987, "total_diff": 1974, "diff_percentage": 0.8410737111205795, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "mask_shape": [1, 32, 1, 11048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:22:42.981529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.0478515625, "l2_diff_relative": 0.2552083333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "attention_shape": [1, 32, 1, 11048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:11.212819", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:11.225340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.079673767089844e-06, "l2_diff": 0.0213623046875, "l2_diff_relative": 0.002959280303030303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:14.619105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.690610588452315, "overlap_percentage": 0.8169954608938548, "num_intersection": 149752, "num_union": 216840, "num_only_computed": 33544, "num_only_roped": 33544, "total_diff": 67088, "diff_percentage": 0.30938941154768496, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:14.843630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 8.678436279296875e-05, "l2_diff": 0.37890625, "l2_diff_relative": 0.0566588785046729}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:22.870936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5701635337077388, "overlap_percentage": 0.726247325794621, "num_intersection": 152082, "num_union": 266734, "num_only_computed": 57326, "num_only_roped": 57326, "total_diff": 114652, "diff_percentage": 0.4298364662922612, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:23.166005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.07465277777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:33.561083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48871548353860694, "overlap_percentage": 0.6565599524456521, "num_intersection": 154633, "num_union": 316407, "num_only_computed": 80887, "num_only_roped": 80887, "total_diff": 161774, "diff_percentage": 0.5112845164613931, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:35.610029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 7.62939453125e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.09558823529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:48.369006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4328292945552334, "overlap_percentage": 0.6041603088378906, "num_intersection": 158377, "num_union": 365911, "num_only_computed": 103767, "num_only_roped": 103767, "total_diff": 207534, "diff_percentage": 0.5671707054447667, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:23:49.257918", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.0001125335693359375, "l2_diff": 0.953125, "l2_diff_relative": 0.17630057803468208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:24:04.403299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3887806205901412, "overlap_percentage": 0.5598877386767318, "num_intersection": 161391, "num_union": 415121, "num_only_computed": 126865, "num_only_roped": 126865, "total_diff": 253730, "diff_percentage": 0.6112193794098588, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:24:04.942379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.11402439024390244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:24:23.159274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3547191601954717, "overlap_percentage": 0.5236792548859935, "num_intersection": 164628, "num_union": 464108, "num_only_computed": 149740, "num_only_roped": 149740, "total_diff": 299480, "diff_percentage": 0.6452808398045282, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:24:23.778986", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.8125, "l2_diff_relative": 0.12807881773399016}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:24:44.127224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3207828959235647, "overlap_percentage": 0.4857465930451128, "num_intersection": 165387, "num_union": 515573, "num_only_computed": 175093, "num_only_roped": 175093, "total_diff": 350186, "diff_percentage": 0.6792171040764353, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:24:44.821035", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.13177339901477833}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:25:08.465507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29649821135221066, "overlap_percentage": 0.4573831398393855, "num_intersection": 167673, "num_union": 565511, "num_only_computed": 198919, "num_only_roped": 198919, "total_diff": 397838, "diff_percentage": 0.7035017886477893, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:25:11.526535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.11615566037735849}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:25:37.368514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2840209249015472, "overlap_percentage": 0.4423929850260417, "num_intersection": 173956, "num_union": 612476, "num_only_computed": 219260, "num_only_roped": 219260, "total_diff": 438520, "diff_percentage": 0.7159790750984528, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:25:39.333261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.12796208530805686}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:26:07.776042", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28305489260143196, "overlap_percentage": 0.4412202380952381, "num_intersection": 185016, "num_union": 653640, "num_only_computed": 234312, "num_only_roped": 234312, "total_diff": 468624, "diff_percentage": 0.716945107398568, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:26:08.749771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 4.9114227294921875e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.16071428571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:26:40.024345", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2629304784330181, "overlap_percentage": 0.41638155531609194, "num_intersection": 185473, "num_union": 705407, "num_only_computed": 259967, "num_only_roped": 259967, "total_diff": 519934, "diff_percentage": 0.7370695215669819, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:26:41.086086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.696846008300781e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.17063492063492064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:27:15.565554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25729765472521143, "overlap_percentage": 0.4092867806731813, "num_intersection": 193000, "num_union": 750104, "num_only_computed": 278552, "num_only_roped": 278552, "total_diff": 557104, "diff_percentage": 0.7427023452747885, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:27:16.683923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.1001131221719457}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:27:52.886381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2423120608095458, "overlap_percentage": 0.39009854038065844, "num_intersection": 194138, "num_union": 801190, "num_only_computed": 303526, "num_only_roped": 303526, "total_diff": 607052, "diff_percentage": 0.7576879391904542, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:27:55.716282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:28:34.595288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2273664743132045, "overlap_percentage": 0.3704948425292969, "num_intersection": 194246, "num_union": 854330, "num_only_computed": 330042, "num_only_roped": 330042, "total_diff": 660084, "diff_percentage": 0.7726335256867956, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:28:38.020620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.673004150390625e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.21932515337423314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:29:20.246649", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21852674272127307, "overlap_percentage": 0.3586736918604651, "num_intersection": 197414, "num_union": 903386, "num_only_computed": 352986, "num_only_roped": 352986, "total_diff": 705972, "diff_percentage": 0.781473257278727, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:29:21.647821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.15898058252427186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:30:08.025469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20352386121665067, "overlap_percentage": 0.33821325488454707, "num_intersection": 194984, "num_union": 958040, "num_only_computed": 381528, "num_only_roped": 381528, "total_diff": 763056, "diff_percentage": 0.7964761387833493, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:30:09.528333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 4.673004150390625e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.2818181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:30:59.858419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18729842244940983, "overlap_percentage": 0.31550353122344943, "num_intersection": 190130, "num_union": 1015118, "num_only_computed": 412494, "num_only_roped": 412494, "total_diff": 824988, "diff_percentage": 0.8127015775505901, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:31:01.460440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.963180541992188e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.5827338129496403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:31:52.956613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17263644383435944, "overlap_percentage": 0.29444154621335505, "num_intersection": 185126, "num_union": 1072346, "num_only_computed": 443610, "num_only_roped": 443610, "total_diff": 887220, "diff_percentage": 0.8273635561656406, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:31:54.689696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 8.153915405273438e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.6532846715328468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:32:49.001447", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1602362040929414, "overlap_percentage": 0.27621307373046877, "num_intersection": 181019, "num_union": 1129701, "num_only_computed": 474341, "num_only_roped": 474341, "total_diff": 948682, "diff_percentage": 0.8397637959070586, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:32:50.808778", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 9.918212890625e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.9797979797979798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:33:47.913194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1568873274465183, "overlap_percentage": 0.27122317571374904, "num_intersection": 184831, "num_union": 1178113, "num_only_computed": 496641, "num_only_roped": 496641, "total_diff": 993282, "diff_percentage": 0.8431126725534817, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:33:52.071913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 9.441375732421875e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.914572864321608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:34:52.643783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1564560586609093, "overlap_percentage": 0.27057847548842257, "num_intersection": 191457, "num_union": 1223711, "num_only_computed": 516127, "num_only_roped": 516127, "total_diff": 1032254, "diff_percentage": 0.8435439413390907, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:34:54.624104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 8.58306884765625e-05, "l2_diff": 3.0625, "l2_diff_relative": 0.8558951965065502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:35:58.355207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1560566860052879, "overlap_percentage": 0.2699810275645499, "num_intersection": 198084, "num_union": 1269308, "num_only_computed": 535612, "num_only_roped": 535612, "total_diff": 1071224, "diff_percentage": 0.8439433139947121, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:36:00.480629", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 8.20159912109375e-05, "l2_diff": 3.171875, "l2_diff_relative": 0.8388429752066116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:37:06.759068", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15244915618646182, "overlap_percentage": 0.26456552181603776, "num_intersection": 201019, "num_union": 1318597, "num_only_computed": 558789, "num_only_roped": 558789, "total_diff": 1117578, "diff_percentage": 0.8475508438135382, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:37:08.927828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.201171875, "mean_diff": 9.059906005859375e-05, "l2_diff": 4.03125, "l2_diff_relative": 1.167420814479638}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:38:16.899625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15056011446612466, "overlap_percentage": 0.26171620686848956, "num_intersection": 205822, "num_union": 1367042, "num_only_computed": 580610, "num_only_roped": 580610, "total_diff": 1161220, "diff_percentage": 0.8494398855338753, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:38:19.200973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.22265625, "mean_diff": 9.393692016601562e-05, "l2_diff": 3.78125, "l2_diff_relative": 1.3519553072625698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:39:31.450506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1488390637857464, "overlap_percentage": 0.25911212192816635, "num_intersection": 210540, "num_union": 1414548, "num_only_computed": 602004, "num_only_roped": 602004, "total_diff": 1204008, "diff_percentage": 0.8511609362142536, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:39:34.185855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 6.580352783203125e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.6811023622047244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:40:50.014112", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14236755053712616, "overlap_percentage": 0.24924999046092797, "num_intersection": 209035, "num_union": 1468277, "num_only_computed": 629621, "num_only_roped": 629621, "total_diff": 1259242, "diff_percentage": 0.8576324494628739, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:40:52.539128", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1826171875, "mean_diff": 8.0108642578125e-05, "l2_diff": 3.328125, "l2_diff_relative": 1.065}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:42:12.793387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13993977130496166, "overlap_percentage": 0.2455213421403197, "num_intersection": 212319, "num_union": 1517217, "num_only_computed": 652449, "num_only_roped": 652449, "total_diff": 1304898, "diff_percentage": 0.8600602286950384, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:42:15.476605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.534027099609375e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.9651741293532339}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:43:39.558018", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13548867321753016, "overlap_percentage": 0.2386438128591954, "num_intersection": 212603, "num_union": 1569157, "num_only_computed": 678277, "num_only_roped": 678277, "total_diff": 1356554, "diff_percentage": 0.8645113267824698, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:43:42.755434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 6.532669067382812e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.7727272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:45:04.736705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13880098016845405, "overlap_percentage": 0.24376687864796584, "num_intersection": 111928, "num_union": 806392, "num_only_computed": 347232, "num_only_roped": 347232, "total_diff": 694464, "diff_percentage": 0.8611990198315459, "num_computed": 459160, "num_roped": 459160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15108, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15108, 128], "mask_shape": [1, 32, 260, 15108], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:45:07.560664", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.152557373046875e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.8554216867469879}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15108, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15108, 128], "attention_shape": [1, 32, 260, 15108]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:46:21.513685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13998652567444858, "overlap_percentage": 0.24559329873066446, "num_intersection": 9558, "num_union": 68278, "num_only_computed": 29360, "num_only_roped": 29360, "total_diff": 58720, "diff_percentage": 0.8600134743255514, "num_computed": 38918, "num_roped": 38918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "mask_shape": [1, 32, 22, 15130], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:46:23.597160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.33984375, "l2_diff_relative": 0.3438735177865613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "attention_shape": [1, 32, 22, 15130]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:47:23.749075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14055448098001289, "overlap_percentage": 0.24646693046919163, "num_intersection": 436, "num_union": 3102, "num_only_computed": 1333, "num_only_roped": 1333, "total_diff": 2666, "diff_percentage": 0.8594455190199871, "num_computed": 1769, "num_roped": 1769}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "mask_shape": [1, 32, 1, 15131], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:47:25.528147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.0791015625, "l2_diff_relative": 0.4764705882352941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "attention_shape": [1, 32, 1, 15131]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:48:18.629096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14129032258064517, "overlap_percentage": 0.2475975127190503, "num_intersection": 438, "num_union": 3100, "num_only_computed": 1331, "num_only_roped": 1331, "total_diff": 2662, "diff_percentage": 0.8587096774193549, "num_computed": 1769, "num_roped": 1769}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15132, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15132, 128], "mask_shape": [1, 32, 1, 15132], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:48:20.323651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.05419921875, "l2_diff_relative": 0.21183206106870228}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15132, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15132, 128], "attention_shape": [1, 32, 1, 15132]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:48:49.077515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:48:49.089852", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.022705078125, "l2_diff_relative": 0.003200715859030837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:48:52.344753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6801734292143895, "overlap_percentage": 0.8096466916899442, "num_intersection": 148405, "num_union": 218187, "num_only_computed": 34891, "num_only_roped": 34891, "total_diff": 69782, "diff_percentage": 0.3198265707856105, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:48:52.561208", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.00014495849609375, "l2_diff": 0.53125, "l2_diff_relative": 0.08900523560209424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:00.310039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5612083619121463, "overlap_percentage": 0.7189410146699267, "num_intersection": 150552, "num_union": 268264, "num_only_computed": 58856, "num_only_roped": 58856, "total_diff": 117712, "diff_percentage": 0.43879163808785376, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:00.605031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.0001239776611328125, "l2_diff": 0.71484375, "l2_diff_relative": 0.11852331606217617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:10.617534", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4817238125196603, "overlap_percentage": 0.6502207880434783, "num_intersection": 153140, "num_union": 317900, "num_only_computed": 82380, "num_only_roped": 82380, "total_diff": 164760, "diff_percentage": 0.5182761874803398, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:13.334995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.00010395050048828125, "l2_diff": 0.8125, "l2_diff_relative": 0.13756613756613756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:25.693453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42315647750530677, "overlap_percentage": 0.5946731567382812, "num_intersection": 155890, "num_union": 368398, "num_only_computed": 106254, "num_only_roped": 106254, "total_diff": 212508, "diff_percentage": 0.5768435224946933, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:27.495664", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 0.00010585784912109375, "l2_diff": 0.92578125, "l2_diff_relative": 0.16188524590163936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:42.145244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3735600553701149, "overlap_percentage": 0.5439297013765542, "num_intersection": 156791, "num_union": 419721, "num_only_computed": 131465, "num_only_roped": 131465, "total_diff": 262930, "diff_percentage": 0.6264399446298851, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:42.653233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 7.486343383789062e-05, "l2_diff": 0.78515625, "l2_diff_relative": 0.13958333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:49:59.763967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34686620366998416, "overlap_percentage": 0.5150715085504886, "num_intersection": 161922, "num_union": 466814, "num_only_computed": 152446, "num_only_roped": 152446, "total_diff": 304892, "diff_percentage": 0.6531337963300158, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:50:00.367253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 7.772445678710938e-05, "l2_diff": 0.875, "l2_diff_relative": 0.16766467065868262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:50:20.016414", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32427097614810924, "overlap_percentage": 0.48973507988721804, "num_intersection": 166745, "num_union": 514215, "num_only_computed": 173735, "num_only_roped": 173735, "total_diff": 347470, "diff_percentage": 0.6757290238518907, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:50:22.929531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 8.821487426757812e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.21474358974358973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:50:45.195660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30490899965472196, "overlap_percentage": 0.46732607367318435, "num_intersection": 171318, "num_union": 561866, "num_only_computed": 195274, "num_only_roped": 195274, "total_diff": 390548, "diff_percentage": 0.695091000345278, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:50:45.956534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.83984375, "l2_diff_relative": 0.15357142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:51:11.365137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27577441254957946, "overlap_percentage": 0.43232472737630206, "num_intersection": 169997, "num_union": 616435, "num_only_computed": 223219, "num_only_roped": 223219, "total_diff": 446438, "diff_percentage": 0.7242255874504205, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:51:12.250837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.12850467289719625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:51:37.186725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2855950282905111, "overlap_percentage": 0.4443001443001443, "num_intersection": 9237, "num_union": 32343, "num_only_computed": 11553, "num_only_roped": 11553, "total_diff": 23106, "diff_percentage": 0.7144049717094889, "num_computed": 20790, "num_roped": 20790}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "mask_shape": [1, 32, 27, 5147], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:51:37.923344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.26953125, "l2_diff_relative": 0.24125874125874125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "attention_shape": [1, 32, 27, 5147]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:51:59.293517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2510154346060114, "overlap_percentage": 0.4012987012987013, "num_intersection": 309, "num_union": 1231, "num_only_computed": 461, "num_only_roped": 461, "total_diff": 922, "diff_percentage": 0.7489845653939886, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "mask_shape": [1, 32, 1, 5148], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:52:00.371585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.13580246913580246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "attention_shape": [1, 32, 1, 5148]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:52:20.536920", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26957955482275353, "overlap_percentage": 0.42467532467532465, "num_intersection": 327, "num_union": 1213, "num_only_computed": 443, "num_only_roped": 443, "total_diff": 886, "diff_percentage": 0.7304204451772465, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "mask_shape": [1, 32, 1, 5149], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:52:21.170088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.1797872340425532}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "attention_shape": [1, 32, 1, 5149]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:52:40.774248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2701812191103789, "overlap_percentage": 0.4254215304798962, "num_intersection": 328, "num_union": 1214, "num_only_computed": 443, "num_only_roped": 443, "total_diff": 886, "diff_percentage": 0.729818780889621, "num_computed": 771, "num_roped": 771}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "mask_shape": [1, 32, 1, 5150], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:52:41.426565", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 3.6716461181640625e-05, "l2_diff": 0.022705078125, "l2_diff_relative": 0.10108695652173913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "attention_shape": [1, 32, 1, 5150]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:52:56.771655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:52:56.784110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.258487701416016e-06, "l2_diff": 0.02392578125, "l2_diff_relative": 0.0031507201646090535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:00.123220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6846903980661943, "overlap_percentage": 0.812838250698324, "num_intersection": 148990, "num_union": 217602, "num_only_computed": 34306, "num_only_roped": 34306, "total_diff": 68612, "diff_percentage": 0.31530960193380575, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:00.346858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 0.0001392364501953125, "l2_diff": 0.5703125, "l2_diff_relative": 0.09125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:08.281797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5661356667414554, "overlap_percentage": 0.722971424205379, "num_intersection": 151396, "num_union": 267420, "num_only_computed": 58012, "num_only_roped": 58012, "total_diff": 116024, "diff_percentage": 0.4338643332585446, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:08.651024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 0.00010061264038085938, "l2_diff": 0.55078125, "l2_diff_relative": 0.09276315789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:18.908801", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5002277222362005, "overlap_percentage": 0.6668690557065218, "num_intersection": 157061, "num_union": 313979, "num_only_computed": 78459, "num_only_roped": 78459, "total_diff": 156918, "diff_percentage": 0.4997722777637995, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:19.277452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00012302398681640625, "l2_diff": 0.80078125, "l2_diff_relative": 0.15916149068322982}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:34.294962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.448837697724032, "overlap_percentage": 0.6195831298828125, "num_intersection": 162420, "num_union": 361868, "num_only_computed": 99724, "num_only_roped": 99724, "total_diff": 199448, "diff_percentage": 0.5511623022759681, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:36.308280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 9.5367431640625e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.14026162790697674}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:51.358299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.408225428626563, "overlap_percentage": 0.5797728408081705, "num_intersection": 167123, "num_union": 409389, "num_only_computed": 121133, "num_only_roped": 121133, "total_diff": 242266, "diff_percentage": 0.591774571373437, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:53:51.890521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 9.72747802734375e-05, "l2_diff": 0.8125, "l2_diff_relative": 0.18571428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:54:09.494097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36451551296074447, "overlap_percentage": 0.5342782980456026, "num_intersection": 167960, "num_union": 460776, "num_only_computed": 146408, "num_only_roped": 146408, "total_diff": 292816, "diff_percentage": 0.6354844870392555, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:54:10.114389", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 9.1552734375e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.19332298136645962}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:54:30.406547", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33340121481748364, "overlap_percentage": 0.5000763627819549, "num_intersection": 170266, "num_union": 510694, "num_only_computed": 170214, "num_only_roped": 170214, "total_diff": 340428, "diff_percentage": 0.6665987851825164, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:54:31.554069", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.21283783783783783}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:54:54.814109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3151919465157954, "overlap_percentage": 0.4793094230097765, "num_intersection": 175711, "num_union": 557473, "num_only_computed": 190881, "num_only_roped": 190881, "total_diff": 381762, "diff_percentage": 0.6848080534842046, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:54:55.604572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.0, "l2_diff_relative": 0.1871345029239766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:55:23.814436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2898375303830977, "overlap_percentage": 0.4494171142578125, "num_intersection": 176718, "num_union": 609714, "num_only_computed": 216498, "num_only_roped": 216498, "total_diff": 432996, "diff_percentage": 0.7101624696169023, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:55:26.733134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.9087066650390625e-05, "l2_diff": 0.515625, "l2_diff_relative": 0.0825}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:55:54.726225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2913624920122876, "overlap_percentage": 0.4512481875763126, "num_intersection": 189221, "num_union": 649435, "num_only_computed": 230107, "num_only_roped": 230107, "total_diff": 460214, "diff_percentage": 0.7086375079877124, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:55:55.680113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.1427469135802469}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:56:26.454618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2778133969027139, "overlap_percentage": 0.43482623922413793, "num_intersection": 193689, "num_union": 697191, "num_only_computed": 251751, "num_only_roped": 251751, "total_diff": 503502, "diff_percentage": 0.7221866030972861, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:56:27.506655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.41015625, "l2_diff_relative": 0.05965909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:57:01.857875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2602327498773981, "overlap_percentage": 0.4129915682681867, "num_intersection": 194747, "num_union": 748357, "num_only_computed": 276805, "num_only_roped": 276805, "total_diff": 553610, "diff_percentage": 0.7397672501226019, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:57:03.713298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.453125, "l2_diff_relative": 0.07107843137254902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:57:40.747937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2422050797557344, "overlap_percentage": 0.38995989261831276, "num_intersection": 194069, "num_union": 801259, "num_only_computed": 303595, "num_only_roped": 303595, "total_diff": 607190, "diff_percentage": 0.7577949202442655, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:57:43.746651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.44921875, "l2_diff_relative": 0.07334183673469388}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:58:23.573238", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22366538532454833, "overlap_percentage": 0.3655662536621094, "num_intersection": 191662, "num_union": 856914, "num_only_computed": 332626, "num_only_roped": 332626, "total_diff": 665252, "diff_percentage": 0.7763346146754517, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:58:26.559327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.10013089005235602}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:59:08.421061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20037729882393993, "overlap_percentage": 0.33385719476744186, "num_intersection": 183755, "num_union": 917045, "num_only_computed": 366645, "num_only_roped": 366645, "total_diff": 733290, "diff_percentage": 0.79962270117606, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:59:09.796080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.19863013698630136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:59:54.986840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1896472918805425, "overlap_percentage": 0.31882944327264656, "num_intersection": 183809, "num_union": 969215, "num_only_computed": 392703, "num_only_roped": 392703, "total_diff": 785406, "diff_percentage": 0.8103527081194575, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T14:59:56.458506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 6.008148193359375e-05, "l2_diff": 1.34375, "l2_diff_relative": 0.35537190082644626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:00:44.909030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17130248274749485, "overlap_percentage": 0.29249913710705183, "num_intersection": 176267, "num_union": 1028981, "num_only_computed": 426357, "num_only_roped": 426357, "total_diff": 852714, "diff_percentage": 0.8286975172525052, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:00:46.522675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 1.6015625, "l2_diff_relative": 0.34395973154362414}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:01:38.077767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15562131536987597, "overlap_percentage": 0.26932925743078173, "num_intersection": 169337, "num_union": 1088135, "num_only_computed": 459399, "num_only_roped": 459399, "total_diff": 918798, "diff_percentage": 0.844378684630124, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:01:41.157319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11572265625, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.551440329218107}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:02:35.514237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1493077689985383, "overlap_percentage": 0.25982208251953126, "num_intersection": 170277, "num_union": 1140443, "num_only_computed": 485083, "num_only_roped": 485083, "total_diff": 970166, "diff_percentage": 0.8506922310014617, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:02:37.315141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.6172248803827751}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:03:34.984724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14448090662062804, "overlap_percentage": 0.2524828606311044, "num_intersection": 172060, "num_union": 1190884, "num_only_computed": 509412, "num_only_roped": 509412, "total_diff": 1018824, "diff_percentage": 0.8555190933793719, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:03:36.906565", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 5.7220458984375e-05, "l2_diff": 1.8046875, "l2_diff_relative": 0.4095744680851064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:04:37.554999", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14009867329214964, "overlap_percentage": 0.24576587373371925, "num_intersection": 173900, "num_union": 1241268, "num_only_computed": 533684, "num_only_roped": 533684, "total_diff": 1067368, "diff_percentage": 0.8599013267078504, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:04:39.604331", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.984306335449219e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:05:38.450300", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1382678246179025, "overlap_percentage": 0.24294427309199693, "num_intersection": 31428, "num_union": 227298, "num_only_computed": 97935, "num_only_roped": 97935, "total_diff": 195870, "diff_percentage": 0.8617321753820976, "num_computed": 129363, "num_roped": 129363}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 93, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:05:40.198892", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.3111888111888112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 93, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:06:33.829263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13858477970627503, "overlap_percentage": 0.24343339587242027, "num_intersection": 8823, "num_union": 63665, "num_only_computed": 27421, "num_only_roped": 27421, "total_diff": 54842, "diff_percentage": 0.861415220293725, "num_computed": 36244, "num_roped": 36244}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 26, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:06:35.502328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 6.103515625e-05, "l2_diff": 0.30859375, "l2_diff_relative": 0.30980392156862746}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 26, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:07:22.783744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14028629856850716, "overlap_percentage": 0.2460545193687231, "num_intersection": 343, "num_union": 2445, "num_only_computed": 1051, "num_only_roped": 1051, "total_diff": 2102, "diff_percentage": 0.8597137014314928, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:07:24.124772", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.0859375, "l2_diff_relative": 0.6423357664233577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:08:06.264061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12920210611583638, "overlap_percentage": 0.22883787661406027, "num_intersection": 319, "num_union": 2469, "num_only_computed": 1075, "num_only_roped": 1075, "total_diff": 2150, "diff_percentage": 0.8707978938841636, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:08:07.682297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 6.103515625e-05, "l2_diff": 0.059326171875, "l2_diff_relative": 0.26762114537444937}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:08:49.275701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1384238464679461, "overlap_percentage": 0.24318507890961263, "num_intersection": 339, "num_union": 2449, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.8615761535320539, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:08:50.626313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.15118243243243243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:17.590342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:17.602829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.020069122314453e-06, "l2_diff": 0.0228271484375, "l2_diff_relative": 0.0030436197916666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:20.960872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6823709741076264, "overlap_percentage": 0.8112015537709497, "num_intersection": 148690, "num_union": 217902, "num_only_computed": 34606, "num_only_roped": 34606, "total_diff": 69212, "diff_percentage": 0.31762902589237363, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:21.183251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 0.00010585784912109375, "l2_diff": 0.4375, "l2_diff_relative": 0.07253886010362694}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:29.621891", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5702930501814691, "overlap_percentage": 0.7263523838630807, "num_intersection": 152104, "num_union": 266712, "num_only_computed": 57304, "num_only_roped": 57304, "total_diff": 114608, "diff_percentage": 0.42970694981853086, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:29.919905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.41796875, "l2_diff_relative": 0.06430288461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:40.256512", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48380552773000185, "overlap_percentage": 0.6521144701086956, "num_intersection": 153586, "num_union": 317454, "num_only_computed": 81934, "num_only_roped": 81934, "total_diff": 163868, "diff_percentage": 0.5161944722699982, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:41.210171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 0.00011205673217773438, "l2_diff": 0.86328125, "l2_diff_relative": 0.15178571428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:54.223259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4284920250012261, "overlap_percentage": 0.5999221801757812, "num_intersection": 157266, "num_union": 367022, "num_only_computed": 104878, "num_only_roped": 104878, "total_diff": 209756, "diff_percentage": 0.5715079749987739, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:09:55.097820", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 0.0001068115234375, "l2_diff": 0.9296875, "l2_diff_relative": 0.16620111731843576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:10:10.155904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38949357447916166, "overlap_percentage": 0.5606266651865008, "num_intersection": 161604, "num_union": 414908, "num_only_computed": 126652, "num_only_roped": 126652, "total_diff": 253304, "diff_percentage": 0.6105064255208383, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:10:10.690546", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 0.00011110305786132812, "l2_diff": 1.078125, "l2_diff_relative": 0.20909090909090908}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:10:28.290550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3684506073553001, "overlap_percentage": 0.5384931036237784, "num_intersection": 169285, "num_union": 459451, "num_only_computed": 145083, "num_only_roped": 145083, "total_diff": 290166, "diff_percentage": 0.6315493926446999, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:10:28.902039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.16264204545454544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:10:49.049671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35644268444023036, "overlap_percentage": 0.5255550986842106, "num_intersection": 178941, "num_union": 502019, "num_only_computed": 161539, "num_only_roped": 161539, "total_diff": 323078, "diff_percentage": 0.6435573155597697, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:10:51.043512", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.1769578313253012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:11:14.222020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3302706684520116, "overlap_percentage": 0.4965465694832402, "num_intersection": 182030, "num_union": 551154, "num_only_computed": 184562, "num_only_roped": 184562, "total_diff": 369124, "diff_percentage": 0.6697293315479884, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:11:15.003793", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.953125, "l2_diff_relative": 0.1685082872928177}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:11:42.599934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.300863788694326, "overlap_percentage": 0.4625600179036458, "num_intersection": 181886, "num_union": 604546, "num_only_computed": 211330, "num_only_roped": 211330, "total_diff": 422660, "diff_percentage": 0.699136211305674, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:11:45.643047", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.36328125, "l2_diff_relative": 0.053082191780821915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:12:13.507864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2783864078765051, "overlap_percentage": 0.43552779685592186, "num_intersection": 182629, "num_union": 656027, "num_only_computed": 236699, "num_only_roped": 236699, "total_diff": 473398, "diff_percentage": 0.721613592123495, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:12:14.428979", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.4453125, "l2_diff_relative": 0.07270408163265306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:12:45.112870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2569930538604479, "overlap_percentage": 0.40890131106321836, "num_intersection": 182141, "num_union": 708739, "num_only_computed": 263299, "num_only_roped": 263299, "total_diff": 526598, "diff_percentage": 0.7430069461395521, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:12:46.120260", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.1309880239520958}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:13:19.138654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24799555376176896, "overlap_percentage": 0.39743018797502716, "num_intersection": 187409, "num_union": 755695, "num_only_computed": 284143, "num_only_roped": 284143, "total_diff": 568286, "diff_percentage": 0.752004446238231, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:13:22.766532", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 3.838539123535156e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.15245664739884393}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:13:58.592730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23204895873562878, "overlap_percentage": 0.37668788580246915, "num_intersection": 187464, "num_union": 807864, "num_only_computed": 310200, "num_only_roped": 310200, "total_diff": 620400, "diff_percentage": 0.7679510412643712, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:13:59.802075", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 5.125999450683594e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.23548387096774193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:14:39.736279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23150932050511125, "overlap_percentage": 0.3759765625, "num_intersection": 197120, "num_union": 851456, "num_only_computed": 327168, "num_only_roped": 327168, "total_diff": 654336, "diff_percentage": 0.7684906794948888, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:14:41.008246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.08608490566037735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:15:24.568166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22236546817552405, "overlap_percentage": 0.363828125, "num_intersection": 200251, "num_union": 900549, "num_only_computed": 350149, "num_only_roped": 350149, "total_diff": 700298, "diff_percentage": 0.777634531824476, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:15:26.856474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:16:11.887761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20415104940676168, "overlap_percentage": 0.33907880495115456, "num_intersection": 195483, "num_union": 957541, "num_only_computed": 381029, "num_only_roped": 381029, "total_diff": 762058, "diff_percentage": 0.7958489505932383, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:16:13.368575", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.17277486910994763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:17:00.550914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18402785282172898, "overlap_percentage": 0.31085054694137637, "num_intersection": 187326, "num_union": 1017922, "num_only_computed": 415298, "num_only_roped": 415298, "total_diff": 830596, "diff_percentage": 0.815972147178271, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:17:02.996629", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.49310344827586206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:17:53.717271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1739030180481689, "overlap_percentage": 0.29628174623371334, "num_intersection": 186283, "num_union": 1071189, "num_only_computed": 442453, "num_only_roped": 442453, "total_diff": 884906, "diff_percentage": 0.8260969819518311, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:17:57.153151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 9.679794311523438e-05, "l2_diff": 2.984375, "l2_diff_relative": 0.8842592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:18:50.833314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16153479411363317, "overlap_percentage": 0.2781402587890625, "num_intersection": 182282, "num_union": 1128438, "num_only_computed": 473078, "num_only_roped": 473078, "total_diff": 946156, "diff_percentage": 0.8384652058863669, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:18:53.832198", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 9.918212890625e-05, "l2_diff": 3.125, "l2_diff_relative": 1.0}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:19:49.918078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1545627432792454, "overlap_percentage": 0.2677424751126972, "num_intersection": 182459, "num_union": 1180485, "num_only_computed": 499013, "num_only_roped": 499013, "total_diff": 998026, "diff_percentage": 0.8454372567207546, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:19:51.788256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 9.059906005859375e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.9333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:20:50.986520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15362128867433264, "overlap_percentage": 0.26632880336468884, "num_intersection": 188450, "num_union": 1226718, "num_only_computed": 519134, "num_only_roped": 519134, "total_diff": 1038268, "diff_percentage": 0.8463787113256673, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:20:52.937110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.375, "l2_diff_relative": 0.6129032258064516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:21:56.666932", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15274007038712922, "overlap_percentage": 0.26500348918353106, "num_intersection": 194432, "num_union": 1272960, "num_only_computed": 539264, "num_only_roped": 539264, "total_diff": 1078528, "diff_percentage": 0.8472599296128708, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:21:58.743132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.7219730941704036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:23:04.656631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15088420845356296, "overlap_percentage": 0.26220571512803237, "num_intersection": 199226, "num_union": 1320390, "num_only_computed": 560582, "num_only_roped": 560582, "total_diff": 1121164, "diff_percentage": 0.849115791546437, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:23:06.853473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 7.152557373046875e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.6943231441048034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:24:16.146854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15244679822157614, "overlap_percentage": 0.2645619710286458, "num_intersection": 208060, "num_union": 1364804, "num_only_computed": 578372, "num_only_roped": 578372, "total_diff": 1156744, "diff_percentage": 0.8475532017784239, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:24:18.385613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1787109375, "mean_diff": 6.008148193359375e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.6044776119402985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:25:30.279432", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.143888447000359, "overlap_percentage": 0.2515777607120353, "num_intersection": 204418, "num_union": 1420670, "num_only_computed": 608126, "num_only_roped": 608126, "total_diff": 1216252, "diff_percentage": 0.856111552999641, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:25:34.485837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.5821428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:26:50.299236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14451115537277717, "overlap_percentage": 0.252529046474359, "num_intersection": 211785, "num_union": 1465527, "num_only_computed": 626871, "num_only_roped": 626871, "total_diff": 1253742, "diff_percentage": 0.8554888446272229, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:26:54.147204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.7372881355932204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:28:12.320456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14368968409436295, "overlap_percentage": 0.2512739007664381, "num_intersection": 155727, "num_union": 1083773, "num_only_computed": 464023, "num_only_roped": 464023, "total_diff": 928046, "diff_percentage": 0.8563103159056371, "num_computed": 619750, "num_roped": 619750}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 370, "seq_len_k": 14194, "queries_shape": [1, 32, 370, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 370, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:28:17.301450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.9140625, "l2_diff_relative": 0.5303030303030303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 370, "seq_len_k": 14194, "queries_shape": [1, 32, 370, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 370, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:29:31.913323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14426273425798516, "overlap_percentage": 0.2521496679720756, "num_intersection": 11847, "num_union": 82121, "num_only_computed": 35137, "num_only_roped": 35137, "total_diff": 70274, "diff_percentage": 0.8557372657420148, "num_computed": 46984, "num_roped": 46984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "mask_shape": [1, 32, 28, 14222], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:29:34.001697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.34765625, "l2_diff_relative": 0.32014388489208634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "attention_shape": [1, 32, 28, 14222]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:30:34.523664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15724137931034482, "overlap_percentage": 0.27175208581644816, "num_intersection": 456, "num_union": 2900, "num_only_computed": 1222, "num_only_roped": 1222, "total_diff": 2444, "diff_percentage": 0.8427586206896551, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "mask_shape": [1, 32, 1, 14223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:30:37.532287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0279541015625, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.2545454545454545}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "attention_shape": [1, 32, 1, 14223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:31:29.679543", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14852840520191649, "overlap_percentage": 0.2586412395709178, "num_intersection": 434, "num_union": 2922, "num_only_computed": 1244, "num_only_roped": 1244, "total_diff": 2488, "diff_percentage": 0.8514715947980835, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "mask_shape": [1, 32, 1, 14224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:31:32.125000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.04296875, "l2_diff_relative": 0.2732919254658385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "attention_shape": [1, 32, 1, 14224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:32:24.316468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14033299354400272, "overlap_percentage": 0.2461263408820024, "num_intersection": 413, "num_union": 2943, "num_only_computed": 1265, "num_only_roped": 1265, "total_diff": 2530, "diff_percentage": 0.8596670064559973, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 1, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:32:26.782230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.03076171875, "l2_diff_relative": 0.15829145728643215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 1, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:33:18.892674", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14617486338797814, "overlap_percentage": 0.2550655542312277, "num_intersection": 428, "num_union": 2928, "num_only_computed": 1250, "num_only_roped": 1250, "total_diff": 2500, "diff_percentage": 0.8538251366120219, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:33:21.486519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0106201171875, "mean_diff": 3.2901763916015625e-05, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.1856060606060606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:34:13.721586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14735042735042736, "overlap_percentage": 0.25685339690107273, "num_intersection": 431, "num_union": 2925, "num_only_computed": 1247, "num_only_roped": 1247, "total_diff": 2494, "diff_percentage": 0.8526495726495726, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:34:16.333621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.22272727272727272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:06.878124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15326460481099657, "overlap_percentage": 0.265792610250298, "num_intersection": 446, "num_union": 2910, "num_only_computed": 1232, "num_only_roped": 1232, "total_diff": 2464, "diff_percentage": 0.8467353951890034, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:09.623793", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012939453125, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.20494186046511628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:39.637123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:39.649528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.0218505859375, "l2_diff_relative": 0.0030269209956709955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:42.932750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6877229974540884, "overlap_percentage": 0.8149714123603352, "num_intersection": 149381, "num_union": 217211, "num_only_computed": 33915, "num_only_roped": 33915, "total_diff": 67830, "diff_percentage": 0.31227700254591156, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:43.149288", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 8.440017700195312e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.05476190476190476}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:50.940102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5737980895692888, "overlap_percentage": 0.7291889517114915, "num_intersection": 152698, "num_union": 266118, "num_only_computed": 56710, "num_only_roped": 56710, "total_diff": 113420, "diff_percentage": 0.4262019104307112, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:35:51.225342", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 0.00010538101196289062, "l2_diff": 0.6328125, "l2_diff_relative": 0.0916289592760181}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:01.289182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49585895025659266, "overlap_percentage": 0.6629755434782608, "num_intersection": 156144, "num_union": 314896, "num_only_computed": 79376, "num_only_roped": 79376, "total_diff": 158752, "diff_percentage": 0.5041410497434073, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:01.646502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.1076555023923445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:14.094678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43477023447249163, "overlap_percentage": 0.606048583984375, "num_intersection": 158872, "num_union": 365416, "num_only_computed": 103272, "num_only_roped": 103272, "total_diff": 206544, "diff_percentage": 0.5652297655275084, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:14.537959", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.12169312169312169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:29.327055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39271599331316975, "overlap_percentage": 0.5639570381882771, "num_intersection": 162564, "num_union": 413948, "num_only_computed": 125692, "num_only_roped": 125692, "total_diff": 251384, "diff_percentage": 0.6072840066868302, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:30.607015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.875, "l2_diff_relative": 0.14659685863874344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:49.762511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.349827175336525, "overlap_percentage": 0.5183288375407166, "num_intersection": 162946, "num_union": 465790, "num_only_computed": 151422, "num_only_roped": 151422, "total_diff": 302844, "diff_percentage": 0.6501728246634749, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:36:50.370844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.1453804347826087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:37:10.362642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3232262189067294, "overlap_percentage": 0.48854264567669176, "num_intersection": 166339, "num_union": 514621, "num_only_computed": 174141, "num_only_roped": 174141, "total_diff": 348282, "diff_percentage": 0.6767737810932706, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:37:11.053740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 5.7697296142578125e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.13353658536585367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:37:35.655022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3001168570248095, "overlap_percentage": 0.4616767414455307, "num_intersection": 169247, "num_union": 563937, "num_only_computed": 197345, "num_only_roped": 197345, "total_diff": 394690, "diff_percentage": 0.6998831429751905, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:37:36.424641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.9114227294921875e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.1356951871657754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:38:01.211792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2790340628171433, "overlap_percentage": 0.4363199869791667, "num_intersection": 171568, "num_union": 614864, "num_only_computed": 221648, "num_only_roped": 221648, "total_diff": 443296, "diff_percentage": 0.7209659371828567, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:38:02.032508", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.24561403508771928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:38:29.397370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26026318597183007, "overlap_percentage": 0.41302989545177043, "num_intersection": 173195, "num_union": 665461, "num_only_computed": 246133, "num_only_roped": 246133, "total_diff": 492266, "diff_percentage": 0.7397368140281699, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:38:30.320032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08544921875, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.22699386503067484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:39:00.349892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.248845258304678, "overlap_percentage": 0.3985205639367816, "num_intersection": 177517, "num_union": 713363, "num_only_computed": 267923, "num_only_roped": 267923, "total_diff": 535846, "diff_percentage": 0.751154741695322, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:39:01.347384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.1859903381642512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:39:36.099213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25067499827603584, "overlap_percentage": 0.4008635314875136, "num_intersection": 189028, "num_union": 754076, "num_only_computed": 282524, "num_only_roped": 282524, "total_diff": 565048, "diff_percentage": 0.7493250017239642, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:39:37.175640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.17081447963800905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:40:12.425556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23327633633187123, "overlap_percentage": 0.37830343364197533, "num_intersection": 188268, "num_union": 807060, "num_only_computed": 309396, "num_only_roped": 309396, "total_diff": 618792, "diff_percentage": 0.7667236636681287, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:40:14.878496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.875, "l2_diff_relative": 0.14659685863874344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:40:53.433129", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21658378794804978, "overlap_percentage": 0.3560523986816406, "num_intersection": 186674, "num_union": 861902, "num_only_computed": 337614, "num_only_roped": 337614, "total_diff": 675228, "diff_percentage": 0.7834162120519502, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:40:56.918909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1853448275862069}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:41:38.206903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20806665437529082, "overlap_percentage": 0.3444622093023256, "num_intersection": 189592, "num_union": 911208, "num_only_computed": 360808, "num_only_roped": 360808, "total_diff": 721616, "diff_percentage": 0.7919333456247092, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:41:39.562574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1868421052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:42:23.114042", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20250591593480113, "overlap_percentage": 0.336806519205151, "num_intersection": 194173, "num_union": 958851, "num_only_computed": 382339, "num_only_roped": 382339, "total_diff": 764678, "diff_percentage": 0.7974940840651988, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:42:24.574174", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 5.340576171875e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.33093525179856115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:43:11.170353", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19222650214358775, "overlap_percentage": 0.3224664135514019, "num_intersection": 194326, "num_union": 1010922, "num_only_computed": 408298, "num_only_roped": 408298, "total_diff": 816596, "diff_percentage": 0.8077734978564123, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:43:14.821370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.677078247070312e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.5708661417322834}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:43:57.951448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18706665751355805, "overlap_percentage": 0.3151746472357159, "num_intersection": 8175, "num_union": 43701, "num_only_computed": 17763, "num_only_roped": 17763, "total_diff": 35526, "diff_percentage": 0.812933342486442, "num_computed": 25938, "num_roped": 25938}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "mask_shape": [1, 32, 22, 9238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:43:59.130175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.2294921875, "l2_diff_relative": 0.18710191082802546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "attention_shape": [1, 32, 22, 9238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:44:39.771596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18560302222682226, "overlap_percentage": 0.313094718463553, "num_intersection": 21519, "num_union": 115941, "num_only_computed": 47211, "num_only_roped": 47211, "total_diff": 94422, "diff_percentage": 0.8143969777731778, "num_computed": 68730, "num_roped": 68730}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "mask_shape": [1, 32, 58, 9296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:44:41.235696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.5487804878048781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "attention_shape": [1, 32, 58, 9296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:45:20.619136", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1975745325922183, "overlap_percentage": 0.329957805907173, "num_intersection": 391, "num_union": 1979, "num_only_computed": 794, "num_only_roped": 794, "total_diff": 1588, "diff_percentage": 0.8024254674077818, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "mask_shape": [1, 32, 1, 9297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:45:21.724820", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.000141143798828125, "l2_diff": 0.1259765625, "l2_diff_relative": 2.023529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "attention_shape": [1, 32, 1, 9297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:45:55.726003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20795107033639143, "overlap_percentage": 0.34430379746835443, "num_intersection": 408, "num_union": 1962, "num_only_computed": 777, "num_only_roped": 777, "total_diff": 1554, "diff_percentage": 0.7920489296636085, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "mask_shape": [1, 32, 1, 9298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:45:56.968060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 0.000110626220703125, "l2_diff": 0.08447265625, "l2_diff_relative": 1.0484848484848486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "attention_shape": [1, 32, 1, 9298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:20.592407", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:20.605907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.022705078125, "l2_diff_relative": 0.0031727620087336245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:23.944833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.690236435395227, "overlap_percentage": 0.8167335893854749, "num_intersection": 149704, "num_union": 216888, "num_only_computed": 33592, "num_only_roped": 33592, "total_diff": 67184, "diff_percentage": 0.30976356460477295, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:26.612966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 0.00020599365234375, "l2_diff": 0.7265625, "l2_diff_relative": 0.13839285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:34.512482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.578614882437638, "overlap_percentage": 0.7330665495110025, "num_intersection": 153510, "num_union": 265306, "num_only_computed": 55898, "num_only_roped": 55898, "total_diff": 111796, "diff_percentage": 0.42138511756236197, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:34.809967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00017833709716796875, "l2_diff": 0.90234375, "l2_diff_relative": 0.17085798816568049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:45.428906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4875871238319011, "overlap_percentage": 0.6555409307065218, "num_intersection": 154393, "num_union": 316647, "num_only_computed": 81127, "num_only_roped": 81127, "total_diff": 162254, "diff_percentage": 0.5124128761680988, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:45.799929", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 0.00018405914306640625, "l2_diff": 1.171875, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:58.905863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4325708992641614, "overlap_percentage": 0.6039085388183594, "num_intersection": 158311, "num_union": 365977, "num_only_computed": 103833, "num_only_roped": 103833, "total_diff": 207666, "diff_percentage": 0.5674291007358386, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:46:59.355107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 0.0001430511474609375, "l2_diff": 1.0703125, "l2_diff_relative": 0.23299319727891157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:47:14.981640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38975818951905483, "overlap_percentage": 0.5609007271314387, "num_intersection": 161683, "num_union": 414829, "num_only_computed": 126573, "num_only_roped": 126573, "total_diff": 253146, "diff_percentage": 0.6102418104809452, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:47:15.511813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08056640625, "mean_diff": 0.00011873245239257812, "l2_diff": 1.125, "l2_diff_relative": 0.23684210526315788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:47:32.961292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3603939658828315, "overlap_percentage": 0.5298376425081434, "num_intersection": 166564, "num_union": 462172, "num_only_computed": 147804, "num_only_roped": 147804, "total_diff": 295608, "diff_percentage": 0.6396060341171685, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:47:35.746037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.1901840490797546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:47:55.735349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3290473430177978, "overlap_percentage": 0.4951627114661654, "num_intersection": 168593, "num_union": 512367, "num_only_computed": 171887, "num_only_roped": 171887, "total_diff": 343774, "diff_percentage": 0.6709526569822022, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:47:56.436952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 9.870529174804688e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.24647887323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:48:19.032662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30573166735528357, "overlap_percentage": 0.4682917248603352, "num_intersection": 171672, "num_union": 561512, "num_only_computed": 194920, "num_only_roped": 194920, "total_diff": 389840, "diff_percentage": 0.6942683326447164, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:48:19.814196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.2395104895104895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:48:45.291828", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28659421416079484, "overlap_percentage": 0.44550832112630206, "num_intersection": 175181, "num_union": 611251, "num_only_computed": 218035, "num_only_roped": 218035, "total_diff": 436070, "diff_percentage": 0.7134057858392052, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:48:46.145157", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.19912790697674418}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:49:14.070810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2716272891856731, "overlap_percentage": 0.4272121108058608, "num_intersection": 179142, "num_union": 659514, "num_only_computed": 240186, "num_only_roped": 240186, "total_diff": 480372, "diff_percentage": 0.7283727108143269, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:49:15.004410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.482421875, "l2_diff_relative": 0.08435792349726776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:49:46.138246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25301340384534243, "overlap_percentage": 0.40384788074712646, "num_intersection": 179890, "num_union": 710990, "num_only_computed": 265550, "num_only_roped": 265550, "total_diff": 531100, "diff_percentage": 0.7469865961546576, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:49:47.228465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.12888198757763975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:50:20.794732", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23754261374819902, "overlap_percentage": 0.38389403501628666, "num_intersection": 181026, "num_union": 762078, "num_only_computed": 290526, "num_only_roped": 290526, "total_diff": 581052, "diff_percentage": 0.762457386251801, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:50:22.185173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.20993589743589744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:50:58.697215", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.238230424056798, "overlap_percentage": 0.38479174704218105, "num_intersection": 191497, "num_union": 803831, "num_only_computed": 306167, "num_only_roped": 306167, "total_diff": 612334, "diff_percentage": 0.7617695759432019, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:51:00.020797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.8515625, "l2_diff_relative": 0.16029411764705884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:51:40.440561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2374228068167201, "overlap_percentage": 0.38373756408691406, "num_intersection": 201189, "num_union": 847387, "num_only_computed": 323099, "num_only_roped": 323099, "total_diff": 646198, "diff_percentage": 0.7625771931832799, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:51:41.738204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.11381578947368422}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:52:24.829783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23196483170160664, "overlap_percentage": 0.3765770348837209, "num_intersection": 207268, "num_union": 893532, "num_only_computed": 343132, "num_only_roped": 343132, "total_diff": 686264, "diff_percentage": 0.7680351682983934, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:52:27.012104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:53:11.756480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21176554663886565, "overlap_percentage": 0.34951570825932504, "num_intersection": 201500, "num_union": 951524, "num_only_computed": 375012, "num_only_roped": 375012, "total_diff": 750024, "diff_percentage": 0.7882344533611344, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:53:13.265195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 5.340576171875e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.3125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:54:01.264066", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19280938374629364, "overlap_percentage": 0.3232861618521665, "num_intersection": 194820, "num_union": 1010428, "num_only_computed": 407804, "num_only_roped": 407804, "total_diff": 815608, "diff_percentage": 0.8071906162537064, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:54:03.241236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 7.724761962890625e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.5633187772925764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:54:54.455185", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1716541889316978, "overlap_percentage": 0.29301169330211724, "num_intersection": 184227, "num_union": 1073245, "num_only_computed": 444509, "num_only_roped": 444509, "total_diff": 889018, "diff_percentage": 0.8283458110683022, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:54:58.329754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 9.059906005859375e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.8342245989304813}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:55:51.949855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16308497214566248, "overlap_percentage": 0.2804351806640625, "num_intersection": 183786, "num_union": 1126934, "num_only_computed": 471574, "num_only_roped": 471574, "total_diff": 943148, "diff_percentage": 0.8369150278543375, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:55:53.768921", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 9.5367431640625e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.9532163742690059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:56:50.918285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1553868416122505, "overlap_percentage": 0.2689780357813674, "num_intersection": 183301, "num_union": 1179643, "num_only_computed": 498171, "num_only_roped": 498171, "total_diff": 996342, "diff_percentage": 0.8446131583877495, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:56:52.846448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 8.20159912109375e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.7428571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:57:53.251379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15351315134170665, "overlap_percentage": 0.2661662784913169, "num_intersection": 188335, "num_union": 1226833, "num_only_computed": 519249, "num_only_roped": 519249, "total_diff": 1038498, "diff_percentage": 0.8464868486582934, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:57:56.502612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.6}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:58:59.921506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1529556336733395, "overlap_percentage": 0.2653278742149337, "num_intersection": 194670, "num_union": 1272722, "num_only_computed": 539026, "num_only_roped": 539026, "total_diff": 1078052, "diff_percentage": 0.8470443663266605, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T15:59:02.031271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.7090909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:00:09.270769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14749921655836923, "overlap_percentage": 0.2570794200640162, "num_intersection": 195331, "num_union": 1324285, "num_only_computed": 564477, "num_only_roped": 564477, "total_diff": 1128954, "diff_percentage": 0.8525007834416307, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:00:11.496145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4963235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:01:21.826237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14654356112378275, "overlap_percentage": 0.2556266784667969, "num_intersection": 201033, "num_union": 1371831, "num_only_computed": 585399, "num_only_roped": 585399, "total_diff": 1170798, "diff_percentage": 0.8534564388762172, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:01:25.460552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 7.295608520507812e-05, "l2_diff": 2.25, "l2_diff_relative": 0.7384615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:02:38.314192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14159829155895245, "overlap_percentage": 0.24807025834908633, "num_intersection": 201568, "num_union": 1423520, "num_only_computed": 610976, "num_only_roped": 610976, "total_diff": 1221952, "diff_percentage": 0.8584017084410476, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:02:40.745703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.7823834196891192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:03:56.094120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1391377577354595, "overlap_percentage": 0.24428609584859584, "num_intersection": 204872, "num_union": 1472440, "num_only_computed": 633784, "num_only_roped": 633784, "total_diff": 1267568, "diff_percentage": 0.8608622422645404, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:03:58.625246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 6.723403930664062e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.6859903381642513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:05:17.181781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13599468238131582, "overlap_percentage": 0.23942837847838958, "num_intersection": 207050, "num_union": 1522486, "num_only_computed": 657718, "num_only_roped": 657718, "total_diff": 1315436, "diff_percentage": 0.8640053176186842, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:05:20.423128", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.7473118279569892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:06:42.763239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13319218462708693, "overlap_percentage": 0.23507430854885059, "num_intersection": 209423, "num_union": 1572337, "num_only_computed": 681457, "num_only_roped": 681457, "total_diff": 1362914, "diff_percentage": 0.8668078153729131, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:06:45.559234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.8068181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:08:12.840757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13000131165792947, "overlap_percentage": 0.2300905500139509, "num_intersection": 211109, "num_union": 1623899, "num_only_computed": 706395, "num_only_roped": 706395, "total_diff": 1412790, "diff_percentage": 0.8699986883420705, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:08:15.917648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.8961748633879781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:09:46.977662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1276845691722845, "overlap_percentage": 0.22645440518176885, "num_intersection": 213686, "num_union": 1673546, "num_only_computed": 729930, "num_only_roped": 729930, "total_diff": 1459860, "diff_percentage": 0.8723154308277156, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:09:52.277136", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.8920454545454546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:11:26.312744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12900534633687796, "overlap_percentage": 0.22852920361350484, "num_intersection": 175664, "num_union": 1361680, "num_only_computed": 593008, "num_only_roped": 593008, "total_diff": 1186016, "diff_percentage": 0.870994653663122, "num_computed": 768672, "num_roped": 768672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 408, "seq_len_k": 16280, "queries_shape": [1, 32, 408, 128], "keys_shape": [1, 8, 16280, 128], "mask_shape": [1, 32, 408, 16280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:11:31.557795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1826171875, "mean_diff": 6.723403930664062e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.930635838150289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 408, "seq_len_k": 16280, "queries_shape": [1, 32, 408, 128], "keys_shape": [1, 8, 16280, 128], "attention_shape": [1, 32, 408, 16280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:12:58.518311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13019390581717452, "overlap_percentage": 0.23039215686274508, "num_intersection": 13912, "num_union": 106856, "num_only_computed": 46472, "num_only_roped": 46472, "total_diff": 92944, "diff_percentage": 0.8698060941828255, "num_computed": 60384, "num_roped": 60384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "mask_shape": [1, 32, 32, 16312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:13:01.000534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.43097014925373134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "attention_shape": [1, 32, 32, 16312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:14:08.832219", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14294367050272563, "overlap_percentage": 0.25013248542660305, "num_intersection": 472, "num_union": 3302, "num_only_computed": 1415, "num_only_roped": 1415, "total_diff": 2830, "diff_percentage": 0.8570563294972744, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "mask_shape": [1, 32, 1, 16313], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:14:10.689856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.3541666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "attention_shape": [1, 32, 1, 16313]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:08.603404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1357207342762564, "overlap_percentage": 0.2390037095919449, "num_intersection": 451, "num_union": 3323, "num_only_computed": 1436, "num_only_roped": 1436, "total_diff": 2872, "diff_percentage": 0.8642792657237436, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "mask_shape": [1, 32, 1, 16314], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:11.992216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.053466796875, "l2_diff_relative": 0.3093220338983051}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "attention_shape": [1, 32, 1, 16314]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:44.530532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:44.543971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.02294921875, "l2_diff_relative": 0.003034607438016529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:47.762819", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6858059947208196, "overlap_percentage": 0.8136238652234636, "num_intersection": 149134, "num_union": 217458, "num_only_computed": 34162, "num_only_roped": 34162, "total_diff": 68324, "diff_percentage": 0.31419400527918034, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:47.975359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 0.0001049041748046875, "l2_diff": 0.404296875, "l2_diff_relative": 0.06501256281407035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:55.820756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5761138311123822, "overlap_percentage": 0.7310561201100244, "num_intersection": 153089, "num_union": 265727, "num_only_computed": 56319, "num_only_roped": 56319, "total_diff": 112638, "diff_percentage": 0.42388616888761776, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:15:56.105947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 0.00011777877807617188, "l2_diff": 0.6328125, "l2_diff_relative": 0.11312849162011174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:05.957192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5055406221733558, "overlap_percentage": 0.6715735394021739, "num_intersection": 158169, "num_union": 312871, "num_only_computed": 77351, "num_only_roped": 77351, "total_diff": 154702, "diff_percentage": 0.49445937782664423, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:06.308444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.09068627450980392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:18.512652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4440251849485229, "overlap_percentage": 0.6149826049804688, "num_intersection": 161214, "num_union": 363074, "num_only_computed": 100930, "num_only_roped": 100930, "total_diff": 201860, "diff_percentage": 0.5559748150514771, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:19.955028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.10140306122448979}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:34.427110", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40543439573673457, "overlap_percentage": 0.5769524311722913, "num_intersection": 166310, "num_union": 410202, "num_only_computed": 121946, "num_only_roped": 121946, "total_diff": 243892, "diff_percentage": 0.5945656042632654, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:34.927712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 9.202957153320312e-05, "l2_diff": 0.94921875, "l2_diff_relative": 0.1696927374301676}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:52.023002", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36553201008615804, "overlap_percentage": 0.5353693760179153, "num_intersection": 168303, "num_union": 460433, "num_only_computed": 146065, "num_only_roped": 146065, "total_diff": 292130, "diff_percentage": 0.634467989913842, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:16:52.620372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.000102996826171875, "l2_diff": 1.1328125, "l2_diff_relative": 0.21706586826347304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:17:12.228417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.336712279827022, "overlap_percentage": 0.5037917058270677, "num_intersection": 171531, "num_union": 509429, "num_only_computed": 168949, "num_only_roped": 168949, "total_diff": 337898, "diff_percentage": 0.663287720172978, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:17:14.912104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.09316037735849056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:17:37.635278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3046303644574776, "overlap_percentage": 0.4669987342877095, "num_intersection": 171198, "num_union": 561986, "num_only_computed": 195394, "num_only_roped": 195394, "total_diff": 390788, "diff_percentage": 0.6953696355425224, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:17:38.401442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.18859649122807018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:18:06.600355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2797271415111687, "overlap_percentage": 0.43716684977213544, "num_intersection": 171901, "num_union": 614531, "num_only_computed": 221315, "num_only_roped": 221315, "total_diff": 442630, "diff_percentage": 0.7202728584888313, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:18:09.733836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.25833333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:18:37.918909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2638965078637868, "overlap_percentage": 0.41759195665445664, "num_intersection": 175108, "num_union": 663548, "num_only_computed": 244220, "num_only_roped": 244220, "total_diff": 488440, "diff_percentage": 0.7361034921362132, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:18:38.867680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.15328947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:19:09.705017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2488102463893869, "overlap_percentage": 0.39847566451149424, "num_intersection": 177497, "num_union": 713383, "num_only_computed": 267943, "num_only_roped": 267943, "total_diff": 535886, "diff_percentage": 0.7511897536106131, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:19:10.743680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.22633136094674555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:19:44.769565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23424353664042716, "overlap_percentage": 0.3795742569218241, "num_intersection": 178989, "num_union": 764115, "num_only_computed": 292563, "num_only_roped": 292563, "total_diff": 585126, "diff_percentage": 0.7657564633595728, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:19:46.651127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 5.745887756347656e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.2469325153374233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:20:22.925499", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2350760159030332, "overlap_percentage": 0.3806664737654321, "num_intersection": 189444, "num_union": 805884, "num_only_computed": 308220, "num_only_roped": 308220, "total_diff": 616440, "diff_percentage": 0.7649239840969668, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:20:24.135015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1878453038674033}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:21:03.947343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23158019607543748, "overlap_percentage": 0.3760700225830078, "num_intersection": 197169, "num_union": 851407, "num_only_computed": 327119, "num_only_roped": 327119, "total_diff": 654238, "diff_percentage": 0.7684198039245626, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:21:05.253430", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.1424731182795699}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:21:47.576114", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22302957580605737, "overlap_percentage": 0.3647165697674419, "num_intersection": 200740, "num_union": 900060, "num_only_computed": 349660, "num_only_roped": 349660, "total_diff": 699320, "diff_percentage": 0.7769704241939426, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:21:51.268529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.875, "l2_diff_relative": 0.1696969696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:22:35.624336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21833015108881368, "overlap_percentage": 0.3584088449156306, "num_intersection": 206627, "num_union": 946397, "num_only_computed": 369885, "num_only_roped": 369885, "total_diff": 739770, "diff_percentage": 0.7816698489111863, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:22:37.031654", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.2353896103896104}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:23:23.552856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20175929277307975, "overlap_percentage": 0.33577321845794394, "num_intersection": 202345, "num_union": 1002903, "num_only_computed": 400279, "num_only_roped": 400279, "total_diff": 800558, "diff_percentage": 0.7982407072269202, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:23:26.676412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.103515625e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.3977272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:24:17.843820", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16935568472438794, "overlap_percentage": 0.28965640982761265, "num_intersection": 166279, "num_union": 981833, "num_only_computed": 407777, "num_only_roped": 407777, "total_diff": 815554, "diff_percentage": 0.830644315275612, "num_computed": 574056, "num_roped": 574056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "mask_shape": [1, 32, 469, 9685], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:24:19.547223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.0, "l2_diff_relative": 0.5311203319502075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "attention_shape": [1, 32, 469, 9685]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:25:08.124147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1567856581223463, "overlap_percentage": 0.27107123436650354, "num_intersection": 7976, "num_union": 50872, "num_only_computed": 21448, "num_only_roped": 21448, "total_diff": 42896, "diff_percentage": 0.8432143418776538, "num_computed": 29424, "num_roped": 29424}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "mask_shape": [1, 32, 24, 9709], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:25:09.416700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.234375, "l2_diff_relative": 0.2054794520547945}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "attention_shape": [1, 32, 24, 9709]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:25:47.506961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15591144606688648, "overlap_percentage": 0.2697636511817441, "num_intersection": 331, "num_union": 2123, "num_only_computed": 896, "num_only_roped": 896, "total_diff": 1792, "diff_percentage": 0.8440885539331136, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 1, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:25:48.629705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.21033653846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 1, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:22.962858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.162482235907153, "overlap_percentage": 0.2795436022819886, "num_intersection": 343, "num_union": 2111, "num_only_computed": 884, "num_only_roped": 884, "total_diff": 1768, "diff_percentage": 0.837517764092847, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "mask_shape": [1, 32, 1, 9711], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:25.096967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.021484375, "l2_diff_relative": 0.09401709401709402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "attention_shape": [1, 32, 1, 9711]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:44.842201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:44.852427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.0031412760416666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:48.117342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6820776360466183, "overlap_percentage": 0.8109942388268156, "num_intersection": 148652, "num_union": 217940, "num_only_computed": 34644, "num_only_roped": 34644, "total_diff": 69288, "diff_percentage": 0.31792236395338164, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:48.334080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.0001735687255859375, "l2_diff": 0.640625, "l2_diff_relative": 0.10789473684210527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:56.410665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5763807860524989, "overlap_percentage": 0.7312710116136919, "num_intersection": 153134, "num_union": 265682, "num_only_computed": 56274, "num_only_roped": 56274, "total_diff": 112548, "diff_percentage": 0.4236192139475011, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:26:56.700753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.0891990291262136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:06.767755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5002420567177109, "overlap_percentage": 0.6668817934782608, "num_intersection": 157064, "num_union": 313976, "num_only_computed": 78456, "num_only_roped": 78456, "total_diff": 156912, "diff_percentage": 0.4997579432822891, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:07.744706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 7.200241088867188e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.09478021978021978}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:20.060758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4359294590012626, "overlap_percentage": 0.6071739196777344, "num_intersection": 159167, "num_union": 365121, "num_only_computed": 102977, "num_only_roped": 102977, "total_diff": 205954, "diff_percentage": 0.5640705409987374, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:21.502196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 9.5367431640625e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.14794303797468356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:36.060800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39464650740852736, "overlap_percentage": 0.5659448545737122, "num_intersection": 163137, "num_union": 413375, "num_only_computed": 125119, "num_only_roped": 125119, "total_diff": 250238, "diff_percentage": 0.6053534925914726, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:36.566628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 9.489059448242188e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.1737012987012987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:51.083744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.405452946350044, "overlap_percentage": 0.5769712140175219, "num_intersection": 5532, "num_union": 13644, "num_only_computed": 4056, "num_only_roped": 4056, "total_diff": 8112, "diff_percentage": 0.594547053649956, "num_computed": 9588, "num_roped": 9588}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "mask_shape": [1, 32, 17, 3089], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:27:51.508525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.12060546875, "l2_diff_relative": 0.1072048611111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "attention_shape": [1, 32, 17, 3089]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:04.913231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39193654990085924, "overlap_percentage": 0.5631528964862298, "num_intersection": 8302, "num_union": 21182, "num_only_computed": 6440, "num_only_roped": 6440, "total_diff": 12880, "diff_percentage": 0.6080634500991408, "num_computed": 14742, "num_roped": 14742}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "mask_shape": [1, 32, 26, 3115], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:05.360311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 9.34600830078125e-05, "l2_diff": 0.181640625, "l2_diff_relative": 0.15604026845637584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "attention_shape": [1, 32, 26, 3115]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:18.387684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37122128174123337, "overlap_percentage": 0.5414462081128748, "num_intersection": 307, "num_union": 827, "num_only_computed": 260, "num_only_roped": 260, "total_diff": 520, "diff_percentage": 0.6287787182587666, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "mask_shape": [1, 32, 1, 3116], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:18.785538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 9.632110595703125e-05, "l2_diff": 0.04345703125, "l2_diff_relative": 0.1831275720164609}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "attention_shape": [1, 32, 1, 3116]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:31.042659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34360189573459715, "overlap_percentage": 0.5114638447971781, "num_intersection": 290, "num_union": 844, "num_only_computed": 277, "num_only_roped": 277, "total_diff": 554, "diff_percentage": 0.6563981042654028, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "mask_shape": [1, 32, 1, 3117], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:31.419273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 8.916854858398438e-05, "l2_diff": 0.038330078125, "l2_diff_relative": 0.1551383399209486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "attention_shape": [1, 32, 1, 3117]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:43.712565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:43.724960", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.079673767089844e-06, "l2_diff": 0.0238037109375, "l2_diff_relative": 0.003134645061728395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:46.964199", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6836845296052028, "overlap_percentage": 0.8121290153631285, "num_intersection": 148860, "num_union": 217732, "num_only_computed": 34436, "num_only_roped": 34436, "total_diff": 68872, "diff_percentage": 0.3163154703947973, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:47.178833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 0.000171661376953125, "l2_diff": 0.59375, "l2_diff_relative": 0.10326086956521739}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:54.910990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5616100225582132, "overlap_percentage": 0.7192705149755502, "num_intersection": 150621, "num_union": 268195, "num_only_computed": 58787, "num_only_roped": 58787, "total_diff": 117574, "diff_percentage": 0.43838997744178676, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:28:57.268795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 0.00016021728515625, "l2_diff": 0.80859375, "l2_diff_relative": 0.1513157894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:07.213744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.485077967854418, "overlap_percentage": 0.6532693614130435, "num_intersection": 153858, "num_union": 317182, "num_only_computed": 81662, "num_only_roped": 81662, "total_diff": 163324, "diff_percentage": 0.5149220321455821, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:07.574619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 0.00015926361083984375, "l2_diff": 1.078125, "l2_diff_relative": 0.20783132530120482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:19.828648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4325552419387892, "overlap_percentage": 0.6038932800292969, "num_intersection": 158307, "num_union": 365981, "num_only_computed": 103837, "num_only_roped": 103837, "total_diff": 207674, "diff_percentage": 0.5674447580612109, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:20.268293", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 0.0001430511474609375, "l2_diff": 1.078125, "l2_diff_relative": 0.22847682119205298}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:35.058162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38718999415298955, "overlap_percentage": 0.5582364287300178, "num_intersection": 160915, "num_union": 415597, "num_only_computed": 127341, "num_only_roped": 127341, "total_diff": 254682, "diff_percentage": 0.6128100058470104, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:35.581947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 0.0001163482666015625, "l2_diff": 1.078125, "l2_diff_relative": 0.2197452229299363}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:53.002605", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36290053368363095, "overlap_percentage": 0.5325414800488599, "num_intersection": 167414, "num_union": 461322, "num_only_computed": 146954, "num_only_roped": 146954, "total_diff": 293908, "diff_percentage": 0.637099466316369, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:29:53.625857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 8.392333984375e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.19078947368421054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:30:13.952937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3328740095831637, "overlap_percentage": 0.4994830827067669, "num_intersection": 170064, "num_union": 510896, "num_only_computed": 170416, "num_only_roped": 170416, "total_diff": 340832, "diff_percentage": 0.6671259904168363, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:30:14.664635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 7.581710815429688e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.17413294797687862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:30:37.465343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30968746873972874, "overlap_percentage": 0.47291812150837986, "num_intersection": 173368, "num_union": 559816, "num_only_computed": 193224, "num_only_roped": 193224, "total_diff": 386448, "diff_percentage": 0.6903125312602713, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:30:38.231427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.15517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:31:03.571030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29417611532575244, "overlap_percentage": 0.4546152750651042, "num_intersection": 178762, "num_union": 607670, "num_only_computed": 214454, "num_only_roped": 214454, "total_diff": 428908, "diff_percentage": 0.7058238846742475, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:31:04.428537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.2054140127388535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:31:32.603299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2748670645356456, "overlap_percentage": 0.431208981990232, "num_intersection": 180818, "num_union": 657838, "num_only_computed": 238510, "num_only_roped": 238510, "total_diff": 477020, "diff_percentage": 0.7251329354643544, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:31:33.541175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.9453125, "l2_diff_relative": 0.1644021739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:32:04.240852", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2647718561004003, "overlap_percentage": 0.4186871408045977, "num_intersection": 186500, "num_union": 704380, "num_only_computed": 258940, "num_only_roped": 258940, "total_diff": 517880, "diff_percentage": 0.7352281438995997, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:32:05.293688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.875, "l2_diff_relative": 0.15819209039548024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:32:39.308415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2541309950292421, "overlap_percentage": 0.405270256514658, "num_intersection": 191106, "num_union": 751998, "num_only_computed": 280446, "num_only_roped": 280446, "total_diff": 560892, "diff_percentage": 0.7458690049707579, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:32:40.415710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.12628865979381443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:33:16.814090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23254633218498696, "overlap_percentage": 0.377342946244856, "num_intersection": 187790, "num_union": 807538, "num_only_computed": 309874, "num_only_roped": 309874, "total_diff": 619748, "diff_percentage": 0.767453667815013, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:33:20.530745", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 4.744529724121094e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.20359281437125748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:33:59.931552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21956512889700452, "overlap_percentage": 0.36007118225097656, "num_intersection": 188781, "num_union": 859795, "num_only_computed": 335507, "num_only_roped": 335507, "total_diff": 671014, "diff_percentage": 0.7804348711029955, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:34:02.279609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08837890625, "mean_diff": 5.316734313964844e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.23466257668711657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:34:44.511410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21186767215280453, "overlap_percentage": 0.3496547965116279, "num_intersection": 192450, "num_union": 908350, "num_only_computed": 357950, "num_only_roped": 357950, "total_diff": 715900, "diff_percentage": 0.7881323278471954, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:34:45.913872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.2088607594936709}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:35:31.647139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20419254982725993, "overlap_percentage": 0.3391360457371226, "num_intersection": 195516, "num_union": 957508, "num_only_computed": 380996, "num_only_roped": 380996, "total_diff": 761992, "diff_percentage": 0.79580745017274, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:35:33.108529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 4.887580871582031e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.24849397590361447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:36:21.541481", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1862315224633894, "overlap_percentage": 0.313988490335599, "num_intersection": 189217, "num_union": 1016031, "num_only_computed": 413407, "num_only_roped": 413407, "total_diff": 826814, "diff_percentage": 0.8137684775366106, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:36:23.150640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.4505928853754941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:37:14.012448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.163444724273652, "overlap_percentage": 0.28096689230456023, "num_intersection": 176654, "num_union": 1080818, "num_only_computed": 452082, "num_only_roped": 452082, "total_diff": 904164, "diff_percentage": 0.836555275726348, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:37:15.714549", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 8.96453857421875e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.8055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:38:09.934430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1475890665945221, "overlap_percentage": 0.25721588134765627, "num_intersection": 168569, "num_union": 1142151, "num_only_computed": 486791, "num_only_roped": 486791, "total_diff": 973582, "diff_percentage": 0.8524109334054779, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:38:11.747912", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 8.96453857421875e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.8087431693989071}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:39:09.219089", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1459551083278962, "overlap_percentage": 0.25473093538692715, "num_intersection": 173592, "num_union": 1189352, "num_only_computed": 507880, "num_only_roped": 507880, "total_diff": 1015760, "diff_percentage": 0.8540448916721038, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:39:11.147520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 8.20159912109375e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.7252747252747253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:40:11.961962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1484096617259806, "overlap_percentage": 0.2584611862337192, "num_intersection": 182883, "num_union": 1232285, "num_only_computed": 524701, "num_only_roped": 524701, "total_diff": 1049402, "diff_percentage": 0.8515903382740194, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:40:13.978398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1884765625, "mean_diff": 8.916854858398438e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.9195979899497487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:41:17.383592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13669017935851097, "overlap_percentage": 0.24050560450104674, "num_intersection": 176458, "num_union": 1290934, "num_only_computed": 557238, "num_only_roped": 557238, "total_diff": 1114476, "diff_percentage": 0.863309820641489, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:41:21.664030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 7.867813110351562e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.8252427184466019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:42:28.471394", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13807857272849144, "overlap_percentage": 0.24265209105458221, "num_intersection": 184369, "num_union": 1335247, "num_only_computed": 575439, "num_only_roped": 575439, "total_diff": 1150878, "diff_percentage": 0.8619214272715086, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:42:30.835268", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.6772908366533864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:43:40.879218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13693971240817135, "overlap_percentage": 0.24089177449544272, "num_intersection": 189445, "num_union": 1383419, "num_only_computed": 596987, "num_only_roped": 596987, "total_diff": 1193974, "diff_percentage": 0.8630602875918286, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:43:43.207395", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.62939453125e-05, "l2_diff": 2.75, "l2_diff_relative": 0.7553648068669528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:44:58.427825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1351788595737547, "overlap_percentage": 0.2381631025519849, "num_intersection": 193518, "num_union": 1431570, "num_only_computed": 619026, "num_only_roped": 619026, "total_diff": 1238052, "diff_percentage": 0.8648211404262454, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:45:02.618119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 6.4849853515625e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.6127819548872181}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:46:19.787899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13928476821192054, "overlap_percentage": 0.2445126488095238, "num_intersection": 205062, "num_union": 1472250, "num_only_computed": 633594, "num_only_roped": 633594, "total_diff": 1267188, "diff_percentage": 0.8607152317880795, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:46:22.503903", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.6680497925311203}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:47:42.659923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13109656204813486, "overlap_percentage": 0.231804368339254, "num_intersection": 200457, "num_union": 1529079, "num_only_computed": 664311, "num_only_roped": 664311, "total_diff": 1328622, "diff_percentage": 0.8689034379518651, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:47:47.559907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.7276785714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:49:10.867040", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1256308835876452, "overlap_percentage": 0.22321861530172413, "num_intersection": 198861, "num_union": 1582899, "num_only_computed": 692019, "num_only_roped": 692019, "total_diff": 1384038, "diff_percentage": 0.8743691164123548, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:49:13.703798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.9891891891891892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:50:40.880823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12023794116426097, "overlap_percentage": 0.21466500418526785, "num_intersection": 196956, "num_union": 1638052, "num_only_computed": 720548, "num_only_roped": 720548, "total_diff": 1441096, "diff_percentage": 0.879762058835739, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:50:44.000271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 7.152557373046875e-05, "l2_diff": 3.046875, "l2_diff_relative": 0.9898477157360406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:52:15.982179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11866862197205273, "overlap_percentage": 0.2121604551003798, "num_intersection": 200198, "num_union": 1687034, "num_only_computed": 743418, "num_only_roped": 743418, "total_diff": 1486836, "diff_percentage": 0.8813313780279473, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:52:19.945731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.15625, "l2_diff_relative": 0.9853658536585366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:53:52.398613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11557074493908406, "overlap_percentage": 0.20719572553042312, "num_intersection": 119980, "num_union": 1038152, "num_only_computed": 459086, "num_only_roped": 459086, "total_diff": 918172, "diff_percentage": 0.884429255060916, "num_computed": 579066, "num_roped": 579066}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 309, "seq_len_k": 16181, "queries_shape": [1, 32, 309, 128], "keys_shape": [1, 8, 16181, 128], "mask_shape": [1, 32, 309, 16181], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:53:56.143474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 5.6743621826171875e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.6804123711340206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 309, "seq_len_k": 16181, "queries_shape": [1, 32, 309, 128], "keys_shape": [1, 8, 16181, 128], "attention_shape": [1, 32, 309, 16181]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:55:21.103119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11241715149300172, "overlap_percentage": 0.2021133013674303, "num_intersection": 11381, "num_union": 101239, "num_only_computed": 44929, "num_only_roped": 44929, "total_diff": 89858, "diff_percentage": 0.8875828485069983, "num_computed": 56310, "num_roped": 56310}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "mask_shape": [1, 32, 30, 16211], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:55:23.548830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.6452991452991453}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "attention_shape": [1, 32, 30, 16211]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:56:31.454195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11959439308082315, "overlap_percentage": 0.2136387852956846, "num_intersection": 401, "num_union": 3353, "num_only_computed": 1476, "num_only_roped": 1476, "total_diff": 2952, "diff_percentage": 0.8804056069191769, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "mask_shape": [1, 32, 1, 16212], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:56:33.310211", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.07861328125, "l2_diff_relative": 0.34698275862068967}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "attention_shape": [1, 32, 1, 16212]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:57:31.001096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11065088757396449, "overlap_percentage": 0.19925412892914224, "num_intersection": 374, "num_union": 3380, "num_only_computed": 1503, "num_only_roped": 1503, "total_diff": 3006, "diff_percentage": 0.8893491124260355, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16213, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16213, 128], "mask_shape": [1, 32, 1, 16213], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:57:32.849805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.1142578125, "l2_diff_relative": 0.78}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16213, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16213, 128], "attention_shape": [1, 32, 1, 16213]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:58:30.670487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10933806146572105, "overlap_percentage": 0.19712306872669152, "num_intersection": 370, "num_union": 3384, "num_only_computed": 1507, "num_only_roped": 1507, "total_diff": 3014, "diff_percentage": 0.890661938534279, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16214, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16214, 128], "mask_shape": [1, 32, 1, 16214], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:58:34.405238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09619140625, "mean_diff": 8.344650268554688e-05, "l2_diff": 0.1494140625, "l2_diff_relative": 1.7485714285714287}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16214, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16214, 128], "attention_shape": [1, 32, 1, 16214]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:59:32.345372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11759452217922, "overlap_percentage": 0.21044219499200853, "num_intersection": 395, "num_union": 3359, "num_only_computed": 1482, "num_only_roped": 1482, "total_diff": 2964, "diff_percentage": 0.88240547782078, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16215, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16215, 128], "mask_shape": [1, 32, 1, 16215], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T16:59:34.320751", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.09814453125, "l2_diff_relative": 1.7787610619469028}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16215, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16215, 128], "attention_shape": [1, 32, 1, 16215]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:00:32.594113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11726190476190476, "overlap_percentage": 0.20990942994139583, "num_intersection": 394, "num_union": 3360, "num_only_computed": 1483, "num_only_roped": 1483, "total_diff": 2966, "diff_percentage": 0.8827380952380952, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16216, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16216, 128], "mask_shape": [1, 32, 1, 16216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:00:36.165484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 7.82012939453125e-05, "l2_diff": 0.0615234375, "l2_diff_relative": 0.8129032258064516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16216, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16216, 128], "attention_shape": [1, 32, 1, 16216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:01:33.993130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11460807600950118, "overlap_percentage": 0.2056473095364944, "num_intersection": 386, "num_union": 3368, "num_only_computed": 1491, "num_only_roped": 1491, "total_diff": 2982, "diff_percentage": 0.8853919239904988, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16217, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16217, 128], "mask_shape": [1, 32, 1, 16217], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:01:35.860531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.091796875, "l2_diff_relative": 0.7230769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16217, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16217, 128], "attention_shape": [1, 32, 1, 16217]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:02:33.767044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12193664076509265, "overlap_percentage": 0.21736814064997337, "num_intersection": 408, "num_union": 3346, "num_only_computed": 1469, "num_only_roped": 1469, "total_diff": 2938, "diff_percentage": 0.8780633592349073, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16218, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16218, 128], "mask_shape": [1, 32, 1, 16218], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:02:35.617731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 5.817413330078125e-05, "l2_diff": 0.09423828125, "l2_diff_relative": 0.7095588235294118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16218, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16218, 128], "attention_shape": [1, 32, 1, 16218]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:11.988022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:12.000427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.020069122314453e-06, "l2_diff": 0.021240234375, "l2_diff_relative": 0.0029551630434782607}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:15.228322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6866979842921097, "overlap_percentage": 0.8142512657122905, "num_intersection": 149249, "num_union": 217343, "num_only_computed": 34047, "num_only_roped": 34047, "total_diff": 68094, "diff_percentage": 0.3133020157078903, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:15.441821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 0.00017642974853515625, "l2_diff": 0.58984375, "l2_diff_relative": 0.10910404624277456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:23.092248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5698927955618862, "overlap_percentage": 0.7260276589242054, "num_intersection": 152036, "num_union": 266780, "num_only_computed": 57372, "num_only_roped": 57372, "total_diff": 114744, "diff_percentage": 0.4301072044381138, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:23.374838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.00011730194091796875, "l2_diff": 0.67578125, "l2_diff_relative": 0.10977157360406091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:33.268692", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4897937237884989, "overlap_percentage": 0.6575322690217391, "num_intersection": 154862, "num_union": 316178, "num_only_computed": 80658, "num_only_roped": 80658, "total_diff": 161316, "diff_percentage": 0.5102062762115012, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:35.872443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.08762886597938144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:48.046156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43333069060071133, "overlap_percentage": 0.6046485900878906, "num_intersection": 158505, "num_union": 365783, "num_only_computed": 103639, "num_only_roped": 103639, "total_diff": 207278, "diff_percentage": 0.5666693093992886, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:03:49.990258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.7265625, "l2_diff_relative": 0.12433155080213903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:04:04.638154", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40579081097688846, "overlap_percentage": 0.5773132215808171, "num_intersection": 166414, "num_union": 410098, "num_only_computed": 121842, "num_only_roped": 121842, "total_diff": 243684, "diff_percentage": 0.5942091890231116, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:04:05.148858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.11357868020304568}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:04:23.012912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.367825419167604, "overlap_percentage": 0.5378250967019544, "num_intersection": 169075, "num_union": 459661, "num_only_computed": 145293, "num_only_roped": 145293, "total_diff": 290586, "diff_percentage": 0.6321745808323961, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:04:23.622192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.62890625, "l2_diff_relative": 0.09865196078431372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:04:43.230015", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3336205714733358, "overlap_percentage": 0.5003230733082706, "num_intersection": 170350, "num_union": 510610, "num_only_computed": 170130, "num_only_roped": 170130, "total_diff": 340260, "diff_percentage": 0.6663794285266642, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:04:45.167307", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.30078125, "l2_diff_relative": 0.03977272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:05:07.870094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2982107602277053, "overlap_percentage": 0.4594180996857542, "num_intersection": 168419, "num_union": 564765, "num_only_computed": 198173, "num_only_roped": 198173, "total_diff": 396346, "diff_percentage": 0.7017892397722947, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:05:08.730506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.55859375, "l2_diff_relative": 0.0859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:05:33.981504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.290711815670744, "overlap_percentage": 0.45046742757161456, "num_intersection": 177131, "num_union": 609301, "num_only_computed": 216085, "num_only_roped": 216085, "total_diff": 432170, "diff_percentage": 0.709288184329256, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:05:34.851702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.57763671875e-05, "l2_diff": 0.75, "l2_diff_relative": 0.13636363636363635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:06:02.715773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28716466657355577, "overlap_percentage": 0.44619724893162394, "num_intersection": 187103, "num_union": 651553, "num_only_computed": 232225, "num_only_roped": 232225, "total_diff": 464450, "diff_percentage": 0.7128353334264442, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:06:03.653297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.14488636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:06:35.751679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2707052294210024, "overlap_percentage": 0.42607085129310346, "num_intersection": 189789, "num_union": 701091, "num_only_computed": 255651, "num_only_roped": 255651, "total_diff": 511302, "diff_percentage": 0.7292947705789976, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:06:36.779935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.13121546961325967}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:07:10.422564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2535442280853326, "overlap_percentage": 0.40452378528773075, "num_intersection": 190754, "num_union": 752350, "num_only_computed": 280798, "num_only_roped": 280798, "total_diff": 561596, "diff_percentage": 0.7464557719146674, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:07:11.530795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.12888601036269431}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:07:47.741224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23725611090117146, "overlap_percentage": 0.383519804526749, "num_intersection": 190864, "num_union": 804464, "num_only_computed": 306800, "num_only_roped": 306800, "total_diff": 613600, "diff_percentage": 0.7627438890988285, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:07:48.950191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07763671875, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1997126436781609}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:08:28.469955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23011805227241533, "overlap_percentage": 0.37413978576660156, "num_intersection": 196157, "num_union": 852419, "num_only_computed": 328131, "num_only_roped": 328131, "total_diff": 656262, "diff_percentage": 0.7698819477275847, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:08:29.776199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.172325134277344e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.19714285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:09:12.709939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21415335745168976, "overlap_percentage": 0.35276162790697674, "num_intersection": 194160, "num_union": 906640, "num_only_computed": 356240, "num_only_roped": 356240, "total_diff": 712480, "diff_percentage": 0.7858466425483103, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:09:14.134273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.195906432748538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:09:59.391815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19214421232752782, "overlap_percentage": 0.32235061889431615, "num_intersection": 185839, "num_union": 967185, "num_only_computed": 390673, "num_only_roped": 390673, "total_diff": 781346, "diff_percentage": 0.8078557876724721, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:10:02.078216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.23378378378378378}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:10:50.092054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1784650253684512, "overlap_percentage": 0.30287708421835174, "num_intersection": 182521, "num_union": 1022727, "num_only_computed": 420103, "num_only_roped": 420103, "total_diff": 840206, "diff_percentage": 0.8215349746315488, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:10:51.670069", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.513986013986014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:11:43.177518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15419678047652177, "overlap_percentage": 0.26719322577361565, "num_intersection": 167994, "num_union": 1089478, "num_only_computed": 460742, "num_only_roped": 460742, "total_diff": 921484, "diff_percentage": 0.8458032195234783, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:11:44.848899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 8.058547973632812e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.6639344262295082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:12:38.128220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14071571486632672, "overlap_percentage": 0.24671478271484376, "num_intersection": 161687, "num_union": 1149033, "num_only_computed": 493673, "num_only_roped": 493673, "total_diff": 987346, "diff_percentage": 0.8592842851336733, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:12:39.891557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.867813110351562e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.6353383458646616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:13:36.029082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13705068801484316, "overlap_percentage": 0.24106346262208866, "num_intersection": 164278, "num_union": 1198666, "num_only_computed": 517194, "num_only_roped": 517194, "total_diff": 1034388, "diff_percentage": 0.8629493119851568, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:13:37.894810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 9.5367431640625e-05, "l2_diff": 3.109375, "l2_diff_relative": 0.9567307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:14:37.993405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13549819986728684, "overlap_percentage": 0.23865859035817655, "num_intersection": 168871, "num_union": 1246297, "num_only_computed": 538713, "num_only_roped": 538713, "total_diff": 1077426, "diff_percentage": 0.8645018001327132, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:14:39.946025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.630752563476562e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.8733031674208145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:15:42.633009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1404075148866192, "overlap_percentage": 0.24624094993021634, "num_intersection": 180666, "num_union": 1286726, "num_only_computed": 553030, "num_only_roped": 553030, "total_diff": 1106060, "diff_percentage": 0.8595924851133808, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:15:45.560392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 8.726119995117188e-05, "l2_diff": 3.140625, "l2_diff_relative": 0.9710144927536232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:16:50.916723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1374865076477871, "overlap_percentage": 0.24173738628706198, "num_intersection": 183674, "num_union": 1335942, "num_only_computed": 576134, "num_only_roped": 576134, "total_diff": 1152268, "diff_percentage": 0.8625134923522129, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:16:54.523962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 8.20159912109375e-05, "l2_diff": 3.078125, "l2_diff_relative": 0.9120370370370371}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:18:03.643040", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14151014602142423, "overlap_percentage": 0.24793497721354166, "num_intersection": 194984, "num_union": 1377880, "num_only_computed": 591448, "num_only_roped": 591448, "total_diff": 1182896, "diff_percentage": 0.8584898539785758, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:18:05.981223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 7.62939453125e-05, "l2_diff": 3.140625, "l2_diff_relative": 0.8410041841004184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:19:18.849735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13782955886111178, "overlap_percentage": 0.2422674956679269, "num_intersection": 196853, "num_union": 1428235, "num_only_computed": 615691, "num_only_roped": 615691, "total_diff": 1231382, "diff_percentage": 0.8621704411388882, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:19:21.333990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.831858407079646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:20:39.244059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1320125152864127, "overlap_percentage": 0.23323508089133088, "num_intersection": 195604, "num_union": 1481708, "num_only_computed": 643052, "num_only_roped": 643052, "total_diff": 1286104, "diff_percentage": 0.8679874847135873, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:20:41.826633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.200241088867188e-05, "l2_diff": 3.046875, "l2_diff_relative": 0.8369098712446352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:22:02.627813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1292075080453136, "overlap_percentage": 0.2288463495411486, "num_intersection": 197899, "num_union": 1531637, "num_only_computed": 666869, "num_only_roped": 666869, "total_diff": 1333738, "diff_percentage": 0.8707924919546864, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:22:05.318489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.8302752293577982}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:23:29.258368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12762840208974777, "overlap_percentage": 0.22636606501436782, "num_intersection": 201665, "num_union": 1580095, "num_only_computed": 689215, "num_only_roped": 689215, "total_diff": 1378430, "diff_percentage": 0.8723715979102522, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:23:33.929538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.0558319091796875e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.6938775510204082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:25:00.593830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13087807523541883, "overlap_percentage": 0.23146275111607142, "num_intersection": 212368, "num_union": 1622640, "num_only_computed": 705136, "num_only_roped": 705136, "total_diff": 1410272, "diff_percentage": 0.8691219247645812, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:25:03.469066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.6576576576576577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:26:32.141307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13241507180981127, "overlap_percentage": 0.23386313924308194, "num_intersection": 220677, "num_union": 1666555, "num_only_computed": 722939, "num_only_roped": 722939, "total_diff": 1445878, "diff_percentage": 0.8675849281901887, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:26:36.383413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.340576171875e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.6177777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:28:08.410173", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1343687918845288, "overlap_percentage": 0.23690495162741862, "num_intersection": 202169, "num_union": 1504583, "num_only_computed": 651207, "num_only_roped": 651207, "total_diff": 1302414, "diff_percentage": 0.8656312081154712, "num_computed": 853376, "num_roped": 853376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 452, "seq_len_k": 16324, "queries_shape": [1, 32, 452, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 452, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:28:12.528256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1826171875, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.90625, "l2_diff_relative": 0.4939271255060729}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 452, "seq_len_k": 16324, "queries_shape": [1, 32, 452, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 452, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:29:38.107141", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13291321809749929, "overlap_percentage": 0.2346397163954012, "num_intersection": 11980, "num_union": 90134, "num_only_computed": 39077, "num_only_roped": 39077, "total_diff": 78154, "diff_percentage": 0.8670867819025008, "num_computed": 51057, "num_roped": 51057}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 27, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:29:40.542347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.375, "l2_diff_relative": 0.35294117647058826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 27, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:30:47.948302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14989358467619338, "overlap_percentage": 0.2607086197778953, "num_intersection": 493, "num_union": 3289, "num_only_computed": 1398, "num_only_roped": 1398, "total_diff": 2796, "diff_percentage": 0.8501064153238066, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:30:49.834512", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 7.486343383789062e-05, "l2_diff": 0.09814453125, "l2_diff_relative": 1.488888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:31:49.966340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1299671347475351, "overlap_percentage": 0.23003701745108407, "num_intersection": 435, "num_union": 3347, "num_only_computed": 1456, "num_only_roped": 1456, "total_diff": 2912, "diff_percentage": 0.8700328652524649, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:31:51.869625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.078125, "l2_diff_relative": 0.7960199004975125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:32:52.094613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1299671347475351, "overlap_percentage": 0.23003701745108407, "num_intersection": 435, "num_union": 3347, "num_only_computed": 1456, "num_only_roped": 1456, "total_diff": 2912, "diff_percentage": 0.8700328652524649, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:32:54.054346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.09033203125, "l2_diff_relative": 1.0054347826086956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:33:54.056306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13675984370303576, "overlap_percentage": 0.24061343204653624, "num_intersection": 455, "num_union": 3327, "num_only_computed": 1436, "num_only_roped": 1436, "total_diff": 2872, "diff_percentage": 0.8632401562969643, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:33:56.374271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.051025390625, "l2_diff_relative": 0.27941176470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:32.038465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:32.050941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.0031412760416666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:35.404045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.686441925511556, "overlap_percentage": 0.8140712290502793, "num_intersection": 149216, "num_union": 217376, "num_only_computed": 34080, "num_only_roped": 34080, "total_diff": 68160, "diff_percentage": 0.31355807448844397, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:36.694691", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.00011873245239257812, "l2_diff": 0.484375, "l2_diff_relative": 0.07989690721649484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:44.629686", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5638841694516532, "overlap_percentage": 0.721132908007335, "num_intersection": 151011, "num_union": 267805, "num_only_computed": 58397, "num_only_roped": 58397, "total_diff": 116794, "diff_percentage": 0.43611583054834674, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:44.927719", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.00018215179443359375, "l2_diff": 0.90625, "l2_diff_relative": 0.1657142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:55.873890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48867784397073466, "overlap_percentage": 0.6565259850543478, "num_intersection": 154625, "num_union": 316415, "num_only_computed": 80895, "num_only_roped": 80895, "total_diff": 161790, "diff_percentage": 0.5113221560292653, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:34:56.285334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.00011587142944335938, "l2_diff": 0.828125, "l2_diff_relative": 0.14804469273743018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:35:09.293418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43639367347665636, "overlap_percentage": 0.6076240539550781, "num_intersection": 159285, "num_union": 365003, "num_only_computed": 102859, "num_only_roped": 102859, "total_diff": 205718, "diff_percentage": 0.5636063265233436, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:35:09.747648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.8671875, "l2_diff_relative": 0.1483957219251337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:35:25.316570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3969546296027061, "overlap_percentage": 0.5683142761989343, "num_intersection": 163820, "num_union": 412692, "num_only_computed": 124436, "num_only_roped": 124436, "total_diff": 248872, "diff_percentage": 0.6030453703972939, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:35:25.851450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 7.82012939453125e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.14713541666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:35:43.514937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3589737493380597, "overlap_percentage": 0.5283012265879479, "num_intersection": 166081, "num_union": 462655, "num_only_computed": 148287, "num_only_roped": 148287, "total_diff": 296574, "diff_percentage": 0.6410262506619403, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:35:45.896627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.12073170731707317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:36:06.139088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34185656070434856, "overlap_percentage": 0.5095277255639098, "num_intersection": 173484, "num_union": 507476, "num_only_computed": 166996, "num_only_roped": 166996, "total_diff": 333992, "diff_percentage": 0.6581434392956514, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:36:06.826966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.51171875, "l2_diff_relative": 0.09199438202247191}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:36:29.010652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32649446467760523, "overlap_percentage": 0.49226660701815644, "num_intersection": 180461, "num_union": 552723, "num_only_computed": 186131, "num_only_roped": 186131, "total_diff": 372262, "diff_percentage": 0.6735055353223948, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:36:29.791625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.7578125, "l2_diff_relative": 0.1460843373493976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:36:54.831360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3067626869962131, "overlap_percentage": 0.46950022379557294, "num_intersection": 184615, "num_union": 601817, "num_only_computed": 208601, "num_only_roped": 208601, "total_diff": 417202, "diff_percentage": 0.6932373130037869, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:36:55.666752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.15793413173652696}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:37:23.344598", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27665637615768224, "overlap_percentage": 0.4334077380952381, "num_intersection": 181740, "num_union": 656916, "num_only_computed": 237588, "num_only_roped": 237588, "total_diff": 475176, "diff_percentage": 0.7233436238423178, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:37:24.277536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.8125, "l2_diff_relative": 0.13541666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:37:54.603108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2495283832627603, "overlap_percentage": 0.39939610272988507, "num_intersection": 177907, "num_union": 712973, "num_only_computed": 267533, "num_only_roped": 267533, "total_diff": 535066, "diff_percentage": 0.7504716167372397, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:37:55.655113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 5.340576171875e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.203125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:38:28.509621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23652526206069188, "overlap_percentage": 0.3825643831433225, "num_intersection": 180399, "num_union": 762705, "num_only_computed": 291153, "num_only_roped": 291153, "total_diff": 582306, "diff_percentage": 0.7634747379393081, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:38:32.247064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 5.412101745605469e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.2235294117647059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:39:08.852741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2311726673255496, "overlap_percentage": 0.3755324877829218, "num_intersection": 186889, "num_union": 808439, "num_only_computed": 310775, "num_only_roped": 310775, "total_diff": 621550, "diff_percentage": 0.7688273326744504, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:39:12.125524", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.10554245283018868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:39:50.683827", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2357020718458295, "overlap_percentage": 0.3814868927001953, "num_intersection": 200009, "num_union": 848567, "num_only_computed": 324279, "num_only_roped": 324279, "total_diff": 648558, "diff_percentage": 0.7642979281541705, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:39:53.356333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.12232620320855615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:40:34.752689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22722367400087404, "overlap_percentage": 0.3703052325581395, "num_intersection": 203816, "num_union": 896984, "num_only_computed": 346584, "num_only_roped": 346584, "total_diff": 693168, "diff_percentage": 0.7727763259991259, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:40:36.454309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.491474151611328e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.1171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:41:21.109767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21126781277740134, "overlap_percentage": 0.34883749167406747, "num_intersection": 201109, "num_union": 951915, "num_only_computed": 375403, "num_only_roped": 375403, "total_diff": 750806, "diff_percentage": 0.7887321872225986, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:41:22.623340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09716796875, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.21571428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:42:10.778753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18958238951250975, "overlap_percentage": 0.3187377203695837, "num_intersection": 192079, "num_union": 1013169, "num_only_computed": 410545, "num_only_roped": 410545, "total_diff": 821090, "diff_percentage": 0.8104176104874903, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:42:13.146642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.4243027888446215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:43:05.009156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1760482962117776, "overlap_percentage": 0.29938956891286644, "num_intersection": 188237, "num_union": 1069235, "num_only_computed": 440499, "num_only_roped": 440499, "total_diff": 880998, "diff_percentage": 0.8239517037882225, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:43:08.825319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.6965811965811965}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:44:04.477478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16264237871918805, "overlap_percentage": 0.27978057861328126, "num_intersection": 183357, "num_union": 1127363, "num_only_computed": 472003, "num_only_roped": 472003, "total_diff": 944006, "diff_percentage": 0.8373576212808119, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:44:06.435962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 9.441375732421875e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.9215686274509803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:45:04.371283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15679404655205192, "overlap_percentage": 0.2710837716003005, "num_intersection": 184736, "num_union": 1178208, "num_only_computed": 496736, "num_only_roped": 496736, "total_diff": 993472, "diff_percentage": 0.843205953447948, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:45:06.249690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.535385131835938e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.8571428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:46:07.500151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16140172343044726, "overlap_percentage": 0.27794297214182345, "num_intersection": 196668, "num_union": 1218500, "num_only_computed": 510916, "num_only_roped": 510916, "total_diff": 1021832, "diff_percentage": 0.8385982765695528, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:46:09.497606", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.058547973632812e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.7801724137931034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:47:13.471298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15484752923140127, "overlap_percentage": 0.26816965064549897, "num_intersection": 196755, "num_union": 1270637, "num_only_computed": 536941, "num_only_roped": 536941, "total_diff": 1073882, "diff_percentage": 0.8451524707685988, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:47:17.325856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 8.0108642578125e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.8075117370892019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:48:24.606395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15764037651102628, "overlap_percentage": 0.2723477510107817, "num_intersection": 206932, "num_union": 1312684, "num_only_computed": 552876, "num_only_roped": 552876, "total_diff": 1105752, "diff_percentage": 0.8423596234889738, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:48:26.978240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 7.724761962890625e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.783410138248848}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:49:37.694100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1549101140838524, "overlap_percentage": 0.2682634989420573, "num_intersection": 210971, "num_union": 1361893, "num_only_computed": 575461, "num_only_roped": 575461, "total_diff": 1150922, "diff_percentage": 0.8450898859161476, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:49:40.266607", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 7.772445678710938e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.8823529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:50:53.800540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15044043554378198, "overlap_percentage": 0.2615353753150599, "num_intersection": 212509, "num_union": 1412579, "num_only_computed": 600035, "num_only_roped": 600035, "total_diff": 1200070, "diff_percentage": 0.849559564456218, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:50:57.200567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.884393063583815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:52:14.998757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14811093192564748, "overlap_percentage": 0.25800805097680096, "num_intersection": 216380, "num_union": 1460932, "num_only_computed": 622276, "num_only_roped": 622276, "total_diff": 1244552, "diff_percentage": 0.8518890680743525, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:52:19.536984", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 7.62939453125e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.9270833333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:53:40.810907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14597093091055582, "overlap_percentage": 0.2547550325636471, "num_intersection": 220304, "num_union": 1509232, "num_only_computed": 644464, "num_only_roped": 644464, "total_diff": 1288928, "diff_percentage": 0.8540290690894442, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:53:44.815980", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.152557373046875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.7889447236180904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:54:59.935202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1447210255810478, "overlap_percentage": 0.25284942330396876, "num_intersection": 22273, "num_union": 153903, "num_only_computed": 65815, "num_only_roped": 65815, "total_diff": 131630, "diff_percentage": 0.8552789744189522, "num_computed": 88088, "num_roped": 88088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "mask_shape": [1, 32, 52, 14388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:55:02.613374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07763671875, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.20535714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "attention_shape": [1, 32, 52, 14388]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:56:10.760613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14190227326252985, "overlap_percentage": 0.2485366332744058, "num_intersection": 12653, "num_union": 89167, "num_only_computed": 38257, "num_only_roped": 38257, "total_diff": 76514, "diff_percentage": 0.8580977267374701, "num_computed": 50910, "num_roped": 50910}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "mask_shape": [1, 32, 30, 14418], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:56:14.406108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.333984375, "l2_diff_relative": 0.27941176470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "attention_shape": [1, 32, 30, 14418]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:57:14.451520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14584740040513167, "overlap_percentage": 0.2545668827342369, "num_intersection": 432, "num_union": 2962, "num_only_computed": 1265, "num_only_roped": 1265, "total_diff": 2530, "diff_percentage": 0.8541525995948683, "num_computed": 1697, "num_roped": 1697}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "mask_shape": [1, 32, 1, 14419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:57:16.104057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.02880859375, "l2_diff_relative": 0.10314685314685315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "attention_shape": [1, 32, 1, 14419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:58:07.075288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14228052472250252, "overlap_percentage": 0.24911660777385158, "num_intersection": 423, "num_union": 2973, "num_only_computed": 1275, "num_only_roped": 1275, "total_diff": 2550, "diff_percentage": 0.8577194752774975, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "mask_shape": [1, 32, 1, 14420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:58:08.731544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.491474151611328e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.1361111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "attention_shape": [1, 32, 1, 14420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:58:59.671909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1395973154362416, "overlap_percentage": 0.24499411071849234, "num_intersection": 416, "num_union": 2980, "num_only_computed": 1282, "num_only_roped": 1282, "total_diff": 2564, "diff_percentage": 0.8604026845637583, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "mask_shape": [1, 32, 1, 14421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:59:01.279624", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0296630859375, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.04541015625, "l2_diff_relative": 0.22794117647058823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "attention_shape": [1, 32, 1, 14421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:59:51.849704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13464751085867024, "overlap_percentage": 0.23733804475853945, "num_intersection": 403, "num_union": 2993, "num_only_computed": 1295, "num_only_roped": 1295, "total_diff": 2590, "diff_percentage": 0.8653524891413298, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14422, 128], "mask_shape": [1, 32, 1, 14422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T17:59:55.489901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.753734588623047e-05, "l2_diff": 0.033935546875, "l2_diff_relative": 0.14126016260162602}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14422, 128], "attention_shape": [1, 32, 1, 14422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:00:46.153322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1380697050938338, "overlap_percentage": 0.24263839811542992, "num_intersection": 412, "num_union": 2984, "num_only_computed": 1286, "num_only_roped": 1286, "total_diff": 2572, "diff_percentage": 0.8619302949061662, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14423, 128], "mask_shape": [1, 32, 1, 14423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:00:48.904684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.13095238095238096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14423, 128], "attention_shape": [1, 32, 1, 14423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:01:39.913857", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1395973154362416, "overlap_percentage": 0.24499411071849234, "num_intersection": 416, "num_union": 2980, "num_only_computed": 1282, "num_only_roped": 1282, "total_diff": 2564, "diff_percentage": 0.8604026845637583, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14424, 128], "mask_shape": [1, 32, 1, 14424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:01:41.569426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.23044692737430167}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14424, 128], "attention_shape": [1, 32, 1, 14424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:02:33.048550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13351134846461948, "overlap_percentage": 0.23557126030624265, "num_intersection": 400, "num_union": 2996, "num_only_computed": 1298, "num_only_roped": 1298, "total_diff": 2596, "diff_percentage": 0.8664886515353805, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14425, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14425, 128], "mask_shape": [1, 32, 1, 14425], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:02:34.691905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.05615234375, "l2_diff_relative": 0.2751196172248804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14425, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14425, 128], "attention_shape": [1, 32, 1, 14425]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:05.290755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:07.499830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.288290023803711e-06, "l2_diff": 0.021728515625, "l2_diff_relative": 0.003076603982300885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:10.831802", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.677766590389016, "overlap_percentage": 0.8079390712290503, "num_intersection": 148092, "num_union": 218500, "num_only_computed": 35204, "num_only_roped": 35204, "total_diff": 70408, "diff_percentage": 0.32223340961098396, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:11.047659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.00016880035400390625, "l2_diff": 0.55859375, "l2_diff_relative": 0.10332369942196531}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:18.775716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5637089999439954, "overlap_percentage": 0.72098964700489, "num_intersection": 150981, "num_union": 267835, "num_only_computed": 58427, "num_only_roped": 58427, "total_diff": 116854, "diff_percentage": 0.43629100005600463, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:21.534342", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 0.000118255615234375, "l2_diff": 0.66796875, "l2_diff_relative": 0.11369680851063829}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:31.563315", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4959729667928555, "overlap_percentage": 0.6630774456521739, "num_intersection": 156168, "num_union": 314872, "num_only_computed": 79352, "num_only_roped": 79352, "total_diff": 158704, "diff_percentage": 0.5040270332071445, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:31.915590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.443359375, "l2_diff_relative": 0.07058457711442787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:44.223381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44651124293005934, "overlap_percentage": 0.6173629760742188, "num_intersection": 161838, "num_union": 362450, "num_only_computed": 100306, "num_only_roped": 100306, "total_diff": 200612, "diff_percentage": 0.5534887570699407, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:44.660773", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.07287234042553191}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:03:59.335274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40140648206893365, "overlap_percentage": 0.5728623168294849, "num_intersection": 165131, "num_union": 411381, "num_only_computed": 123125, "num_only_roped": 123125, "total_diff": 246250, "diff_percentage": 0.5985935179310663, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:04:02.457314", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.08574879227053141}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:04:19.551821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3657574447656927, "overlap_percentage": 0.5356111309039088, "num_intersection": 168379, "num_union": 460357, "num_only_computed": 145989, "num_only_roped": 145989, "total_diff": 291978, "diff_percentage": 0.6342425552343073, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:04:20.156236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.55078125, "l2_diff_relative": 0.091796875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:04:39.899806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33386090206417796, "overlap_percentage": 0.500593280075188, "num_intersection": 170442, "num_union": 510518, "num_only_computed": 170038, "num_only_roped": 170038, "total_diff": 340076, "diff_percentage": 0.666139097935822, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:04:40.591216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.52734375, "l2_diff_relative": 0.08881578947368421}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:05:05.161536", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2894933545322319, "overlap_percentage": 0.44900325157122906, "num_intersection": 164601, "num_union": 568583, "num_only_computed": 201991, "num_only_roped": 201991, "total_diff": 403982, "diff_percentage": 0.7105066454677681, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:05:05.904055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.0962566844919786}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:05:30.451693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2830384455375278, "overlap_percentage": 0.44120025634765625, "num_intersection": 173487, "num_union": 612945, "num_only_computed": 219729, "num_only_roped": 219729, "total_diff": 439458, "diff_percentage": 0.7169615544624721, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:05:31.276659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.07819634703196347}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:05:58.472938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27515782559511504, "overlap_percentage": 0.4315666971916972, "num_intersection": 180968, "num_union": 657688, "num_only_computed": 238360, "num_only_roped": 238360, "total_diff": 476720, "diff_percentage": 0.724842174404885, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:05:59.380169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 3.2901763916015625e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.10190217391304347}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:06:29.131160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2679688700889833, "overlap_percentage": 0.42267420977011494, "num_intersection": 188276, "num_union": 702604, "num_only_computed": 257164, "num_only_roped": 257164, "total_diff": 514328, "diff_percentage": 0.7320311299110167, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:06:30.128686", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.17147435897435898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:07:03.899444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24620135494586956, "overlap_percentage": 0.39512291327361565, "num_intersection": 186321, "num_union": 756783, "num_only_computed": 285231, "num_only_roped": 285231, "total_diff": 570462, "diff_percentage": 0.7537986450541304, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:07:05.028582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.673004150390625e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.1939655172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:07:41.289729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23717306511476438, "overlap_percentage": 0.3834112975823045, "num_intersection": 190810, "num_union": 804518, "num_only_computed": 306854, "num_only_roped": 306854, "total_diff": 613708, "diff_percentage": 0.7628269348852357, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:07:43.253907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.98828125, "l2_diff_relative": 0.17376373626373626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:08:22.479941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21927441860465116, "overlap_percentage": 0.35968017578125, "num_intersection": 188576, "num_union": 860000, "num_only_computed": 335712, "num_only_roped": 335712, "total_diff": 671424, "diff_percentage": 0.7807255813953489, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:08:25.384191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.17473118279569894}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:09:07.737376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20812764360234515, "overlap_percentage": 0.34454578488372095, "num_intersection": 189638, "num_union": 911162, "num_only_computed": 360762, "num_only_roped": 360762, "total_diff": 721524, "diff_percentage": 0.7918723563976549, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:09:09.137393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1963276836158192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:09:54.667753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19359179803149443, "overlap_percentage": 0.3243852686500888, "num_intersection": 187012, "num_union": 966012, "num_only_computed": 389500, "num_only_roped": 389500, "total_diff": 779000, "diff_percentage": 0.8064082019685056, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:09:56.174040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.57763671875e-05, "l2_diff": 1.5, "l2_diff_relative": 0.25263157894736843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:10:45.518242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17162243608437835, "overlap_percentage": 0.29296543118096857, "num_intersection": 176548, "num_union": 1028700, "num_only_computed": 426076, "num_only_roped": 426076, "total_diff": 852152, "diff_percentage": 0.8283775639156217, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:10:47.118992", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.5381944444444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:11:39.458743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16361698150571227, "overlap_percentage": 0.2812213711319218, "num_intersection": 176814, "num_union": 1080658, "num_only_computed": 451922, "num_only_roped": 451922, "total_diff": 903844, "diff_percentage": 0.8363830184942878, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:11:41.216905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 9.012222290039062e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.8041666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:12:36.011386", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1510659953754322, "overlap_percentage": 0.26248016357421877, "num_intersection": 172019, "num_union": 1138701, "num_only_computed": 483341, "num_only_roped": 483341, "total_diff": 966682, "diff_percentage": 0.8489340046245678, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:12:37.799788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 9.107589721679688e-05, "l2_diff": 3.0625, "l2_diff_relative": 0.784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:13:34.985517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15230885513453737, "overlap_percentage": 0.26435422145003756, "num_intersection": 180150, "num_union": 1182794, "num_only_computed": 501322, "num_only_roped": 501322, "total_diff": 1002644, "diff_percentage": 0.8476911448654626, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:13:36.915807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 9.822845458984375e-05, "l2_diff": 3.109375, "l2_diff_relative": 1.0101522842639594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:14:38.121350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14884783835235, "overlap_percentage": 0.25912541832489144, "num_intersection": 183353, "num_union": 1231815, "num_only_computed": 524231, "num_only_roped": 524231, "total_diff": 1048462, "diff_percentage": 0.8511521616476501, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:14:40.119155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 9.72747802734375e-05, "l2_diff": 3.390625, "l2_diff_relative": 1.0742574257425743}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:15:43.642233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14611884272139491, "overlap_percentage": 0.25498026430565246, "num_intersection": 187078, "num_union": 1280314, "num_only_computed": 546618, "num_only_roped": 546618, "total_diff": 1093236, "diff_percentage": 0.8538811572786051, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:15:46.535351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2021484375, "mean_diff": 8.726119995117188e-05, "l2_diff": 3.21875, "l2_diff_relative": 0.9279279279279279}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:16:53.358305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14657107481229587, "overlap_percentage": 0.25566853731469, "num_intersection": 194259, "num_union": 1325357, "num_only_computed": 565549, "num_only_roped": 565549, "total_diff": 1131098, "diff_percentage": 0.8534289251877042, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:16:57.474728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.20703125, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.96875, "l2_diff_relative": 0.7851239669421488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:18:07.397878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14281230246092813, "overlap_percentage": 0.24993133544921875, "num_intersection": 196554, "num_union": 1376310, "num_only_computed": 589878, "num_only_roped": 589878, "total_diff": 1179756, "diff_percentage": 0.8571876975390719, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:18:09.733458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 8.153915405273438e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.8952380952380953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:19:22.306575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13850234448724982, "overlap_percentage": 0.2433062086483932, "num_intersection": 197697, "num_union": 1427391, "num_only_computed": 614847, "num_only_roped": 614847, "total_diff": 1229694, "diff_percentage": 0.8614976555127501, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:19:24.761054", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2080078125, "mean_diff": 8.392333984375e-05, "l2_diff": 3.328125, "l2_diff_relative": 1.0240384615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:20:43.529251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13676531484304102, "overlap_percentage": 0.2406218998015873, "num_intersection": 201799, "num_union": 1475513, "num_only_computed": 636857, "num_only_roped": 636857, "total_diff": 1273714, "diff_percentage": 0.863234685156959, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:20:46.084381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.8125, "l2_diff_relative": 1.0227272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:22:05.350545", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1330551353130185, "overlap_percentage": 0.23486083098023397, "num_intersection": 145555, "num_union": 1093945, "num_only_computed": 474195, "num_only_roped": 474195, "total_diff": 948390, "diff_percentage": 0.8669448646869815, "num_computed": 619750, "num_roped": 619750}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 370, "seq_len_k": 14194, "queries_shape": [1, 32, 370, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 370, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:22:07.960086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 7.677078247070312e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.8655913978494624}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 370, "seq_len_k": 14194, "queries_shape": [1, 32, 370, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 370, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:23:19.988270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13565261055136504, "overlap_percentage": 0.23889807374370411, "num_intersection": 12427, "num_union": 91609, "num_only_computed": 39591, "num_only_roped": 39591, "total_diff": 79182, "diff_percentage": 0.864347389448635, "num_computed": 52018, "num_roped": 52018}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 31, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:23:23.868456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07373046875, "mean_diff": 5.340576171875e-05, "l2_diff": 0.3984375, "l2_diff_relative": 0.38345864661654133}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 31, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:24:22.368098", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14227365554799182, "overlap_percentage": 0.24910607866507747, "num_intersection": 418, "num_union": 2938, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.8577263444520081, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:24:24.001645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 8.249282836914062e-05, "l2_diff": 0.09716796875, "l2_diff_relative": 1.1987951807228916}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:25:14.215579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13994565217391305, "overlap_percentage": 0.24553039332538737, "num_intersection": 412, "num_union": 2944, "num_only_computed": 1266, "num_only_roped": 1266, "total_diff": 2532, "diff_percentage": 0.8600543478260869, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:25:15.859680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 8.821487426757812e-05, "l2_diff": 0.08203125, "l2_diff_relative": 1.302325581395349}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:26:06.141934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1261744966442953, "overlap_percentage": 0.22407628128724671, "num_intersection": 376, "num_union": 2980, "num_only_computed": 1302, "num_only_roped": 1302, "total_diff": 2604, "diff_percentage": 0.8738255033557047, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:26:08.874941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.11865234375, "l2_diff_relative": 1.4046242774566473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:26:59.194320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1414965986394558, "overlap_percentage": 0.24791418355184744, "num_intersection": 416, "num_union": 2940, "num_only_computed": 1262, "num_only_roped": 1262, "total_diff": 2524, "diff_percentage": 0.8585034013605443, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "mask_shape": [1, 32, 1, 14229], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:01.948226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.109375, "l2_diff_relative": 1.0717703349282297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "attention_shape": [1, 32, 1, 14229]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:35.398903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:35.411409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.16908073425293e-06, "l2_diff": 0.0220947265625, "l2_diff_relative": 0.0030874727074235806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:38.675626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.689013798981778, "overlap_percentage": 0.8158770513268156, "num_intersection": 149547, "num_union": 217045, "num_only_computed": 33749, "num_only_roped": 33749, "total_diff": 67498, "diff_percentage": 0.31098620101822205, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:38.891969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.0001373291015625, "l2_diff": 0.58203125, "l2_diff_relative": 0.0917487684729064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:46.743806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5730946487528029, "overlap_percentage": 0.7286206830684596, "num_intersection": 152579, "num_union": 266237, "num_only_computed": 56829, "num_only_roped": 56829, "total_diff": 113658, "diff_percentage": 0.42690535124719703, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:47.035583", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 0.000186920166015625, "l2_diff": 0.90625, "l2_diff_relative": 0.17261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:57.115155", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48520439532720594, "overlap_percentage": 0.6533840013586957, "num_intersection": 153885, "num_union": 317155, "num_only_computed": 81635, "num_only_roped": 81635, "total_diff": 163270, "diff_percentage": 0.5147956046727941, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:27:58.110250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06494140625, "mean_diff": 0.00013828277587890625, "l2_diff": 1.015625, "l2_diff_relative": 0.17473118279569894}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:28:10.470824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4377408058443321, "overlap_percentage": 0.6089286804199219, "num_intersection": 159627, "num_union": 364661, "num_only_computed": 102517, "num_only_roped": 102517, "total_diff": 205034, "diff_percentage": 0.5622591941556678, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:28:12.776969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.7578125, "l2_diff_relative": 0.13857142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:28:27.460680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3924737935365441, "overlap_percentage": 0.5637072602131439, "num_intersection": 162492, "num_union": 414020, "num_only_computed": 125764, "num_only_roped": 125764, "total_diff": 251528, "diff_percentage": 0.6075262064634559, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:28:27.975026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 9.870529174804688e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:28:45.344695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35962321109606993, "overlap_percentage": 0.5290042243485342, "num_intersection": 166302, "num_union": 462434, "num_only_computed": 148066, "num_only_roped": 148066, "total_diff": 296132, "diff_percentage": 0.6403767889039301, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:28:45.951671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 9.059906005859375e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.20094936708860758}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:29:05.734714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33235504162631213, "overlap_percentage": 0.4988986137218045, "num_intersection": 169865, "num_union": 511095, "num_only_computed": 170615, "num_only_roped": 170615, "total_diff": 341230, "diff_percentage": 0.6676449583736879, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:29:07.926275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 8.630752563476562e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.20569620253164558}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:29:30.908126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31211568058985645, "overlap_percentage": 0.47574415153631283, "num_intersection": 174404, "num_union": 558780, "num_only_computed": 192188, "num_only_roped": 192188, "total_diff": 384376, "diff_percentage": 0.6878843194101435, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:29:31.668869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.20411392405063292}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:29:57.433373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2856666426894581, "overlap_percentage": 0.4443868001302083, "num_intersection": 174740, "num_union": 611692, "num_only_computed": 218476, "num_only_roped": 218476, "total_diff": 436952, "diff_percentage": 0.7143333573105419, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:29:58.289970", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 6.103515625e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.18201754385964913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:30:25.935276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26854783207157606, "overlap_percentage": 0.4233940972222222, "num_intersection": 177541, "num_union": 661115, "num_only_computed": 241787, "num_only_roped": 241787, "total_diff": 483574, "diff_percentage": 0.7314521679284239, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:30:26.884945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.2015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:30:59.048673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2622183180906908, "overlap_percentage": 0.41548805675287354, "num_intersection": 185075, "num_union": 705805, "num_only_computed": 260365, "num_only_roped": 260365, "total_diff": 520730, "diff_percentage": 0.7377816819093093, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:31:00.056106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.24825174825174826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:31:33.113467", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.250068262371395, "overlap_percentage": 0.4000873710640608, "num_intersection": 188662, "num_union": 754442, "num_only_computed": 282890, "num_only_roped": 282890, "total_diff": 565780, "diff_percentage": 0.749931737628605, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:31:34.218360", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.2765957446808511}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:32:10.816714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23971253129398284, "overlap_percentage": 0.38672276877572015, "num_intersection": 192458, "num_union": 802870, "num_only_computed": 305206, "num_only_roped": 305206, "total_diff": 610412, "diff_percentage": 0.7602874687060172, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:32:12.009683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 5.841255187988281e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.26992753623188404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:32:51.476876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22623687752670102, "overlap_percentage": 0.36899375915527344, "num_intersection": 193459, "num_union": 855117, "num_only_computed": 330829, "num_only_roped": 330829, "total_diff": 661658, "diff_percentage": 0.7737631224732989, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:32:52.800844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 5.269050598144531e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.25333333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:33:36.139247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21047775824093654, "overlap_percentage": 0.3477598110465116, "num_intersection": 191407, "num_union": 909393, "num_only_computed": 358993, "num_only_roped": 358993, "total_diff": 717986, "diff_percentage": 0.7895222417590635, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:33:37.547755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.29887218045112784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:34:23.234830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1991929277171087, "overlap_percentage": 0.3322116452042629, "num_intersection": 191524, "num_union": 961500, "num_only_computed": 384988, "num_only_roped": 384988, "total_diff": 769976, "diff_percentage": 0.8008070722828913, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:34:26.550205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09130859375, "mean_diff": 5.555152893066406e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.313758389261745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:35:16.034620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18106220810247747, "overlap_percentage": 0.30660909621920135, "num_intersection": 184770, "num_union": 1020478, "num_only_computed": 417854, "num_only_roped": 417854, "total_diff": 835708, "diff_percentage": 0.8189377918975226, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:35:19.742846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.5465587044534413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:36:12.590490", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.162014807586393, "overlap_percentage": 0.27885153705211724, "num_intersection": 175324, "num_union": 1082148, "num_only_computed": 453412, "num_only_roped": 453412, "total_diff": 906824, "diff_percentage": 0.837985192413607, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:36:16.342097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.867813110351562e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.6163265306122448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:37:11.746188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15219623342100452, "overlap_percentage": 0.2641845703125, "num_intersection": 173136, "num_union": 1137584, "num_only_computed": 482224, "num_only_roped": 482224, "total_diff": 964448, "diff_percentage": 0.8478037665789955, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:37:13.555406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4963235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:38:11.555175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14641488802439281, "overlap_percentage": 0.25543089077761083, "num_intersection": 174069, "num_union": 1188875, "num_only_computed": 507403, "num_only_roped": 507403, "total_diff": 1014806, "diff_percentage": 0.8535851119756072, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:38:13.476187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.343292236328125e-05, "l2_diff": 1.984375, "l2_diff_relative": 0.5879629629629629}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:39:14.560712", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14690376796231147, "overlap_percentage": 0.2561745319283647, "num_intersection": 181265, "num_union": 1233903, "num_only_computed": 526319, "num_only_roped": 526319, "total_diff": 1052638, "diff_percentage": 0.8530962320376886, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:39:16.558149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.82012939453125e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.7329842931937173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:40:20.485574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14981801370480216, "overlap_percentage": 0.26059430608862527, "num_intersection": 191197, "num_union": 1276195, "num_only_computed": 542499, "num_only_roped": 542499, "total_diff": 1084998, "diff_percentage": 0.8501819862951978, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:40:25.091223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 8.726119995117188e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.9253731343283582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:41:31.738519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14519375621255043, "overlap_percentage": 0.253570638898248, "num_intersection": 192665, "num_union": 1326951, "num_only_computed": 567143, "num_only_roped": 567143, "total_diff": 1134286, "diff_percentage": 0.8548062437874496, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:41:34.614843", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.220703125, "mean_diff": 8.821487426757812e-05, "l2_diff": 2.984375, "l2_diff_relative": 1.0268817204301075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:42:45.488823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1397540440129478, "overlap_percentage": 0.24523544311523438, "num_intersection": 192861, "num_union": 1380003, "num_only_computed": 593571, "num_only_roped": 593571, "total_diff": 1187142, "diff_percentage": 0.8602459559870522, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:42:47.860661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.961822509765625e-05, "l2_diff": 2.125, "l2_diff_relative": 0.6355140186915887}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:44:01.567135", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14740090699777805, "overlap_percentage": 0.256930086247637, "num_intersection": 208767, "num_union": 1416321, "num_only_computed": 603777, "num_only_roped": 603777, "total_diff": 1207554, "diff_percentage": 0.8525990930022219, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:44:06.451967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.8702702702702703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:45:23.126520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1402102572643443, "overlap_percentage": 0.2459375476953602, "num_intersection": 206257, "num_union": 1471055, "num_only_computed": 632399, "num_only_roped": 632399, "total_diff": 1264798, "diff_percentage": 0.8597897427356557, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:45:26.397905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.375, "l2_diff_relative": 0.8636363636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:46:47.096809", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13236883749159498, "overlap_percentage": 0.23379102834517465, "num_intersection": 202175, "num_union": 1527361, "num_only_computed": 662593, "num_only_roped": 662593, "total_diff": 1325186, "diff_percentage": 0.867631162508405, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:46:51.542636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.9117647058823529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:48:16.044798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12722105745299767, "overlap_percentage": 0.22572512571839082, "num_intersection": 201094, "num_union": 1580666, "num_only_computed": 689786, "num_only_roped": 689786, "total_diff": 1379572, "diff_percentage": 0.8727789425470024, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:48:18.831635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.9152542372881356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:49:44.754958", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12394313056303487, "overlap_percentage": 0.220550537109375, "num_intersection": 202356, "num_union": 1632652, "num_only_computed": 715148, "num_only_roped": 715148, "total_diff": 1430296, "diff_percentage": 0.8760568694369651, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:49:48.136482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.7580645161290323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:51:17.137591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12319162121015063, "overlap_percentage": 0.21935993624564498, "num_intersection": 193230, "num_union": 1568532, "num_only_computed": 687651, "num_only_roped": 687651, "total_diff": 1375302, "diff_percentage": 0.8768083787898494, "num_computed": 880881, "num_roped": 880881}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "mask_shape": [1, 32, 479, 15839], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:51:20.109955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.56951871657754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "attention_shape": [1, 32, 479, 15839]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:52:47.464579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1260702916910284, "overlap_percentage": 0.22391193981631052, "num_intersection": 19406, "num_union": 153930, "num_only_computed": 67262, "num_only_roped": 67262, "total_diff": 134524, "diff_percentage": 0.8739297083089717, "num_computed": 86668, "num_roped": 86668}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 47, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:52:50.321676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.434375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 47, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:53:59.724248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13476923076923078, "overlap_percentage": 0.23752711496746204, "num_intersection": 438, "num_union": 3250, "num_only_computed": 1406, "num_only_roped": 1406, "total_diff": 2812, "diff_percentage": 0.8652307692307692, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "mask_shape": [1, 32, 1, 15887], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:54:01.586519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.5413533834586466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "attention_shape": [1, 32, 1, 15887]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:54:59.393074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13476923076923078, "overlap_percentage": 0.23752711496746204, "num_intersection": 438, "num_union": 3250, "num_only_computed": 1406, "num_only_roped": 1406, "total_diff": 2812, "diff_percentage": 0.8652307692307692, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "mask_shape": [1, 32, 1, 15888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:55:01.277573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.8011049723756906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "attention_shape": [1, 32, 1, 15888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:55:59.476023", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13302611367127495, "overlap_percentage": 0.23481561822125813, "num_intersection": 433, "num_union": 3255, "num_only_computed": 1411, "num_only_roped": 1411, "total_diff": 2822, "diff_percentage": 0.8669738863287251, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "mask_shape": [1, 32, 1, 15889], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:56:03.148188", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037353515625, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.0849609375, "l2_diff_relative": 0.7280334728033473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "attention_shape": [1, 32, 1, 15889]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:56:37.508919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:56:37.523472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.3478946685791016e-06, "l2_diff": 0.0247802734375, "l2_diff_relative": 0.003249871926229508}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:56:40.897744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6798500657566134, "overlap_percentage": 0.8094175541201117, "num_intersection": 148363, "num_union": 218229, "num_only_computed": 34933, "num_only_roped": 34933, "total_diff": 69866, "diff_percentage": 0.32014993424338656, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:56:42.990218", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.00017547607421875, "l2_diff": 0.64453125, "l2_diff_relative": 0.11332417582417582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:56:50.955498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5726457213879909, "overlap_percentage": 0.728257755195599, "num_intersection": 152503, "num_union": 266313, "num_only_computed": 56905, "num_only_roped": 56905, "total_diff": 113810, "diff_percentage": 0.4273542786120092, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:56:51.253111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 0.00014972686767578125, "l2_diff": 0.7578125, "l2_diff_relative": 0.1426470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:02.163310", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48845674994154115, "overlap_percentage": 0.6563264266304348, "num_intersection": 154578, "num_union": 316462, "num_only_computed": 80942, "num_only_roped": 80942, "total_diff": 161884, "diff_percentage": 0.5115432500584588, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:02.526097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 0.00011348724365234375, "l2_diff": 0.859375, "l2_diff_relative": 0.13819095477386933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:15.302727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4282896636645472, "overlap_percentage": 0.5997238159179688, "num_intersection": 157214, "num_union": 367074, "num_only_computed": 104930, "num_only_roped": 104930, "total_diff": 209860, "diff_percentage": 0.5717103363354528, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:15.738603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 9.250640869140625e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.1338862559241706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:31.299118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38984530005809986, "overlap_percentage": 0.5609909247335702, "num_intersection": 161709, "num_union": 414803, "num_only_computed": 126547, "num_only_roped": 126547, "total_diff": 253094, "diff_percentage": 0.6101546999419001, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:31.813352", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 9.918212890625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1771978021978022}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:48.925088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36189384897641785, "overlap_percentage": 0.5314567640472313, "num_intersection": 167073, "num_union": 461663, "num_only_computed": 147295, "num_only_roped": 147295, "total_diff": 294590, "diff_percentage": 0.6381061510235821, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:57:51.723536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.7578125, "l2_diff_relative": 0.11123853211009174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:58:11.424751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33959432104545645, "overlap_percentage": 0.5070106907894737, "num_intersection": 172627, "num_union": 508333, "num_only_computed": 167853, "num_only_roped": 167853, "total_diff": 335706, "diff_percentage": 0.6604056789545436, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:58:12.110354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.06190191387559808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:58:34.394361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3108957625603433, "overlap_percentage": 0.4743256808659218, "num_intersection": 173884, "num_union": 559300, "num_only_computed": 192708, "num_only_roped": 192708, "total_diff": 385416, "diff_percentage": 0.6891042374396568, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:58:35.154183", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.10801630434782608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:58:59.983132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2795293397936306, "overlap_percentage": 0.4369252522786458, "num_intersection": 171806, "num_union": 614626, "num_only_computed": 221410, "num_only_roped": 221410, "total_diff": 442820, "diff_percentage": 0.7204706602063694, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:59:01.403223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.83984375, "l2_diff_relative": 0.12858851674641147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:59:28.730109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26139860602651377, "overlap_percentage": 0.4144583714896215, "num_intersection": 173794, "num_union": 664862, "num_only_computed": 245534, "num_only_roped": 245534, "total_diff": 491068, "diff_percentage": 0.7386013939734862, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T18:59:29.649707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.1645077720207254}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:00:00.008959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2528072427918724, "overlap_percentage": 0.4035852191091954, "num_intersection": 179773, "num_union": 711107, "num_only_computed": 265667, "num_only_roped": 265667, "total_diff": 531334, "diff_percentage": 0.7471927572081276, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:00:01.014140", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07275390625, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.15591397849462366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:00:33.629876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25029696249787886, "overlap_percentage": 0.4003800217155266, "num_intersection": 188800, "num_union": 754304, "num_only_computed": 282752, "num_only_roped": 282752, "total_diff": 565504, "diff_percentage": 0.7497030375021212, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:00:34.714468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.15699404761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:01:11.043810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23787161220997333, "overlap_percentage": 0.3843235596707819, "num_intersection": 191264, "num_union": 804064, "num_only_computed": 306400, "num_only_roped": 306400, "total_diff": 612800, "diff_percentage": 0.7621283877900267, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:01:12.229314", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.20958083832335328}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:01:51.181583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2310856836932007, "overlap_percentage": 0.37541770935058594, "num_intersection": 196827, "num_union": 851749, "num_only_computed": 327461, "num_only_roped": 327461, "total_diff": 654922, "diff_percentage": 0.7689143163067993, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:01:52.454350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 5.340576171875e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.2690972222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:02:34.362604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22002850575324126, "overlap_percentage": 0.3606940406976744, "num_intersection": 198526, "num_union": 902274, "num_only_computed": 351874, "num_only_roped": 351874, "total_diff": 703748, "diff_percentage": 0.7799714942467587, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:02:35.728409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.13342696629213482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:03:19.655072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2041334440319355, "overlap_percentage": 0.3390545209813499, "num_intersection": 195469, "num_union": 957555, "num_only_computed": 381043, "num_only_roped": 381043, "total_diff": 762086, "diff_percentage": 0.7958665559680645, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:03:22.375185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.21957671957671956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:04:09.440630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18334778258765036, "overlap_percentage": 0.3098797923746814, "num_intersection": 186741, "num_union": 1018507, "num_only_computed": 415883, "num_only_roped": 415883, "total_diff": 831766, "diff_percentage": 0.8166522174123496, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:04:11.008417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 5.125999450683594e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.3160919540229885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:05:01.285561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16899649990471188, "overlap_percentage": 0.2891308911848534, "num_intersection": 181787, "num_union": 1075685, "num_only_computed": 446949, "num_only_roped": 446949, "total_diff": 893898, "diff_percentage": 0.8310035000952881, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:05:03.036064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 9.202957153320312e-05, "l2_diff": 3.09375, "l2_diff_relative": 0.782608695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:05:55.682087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16301273109944597, "overlap_percentage": 0.280328369140625, "num_intersection": 183716, "num_union": 1127004, "num_only_computed": 471644, "num_only_roped": 471644, "total_diff": 943288, "diff_percentage": 0.8369872689005541, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:05:57.425329", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19140625, "mean_diff": 9.34600830078125e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.9070796460176991}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:06:52.632456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16286196952374452, "overlap_percentage": 0.2801054188580015, "num_intersection": 190884, "num_union": 1172060, "num_only_computed": 490588, "num_only_roped": 490588, "total_diff": 981176, "diff_percentage": 0.8371380304762555, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:06:54.472494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 9.775161743164062e-05, "l2_diff": 3.203125, "l2_diff_relative": 1.0904255319148937}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:07:53.265879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15589214478709607, "overlap_percentage": 0.26973475940665703, "num_intersection": 190860, "num_union": 1224308, "num_only_computed": 516724, "num_only_roped": 516724, "total_diff": 1033448, "diff_percentage": 0.844107855212904, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:07:55.240545", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.20703125, "mean_diff": 8.821487426757812e-05, "l2_diff": 3.5, "l2_diff_relative": 0.9068825910931174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:08:58.246096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15609858327122375, "overlap_percentage": 0.2700437238311235, "num_intersection": 198130, "num_union": 1269262, "num_only_computed": 535566, "num_only_roped": 535566, "total_diff": 1071132, "diff_percentage": 0.8439014167287763, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:09:00.299984", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.486343383789062e-05, "l2_diff": 3.0, "l2_diff_relative": 0.7384615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:10:05.162822", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1593520026000461, "overlap_percentage": 0.27489839538409705, "num_intersection": 208870, "num_union": 1310746, "num_only_computed": 550938, "num_only_roped": 550938, "total_diff": 1101876, "diff_percentage": 0.8406479973999539, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:10:07.397636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 8.0108642578125e-05, "l2_diff": 2.953125, "l2_diff_relative": 0.8181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:11:15.114278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1576182355724965, "overlap_percentage": 0.27231470743815106, "num_intersection": 214157, "num_union": 1358707, "num_only_computed": 572275, "num_only_roped": 572275, "total_diff": 1144550, "diff_percentage": 0.8423817644275035, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:11:17.430132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 8.296966552734375e-05, "l2_diff": 3.140625, "l2_diff_relative": 1.0523560209424083}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:12:29.048657", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15613361477437407, "overlap_percentage": 0.2700961424858223, "num_intersection": 219465, "num_union": 1405623, "num_only_computed": 593079, "num_only_roped": 593079, "total_diff": 1186158, "diff_percentage": 0.843866385225626, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:12:32.079421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.212890625, "mean_diff": 8.344650268554688e-05, "l2_diff": 3.140625, "l2_diff_relative": 1.1229050279329609}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:13:49.234474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15270348142630255, "overlap_percentage": 0.26494841715469486, "num_intersection": 217294, "num_union": 1422980, "num_only_computed": 602843, "num_only_roped": 602843, "total_diff": 1205686, "diff_percentage": 0.8472965185736975, "num_computed": 820137, "num_roped": 820137}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "mask_shape": [1, 32, 501, 13813], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:13:51.806238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1826171875, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.9490740740740741}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "attention_shape": [1, 32, 501, 13813]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:15:03.658835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14603836433304992, "overlap_percentage": 0.2548577235772358, "num_intersection": 12539, "num_union": 85861, "num_only_computed": 36661, "num_only_roped": 36661, "total_diff": 73322, "diff_percentage": 0.85396163566695, "num_computed": 49200, "num_roped": 49200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "mask_shape": [1, 32, 30, 13843], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:15:06.402650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.34375, "l2_diff_relative": 0.30344827586206896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "attention_shape": [1, 32, 30, 13843]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:16:03.758878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15574348132487667, "overlap_percentage": 0.26951219512195124, "num_intersection": 442, "num_union": 2838, "num_only_computed": 1198, "num_only_roped": 1198, "total_diff": 2396, "diff_percentage": 0.8442565186751233, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "mask_shape": [1, 32, 1, 13844], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:16:05.400604", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.13333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "attention_shape": [1, 32, 1, 13844]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:16:55.938028", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14805740287014352, "overlap_percentage": 0.2579268292682927, "num_intersection": 423, "num_union": 2857, "num_only_computed": 1217, "num_only_roped": 1217, "total_diff": 2434, "diff_percentage": 0.8519425971298565, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "mask_shape": [1, 32, 1, 13845], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:16:57.531869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020263671875, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.14026717557251908}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "attention_shape": [1, 32, 1, 13845]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:17:48.151363", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14605171208944795, "overlap_percentage": 0.2548780487804878, "num_intersection": 418, "num_union": 2862, "num_only_computed": 1222, "num_only_roped": 1222, "total_diff": 2444, "diff_percentage": 0.8539482879105521, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "mask_shape": [1, 32, 1, 13846], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:17:51.981307", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.028076171875, "l2_diff_relative": 0.12721238938053098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "attention_shape": [1, 32, 1, 13846]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:18:42.658141", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1472542847149353, "overlap_percentage": 0.25670731707317074, "num_intersection": 421, "num_union": 2859, "num_only_computed": 1219, "num_only_roped": 1219, "total_diff": 2438, "diff_percentage": 0.8527457152850647, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "mask_shape": [1, 32, 1, 13847], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:18:44.991169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.12410071942446044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "attention_shape": [1, 32, 1, 13847]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:19:36.650991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15371086880056278, "overlap_percentage": 0.26646341463414636, "num_intersection": 437, "num_union": 2843, "num_only_computed": 1203, "num_only_roped": 1203, "total_diff": 2406, "diff_percentage": 0.8462891311994372, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "mask_shape": [1, 32, 1, 13848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:19:38.330666", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.051025390625, "l2_diff_relative": 0.1814236111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "attention_shape": [1, 32, 1, 13848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:20:29.843149", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14206128133704735, "overlap_percentage": 0.24878048780487805, "num_intersection": 408, "num_union": 2872, "num_only_computed": 1232, "num_only_roped": 1232, "total_diff": 2464, "diff_percentage": 0.8579387186629527, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "mask_shape": [1, 32, 1, 13849], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:20:31.456737", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.0250244140625, "l2_diff_relative": 0.09284420289855072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "attention_shape": [1, 32, 1, 13849]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:21:21.770864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13800277392510402, "overlap_percentage": 0.2425350396099939, "num_intersection": 398, "num_union": 2884, "num_only_computed": 1243, "num_only_roped": 1243, "total_diff": 2486, "diff_percentage": 0.8619972260748959, "num_computed": 1641, "num_roped": 1641}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "mask_shape": [1, 32, 1, 13850], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:21:23.400414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.21373056994818654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "attention_shape": [1, 32, 1, 13850]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:21:54.622413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:21:54.635963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.023193359375, "l2_diff_relative": 0.003185354077253219}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:21:58.053672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.676331926451961, "overlap_percentage": 0.8069188634776536, "num_intersection": 147905, "num_union": 218687, "num_only_computed": 35391, "num_only_roped": 35391, "total_diff": 70782, "diff_percentage": 0.323668073548039, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:21:58.864248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 0.0001277923583984375, "l2_diff": 0.5, "l2_diff_relative": 0.08465608465608465}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:06.704981", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5657141148146486, "overlap_percentage": 0.722627597799511, "num_intersection": 151324, "num_union": 267492, "num_only_computed": 58084, "num_only_roped": 58084, "total_diff": 116168, "diff_percentage": 0.43428588518535133, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:07.000376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.000148773193359375, "l2_diff": 0.76953125, "l2_diff_relative": 0.13834269662921347}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:17.614546", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47920650921206753, "overlap_percentage": 0.6479237432065217, "num_intersection": 152599, "num_union": 318441, "num_only_computed": 82921, "num_only_roped": 82921, "total_diff": 165842, "diff_percentage": 0.5207934907879325, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:17.983913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.00011348724365234375, "l2_diff": 0.7578125, "l2_diff_relative": 0.14696969696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:31.052271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43178454194408183, "overlap_percentage": 0.6031417846679688, "num_intersection": 158110, "num_union": 366178, "num_only_computed": 104034, "num_only_roped": 104034, "total_diff": 208068, "diff_percentage": 0.5682154580559181, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:31.500967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 0.00010538101196289062, "l2_diff": 0.828125, "l2_diff_relative": 0.16772151898734178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:47.438298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38848628040336314, "overlap_percentage": 0.5595824544849023, "num_intersection": 161303, "num_union": 415209, "num_only_computed": 126953, "num_only_roped": 126953, "total_diff": 253906, "diff_percentage": 0.6115137195966369, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:22:47.974879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.00010395050048828125, "l2_diff": 0.9609375, "l2_diff_relative": 0.19462025316455697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:23:05.668555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35150426042320493, "overlap_percentage": 0.5201674470684039, "num_intersection": 163524, "num_union": 465212, "num_only_computed": 150844, "num_only_roped": 150844, "total_diff": 301688, "diff_percentage": 0.6484957395767951, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:23:08.202969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 7.581710815429688e-05, "l2_diff": 0.84765625, "l2_diff_relative": 0.16050295857988164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:23:28.475847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31896653579529055, "overlap_percentage": 0.48366130169172933, "num_intersection": 164677, "num_union": 516283, "num_only_computed": 175803, "num_only_roped": 175803, "total_diff": 351606, "diff_percentage": 0.6810334642047094, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:23:29.183765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 9.584426879882812e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.2427536231884058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:23:52.033843", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30255364357005554, "overlap_percentage": 0.4645546002094972, "num_intersection": 170302, "num_union": 562882, "num_only_computed": 196290, "num_only_roped": 196290, "total_diff": 392580, "diff_percentage": 0.6974463564299445, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:23:52.825582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06884765625, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.953125, "l2_diff_relative": 0.22262773722627738}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:24:18.376178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28568135559969593, "overlap_percentage": 0.44440460205078125, "num_intersection": 174747, "num_union": 611685, "num_only_computed": 218469, "num_only_roped": 218469, "total_diff": 436938, "diff_percentage": 0.7143186444003041, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:24:19.264291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.98828125, "l2_diff_relative": 0.2151360544217687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:24:47.641106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2718413474006033, "overlap_percentage": 0.42747682005494503, "num_intersection": 179253, "num_union": 659403, "num_only_computed": 240075, "num_only_roped": 240075, "total_diff": 480150, "diff_percentage": 0.7281586525993967, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:24:48.775051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.2309027777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:25:19.882110", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2595201302951859, "overlap_percentage": 0.4120936602011494, "num_intersection": 183563, "num_union": 707317, "num_only_computed": 261877, "num_only_roped": 261877, "total_diff": 523754, "diff_percentage": 0.740479869704814, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:25:20.922417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.25555555555555554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:25:54.515215", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25146330750622675, "overlap_percentage": 0.4018708435124864, "num_intersection": 189503, "num_union": 753601, "num_only_computed": 282049, "num_only_roped": 282049, "total_diff": 564098, "diff_percentage": 0.7485366924937732, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:25:55.630037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.1610294117647059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:26:32.019531", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23789316584789502, "overlap_percentage": 0.38435169110082307, "num_intersection": 191278, "num_union": 804050, "num_only_computed": 306386, "num_only_roped": 306386, "total_diff": 612772, "diff_percentage": 0.762106834152105, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:26:35.408354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.20572916666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:27:15.168908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22355115671754994, "overlap_percentage": 0.3654136657714844, "num_intersection": 191582, "num_union": 856994, "num_only_computed": 332706, "num_only_roped": 332706, "total_diff": 665412, "diff_percentage": 0.77644884328245, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:27:18.573354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.22727272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:28:01.327679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22178886405157086, "overlap_percentage": 0.3630559593023256, "num_intersection": 199826, "num_union": 900974, "num_only_computed": 350574, "num_only_roped": 350574, "total_diff": 701148, "diff_percentage": 0.7782111359484292, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:28:02.732780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.1473463687150838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:28:48.818385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21182667770915925, "overlap_percentage": 0.3495989675843694, "num_intersection": 201548, "num_union": 951476, "num_only_computed": 374964, "num_only_roped": 374964, "total_diff": 749928, "diff_percentage": 0.7881733222908408, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:28:50.309560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 5.340576171875e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.3065068493150685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:29:40.043597", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19892487023438385, "overlap_percentage": 0.3318387584961767, "num_intersection": 199974, "num_union": 1005274, "num_only_computed": 402650, "num_only_roped": 402650, "total_diff": 805300, "diff_percentage": 0.8010751297656161, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:29:41.634228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 5.888938903808594e-05, "l2_diff": 1.8046875, "l2_diff_relative": 0.35648148148148145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:30:33.146877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17639926804351325, "overlap_percentage": 0.2998969360749186, "num_intersection": 188556, "num_union": 1068916, "num_only_computed": 440180, "num_only_roped": 440180, "total_diff": 880360, "diff_percentage": 0.8236007319564868, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:30:34.857104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 9.1552734375e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:31:29.491510", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16340706998443133, "overlap_percentage": 0.2809112548828125, "num_intersection": 184098, "num_union": 1126622, "num_only_computed": 471262, "num_only_roped": 471262, "total_diff": 942524, "diff_percentage": 0.8365929300155687, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:31:31.304380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 9.059906005859375e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.7510917030567685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:32:29.111310", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1599839314772828, "overlap_percentage": 0.2758381855747558, "num_intersection": 187976, "num_union": 1174968, "num_only_computed": 493496, "num_only_roped": 493496, "total_diff": 986992, "diff_percentage": 0.8400160685227173, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:32:31.024138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.487701416015625e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.7688888888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:33:32.146794", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.158175750105983, "overlap_percentage": 0.27314636848769897, "num_intersection": 193274, "num_union": 1221894, "num_only_computed": 514310, "num_only_roped": 514310, "total_diff": 1028620, "diff_percentage": 0.8418242498940169, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:33:34.134117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 0.00010156631469726562, "l2_diff": 3.15625, "l2_diff_relative": 1.1952662721893492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:34:36.911566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15521210231799445, "overlap_percentage": 0.2687161985345429, "num_intersection": 197156, "num_union": 1270236, "num_only_computed": 536540, "num_only_roped": 536540, "total_diff": 1073080, "diff_percentage": 0.8447878976820056, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:34:40.424627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1943359375, "mean_diff": 9.72747802734375e-05, "l2_diff": 2.890625, "l2_diff_relative": 1.1419753086419753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:35:46.119519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15406832140114995, "overlap_percentage": 0.26700034745619944, "num_intersection": 202869, "num_union": 1316747, "num_only_computed": 556939, "num_only_roped": 556939, "total_diff": 1113878, "diff_percentage": 0.84593167859885, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:35:49.746244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 8.630752563476562e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.9887005649717514}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:36:58.939736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14981322143676942, "overlap_percentage": 0.26058705647786456, "num_intersection": 204934, "num_union": 1367930, "num_only_computed": 581498, "num_only_roped": 581498, "total_diff": 1162996, "diff_percentage": 0.8501867785632305, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:37:01.280828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.8256410256410256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:38:14.763054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14755485191694837, "overlap_percentage": 0.25716391973850034, "num_intersection": 208957, "num_union": 1416131, "num_only_computed": 603587, "num_only_roped": 603587, "total_diff": 1207174, "diff_percentage": 0.8524451480830516, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:38:18.822580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 8.106231689453125e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.9401197604790419}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:39:37.708745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1427278933161831, "overlap_percentage": 0.24980206425518925, "num_intersection": 209498, "num_union": 1467814, "num_only_computed": 629158, "num_only_roped": 629158, "total_diff": 1258316, "diff_percentage": 0.8572721066838169, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:39:41.859658", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 7.295608520507812e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.765625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:41:03.768216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13848928677220815, "overlap_percentage": 0.24328606053878035, "num_intersection": 210386, "num_union": 1519150, "num_only_computed": 654382, "num_only_roped": 654382, "total_diff": 1308764, "diff_percentage": 0.8615107132277918, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:41:07.967990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 7.200241088867188e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.8176795580110497}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:42:34.916295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1335807781915997, "overlap_percentage": 0.2356793283045977, "num_intersection": 209962, "num_union": 1571798, "num_only_computed": 680918, "num_only_roped": 680918, "total_diff": 1361836, "diff_percentage": 0.8664192218084004, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:42:37.772411", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.8596491228070176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:44:06.364500", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13155520639538648, "overlap_percentage": 0.23252105712890625, "num_intersection": 213339, "num_union": 1621669, "num_only_computed": 704165, "num_only_roped": 704165, "total_diff": 1408330, "diff_percentage": 0.8684447936046135, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:44:09.307348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 6.29425048828125e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.7606382978723404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:45:40.577698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12976108520356547, "overlap_percentage": 0.2297142057786218, "num_intersection": 216762, "num_union": 1670470, "num_only_computed": 726854, "num_only_roped": 726854, "total_diff": 1453708, "diff_percentage": 0.8702389147964346, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:45:43.639772", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.9408284023668639}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:47:19.458223", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13807931369876222, "overlap_percentage": 0.24265323521258622, "num_intersection": 231968, "num_union": 1679962, "num_only_computed": 723997, "num_only_roped": 723997, "total_diff": 1447994, "diff_percentage": 0.8619206863012377, "num_computed": 955965, "num_roped": 955965}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 505, "seq_len_k": 16377, "queries_shape": [1, 32, 505, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 505, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:47:22.655386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.9595375722543352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 505, "seq_len_k": 16377, "queries_shape": [1, 32, 505, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 505, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:48:49.881592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11672615471604764, "overlap_percentage": 0.2090506329113924, "num_intersection": 9909, "num_union": 84891, "num_only_computed": 37491, "num_only_roped": 37491, "total_diff": 74982, "diff_percentage": 0.8832738452839524, "num_computed": 47400, "num_roped": 47400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "mask_shape": [1, 32, 25, 16402], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:48:53.187759", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.421875, "l2_diff_relative": 0.4251968503937008}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "attention_shape": [1, 32, 25, 16402]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:50:01.814484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11825420230020643, "overlap_percentage": 0.21149789029535865, "num_intersection": 401, "num_union": 3391, "num_only_computed": 1495, "num_only_roped": 1495, "total_diff": 2990, "diff_percentage": 0.8817457976997936, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "mask_shape": [1, 32, 1, 16403], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:50:03.975063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.115234375, "l2_diff_relative": 0.8489208633093526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "attention_shape": [1, 32, 1, 16403]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:51:03.402149", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11858407079646018, "overlap_percentage": 0.2120253164556962, "num_intersection": 402, "num_union": 3390, "num_only_computed": 1494, "num_only_roped": 1494, "total_diff": 2988, "diff_percentage": 0.8814159292035398, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "mask_shape": [1, 32, 1, 16404], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:51:05.336354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.052734375, "l2_diff_relative": 0.32727272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "attention_shape": [1, 32, 1, 16404]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:52:04.671631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10683012259194395, "overlap_percentage": 0.1930379746835443, "num_intersection": 366, "num_union": 3426, "num_only_computed": 1530, "num_only_roped": 1530, "total_diff": 3060, "diff_percentage": 0.8931698774080561, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "mask_shape": [1, 32, 1, 16405], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:52:08.693217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.053466796875, "l2_diff_relative": 0.33796296296296297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "attention_shape": [1, 32, 1, 16405]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:53:08.781667", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12089861070056163, "overlap_percentage": 0.21571729957805907, "num_intersection": 409, "num_union": 3383, "num_only_computed": 1487, "num_only_roped": 1487, "total_diff": 2974, "diff_percentage": 0.8791013892994384, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "mask_shape": [1, 32, 1, 16406], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:53:10.709227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 4.744529724121094e-05, "l2_diff": 0.048583984375, "l2_diff_relative": 0.3528368794326241}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "attention_shape": [1, 32, 1, 16406]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:54:09.094289", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11202346041055719, "overlap_percentage": 0.20147679324894516, "num_intersection": 382, "num_union": 3410, "num_only_computed": 1514, "num_only_roped": 1514, "total_diff": 3028, "diff_percentage": 0.8879765395894428, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "mask_shape": [1, 32, 1, 16407], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:54:12.634063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 5.412101745605469e-05, "l2_diff": 0.08203125, "l2_diff_relative": 0.5454545454545454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "attention_shape": [1, 32, 1, 16407]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:55:10.843148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14148103552077063, "overlap_percentage": 0.2478902953586498, "num_intersection": 470, "num_union": 3322, "num_only_computed": 1426, "num_only_roped": 1426, "total_diff": 2852, "diff_percentage": 0.8585189644792294, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "mask_shape": [1, 32, 1, 16408], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:55:12.736406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 3.528594970703125e-05, "l2_diff": 0.05859375, "l2_diff_relative": 0.24896265560165975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "attention_shape": [1, 32, 1, 16408]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:55:50.275302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:55:50.287704", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.16908073425293e-06, "l2_diff": 0.0225830078125, "l2_diff_relative": 0.003049182489451477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:55:53.578643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6999554830093486, "overlap_percentage": 0.8234986033519553, "num_intersection": 150944, "num_union": 215648, "num_only_computed": 32352, "num_only_roped": 32352, "total_diff": 64704, "diff_percentage": 0.30004451699065143, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:55:53.796472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 0.0001277923583984375, "l2_diff": 0.5, "l2_diff_relative": 0.07511737089201878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:01.576352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5941534713763703, "overlap_percentage": 0.7454156479217604, "num_intersection": 156096, "num_union": 262720, "num_only_computed": 53312, "num_only_roped": 53312, "total_diff": 106624, "diff_percentage": 0.40584652862362974, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:01.868436", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 0.0001163482666015625, "l2_diff": 0.6640625, "l2_diff_relative": 0.0952914798206278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:11.931804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5091002873774961, "overlap_percentage": 0.67470703125, "num_intersection": 158907, "num_union": 312133, "num_only_computed": 76613, "num_only_roped": 76613, "total_diff": 153226, "diff_percentage": 0.49089971262250387, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:14.708836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 6.580352783203125e-05, "l2_diff": 0.52734375, "l2_diff_relative": 0.084375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:27.072421", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4553731786599601, "overlap_percentage": 0.6257820129394531, "num_intersection": 164045, "num_union": 360243, "num_only_computed": 98099, "num_only_roped": 98099, "total_diff": 196198, "diff_percentage": 0.5446268213400399, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:28.467934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.269050598144531e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.08177570093457943}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:43.158563", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40248379210100593, "overlap_percentage": 0.5739585646092362, "num_intersection": 165447, "num_union": 411065, "num_only_computed": 122809, "num_only_roped": 122809, "total_diff": 245618, "diff_percentage": 0.5975162078989941, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:56:43.675385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.423828125, "l2_diff_relative": 0.06458333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:57:00.779806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3833149253928372, "overlap_percentage": 0.554197628257329, "num_intersection": 174222, "num_union": 454514, "num_only_computed": 140146, "num_only_roped": 140146, "total_diff": 280292, "diff_percentage": 0.6166850746071628, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:57:01.362617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.56640625, "l2_diff_relative": 0.10853293413173652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:57:20.968065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35114060029087935, "overlap_percentage": 0.5197691494360902, "num_intersection": 176971, "num_union": 503989, "num_only_computed": 163509, "num_only_roped": 163509, "total_diff": 327018, "diff_percentage": 0.6488593997091207, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:57:23.747614", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 7.915496826171875e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.19212962962962962}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:57:46.510367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3119184631681411, "overlap_percentage": 0.47551501396648044, "num_intersection": 174320, "num_union": 558864, "num_only_computed": 192272, "num_only_roped": 192272, "total_diff": 384544, "diff_percentage": 0.6880815368318589, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:57:47.280730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.20520231213872833}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:58:13.132858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2838364644347366, "overlap_percentage": 0.442169189453125, "num_intersection": 173868, "num_union": 612564, "num_only_computed": 219348, "num_only_roped": 219348, "total_diff": 438696, "diff_percentage": 0.7161635355652634, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:58:13.997749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.19166666666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:58:41.607781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26487249561109805, "overlap_percentage": 0.41881295787545786, "num_intersection": 175620, "num_union": 663036, "num_only_computed": 243708, "num_only_roped": 243708, "total_diff": 487416, "diff_percentage": 0.735127504388902, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:58:42.543629", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08642578125, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.14125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:59:12.914083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2526504648507584, "overlap_percentage": 0.40338541666666666, "num_intersection": 179684, "num_union": 711196, "num_only_computed": 265756, "num_only_roped": 265756, "total_diff": 531512, "diff_percentage": 0.7473495351492415, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:59:14.879199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.340576171875e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.19305555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:59:47.923751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24586222521067017, "overlap_percentage": 0.39468605795331163, "num_intersection": 186115, "num_union": 756989, "num_only_computed": 285437, "num_only_roped": 285437, "total_diff": 570874, "diff_percentage": 0.7541377747893299, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T19:59:49.051999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.9296875, "l2_diff_relative": 0.14302884615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:00:25.294956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23418164142904616, "overlap_percentage": 0.379492991255144, "num_intersection": 188860, "num_union": 806468, "num_only_computed": 308804, "num_only_roped": 308804, "total_diff": 617608, "diff_percentage": 0.7658183585709538, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:00:26.484032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.671875, "l2_diff_relative": 0.1096938775510204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:01:04.864122", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2234112557345069, "overlap_percentage": 0.36522674560546875, "num_intersection": 191484, "num_union": 857092, "num_only_computed": 332804, "num_only_roped": 332804, "total_diff": 665608, "diff_percentage": 0.7765887442654931, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:01:06.119936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.18064024390243902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:01:47.208992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21339585496568586, "overlap_percentage": 0.3517332848837209, "num_intersection": 193594, "num_union": 907206, "num_only_computed": 356806, "num_only_roped": 356806, "total_diff": 713612, "diff_percentage": 0.7866041450343142, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:01:48.575731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.2261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:02:34.279815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19842389231247343, "overlap_percentage": 0.3311414159635879, "num_intersection": 190907, "num_union": 962117, "num_only_computed": 385605, "num_only_roped": 385605, "total_diff": 771210, "diff_percentage": 0.8015761076875265, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:02:35.782816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 5.745887756347656e-05, "l2_diff": 1.6015625, "l2_diff_relative": 0.3559027777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:03:23.952994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17952030314774145, "overlap_percentage": 0.30439544392523366, "num_intersection": 183436, "num_union": 1021812, "num_only_computed": 419188, "num_only_roped": 419188, "total_diff": 838376, "diff_percentage": 0.8204796968522585, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:03:25.553365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12451171875, "mean_diff": 7.009506225585938e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.48507462686567165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:04:17.049455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16521710122742023, "overlap_percentage": 0.2835816622557003, "num_intersection": 178298, "num_union": 1079174, "num_only_computed": 450438, "num_only_roped": 450438, "total_diff": 900876, "diff_percentage": 0.8347828987725797, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:04:20.422961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1953125, "mean_diff": 8.916854858398438e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.7991452991452992}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:05:15.153532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1564567630115944, "overlap_percentage": 0.27057952880859376, "num_intersection": 177327, "num_union": 1133393, "num_only_computed": 478033, "num_only_roped": 478033, "total_diff": 956066, "diff_percentage": 0.8435432369884056, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:05:16.974365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 9.107589721679688e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.8388625592417062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:06:14.468287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15035786630654963, "overlap_percentage": 0.2614105935386927, "num_intersection": 178144, "num_union": 1184800, "num_only_computed": 503328, "num_only_roped": 503328, "total_diff": 1006656, "diff_percentage": 0.8496421336934503, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:06:16.382447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.772445678710938e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.7025862068965517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:07:15.684626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14767111245192924, "overlap_percentage": 0.25734047123733717, "num_intersection": 182090, "num_union": 1233078, "num_only_computed": 525494, "num_only_roped": 525494, "total_diff": 1050988, "diff_percentage": 0.8523288875480708, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:07:19.363947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 8.296966552734375e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.861878453038674}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:08:21.439678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15151705390830503, "overlap_percentage": 0.2631607641311933, "num_intersection": 193080, "num_union": 1274312, "num_only_computed": 540616, "num_only_roped": 540616, "total_diff": 1081232, "diff_percentage": 0.848482946091695, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:08:23.496923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.197265625, "mean_diff": 8.96453857421875e-05, "l2_diff": 2.90625, "l2_diff_relative": 1.062857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:09:29.550705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14974612184184424, "overlap_percentage": 0.2604855437163073, "num_intersection": 197919, "num_union": 1321697, "num_only_computed": 561889, "num_only_roped": 561889, "total_diff": 1123778, "diff_percentage": 0.8502538781581558, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:09:31.720447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.7608695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:10:43.655936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.158589477654158, "overlap_percentage": 0.2737630208333333, "num_intersection": 215296, "num_union": 1357568, "num_only_computed": 571136, "num_only_roped": 571136, "total_diff": 1142272, "diff_percentage": 0.841410522345842, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:10:47.085286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.6763485477178424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:12:01.078839", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15808459617104517, "overlap_percentage": 0.27301044620352866, "num_intersection": 221833, "num_union": 1403255, "num_only_computed": 590711, "num_only_roped": 590711, "total_diff": 1181422, "diff_percentage": 0.8419154038289548, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:12:03.757259", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.66796875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:13:22.702454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15080572290706554, "overlap_percentage": 0.2620871966575092, "num_intersection": 219801, "num_union": 1457511, "num_only_computed": 618855, "num_only_roped": 618855, "total_diff": 1237710, "diff_percentage": 0.8491942770929345, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:13:25.289308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.866455078125e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.7763157894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:14:45.511376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14036443429343054, "overlap_percentage": 0.2461746965660154, "num_intersection": 212884, "num_union": 1516652, "num_only_computed": 651884, "num_only_roped": 651884, "total_diff": 1303768, "diff_percentage": 0.8596355657065695, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:14:48.180027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.103515625e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.6194690265486725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:16:13.344322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14489572463283865, "overlap_percentage": 0.25311602011494255, "num_intersection": 225496, "num_union": 1556264, "num_only_computed": 665384, "num_only_roped": 665384, "total_diff": 1330768, "diff_percentage": 0.8551042753671614, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:16:16.097857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 6.29425048828125e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.6740088105726872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:17:43.422123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13347943932853837, "overlap_percentage": 0.23552158900669642, "num_intersection": 216092, "num_union": 1618916, "num_only_computed": 701412, "num_only_roped": 701412, "total_diff": 1402824, "diff_percentage": 0.8665205606714617, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:17:46.347176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.6915422885572139}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:19:12.403515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14008614588178198, "overlap_percentage": 0.24574659798788187, "num_intersection": 69274, "num_union": 494510, "num_only_computed": 212618, "num_only_roped": 212618, "total_diff": 425236, "diff_percentage": 0.8599138541182181, "num_computed": 281892, "num_roped": 281892}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "mask_shape": [1, 32, 156, 15516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:19:17.209469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.512987012987013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "attention_shape": [1, 32, 156, 15516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:20:36.604261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14203989778427434, "overlap_percentage": 0.2487476979742173, "num_intersection": 13507, "num_union": 95093, "num_only_computed": 40793, "num_only_roped": 40793, "total_diff": 81586, "diff_percentage": 0.8579601022157256, "num_computed": 54300, "num_roped": 54300}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "mask_shape": [1, 32, 30, 15546], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:20:40.030858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.482421875, "l2_diff_relative": 0.4678030303030303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "attention_shape": [1, 32, 30, 15546]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:21:46.793057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1394397230091281, "overlap_percentage": 0.2447513812154696, "num_intersection": 443, "num_union": 3177, "num_only_computed": 1367, "num_only_roped": 1367, "total_diff": 2734, "diff_percentage": 0.8605602769908719, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "mask_shape": [1, 32, 1, 15547], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:21:48.571867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.05810546875, "l2_diff_relative": 0.4160839160839161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "attention_shape": [1, 32, 1, 15547]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:22:45.176100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13908118313404658, "overlap_percentage": 0.24419889502762432, "num_intersection": 442, "num_union": 3178, "num_only_computed": 1368, "num_only_roped": 1368, "total_diff": 2736, "diff_percentage": 0.8609188168659534, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "mask_shape": [1, 32, 1, 15548], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:22:47.031063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0174560546875, "mean_diff": 3.039836883544922e-05, "l2_diff": 0.033935546875, "l2_diff_relative": 0.19744318181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "attention_shape": [1, 32, 1, 15548]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:23:43.907458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15066751430387795, "overlap_percentage": 0.261878453038674, "num_intersection": 474, "num_union": 3146, "num_only_computed": 1336, "num_only_roped": 1336, "total_diff": 2672, "diff_percentage": 0.8493324856961221, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15549, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15549, 128], "mask_shape": [1, 32, 1, 15549], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:23:45.749471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.5035460992907801}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15549, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15549, 128], "attention_shape": [1, 32, 1, 15549]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:24:42.577835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16052547260493433, "overlap_percentage": 0.2766427388183324, "num_intersection": 501, "num_union": 3121, "num_only_computed": 1310, "num_only_roped": 1310, "total_diff": 2620, "diff_percentage": 0.8394745273950657, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15550, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15550, 128], "mask_shape": [1, 32, 1, 15550], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:24:45.757835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 5.698204040527344e-05, "l2_diff": 0.068359375, "l2_diff_relative": 0.5343511450381679}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15550, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15550, 128], "attention_shape": [1, 32, 1, 15550]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:25:42.582889", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14729173265758633, "overlap_percentage": 0.2567642186637217, "num_intersection": 465, "num_union": 3157, "num_only_computed": 1346, "num_only_roped": 1346, "total_diff": 2692, "diff_percentage": 0.8527082673424137, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15551, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15551, 128], "mask_shape": [1, 32, 1, 15551], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:25:44.315295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 3.838539123535156e-05, "l2_diff": 0.04052734375, "l2_diff_relative": 0.23579545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15551, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15551, 128], "attention_shape": [1, 32, 1, 15551]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:26:39.274220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15681890769722134, "overlap_percentage": 0.27112092766427387, "num_intersection": 491, "num_union": 3131, "num_only_computed": 1320, "num_only_roped": 1320, "total_diff": 2640, "diff_percentage": 0.8431810923027787, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15552, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15552, 128], "mask_shape": [1, 32, 1, 15552], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:26:41.048072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.28591160220994477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15552, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15552, 128], "attention_shape": [1, 32, 1, 15552]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:27:35.979288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1454775458570525, "overlap_percentage": 0.25400331308669244, "num_intersection": 460, "num_union": 3162, "num_only_computed": 1351, "num_only_roped": 1351, "total_diff": 2702, "diff_percentage": 0.8545224541429475, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15553, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15553, 128], "mask_shape": [1, 32, 1, 15553], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:27:37.758535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.052978515625, "l2_diff_relative": 0.3522727272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15553, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15553, 128], "attention_shape": [1, 32, 1, 15553]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:10.824811", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:10.837291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.020069122314453e-06, "l2_diff": 0.0224609375, "l2_diff_relative": 0.002994791666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:14.234626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6856432115284694, "overlap_percentage": 0.8135092964385475, "num_intersection": 149113, "num_union": 217479, "num_only_computed": 34183, "num_only_roped": 34183, "total_diff": 68366, "diff_percentage": 0.3143567884715306, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:14.456866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.0001506805419921875, "l2_diff": 0.58203125, "l2_diff_relative": 0.0955128205128205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:22.539003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5750350683880575, "overlap_percentage": 0.7301870033618582, "num_intersection": 152907, "num_union": 265909, "num_only_computed": 56501, "num_only_roped": 56501, "total_diff": 113002, "diff_percentage": 0.42496493161194243, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:22.842963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.00019931793212890625, "l2_diff": 0.94921875, "l2_diff_relative": 0.18298192771084337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:33.372377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4990675382372972, "overlap_percentage": 0.6658372961956521, "num_intersection": 156818, "num_union": 314222, "num_only_computed": 78702, "num_only_roped": 78702, "total_diff": 157404, "diff_percentage": 0.5009324617627028, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:33.749706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.982948303222656e-05, "l2_diff": 0.421875, "l2_diff_relative": 0.06716417910447761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:46.750591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45280828200033807, "overlap_percentage": 0.6233558654785156, "num_intersection": 163409, "num_union": 360879, "num_only_computed": 98735, "num_only_roped": 98735, "total_diff": 197470, "diff_percentage": 0.5471917179996619, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:28:47.205762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 6.103515625e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.09090909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:29:02.881970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40744845769808236, "overlap_percentage": 0.5789888154973357, "num_intersection": 166897, "num_union": 409615, "num_only_computed": 121359, "num_only_roped": 121359, "total_diff": 242718, "diff_percentage": 0.5925515423019176, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:29:03.419215", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 8.487701416015625e-05, "l2_diff": 0.78515625, "l2_diff_relative": 0.15605590062111802}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:29:20.739405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3764826936970467, "overlap_percentage": 0.5470213253257329, "num_intersection": 171966, "num_union": 456770, "num_only_computed": 142402, "num_only_roped": 142402, "total_diff": 284804, "diff_percentage": 0.6235173063029533, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:29:23.400816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.8515625, "l2_diff_relative": 0.16029411764705884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:29:43.332798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3479285021477068, "overlap_percentage": 0.5162417763157895, "num_intersection": 175770, "num_union": 505190, "num_only_computed": 164710, "num_only_roped": 164710, "total_diff": 329420, "diff_percentage": 0.6520714978522932, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:29:44.032480", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 6.914138793945312e-05, "l2_diff": 0.8046875, "l2_diff_relative": 0.15512048192771086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:30:06.332317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3192409700555274, "overlap_percentage": 0.4839767370810056, "num_intersection": 177422, "num_union": 555762, "num_only_computed": 189170, "num_only_roped": 189170, "total_diff": 378340, "diff_percentage": 0.6807590299444727, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:30:07.104146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 6.866455078125e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.17527932960893855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:30:32.122311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30551317827398394, "overlap_percentage": 0.46803538004557294, "num_intersection": 184039, "num_union": 602393, "num_only_computed": 209177, "num_only_roped": 209177, "total_diff": 418354, "diff_percentage": 0.6944868217260161, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:30:32.930587", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.23178807947019867}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:31:00.394859", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27701989709606245, "overlap_percentage": 0.4338536897130647, "num_intersection": 181927, "num_union": 656729, "num_only_computed": 237401, "num_only_roped": 237401, "total_diff": 474802, "diff_percentage": 0.7229801029039375, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:31:01.308398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.55078125, "l2_diff_relative": 0.091796875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:31:31.321300", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2749770301484668, "overlap_percentage": 0.43134428879310344, "num_intersection": 192138, "num_union": 698742, "num_only_computed": 253302, "num_only_roped": 253302, "total_diff": 506604, "diff_percentage": 0.7250229698515331, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:31:32.303138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.12267080745341614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:32:04.967355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2571032497134174, "overlap_percentage": 0.4090407844733985, "num_intersection": 192884, "num_union": 750220, "num_only_computed": 278668, "num_only_roped": 278668, "total_diff": 557336, "diff_percentage": 0.7428967502865826, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:32:08.420184", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.1541005291005291}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:32:44.280929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23780541644333403, "overlap_percentage": 0.38423715599279834, "num_intersection": 191221, "num_union": 804107, "num_only_computed": 306443, "num_only_roped": 306443, "total_diff": 612886, "diff_percentage": 0.7621945835566659, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:32:45.476964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.11848341232227488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:33:23.967248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.228801920003, "overlap_percentage": 0.37239837646484375, "num_intersection": 195244, "num_union": 853332, "num_only_computed": 329044, "num_only_roped": 329044, "total_diff": 658088, "diff_percentage": 0.771198079997, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:33:25.242347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05712890625, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.09405940594059406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:34:06.688107", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22736050592941784, "overlap_percentage": 0.37048691860465116, "num_intersection": 203916, "num_union": 896884, "num_only_computed": 346484, "num_only_roped": 346484, "total_diff": 692968, "diff_percentage": 0.7726394940705822, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:34:08.059785", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.62890625, "l2_diff_relative": 0.11057692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:34:52.148485", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20305421248020167, "overlap_percentage": 0.3375645259769094, "num_intersection": 194610, "num_union": 958414, "num_only_computed": 381902, "num_only_roped": 381902, "total_diff": 763804, "diff_percentage": 0.7969457875197984, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:34:55.671967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.602836608886719e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.3386454183266932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:35:44.099943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17947066853907845, "overlap_percentage": 0.30432408931605776, "num_intersection": 183393, "num_union": 1021855, "num_only_computed": 419231, "num_only_roped": 419231, "total_diff": 838462, "diff_percentage": 0.8205293314609216, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:35:45.777011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 7.43865966796875e-05, "l2_diff": 1.8984375, "l2_diff_relative": 0.5352422907488987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:36:39.179202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16353622957751823, "overlap_percentage": 0.2811020841815961, "num_intersection": 176739, "num_union": 1080733, "num_only_computed": 451997, "num_only_roped": 451997, "total_diff": 903994, "diff_percentage": 0.8364637704224818, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:36:40.902580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.21484375, "mean_diff": 9.107589721679688e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.798941798941799}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:37:36.464166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15038406987684486, "overlap_percentage": 0.2614501953125, "num_intersection": 171344, "num_union": 1139376, "num_only_computed": 484016, "num_only_roped": 484016, "total_diff": 968032, "diff_percentage": 0.8496159301231552, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:37:40.032136", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.5, "l2_diff_relative": 0.6106870229007634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:38:38.361117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14496162582830413, "overlap_percentage": 0.2532165664913599, "num_intersection": 172560, "num_union": 1190384, "num_only_computed": 508912, "num_only_roped": 508912, "total_diff": 1017824, "diff_percentage": 0.8550383741716958, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:38:40.319797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.201171875, "mean_diff": 8.20159912109375e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.7362204724409449}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:39:41.438672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14245764730101193, "overlap_percentage": 0.2493880585202605, "num_intersection": 176463, "num_union": 1238705, "num_only_computed": 531121, "num_only_roped": 531121, "total_diff": 1062242, "diff_percentage": 0.857542352698988, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:39:45.372817", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.6377952755905512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:40:49.487312", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1410797158249661, "overlap_percentage": 0.24727407536636428, "num_intersection": 181424, "num_union": 1285968, "num_only_computed": 552272, "num_only_roped": 552272, "total_diff": 1104544, "diff_percentage": 0.8589202841750339, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:40:54.043866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 8.916854858398438e-05, "l2_diff": 3.078125, "l2_diff_relative": 0.985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:42:01.106049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14168254407106667, "overlap_percentage": 0.248199545148248, "num_intersection": 188584, "num_union": 1331032, "num_only_computed": 571224, "num_only_roped": 571224, "total_diff": 1142448, "diff_percentage": 0.8583174559289334, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:42:03.337522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 8.7738037109375e-05, "l2_diff": 3.171875, "l2_diff_relative": 0.9854368932038835}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:43:13.907974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13936352388596396, "overlap_percentage": 0.24463399251302084, "num_intersection": 192388, "num_union": 1380476, "num_only_computed": 594044, "num_only_roped": 594044, "total_diff": 1188088, "diff_percentage": 0.860636476114036, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:43:16.280500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 7.867813110351562e-05, "l2_diff": 3.140625, "l2_diff_relative": 0.9054054054054054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:44:30.015276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13883664150382768, "overlap_percentage": 0.24382187303087588, "num_intersection": 198116, "num_union": 1426972, "num_only_computed": 614428, "num_only_roped": 614428, "total_diff": 1228856, "diff_percentage": 0.8611633584961723, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:44:32.802119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.72265625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:45:44.269409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13758077603652397, "overlap_percentage": 0.2418830889809388, "num_intersection": 28146, "num_union": 204578, "num_only_computed": 88216, "num_only_roped": 88216, "total_diff": 176432, "diff_percentage": 0.862419223963476, "num_computed": 116362, "num_roped": 116362}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "mask_shape": [1, 32, 73, 13385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:45:46.427664", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.34309623430962344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "attention_shape": [1, 32, 73, 13385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:46:52.757682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13244694718181343, "overlap_percentage": 0.23391285130207373, "num_intersection": 12701, "num_union": 95895, "num_only_computed": 41597, "num_only_roped": 41597, "total_diff": 83194, "diff_percentage": 0.8675530528181865, "num_computed": 54298, "num_roped": 54298}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "mask_shape": [1, 32, 34, 13419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:46:54.996840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 6.008148193359375e-05, "l2_diff": 0.474609375, "l2_diff_relative": 0.41047297297297297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "attention_shape": [1, 32, 34, 13419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:47:51.780080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13736654804270462, "overlap_percentage": 0.24155193992490614, "num_intersection": 386, "num_union": 2810, "num_only_computed": 1212, "num_only_roped": 1212, "total_diff": 2424, "diff_percentage": 0.8626334519572953, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "mask_shape": [1, 32, 1, 13420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:47:53.359902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.05908203125, "l2_diff_relative": 0.33798882681564246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "attention_shape": [1, 32, 1, 13420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:48:42.061758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14428929466523452, "overlap_percentage": 0.2521902377972466, "num_intersection": 403, "num_union": 2793, "num_only_computed": 1195, "num_only_roped": 1195, "total_diff": 2390, "diff_percentage": 0.8557107053347655, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "mask_shape": [1, 32, 1, 13421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:48:44.049221", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.0751953125, "l2_diff_relative": 0.4556213017751479}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "attention_shape": [1, 32, 1, 13421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:49:32.719547", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14551971326164875, "overlap_percentage": 0.25406758448060074, "num_intersection": 406, "num_union": 2790, "num_only_computed": 1192, "num_only_roped": 1192, "total_diff": 2384, "diff_percentage": 0.8544802867383513, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "mask_shape": [1, 32, 1, 13422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:49:34.434425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.05908203125, "l2_diff_relative": 0.32180851063829785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "attention_shape": [1, 32, 1, 13422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:50:25.532712", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14102106390574795, "overlap_percentage": 0.24718397997496871, "num_intersection": 395, "num_union": 2801, "num_only_computed": 1203, "num_only_roped": 1203, "total_diff": 2406, "diff_percentage": 0.858978936094252, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "mask_shape": [1, 32, 1, 13423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:50:27.127099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.061279296875, "l2_diff_relative": 0.3201530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "attention_shape": [1, 32, 1, 13423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:16.225412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13615357269818698, "overlap_percentage": 0.23967459324155194, "num_intersection": 383, "num_union": 2813, "num_only_computed": 1215, "num_only_roped": 1215, "total_diff": 2430, "diff_percentage": 0.863846427301813, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "mask_shape": [1, 32, 1, 13424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:17.812528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.25870646766169153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "attention_shape": [1, 32, 1, 13424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:48.194059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 262144, "num_union": 262144, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 512, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:48.206600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.021484375, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 512, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 512, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:51.505451", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6960074022669442, "overlap_percentage": 0.8207598638268156, "num_intersection": 150442, "num_union": 216150, "num_only_computed": 32854, "num_only_roped": 32854, "total_diff": 65708, "diff_percentage": 0.30399259773305576, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 512, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:51.724339", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 9.059906005859375e-05, "l2_diff": 0.37890625, "l2_diff_relative": 0.06032338308457712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1024, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 512, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:59.640824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5710529178529764, "overlap_percentage": 0.7269684061735942, "num_intersection": 152233, "num_union": 266583, "num_only_computed": 57175, "num_only_roped": 57175, "total_diff": 114350, "diff_percentage": 0.42894708214702365, "num_computed": 209408, "num_roped": 209408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 512, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:51:59.936420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.00015354156494140625, "l2_diff": 0.83203125, "l2_diff_relative": 0.14791666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 1536, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 512, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:10.142720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4967763256149449, "overlap_percentage": 0.6637950067934782, "num_intersection": 156337, "num_union": 314703, "num_only_computed": 79183, "num_only_roped": 79183, "total_diff": 158366, "diff_percentage": 0.5032236743850551, "num_computed": 235520, "num_roped": 235520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 512, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:10.505013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.00013828277587890625, "l2_diff": 0.95703125, "l2_diff_relative": 0.1701388888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2048, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 512, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:23.100784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42428539605439736, "overlap_percentage": 0.5957870483398438, "num_intersection": 156182, "num_union": 368106, "num_only_computed": 105962, "num_only_roped": 105962, "total_diff": 211924, "diff_percentage": 0.5757146039456026, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 512, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:23.541074", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.12165775401069519}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 2560, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 512, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:38.474615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3881887223150605, "overlap_percentage": 0.5592737011545293, "num_intersection": 161214, "num_union": 415298, "num_only_computed": 127042, "num_only_roped": 127042, "total_diff": 254084, "diff_percentage": 0.6118112776849395, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 512, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:39.005969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 0.00010156631469726562, "l2_diff": 0.984375, "l2_diff_relative": 0.19444444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3072, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 512, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:56.567320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3501866144403929, "overlap_percentage": 0.518723279723127, "num_intersection": 163070, "num_union": 465666, "num_only_computed": 151298, "num_only_roped": 151298, "total_diff": 302596, "diff_percentage": 0.6498133855596071, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 512, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:52:57.184510", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07275390625, "mean_diff": 7.534027099609375e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.15752551020408162}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 3584, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 512, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:53:17.415077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34543040495684885, "overlap_percentage": 0.5134868421052632, "num_intersection": 174832, "num_union": 506128, "num_only_computed": 165648, "num_only_roped": 165648, "total_diff": 331296, "diff_percentage": 0.6545695950431512, "num_computed": 340480, "num_roped": 340480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 512, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:53:19.119765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.14717741935483872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4096, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 512, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:53:42.779604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32775562388853274, "overlap_percentage": 0.4936987168296089, "num_intersection": 180986, "num_union": 552198, "num_only_computed": 185606, "num_only_roped": 185606, "total_diff": 371212, "diff_percentage": 0.6722443761114673, "num_computed": 366592, "num_roped": 366592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 512, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:53:45.264020", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.0960591133004926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 4608, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 512, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:54:11.919303", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3043850366718968, "overlap_percentage": 0.4667104085286458, "num_intersection": 183518, "num_union": 602914, "num_only_computed": 209698, "num_only_roped": 209698, "total_diff": 419396, "diff_percentage": 0.6956149633281031, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 512, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:54:14.177749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.7265625, "l2_diff_relative": 0.11802030456852793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5120, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 512, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:54:42.389189", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2722387996304595, "overlap_percentage": 0.42796808226495725, "num_intersection": 179459, "num_union": 659197, "num_only_computed": 239869, "num_only_roped": 239869, "total_diff": 479738, "diff_percentage": 0.7277612003695405, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 512, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:54:43.345327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.09872159090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 5632, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 512, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:55:14.307770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24606792334601016, "overlap_percentage": 0.3949510596264368, "num_intersection": 175927, "num_union": 714953, "num_only_computed": 269513, "num_only_roped": 269513, "total_diff": 539026, "diff_percentage": 0.7539320766539899, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 512, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:55:15.329985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 4.744529724121094e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.17251461988304093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6144, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 512, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:55:48.182269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23517948073175332, "overlap_percentage": 0.38080211726384366, "num_intersection": 179568, "num_union": 763536, "num_only_computed": 291984, "num_only_roped": 291984, "total_diff": 583968, "diff_percentage": 0.7648205192682467, "num_computed": 471552, "num_roped": 471552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 512, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:55:51.140476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 5.0067901611328125e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.19910179640718562}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 6656, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 512, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:56:26.609641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.228631631961546, "overlap_percentage": 0.3721727912808642, "num_intersection": 185217, "num_union": 810111, "num_only_computed": 312447, "num_only_roped": 312447, "total_diff": 624894, "diff_percentage": 0.771368368038454, "num_computed": 497664, "num_roped": 497664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 512, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:56:27.791229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 4.6253204345703125e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.2152777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7168, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 512, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:57:06.210341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22302312669997806, "overlap_percentage": 0.36470794677734375, "num_intersection": 191212, "num_union": 857364, "num_only_computed": 333076, "num_only_roped": 333076, "total_diff": 666152, "diff_percentage": 0.776976873300022, "num_computed": 524288, "num_roped": 524288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 512, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:57:07.492239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.0, "l2_diff_relative": 0.17486338797814208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 7680, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 512, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:57:48.428997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20929159548932477, "overlap_percentage": 0.34613917151162793, "num_intersection": 190515, "num_union": 910285, "num_only_computed": 359885, "num_only_roped": 359885, "total_diff": 719770, "diff_percentage": 0.7907084045106753, "num_computed": 550400, "num_roped": 550400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 512, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:57:49.783693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.15868263473053892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8192, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 512, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:58:33.583237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19846749029708485, "overlap_percentage": 0.33120212588809944, "num_intersection": 190942, "num_union": 962082, "num_only_computed": 385570, "num_only_roped": 385570, "total_diff": 771140, "diff_percentage": 0.8015325097029151, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 512, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:58:37.363312", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.3645833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 8704, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 512, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:59:24.731890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18789054338012956, "overlap_percentage": 0.3163431924384027, "num_intersection": 190636, "num_union": 1014612, "num_only_computed": 411988, "num_only_roped": 411988, "total_diff": 823976, "diff_percentage": 0.8121094566198704, "num_computed": 602624, "num_roped": 602624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 512, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T20:59:26.300723", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 8.487701416015625e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.6748768472906403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9216, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 512, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:00:16.098698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18172907494161705, "overlap_percentage": 0.3075647012418567, "num_intersection": 193377, "num_union": 1064095, "num_only_computed": 435359, "num_only_roped": 435359, "total_diff": 870718, "diff_percentage": 0.818270925058383, "num_computed": 628736, "num_roped": 628736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 512, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:00:17.766162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 0.00010776519775390625, "l2_diff": 2.828125, "l2_diff_relative": 1.124223602484472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 9728, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 512, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:01:10.001005", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17773488744882812, "overlap_percentage": 0.301824951171875, "num_intersection": 197804, "num_union": 1112916, "num_only_computed": 457556, "num_only_roped": 457556, "total_diff": 915112, "diff_percentage": 0.8222651125511719, "num_computed": 655360, "num_roped": 655360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 512, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:01:11.784031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 0.00010204315185546875, "l2_diff": 3.046875, "l2_diff_relative": 1.0833333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10240, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 512, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:02:08.932602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16922754892213035, "overlap_percentage": 0.28946897304658153, "num_intersection": 197265, "num_union": 1165679, "num_only_computed": 484207, "num_only_roped": 484207, "total_diff": 968414, "diff_percentage": 0.8307724510778697, "num_computed": 681472, "num_roped": 681472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 512, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:02:10.843284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 9.632110595703125e-05, "l2_diff": 2.828125, "l2_diff_relative": 1.052325581395349}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 10752, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 512, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:03:11.723270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15491486472370208, "overlap_percentage": 0.26827062228654125, "num_intersection": 189824, "num_union": 1225344, "num_only_computed": 517760, "num_only_roped": 517760, "total_diff": 1035520, "diff_percentage": 0.8450851352762979, "num_computed": 707584, "num_roped": 707584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 512, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:03:13.658367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 9.441375732421875e-05, "l2_diff": 2.9375, "l2_diff_relative": 1.0502793296089385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11264, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 512, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:04:16.695092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1533634317190035, "overlap_percentage": 0.26594120725750175, "num_intersection": 195120, "num_union": 1272272, "num_only_computed": 538576, "num_only_roped": 538576, "total_diff": 1077152, "diff_percentage": 0.8466365682809965, "num_computed": 733696, "num_roped": 733696}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 512, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:04:20.212251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1962890625, "mean_diff": 0.0001010894775390625, "l2_diff": 3.234375, "l2_diff_relative": 1.3269230769230769}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 11776, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 512, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:05:27.846133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15029790403637072, "overlap_percentage": 0.26131996504380056, "num_intersection": 198553, "num_union": 1321063, "num_only_computed": 561255, "num_only_roped": 561255, "total_diff": 1122510, "diff_percentage": 0.8497020959636293, "num_computed": 759808, "num_roped": 759808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 512, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:05:30.974317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.26171875, "mean_diff": 9.679794311523438e-05, "l2_diff": 3.140625, "l2_diff_relative": 1.2884615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12288, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 512, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:06:41.030635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14811949066679903, "overlap_percentage": 0.2580210367838542, "num_intersection": 202916, "num_union": 1369948, "num_only_computed": 583516, "num_only_roped": 583516, "total_diff": 1167032, "diff_percentage": 0.8518805093332009, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 512, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:06:43.385895", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 9.250640869140625e-05, "l2_diff": 3.15625, "l2_diff_relative": 1.2317073170731707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 12800, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 512, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:07:56.956124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14457567418899758, "overlap_percentage": 0.252627550015753, "num_intersection": 205271, "num_union": 1419817, "num_only_computed": 607273, "num_only_roped": 607273, "total_diff": 1214546, "diff_percentage": 0.8554243258110024, "num_computed": 812544, "num_roped": 812544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 512, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:08:01.045543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.867813110351562e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.8591549295774648}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13312, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 512, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:09:18.800662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14634386379293376, "overlap_percentage": 0.2553228021978022, "num_intersection": 214128, "num_union": 1463184, "num_only_computed": 624528, "num_only_roped": 624528, "total_diff": 1249056, "diff_percentage": 0.8536561362070663, "num_computed": 838656, "num_roped": 838656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 512, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:09:23.474201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.62939453125e-05, "l2_diff": 2.953125, "l2_diff_relative": 0.9086538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 13824, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 512, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:10:45.194869", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.141872473424536, "overlap_percentage": 0.24849092473357015, "num_intersection": 214887, "num_union": 1514649, "num_only_computed": 649881, "num_only_roped": 649881, "total_diff": 1299762, "diff_percentage": 0.858127526575464, "num_computed": 864768, "num_roped": 864768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 512, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:10:49.917397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.8963730569948186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14336, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 512, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:12:12.413576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14005205787279348, "overlap_percentage": 0.24569414511494253, "num_intersection": 218884, "num_union": 1562876, "num_only_computed": 671996, "num_only_roped": 671996, "total_diff": 1343992, "diff_percentage": 0.8599479421272065, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 512, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:12:15.200464", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.793571472167969e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.6213235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 14848, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 512, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:13:41.644677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13697763540663038, "overlap_percentage": 0.24095044817243302, "num_intersection": 221073, "num_union": 1613935, "num_only_computed": 696431, "num_only_roped": 696431, "total_diff": 1392862, "diff_percentage": 0.8630223645933697, "num_computed": 917504, "num_roped": 917504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 512, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:13:46.556533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.6326530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15360, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 512, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:15:17.058627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13441836197382562, "overlap_percentage": 0.23698199267498643, "num_intersection": 223620, "num_union": 1663612, "num_only_computed": 719996, "num_only_roped": 719996, "total_diff": 1439992, "diff_percentage": 0.8655816380261744, "num_computed": 943616, "num_roped": 943616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 512, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:15:20.140089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.6761904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 512, "seq_len_k": 15872, "queries_shape": [1, 32, 512, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 512, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:16:50.510763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13292392817121298, "overlap_percentage": 0.2346564051935619, "num_intersection": 62749, "num_union": 472067, "num_only_computed": 204659, "num_only_roped": 204659, "total_diff": 409318, "diff_percentage": 0.867076071828787, "num_computed": 267408, "num_roped": 267408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 144, "seq_len_k": 16016, "queries_shape": [1, 32, 144, 128], "keys_shape": [1, 8, 16016, 128], "mask_shape": [1, 32, 144, 16016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:16:53.398222", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.4447852760736196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 144, "seq_len_k": 16016, "queries_shape": [1, 32, 144, 128], "keys_shape": [1, 8, 16016, 128], "attention_shape": [1, 32, 144, 16016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:18:15.084684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.130298273155416, "overlap_percentage": 0.23055555555555557, "num_intersection": 10292, "num_union": 78988, "num_only_computed": 34348, "num_only_roped": 34348, "total_diff": 68696, "diff_percentage": 0.869701726844584, "num_computed": 44640, "num_roped": 44640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "mask_shape": [1, 32, 24, 16040], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:18:17.496392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.36328125, "l2_diff_relative": 0.31208053691275167}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "attention_shape": [1, 32, 24, 16040]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:19:25.136809", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13276492082825822, "overlap_percentage": 0.23440860215053763, "num_intersection": 436, "num_union": 3284, "num_only_computed": 1424, "num_only_roped": 1424, "total_diff": 2848, "diff_percentage": 0.8672350791717418, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "mask_shape": [1, 32, 1, 16041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:19:27.030133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07275390625, "mean_diff": 5.364418029785156e-05, "l2_diff": 0.10302734375, "l2_diff_relative": 0.647239263803681}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "attention_shape": [1, 32, 1, 16041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:20:25.501984", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12318840579710146, "overlap_percentage": 0.21935483870967742, "num_intersection": 408, "num_union": 3312, "num_only_computed": 1452, "num_only_roped": 1452, "total_diff": 2904, "diff_percentage": 0.8768115942028986, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "mask_shape": [1, 32, 1, 16042], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:20:28.943766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.130859375, "l2_diff_relative": 0.9436619718309859}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "attention_shape": [1, 32, 1, 16042]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:21:27.394004", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12352763515554213, "overlap_percentage": 0.21989247311827956, "num_intersection": 409, "num_union": 3311, "num_only_computed": 1451, "num_only_roped": 1451, "total_diff": 2902, "diff_percentage": 0.8764723648444579, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "mask_shape": [1, 32, 1, 16043], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-16T21:21:29.301245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.10791015625, "l2_diff_relative": 0.5580808080808081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "attention_shape": [1, 32, 1, 16043]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
