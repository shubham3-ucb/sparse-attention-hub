{"timestamp": "2025-11-12T07:54:42.882157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:42.927871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.0166015625, "l2_diff_relative": 0.0029350828729281767}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:45.060222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8632908669359658, "overlap_percentage": 0.9266302779185294, "num_intersection": 72235, "num_union": 83674, "num_only_computed": 6357, "num_only_roped": 5082, "total_diff": 11439, "diff_percentage": 0.13670913306403423, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:45.197596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 0.00011301040649414062, "l2_diff": 0.1875, "l2_diff_relative": 0.043795620437956206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:50.866986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7375091994439448, "overlap_percentage": 0.8489269578313253, "num_intersection": 72152, "num_union": 97832, "num_only_computed": 12840, "num_only_roped": 12840, "total_diff": 25680, "diff_percentage": 0.2624908005560553, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:51.041392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 0.000244140625, "l2_diff": 0.435546875, "l2_diff_relative": 0.10804263565891473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:56.904186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6669789099375211, "overlap_percentage": 0.8002247730446927, "num_intersection": 73339, "num_union": 109957, "num_only_computed": 18309, "num_only_roped": 18309, "total_diff": 36618, "diff_percentage": 0.333021090062479, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:57.114223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 0.00019741058349609375, "l2_diff": 0.515625, "l2_diff_relative": 0.11301369863013698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:03.939152", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6019163550145438, "overlap_percentage": 0.751495361328125, "num_intersection": 73875, "num_union": 122733, "num_only_computed": 24429, "num_only_roped": 24429, "total_diff": 48858, "diff_percentage": 0.39808364498545623, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:04.168828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 6.914138793945312e-05, "l2_diff": 0.265625, "l2_diff_relative": 0.05555555555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:12.099274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.546770667139396, "overlap_percentage": 0.7069834963325183, "num_intersection": 74024, "num_union": 135384, "num_only_computed": 30680, "num_only_roped": 30680, "total_diff": 61360, "diff_percentage": 0.4532293328606039, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:12.376712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.205078125, "l2_diff_relative": 0.04179936305732484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:21.878596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5280017014386762, "overlap_percentage": 0.691100933908046, "num_intersection": 76961, "num_union": 145759, "num_only_computed": 34399, "num_only_roped": 34399, "total_diff": 68798, "diff_percentage": 0.4719982985613238, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:22.191119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 9.059906005859375e-05, "l2_diff": 0.380859375, "l2_diff_relative": 0.09948979591836735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:32.210753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48409537732520036, "overlap_percentage": 0.6523777173913043, "num_intersection": 76824, "num_union": 158696, "num_only_computed": 40936, "num_only_roped": 40936, "total_diff": 81872, "diff_percentage": 0.5159046226747996, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:32.543201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 9.107589721679688e-05, "l2_diff": 0.46484375, "l2_diff_relative": 0.11805555555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:43.704492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45360228527365454, "overlap_percentage": 0.6241078317901234, "num_intersection": 77649, "num_union": 171183, "num_only_computed": 46767, "num_only_roped": 46767, "total_diff": 93534, "diff_percentage": 0.5463977147263455, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:45.549621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 9.012222290039062e-05, "l2_diff": 0.4921875, "l2_diff_relative": 0.11580882352941177}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:57.777721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4302300205141635, "overlap_percentage": 0.60162353515625, "num_intersection": 78856, "num_union": 183288, "num_only_computed": 52216, "num_only_roped": 52216, "total_diff": 104432, "diff_percentage": 0.5697699794858365, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:59.415770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.00010967254638671875, "l2_diff": 0.60546875, "l2_diff_relative": 0.15255905511811024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:12.745289", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4143064371765723, "overlap_percentage": 0.5858793063314711, "num_intersection": 80542, "num_union": 194402, "num_only_computed": 56930, "num_only_roped": 56930, "total_diff": 113860, "diff_percentage": 0.5856935628234278, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:13.193547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 0.0001316070556640625, "l2_diff": 0.796875, "l2_diff_relative": 0.21888412017167383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:27.775630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3902374326598921, "overlap_percentage": 0.5613968139431617, "num_intersection": 80913, "num_union": 207343, "num_only_computed": 63215, "num_only_roped": 63215, "total_diff": 126430, "diff_percentage": 0.6097625673401079, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:28.263092", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 0.00011682510375976562, "l2_diff": 0.75390625, "l2_diff_relative": 0.22235023041474655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:43.876392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3744338933528123, "overlap_percentage": 0.5448554421768708, "num_intersection": 82016, "num_union": 219040, "num_only_computed": 68512, "num_only_roped": 68512, "total_diff": 137024, "diff_percentage": 0.6255661066471877, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:44.408311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 8.0108642578125e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.15951492537313433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:01.939928", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36783434640537094, "overlap_percentage": 0.5378346396579805, "num_intersection": 84539, "num_union": 229829, "num_only_computed": 72645, "num_only_roped": 72645, "total_diff": 145290, "diff_percentage": 0.6321656535946291, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:02.537291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 7.772445678710938e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.15338645418326693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:21.142903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3577019171407381, "overlap_percentage": 0.526922607421875, "num_intersection": 86331, "num_union": 241349, "num_only_computed": 77509, "num_only_roped": 77509, "total_diff": 155018, "diff_percentage": 0.6422980828592619, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:23.026584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.09815436241610738}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:42.792090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33194067919273, "overlap_percentage": 0.49843162593984963, "num_intersection": 84853, "num_union": 255627, "num_only_computed": 85387, "num_only_roped": 85387, "total_diff": 170774, "diff_percentage": 0.6680593208072699, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:43.466780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.0871975806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:04.427031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3237696483961371, "overlap_percentage": 0.48916312409551377, "num_intersection": 86531, "num_union": 267261, "num_only_computed": 90365, "num_only_roped": 90365, "total_diff": 180730, "diff_percentage": 0.6762303516038629, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:05.194732", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.15082644628099173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:27.894395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3030258869193393, "overlap_percentage": 0.4651110771648045, "num_intersection": 85253, "num_union": 281339, "num_only_computed": 98043, "num_only_roped": 98043, "total_diff": 196086, "diff_percentage": 0.6969741130806607, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:28.630069", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.1589958158995816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:51.583857", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2917906362316426, "overlap_percentage": 0.4517614976415094, "num_intersection": 85813, "num_union": 294091, "num_only_computed": 104139, "num_only_roped": 104139, "total_diff": 208278, "diff_percentage": 0.7082093637683574, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:52.366951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 8.0108642578125e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.24261083743842365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:59:16.539955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2773513255391652, "overlap_percentage": 0.4342600504557292, "num_intersection": 85379, "num_union": 307837, "num_only_computed": 111229, "num_only_roped": 111229, "total_diff": 222458, "diff_percentage": 0.7226486744608348, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:59:17.354137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 7.915496826171875e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.2550251256281407}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:59:42.646928", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2740714707100629, "overlap_percentage": 0.4302293505674653, "num_intersection": 87340, "num_union": 318676, "num_only_computed": 115668, "num_only_roped": 115668, "total_diff": 231336, "diff_percentage": 0.7259285292899371, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:59:43.503999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.2845744680851064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:00:10.572039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26698593506866286, "overlap_percentage": 0.4214505112942613, "num_intersection": 88363, "num_union": 330965, "num_only_computed": 121301, "num_only_roped": 121301, "total_diff": 242602, "diff_percentage": 0.7330140649313371, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:00:11.484907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.890625, "l2_diff_relative": 0.2688679245283019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:00:40.239583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26080042947881926, "overlap_percentage": 0.4137061241113744, "num_intersection": 89387, "num_union": 342741, "num_only_computed": 126677, "num_only_roped": 126677, "total_diff": 253354, "diff_percentage": 0.7391995705211807, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:00:41.170854", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.396484375, "l2_diff_relative": 0.08081210191082802}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:01:10.978049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2534118216454407, "overlap_percentage": 0.40435524425287356, "num_intersection": 90058, "num_union": 355382, "num_only_computed": 132662, "num_only_roped": 132662, "total_diff": 265324, "diff_percentage": 0.7465881783545594, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:01:11.968552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.31640625, "l2_diff_relative": 0.07729007633587787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:01:42.729990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2515571075856989, "overlap_percentage": 0.40199061802455355, "num_intersection": 92207, "num_union": 366545, "num_only_computed": 137169, "num_only_roped": 137169, "total_diff": 274338, "diff_percentage": 0.7484428924143011, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:01:45.031708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.14107883817427386}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:02:17.759976", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2509935215497344, "overlap_percentage": 0.4012706976112921, "num_intersection": 94610, "num_union": 376942, "num_only_computed": 141166, "num_only_roped": 141166, "total_diff": 282332, "diff_percentage": 0.7490064784502656, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:02:18.827750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.1858108108108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:02:52.031557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24364281793605114, "overlap_percentage": 0.3918212117212249, "num_intersection": 94990, "num_union": 389874, "num_only_computed": 147442, "num_only_roped": 147442, "total_diff": 294884, "diff_percentage": 0.7563571820639489, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:02:54.376643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.09675141242937853}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:03:30.102001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2438024068080427, "overlap_percentage": 0.39202755272633744, "num_intersection": 97549, "num_union": 400115, "num_only_computed": 151283, "num_only_roped": 151283, "total_diff": 302566, "diff_percentage": 0.7561975931919573, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:03:31.246175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.09435483870967742}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:04:08.079874", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23074255076750397, "overlap_percentage": 0.37496477329659317, "num_intersection": 95799, "num_union": 415177, "num_only_computed": 159689, "num_only_roped": 159689, "total_diff": 319378, "diff_percentage": 0.7692574492324961, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:04:09.269622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.40625, "l2_diff_relative": 0.10655737704918032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:04:46.317192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22461144616304546, "overlap_percentage": 0.36682891845703125, "num_intersection": 96162, "num_union": 428126, "num_only_computed": 165982, "num_only_roped": 165982, "total_diff": 331964, "diff_percentage": 0.7753885538369545, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:04:47.731074", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.039836883544922e-05, "l2_diff": 0.484375, "l2_diff_relative": 0.1415525114155251}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:05:26.657982", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22389229689451184, "overlap_percentage": 0.3658692802669209, "num_intersection": 98252, "num_union": 438836, "num_only_computed": 170292, "num_only_roped": 170292, "total_diff": 340584, "diff_percentage": 0.7761077031054882, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:05:29.966543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.56640625, "l2_diff_relative": 0.17018779342723006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:10.174991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21766678760740865, "overlap_percentage": 0.3575145348837209, "num_intersection": 98388, "num_union": 452012, "num_only_computed": 176812, "num_only_roped": 176812, "total_diff": 353624, "diff_percentage": 0.7823332123925913, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:11.530685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.2204433497536946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:53.231626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21285470939510162, "overlap_percentage": 0.35099786931818183, "num_intersection": 98841, "num_union": 464359, "num_only_computed": 182759, "num_only_roped": 182759, "total_diff": 365518, "diff_percentage": 0.7871452906048984, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:54.626587", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.21058091286307054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:07:37.852661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20372991911270352, "overlap_percentage": 0.33849772424511543, "num_intersection": 97574, "num_union": 478938, "num_only_computed": 190682, "num_only_roped": 190682, "total_diff": 381364, "diff_percentage": 0.7962700808872964, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:07:39.308219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06982421875, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.27314814814814814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:08:23.681596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19251523943348733, "overlap_percentage": 0.3228725857204861, "num_intersection": 95219, "num_union": 494605, "num_only_computed": 199693, "num_only_roped": 199693, "total_diff": 399386, "diff_percentage": 0.8074847605665126, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:08:25.153125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 5.984306335449219e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.3767772511848341}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:09:12.580131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18481701538667222, "overlap_percentage": 0.31197562659303313, "num_intersection": 94002, "num_union": 508622, "num_only_computed": 207310, "num_only_roped": 207310, "total_diff": 414620, "diff_percentage": 0.8151829846133277, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:09:14.100725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.5234375, "l2_diff_relative": 0.5416666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:10:01.818340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17927853585781325, "overlap_percentage": 0.3040478231504572, "num_intersection": 93637, "num_union": 522299, "num_only_computed": 214331, "num_only_roped": 214331, "total_diff": 428662, "diff_percentage": 0.8207214641421867, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:10:03.392436", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 9.72747802734375e-05, "l2_diff": 1.8984375, "l2_diff_relative": 0.8678571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:10:53.628608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17555684773605615, "overlap_percentage": 0.2986786186889251, "num_intersection": 93895, "num_union": 534841, "num_only_computed": 220473, "num_only_roped": 220473, "total_diff": 440946, "diff_percentage": 0.8244431522639438, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:10:55.201975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 0.00010156631469726562, "l2_diff": 2.09375, "l2_diff_relative": 1.0}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:11:45.000902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1680395866686072, "overlap_percentage": 0.2877292663476874, "num_intersection": 92368, "num_union": 549680, "num_only_computed": 228656, "num_only_roped": 228656, "total_diff": 457312, "diff_percentage": 0.8319604133313928, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:11:46.657494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 0.00010156631469726562, "l2_diff": 2.125, "l2_diff_relative": 0.9927007299270073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:12:38.563758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16612307139336546, "overlap_percentage": 0.2849151611328125, "num_intersection": 93361, "num_union": 561999, "num_only_computed": 234319, "num_only_roped": 234319, "total_diff": 468638, "diff_percentage": 0.8338769286066345, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:12:40.410717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 9.775161743164062e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.9185185185185185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:13:33.847856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15948266138198755, "overlap_percentage": 0.27509279214559385, "num_intersection": 91903, "num_union": 576257, "num_only_computed": 242177, "num_only_roped": 242177, "total_diff": 484354, "diff_percentage": 0.8405173386180125, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:13:35.654940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.5567010309278351}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:14:30.495627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16135783049784505, "overlap_percentage": 0.27787788786626594, "num_intersection": 94683, "num_union": 586789, "num_only_computed": 246053, "num_only_roped": 246053, "total_diff": 492106, "diff_percentage": 0.838642169502155, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:14:32.267225", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.4767932489451477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:15:28.560611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15832852275874496, "overlap_percentage": 0.2733741242625369, "num_intersection": 94898, "num_union": 599374, "num_only_computed": 252238, "num_only_roped": 252238, "total_diff": 504476, "diff_percentage": 0.841671477241255, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:15:30.437396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 5.245208740234375e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.40476190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:16:27.216921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15174539926231936, "overlap_percentage": 0.2635051103473227, "num_intersection": 93226, "num_union": 614358, "num_only_computed": 260566, "num_only_roped": 260566, "total_diff": 521132, "diff_percentage": 0.8482546007376807, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:16:29.061398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.5294117647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:17:24.559824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15140415919547198, "overlap_percentage": 0.262990467745511, "num_intersection": 23727, "num_union": 156713, "num_only_computed": 66493, "num_only_roped": 66493, "total_diff": 132986, "diff_percentage": 0.848595840804528, "num_computed": 90220, "num_roped": 90220}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:17:26.261095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.33043478260869563}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:18:17.745710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15118375550498034, "overlap_percentage": 0.2626579028448187, "num_intersection": 10230, "num_union": 67666, "num_only_computed": 28718, "num_only_roped": 28718, "total_diff": 57436, "diff_percentage": 0.8488162444950197, "num_computed": 38948, "num_roped": 38948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:18:19.334271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.345703125, "l2_diff_relative": 0.29304635761589404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:19:04.452829", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1373671300081766, "overlap_percentage": 0.2415528396836808, "num_intersection": 336, "num_union": 2446, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.8626328699918234, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:19:08.273907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.028564453125, "l2_diff_relative": 0.10299295774647887}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:19:47.700911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14016393442622951, "overlap_percentage": 0.24586628324946083, "num_intersection": 342, "num_union": 2440, "num_only_computed": 1049, "num_only_roped": 1049, "total_diff": 2098, "diff_percentage": 0.8598360655737705, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:19:50.400268", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.05712890625, "l2_diff_relative": 0.2543478260869565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:20:29.912297", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14804123711340206, "overlap_percentage": 0.2579022988505747, "num_intersection": 359, "num_union": 2425, "num_only_computed": 1033, "num_only_roped": 1033, "total_diff": 2066, "diff_percentage": 0.8519587628865979, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:20:32.488069", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.078125, "l2_diff_relative": 0.2777777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:21:12.135993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1423881821912187, "overlap_percentage": 0.2492816091954023, "num_intersection": 347, "num_union": 2437, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8576118178087813, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:21:14.027422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.0673828125, "l2_diff_relative": 0.4825174825174825}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:21:53.467437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14520773344302756, "overlap_percentage": 0.2535919540229885, "num_intersection": 353, "num_union": 2431, "num_only_computed": 1039, "num_only_roped": 1039, "total_diff": 2078, "diff_percentage": 0.8547922665569725, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "mask_shape": [1, 32, 1, 11362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:21:56.041625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.0283203125, "l2_diff_relative": 0.12446351931330472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "attention_shape": [1, 32, 1, 11362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:22.890988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:22.905401", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1026859283447266e-05, "l2_diff": 0.017822265625, "l2_diff_relative": 0.003017526455026455}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:24.963555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8634690316257501, "overlap_percentage": 0.926732901885074, "num_intersection": 72243, "num_union": 83666, "num_only_computed": 6349, "num_only_roped": 5074, "total_diff": 11423, "diff_percentage": 0.13653096837425, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:25.097854", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 0.00010776519775390625, "l2_diff": 0.18359375, "l2_diff_relative": 0.04288321167883212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:29.775856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.731332946293071, "overlap_percentage": 0.8448206890060241, "num_intersection": 71803, "num_union": 98181, "num_only_computed": 13189, "num_only_roped": 13189, "total_diff": 26378, "diff_percentage": 0.26866705370692906, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:29.949097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 0.00023746490478515625, "l2_diff": 0.43359375, "l2_diff_relative": 0.11280487804878049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:35.675287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6557904245709124, "overlap_percentage": 0.7921176675977654, "num_intersection": 72596, "num_union": 110700, "num_only_computed": 19052, "num_only_roped": 19052, "total_diff": 38104, "diff_percentage": 0.34420957542908764, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:36.497831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 0.000217437744140625, "l2_diff": 0.482421875, "l2_diff_relative": 0.13251072961373392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:43.293121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.601042345276873, "overlap_percentage": 0.7508138020833334, "num_intersection": 73808, "num_union": 122800, "num_only_computed": 24496, "num_only_roped": 24496, "total_diff": 48992, "diff_percentage": 0.39895765472312705, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:43.532413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.00016117095947265625, "l2_diff": 0.51953125, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:51.799404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5529879414425772, "overlap_percentage": 0.7121599938875306, "num_intersection": 74566, "num_union": 134842, "num_only_computed": 30138, "num_only_roped": 30138, "total_diff": 60276, "diff_percentage": 0.44701205855742276, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:52.092399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 0.00010251998901367188, "l2_diff": 0.439453125, "l2_diff_relative": 0.10264598540145986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:01.049635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5138456519079404, "overlap_percentage": 0.6788613505747126, "num_intersection": 75598, "num_union": 147122, "num_only_computed": 35762, "num_only_roped": 35762, "total_diff": 71524, "diff_percentage": 0.48615434809205965, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:03.891395", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 4.9591064453125e-05, "l2_diff": 0.30078125, "l2_diff_relative": 0.058333333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:13.903689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4790253705099221, "overlap_percentage": 0.6477581521739131, "num_intersection": 76280, "num_union": 159240, "num_only_computed": 41480, "num_only_roped": 41480, "total_diff": 82960, "diff_percentage": 0.5209746294900779, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:14.248489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 5.6743621826171875e-05, "l2_diff": 0.37109375, "l2_diff_relative": 0.07515822784810126}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:25.260411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4498164656528579, "overlap_percentage": 0.6205150462962963, "num_intersection": 77202, "num_union": 171630, "num_only_computed": 47214, "num_only_roped": 47214, "total_diff": 94428, "diff_percentage": 0.5501835343471421, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:25.631181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.390625, "l2_diff_relative": 0.08333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:37.634465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4201342427312274, "overlap_percentage": 0.5916824340820312, "num_intersection": 77553, "num_union": 184591, "num_only_computed": 53519, "num_only_roped": 53519, "total_diff": 107038, "diff_percentage": 0.5798657572687725, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:38.048258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 5.7697296142578125e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.08346774193548387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:51.887713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3943029854303695, "overlap_percentage": 0.5655915386405959, "num_intersection": 77753, "num_union": 197191, "num_only_computed": 59719, "num_only_roped": 59719, "total_diff": 119438, "diff_percentage": 0.6056970145696304, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:52.340685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.416015625, "l2_diff_relative": 0.09441489361702128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:06.684391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36881493722339354, "overlap_percentage": 0.5388821047957372, "num_intersection": 77668, "num_union": 210588, "num_only_computed": 66460, "num_only_roped": 66460, "total_diff": 132920, "diff_percentage": 0.6311850627766065, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:07.180578", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 6.866455078125e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:22.780392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3569393862907006, "overlap_percentage": 0.52609481292517, "num_intersection": 79192, "num_union": 221864, "num_only_computed": 71336, "num_only_roped": 71336, "total_diff": 142672, "diff_percentage": 0.6430606137092993, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:23.316734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.14324817518248176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:40.057125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3413091895858756, "overlap_percentage": 0.5089194828990228, "num_intersection": 79994, "num_union": 234374, "num_only_computed": 77190, "num_only_roped": 77190, "total_diff": 154380, "diff_percentage": 0.6586908104141245, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:41.043327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 8.249282836914062e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.16324626865671643}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:59.068931", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32640339372743316, "overlap_percentage": 0.4921630859375, "num_intersection": 80636, "num_union": 247044, "num_only_computed": 83204, "num_only_roped": 83204, "total_diff": 166408, "diff_percentage": 0.6735966062725668, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:24:59.708040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 9.059906005859375e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.19176706827309237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:25:19.554080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3200020159805225, "overlap_percentage": 0.48485079887218047, "num_intersection": 82541, "num_union": 257939, "num_only_computed": 87699, "num_only_roped": 87699, "total_diff": 175398, "diff_percentage": 0.6799979840194774, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:25:22.629563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.734375, "l2_diff_relative": 0.18951612903225806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:25:43.718288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31110798170781423, "overlap_percentage": 0.47457263024602026, "num_intersection": 83950, "num_union": 269842, "num_only_computed": 92946, "num_only_roped": 92946, "total_diff": 185892, "diff_percentage": 0.6888920182921858, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:25:44.422446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.20777777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:26:06.487021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30420335485707173, "overlap_percentage": 0.46649681389664804, "num_intersection": 85507, "num_union": 281085, "num_only_computed": 97789, "num_only_roped": 97789, "total_diff": 195578, "diff_percentage": 0.6957966451429283, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:26:07.205812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.62890625, "l2_diff_relative": 0.16563786008230452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:26:30.550808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29920352378314236, "overlap_percentage": 0.4605953082884097, "num_intersection": 87491, "num_union": 292413, "num_only_computed": 102461, "num_only_roped": 102461, "total_diff": 204922, "diff_percentage": 0.7007964762168577, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:26:32.548431", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.17828685258964144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:26:57.753229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2916042569964525, "overlap_percentage": 0.4515380859375, "num_intersection": 88776, "num_union": 304440, "num_only_computed": 107832, "num_only_roped": 107832, "total_diff": 215664, "diff_percentage": 0.7083957430035475, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:00.359071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 6.961822509765625e-05, "l2_diff": 0.75, "l2_diff_relative": 0.20425531914893616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:26.518174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2849949520044815, "overlap_percentage": 0.4435736522698613, "num_intersection": 90049, "num_union": 315967, "num_only_computed": 112959, "num_only_roped": 112959, "total_diff": 225918, "diff_percentage": 0.7150050479955186, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:28.152248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 5.4836273193359375e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:55.354357", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27245692506569724, "overlap_percentage": 0.42823756105006106, "num_intersection": 89786, "num_union": 329542, "num_only_computed": 119878, "num_only_roped": 119878, "total_diff": 239756, "diff_percentage": 0.7275430749343028, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:56.254110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.9114227294921875e-05, "l2_diff": 0.63671875, "l2_diff_relative": 0.16769547325102882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:24.749308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26084825284190377, "overlap_percentage": 0.4137662914691943, "num_intersection": 89400, "num_union": 342728, "num_only_computed": 126664, "num_only_roped": 126664, "total_diff": 253328, "diff_percentage": 0.7391517471580962, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:25.707265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.2056451612903226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:55.804395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2597498826337551, "overlap_percentage": 0.41238326149425286, "num_intersection": 91846, "num_union": 353594, "num_only_computed": 130874, "num_only_roped": 130874, "total_diff": 261748, "diff_percentage": 0.7402501173662449, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:56.814273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 6.4849853515625e-05, "l2_diff": 0.84765625, "l2_diff_relative": 0.23283261802575106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:29:27.870790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2496002658538512, "overlap_percentage": 0.39948817661830355, "num_intersection": 91633, "num_union": 367119, "num_only_computed": 137743, "num_only_roped": 137743, "total_diff": 275486, "diff_percentage": 0.7503997341461488, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:29:28.899208", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.19215686274509805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:30:01.310287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24544926311341186, "overlap_percentage": 0.394153773072747, "num_intersection": 92932, "num_union": 378620, "num_only_computed": 142844, "num_only_roped": 142844, "total_diff": 285688, "diff_percentage": 0.7545507368865881, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:30:02.376922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.0067901611328125e-05, "l2_diff": 0.73828125, "l2_diff_relative": 0.20192307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:30:37.040552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23311054821415855, "overlap_percentage": 0.37808540126715945, "num_intersection": 91660, "num_union": 393204, "num_only_computed": 150772, "num_only_roped": 150772, "total_diff": 301544, "diff_percentage": 0.7668894517858414, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:30:38.174679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.20319148936170212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:31:14.717358", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2283056448886004, "overlap_percentage": 0.3717407728909465, "num_intersection": 92501, "num_union": 405163, "num_only_computed": 156331, "num_only_roped": 156331, "total_diff": 312662, "diff_percentage": 0.7716943551113996, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:31:15.871215", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.095703125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.2015810276679842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:31:52.615675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2198508417604874, "overlap_percentage": 0.36045528557114226, "num_intersection": 92092, "num_union": 418884, "num_only_computed": 163396, "num_only_roped": 163396, "total_diff": 326792, "diff_percentage": 0.7801491582395126, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:31:53.846446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.7890625, "l2_diff_relative": 0.2148936170212766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:32:31.708952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2193453107738822, "overlap_percentage": 0.3597755432128906, "num_intersection": 94313, "num_union": 429975, "num_only_computed": 167831, "num_only_roped": 167831, "total_diff": 335662, "diff_percentage": 0.7806546892261178, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:32:33.160152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.15345528455284552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:33:12.601546", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21066108846972265, "overlap_percentage": 0.34801000953288846, "num_intersection": 93456, "num_union": 443632, "num_only_computed": 175088, "num_only_roped": 175088, "total_diff": 350176, "diff_percentage": 0.7893389115302774, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:33:14.825488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.16765873015873015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:33:55.194465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21213989821019968, "overlap_percentage": 0.35002543604651165, "num_intersection": 96327, "num_union": 454073, "num_only_computed": 178873, "num_only_roped": 178873, "total_diff": 357746, "diff_percentage": 0.7878601017898004, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:33:56.696814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.1453900709219858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:34:38.533865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20683817825719883, "overlap_percentage": 0.34277698863636363, "num_intersection": 96526, "num_union": 466674, "num_only_computed": 185074, "num_only_roped": 185074, "total_diff": 370148, "diff_percentage": 0.7931618217428011, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:34:39.948771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.17857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:35:24.073104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19964708428359773, "overlap_percentage": 0.33284302841918295, "num_intersection": 95944, "num_union": 480568, "num_only_computed": 192312, "num_only_roped": 192312, "total_diff": 384624, "diff_percentage": 0.8003529157164022, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:35:25.485240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 5.936622619628906e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.34146341463414637}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:36:10.811678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19409898592769698, "overlap_percentage": 0.3250969780815972, "num_intersection": 95875, "num_union": 493949, "num_only_computed": 199037, "num_only_roped": 199037, "total_diff": 398074, "diff_percentage": 0.805901014072303, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:36:13.959018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.37745098039215685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:37:03.171685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18661342280821971, "overlap_percentage": 0.31453111724723876, "num_intersection": 94772, "num_union": 507852, "num_only_computed": 206540, "num_only_roped": 206540, "total_diff": 413080, "diff_percentage": 0.8133865771917803, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:37:04.775638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.3861607142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:37:55.108881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17324271504382974, "overlap_percentage": 0.29532289068994183, "num_intersection": 90950, "num_union": 524986, "num_only_computed": 217018, "num_only_roped": 217018, "total_diff": 434036, "diff_percentage": 0.8267572849561703, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:37:56.714570", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.4696969696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:38:47.825789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1715788669485351, "overlap_percentage": 0.2929019493078176, "num_intersection": 92079, "num_union": 536657, "num_only_computed": 222289, "num_only_roped": 222289, "total_diff": 444578, "diff_percentage": 0.8284211330514649, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:38:49.509901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 8.20159912109375e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.6627906976744186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:39:42.439107", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16901787990240705, "overlap_percentage": 0.28916218102073366, "num_intersection": 92828, "num_union": 549220, "num_only_computed": 228196, "num_only_roped": 228196, "total_diff": 456392, "diff_percentage": 0.830982120097593, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:39:44.165583", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.75, "l2_diff_relative": 0.5957446808510638}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:40:38.172075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16121990460192923, "overlap_percentage": 0.27767333984375, "num_intersection": 90988, "num_union": 564372, "num_only_computed": 236692, "num_only_roped": 236692, "total_diff": 473384, "diff_percentage": 0.8387800953980707, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:40:39.926915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.47468354430379744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:41:35.014952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16468299621394356, "overlap_percentage": 0.28279454022988504, "num_intersection": 94476, "num_union": 573684, "num_only_computed": 239604, "num_only_roped": 239604, "total_diff": 479208, "diff_percentage": 0.8353170037860564, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:41:36.836095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.5, "l2_diff_relative": 0.5274725274725275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:42:32.518514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15957338197559265, "overlap_percentage": 0.2752277422990233, "num_intersection": 93780, "num_union": 587692, "num_only_computed": 246956, "num_only_roped": 246956, "total_diff": 493912, "diff_percentage": 0.8404266180244073, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:42:34.383272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.866455078125e-05, "l2_diff": 1.6015625, "l2_diff_relative": 0.5394736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:43:31.349538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17377191084180912, "overlap_percentage": 0.29609144542772864, "num_intersection": 102784, "num_union": 591488, "num_only_computed": 244352, "num_only_roped": 244352, "total_diff": 488704, "diff_percentage": 0.8262280891581909, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:43:33.197395", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 8.58306884765625e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.8581560283687943}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:44:33.186063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16853472406862738, "overlap_percentage": 0.28845479829956583, "num_intersection": 102053, "num_union": 605531, "num_only_computed": 251739, "num_only_roped": 251739, "total_diff": 503478, "diff_percentage": 0.8314652759313726, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:44:35.083043", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 7.915496826171875e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.7610294117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:45:33.997792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15882538274081648, "overlap_percentage": 0.2741144353693182, "num_intersection": 98804, "num_union": 622092, "num_only_computed": 261644, "num_only_roped": 261644, "total_diff": 523288, "diff_percentage": 0.8411746172591835, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:45:35.887784", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.7215686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:46:37.274192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15086319131381387, "overlap_percentage": 0.26217397941381715, "num_intersection": 96178, "num_union": 637518, "num_only_computed": 270670, "num_only_roped": 270670, "total_diff": 541340, "diff_percentage": 0.8491368086861861, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:46:40.939184", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.6242038216560509}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:43.454169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14790444374099126, "overlap_percentage": 0.2576946967100754, "num_intersection": 96250, "num_union": 650758, "num_only_computed": 277254, "num_only_roped": 277254, "total_diff": 554508, "diff_percentage": 0.8520955562590087, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:45.504640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.6328125, "l2_diff_relative": 0.6005747126436781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:48:49.641224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1460306399332721, "overlap_percentage": 0.25484596108490565, "num_intersection": 96817, "num_union": 662991, "num_only_computed": 283087, "num_only_roped": 283087, "total_diff": 566174, "diff_percentage": 0.8539693600667279, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:48:51.708060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.45161290322580644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:49:57.316481", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14326105633938196, "overlap_percentage": 0.2506182740066225, "num_intersection": 96879, "num_union": 676241, "num_only_computed": 289681, "num_only_roped": 289681, "total_diff": 579362, "diff_percentage": 0.856738943660618, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:49:59.450592", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.4879807692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:51:07.231381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14160956915573103, "overlap_percentage": 0.24808756510416666, "num_intersection": 97552, "num_union": 688880, "num_only_computed": 295664, "num_only_roped": 295664, "total_diff": 591328, "diff_percentage": 0.8583904308442689, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:51:09.413814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.48737373737373735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:52:19.298822", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1442937933996707, "overlap_percentage": 0.2521971092248559, "num_intersection": 100782, "num_union": 698450, "num_only_computed": 298834, "num_only_roped": 298834, "total_diff": 597668, "diff_percentage": 0.8557062066003293, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:52:21.547931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.84375, "l2_diff_relative": 0.6483516483516484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:53:33.555485", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13877758670708581, "overlap_percentage": 0.24373080103969755, "num_intersection": 99021, "num_union": 713523, "num_only_computed": 307251, "num_only_roped": 307251, "total_diff": 614502, "diff_percentage": 0.8612224132929142, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:53:36.840970", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.578125, "l2_diff_relative": 0.6392405063291139}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:54:49.387482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1399574317035744, "overlap_percentage": 0.24554852279776676, "num_intersection": 101331, "num_union": 724013, "num_only_computed": 311341, "num_only_roped": 311341, "total_diff": 622682, "diff_percentage": 0.8600425682964257, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:54:51.775129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.6758620689655173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:56:05.071562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1423434320319715, "overlap_percentage": 0.24921302655677655, "num_intersection": 104502, "num_union": 734154, "num_only_computed": 314826, "num_only_roped": 314826, "total_diff": 629652, "diff_percentage": 0.8576565679680285, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:56:09.823600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.7730496453900709}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:57:24.801803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1412114709455667, "overlap_percentage": 0.24747643103966346, "num_intersection": 105421, "num_union": 746547, "num_only_computed": 320563, "num_only_roped": 320563, "total_diff": 641126, "diff_percentage": 0.8587885290544333, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:57:27.275093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.8384615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:58:44.131180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14114543676688127, "overlap_percentage": 0.24737501850207222, "num_intersection": 106961, "num_union": 757807, "num_only_computed": 325423, "num_only_roped": 325423, "total_diff": 650846, "diff_percentage": 0.8588545632331187, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:58:46.658521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12353515625, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.8838174273858921}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:00:04.431012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1380092872796928, "overlap_percentage": 0.24254509839650146, "num_intersection": 106487, "num_union": 771593, "num_only_computed": 332553, "num_only_roped": 332553, "total_diff": 665106, "diff_percentage": 0.8619907127203073, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:00:06.975501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 7.43865966796875e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.9051724137931034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:01:25.671766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13569784073612312, "overlap_percentage": 0.23896821120689654, "num_intersection": 106446, "num_union": 784434, "num_only_computed": 338994, "num_only_roped": 338994, "total_diff": 677988, "diff_percentage": 0.8643021592638769, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:01:28.296747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.62939453125e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.9565217391304348}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:02:49.333772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13641499497896697, "overlap_percentage": 0.24007954062853906, "num_intersection": 108539, "num_union": 795653, "num_only_computed": 343557, "num_only_roped": 343557, "total_diff": 687114, "diff_percentage": 0.8635850050210331, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:02:52.012350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.7692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:04:14.467056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13331002903978487, "overlap_percentage": 0.23525782993861608, "num_intersection": 107925, "num_union": 809579, "num_only_computed": 350827, "num_only_roped": 350827, "total_diff": 701654, "diff_percentage": 0.8666899709602152, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:04:17.215194", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.866455078125e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.8345864661654135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:40.712336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1320748288144235, "overlap_percentage": 0.2333323300770501, "num_intersection": 108535, "num_union": 821769, "num_only_computed": 356617, "num_only_roped": 356617, "total_diff": 713234, "diff_percentage": 0.8679251711855764, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:43.396017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 6.4849853515625e-05, "l2_diff": 1.9296875, "l2_diff_relative": 0.8344594594594594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:07:09.714039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12803237240216853, "overlap_percentage": 0.22700123779164405, "num_intersection": 107101, "num_union": 836515, "num_only_computed": 364707, "num_only_roped": 364707, "total_diff": 729414, "diff_percentage": 0.8719676275978315, "num_computed": 471808, "num_roped": 471808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 256, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:07:14.183329", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.7435064935064936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 256, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:08:41.855266", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13168048901410317, "overlap_percentage": 0.23271672577623126, "num_intersection": 111287, "num_union": 845129, "num_only_computed": 366921, "num_only_roped": 366921, "total_diff": 733842, "diff_percentage": 0.8683195109858969, "num_computed": 478208, "num_roped": 478208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "mask_shape": [1, 32, 256, 16128], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:08:44.753199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 6.580352783203125e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.9347826086956522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "attention_shape": [1, 32, 256, 16128]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:10:11.905678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1301687819044054, "overlap_percentage": 0.23035281807211633, "num_intersection": 54595, "num_union": 419417, "num_only_computed": 182411, "num_only_roped": 182411, "total_diff": 364822, "diff_percentage": 0.8698312180955946, "num_computed": 237006, "num_roped": 237006}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 126, "seq_len_k": 16254, "queries_shape": [1, 32, 126, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 126, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:10:14.686504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.103515625e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.6666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 126, "seq_len_k": 16254, "queries_shape": [1, 32, 126, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 126, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:11:37.944934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12508532325323943, "overlap_percentage": 0.22235704380455176, "num_intersection": 21807, "num_union": 174337, "num_only_computed": 76265, "num_only_roped": 76265, "total_diff": 152530, "diff_percentage": 0.8749146767467606, "num_computed": 98072, "num_roped": 98072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:11:40.554877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.494140625, "l2_diff_relative": 0.39285714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:12:51.597374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13546056592414207, "overlap_percentage": 0.23860021208907742, "num_intersection": 450, "num_union": 3322, "num_only_computed": 1436, "num_only_roped": 1436, "total_diff": 2872, "diff_percentage": 0.8645394340758579, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:12:53.508783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033935546875, "mean_diff": 5.6743621826171875e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.6239316239316239}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:13:52.195811", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14372346876895087, "overlap_percentage": 0.2513255567338282, "num_intersection": 474, "num_union": 3298, "num_only_computed": 1412, "num_only_roped": 1412, "total_diff": 2824, "diff_percentage": 0.8562765312310491, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:13:55.359914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.049560546875, "l2_diff_relative": 0.4109311740890688}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:14:53.959001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1310344827586207, "overlap_percentage": 0.23170731707317074, "num_intersection": 437, "num_union": 3335, "num_only_computed": 1449, "num_only_roped": 1449, "total_diff": 2898, "diff_percentage": 0.8689655172413793, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:14:55.887438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.2552910052910053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:34.439717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:34.454337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.0030782948369565215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:36.592316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8561037167551608, "overlap_percentage": 0.9224740072734736, "num_intersection": 71911, "num_union": 83998, "num_only_computed": 6681, "num_only_roped": 5406, "total_diff": 12087, "diff_percentage": 0.14389628324483916, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:36.734501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 0.0001049041748046875, "l2_diff": 0.2041015625, "l2_diff_relative": 0.04473458904109589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:41.611487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7306983516091919, "overlap_percentage": 0.8443971197289156, "num_intersection": 71767, "num_union": 98217, "num_only_computed": 13225, "num_only_roped": 13225, "total_diff": 26450, "diff_percentage": 0.2693016483908081, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:43.878700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 0.00019359588623046875, "l2_diff": 0.341796875, "l2_diff_relative": 0.08820564516129033}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:49.808126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6506609992435431, "overlap_percentage": 0.7883641759776536, "num_intersection": 72252, "num_union": 111044, "num_only_computed": 19396, "num_only_roped": 19396, "total_diff": 38792, "diff_percentage": 0.3493390007564569, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:50.022491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 0.00019168853759765625, "l2_diff": 0.47265625, "l2_diff_relative": 0.11862745098039215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:57.053149", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5986469784687439, "overlap_percentage": 0.7489420572916666, "num_intersection": 73624, "num_union": 122984, "num_only_computed": 24680, "num_only_roped": 24680, "total_diff": 49360, "diff_percentage": 0.40135302153125607, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:15:57.698875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 7.82012939453125e-05, "l2_diff": 0.2734375, "l2_diff_relative": 0.059931506849315065}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:05.774863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5460398086350481, "overlap_percentage": 0.7063722493887531, "num_intersection": 73960, "num_union": 135448, "num_only_computed": 30744, "num_only_roped": 30744, "total_diff": 61488, "diff_percentage": 0.45396019136495186, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:06.059739", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.0001430511474609375, "l2_diff": 0.58984375, "l2_diff_relative": 0.1451923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:15.659794", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5012233838189797, "overlap_percentage": 0.6677532327586206, "num_intersection": 74361, "num_union": 148359, "num_only_computed": 36999, "num_only_roped": 36999, "total_diff": 73998, "diff_percentage": 0.49877661618102037, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:15.980660", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 0.0001430511474609375, "l2_diff": 0.58203125, "l2_diff_relative": 0.15585774058577406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:26.288063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4763922669943081, "overlap_percentage": 0.6453464673913043, "num_intersection": 75996, "num_union": 159524, "num_only_computed": 41764, "num_only_roped": 41764, "total_diff": 83528, "diff_percentage": 0.523607733005692, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:26.647105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.00016021728515625, "l2_diff": 0.8046875, "l2_diff_relative": 0.1996124031007752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:38.137078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4498755994243196, "overlap_percentage": 0.6205713091563786, "num_intersection": 77209, "num_union": 171623, "num_only_computed": 47207, "num_only_roped": 47207, "total_diff": 94414, "diff_percentage": 0.5501244005756805, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:39.138646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 0.00014209747314453125, "l2_diff": 0.8046875, "l2_diff_relative": 0.21020408163265306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:51.757188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42199849199073497, "overlap_percentage": 0.5935287475585938, "num_intersection": 77795, "num_union": 184349, "num_only_computed": 53277, "num_only_roped": 53277, "total_diff": 106554, "diff_percentage": 0.5780015080092651, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:52.931125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 0.00014781951904296875, "l2_diff": 0.84375, "l2_diff_relative": 0.22594142259414227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:06.988725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.405284947610529, "overlap_percentage": 0.5768010940409684, "num_intersection": 79294, "num_union": 195650, "num_only_computed": 58178, "num_only_roped": 58178, "total_diff": 116356, "diff_percentage": 0.594715052389471, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:07.572238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00012493133544921875, "l2_diff": 0.81640625, "l2_diff_relative": 0.21770833333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:22.556974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3934161550732344, "overlap_percentage": 0.5646786190053286, "num_intersection": 81386, "num_union": 206870, "num_only_computed": 62742, "num_only_roped": 62742, "total_diff": 125484, "diff_percentage": 0.6065838449267656, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:23.071449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.15059055118110237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:39.190848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37855621952057145, "overlap_percentage": 0.5492067920918368, "num_intersection": 82671, "num_union": 218385, "num_only_computed": 67857, "num_only_roped": 67857, "total_diff": 135714, "diff_percentage": 0.6214437804794285, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:39.731085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 8.249282836914062e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.16702127659574467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:57.236368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3636158584193632, "overlap_percentage": 0.5333112785016286, "num_intersection": 83828, "num_union": 230540, "num_only_computed": 73356, "num_only_roped": 73356, "total_diff": 146712, "diff_percentage": 0.6363841415806367, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:57.860834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 0.00010061264038085938, "l2_diff": 0.79296875, "l2_diff_relative": 0.22065217391304348}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:18:17.296960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35499584420525077, "overlap_percentage": 0.523980712890625, "num_intersection": 85849, "num_union": 241831, "num_only_computed": 77991, "num_only_roped": 77991, "total_diff": 155982, "diff_percentage": 0.6450041557947492, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:18:17.957860", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 6.866455078125e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.13432835820895522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:18:39.341576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3258153951590293, "overlap_percentage": 0.4914943609022556, "num_intersection": 83672, "num_union": 256808, "num_only_computed": 86568, "num_only_roped": 86568, "total_diff": 173136, "diff_percentage": 0.6741846048409706, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:18:40.049135", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.259765625, "l2_diff_relative": 0.05895390070921986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:02.029777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33266535330744285, "overlap_percentage": 0.4992481458031838, "num_intersection": 88315, "num_union": 265477, "num_only_computed": 88581, "num_only_roped": 88581, "total_diff": 177162, "diff_percentage": 0.6673346466925572, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:02.771972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 3.2901763916015625e-05, "l2_diff": 0.330078125, "l2_diff_relative": 0.0743838028169014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:26.149902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3205335561887403, "overlap_percentage": 0.4854606756284916, "num_intersection": 88983, "num_union": 277609, "num_only_computed": 94313, "num_only_roped": 94313, "total_diff": 188626, "diff_percentage": 0.6794664438112598, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:26.899724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.4960765838623047e-05, "l2_diff": 0.1748046875, "l2_diff_relative": 0.035628980891719744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:51.723229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3016072058737876, "overlap_percentage": 0.4634381317385445, "num_intersection": 88031, "num_union": 291873, "num_only_computed": 101921, "num_only_roped": 101921, "total_diff": 203842, "diff_percentage": 0.6983927941262125, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:54.128107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.400390625, "l2_diff_relative": 0.09217625899280575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:20:20.111909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28926660371419577, "overlap_percentage": 0.44873046875, "num_intersection": 88224, "num_union": 304992, "num_only_computed": 108384, "num_only_roped": 108384, "total_diff": 216768, "diff_percentage": 0.7107333962858042, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:20:22.455985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.4296875, "l2_diff_relative": 0.1065891472868217}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:20:48.895390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2738156491184037, "overlap_percentage": 0.4299140920554855, "num_intersection": 87276, "num_union": 318740, "num_only_computed": 115732, "num_only_roped": 115732, "total_diff": 231464, "diff_percentage": 0.7261843508815963, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:20:50.210349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.63671875, "l2_diff_relative": 0.14981617647058823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:18.828812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2654832537617924, "overlap_percentage": 0.4195760836385836, "num_intersection": 87970, "num_union": 331358, "num_only_computed": 121694, "num_only_roped": 121694, "total_diff": 243388, "diff_percentage": 0.7345167462382076, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:19.781461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:49.818707", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2522872104581376, "overlap_percentage": 0.4029222822867299, "num_intersection": 87057, "num_union": 345071, "num_only_computed": 129007, "num_only_roped": 129007, "total_diff": 258014, "diff_percentage": 0.7477127895418624, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:50.821713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.13725490196078433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:21.091949", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24946354188580805, "overlap_percentage": 0.3993130387931034, "num_intersection": 88935, "num_union": 356505, "num_only_computed": 133785, "num_only_roped": 133785, "total_diff": 267570, "diff_percentage": 0.7505364581141919, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:22.070240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.52734375, "l2_diff_relative": 0.1355421686746988}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:53.779913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24864113053584502, "overlap_percentage": 0.39825875418526785, "num_intersection": 91351, "num_union": 367401, "num_only_computed": 138025, "num_only_roped": 138025, "total_diff": 276050, "diff_percentage": 0.751358869464155, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:55.033725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.1697530864197531}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:23:27.218158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2456828574372142, "overlap_percentage": 0.39445490635179153, "num_intersection": 93003, "num_union": 378549, "num_only_computed": 142773, "num_only_roped": 142773, "total_diff": 285546, "diff_percentage": 0.7543171425627858, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:23:28.291771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.0517578125e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.12411347517730496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:01.845319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2384238743145253, "overlap_percentage": 0.3850440535902851, "num_intersection": 93347, "num_union": 391517, "num_only_computed": 149085, "num_only_roped": 149085, "total_diff": 298170, "diff_percentage": 0.7615761256854747, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:04.059739", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.1396761133603239}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:39.048261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23484617274209277, "overlap_percentage": 0.38036506558641975, "num_intersection": 94647, "num_union": 403017, "num_only_computed": 154185, "num_only_roped": 154185, "total_diff": 308370, "diff_percentage": 0.7651538272579073, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:40.201606", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.1648706896551724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:25:16.570118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22728986777792456, "overlap_percentage": 0.37039313001002006, "num_intersection": 94631, "num_union": 416345, "num_only_computed": 160857, "num_only_roped": 160857, "total_diff": 321714, "diff_percentage": 0.7727101322220754, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:25:17.777527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.56640625, "l2_diff_relative": 0.1322992700729927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:25:55.176131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2256936326996269, "overlap_percentage": 0.3682708740234375, "num_intersection": 96540, "num_union": 427748, "num_only_computed": 165604, "num_only_roped": 165604, "total_diff": 331208, "diff_percentage": 0.7743063673003732, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:25:56.411190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.515625, "l2_diff_relative": 0.13095238095238096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:26:35.098668", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21294681975446933, "overlap_percentage": 0.35112309342230696, "num_intersection": 94292, "num_union": 442796, "num_only_computed": 174252, "num_only_roped": 174252, "total_diff": 348504, "diff_percentage": 0.7870531802455307, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:26:36.387911", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.2901763916015625e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.15638297872340426}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:27:16.816713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2116275742132896, "overlap_percentage": 0.34932776162790696, "num_intersection": 96135, "num_union": 454265, "num_only_computed": 179065, "num_only_roped": 179065, "total_diff": 358130, "diff_percentage": 0.7883724257867104, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:27:18.537250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.15805785123966942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:27:59.945200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20933368548305709, "overlap_percentage": 0.34619673295454545, "num_intersection": 97489, "num_union": 465711, "num_only_computed": 184111, "num_only_roped": 184111, "total_diff": 368222, "diff_percentage": 0.7906663145169429, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:28:01.314168", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.20405982905982906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:28:44.096279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.203722379165701, "overlap_percentage": 0.3384873168294849, "num_intersection": 97571, "num_union": 478941, "num_only_computed": 190685, "num_only_roped": 190685, "total_diff": 381370, "diff_percentage": 0.796277620834299, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:28:45.499669", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.340576171875e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.3155339805825243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:29:29.639887", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19329451608595902, "overlap_percentage": 0.3239678276909722, "num_intersection": 95542, "num_union": 494282, "num_only_computed": 199370, "num_only_roped": 199370, "total_diff": 398740, "diff_percentage": 0.806705483914041, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:29:31.100801", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 7.009506225585938e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.4486486486486487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:30:15.720257", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18266385109940575, "overlap_percentage": 0.30890240016992354, "num_intersection": 93076, "num_union": 509548, "num_only_computed": 208236, "num_only_roped": 208236, "total_diff": 416472, "diff_percentage": 0.8173361489005943, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:30:18.990033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11474609375, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.4585365853658537}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:31:05.768128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1752933768389719, "overlap_percentage": 0.29829722568578554, "num_intersection": 91866, "num_union": 524070, "num_only_computed": 216102, "num_only_roped": 216102, "total_diff": 432204, "diff_percentage": 0.824706623161028, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:31:07.334051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 9.441375732421875e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.80625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:31:54.483246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16392932778460673, "overlap_percentage": 0.2816826140065147, "num_intersection": 88552, "num_union": 540184, "num_only_computed": 225816, "num_only_roped": 225816, "total_diff": 451632, "diff_percentage": 0.8360706722153932, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:31:56.035865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 8.392333984375e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.6686746987951807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:32:46.020444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16236184407049686, "overlap_percentage": 0.2793654057017544, "num_intersection": 89683, "num_union": 552365, "num_only_computed": 231341, "num_only_roped": 231341, "total_diff": 462682, "diff_percentage": 0.8376381559295032, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:32:49.183053", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.390975952148438e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.5793650793650794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:33:41.589063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15891797069106073, "overlap_percentage": 0.2742523193359375, "num_intersection": 89867, "num_union": 565493, "num_only_computed": 237813, "num_only_roped": 237813, "total_diff": 475626, "diff_percentage": 0.8410820293089393, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:33:44.675718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.6666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:34:37.706696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15596415985162912, "overlap_percentage": 0.26984255268199236, "num_intersection": 90149, "num_union": 578011, "num_only_computed": 243931, "num_only_roped": 243931, "total_diff": 487862, "diff_percentage": 0.8440358401483709, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:34:40.615465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.8359375, "l2_diff_relative": 0.7833333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:35:34.827029", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15420977841310382, "overlap_percentage": 0.2672127394815928, "num_intersection": 91049, "num_union": 590423, "num_only_computed": 249687, "num_only_roped": 249687, "total_diff": 499374, "diff_percentage": 0.8457902215868962, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:35:37.557805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.7676056338028169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:36:33.717525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1486886254889114, "overlap_percentage": 0.2588841261061947, "num_intersection": 89868, "num_union": 604404, "num_only_computed": 257268, "num_only_roped": 257268, "total_diff": 514536, "diff_percentage": 0.8513113745110886, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:36:35.561573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.5703125, "l2_diff_relative": 0.5234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:33.585817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14502648216802624, "overlap_percentage": 0.25331550741678727, "num_intersection": 89621, "num_union": 617963, "num_only_computed": 264171, "num_only_roped": 264171, "total_diff": 528342, "diff_percentage": 0.8549735178319737, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:35.500618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.5798969072164949}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:38:34.248927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14813015717796355, "overlap_percentage": 0.25803722034801135, "num_intersection": 93009, "num_union": 627887, "num_only_computed": 267439, "num_only_roped": 267439, "total_diff": 534878, "diff_percentage": 0.8518698428220365, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:38:38.697402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.550531914893617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:39:38.668263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14906439306141114, "overlap_percentage": 0.2594535066294487, "num_intersection": 95180, "num_union": 638516, "num_only_computed": 271668, "num_only_roped": 271668, "total_diff": 543336, "diff_percentage": 0.8509356069385888, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:39:40.672162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.6770186335403726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:40:43.077658", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14363399205129304, "overlap_percentage": 0.2511887422892392, "num_intersection": 93820, "num_union": 653188, "num_only_computed": 279684, "num_only_roped": 279684, "total_diff": 559368, "diff_percentage": 0.856366007948707, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:40:45.118518", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.7246835443037974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:41:48.178695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13866442872557247, "overlap_percentage": 0.2435562668463612, "num_intersection": 92528, "num_union": 667280, "num_only_computed": 287376, "num_only_roped": 287376, "total_diff": 574752, "diff_percentage": 0.8613355712744275, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:41:52.484618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.7251461988304093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:42:56.814184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13725559419368885, "overlap_percentage": 0.24138038079470198, "num_intersection": 93308, "num_union": 679812, "num_only_computed": 293252, "num_only_roped": 293252, "total_diff": 586504, "diff_percentage": 0.8627444058063112, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:43:00.550500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1806640625, "mean_diff": 7.62939453125e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.7382198952879581}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:44:04.591508", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13775308695557822, "overlap_percentage": 0.24214935302734375, "num_intersection": 95217, "num_union": 691215, "num_only_computed": 297999, "num_only_roped": 297999, "total_diff": 595998, "diff_percentage": 0.8622469130444218, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:44:06.699354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 7.62939453125e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.7613636363636364}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:45:13.958482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13398410896708285, "overlap_percentage": 0.23630685458039719, "num_intersection": 94432, "num_union": 704800, "num_only_computed": 305184, "num_only_roped": 305184, "total_diff": 610368, "diff_percentage": 0.8660158910329171, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:45:16.109228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.390975952148438e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.7344632768361582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:46:25.442316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13745604407910947, "overlap_percentage": 0.2416902961562697, "num_intersection": 98192, "num_union": 714352, "num_only_computed": 308080, "num_only_roped": 308080, "total_diff": 616160, "diff_percentage": 0.8625439559208905, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:46:28.700931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.6822916666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:47:38.743035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13746416758544652, "overlap_percentage": 0.24170285359801488, "num_intersection": 99744, "num_union": 725600, "num_only_computed": 312928, "num_only_roped": 312928, "total_diff": 625856, "diff_percentage": 0.8625358324145534, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:47:41.100825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.5967741935483871}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:48:54.640075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13923988730618866, "overlap_percentage": 0.24444349053724054, "num_intersection": 102502, "num_union": 736154, "num_only_computed": 316826, "num_only_roped": 316826, "total_diff": 633652, "diff_percentage": 0.8607601126938114, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:48:57.062804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.96875, "l2_diff_relative": 0.7544910179640718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:50:12.603594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13588766555651252, "overlap_percentage": 0.23926250751201922, "num_intersection": 101922, "num_union": 750046, "num_only_computed": 324062, "num_only_roped": 324062, "total_diff": 648124, "diff_percentage": 0.8641123344434875, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:50:15.166313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.343292236328125e-05, "l2_diff": 1.8125, "l2_diff_relative": 0.8405797101449275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:51:33.145293", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13120679167784005, "overlap_percentage": 0.23197666888691534, "num_intersection": 100303, "num_union": 764465, "num_only_computed": 332081, "num_only_roped": 332081, "total_diff": 664162, "diff_percentage": 0.8687932083221599, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:51:35.718180", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.8671875, "l2_diff_relative": 0.8786764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:52:55.418748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13148806762538012, "overlap_percentage": 0.23241618075801748, "num_intersection": 102040, "num_union": 776040, "num_only_computed": 337000, "num_only_roped": 337000, "total_diff": 674000, "diff_percentage": 0.8685119323746199, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:52:59.275537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.8515625, "l2_diff_relative": 0.7745098039215687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:54:18.916182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13448155104899556, "overlap_percentage": 0.23708019037356323, "num_intersection": 105605, "num_union": 785275, "num_only_computed": 339835, "num_only_roped": 339835, "total_diff": 679670, "diff_percentage": 0.8655184489510044, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:54:22.632494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.6228070175438597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:55:42.702136", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1301976175893404, "overlap_percentage": 0.23039796857304642, "num_intersection": 104162, "num_union": 800030, "num_only_computed": 347934, "num_only_roped": 347934, "total_diff": 695868, "diff_percentage": 0.8698023824106595, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:55:45.631623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 5.5789947509765625e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.6541095890410958}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:57:08.266325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13538423462442767, "overlap_percentage": 0.23848179408482142, "num_intersection": 109404, "num_union": 808100, "num_only_computed": 349348, "num_only_roped": 349348, "total_diff": 698696, "diff_percentage": 0.8646157653755723, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:57:11.040169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.872093023255814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:58:36.264559", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12784764241697572, "overlap_percentage": 0.22671083860759494, "num_intersection": 105455, "num_union": 824849, "num_only_computed": 359697, "num_only_roped": 359697, "total_diff": 719394, "diff_percentage": 0.8721523575830243, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:58:39.068385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.82012939453125e-05, "l2_diff": 2.109375, "l2_diff_relative": 1.210762331838565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:00:06.447792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12371089823896196, "overlap_percentage": 0.22018278621812262, "num_intersection": 103884, "num_union": 839732, "num_only_computed": 367924, "num_only_roped": 367924, "total_diff": 735848, "diff_percentage": 0.876289101761038, "num_computed": 471808, "num_roped": 471808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 256, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:00:10.129795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.046875, "l2_diff_relative": 1.1293103448275863}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 256, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:37.236916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1257939516072076, "overlap_percentage": 0.22347597698072805, "num_intersection": 106868, "num_union": 849548, "num_only_computed": 371340, "num_only_roped": 371340, "total_diff": 742680, "diff_percentage": 0.8742060483927924, "num_computed": 478208, "num_roped": 478208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "mask_shape": [1, 32, 256, 16128], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:40.148466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.125, "l2_diff_relative": 0.8292682926829268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "attention_shape": [1, 32, 256, 16128]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:03:07.909012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12509761663512556, "overlap_percentage": 0.22237646722470178, "num_intersection": 70003, "num_union": 559587, "num_only_computed": 244792, "num_only_roped": 244792, "total_diff": 489584, "diff_percentage": 0.8749023833648745, "num_computed": 314795, "num_roped": 314795}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 167, "seq_len_k": 16295, "queries_shape": [1, 32, 167, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 167, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:03:10.743303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 5.221366882324219e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.5909090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 167, "seq_len_k": 16295, "queries_shape": [1, 32, 167, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 167, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:04:31.602324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1251936906511979, "overlap_percentage": 0.22252824858757062, "num_intersection": 12604, "num_union": 100676, "num_only_computed": 44036, "num_only_roped": 44036, "total_diff": 88072, "diff_percentage": 0.8748063093488021, "num_computed": 56640, "num_roped": 56640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:04:34.037904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.408203125, "l2_diff_relative": 0.3732142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:05:43.131639", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1291866028708134, "overlap_percentage": 0.2288135593220339, "num_intersection": 432, "num_union": 3344, "num_only_computed": 1456, "num_only_roped": 1456, "total_diff": 2912, "diff_percentage": 0.8708133971291866, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:05:45.037803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03466796875, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.5708661417322834}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:06:44.172936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12851165570830841, "overlap_percentage": 0.2277542372881356, "num_intersection": 430, "num_union": 3346, "num_only_computed": 1458, "num_only_roped": 1458, "total_diff": 2916, "diff_percentage": 0.8714883442916915, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "mask_shape": [1, 32, 1, 16327], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:06:46.052125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.035888671875, "mean_diff": 6.103515625e-05, "l2_diff": 0.0849609375, "l2_diff_relative": 0.75}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "attention_shape": [1, 32, 1, 16327]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:23.536223", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:23.550690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1026859283447266e-05, "l2_diff": 0.016845703125, "l2_diff_relative": 0.002945696721311475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:25.665359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.861355523453636, "overlap_percentage": 0.925514242282357, "num_intersection": 72148, "num_union": 83761, "num_only_computed": 6444, "num_only_roped": 5169, "total_diff": 11613, "diff_percentage": 0.13864447654636405, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:25.810147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 0.00010967254638671875, "l2_diff": 0.171875, "l2_diff_relative": 0.03793103448275862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:30.658625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.726356841078973, "overlap_percentage": 0.8414909638554217, "num_intersection": 71520, "num_union": 98464, "num_only_computed": 13472, "num_only_roped": 13472, "total_diff": 26944, "diff_percentage": 0.273643158921027, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:31.203563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 0.0001983642578125, "l2_diff": 0.373046875, "l2_diff_relative": 0.08466312056737589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:37.070840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6623376623376623, "overlap_percentage": 0.796875, "num_intersection": 73032, "num_union": 110264, "num_only_computed": 18616, "num_only_roped": 18616, "total_diff": 37232, "diff_percentage": 0.33766233766233766, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:37.283041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.00018024444580078125, "l2_diff": 0.515625, "l2_diff_relative": 0.10248447204968944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:44.276860", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6138691883372734, "overlap_percentage": 0.7607421875, "num_intersection": 74784, "num_union": 121824, "num_only_computed": 23520, "num_only_roped": 23520, "total_diff": 47040, "diff_percentage": 0.38613081166272656, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:45.111224", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 0.00011348724365234375, "l2_diff": 0.419921875, "l2_diff_relative": 0.0920376712328767}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:53.190755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5608941628962649, "overlap_percentage": 0.7186831448655256, "num_intersection": 75249, "num_union": 134159, "num_only_computed": 29455, "num_only_roped": 29455, "total_diff": 58910, "diff_percentage": 0.43910583710373513, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:53.468804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 8.630752563476562e-05, "l2_diff": 0.3671875, "l2_diff_relative": 0.08576642335766424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:03.055888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5271530444322545, "overlap_percentage": 0.6903735632183908, "num_intersection": 76880, "num_union": 145840, "num_only_computed": 34480, "num_only_roped": 34480, "total_diff": 68960, "diff_percentage": 0.4728469555677455, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:03.376315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 8.630752563476562e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.08899006622516556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:13.602540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4892661797717285, "overlap_percentage": 0.6570567255434783, "num_intersection": 77375, "num_union": 158145, "num_only_computed": 40385, "num_only_roped": 40385, "total_diff": 80770, "diff_percentage": 0.5107338202282715, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:13.955941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.000133514404296875, "l2_diff": 0.6953125, "l2_diff_relative": 0.17943548387096775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:25.523877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4604873925905057, "overlap_percentage": 0.6305941358024691, "num_intersection": 78456, "num_union": 170376, "num_only_computed": 45960, "num_only_roped": 45960, "total_diff": 91920, "diff_percentage": 0.5395126074094942, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:26.514158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 0.00012159347534179688, "l2_diff": 0.6171875, "l2_diff_relative": 0.18202764976958524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:39.184132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.436334646510583, "overlap_percentage": 0.6075668334960938, "num_intersection": 79635, "num_union": 182509, "num_only_computed": 51437, "num_only_roped": 51437, "total_diff": 102874, "diff_percentage": 0.5636653534894169, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:40.399218", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 0.00014019012451171875, "l2_diff": 0.7578125, "l2_diff_relative": 0.23205741626794257}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:54.115236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4123376123037093, "overlap_percentage": 0.5839079958100558, "num_intersection": 80271, "num_union": 194673, "num_only_computed": 57201, "num_only_roped": 57201, "total_diff": 114402, "diff_percentage": 0.5876623876962908, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:54.567805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 0.000141143798828125, "l2_diff": 0.796875, "l2_diff_relative": 0.25757575757575757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:09:09.495521", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38998939145529943, "overlap_percentage": 0.5611400976909414, "num_intersection": 80876, "num_union": 207380, "num_only_computed": 63252, "num_only_roped": 63252, "total_diff": 126504, "diff_percentage": 0.6100106085447006, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:09:10.010037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07763671875, "mean_diff": 0.00011396408081054688, "l2_diff": 0.8125, "l2_diff_relative": 0.22317596566523606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:09:26.116804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3830781316757859, "overlap_percentage": 0.5539500956632653, "num_intersection": 83385, "num_union": 217671, "num_only_computed": 67143, "num_only_roped": 67143, "total_diff": 134286, "diff_percentage": 0.616921868324214, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:09:26.668635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 9.775161743164062e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.20365853658536584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:09:43.962303", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36295962298017354, "overlap_percentage": 0.5326050997557004, "num_intersection": 83717, "num_union": 230651, "num_only_computed": 73467, "num_only_roped": 73467, "total_diff": 146934, "diff_percentage": 0.6370403770198265, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:09:44.553828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 0.00012302398681640625, "l2_diff": 0.87890625, "l2_diff_relative": 0.30080213903743314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:03.136300", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34714685084690017, "overlap_percentage": 0.515380859375, "num_intersection": 84440, "num_union": 243240, "num_only_computed": 79400, "num_only_roped": 79400, "total_diff": 158800, "diff_percentage": 0.6528531491530998, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:03.748944", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 0.000102996826171875, "l2_diff": 0.82421875, "l2_diff_relative": 0.25483091787439616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:24.139918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3423273894239678, "overlap_percentage": 0.5100505169172932, "num_intersection": 86831, "num_union": 253649, "num_only_computed": 83409, "num_only_roped": 83409, "total_diff": 166818, "diff_percentage": 0.6576726105760322, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:24.811330", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08154296875, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.16630901287553648}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:45.708907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31604849179218014, "overlap_percentage": 0.48029915882778584, "num_intersection": 84963, "num_union": 268829, "num_only_computed": 91933, "num_only_roped": 91933, "total_diff": 183866, "diff_percentage": 0.6839515082078198, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:46.414850", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 9.822845458984375e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.27682926829268295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:11:08.705740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30862619808306707, "overlap_percentage": 0.4716796875, "num_intersection": 86457, "num_union": 280135, "num_only_computed": 96839, "num_only_roped": 96839, "total_diff": 193678, "diff_percentage": 0.6913738019169329, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:11:11.499981", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07080078125, "mean_diff": 8.392333984375e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.24308755760368664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:11:35.578967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2983820805337015, "overlap_percentage": 0.45962137803234504, "num_intersection": 87306, "num_union": 292598, "num_only_computed": 102646, "num_only_roped": 102646, "total_diff": 205292, "diff_percentage": 0.7016179194662985, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:11:36.369190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.62939453125e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.23032407407407407}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:12:03.463130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2932524699722416, "overlap_percentage": 0.4535115559895833, "num_intersection": 89164, "num_union": 304052, "num_only_computed": 107444, "num_only_roped": 107444, "total_diff": 214888, "diff_percentage": 0.7067475300277584, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:12:06.713661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.20774647887323944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:12:33.239176", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28051268950683284, "overlap_percentage": 0.43812559110970994, "num_intersection": 88943, "num_union": 317073, "num_only_computed": 114065, "num_only_roped": 114065, "total_diff": 228130, "diff_percentage": 0.7194873104931672, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:12:35.327531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 7.534027099609375e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.24333333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:13:02.644362", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2739452601646023, "overlap_percentage": 0.4300738324175824, "num_intersection": 90171, "num_union": 329157, "num_only_computed": 119493, "num_only_roped": 119493, "total_diff": 238986, "diff_percentage": 0.7260547398353977, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:13:03.709039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.2786458333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:13:32.258437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2685656244220489, "overlap_percentage": 0.4234162100118483, "num_intersection": 91485, "num_union": 340643, "num_only_computed": 124579, "num_only_roped": 124579, "total_diff": 249158, "diff_percentage": 0.7314343755779511, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:13:33.271438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.8125, "l2_diff_relative": 0.2311111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:14:03.038566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26481854294857415, "overlap_percentage": 0.41874551005747124, "num_intersection": 93263, "num_union": 352177, "num_only_computed": 129457, "num_only_roped": 129457, "total_diff": 258914, "diff_percentage": 0.7351814570514258, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:14:04.038763", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 7.104873657226562e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.29441624365482233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:14:35.082113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2525104705323453, "overlap_percentage": 0.4032069614955357, "num_intersection": 92486, "num_union": 366266, "num_only_computed": 136890, "num_only_roped": 136890, "total_diff": 273780, "diff_percentage": 0.7474895294676547, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:14:36.133992", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.27238805970149255}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:09.475590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24721490462436918, "overlap_percentage": 0.39642711726384366, "num_intersection": 93468, "num_union": 378084, "num_only_computed": 142308, "num_only_roped": 142308, "total_diff": 284616, "diff_percentage": 0.7527850953756308, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:10.570401", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 7.486343383789062e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.3217948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:44.340834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2370020945640832, "overlap_percentage": 0.38318786298838436, "num_intersection": 92897, "num_union": 391967, "num_only_computed": 149535, "num_only_roped": 149535, "total_diff": 299070, "diff_percentage": 0.7629979054359168, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:45.477040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.0, "l2_diff_relative": 0.3386243386243386}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:16:20.815048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23606071218341815, "overlap_percentage": 0.3819565007716049, "num_intersection": 95043, "num_union": 402621, "num_only_computed": 153789, "num_only_roped": 153789, "total_diff": 307578, "diff_percentage": 0.7639392878165818, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:16:21.989873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 5.4836273193359375e-05, "l2_diff": 0.875, "l2_diff_relative": 0.2445414847161572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:16:58.400069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23222949965756398, "overlap_percentage": 0.3769257264529058, "num_intersection": 96300, "num_union": 414676, "num_only_computed": 159188, "num_only_roped": 159188, "total_diff": 318376, "diff_percentage": 0.767770500342436, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:17:00.712981", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.24519230769230768}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:17:38.425629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23126348890240553, "overlap_percentage": 0.3756523132324219, "num_intersection": 98475, "num_union": 425813, "num_only_computed": 163669, "num_only_roped": 163669, "total_diff": 327338, "diff_percentage": 0.7687365110975944, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:17:42.158192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.29534313725490197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:18:21.204151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23062822786492346, "overlap_percentage": 0.37481381077216397, "num_intersection": 100654, "num_union": 436434, "num_only_computed": 167890, "num_only_roped": 167890, "total_diff": 335780, "diff_percentage": 0.7693717721350766, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:18:23.465073", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.875, "l2_diff_relative": 0.30601092896174864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:19:04.368468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22672312921379617, "overlap_percentage": 0.369640261627907, "num_intersection": 101725, "num_union": 448675, "num_only_computed": 173475, "num_only_roped": 173475, "total_diff": 346950, "diff_percentage": 0.7732768707862038, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:19:05.696991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.20285087719298245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:19:47.935166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21393438029425837, "overlap_percentage": 0.35246448863636365, "num_intersection": 99254, "num_union": 463946, "num_only_computed": 182346, "num_only_roped": 182346, "total_diff": 364692, "diff_percentage": 0.7860656197057416, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:19:49.305683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.6716461181640625e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.1695736434108527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:20:33.054329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21162038506238717, "overlap_percentage": 0.3493179673623446, "num_intersection": 100693, "num_union": 475819, "num_only_computed": 187563, "num_only_roped": 187563, "total_diff": 375126, "diff_percentage": 0.7883796149376129, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:20:34.454723", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.30861244019138756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:21:19.139940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1907120968034981, "overlap_percentage": 0.3203328450520833, "num_intersection": 94470, "num_union": 495354, "num_only_computed": 200442, "num_only_roped": 200442, "total_diff": 400884, "diff_percentage": 0.8092879031965019, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:21:22.318238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09033203125, "mean_diff": 6.031990051269531e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:08.619504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1842209724138202, "overlap_percentage": 0.3111260089209856, "num_intersection": 93746, "num_union": 508878, "num_only_computed": 207566, "num_only_roped": 207566, "total_diff": 415132, "diff_percentage": 0.8157790275861798, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:10.176025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.4542857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:57.880704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17041803087108293, "overlap_percentage": 0.29120882689110555, "num_intersection": 89683, "num_union": 526253, "num_only_computed": 218285, "num_only_roped": 218285, "total_diff": 436570, "diff_percentage": 0.8295819691289171, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:01.159126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 8.916854858398438e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.7414965986394558}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:50.339938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16727004036105883, "overlap_percentage": 0.28660041734527686, "num_intersection": 90098, "num_union": 538638, "num_only_computed": 224270, "num_only_roped": 224270, "total_diff": 448540, "diff_percentage": 0.8327299596389411, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:51.890421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.6796875, "l2_diff_relative": 0.6677018633540373}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:24:43.171488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16321472570476123, "overlap_percentage": 0.28062699362041466, "num_intersection": 90088, "num_union": 551960, "num_only_computed": 230936, "num_only_roped": 230936, "total_diff": 461872, "diff_percentage": 0.8367852742952387, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:24:44.786077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 8.678436279296875e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.7432432432432432}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:25:35.951336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16140305485013726, "overlap_percentage": 0.2779449462890625, "num_intersection": 91077, "num_union": 564283, "num_only_computed": 236603, "num_only_roped": 236603, "total_diff": 473206, "diff_percentage": 0.8385969451498627, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:25:37.598946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.6859756097560976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:26:29.668412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1529462110283612, "overlap_percentage": 0.26531369731800764, "num_intersection": 88636, "num_union": 579524, "num_only_computed": 245444, "num_only_roped": 245444, "total_diff": 490888, "diff_percentage": 0.8470537889716387, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:26:31.414439", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.6796875, "l2_diff_relative": 0.5512820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:27:24.877214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14769012609110826, "overlap_percentage": 0.2573693416604057, "num_intersection": 87695, "num_union": 593777, "num_only_computed": 253041, "num_only_roped": 253041, "total_diff": 506082, "diff_percentage": 0.8523098739088917, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:27:26.642166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 9.250640869140625e-05, "l2_diff": 1.921875, "l2_diff_relative": 0.924812030075188}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:28:21.945682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14704512035950898, "overlap_percentage": 0.25638942662241887, "num_intersection": 89002, "num_union": 605270, "num_only_computed": 258134, "num_only_roped": 258134, "total_diff": 516268, "diff_percentage": 0.852954879640491, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:28:23.773740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 8.20159912109375e-05, "l2_diff": 1.671875, "l2_diff_relative": 0.7482517482517482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:29:20.243023", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16121684360471128, "overlap_percentage": 0.27766879974674386, "num_intersection": 98237, "num_union": 609347, "num_only_computed": 255555, "num_only_roped": 255555, "total_diff": 511110, "diff_percentage": 0.8387831563952888, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:29:22.091023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.549079754601227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:30:19.755377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.161485949792723, "overlap_percentage": 0.2780678488991477, "num_intersection": 100229, "num_union": 620667, "num_only_computed": 260219, "num_only_roped": 260219, "total_diff": 520438, "diff_percentage": 0.838514050207277, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:30:24.256958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.6777777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:31:24.013146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15675293880228042, "overlap_percentage": 0.27102233077459875, "num_intersection": 99424, "num_union": 634272, "num_only_computed": 267424, "num_only_roped": 267424, "total_diff": 534848, "diff_percentage": 0.8432470611977196, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:31:26.010800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 8.153915405273438e-05, "l2_diff": 1.671875, "l2_diff_relative": 0.7642857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:32:27.417272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16061171506122277, "overlap_percentage": 0.2767707976353667, "num_intersection": 103375, "num_union": 643633, "num_only_computed": 270129, "num_only_roped": 270129, "total_diff": 540258, "diff_percentage": 0.8393882849387773, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:32:29.393371", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 7.343292236328125e-05, "l2_diff": 1.4140625, "l2_diff_relative": 0.6418439716312057}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:33:31.376286", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1560709824369744, "overlap_percentage": 0.2700024216644205, "num_intersection": 102575, "num_union": 657233, "num_only_computed": 277329, "num_only_roped": 277329, "total_diff": 554658, "diff_percentage": 0.8439290175630256, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:33:35.779617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.8828125, "l2_diff_relative": 0.6478494623655914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:34:41.055814", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15513799739424583, "overlap_percentage": 0.26860513245033113, "num_intersection": 103832, "num_union": 669288, "num_only_computed": 282728, "num_only_roped": 282728, "total_diff": 565456, "diff_percentage": 0.8448620026057542, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:34:44.971746", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.375, "l2_diff_relative": 0.4756756756756757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:35:51.261917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1527339673307614, "overlap_percentage": 0.2649943033854167, "num_intersection": 104200, "num_union": 682232, "num_only_computed": 289016, "num_only_roped": 289016, "total_diff": 578032, "diff_percentage": 0.8472660326692386, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:35:54.557928", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.459785461425781e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.4147465437788018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:37:02.512385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1441594658512423, "overlap_percentage": 0.2519919122357463, "num_intersection": 100700, "num_union": 698532, "num_only_computed": 298916, "num_only_roped": 298916, "total_diff": 597832, "diff_percentage": 0.8558405341487577, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:37:06.501507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 7.43865966796875e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.7808219178082192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:38:15.640622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14523305816341345, "overlap_percentage": 0.25363057262129807, "num_intersection": 103043, "num_union": 709501, "num_only_computed": 303229, "num_only_roped": 303229, "total_diff": 606458, "diff_percentage": 0.8547669418365865, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:38:17.905847", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.295608520507812e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.7258064516129032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:39:29.903641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1420379856481443, "overlap_percentage": 0.24874476581885857, "num_intersection": 102650, "num_union": 722694, "num_only_computed": 310022, "num_only_roped": 310022, "total_diff": 620044, "diff_percentage": 0.8579620143518557, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:39:32.257623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.866455078125e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.6891891891891891}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:40:47.083253", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14684706490480273, "overlap_percentage": 0.25608831272893773, "num_intersection": 107385, "num_union": 731271, "num_only_computed": 311943, "num_only_roped": 311943, "total_diff": 623886, "diff_percentage": 0.8531529350951973, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:40:49.462393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.7734375, "l2_diff_relative": 0.8798449612403101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:42:03.529792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14304727456168126, "overlap_percentage": 0.2502910907451923, "num_intersection": 106620, "num_union": 745348, "num_only_computed": 319364, "num_only_roped": 319364, "total_diff": 638728, "diff_percentage": 0.8569527254383188, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:42:05.967671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.8540145985401459}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:43:22.091137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13772688281821482, "overlap_percentage": 0.2421088661930136, "num_intersection": 104684, "num_union": 760084, "num_only_computed": 327700, "num_only_roped": 327700, "total_diff": 655400, "diff_percentage": 0.8622731171817851, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:43:24.584274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.7007042253521126}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:44:41.940055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13583210878158827, "overlap_percentage": 0.23917638483965015, "num_intersection": 105008, "num_union": 773072, "num_only_computed": 334032, "num_only_roped": 334032, "total_diff": 668064, "diff_percentage": 0.8641678912184118, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:44:45.166481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 5.459785461425781e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.5088235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:46:03.690251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12857763595111626, "overlap_percentage": 0.22785784841954024, "num_intersection": 101497, "num_union": 789383, "num_only_computed": 343943, "num_only_roped": 343943, "total_diff": 687886, "diff_percentage": 0.8714223640488837, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:46:06.418310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.7848605577689243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:47:27.119419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13496143958868895, "overlap_percentage": 0.23782559456398641, "num_intersection": 107520, "num_union": 796672, "num_only_computed": 344576, "num_only_roped": 344576, "total_diff": 689152, "diff_percentage": 0.8650385604113111, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:47:31.912483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 5.507469177246094e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.56353591160221}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:48:54.353234", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1304001783991632, "overlap_percentage": 0.23071507045200892, "num_intersection": 105841, "num_union": 811663, "num_only_computed": 352911, "num_only_roped": 352911, "total_diff": 705822, "diff_percentage": 0.8695998216008368, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:48:57.083500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 5.53131103515625e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.6048951048951049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:50:22.133681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12406328462373101, "overlap_percentage": 0.22074074711062192, "num_intersection": 102678, "num_union": 827626, "num_only_computed": 362474, "num_only_roped": 362474, "total_diff": 724948, "diff_percentage": 0.8759367153762689, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:50:24.956105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.9279661016949152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:51:54.915758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.129077070527831, "overlap_percentage": 0.22864173562126966, "num_intersection": 107875, "num_union": 835741, "num_only_computed": 363933, "num_only_roped": 363933, "total_diff": 727866, "diff_percentage": 0.870922929472169, "num_computed": 471808, "num_roped": 471808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 256, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:51:57.852251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.6328125, "l2_diff_relative": 0.8461538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 256, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:53:28.727648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13419008869161195, "overlap_percentage": 0.23662715805674517, "num_intersection": 113157, "num_union": 843259, "num_only_computed": 365051, "num_only_roped": 365051, "total_diff": 730102, "diff_percentage": 0.865809911308388, "num_computed": 478208, "num_roped": 478208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "mask_shape": [1, 32, 256, 16128], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:53:33.851321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 7.009506225585938e-05, "l2_diff": 1.890625, "l2_diff_relative": 1.0125523012552302}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "attention_shape": [1, 32, 256, 16128]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:55:04.062569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13177678139967336, "overlap_percentage": 0.23286708751297128, "num_intersection": 86172, "num_union": 653924, "num_only_computed": 283876, "num_only_roped": 283876, "total_diff": 567752, "diff_percentage": 0.8682232186003267, "num_computed": 370048, "num_roped": 370048}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 196, "seq_len_k": 16324, "queries_shape": [1, 32, 196, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 196, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:55:07.470738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.6211180124223602}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 196, "seq_len_k": 16324, "queries_shape": [1, 32, 196, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 196, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:56:30.996234", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13191990577149587, "overlap_percentage": 0.23309053069719043, "num_intersection": 13664, "num_union": 103578, "num_only_computed": 44957, "num_only_roped": 44957, "total_diff": 89914, "diff_percentage": 0.8680800942285041, "num_computed": 58621, "num_roped": 58621}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:56:33.465968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.35546875, "l2_diff_relative": 0.30952380952380953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:57:42.060720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1374436090225564, "overlap_percentage": 0.24167107350608144, "num_intersection": 457, "num_union": 3325, "num_only_computed": 1434, "num_only_roped": 1434, "total_diff": 2868, "diff_percentage": 0.8625563909774436, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:57:43.983691", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.057861328125, "l2_diff_relative": 0.38980263157894735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:21.702966", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:21.717494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.043081283569336e-05, "l2_diff": 0.0179443359375, "l2_diff_relative": 0.003006380890052356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:23.858514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8696366470799856, "overlap_percentage": 0.9302734287308623, "num_intersection": 72519, "num_union": 83390, "num_only_computed": 6073, "num_only_roped": 4798, "total_diff": 10871, "diff_percentage": 0.13036335292001439, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:24.000203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 7.534027099609375e-05, "l2_diff": 0.1259765625, "l2_diff_relative": 0.02819055944055944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:28.907158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7555252612880572, "overlap_percentage": 0.8607398343373494, "num_intersection": 73156, "num_union": 96828, "num_only_computed": 11836, "num_only_roped": 11836, "total_diff": 23672, "diff_percentage": 0.24447473871194284, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:29.086729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.177734375, "l2_diff_relative": 0.03365384615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:34.992370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6817381092190252, "overlap_percentage": 0.8107541899441341, "num_intersection": 74304, "num_union": 108992, "num_only_computed": 17344, "num_only_roped": 17344, "total_diff": 34688, "diff_percentage": 0.3182618907809748, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:35.343672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 0.00010061264038085938, "l2_diff": 0.29296875, "l2_diff_relative": 0.061274509803921566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:42.341670", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6194657463159889, "overlap_percentage": 0.7650248209635416, "num_intersection": 75205, "num_union": 121403, "num_only_computed": 23099, "num_only_roped": 23099, "total_diff": 46198, "diff_percentage": 0.3805342536840111, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:42.589952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.263671875, "l2_diff_relative": 0.05625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:51.975072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5888074536046494, "overlap_percentage": 0.7411942237163814, "num_intersection": 77606, "num_union": 131802, "num_only_computed": 27098, "num_only_roped": 27098, "total_diff": 54196, "diff_percentage": 0.4111925463953506, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:52.257320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.392578125, "l2_diff_relative": 0.0821078431372549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:01.421767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5565355343252706, "overlap_percentage": 0.7150951867816092, "num_intersection": 79633, "num_union": 143087, "num_only_computed": 31727, "num_only_roped": 31727, "total_diff": 63454, "diff_percentage": 0.44346446567472936, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:03.154427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.06699101796407185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:13.396288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.519297634483515, "overlap_percentage": 0.6836022418478261, "num_intersection": 80501, "num_union": 155019, "num_only_computed": 37259, "num_only_roped": 37259, "total_diff": 74518, "diff_percentage": 0.4807023655164851, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:13.751001", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.09060650887573965}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:27.611283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46589061432240736, "overlap_percentage": 0.6356417181069959, "num_intersection": 79084, "num_union": 169748, "num_only_computed": 45332, "num_only_roped": 45332, "total_diff": 90664, "diff_percentage": 0.5341093856775927, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:30.337713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.298828125, "l2_diff_relative": 0.05726047904191617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:42.986569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43679912304741025, "overlap_percentage": 0.6080169677734375, "num_intersection": 79694, "num_union": 182450, "num_only_computed": 51378, "num_only_roped": 51378, "total_diff": 102756, "diff_percentage": 0.5632008769525898, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:44.590472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.314453125, "l2_diff_relative": 0.06534090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:58.362337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40452399926439037, "overlap_percentage": 0.5760300279329609, "num_intersection": 79188, "num_union": 195756, "num_only_computed": 58284, "num_only_roped": 58284, "total_diff": 116568, "diff_percentage": 0.5954760007356097, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:59:59.078742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:13.903705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38193289195499286, "overlap_percentage": 0.5527517206927176, "num_intersection": 79667, "num_union": 208589, "num_only_computed": 64461, "num_only_roped": 64461, "total_diff": 128922, "diff_percentage": 0.6180671080450072, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:14.413133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 8.7738037109375e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.16477272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:30.471559", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3675039745627981, "overlap_percentage": 0.5374813988095238, "num_intersection": 80906, "num_union": 220150, "num_only_computed": 69622, "num_only_roped": 69622, "total_diff": 139244, "diff_percentage": 0.632496025437202, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:31.014165", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.13541666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:48.846499", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35293510070580136, "overlap_percentage": 0.5217324918566775, "num_intersection": 82008, "num_union": 232360, "num_only_computed": 75176, "num_only_roped": 75176, "total_diff": 150352, "diff_percentage": 0.6470648992941986, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:49.436772", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 8.0108642578125e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.15900735294117646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:07.748056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3389832586230146, "overlap_percentage": 0.506329345703125, "num_intersection": 82957, "num_union": 244723, "num_only_computed": 80883, "num_only_roped": 80883, "total_diff": 161766, "diff_percentage": 0.6610167413769854, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:09.136730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 7.486343383789062e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.14758064516129032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:28.693182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3385331488237514, "overlap_percentage": 0.505827067669173, "num_intersection": 86112, "num_union": 254368, "num_only_computed": 84128, "num_only_roped": 84128, "total_diff": 168256, "diff_percentage": 0.6614668511762486, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:29.357376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.2470703125, "l2_diff_relative": 0.0454382183908046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:50.137918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3192677860933054, "overlap_percentage": 0.4840075524602026, "num_intersection": 85619, "num_union": 268173, "num_only_computed": 91277, "num_only_roped": 91277, "total_diff": 182554, "diff_percentage": 0.6807322139066946, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:50.825925", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.42578125, "l2_diff_relative": 0.09332191780821918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:02:13.850328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30289158681868583, "overlap_percentage": 0.4649528631284916, "num_intersection": 85224, "num_union": 281368, "num_only_computed": 98072, "num_only_roped": 98072, "total_diff": 196144, "diff_percentage": 0.6971084131813141, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:02:14.592659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.36328125, "l2_diff_relative": 0.08244680851063829}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:02:37.706663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2942374844567087, "overlap_percentage": 0.45468855289757415, "num_intersection": 86369, "num_union": 293535, "num_only_computed": 103583, "num_only_roped": 103583, "total_diff": 207166, "diff_percentage": 0.7057625155432913, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:02:38.482853", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.1358695652173913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:02.841562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28447391631006436, "overlap_percentage": 0.4429423014322917, "num_intersection": 87086, "num_union": 306130, "num_only_computed": 109522, "num_only_roped": 109522, "total_diff": 219044, "diff_percentage": 0.7155260836899356, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:03.649462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.14134615384615384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:29.382787", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27882277348720597, "overlap_percentage": 0.43606163303909207, "num_intersection": 88524, "num_union": 317492, "num_only_computed": 114484, "num_only_roped": 114484, "total_diff": 228968, "diff_percentage": 0.721177226512794, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:30.252726", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.14634146341463414}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:57.294071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2633748203584696, "overlap_percentage": 0.4169385302197802, "num_intersection": 87417, "num_union": 331911, "num_only_computed": 122247, "num_only_roped": 122247, "total_diff": 244494, "diff_percentage": 0.7366251796415304, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:58.183652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07763671875, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.1446917808219178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:04:26.812072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2562700413109016, "overlap_percentage": 0.4079855968601896, "num_intersection": 88151, "num_union": 343977, "num_only_computed": 127913, "num_only_roped": 127913, "total_diff": 255826, "diff_percentage": 0.7437299586890984, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:04:27.779140", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.22542735042735043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:04:57.857929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24678814342094216, "overlap_percentage": 0.39587823275862066, "num_intersection": 88170, "num_union": 357270, "num_only_computed": 134550, "num_only_roped": 134550, "total_diff": 269100, "diff_percentage": 0.7532118565790579, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:04:58.859562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.2125984251968504}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:05:30.085526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2405743800535439, "overlap_percentage": 0.38784354073660715, "num_intersection": 88962, "num_union": 369790, "num_only_computed": 140414, "num_only_roped": 140414, "total_diff": 280828, "diff_percentage": 0.7594256199464561, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:05:32.633889", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.2060546875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:06:04.950070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2366468667636993, "overlap_percentage": 0.38272343241042345, "num_intersection": 90237, "num_union": 381315, "num_only_computed": 145539, "num_only_roped": 145539, "total_diff": 291078, "diff_percentage": 0.7633531332363007, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:06:06.046743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 5.698204040527344e-05, "l2_diff": 0.83984375, "l2_diff_relative": 0.24321266968325791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:06:39.891178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2351492147597152, "overlap_percentage": 0.38076244060190073, "num_intersection": 92309, "num_union": 392555, "num_only_computed": 150123, "num_only_roped": 150123, "total_diff": 300246, "diff_percentage": 0.7648507852402848, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:06:42.456309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.9453125, "l2_diff_relative": 0.26419213973799127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:07:17.596406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22999962926805156, "overlap_percentage": 0.37398324974279834, "num_intersection": 93059, "num_union": 404605, "num_only_computed": 155773, "num_only_roped": 155773, "total_diff": 311546, "diff_percentage": 0.7700003707319485, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:07:18.788246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.793571472167969e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.26851851851851855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:07:55.381157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22467194746365957, "overlap_percentage": 0.3669096004509018, "num_intersection": 93741, "num_union": 417235, "num_only_computed": 161747, "num_only_roped": 161747, "total_diff": 323494, "diff_percentage": 0.7753280525363404, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:07:56.598352", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.26004464285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:08:34.976685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2179799608323247, "overlap_percentage": 0.3579368591308594, "num_intersection": 93831, "num_union": 430457, "num_only_computed": 168313, "num_only_roped": 168313, "total_diff": 336626, "diff_percentage": 0.7820200391676753, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:08:36.238466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 5.269050598144531e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.2545662100456621}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:15.721835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2139639486918687, "overlap_percentage": 0.35250461749285034, "num_intersection": 94663, "num_union": 442425, "num_only_computed": 173881, "num_only_roped": 173881, "total_diff": 347762, "diff_percentage": 0.7860360513081314, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:17.021862", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.24030172413793102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:57.652764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21263128209760537, "overlap_percentage": 0.3506940406976744, "num_intersection": 96511, "num_union": 453889, "num_only_computed": 178689, "num_only_roped": 178689, "total_diff": 357378, "diff_percentage": 0.7873687179023946, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:59.011065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.982948303222656e-05, "l2_diff": 0.90234375, "l2_diff_relative": 0.240625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:10:40.492849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21015481472727468, "overlap_percentage": 0.3473188920454545, "num_intersection": 97805, "num_union": 465395, "num_only_computed": 183795, "num_only_roped": 183795, "total_diff": 367590, "diff_percentage": 0.7898451852727253, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:10:41.868931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.9453125, "l2_diff_relative": 0.2762557077625571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:11:25.423610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20234164979113267, "overlap_percentage": 0.33657929063055064, "num_intersection": 97021, "num_union": 479491, "num_only_computed": 191235, "num_only_roped": 191235, "total_diff": 382470, "diff_percentage": 0.7976583502088673, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:11:26.858372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.35609756097560974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:12:11.059701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1942948318174087, "overlap_percentage": 0.3253716362847222, "num_intersection": 95956, "num_union": 493868, "num_only_computed": 198956, "num_only_roped": 198956, "total_diff": 397912, "diff_percentage": 0.8057051681825913, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:12:15.146511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10009765625, "mean_diff": 6.103515625e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.3640776699029126}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:13:01.859374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1875604742958378, "overlap_percentage": 0.31587523895497027, "num_intersection": 95177, "num_union": 507447, "num_only_computed": 206135, "num_only_roped": 206135, "total_diff": 412270, "diff_percentage": 0.8124395257041622, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:13:03.426642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 7.62939453125e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.5572289156626506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:13:50.666302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1739090659591986, "overlap_percentage": 0.2962905236907731, "num_intersection": 91248, "num_union": 524688, "num_only_computed": 216720, "num_only_roped": 216720, "total_diff": 433440, "diff_percentage": 0.8260909340408014, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:13:52.240800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 8.58306884765625e-05, "l2_diff": 1.8515625, "l2_diff_relative": 0.6970588235294117}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:14:40.778744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16469043089411317, "overlap_percentage": 0.28280550183224756, "num_intersection": 88905, "num_union": 539831, "num_only_computed": 225463, "num_only_roped": 225463, "total_diff": 450926, "diff_percentage": 0.8353095691058868, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:14:44.944339", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 8.869171142578125e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.7668711656441718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:15:37.522093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16277654626852697, "overlap_percentage": 0.27997906698564595, "num_intersection": 89880, "num_union": 552168, "num_only_computed": 231144, "num_only_roped": 231144, "total_diff": 462288, "diff_percentage": 0.837223453731473, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:15:40.873271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 9.870529174804688e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.9072847682119205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:16:34.336913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15638840364900394, "overlap_percentage": 0.270477294921875, "num_intersection": 88630, "num_union": 566730, "num_only_computed": 239050, "num_only_roped": 239050, "total_diff": 478100, "diff_percentage": 0.843611596350996, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:16:37.941598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 9.393692016601562e-05, "l2_diff": 1.9609375, "l2_diff_relative": 0.8715277777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:17:32.943907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15399362346674772, "overlap_percentage": 0.2668881704980843, "num_intersection": 89162, "num_union": 578998, "num_only_computed": 244918, "num_only_roped": 244918, "total_diff": 489836, "diff_percentage": 0.8460063765332523, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:17:34.790506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 9.632110595703125e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.9148936170212766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:18:30.988464", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15483568122853128, "overlap_percentage": 0.26815188298271975, "num_intersection": 91369, "num_union": 590103, "num_only_computed": 249367, "num_only_roped": 249367, "total_diff": 498734, "diff_percentage": 0.8451643187714687, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:18:32.811594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 9.012222290039062e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.8203592814371258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:19:30.534511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1500453046343245, "overlap_percentage": 0.26093807614306785, "num_intersection": 90581, "num_union": 603691, "num_only_computed": 256555, "num_only_roped": 256555, "total_diff": 513110, "diff_percentage": 0.8499546953656755, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:19:32.465702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 8.726119995117188e-05, "l2_diff": 1.9453125, "l2_diff_relative": 0.819078947368421}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:20:34.201298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1495505506627611, "overlap_percentage": 0.26018960293053545, "num_intersection": 92053, "num_union": 615531, "num_only_computed": 261739, "num_only_roped": 261739, "total_diff": 523478, "diff_percentage": 0.8504494493372389, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:20:36.155068", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 8.96453857421875e-05, "l2_diff": 1.921875, "l2_diff_relative": 0.8913043478260869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:21:36.234044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15531167465832457, "overlap_percentage": 0.2688654119318182, "num_intersection": 96912, "num_union": 623984, "num_only_computed": 263536, "num_only_roped": 263536, "total_diff": 527072, "diff_percentage": 0.8446883253416754, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:21:40.656143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 8.392333984375e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.8271604938271605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:22:41.441825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15657423900878037, "overlap_percentage": 0.2707551901605024, "num_intersection": 99326, "num_union": 634370, "num_only_computed": 267522, "num_only_roped": 267522, "total_diff": 535044, "diff_percentage": 0.8434257609912197, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:22:43.441122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 8.726119995117188e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.8851351351351351}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:23:45.918316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15407777504839504, "overlap_percentage": 0.2670145433516107, "num_intersection": 99731, "num_union": 647277, "num_only_computed": 273773, "num_only_roped": 273773, "total_diff": 547546, "diff_percentage": 0.845922224951605, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:23:47.986406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 8.296966552734375e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.81875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:24:51.902335", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14930177400227498, "overlap_percentage": 0.25981300539083557, "num_intersection": 98704, "num_union": 661104, "num_only_computed": 281200, "num_only_roped": 281200, "total_diff": 562400, "diff_percentage": 0.850698225997725, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:24:56.640879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.8178571428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:26:02.892350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.145427446285865, "overlap_percentage": 0.25392694536423843, "num_intersection": 98158, "num_union": 674962, "num_only_computed": 288402, "num_only_roped": 288402, "total_diff": 576804, "diff_percentage": 0.854572553714135, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:26:05.942717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.75, "l2_diff_relative": 0.7671232876712328}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:27:13.316118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14720838840117983, "overlap_percentage": 0.2566375732421875, "num_intersection": 100914, "num_union": 685518, "num_only_computed": 292302, "num_only_roped": 292302, "total_diff": 584604, "diff_percentage": 0.8527916115988201, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:27:15.686614", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 8.392333984375e-05, "l2_diff": 1.9296875, "l2_diff_relative": 0.8821428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:28:24.401704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15414729807202157, "overlap_percentage": 0.26711893417680976, "num_intersection": 106745, "num_union": 692487, "num_only_computed": 292871, "num_only_roped": 292871, "total_diff": 585742, "diff_percentage": 0.8458527019279785, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:28:26.645531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.6953125, "l2_diff_relative": 0.7534722222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:29:37.009736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15019860200045865, "overlap_percentage": 0.2611698566477631, "num_intersection": 106106, "num_union": 706438, "num_only_computed": 300166, "num_only_roped": 300166, "total_diff": 600332, "diff_percentage": 0.8498013979995414, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:29:39.340646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.05718994140625e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.7627118644067796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:30:51.253532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15327722591039486, "overlap_percentage": 0.26581158886476425, "num_intersection": 109693, "num_union": 715651, "num_only_computed": 302979, "num_only_roped": 302979, "total_diff": 605958, "diff_percentage": 0.8467227740896052, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:30:53.615917", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.009506225585938e-05, "l2_diff": 1.90625, "l2_diff_relative": 0.6853932584269663}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:32:07.765311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14522617594284357, "overlap_percentage": 0.25362007783882784, "num_intersection": 106350, "num_union": 732306, "num_only_computed": 312978, "num_only_roped": 312978, "total_diff": 625956, "diff_percentage": 0.8547738240571564, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:32:10.230572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 6.103515625e-05, "l2_diff": 1.875, "l2_diff_relative": 0.5853658536585366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:33:25.761436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1469728606873749, "overlap_percentage": 0.25627957857572115, "num_intersection": 109171, "num_union": 742797, "num_only_computed": 316813, "num_only_roped": 316813, "total_diff": 633626, "diff_percentage": 0.8530271393126251, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:33:29.764173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.859375, "l2_diff_relative": 0.601010101010101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:34:46.734803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13921819444096806, "overlap_percentage": 0.24441006142687982, "num_intersection": 105679, "num_union": 759089, "num_only_computed": 326705, "num_only_roped": 326705, "total_diff": 653410, "diff_percentage": 0.8607818055590319, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:34:49.258992", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.6796875, "l2_diff_relative": 0.7026143790849673}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:36:06.798372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1402006083414059, "overlap_percentage": 0.2459227039798705, "num_intersection": 64115, "num_union": 457309, "num_only_computed": 196597, "num_only_roped": 196597, "total_diff": 393194, "diff_percentage": 0.8597993916585941, "num_computed": 260712, "num_roped": 260712}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:36:09.255523", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.5162337662337663}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:37:20.012244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1364689238109769, "overlap_percentage": 0.24016305409099786, "num_intersection": 9839, "num_union": 72097, "num_only_computed": 31129, "num_only_roped": 31129, "total_diff": 62258, "diff_percentage": 0.8635310761890231, "num_computed": 40968, "num_roped": 40968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:37:22.147352", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12451171875, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.4800796812749004}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:20.918831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1330899435778294, "overlap_percentage": 0.23491505565319273, "num_intersection": 401, "num_union": 3013, "num_only_computed": 1306, "num_only_roped": 1306, "total_diff": 2612, "diff_percentage": 0.8669100564221706, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:23.421906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.31601731601731603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:55.483792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:55.498409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.018310546875, "l2_diff_relative": 0.003067735602094241}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:57.608915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8588034717916925, "overlap_percentage": 0.9240390227632785, "num_intersection": 72033, "num_union": 83876, "num_only_computed": 6559, "num_only_roped": 5284, "total_diff": 11843, "diff_percentage": 0.1411965282083075, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:57.744786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.793571472167969e-05, "l2_diff": 0.10205078125, "l2_diff_relative": 0.021626655629139072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:02.524533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7328508078903104, "overlap_percentage": 0.8458325489457831, "num_intersection": 71889, "num_union": 98095, "num_only_computed": 13103, "num_only_roped": 13103, "total_diff": 26206, "diff_percentage": 0.26714919210968957, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:03.459376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 0.0001277923583984375, "l2_diff": 0.2890625, "l2_diff_relative": 0.06514084507042253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:09.255036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6649347818188425, "overlap_percentage": 0.7987517458100558, "num_intersection": 73204, "num_union": 110092, "num_only_computed": 18444, "num_only_roped": 18444, "total_diff": 36888, "diff_percentage": 0.3350652181811576, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:09.464122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 0.00012493133544921875, "l2_diff": 0.337890625, "l2_diff_relative": 0.07066993464052287}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:16.367207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6049501636721333, "overlap_percentage": 0.7538553873697916, "num_intersection": 74107, "num_union": 122501, "num_only_computed": 24197, "num_only_roped": 24197, "total_diff": 48394, "diff_percentage": 0.3950498363278667, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:17.349297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.314453125, "l2_diff_relative": 0.06620065789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:25.216788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5627346064581608, "overlap_percentage": 0.7201921607579462, "num_intersection": 75407, "num_union": 134001, "num_only_computed": 29297, "num_only_roped": 29297, "total_diff": 58594, "diff_percentage": 0.43726539354183924, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:25.493799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 0.00010395050048828125, "l2_diff": 0.419921875, "l2_diff_relative": 0.09463028169014084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:35.214225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5313741938145464, "overlap_percentage": 0.6939834770114942, "num_intersection": 77282, "num_union": 145438, "num_only_computed": 34078, "num_only_roped": 34078, "total_diff": 68156, "diff_percentage": 0.4686258061854536, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:35.520279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 0.00011920928955078125, "l2_diff": 0.60546875, "l2_diff_relative": 0.1354895104895105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:45.591556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49263568839201965, "overlap_percentage": 0.6600883152173913, "num_intersection": 77732, "num_union": 157788, "num_only_computed": 40028, "num_only_roped": 40028, "total_diff": 80056, "diff_percentage": 0.5073643116079803, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:45.934760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 0.00011920928955078125, "l2_diff": 0.69140625, "l2_diff_relative": 0.15051020408163265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:57.169504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45853555602447776, "overlap_percentage": 0.6287615740740741, "num_intersection": 78228, "num_union": 170604, "num_only_computed": 46188, "num_only_roped": 46188, "total_diff": 92376, "diff_percentage": 0.5414644439755223, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:59.099873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.345703125, "l2_diff_relative": 0.07682291666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:11.581062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4368857535943521, "overlap_percentage": 0.6081008911132812, "num_intersection": 79705, "num_union": 182439, "num_only_computed": 51367, "num_only_roped": 51367, "total_diff": 102734, "diff_percentage": 0.5631142464056479, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:13.618369", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.455078125, "l2_diff_relative": 0.10707720588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:27.402392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41366651241709085, "overlap_percentage": 0.5852391759776536, "num_intersection": 80454, "num_union": 194490, "num_only_computed": 57018, "num_only_roped": 57018, "total_diff": 114036, "diff_percentage": 0.5863334875829092, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:27.864014", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06396484375, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.40234375, "l2_diff_relative": 0.09537037037037037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:42.944104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38701311199326355, "overlap_percentage": 0.5580525643872114, "num_intersection": 80431, "num_union": 207825, "num_only_computed": 63697, "num_only_roped": 63697, "total_diff": 127394, "diff_percentage": 0.6129868880067364, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:43.461707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 9.059906005859375e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.16125954198473283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:59.591816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3706356107754715, "overlap_percentage": 0.5408229698129252, "num_intersection": 81409, "num_union": 219647, "num_only_computed": 69119, "num_only_roped": 69119, "total_diff": 138238, "diff_percentage": 0.6293643892245284, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:00.148363", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.000102996826171875, "l2_diff": 0.765625, "l2_diff_relative": 0.20416666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:17.490924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34984456314514883, "overlap_percentage": 0.5183479234527687, "num_intersection": 81476, "num_union": 232892, "num_only_computed": 75708, "num_only_roped": 75708, "total_diff": 151416, "diff_percentage": 0.6501554368548512, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:18.084236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 7.915496826171875e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.15988372093023256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:36.534805", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3397606518903758, "overlap_percentage": 0.507196044921875, "num_intersection": 83099, "num_union": 244581, "num_only_computed": 80741, "num_only_roped": 80741, "total_diff": 161482, "diff_percentage": 0.6602393481096243, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:37.153132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 8.392333984375e-05, "l2_diff": 0.6328125, "l2_diff_relative": 0.18}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:56.885944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33681987011865216, "overlap_percentage": 0.5039121240601504, "num_intersection": 85786, "num_union": 254694, "num_only_computed": 84454, "num_only_roped": 84454, "total_diff": 168908, "diff_percentage": 0.6631801298813478, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:57.550657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 5.340576171875e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.12147887323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:18.531672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3155395581799184, "overlap_percentage": 0.47971124276411, "num_intersection": 84859, "num_union": 268933, "num_only_computed": 92037, "num_only_roped": 92037, "total_diff": 184074, "diff_percentage": 0.6844604418200816, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:19.231570", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 7.82012939453125e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.21058558558558557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:41.880328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30704916337758004, "overlap_percentage": 0.4698356756284916, "num_intersection": 86119, "num_union": 280473, "num_only_computed": 97177, "num_only_roped": 97177, "total_diff": 194354, "diff_percentage": 0.69295083662242, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:42.622907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.2265625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:05.925893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30449891149828656, "overlap_percentage": 0.46684425539083557, "num_intersection": 88678, "num_union": 291226, "num_only_computed": 101274, "num_only_roped": 101274, "total_diff": 202548, "diff_percentage": 0.6955010885017134, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:06.711513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.18514644351464435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:31.337256", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29446156277158886, "overlap_percentage": 0.4549560546875, "num_intersection": 89448, "num_union": 303768, "num_only_computed": 107160, "num_only_roped": 107160, "total_diff": 214320, "diff_percentage": 0.7055384372284111, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:32.165243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.13333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:58.081157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2851983274087814, "overlap_percentage": 0.44381994798234553, "num_intersection": 90099, "num_union": 315917, "num_only_computed": 112909, "num_only_roped": 112909, "total_diff": 225818, "diff_percentage": 0.7148016725912186, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:58.932158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.57763671875e-05, "l2_diff": 0.55078125, "l2_diff_relative": 0.13932806324110672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:44:26.151711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2771307441157838, "overlap_percentage": 0.4339896214896215, "num_intersection": 90992, "num_union": 328336, "num_only_computed": 118672, "num_only_roped": 118672, "total_diff": 237344, "diff_percentage": 0.7228692558842161, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:44:27.051480", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.734375, "l2_diff_relative": 0.17938931297709923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:44:55.796131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26696630926517195, "overlap_percentage": 0.4214260589454976, "num_intersection": 91055, "num_union": 341073, "num_only_computed": 125009, "num_only_roped": 125009, "total_diff": 250018, "diff_percentage": 0.733033690734828, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:44:56.750068", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.57763671875e-05, "l2_diff": 0.6640625, "l2_diff_relative": 0.15625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:45:26.854193", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2592726614800072, "overlap_percentage": 0.4117816091954023, "num_intersection": 91712, "num_union": 353728, "num_only_computed": 131008, "num_only_roped": 131008, "total_diff": 262016, "diff_percentage": 0.7407273385199927, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:45:27.844083", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:45:59.887492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25387640864029826, "overlap_percentage": 0.4049464634486607, "num_intersection": 92885, "num_union": 365867, "num_only_computed": 136491, "num_only_roped": 136491, "total_diff": 272982, "diff_percentage": 0.7461235913597017, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:46:00.917675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 5.936622619628906e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.2294238683127572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:46:33.330642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2498495840036895, "overlap_percentage": 0.3998074443539631, "num_intersection": 94265, "num_union": 377287, "num_only_computed": 141511, "num_only_roped": 141511, "total_diff": 283022, "diff_percentage": 0.7501504159963105, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:46:34.399336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.177734375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:47:08.195756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23273120193224434, "overlap_percentage": 0.37758629223864837, "num_intersection": 91539, "num_union": 393325, "num_only_computed": 150893, "num_only_roped": 150893, "total_diff": 301786, "diff_percentage": 0.7672687980677557, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:47:10.320538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.13214285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:47:45.531307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23783466486255236, "overlap_percentage": 0.3842753343621399, "num_intersection": 95620, "num_union": 402044, "num_only_computed": 153212, "num_only_roped": 153212, "total_diff": 306424, "diff_percentage": 0.7621653351374477, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:47:46.691085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.734375, "l2_diff_relative": 0.18359375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:48:23.039730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2378774371099655, "overlap_percentage": 0.3843311623246493, "num_intersection": 98192, "num_union": 412784, "num_only_computed": 157296, "num_only_roped": 157296, "total_diff": 314592, "diff_percentage": 0.7621225628900345, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:48:24.256421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.15257352941176472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:49:01.878095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22605191956466328, "overlap_percentage": 0.3687477111816406, "num_intersection": 96665, "num_union": 427623, "num_only_computed": 165479, "num_only_roped": 165479, "total_diff": 330958, "diff_percentage": 0.7739480804353367, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:49:03.128527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.80859375, "l2_diff_relative": 0.2086693548387097}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:49:42.254194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22176802040041038, "overlap_percentage": 0.363028032650143, "num_intersection": 97489, "num_union": 439599, "num_only_computed": 171055, "num_only_roped": 171055, "total_diff": 342110, "diff_percentage": 0.7782319795995897, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:49:43.719132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.51171875, "l2_diff_relative": 0.11293103448275862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:50:24.550465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2105696099520083, "overlap_percentage": 0.34788517441860467, "num_intersection": 95738, "num_union": 454662, "num_only_computed": 179462, "num_only_roped": 179462, "total_diff": 358924, "diff_percentage": 0.7894303900479916, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:50:25.893531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:51:08.335847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2030640537619249, "overlap_percentage": 0.337578125, "num_intersection": 95062, "num_union": 468138, "num_only_computed": 186538, "num_only_roped": 186538, "total_diff": 373076, "diff_percentage": 0.7969359462380751, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:51:09.714065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.20397489539748953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:51:53.979113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19924780749197052, "overlap_percentage": 0.33228796625222023, "num_intersection": 95784, "num_union": 480728, "num_only_computed": 192472, "num_only_roped": 192472, "total_diff": 384944, "diff_percentage": 0.8007521925080295, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:51:55.445953", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 5.054473876953125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.3039647577092511}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:52:40.256492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18879698157016397, "overlap_percentage": 0.317626953125, "num_intersection": 93672, "num_union": 496152, "num_only_computed": 201240, "num_only_roped": 201240, "total_diff": 402480, "diff_percentage": 0.811203018429836, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:52:43.856963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.4282051282051282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:53:30.453376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17608807233453747, "overlap_percentage": 0.29944708474936277, "num_intersection": 90227, "num_union": 512397, "num_only_computed": 211085, "num_only_roped": 211085, "total_diff": 422170, "diff_percentage": 0.8239119276654625, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:53:31.950776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 8.726119995117188e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.6428571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:54:19.485324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17028904963035163, "overlap_percentage": 0.2910204956359102, "num_intersection": 89625, "num_union": 526311, "num_only_computed": 218343, "num_only_roped": 218343, "total_diff": 436686, "diff_percentage": 0.8297109503696484, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:54:21.069474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 0.0001010894775390625, "l2_diff": 2.1875, "l2_diff_relative": 0.9271523178807947}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:55:10.479499", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.159560989194403, "overlap_percentage": 0.2752093088355049, "num_intersection": 86517, "num_union": 542219, "num_only_computed": 227851, "num_only_roped": 227851, "total_diff": 455702, "diff_percentage": 0.840439010805597, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:55:13.012468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 9.250640869140625e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.7634730538922155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:56:04.953062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15589769809921253, "overlap_percentage": 0.269743072169059, "num_intersection": 86594, "num_union": 555454, "num_only_computed": 234430, "num_only_roped": 234430, "total_diff": 468860, "diff_percentage": 0.8441023019007875, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:56:06.630463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 9.775161743164062e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.9121621621621622}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:56:58.839577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15281237246872406, "overlap_percentage": 0.2651123046875, "num_intersection": 86872, "num_union": 568488, "num_only_computed": 240808, "num_only_roped": 240808, "total_diff": 481616, "diff_percentage": 0.847187627531276, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:57:00.573625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 0.00010442733764648438, "l2_diff": 2.28125, "l2_diff_relative": 1.0}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:57:53.251270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15188282571255682, "overlap_percentage": 0.26371228448275863, "num_intersection": 88101, "num_union": 580059, "num_only_computed": 245979, "num_only_roped": 245979, "total_diff": 491958, "diff_percentage": 0.8481171742874432, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:57:54.959145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 9.679794311523438e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.959731543624161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:58:49.428256", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15241992762201104, "overlap_percentage": 0.26452150638617583, "num_intersection": 90132, "num_union": 591340, "num_only_computed": 250604, "num_only_roped": 250604, "total_diff": 501208, "diff_percentage": 0.8475800723779889, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:58:51.257049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 8.392333984375e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.7068062827225131}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:59:46.577950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14916585699317889, "overlap_percentage": 0.25960718565634217, "num_intersection": 90119, "num_union": 604153, "num_only_computed": 257017, "num_only_roped": 257017, "total_diff": 514034, "diff_percentage": 0.8508341430068211, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:59:48.398949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.43865966796875e-05, "l2_diff": 1.859375, "l2_diff_relative": 0.5639810426540285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:00:47.361968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14643828114620497, "overlap_percentage": 0.2554664887843705, "num_intersection": 90382, "num_union": 617202, "num_only_computed": 263410, "num_only_roped": 263410, "total_diff": 526820, "diff_percentage": 0.8535617188537951, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:00:49.927337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.6595744680851063}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:47.219474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14329395457565938, "overlap_percentage": 0.2506686123934659, "num_intersection": 90353, "num_union": 630543, "num_only_computed": 270095, "num_only_roped": 270095, "total_diff": 540190, "diff_percentage": 0.8567060454243406, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:49.103157", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.8828125, "l2_diff_relative": 0.6308900523560209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:02:47.737251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1444883468082219, "overlap_percentage": 0.2524942210397767, "num_intersection": 92627, "num_union": 641069, "num_only_computed": 274221, "num_only_roped": 274221, "total_diff": 548442, "diff_percentage": 0.8555116531917781, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:02:49.647574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 7.104873657226562e-05, "l2_diff": 1.8984375, "l2_diff_relative": 0.5869565217391305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:03:51.176511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14865991112204574, "overlap_percentage": 0.258840601439342, "num_intersection": 96678, "num_union": 650330, "num_only_computed": 276826, "num_only_roped": 276826, "total_diff": 553652, "diff_percentage": 0.8513400888779543, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:03:53.200167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 7.295608520507812e-05, "l2_diff": 1.8671875, "l2_diff_relative": 0.6322751322751323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:04:55.900332", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15109866802409433, "overlap_percentage": 0.26252948113207547, "num_intersection": 99736, "num_union": 660072, "num_only_computed": 280168, "num_only_roped": 280168, "total_diff": 560336, "diff_percentage": 0.8489013319759057, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:04:59.366489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.7064516129032258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:06:03.714301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15065084283626384, "overlap_percentage": 0.26185326986754964, "num_intersection": 101222, "num_union": 671898, "num_only_computed": 285338, "num_only_roped": 285338, "total_diff": 570676, "diff_percentage": 0.8493491571637362, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:06:07.155355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.915496826171875e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.8986486486486487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:07:14.519118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14947541970808254, "overlap_percentage": 0.2600758870442708, "num_intersection": 102266, "num_union": 684166, "num_only_computed": 290950, "num_only_roped": 290950, "total_diff": 581900, "diff_percentage": 0.8505245802919175, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:07:19.183495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.5916230366492147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:08:27.706628", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1495027219054057, "overlap_percentage": 0.2601172125240231, "num_intersection": 103947, "num_union": 695285, "num_only_computed": 295669, "num_only_roped": 295669, "total_diff": 591338, "diff_percentage": 0.8504972780945943, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:08:29.965337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.5234375, "l2_diff_relative": 0.5213903743315508}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:09:40.295955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14512169341995856, "overlap_percentage": 0.2534607356647763, "num_intersection": 102974, "num_union": 709570, "num_only_computed": 303298, "num_only_roped": 303298, "total_diff": 606596, "diff_percentage": 0.8548783065800414, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:09:42.606804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.5448717948717948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:10:54.345936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1378546386508049, "overlap_percentage": 0.24230623836848636, "num_intersection": 99993, "num_union": 725351, "num_only_computed": 312679, "num_only_roped": 312679, "total_diff": 625358, "diff_percentage": 0.8621453613491951, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:10:58.577311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.47619047619047616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:12:12.836245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13792134945801057, "overlap_percentage": 0.24240928342490842, "num_intersection": 101649, "num_union": 737007, "num_only_computed": 317679, "num_only_roped": 317679, "total_diff": 635358, "diff_percentage": 0.8620786505419894, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:12:15.286469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.7664473684210527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:30.413322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13883783382769485, "overlap_percentage": 0.24382371168870193, "num_intersection": 103865, "num_union": 748103, "num_only_computed": 322119, "num_only_roped": 322119, "total_diff": 644238, "diff_percentage": 0.8611621661723051, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:34.096280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.866455078125e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.8211678832116789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:14:50.555192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13457282041257052, "overlap_percentage": 0.23722200636471286, "num_intersection": 102571, "num_union": 762197, "num_only_computed": 329813, "num_only_roped": 329813, "total_diff": 659626, "diff_percentage": 0.8654271795874295, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:14:55.083285", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.6480263157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:16:14.678069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13534996688010598, "overlap_percentage": 0.2384286269933878, "num_intersection": 102984, "num_union": 760872, "num_only_computed": 328944, "num_only_roped": 328944, "total_diff": 657888, "diff_percentage": 0.864650033119894, "num_computed": 431928, "num_roped": 431928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:16:18.118423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.079673767089844e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.630057803468208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:17:32.579466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12782849523028003, "overlap_percentage": 0.22668073341094297, "num_intersection": 12462, "num_union": 97490, "num_only_computed": 42514, "num_only_roped": 42514, "total_diff": 85028, "diff_percentage": 0.8721715047697199, "num_computed": 54976, "num_roped": 54976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:17:34.758549", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.443359375, "l2_diff_relative": 0.4172794117647059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:36.050472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1351172778328378, "overlap_percentage": 0.23806752037252618, "num_intersection": 409, "num_union": 3027, "num_only_computed": 1309, "num_only_roped": 1309, "total_diff": 2618, "diff_percentage": 0.8648827221671622, "num_computed": 1718, "num_roped": 1718}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:38.789377", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.049072265625, "mean_diff": 7.534027099609375e-05, "l2_diff": 0.10546875, "l2_diff_relative": 0.8925619834710744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:11.755228", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:11.769723", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.138448715209961e-05, "l2_diff": 0.018310546875, "l2_diff_relative": 0.0031502016129032256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:13.895002", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8586040412469452, "overlap_percentage": 0.9239235708009159, "num_intersection": 72024, "num_union": 83885, "num_only_computed": 6568, "num_only_roped": 5293, "total_diff": 11861, "diff_percentage": 0.14139595875305477, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:14.034944", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.1708984375, "l2_diff_relative": 0.03771551724137931}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:19.974838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7303459999796411, "overlap_percentage": 0.8441618034638554, "num_intersection": 71747, "num_union": 98237, "num_only_computed": 13245, "num_only_roped": 13245, "total_diff": 26490, "diff_percentage": 0.26965400002035894, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:20.149199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 0.000209808349609375, "l2_diff": 0.388671875, "l2_diff_relative": 0.09212962962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:26.064502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6483453237410072, "overlap_percentage": 0.7866620111731844, "num_intersection": 72096, "num_union": 111200, "num_only_computed": 19552, "num_only_roped": 19552, "total_diff": 39104, "diff_percentage": 0.3516546762589928, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:26.276078", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 0.000247955322265625, "l2_diff": 0.5546875, "l2_diff_relative": 0.15434782608695652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:34.533636", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5747410913809261, "overlap_percentage": 0.729949951171875, "num_intersection": 71757, "num_union": 124851, "num_only_computed": 26547, "num_only_roped": 26547, "total_diff": 53094, "diff_percentage": 0.42525890861907395, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:34.772784", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.0001964569091796875, "l2_diff": 0.66796875, "l2_diff_relative": 0.14540816326530612}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:42.784453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5394703953655918, "overlap_percentage": 0.7008519254278729, "num_intersection": 73382, "num_union": 136026, "num_only_computed": 31322, "num_only_roped": 31322, "total_diff": 62644, "diff_percentage": 0.4605296046344081, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:43.067229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.000255584716796875, "l2_diff": 0.87109375, "l2_diff_relative": 0.2593023255813954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:52.149377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5101606308609244, "overlap_percentage": 0.6756375718390805, "num_intersection": 75239, "num_union": 147481, "num_only_computed": 36121, "num_only_roped": 36121, "total_diff": 72242, "diff_percentage": 0.48983936913907555, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:52.457067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 0.00014781951904296875, "l2_diff": 0.65625, "l2_diff_relative": 0.16030534351145037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:02.767962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47508846647668557, "overlap_percentage": 0.644149116847826, "num_intersection": 75855, "num_union": 159665, "num_only_computed": 41905, "num_only_roped": 41905, "total_diff": 83810, "diff_percentage": 0.5249115335233144, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:03.117393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 9.5367431640625e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.1375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:14.362484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45182972367438384, "overlap_percentage": 0.6224279835390947, "num_intersection": 77440, "num_union": 171392, "num_only_computed": 46976, "num_only_roped": 46976, "total_diff": 93952, "diff_percentage": 0.5481702763256161, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:14.741060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.26953125, "l2_diff_relative": 0.06295620437956205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:27.095107", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4392998523057326, "overlap_percentage": 0.6104354858398438, "num_intersection": 80011, "num_union": 182133, "num_only_computed": 51061, "num_only_roped": 51061, "total_diff": 102122, "diff_percentage": 0.5607001476942673, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:28.893668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 6.4849853515625e-05, "l2_diff": 0.3671875, "l2_diff_relative": 0.09591836734693877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:42.287735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4347948608226441, "overlap_percentage": 0.606072509310987, "num_intersection": 83318, "num_union": 191626, "num_only_computed": 54154, "num_only_roped": 54154, "total_diff": 108308, "diff_percentage": 0.5652051391773559, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:42.769844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.4453125, "l2_diff_relative": 0.11046511627906977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:57.378745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4250980120729121, "overlap_percentage": 0.5965877553285968, "num_intersection": 85985, "num_union": 202271, "num_only_computed": 58143, "num_only_roped": 58143, "total_diff": 116286, "diff_percentage": 0.5749019879270879, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:57.876378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.36328125, "l2_diff_relative": 0.07648026315789473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:13.478293", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40015626744056254, "overlap_percentage": 0.5715880102040817, "num_intersection": 86040, "num_union": 215016, "num_only_computed": 64488, "num_only_roped": 64488, "total_diff": 128976, "diff_percentage": 0.5998437325594375, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:14.004523", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.08540076335877862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:31.122272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37045206852957846, "overlap_percentage": 0.5406275447882736, "num_intersection": 84978, "num_union": 229390, "num_only_computed": 72206, "num_only_roped": 72206, "total_diff": 144412, "diff_percentage": 0.6295479314704215, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:31.675814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.466796875, "l2_diff_relative": 0.12447916666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:49.358686", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3480280235806172, "overlap_percentage": 0.516351318359375, "num_intersection": 84599, "num_union": 243081, "num_only_computed": 79241, "num_only_roped": 79241, "total_diff": 158482, "diff_percentage": 0.6519719764193829, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:52.032333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 8.535385131835938e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.20232558139534884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:10.930089", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32384103642817985, "overlap_percentage": 0.4892445958646617, "num_intersection": 83289, "num_union": 257191, "num_only_computed": 86951, "num_only_roped": 86951, "total_diff": 173902, "diff_percentage": 0.6761589635718201, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:11.567209", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.936622619628906e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.13380281690140844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:31.721585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31043295639322765, "overlap_percentage": 0.4737868578147612, "num_intersection": 83811, "num_union": 269981, "num_only_computed": 93085, "num_only_roped": 93085, "total_diff": 186170, "diff_percentage": 0.6895670436067723, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:34.267613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 5.793571472167969e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.1420863309352518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:55.989041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2968307255830736, "overlap_percentage": 0.4577786749301676, "num_intersection": 83909, "num_union": 282683, "num_only_computed": 99387, "num_only_roped": 99387, "total_diff": 198774, "diff_percentage": 0.7031692744169263, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:56.692256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.376953125, "l2_diff_relative": 0.09069548872180451}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:23:18.501277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2764261787246624, "overlap_percentage": 0.4331252105795148, "num_intersection": 82273, "num_union": 297631, "num_only_computed": 107679, "num_only_roped": 107679, "total_diff": 215358, "diff_percentage": 0.7235738212753375, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:23:19.235454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.838539123535156e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.11676356589147287}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:23:42.796513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26232660569307964, "overlap_percentage": 0.4156239827473958, "num_intersection": 81715, "num_union": 311501, "num_only_computed": 114893, "num_only_roped": 114893, "total_diff": 229786, "diff_percentage": 0.7376733943069204, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:23:43.586387", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09814453125, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.7578125, "l2_diff_relative": 0.1851145038167939}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:24:08.531537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2561210283698914, "overlap_percentage": 0.407796737074401, "num_intersection": 82786, "num_union": 323230, "num_only_computed": 120222, "num_only_roped": 120222, "total_diff": 240444, "diff_percentage": 0.7438789716301086, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:24:11.123365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 5.412101745605469e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.16950757575757575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:24:37.167044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25211035034652446, "overlap_percentage": 0.4026966956654457, "num_intersection": 84431, "num_union": 334897, "num_only_computed": 125233, "num_only_roped": 125233, "total_diff": 250466, "diff_percentage": 0.7478896496534756, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:24:38.713039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.18609022556390978}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:25:06.047679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2506924526281363, "overlap_percentage": 0.40088584863744076, "num_intersection": 86617, "num_union": 345511, "num_only_computed": 129447, "num_only_roped": 129447, "total_diff": 258894, "diff_percentage": 0.7493075473718637, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:25:06.961430", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.2144230769230769}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:25:35.327224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24797229716667926, "overlap_percentage": 0.39740032327586206, "num_intersection": 88509, "num_union": 356931, "num_only_computed": 134211, "num_only_roped": 134211, "total_diff": 268422, "diff_percentage": 0.7520277028333208, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:25:36.279070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.18487394957983194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:26:05.792816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24720179433154355, "overlap_percentage": 0.39641026088169645, "num_intersection": 90927, "num_union": 367825, "num_only_computed": 138449, "num_only_roped": 138449, "total_diff": 276898, "diff_percentage": 0.7527982056684565, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:26:06.779190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.23060344827586207}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:26:37.929278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2439838972632734, "overlap_percentage": 0.39226214712269275, "num_intersection": 92486, "num_union": 379066, "num_only_computed": 143290, "num_only_roped": 143290, "total_diff": 286580, "diff_percentage": 0.7560161027367266, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:26:38.950447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 6.4849853515625e-05, "l2_diff": 0.9453125, "l2_diff_relative": 0.29086538461538464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:27:11.379458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23275314122414942, "overlap_percentage": 0.37761516631467795, "num_intersection": 91546, "num_union": 393318, "num_only_computed": 150886, "num_only_roped": 150886, "total_diff": 301772, "diff_percentage": 0.7672468587758506, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:27:12.456881", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 4.982948303222656e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.21804511278195488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:27:45.704682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24235547866723584, "overlap_percentage": 0.39015480324074076, "num_intersection": 97083, "num_union": 400581, "num_only_computed": 151749, "num_only_roped": 151749, "total_diff": 303498, "diff_percentage": 0.7576445213327642, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:27:46.821097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.2173076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:28:21.722496", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23603887778847502, "overlap_percentage": 0.38192791833667333, "num_intersection": 97578, "num_union": 413398, "num_only_computed": 157910, "num_only_roped": 157910, "total_diff": 315820, "diff_percentage": 0.763961122211525, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:28:22.860653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.245850622406639}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:28:58.807354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2310004132386641, "overlap_percentage": 0.37530517578125, "num_intersection": 98384, "num_union": 425904, "num_only_computed": 163760, "num_only_roped": 163760, "total_diff": 327520, "diff_percentage": 0.7689995867613358, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:29:01.991441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.17745098039215687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:29:39.106910", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23027304379695804, "overlap_percentage": 0.37434461391801716, "num_intersection": 100528, "num_union": 436560, "num_only_computed": 168016, "num_only_roped": 168016, "total_diff": 336032, "diff_percentage": 0.769726956203042, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:29:40.338788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.1675925925925926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:30:20.809849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2268707884829288, "overlap_percentage": 0.36983648255813956, "num_intersection": 101779, "num_union": 448621, "num_only_computed": 173421, "num_only_roped": 173421, "total_diff": 346842, "diff_percentage": 0.7731292115170713, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:30:22.066745", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.482421875, "l2_diff_relative": 0.12550813008130082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:31:05.275237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2173559685458735, "overlap_percentage": 0.3570951704545455, "num_intersection": 100558, "num_union": 462642, "num_only_computed": 181042, "num_only_roped": 181042, "total_diff": 362084, "diff_percentage": 0.7826440314541265, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:31:08.300476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.0067901611328125e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.26674641148325356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:31:50.974244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20147717136688367, "overlap_percentage": 0.3353824378330373, "num_intersection": 96676, "num_union": 479836, "num_only_computed": 191580, "num_only_roped": 191580, "total_diff": 383160, "diff_percentage": 0.7985228286331163, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:31:52.401564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.841255187988281e-05, "l2_diff": 1.125, "l2_diff_relative": 0.33962264150943394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:32:37.353043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19418843842627836, "overlap_percentage": 0.3252224392361111, "num_intersection": 95912, "num_union": 493912, "num_only_computed": 199000, "num_only_roped": 199000, "total_diff": 398000, "diff_percentage": 0.8058115615737216, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:32:38.808675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 7.390975952148438e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.5188679245283019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:33:24.312489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17954800800165985, "overlap_percentage": 0.30443526975361085, "num_intersection": 91730, "num_union": 510894, "num_only_computed": 209582, "num_only_roped": 209582, "total_diff": 419164, "diff_percentage": 0.8204519919983402, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:33:26.489010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 8.487701416015625e-05, "l2_diff": 1.65625, "l2_diff_relative": 0.6751592356687898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:34:13.027899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.161654624563627, "overlap_percentage": 0.27831787718204487, "num_intersection": 85713, "num_union": 530223, "num_only_computed": 222255, "num_only_roped": 222255, "total_diff": 444510, "diff_percentage": 0.838345375436373, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:34:14.510111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 0.00011301040649414062, "l2_diff": 2.3125, "l2_diff_relative": 1.1887550200803212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:35:01.816091", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16854133057771367, "overlap_percentage": 0.2884644747557003, "num_intersection": 90684, "num_union": 538052, "num_only_computed": 223684, "num_only_roped": 223684, "total_diff": 447368, "diff_percentage": 0.8314586694222863, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:35:04.111551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11376953125, "mean_diff": 8.96453857421875e-05, "l2_diff": 1.625, "l2_diff_relative": 0.8188976377952756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:35:54.333302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15628281067374553, "overlap_percentage": 0.27031935307017546, "num_intersection": 86779, "num_union": 555269, "num_only_computed": 234245, "num_only_roped": 234245, "total_diff": 468490, "diff_percentage": 0.8437171893262545, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:35:56.875868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.5634517766497462}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:36:49.832457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15503919688680842, "overlap_percentage": 0.26845703125, "num_intersection": 87968, "num_union": 567392, "num_only_computed": 239712, "num_only_roped": 239712, "total_diff": 479424, "diff_percentage": 0.8449608031131915, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:36:53.025714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.5222222222222223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:37:46.737413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15414312438787195, "overlap_percentage": 0.26711266762452107, "num_intersection": 89237, "num_union": 578923, "num_only_computed": 244843, "num_only_roped": 244843, "total_diff": 489686, "diff_percentage": 0.8458568756121281, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:37:50.513728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.5276243093922652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:44.450376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.148614779394538, "overlap_percentage": 0.2587721872652141, "num_intersection": 88173, "num_union": 593299, "num_only_computed": 252563, "num_only_roped": 252563, "total_diff": 505126, "diff_percentage": 0.851385220605462, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:46.619795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 8.249282836914062e-05, "l2_diff": 1.65625, "l2_diff_relative": 0.7162162162162162}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:39:41.781222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14913922806111554, "overlap_percentage": 0.25956685564159293, "num_intersection": 90105, "num_union": 604167, "num_only_computed": 257031, "num_only_roped": 257031, "total_diff": 514062, "diff_percentage": 0.8508607719388844, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:39:43.627659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 8.392333984375e-05, "l2_diff": 1.8515625, "l2_diff_relative": 0.7645161290322581}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:40:40.581569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15113456670419273, "overlap_percentage": 0.26258366497829233, "num_intersection": 92900, "num_union": 614684, "num_only_computed": 260892, "num_only_roped": 260892, "total_diff": 521784, "diff_percentage": 0.8488654332958073, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:40:42.450430", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 8.821487426757812e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.8675496688741722}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:41:40.700782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14840816586616964, "overlap_percentage": 0.2584589177911932, "num_intersection": 93161, "num_union": 627735, "num_only_computed": 267287, "num_only_roped": 267287, "total_diff": 534574, "diff_percentage": 0.8515918341338303, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:41:44.781260", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 8.392333984375e-05, "l2_diff": 1.984375, "l2_diff_relative": 0.7839506172839507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:42:44.758456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1461277946487709, "overlap_percentage": 0.25499389392882066, "num_intersection": 93544, "num_union": 640152, "num_only_computed": 273304, "num_only_roped": 273304, "total_diff": 546608, "diff_percentage": 0.8538722053512291, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:42:46.747600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.859375, "l2_diff_relative": 0.7300613496932515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:43:48.023841", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14778098053556393, "overlap_percentage": 0.2575072823851953, "num_intersection": 96180, "num_union": 650828, "num_only_computed": 277324, "num_only_roped": 277324, "total_diff": 554648, "diff_percentage": 0.8522190194644361, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:43:51.729605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.7373417721518988}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:44:55.121913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1491922615617537, "overlap_percentage": 0.25964717402291104, "num_intersection": 98641, "num_union": 661167, "num_only_computed": 281263, "num_only_roped": 281263, "total_diff": 562526, "diff_percentage": 0.8508077384382463, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:44:59.528833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 7.295608520507812e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.6754966887417219}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:46:04.736421", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15093348101105647, "overlap_percentage": 0.2622801117549669, "num_intersection": 101387, "num_union": 671733, "num_only_computed": 285173, "num_only_roped": 285173, "total_diff": 570346, "diff_percentage": 0.8490665189889435, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:46:09.247048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11669921875, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.5641891891891891}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:47:16.637474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1477692820750077, "overlap_percentage": 0.25748952229817706, "num_intersection": 101249, "num_union": 685183, "num_only_computed": 291967, "num_only_roped": 291967, "total_diff": 583934, "diff_percentage": 0.8522307179249923, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:47:20.573340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.724761962890625e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.7406015037593985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:48:28.523352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1518319476450505, "overlap_percentage": 0.2636355901665599, "num_intersection": 105353, "num_union": 693879, "num_only_computed": 294263, "num_only_roped": 294263, "total_diff": 588526, "diff_percentage": 0.8481680523549495, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:48:30.782462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.375, "l2_diff_relative": 0.6197183098591549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:49:40.833137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15045753873469267, "overlap_percentage": 0.26156122006931315, "num_intersection": 106265, "num_union": 706279, "num_only_computed": 300007, "num_only_roped": 300007, "total_diff": 600014, "diff_percentage": 0.8495424612653073, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:49:43.188383", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.375, "l2_diff_relative": 0.676923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:50:54.361654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14935690691443437, "overlap_percentage": 0.259896479528536, "num_intersection": 107252, "num_union": 718092, "num_only_computed": 305420, "num_only_roped": 305420, "total_diff": 610840, "diff_percentage": 0.8506430930855656, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:50:56.684556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.8897058823529411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:52:09.190953", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.142500609629005, "overlap_percentage": 0.24945388812576313, "num_intersection": 104603, "num_union": 734053, "num_only_computed": 314725, "num_only_roped": 314725, "total_diff": 629450, "diff_percentage": 0.857499390370995, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:52:11.859114", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.7202380952380952}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:53:25.169254", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13856845031271717, "overlap_percentage": 0.243408203125, "num_intersection": 103688, "num_union": 748280, "num_only_computed": 322296, "num_only_roped": 322296, "total_diff": 644592, "diff_percentage": 0.8614315496872829, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:53:27.566029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 5.602836608886719e-05, "l2_diff": 1.6015625, "l2_diff_relative": 0.5540540540540541}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:54:42.739194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13647988350912976, "overlap_percentage": 0.24018002516281822, "num_intersection": 103850, "num_union": 760918, "num_only_computed": 328534, "num_only_roped": 328534, "total_diff": 657068, "diff_percentage": 0.8635201164908702, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:54:45.135668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.459785461425781e-05, "l2_diff": 1.4765625, "l2_diff_relative": 0.5338983050847458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:56:00.054516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13031557131731555, "overlap_percentage": 0.23058263483965014, "num_intersection": 101235, "num_union": 776845, "num_only_computed": 337805, "num_only_roped": 337805, "total_diff": 675610, "diff_percentage": 0.8696844286826845, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:56:04.738511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0966796875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.38055555555555554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:57:21.853861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12547943544108062, "overlap_percentage": 0.22297952586206896, "num_intersection": 99324, "num_union": 791556, "num_only_computed": 346116, "num_only_roped": 346116, "total_diff": 692232, "diff_percentage": 0.8745205645589194, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:57:24.414576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.41964285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:58:42.742914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12266342520911995, "overlap_percentage": 0.2185221722819932, "num_intersection": 98793, "num_union": 805399, "num_only_computed": 353303, "num_only_roped": 353303, "total_diff": 706606, "diff_percentage": 0.87733657479088, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:58:45.330134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 4.7206878662109375e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.3870056497175141}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:00:05.629371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12740825025773608, "overlap_percentage": 0.22601972307477677, "num_intersection": 103687, "num_union": 813817, "num_only_computed": 355065, "num_only_roped": 355065, "total_diff": 710130, "diff_percentage": 0.872591749742264, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:00:08.319390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 4.673004150390625e-05, "l2_diff": 1.578125, "l2_diff_relative": 0.46543778801843316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:01:30.391428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12771229216871852, "overlap_percentage": 0.2264980049532196, "num_intersection": 105356, "num_union": 824948, "num_only_computed": 359796, "num_only_roped": 359796, "total_diff": 719592, "diff_percentage": 0.8722877078312815, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:01:33.142823", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.435943603515625e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.6055555555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:02:59.159945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13054375340126714, "overlap_percentage": 0.23093976329270446, "num_intersection": 78441, "num_union": 600879, "num_only_computed": 261219, "num_only_roped": 261219, "total_diff": 522438, "diff_percentage": 0.8694562465987329, "num_computed": 339660, "num_roped": 339660}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 15801, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 185, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:03:04.381366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 5.459785461425781e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.509493670886076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 15801, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 185, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:04:24.240364", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13112042770875804, "overlap_percentage": 0.23184167573449402, "num_intersection": 10227, "num_union": 77997, "num_only_computed": 33885, "num_only_roped": 33885, "total_diff": 67770, "diff_percentage": 0.868879572291242, "num_computed": 44112, "num_roped": 44112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:04:26.791951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.1865234375, "l2_diff_relative": 0.1657986111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:05:34.319948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13632148377125194, "overlap_percentage": 0.23993471164309033, "num_intersection": 441, "num_union": 3235, "num_only_computed": 1397, "num_only_roped": 1397, "total_diff": 2794, "diff_percentage": 0.863678516228748, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:05:36.244517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04833984375, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.08154296875, "l2_diff_relative": 0.65234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:06:35.472061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13003381494005534, "overlap_percentage": 0.23014145810663764, "num_intersection": 423, "num_union": 3253, "num_only_computed": 1415, "num_only_roped": 1415, "total_diff": 2830, "diff_percentage": 0.8699661850599447, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:06:37.388440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.064453125, "l2_diff_relative": 0.37714285714285717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:07:35.766506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13597033374536466, "overlap_percentage": 0.23939064200217627, "num_intersection": 440, "num_union": 3236, "num_only_computed": 1398, "num_only_roped": 1398, "total_diff": 2796, "diff_percentage": 0.8640296662546354, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:07:38.474468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0179443359375, "mean_diff": 2.682209014892578e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.15878378378378377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:07.733533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:07.742685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.0172119140625, "l2_diff_relative": 0.002977195945945946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:09.836462", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8688746643651707, "overlap_percentage": 0.9298372768730477, "num_intersection": 72485, "num_union": 83424, "num_only_computed": 6107, "num_only_roped": 4832, "total_diff": 10939, "diff_percentage": 0.1311253356348293, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:09.974023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 0.00011348724365234375, "l2_diff": 0.2197265625, "l2_diff_relative": 0.04536290322580645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:14.770771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7279362433163235, "overlap_percentage": 0.8425498870481928, "num_intersection": 71610, "num_union": 98374, "num_only_computed": 13382, "num_only_roped": 13382, "total_diff": 26764, "diff_percentage": 0.2720637566836766, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:14.949875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 0.000270843505859375, "l2_diff": 0.498046875, "l2_diff_relative": 0.12259615384615384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:21.445878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6557305969070675, "overlap_percentage": 0.7920740223463687, "num_intersection": 72592, "num_union": 110704, "num_only_computed": 19056, "num_only_roped": 19056, "total_diff": 38112, "diff_percentage": 0.3442694030929325, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:21.657196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 0.000270843505859375, "l2_diff": 0.62109375, "l2_diff_relative": 0.17825112107623317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:28.638507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5918258292783639, "overlap_percentage": 0.7435811360677084, "num_intersection": 73097, "num_union": 123511, "num_only_computed": 25207, "num_only_roped": 25207, "total_diff": 50414, "diff_percentage": 0.40817417072163614, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:28.882076", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 0.0001125335693359375, "l2_diff": 0.42578125, "l2_diff_relative": 0.08963815789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:38.287120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5594760241582949, "overlap_percentage": 0.7175179553789731, "num_intersection": 75127, "num_union": 134281, "num_only_computed": 29577, "num_only_roped": 29577, "total_diff": 59154, "diff_percentage": 0.4405239758417051, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:38.565765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 7.534027099609375e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.07456896551724138}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:47.683506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5271006890877301, "overlap_percentage": 0.6903286637931034, "num_intersection": 76875, "num_union": 145845, "num_only_computed": 34485, "num_only_roped": 34485, "total_diff": 68970, "diff_percentage": 0.4728993109122699, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:48.634840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.00010013580322265625, "l2_diff": 0.455078125, "l2_diff_relative": 0.1165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:58.822271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4944541739638062, "overlap_percentage": 0.66171875, "num_intersection": 77924, "num_union": 157596, "num_only_computed": 39836, "num_only_roped": 39836, "total_diff": 79672, "diff_percentage": 0.5055458260361938, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:59.175495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 0.0001392364501953125, "l2_diff": 0.66015625, "l2_diff_relative": 0.17315573770491804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:12.852174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46075102202294604, "overlap_percentage": 0.6308412796930543, "num_intersection": 55902, "num_union": 121328, "num_only_computed": 32713, "num_only_roped": 32713, "total_diff": 65426, "diff_percentage": 0.539248977977054, "num_computed": 88615, "num_roped": 88615}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:13.229271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 0.0001316070556640625, "l2_diff": 0.57421875, "l2_diff_relative": 0.18846153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:26.644492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47320061255742724, "overlap_percentage": 0.6424116424116424, "num_intersection": 7725, "num_union": 16325, "num_only_computed": 4300, "num_only_roped": 4300, "total_diff": 8600, "diff_percentage": 0.5267993874425727, "num_computed": 12025, "num_roped": 12025}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:26.990776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 0.00012493133544921875, "l2_diff": 0.1748046875, "l2_diff_relative": 0.15016778523489932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:37.087311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45537065052950076, "overlap_percentage": 0.6257796257796258, "num_intersection": 301, "num_union": 661, "num_only_computed": 180, "num_only_roped": 180, "total_diff": 360, "diff_percentage": 0.5446293494704992, "num_computed": 481, "num_roped": 481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:37.398945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.01458740234375, "l2_diff_relative": 0.054917279411764705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:46.924280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4672754946727549, "overlap_percentage": 0.6369294605809128, "num_intersection": 307, "num_union": 657, "num_only_computed": 175, "num_only_roped": 175, "total_diff": 350, "diff_percentage": 0.532724505327245, "num_computed": 482, "num_roped": 482}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:47.235415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.00811767578125, "l2_diff_relative": 0.03552350427350427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:58.147869", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:09:58.161278", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.0907649993896484e-05, "l2_diff": 0.016845703125, "l2_diff_relative": 0.0028521825396825395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:00.308287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8568332043113202, "overlap_percentage": 0.92289733113547, "num_intersection": 71944, "num_union": 83965, "num_only_computed": 6648, "num_only_roped": 5373, "total_diff": 12021, "diff_percentage": 0.1431667956886798, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:00.450568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 0.00010824203491210938, "l2_diff": 0.19921875, "l2_diff_relative": 0.04060509554140127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:05.317945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7336284178641728, "overlap_percentage": 0.8463502447289156, "num_intersection": 71933, "num_union": 98051, "num_only_computed": 13059, "num_only_roped": 13059, "total_diff": 26118, "diff_percentage": 0.2663715821358273, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:05.497444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 0.00018978118896484375, "l2_diff": 0.37890625, "l2_diff_relative": 0.08723021582733813}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:11.406007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6680711653091869, "overlap_percentage": 0.8010103875698324, "num_intersection": 73411, "num_union": 109885, "num_only_computed": 18237, "num_only_roped": 18237, "total_diff": 36474, "diff_percentage": 0.33192883469081313, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:12.130751", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 0.000213623046875, "l2_diff": 0.58203125, "l2_diff_relative": 0.13303571428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:19.097533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6057104121917953, "overlap_percentage": 0.7544453938802084, "num_intersection": 74165, "num_union": 122443, "num_only_computed": 24139, "num_only_roped": 24139, "total_diff": 48278, "diff_percentage": 0.3942895878082046, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:19.342578", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.0001735687255859375, "l2_diff": 0.58203125, "l2_diff_relative": 0.1320921985815603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:29.244084", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.558396713649962, "overlap_percentage": 0.7166297371638142, "num_intersection": 75034, "num_union": 134374, "num_only_computed": 29670, "num_only_roped": 29670, "total_diff": 59340, "diff_percentage": 0.4416032863500379, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:29.524260", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.000152587890625, "l2_diff": 0.625, "l2_diff_relative": 0.14492753623188406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:38.561558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5165773507561778, "overlap_percentage": 0.6812410201149425, "num_intersection": 75863, "num_union": 146857, "num_only_computed": 35497, "num_only_roped": 35497, "total_diff": 70994, "diff_percentage": 0.4834226492438222, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:39.768340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.09019607843137255}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:49.816710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48359055118110233, "overlap_percentage": 0.6519191576086957, "num_intersection": 76770, "num_union": 158750, "num_only_computed": 40990, "num_only_roped": 40990, "total_diff": 81980, "diff_percentage": 0.5164094488188976, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:50.156981", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.00011157989501953125, "l2_diff": 0.546875, "l2_diff_relative": 0.14705882352941177}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:01.259022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4440446621323615, "overlap_percentage": 0.6150012860082305, "num_intersection": 76516, "num_union": 172316, "num_only_computed": 47900, "num_only_roped": 47900, "total_diff": 95800, "diff_percentage": 0.5559553378676385, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:01.638323", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07275390625, "mean_diff": 0.00015544891357421875, "l2_diff": 0.86328125, "l2_diff_relative": 0.2201195219123506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:13.916230", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4306671323786238, "overlap_percentage": 0.60205078125, "num_intersection": 78912, "num_union": 183232, "num_only_computed": 52160, "num_only_roped": 52160, "total_diff": 104320, "diff_percentage": 0.5693328676213761, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:14.343299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00010156631469726562, "l2_diff": 0.5703125, "l2_diff_relative": 0.15271966527196654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:27.685297", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40915986715322483, "overlap_percentage": 0.5807146182495344, "num_intersection": 79832, "num_union": 195112, "num_only_computed": 57640, "num_only_roped": 57640, "total_diff": 115280, "diff_percentage": 0.5908401328467752, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:28.145890", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.423828125, "l2_diff_relative": 0.09041666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:42.657552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37873374371630963, "overlap_percentage": 0.5493935945825933, "num_intersection": 79183, "num_union": 209073, "num_only_computed": 64945, "num_only_roped": 64945, "total_diff": 129890, "diff_percentage": 0.6212662562836904, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:43.143440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 5.6743621826171875e-05, "l2_diff": 0.439453125, "l2_diff_relative": 0.10340073529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:58.845581", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3673735414745811, "overlap_percentage": 0.5373418898809523, "num_intersection": 80885, "num_union": 220171, "num_only_computed": 69643, "num_only_roped": 69643, "total_diff": 139286, "diff_percentage": 0.6326264585254189, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:11:59.383390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 0.474609375, "l2_diff_relative": 0.11085766423357664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:16.195185", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3604763883118682, "overlap_percentage": 0.5299267100977199, "num_intersection": 83296, "num_union": 231072, "num_only_computed": 73888, "num_only_roped": 73888, "total_diff": 147776, "diff_percentage": 0.6395236116881319, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:17.138552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.37890625, "l2_diff_relative": 0.09048507462686567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:35.680247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3431710116412527, "overlap_percentage": 0.510986328125, "num_intersection": 83720, "num_union": 243960, "num_only_computed": 80120, "num_only_roped": 80120, "total_diff": 160240, "diff_percentage": 0.6568289883587474, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:36.316797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03466796875, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.10461956521739131}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:55.913437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3336049007473326, "overlap_percentage": 0.5003054511278195, "num_intersection": 85172, "num_union": 255308, "num_only_computed": 85068, "num_only_roped": 85068, "total_diff": 170136, "diff_percentage": 0.6663950992526674, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:58.483148", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.46875, "l2_diff_relative": 0.10135135135135136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:13:19.212985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3291357041422786, "overlap_percentage": 0.4952627532561505, "num_intersection": 87610, "num_union": 266182, "num_only_computed": 89286, "num_only_roped": 89286, "total_diff": 178572, "diff_percentage": 0.6708642958577214, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:13:19.913962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.16158536585365854}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:13:41.850192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31696609798067976, "overlap_percentage": 0.48135802199720673, "num_intersection": 88231, "num_union": 278361, "num_only_computed": 95065, "num_only_roped": 95065, "total_diff": 190130, "diff_percentage": 0.6830339020193202, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:13:42.588620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.131993006993007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:14:05.902095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3012728294079768, "overlap_percentage": 0.463043295148248, "num_intersection": 87956, "num_union": 291948, "num_only_computed": 101996, "num_only_roped": 101996, "total_diff": 203992, "diff_percentage": 0.6987271705920233, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:14:08.355722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.11607142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:14:33.566491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2991703753630227, "overlap_percentage": 0.4605560302734375, "num_intersection": 90549, "num_union": 302667, "num_only_computed": 106059, "num_only_roped": 106059, "total_diff": 212118, "diff_percentage": 0.7008296246369773, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:14:36.171816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.5234375, "l2_diff_relative": 0.11092715231788079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:15:02.100899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27999596470376825, "overlap_percentage": 0.43749507408575034, "num_intersection": 88815, "num_union": 317201, "num_only_computed": 114193, "num_only_roped": 114193, "total_diff": 228386, "diff_percentage": 0.7200040352962317, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:15:03.951498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.13645418326693226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:15:31.099586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27345391819827264, "overlap_percentage": 0.4294681013431013, "num_intersection": 90044, "num_union": 329284, "num_only_computed": 119620, "num_only_roped": 119620, "total_diff": 239240, "diff_percentage": 0.7265460818017274, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:15:31.974297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.1423611111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:16:00.404870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28089920945687585, "overlap_percentage": 0.4385968972156398, "num_intersection": 94765, "num_union": 337363, "num_only_computed": 121299, "num_only_roped": 121299, "total_diff": 242598, "diff_percentage": 0.7191007905431241, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:16:01.346024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.37890625, "l2_diff_relative": 0.07008670520231214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:16:31.237309", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27726562387991227, "overlap_percentage": 0.43415499281609193, "num_intersection": 96695, "num_union": 348745, "num_only_computed": 126025, "num_only_roped": 126025, "total_diff": 252050, "diff_percentage": 0.7227343761200877, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:16:32.225187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.33203125, "l2_diff_relative": 0.06767515923566879}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:17:03.139976", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27579599589522247, "overlap_percentage": 0.4323512486049107, "num_intersection": 99171, "num_union": 359581, "num_only_computed": 130205, "num_only_roped": 130205, "total_diff": 260410, "diff_percentage": 0.7242040041047775, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:17:04.167735", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.484375, "l2_diff_relative": 0.0950920245398773}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:17:37.018746", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2472050083710892, "overlap_percentage": 0.3964143933224756, "num_intersection": 93465, "num_union": 378087, "num_only_computed": 142311, "num_only_roped": 142311, "total_diff": 284622, "diff_percentage": 0.7527949916289108, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:17:38.105897", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.0973731884057971}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:12.103565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23871178715772584, "overlap_percentage": 0.38541941657866946, "num_intersection": 93438, "num_union": 391426, "num_only_computed": 148994, "num_only_roped": 148994, "total_diff": 297988, "diff_percentage": 0.7612882128422741, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:13.247809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.17596153846153847}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:48.815413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23564946431453365, "overlap_percentage": 0.38141798482510286, "num_intersection": 94909, "num_union": 402755, "num_only_computed": 153923, "num_only_roped": 153923, "total_diff": 307846, "diff_percentage": 0.7643505356854664, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:49.994730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.90234375, "l2_diff_relative": 0.21548507462686567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:26.388732", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22996045166461665, "overlap_percentage": 0.37393145666332667, "num_intersection": 95535, "num_union": 415441, "num_only_computed": 159953, "num_only_roped": 159953, "total_diff": 319906, "diff_percentage": 0.7700395483353834, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:27.980520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.00543212890625e-05, "l2_diff": 0.73828125, "l2_diff_relative": 0.17897727272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:05.692780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22673467716461737, "overlap_percentage": 0.3696556091308594, "num_intersection": 96903, "num_union": 427385, "num_only_computed": 165241, "num_only_roped": 165241, "total_diff": 330482, "diff_percentage": 0.7732653228353826, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:08.393481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:47.514815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2227721645212846, "overlap_percentage": 0.36437231887511917, "num_intersection": 97850, "num_union": 439238, "num_only_computed": 170694, "num_only_roped": 170694, "total_diff": 341388, "diff_percentage": 0.7772278354787154, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:51.101493", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.315376281738281e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.21666666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:21:31.867066", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21475092529855638, "overlap_percentage": 0.35357194767441863, "num_intersection": 97303, "num_union": 453097, "num_only_computed": 177897, "num_only_roped": 177897, "total_diff": 355794, "diff_percentage": 0.7852490747014437, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:21:33.393317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.23678861788617886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:22:15.154333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20889239956126135, "overlap_percentage": 0.34559303977272726, "num_intersection": 97319, "num_union": 465881, "num_only_computed": 184281, "num_only_roped": 184281, "total_diff": 368562, "diff_percentage": 0.7911076004387386, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:22:16.532556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 5.745887756347656e-05, "l2_diff": 1.0, "l2_diff_relative": 0.28193832599118945}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:22:59.806120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2064100578813662, "overlap_percentage": 0.3421888876554174, "num_intersection": 98638, "num_union": 477874, "num_only_computed": 189618, "num_only_roped": 189618, "total_diff": 379236, "diff_percentage": 0.7935899421186338, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:23:01.155940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08740234375, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.98828125, "l2_diff_relative": 0.2657563025210084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:23:44.811938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1975951610840049, "overlap_percentage": 0.329986572265625, "num_intersection": 97317, "num_union": 492507, "num_only_computed": 197595, "num_only_roped": 197595, "total_diff": 395190, "diff_percentage": 0.8024048389159951, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:23:46.287414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 6.437301635742188e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:24:30.953341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1822972458633016, "overlap_percentage": 0.30837802676295667, "num_intersection": 92918, "num_union": 509706, "num_only_computed": 208394, "num_only_roped": 208394, "total_diff": 416788, "diff_percentage": 0.8177027541366985, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:24:33.980248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 8.20159912109375e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.569060773480663}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:25:22.169939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17008229420749083, "overlap_percentage": 0.2907185162094763, "num_intersection": 89532, "num_union": 526404, "num_only_computed": 218436, "num_only_roped": 218436, "total_diff": 436872, "diff_percentage": 0.8299177057925092, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:25:23.670598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 9.679794311523438e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.8992805755395683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:26:11.163448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1589240521495179, "overlap_percentage": 0.27426137520358307, "num_intersection": 86219, "num_union": 542517, "num_only_computed": 228149, "num_only_roped": 228149, "total_diff": 456298, "diff_percentage": 0.8410759478504821, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:26:12.762123", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 9.775161743164062e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.8931297709923665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:27:01.857879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15310966115119154, "overlap_percentage": 0.26555958433014354, "num_intersection": 85251, "num_union": 556797, "num_only_computed": 235773, "num_only_roped": 235773, "total_diff": 471546, "diff_percentage": 0.8468903388488085, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:27:04.782112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 9.5367431640625e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.8857142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:27:56.388049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1483220053582286, "overlap_percentage": 0.2583282470703125, "num_intersection": 84649, "num_union": 570711, "num_only_computed": 243031, "num_only_roped": 243031, "total_diff": 486062, "diff_percentage": 0.8516779946417714, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:28:00.592239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 8.487701416015625e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.7045454545454546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:28:53.858509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14556901257766744, "overlap_percentage": 0.2541427203065134, "num_intersection": 84904, "num_union": 583256, "num_only_computed": 249176, "num_only_roped": 249176, "total_diff": 498352, "diff_percentage": 0.8544309874223326, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:28:57.630987", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.573394495412844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:52.782677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1523770550018432, "overlap_percentage": 0.26445694027047334, "num_intersection": 90110, "num_union": 591362, "num_only_computed": 250626, "num_only_roped": 250626, "total_diff": 501252, "diff_percentage": 0.8476229449981568, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:54.615368", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.724761962890625e-05, "l2_diff": 1.8515625, "l2_diff_relative": 0.6475409836065574}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:51.493215", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15412504550690956, "overlap_percentage": 0.26708552267699115, "num_intersection": 92715, "num_union": 601557, "num_only_computed": 254421, "num_only_roped": 254421, "total_diff": 508842, "diff_percentage": 0.8458749544930905, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:53.368087", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 8.153915405273438e-05, "l2_diff": 1.96875, "l2_diff_relative": 0.7159090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:31:51.480632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1439916445979286, "overlap_percentage": 0.25173548299565845, "num_intersection": 89062, "num_union": 618522, "num_only_computed": 264730, "num_only_roped": 264730, "total_diff": 529460, "diff_percentage": 0.8560083554020714, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:31:53.385707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 9.202957153320312e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.9078947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:32:54.630808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14066183753746056, "overlap_percentage": 0.24663196910511365, "num_intersection": 88898, "num_union": 631998, "num_only_computed": 271550, "num_only_roped": 271550, "total_diff": 543100, "diff_percentage": 0.8593381624625395, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:32:56.594196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 9.632110595703125e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.972027972027972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:33:56.781166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14033307170444742, "overlap_percentage": 0.24612646109560363, "num_intersection": 90291, "num_union": 643405, "num_only_computed": 276557, "num_only_roped": 276557, "total_diff": 553114, "diff_percentage": 0.8596669282955526, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:33:58.771752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 0.00010061264038085938, "l2_diff": 2.234375, "l2_diff_relative": 1.1349206349206349}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:35:02.277210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1409980494793775, "overlap_percentage": 0.24714862491432488, "num_intersection": 92311, "num_union": 654697, "num_only_computed": 281193, "num_only_roped": 281193, "total_diff": 562386, "diff_percentage": 0.8590019505206226, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:35:04.355032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 0.000102996826171875, "l2_diff": 2.328125, "l2_diff_relative": 1.2680851063829788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:36:05.948196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14304521883983987, "overlap_percentage": 0.25028794396257903, "num_intersection": 31944, "num_union": 223314, "num_only_computed": 95685, "num_only_roped": 95685, "total_diff": 191370, "diff_percentage": 0.8569547811601601, "num_computed": 127629, "num_roped": 127629}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 87, "seq_len_k": 12119, "queries_shape": [1, 32, 87, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 87, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:36:08.796080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.6216216216216216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 87, "seq_len_k": 12119, "queries_shape": [1, 32, 87, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 87, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:37:07.021482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1446552254191005, "overlap_percentage": 0.2527489888776542, "num_intersection": 15998, "num_union": 110594, "num_only_computed": 47298, "num_only_roped": 47298, "total_diff": 94596, "diff_percentage": 0.8553447745808995, "num_computed": 63296, "num_roped": 63296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:37:08.813616", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.478125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:37:58.865304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15768777034998033, "overlap_percentage": 0.27241847826086957, "num_intersection": 401, "num_union": 2543, "num_only_computed": 1071, "num_only_roped": 1071, "total_diff": 2142, "diff_percentage": 0.8423122296500196, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:38:00.255939", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046142578125, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.10302734375, "l2_diff_relative": 0.8406374501992032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:38:43.948445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16501780767708746, "overlap_percentage": 0.28328804347826086, "num_intersection": 417, "num_union": 2527, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.8349821923229126, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:38:45.358899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.1171875, "l2_diff_relative": 0.9022556390977443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:39:28.672851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14597119501751654, "overlap_percentage": 0.2547554347826087, "num_intersection": 375, "num_union": 2569, "num_only_computed": 1097, "num_only_roped": 1097, "total_diff": 2194, "diff_percentage": 0.8540288049824835, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:39:30.097210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.872943878173828e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.17331932773109243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:39:55.361136", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:39:55.373464", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.0186767578125, "l2_diff_relative": 0.003096664507772021}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:39:57.514296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8586261980830671, "overlap_percentage": 0.923936398796734, "num_intersection": 72025, "num_union": 83884, "num_only_computed": 6567, "num_only_roped": 5292, "total_diff": 11859, "diff_percentage": 0.1413738019169329, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:39:57.654592", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 9.202957153320312e-05, "l2_diff": 0.1611328125, "l2_diff_relative": 0.035076530612244895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:02.496230", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7310684752943093, "overlap_percentage": 0.8446442018072289, "num_intersection": 71788, "num_union": 98196, "num_only_computed": 13204, "num_only_roped": 13204, "total_diff": 26408, "diff_percentage": 0.26893152470569065, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:04.784693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 0.000217437744140625, "l2_diff": 0.435546875, "l2_diff_relative": 0.09746503496503496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:10.674484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6589825047290632, "overlap_percentage": 0.7944417772346368, "num_intersection": 72809, "num_union": 110487, "num_only_computed": 18839, "num_only_roped": 18839, "total_diff": 37678, "diff_percentage": 0.34101749527093683, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:10.886551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 0.0001983642578125, "l2_diff": 0.51953125, "l2_diff_relative": 0.1196043165467626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:17.875955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6059989707648198, "overlap_percentage": 0.754669189453125, "num_intersection": 74187, "num_union": 122421, "num_only_computed": 24117, "num_only_roped": 24117, "total_diff": 48234, "diff_percentage": 0.3940010292351802, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:18.633698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 0.00019931793212890625, "l2_diff": 0.60546875, "l2_diff_relative": 0.14678030303030304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:26.706586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5551099823255952, "overlap_percentage": 0.7139173288508558, "num_intersection": 74750, "num_union": 134658, "num_only_computed": 29954, "num_only_roped": 29954, "total_diff": 59908, "diff_percentage": 0.4448900176744048, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:26.988811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 0.0001239776611328125, "l2_diff": 0.466796875, "l2_diff_relative": 0.11064814814814815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:36.745237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5186662575432137, "overlap_percentage": 0.6830549568965517, "num_intersection": 76065, "num_union": 146655, "num_only_computed": 35295, "num_only_roped": 35295, "total_diff": 70590, "diff_percentage": 0.48133374245678634, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:37.064478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 0.00010967254638671875, "l2_diff": 0.5234375, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:47.291218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48502178477524793, "overlap_percentage": 0.653218410326087, "num_intersection": 76923, "num_union": 158597, "num_only_computed": 40837, "num_only_roped": 40837, "total_diff": 81674, "diff_percentage": 0.5149782152247521, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:47.645045", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 0.0001373291015625, "l2_diff": 0.765625, "l2_diff_relative": 0.17375886524822695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:58.995007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4564439944044156, "overlap_percentage": 0.6267923739711934, "num_intersection": 77983, "num_union": 170849, "num_only_computed": 46433, "num_only_roped": 46433, "total_diff": 92866, "diff_percentage": 0.5435560055955844, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:00.539034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 6.103515625e-05, "l2_diff": 0.4140625, "l2_diff_relative": 0.08548387096774193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:13.007211", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42143562047911853, "overlap_percentage": 0.5929718017578125, "num_intersection": 77722, "num_union": 184422, "num_only_computed": 53350, "num_only_roped": 53350, "total_diff": 106700, "diff_percentage": 0.5785643795208815, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:14.316082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.4921875, "l2_diff_relative": 0.123046875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:27.912188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4038785576422291, "overlap_percentage": 0.5753753491620112, "num_intersection": 79098, "num_union": 195846, "num_only_computed": 58374, "num_only_roped": 58374, "total_diff": 116748, "diff_percentage": 0.5961214423577709, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:28.370684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.1314655172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:43.012732", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3895605561018877, "overlap_percentage": 0.5606960479573713, "num_intersection": 80812, "num_union": 207444, "num_only_computed": 63316, "num_only_roped": 63316, "total_diff": 126632, "diff_percentage": 0.6104394438981122, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:43.512199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 0.00010204315185546875, "l2_diff": 0.625, "l2_diff_relative": 0.20202020202020202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:59.415685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36753503372777035, "overlap_percentage": 0.5375146152210885, "num_intersection": 80911, "num_union": 220145, "num_only_computed": 69617, "num_only_roped": 69617, "total_diff": 139234, "diff_percentage": 0.6324649662722297, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:41:59.965344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 9.202957153320312e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.18846153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:17.766965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35422895002110816, "overlap_percentage": 0.5231448493485342, "num_intersection": 82230, "num_union": 232138, "num_only_computed": 74954, "num_only_roped": 74954, "total_diff": 149908, "diff_percentage": 0.6457710499788919, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:18.356561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 8.678436279296875e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.17786561264822134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:36.890397", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3354416966891088, "overlap_percentage": 0.5023681640625, "num_intersection": 82308, "num_union": 245372, "num_only_computed": 81532, "num_only_roped": 81532, "total_diff": 163064, "diff_percentage": 0.6645583033108912, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:37.503814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.13565891472868216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:57.029685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3329000990436223, "overlap_percentage": 0.4995124530075188, "num_intersection": 85037, "num_union": 255443, "num_only_computed": 85203, "num_only_roped": 85203, "total_diff": 170406, "diff_percentage": 0.6670999009563777, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:57.694655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.5234375, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:43:18.755953", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32838213815036066, "overlap_percentage": 0.4944091443560058, "num_intersection": 87459, "num_union": 266333, "num_only_computed": 89437, "num_only_roped": 89437, "total_diff": 178874, "diff_percentage": 0.6716178618496393, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:43:19.941003", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.12322695035460993}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:43:43.289287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32842922318170453, "overlap_percentage": 0.4944625087290503, "num_intersection": 90633, "num_union": 275959, "num_only_computed": 92663, "num_only_roped": 92663, "total_diff": 185326, "diff_percentage": 0.6715707768182955, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:43:44.053814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.2490234375, "l2_diff_relative": 0.060369318181818184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:44:09.194878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3102758482731029, "overlap_percentage": 0.4736038578167116, "num_intersection": 89962, "num_union": 289942, "num_only_computed": 99990, "num_only_roped": 99990, "total_diff": 199980, "diff_percentage": 0.689724151726897, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:44:10.012228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.435546875, "l2_diff_relative": 0.10888671875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:44:35.443663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3034251638330809, "overlap_percentage": 0.4655812581380208, "num_intersection": 91537, "num_union": 301679, "num_only_computed": 105071, "num_only_roped": 105071, "total_diff": 210142, "diff_percentage": 0.6965748361669192, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:44:36.318079", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.13602941176470587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:03.085092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2872274656884969, "overlap_percentage": 0.44627305327868855, "num_intersection": 90597, "num_union": 315419, "num_only_computed": 112411, "num_only_roped": 112411, "total_diff": 224822, "diff_percentage": 0.7127725343115031, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:03.966801", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.4140625, "l2_diff_relative": 0.10557768924302789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:32.015399", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2818390242411274, "overlap_percentage": 0.43974168192918195, "num_intersection": 92198, "num_union": 327130, "num_only_computed": 117466, "num_only_roped": 117466, "total_diff": 234932, "diff_percentage": 0.7181609757588726, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:32.951146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.817413330078125e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.19256756756756757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:02.327829", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2712189496722874, "overlap_percentage": 0.4267069016587678, "num_intersection": 92196, "num_union": 339932, "num_only_computed": 123868, "num_only_roped": 123868, "total_diff": 247736, "diff_percentage": 0.7287810503277126, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:05.907131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.1676470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:36.860209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2691249123886695, "overlap_percentage": 0.42411099137931035, "num_intersection": 94458, "num_union": 350982, "num_only_computed": 128262, "num_only_roped": 128262, "total_diff": 256524, "diff_percentage": 0.7308750876113305, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:37.899415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.5, "l2_diff_relative": 0.10884353741496598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:10.001509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.255166337885201, "overlap_percentage": 0.406585693359375, "num_intersection": 93261, "num_union": 365491, "num_only_computed": 136115, "num_only_roped": 136115, "total_diff": 272230, "diff_percentage": 0.744833662114799, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:11.087696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.6702880859375e-05, "l2_diff": 0.421875, "l2_diff_relative": 0.10305343511450382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:44.832965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25745523393021424, "overlap_percentage": 0.40948612242128124, "num_intersection": 96547, "num_union": 375005, "num_only_computed": 139229, "num_only_roped": 139229, "total_diff": 278458, "diff_percentage": 0.7425447660697857, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:45.954218", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.62890625, "l2_diff_relative": 0.1560077519379845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:20.880004", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2621144915766019, "overlap_percentage": 0.41535770855332627, "num_intersection": 100696, "num_union": 384168, "num_only_computed": 141736, "num_only_roped": 141736, "total_diff": 283472, "diff_percentage": 0.7378855084233981, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:22.020855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.6328125, "l2_diff_relative": 0.16463414634146342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:58.288180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24128022986670924, "overlap_percentage": 0.3887602880658436, "num_intersection": 96736, "num_union": 400928, "num_only_computed": 152096, "num_only_roped": 152096, "total_diff": 304192, "diff_percentage": 0.7587197701332907, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:59.451546", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.671875, "l2_diff_relative": 0.17551020408163265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:35.737257", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2349902960490539, "overlap_percentage": 0.3805540769038076, "num_intersection": 97227, "num_union": 413749, "num_only_computed": 158261, "num_only_roped": 158261, "total_diff": 316522, "diff_percentage": 0.7650097039509461, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:36.946361", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.23809523809523808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:14.987759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23271386652622075, "overlap_percentage": 0.3775634765625, "num_intersection": 98976, "num_union": 425312, "num_only_computed": 163168, "num_only_roped": 163168, "total_diff": 326336, "diff_percentage": 0.7672861334737793, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:17.895141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 5.745887756347656e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:57.532131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22023023812174403, "overlap_percentage": 0.3609650560057197, "num_intersection": 96935, "num_union": 440153, "num_only_computed": 171609, "num_only_roped": 171609, "total_diff": 343218, "diff_percentage": 0.779769761878256, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:59.536164", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.2784090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:40.484989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2095586781000435, "overlap_percentage": 0.3465043604651163, "num_intersection": 95358, "num_union": 455042, "num_only_computed": 179842, "num_only_roped": 179842, "total_diff": 359684, "diff_percentage": 0.7904413218999565, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:41.830426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.29864864864864865}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:52:23.806187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20637803843616392, "overlap_percentage": 0.3421448863636364, "num_intersection": 96348, "num_union": 466852, "num_only_computed": 185252, "num_only_roped": 185252, "total_diff": 370504, "diff_percentage": 0.7936219615638361, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:52:25.173187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.2675233644859813}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:08.588828", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20315464128372782, "overlap_percentage": 0.3377032915186501, "num_intersection": 97345, "num_union": 479167, "num_only_computed": 190911, "num_only_roped": 190911, "total_diff": 381822, "diff_percentage": 0.7968453587162722, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:10.010284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 7.343292236328125e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.4263157894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:49.685041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18291232244069694, "overlap_percentage": 0.3092576160899142, "num_intersection": 5228, "num_union": 28582, "num_only_computed": 11677, "num_only_roped": 11677, "total_diff": 23354, "diff_percentage": 0.817087677559303, "num_computed": 16905, "num_roped": 16905}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 15, "seq_len_k": 8719, "queries_shape": [1, 32, 15, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 15, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:50.826085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.09912109375, "l2_diff_relative": 0.0899822695035461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 15, "seq_len_k": 8719, "queries_shape": [1, 32, 15, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 15, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:54:28.460727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18776055755338447, "overlap_percentage": 0.31615893684859203, "num_intersection": 11800, "num_union": 62846, "num_only_computed": 25523, "num_only_roped": 25523, "total_diff": 51046, "diff_percentage": 0.8122394424466155, "num_computed": 37323, "num_roped": 37323}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:54:29.705538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.41796875, "l2_diff_relative": 0.34967320261437906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:55:05.198502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20063694267515925, "overlap_percentage": 0.33421750663129973, "num_intersection": 378, "num_union": 1884, "num_only_computed": 753, "num_only_roped": 753, "total_diff": 1506, "diff_percentage": 0.7993630573248408, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:55:08.817132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 9.918212890625e-05, "l2_diff": 0.0771484375, "l2_diff_relative": 0.7383177570093458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:55:40.124455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20319148936170212, "overlap_percentage": 0.33775419982316535, "num_intersection": 382, "num_union": 1880, "num_only_computed": 749, "num_only_roped": 749, "total_diff": 1498, "diff_percentage": 0.7968085106382978, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:55:41.144726", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.3680555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:12.362709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1911532385466035, "overlap_percentage": 0.3209549071618037, "num_intersection": 363, "num_union": 1899, "num_only_computed": 768, "num_only_roped": 768, "total_diff": 1536, "diff_percentage": 0.8088467614533965, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:13.384822", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.052490234375, "l2_diff_relative": 0.27284263959390864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:37.000575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:37.015048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.016845703125, "l2_diff_relative": 0.002945696721311475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:39.116433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8606002744793843, "overlap_percentage": 0.9250780904245425, "num_intersection": 72114, "num_union": 83795, "num_only_computed": 6478, "num_only_roped": 5203, "total_diff": 11681, "diff_percentage": 0.13939972552061577, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:39.250683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 0.0001068115234375, "l2_diff": 0.1923828125, "l2_diff_relative": 0.04335387323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:44.008834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7250253704079561, "overlap_percentage": 0.8405967620481928, "num_intersection": 71444, "num_union": 98540, "num_only_computed": 13548, "num_only_roped": 13548, "total_diff": 27096, "diff_percentage": 0.27497462959204383, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:44.737492", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 0.00018596649169921875, "l2_diff": 0.35546875, "l2_diff_relative": 0.08067375886524823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:50.555427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6502003151024083, "overlap_percentage": 0.7880259252793296, "num_intersection": 72221, "num_union": 111075, "num_only_computed": 19427, "num_only_roped": 19427, "total_diff": 38854, "diff_percentage": 0.3497996848975917, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:50.764534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.00018978118896484375, "l2_diff": 0.478515625, "l2_diff_relative": 0.11688931297709923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:57.632340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.600273484238029, "overlap_percentage": 0.750213623046875, "num_intersection": 73749, "num_union": 122859, "num_only_computed": 24555, "num_only_roped": 24555, "total_diff": 49110, "diff_percentage": 0.39972651576197105, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:56:58.710678", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 0.00019741058349609375, "l2_diff": 0.58984375, "l2_diff_relative": 0.15345528455284552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:06.672625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5542904645621952, "overlap_percentage": 0.7132392267726161, "num_intersection": 74679, "num_union": 134729, "num_only_computed": 30025, "num_only_roped": 30025, "total_diff": 60050, "diff_percentage": 0.4457095354378048, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:06.950892", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 0.000148773193359375, "l2_diff": 0.578125, "l2_diff_relative": 0.14682539682539683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:16.626158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5167425991378429, "overlap_percentage": 0.6813846982758621, "num_intersection": 75879, "num_union": 146841, "num_only_computed": 35481, "num_only_roped": 35481, "total_diff": 70962, "diff_percentage": 0.483257400862157, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:16.939230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10791015625, "mean_diff": 0.000133514404296875, "l2_diff": 0.62890625, "l2_diff_relative": 0.15246212121212122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:27.023152", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.478960357180983, "overlap_percentage": 0.6476987092391304, "num_intersection": 76273, "num_union": 159247, "num_only_computed": 41487, "num_only_roped": 41487, "total_diff": 82974, "diff_percentage": 0.521039642819017, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:27.370926", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.00011157989501953125, "l2_diff": 0.58984375, "l2_diff_relative": 0.1498015873015873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:38.641791", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4510931367689338, "overlap_percentage": 0.621728716563786, "num_intersection": 77353, "num_union": 171479, "num_only_computed": 47063, "num_only_roped": 47063, "total_diff": 94126, "diff_percentage": 0.5489068632310662, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:40.371893", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 0.00011968612670898438, "l2_diff": 0.70703125, "l2_diff_relative": 0.16160714285714287}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:52.760756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4379655736086274, "overlap_percentage": 0.6091461181640625, "num_intersection": 79842, "num_union": 182302, "num_only_computed": 51230, "num_only_roped": 51230, "total_diff": 102460, "diff_percentage": 0.5620344263913726, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:54.153236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00013256072998046875, "l2_diff": 0.765625, "l2_diff_relative": 0.20416666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:07.666747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4251710553597346, "overlap_percentage": 0.5966596834264432, "num_intersection": 82024, "num_union": 192920, "num_only_computed": 55448, "num_only_roped": 55448, "total_diff": 110896, "diff_percentage": 0.5748289446402653, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:08.106957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 0.00010585784912109375, "l2_diff": 0.63671875, "l2_diff_relative": 0.17717391304347826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:22.747194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4029786819818943, "overlap_percentage": 0.5744615896980462, "num_intersection": 82796, "num_union": 205460, "num_only_computed": 61332, "num_only_roped": 61332, "total_diff": 122664, "diff_percentage": 0.5970213180181058, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:23.247026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 0.00011205673217773438, "l2_diff": 0.76171875, "l2_diff_relative": 0.2074468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:39.261864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3889870585249948, "overlap_percentage": 0.560101775085034, "num_intersection": 84311, "num_union": 216745, "num_only_computed": 66217, "num_only_roped": 66217, "total_diff": 132434, "diff_percentage": 0.6110129414750052, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:39.805141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 9.1552734375e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.1746987951807229}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:57.649576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37322977730795104, "overlap_percentage": 0.5435794991856677, "num_intersection": 85442, "num_union": 228926, "num_only_computed": 71742, "num_only_roped": 71742, "total_diff": 143484, "diff_percentage": 0.626770222692049, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:58.241653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 9.72747802734375e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.19313304721030042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:16.696365", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3505893990602588, "overlap_percentage": 0.5191650390625, "num_intersection": 85060, "num_union": 242620, "num_only_computed": 78780, "num_only_roped": 78780, "total_diff": 157560, "diff_percentage": 0.6494106009397411, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:17.305603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09033203125, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.6640625, "l2_diff_relative": 0.1748971193415638}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:37.033796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3336101242817471, "overlap_percentage": 0.50031132518797, "num_intersection": 85173, "num_union": 255307, "num_only_computed": 85067, "num_only_roped": 85067, "total_diff": 170134, "diff_percentage": 0.6663898757182529, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:37.707189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.19874476987447698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:58.910867", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3264646555538059, "overlap_percentage": 0.49223272431259046, "num_intersection": 87074, "num_union": 266718, "num_only_computed": 89822, "num_only_roped": 89822, "total_diff": 179644, "diff_percentage": 0.6735353444461941, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:59.622788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.2040358744394619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:00:22.454734", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3152650858744049, "overlap_percentage": 0.47939398568435754, "num_intersection": 87871, "num_union": 278721, "num_only_computed": 95425, "num_only_roped": 95425, "total_diff": 190850, "diff_percentage": 0.6847349141255952, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:00:24.203275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 7.390975952148438e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.20833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:00:49.823733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2999059040906058, "overlap_percentage": 0.46142709737196763, "num_intersection": 87649, "num_union": 292255, "num_only_computed": 102303, "num_only_roped": 102303, "total_diff": 204606, "diff_percentage": 0.7000940959093942, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:00:50.607146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.21596858638743455}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:01:15.250206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2816103567633811, "overlap_percentage": 0.4394632975260417, "num_intersection": 86402, "num_union": 306814, "num_only_computed": 110206, "num_only_roped": 110206, "total_diff": 220412, "diff_percentage": 0.7183896432366189, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:01:16.074609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.20212765957446807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:01:42.204489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27668352074057306, "overlap_percentage": 0.4334410466582598, "num_intersection": 87992, "num_union": 318024, "num_only_computed": 115016, "num_only_roped": 115016, "total_diff": 230032, "diff_percentage": 0.723316479259427, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:01:43.073741", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08056640625, "mean_diff": 7.390975952148438e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.24258474576271186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:10.244863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27309049177540695, "overlap_percentage": 0.42901976495726496, "num_intersection": 89950, "num_union": 329378, "num_only_computed": 119714, "num_only_roped": 119714, "total_diff": 239428, "diff_percentage": 0.726909508224593, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:11.150450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.21996124031007752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:39.611088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2619934173828986, "overlap_percentage": 0.4152056797985782, "num_intersection": 89711, "num_union": 342417, "num_only_computed": 126353, "num_only_roped": 126353, "total_diff": 252706, "diff_percentage": 0.7380065826171014, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:40.565649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 7.772445678710938e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.2926829268292683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:09.937566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2580065747110855, "overlap_percentage": 0.4101831896551724, "num_intersection": 91356, "num_union": 354084, "num_only_computed": 131364, "num_only_roped": 131364, "total_diff": 262728, "diff_percentage": 0.7419934252889145, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:13.092104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.16441441441441443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:43.442468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2518029977651832, "overlap_percentage": 0.4023045131138393, "num_intersection": 92279, "num_union": 366473, "num_only_computed": 137097, "num_only_roped": 137097, "total_diff": 274194, "diff_percentage": 0.7481970022348168, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:44.457135", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.1658878504672897}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:04:16.514900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24060310603290194, "overlap_percentage": 0.38788086997828447, "num_intersection": 91453, "num_union": 380099, "num_only_computed": 144323, "num_only_roped": 144323, "total_diff": 288646, "diff_percentage": 0.7593968939670981, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:04:17.576221", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.1922222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:04:52.062754", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23112861412208605, "overlap_percentage": 0.37547435982048577, "num_intersection": 91027, "num_union": 393837, "num_only_computed": 151405, "num_only_roped": 151405, "total_diff": 302810, "diff_percentage": 0.7688713858779139, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:04:53.192965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.875, "l2_diff_relative": 0.2445414847161572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:05:28.570680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23072661895411584, "overlap_percentage": 0.3749437371399177, "num_intersection": 93298, "num_union": 404366, "num_only_computed": 155534, "num_only_roped": 155534, "total_diff": 311068, "diff_percentage": 0.7692733810458842, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:05:31.781428", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 5.793571472167969e-05, "l2_diff": 0.94921875, "l2_diff_relative": 0.262987012987013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:06:08.389934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22948397745920376, "overlap_percentage": 0.37330129008016033, "num_intersection": 95374, "num_union": 415602, "num_only_computed": 160114, "num_only_roped": 160114, "total_diff": 320228, "diff_percentage": 0.7705160225407962, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:06:09.591456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.12080536912751678}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:06:49.293277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23013681273946923, "overlap_percentage": 0.3741645812988281, "num_intersection": 98085, "num_union": 426203, "num_only_computed": 164059, "num_only_roped": 164059, "total_diff": 328118, "diff_percentage": 0.7698631872605308, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:06:50.529256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.09186746987951808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:07:29.859187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2255399935196214, "overlap_percentage": 0.36806631315538607, "num_intersection": 98842, "num_union": 438246, "num_only_computed": 169702, "num_only_roped": 169702, "total_diff": 339404, "diff_percentage": 0.7744600064803786, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:07:31.134515", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.129}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:08:11.952342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.214225677431595, "overlap_percentage": 0.352859738372093, "num_intersection": 97107, "num_union": 453293, "num_only_computed": 178093, "num_only_roped": 178093, "total_diff": 356186, "diff_percentage": 0.785774322568405, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:08:13.308169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.20326086956521738}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:08:56.663422", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21625707251760032, "overlap_percentage": 0.35561079545454544, "num_intersection": 100140, "num_union": 463060, "num_only_computed": 181460, "num_only_roped": 181460, "total_diff": 362920, "diff_percentage": 0.7837429274823997, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:09:00.224189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.2560386473429952}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:09:43.523892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20889932688880036, "overlap_percentage": 0.345602519982238, "num_intersection": 99622, "num_union": 476890, "num_only_computed": 188634, "num_only_roped": 188634, "total_diff": 377268, "diff_percentage": 0.7911006731111997, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:09:44.934173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 5.0067901611328125e-05, "l2_diff": 0.890625, "l2_diff_relative": 0.3048128342245989}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:10:29.956398", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1900586329207911, "overlap_percentage": 0.3194105360243056, "num_intersection": 94198, "num_union": 495626, "num_only_computed": 200714, "num_only_roped": 200714, "total_diff": 401428, "diff_percentage": 0.8099413670792089, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:10:31.369422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.2819548872180451}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:11:17.572925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17973966887948772, "overlap_percentage": 0.30471073173322005, "num_intersection": 91813, "num_union": 510811, "num_only_computed": 209499, "num_only_roped": 209499, "total_diff": 418998, "diff_percentage": 0.8202603311205123, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:11:19.106899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.2809734513274336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:12:07.332175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1669189570146505, "overlap_percentage": 0.28608491791354945, "num_intersection": 88105, "num_union": 527831, "num_only_computed": 219863, "num_only_roped": 219863, "total_diff": 439726, "diff_percentage": 0.8330810429853495, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:12:08.881142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.5337078651685393}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:13:00.111758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15913984838205364, "overlap_percentage": 0.27458265472312704, "num_intersection": 86320, "num_union": 542416, "num_only_computed": 228048, "num_only_roped": 228048, "total_diff": 456096, "diff_percentage": 0.8408601516179464, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:13:01.779362", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.5767045454545454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:13:52.468896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15043604000064506, "overlap_percentage": 0.26152873305422647, "num_intersection": 83957, "num_union": 558091, "num_only_computed": 237067, "num_only_roped": 237067, "total_diff": 474134, "diff_percentage": 0.849563959999355, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:13:54.107473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.34375, "l2_diff_relative": 0.4673913043478261}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:14:46.314892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14912539101404143, "overlap_percentage": 0.2595458984375, "num_intersection": 85048, "num_union": 570312, "num_only_computed": 242632, "num_only_roped": 242632, "total_diff": 485264, "diff_percentage": 0.8508746089859586, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:14:48.062094", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.40476190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:15:42.083939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14652239044152848, "overlap_percentage": 0.2555944683908046, "num_intersection": 85389, "num_union": 582771, "num_only_computed": 248691, "num_only_roped": 248691, "total_diff": 497382, "diff_percentage": 0.8534776095584715, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:15:43.818403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.982948303222656e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.32669322709163345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:16:38.790086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14702174465556794, "overlap_percentage": 0.2563538927498122, "num_intersection": 87349, "num_union": 594123, "num_only_computed": 253387, "num_only_roped": 253387, "total_diff": 506774, "diff_percentage": 0.8529782553444321, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:16:40.597188", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 6.4849853515625e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.5134408602150538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:17:37.084279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14345570433321805, "overlap_percentage": 0.2509160674778761, "num_intersection": 87102, "num_union": 607170, "num_only_computed": 260034, "num_only_roped": 260034, "total_diff": 520068, "diff_percentage": 0.8565442956667819, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:17:38.938946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 5.936622619628906e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.4393939393939394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:18:37.157789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14108047089179165, "overlap_percentage": 0.24727523516642547, "num_intersection": 87484, "num_union": 620100, "num_only_computed": 266308, "num_only_roped": 266308, "total_diff": 532616, "diff_percentage": 0.8589195291082083, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:18:39.732656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 5.888938903808594e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.43317972350230416}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:19:41.094901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14334109944696177, "overlap_percentage": 0.2507407448508523, "num_intersection": 90379, "num_union": 630517, "num_only_computed": 270069, "num_only_roped": 270069, "total_diff": 540138, "diff_percentage": 0.8566589005530382, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:19:43.051918", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.5432692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:20:44.018744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14138681509806147, "overlap_percentage": 0.24774566032798326, "num_intersection": 90885, "num_union": 642811, "num_only_computed": 275963, "num_only_roped": 275963, "total_diff": 551926, "diff_percentage": 0.8586131849019385, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:20:47.392343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.7350993377483444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:21:49.557358", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1389417865185499, "overlap_percentage": 0.24398400017135025, "num_intersection": 91129, "num_union": 655879, "num_only_computed": 282375, "num_only_roped": 282375, "total_diff": 564750, "diff_percentage": 0.8610582134814501, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:21:51.639480", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.5, "l2_diff_relative": 0.6808510638297872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:22:56.886723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1414938719340891, "overlap_percentage": 0.2479099983153639, "num_intersection": 94182, "num_union": 665626, "num_only_computed": 285722, "num_only_roped": 285722, "total_diff": 571444, "diff_percentage": 0.8585061280659109, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:22:59.017595", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.859375, "l2_diff_relative": 0.8206896551724138}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:04.626866", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1406449176148435, "overlap_percentage": 0.24660596026490067, "num_intersection": 95328, "num_union": 677792, "num_only_computed": 291232, "num_only_roped": 291232, "total_diff": 582464, "diff_percentage": 0.8593550823851565, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:06.793875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.8090277777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:25:14.068417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13902523452334226, "overlap_percentage": 0.2441126505533854, "num_intersection": 95989, "num_union": 690443, "num_only_computed": 297227, "num_only_roped": 297227, "total_diff": 594454, "diff_percentage": 0.8609747654766577, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:25:16.261084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.776595744680851}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:26:24.978014", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13666126233751458, "overlap_percentage": 0.24046084240871238, "num_intersection": 96092, "num_union": 703140, "num_only_computed": 303524, "num_only_roped": 303524, "total_diff": 607048, "diff_percentage": 0.8633387376624854, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:26:27.244113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.7956204379562044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:27:37.233153", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1368703828072532, "overlap_percentage": 0.2407844990548204, "num_intersection": 97824, "num_union": 714720, "num_only_computed": 308448, "num_only_roped": 308448, "total_diff": 616896, "diff_percentage": 0.8631296171927468, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:27:39.540756", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.7634730538922155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:28:52.487509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13257704145974303, "overlap_percentage": 0.23411571417493796, "num_intersection": 96613, "num_union": 728731, "num_only_computed": 316059, "num_only_roped": 316059, "total_diff": 632118, "diff_percentage": 0.867422958540257, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:28:55.863821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2314453125, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.75, "l2_diff_relative": 0.6829268292682927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:30:09.333812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13480797099978487, "overlap_percentage": 0.2375872825091575, "num_intersection": 99627, "num_union": 739029, "num_only_computed": 319701, "num_only_roped": 319701, "total_diff": 639402, "diff_percentage": 0.8651920290002152, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:30:11.768326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 7.724761962890625e-05, "l2_diff": 1.8984375, "l2_diff_relative": 0.8617021276595744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:31:30.274312", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13973822493819496, "overlap_percentage": 0.2452110877403846, "num_intersection": 104456, "num_union": 747512, "num_only_computed": 321528, "num_only_roped": 321528, "total_diff": 643056, "diff_percentage": 0.860261775061805, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:31:32.820802", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 7.2479248046875e-05, "l2_diff": 1.84375, "l2_diff_relative": 0.7375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:32:51.066092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12932326899469793, "overlap_percentage": 0.229027901124926, "num_intersection": 99028, "num_union": 765740, "num_only_computed": 333356, "num_only_roped": 333356, "total_diff": 666712, "diff_percentage": 0.8706767310053021, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:32:53.668620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.75, "l2_diff_relative": 0.6746987951807228}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:34:12.773301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12483939192469642, "overlap_percentage": 0.22196838556851312, "num_intersection": 97453, "num_union": 780627, "num_only_computed": 341587, "num_only_roped": 341587, "total_diff": 683174, "diff_percentage": 0.8751606080753036, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:34:15.365196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.245208740234375e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.48936170212765956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:35:36.290336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12266269460217606, "overlap_percentage": 0.2185210129310345, "num_intersection": 97338, "num_union": 793542, "num_only_computed": 348102, "num_only_roped": 348102, "total_diff": 696204, "diff_percentage": 0.877337305397824, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:35:39.795737", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 6.29425048828125e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.7096774193548387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:37:02.444716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1197535083938912, "overlap_percentage": 0.21389262457531144, "num_intersection": 96700, "num_union": 807492, "num_only_computed": 355396, "num_only_roped": 355396, "total_diff": 710792, "diff_percentage": 0.8802464916061088, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:37:05.132009", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 5.245208740234375e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.5104166666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:38:28.772539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12201337849901557, "overlap_percentage": 0.21749005998883927, "num_intersection": 99774, "num_union": 817730, "num_only_computed": 358978, "num_only_roped": 358978, "total_diff": 717956, "diff_percentage": 0.8779866215009844, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:38:31.544063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 5.936622619628906e-05, "l2_diff": 1.671875, "l2_diff_relative": 0.6369047619047619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:40:00.083739", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1261560511713038, "overlap_percentage": 0.22404719317556412, "num_intersection": 104216, "num_union": 826088, "num_only_computed": 360936, "num_only_roped": 360936, "total_diff": 721872, "diff_percentage": 0.8738439488286962, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:40:03.271637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.8515625, "l2_diff_relative": 0.6583333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:41:31.197587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1231023569752924, "overlap_percentage": 0.21921841087900162, "num_intersection": 103429, "num_union": 840187, "num_only_computed": 368379, "num_only_roped": 368379, "total_diff": 736758, "diff_percentage": 0.8768976430247076, "num_computed": 471808, "num_roped": 471808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 256, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:41:34.124889", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 6.246566772460938e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.7844311377245509}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 256, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:43:03.623472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12271607286028383, "overlap_percentage": 0.2186057113222698, "num_intersection": 104539, "num_union": 851877, "num_only_computed": 373669, "num_only_roped": 373669, "total_diff": 747338, "diff_percentage": 0.8772839271397161, "num_computed": 478208, "num_roped": 478208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "mask_shape": [1, 32, 256, 16128], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:43:06.608748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.7588235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "attention_shape": [1, 32, 256, 16128]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:44:33.746434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11687427323274731, "overlap_percentage": 0.20928814645261629, "num_intersection": 40505, "num_union": 346569, "num_only_computed": 153032, "num_only_roped": 153032, "total_diff": 306064, "diff_percentage": 0.8831257267672527, "num_computed": 193537, "num_roped": 193537}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 103, "seq_len_k": 16231, "queries_shape": [1, 32, 103, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 103, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:44:38.056756", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.3363309352517986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 103, "seq_len_k": 16231, "queries_shape": [1, 32, 103, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 103, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:46:00.239410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1136094674556213, "overlap_percentage": 0.20403825717321997, "num_intersection": 13056, "num_union": 114920, "num_only_computed": 50932, "num_only_roped": 50932, "total_diff": 101864, "diff_percentage": 0.8863905325443787, "num_computed": 63988, "num_roped": 63988}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:46:03.510095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.486328125, "l2_diff_relative": 0.447841726618705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:47:12.250962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1192387749033601, "overlap_percentage": 0.2130712008501594, "num_intersection": 401, "num_union": 3363, "num_only_computed": 1481, "num_only_roped": 1481, "total_diff": 2962, "diff_percentage": 0.8807612250966399, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:47:14.119878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.060791015625, "l2_diff_relative": 0.30514705882352944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:48:11.493894", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10381231671554252, "overlap_percentage": 0.18809776833156217, "num_intersection": 354, "num_union": 3410, "num_only_computed": 1528, "num_only_roped": 1528, "total_diff": 3056, "diff_percentage": 0.8961876832844575, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:48:13.334558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.051025390625, "l2_diff_relative": 0.312874251497006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:49:10.683437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10673331373125551, "overlap_percentage": 0.19287991498405951, "num_intersection": 363, "num_union": 3401, "num_only_computed": 1519, "num_only_roped": 1519, "total_diff": 3038, "diff_percentage": 0.8932666862687445, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:49:13.828753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.029541015625, "l2_diff_relative": 0.1104014598540146}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:50:12.130564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11957168352171327, "overlap_percentage": 0.21360255047821466, "num_intersection": 402, "num_union": 3362, "num_only_computed": 1480, "num_only_roped": 1480, "total_diff": 2960, "diff_percentage": 0.8804283164782868, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:50:14.010196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.056640625, "l2_diff_relative": 0.23577235772357724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:51:12.367130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11585185185185186, "overlap_percentage": 0.20764737121614446, "num_intersection": 391, "num_union": 3375, "num_only_computed": 1492, "num_only_roped": 1492, "total_diff": 2984, "diff_percentage": 0.8841481481481481, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:51:14.312964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.08740234375, "l2_diff_relative": 0.5085227272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:12.708901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11025943396226415, "overlap_percentage": 0.19861922464152948, "num_intersection": 374, "num_union": 3392, "num_only_computed": 1509, "num_only_roped": 1509, "total_diff": 3018, "diff_percentage": 0.8897405660377359, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:15.681409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.285958904109589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:13.002719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12083333333333333, "overlap_percentage": 0.21561338289962825, "num_intersection": 406, "num_union": 3360, "num_only_computed": 1477, "num_only_roped": 1477, "total_diff": 2954, "diff_percentage": 0.8791666666666667, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:14.876564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0113525390625, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.11035564853556486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:50.554880", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:53.251965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1026859283447266e-05, "l2_diff": 0.01556396484375, "l2_diff_relative": 0.0028459821428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:55.382518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8587148307105389, "overlap_percentage": 0.9239877107800063, "num_intersection": 72029, "num_union": 83880, "num_only_computed": 6563, "num_only_roped": 5288, "total_diff": 11851, "diff_percentage": 0.14128516928946114, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:55.519859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 3.1948089599609375e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.013172238372093024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:00.254417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7381843466879359, "overlap_percentage": 0.8493740587349398, "num_intersection": 72190, "num_union": 97794, "num_only_computed": 12802, "num_only_roped": 12802, "total_diff": 25604, "diff_percentage": 0.26181565331206413, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:00.442420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 9.965896606445312e-05, "l2_diff": 0.236328125, "l2_diff_relative": 0.04555722891566265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:06.225715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.662669400047169, "overlap_percentage": 0.7971150488826816, "num_intersection": 73054, "num_union": 110242, "num_only_computed": 18594, "num_only_roped": 18594, "total_diff": 37188, "diff_percentage": 0.33733059995283105, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:07.321919", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 0.00019359588623046875, "l2_diff": 0.478515625, "l2_diff_relative": 0.11342592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:14.094729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5949638186715125, "overlap_percentage": 0.7460530598958334, "num_intersection": 73340, "num_union": 123268, "num_only_computed": 24964, "num_only_roped": 24964, "total_diff": 49928, "diff_percentage": 0.4050361813284875, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:14.337066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 0.00019073486328125, "l2_diff": 0.61328125, "l2_diff_relative": 0.14324817518248176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:23.109638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5532989652486741, "overlap_percentage": 0.7124178636919315, "num_intersection": 74593, "num_union": 134815, "num_only_computed": 30111, "num_only_roped": 30111, "total_diff": 60222, "diff_percentage": 0.4467010347513259, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:23.387270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 0.00014972686767578125, "l2_diff": 0.578125, "l2_diff_relative": 0.13214285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:32.378233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5122934957527856, "overlap_percentage": 0.6775053879310344, "num_intersection": 75447, "num_union": 147273, "num_only_computed": 35913, "num_only_roped": 35913, "total_diff": 71826, "diff_percentage": 0.48770650424721435, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:35.059080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 0.000118255615234375, "l2_diff": 0.55859375, "l2_diff_relative": 0.12588028169014084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:45.159363", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47797656774582215, "overlap_percentage": 0.6467985733695653, "num_intersection": 76167, "num_union": 159353, "num_only_computed": 41593, "num_only_roped": 41593, "total_diff": 83186, "diff_percentage": 0.5220234322541778, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:45.509176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 0.00013446807861328125, "l2_diff": 0.74609375, "l2_diff_relative": 0.1657986111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:59.384017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45475804895730415, "overlap_percentage": 0.6252009387860082, "num_intersection": 77785, "num_union": 171047, "num_only_computed": 46631, "num_only_roped": 46631, "total_diff": 93262, "diff_percentage": 0.5452419510426959, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:02.363765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 9.1552734375e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.12059859154929578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:14.699643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4317063446550773, "overlap_percentage": 0.6030654907226562, "num_intersection": 79045, "num_union": 183099, "num_only_computed": 52027, "num_only_roped": 52027, "total_diff": 104054, "diff_percentage": 0.5682936553449227, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:16.526383", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:29.941429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40791151394116293, "overlap_percentage": 0.5794561801675978, "num_intersection": 79659, "num_union": 195285, "num_only_computed": 57813, "num_only_roped": 57813, "total_diff": 115626, "diff_percentage": 0.5920884860588371, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:30.391688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 8.440017700195312e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.12852112676056338}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:44.914747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38810181930252047, "overlap_percentage": 0.5591835035523979, "num_intersection": 80594, "num_union": 207662, "num_only_computed": 63534, "num_only_roped": 63534, "total_diff": 127068, "diff_percentage": 0.6118981806974796, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:45.412557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 7.104873657226562e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.12582236842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:01.496424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38137101954666425, "overlap_percentage": 0.5521630527210885, "num_intersection": 83116, "num_union": 217940, "num_only_computed": 67412, "num_only_roped": 67412, "total_diff": 134824, "diff_percentage": 0.6186289804533358, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:02.045832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.0798611111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:19.947644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36783434640537094, "overlap_percentage": 0.5378346396579805, "num_intersection": 84539, "num_union": 229829, "num_only_computed": 72645, "num_only_roped": 72645, "total_diff": 145290, "diff_percentage": 0.6321656535946291, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:20.541859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.265625, "l2_diff_relative": 0.06439393939393939}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:38.982890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35189883862450233, "overlap_percentage": 0.520599365234375, "num_intersection": 85295, "num_union": 242385, "num_only_computed": 78545, "num_only_roped": 78545, "total_diff": 157090, "diff_percentage": 0.6481011613754977, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:39.597922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.326171875, "l2_diff_relative": 0.08383534136546185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:59.429297", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3457707509881423, "overlap_percentage": 0.5138627819548872, "num_intersection": 87480, "num_union": 253000, "num_only_computed": 82760, "num_only_roped": 82760, "total_diff": 165520, "diff_percentage": 0.6542292490118577, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:57:00.099005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.400390625, "l2_diff_relative": 0.10858050847457627}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:57:20.978971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3287363574223885, "overlap_percentage": 0.494810510130246, "num_intersection": 87530, "num_union": 266262, "num_only_computed": 89366, "num_only_roped": 89366, "total_diff": 178732, "diff_percentage": 0.6712636425776115, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:57:21.672047", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.458984375, "l2_diff_relative": 0.12553418803418803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:57:44.474923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3175056694232103, "overlap_percentage": 0.4819799668296089, "num_intersection": 88345, "num_union": 278247, "num_only_computed": 94951, "num_only_roped": 94951, "total_diff": 189902, "diff_percentage": 0.6824943305767897, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:57:45.201574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.11096014492753623}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:58:08.498697", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3012238019721947, "overlap_percentage": 0.46298538578167114, "num_intersection": 87945, "num_union": 291959, "num_only_computed": 102007, "num_only_roped": 102007, "total_diff": 204014, "diff_percentage": 0.6987761980278053, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:58:09.279186", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.296875, "l2_diff_relative": 0.0673758865248227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:58:33.699480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28620072681122205, "overlap_percentage": 0.4450327555338542, "num_intersection": 87497, "num_union": 305719, "num_only_computed": 109111, "num_only_roped": 109111, "total_diff": 218222, "diff_percentage": 0.7137992731887779, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:58:34.518028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.08346774193548387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:00.339498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2791491158151419, "overlap_percentage": 0.43646063209331654, "num_intersection": 88605, "num_union": 317411, "num_only_computed": 114403, "num_only_roped": 114403, "total_diff": 228806, "diff_percentage": 0.7208508841848581, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:01.210243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.10517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:28.439677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27171598925194246, "overlap_percentage": 0.42732181013431014, "num_intersection": 89594, "num_union": 329734, "num_only_computed": 120070, "num_only_roped": 120070, "total_diff": 240140, "diff_percentage": 0.7282840107480575, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:29.349051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.515625, "l2_diff_relative": 0.1064516129032258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:57.800102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2603665063480906, "overlap_percentage": 0.4131599896327014, "num_intersection": 89269, "num_union": 342859, "num_only_computed": 126795, "num_only_roped": 126795, "total_diff": 253590, "diff_percentage": 0.7396334936519093, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:58.757398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.298828125, "l2_diff_relative": 0.06830357142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:00:29.419469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2536975691033799, "overlap_percentage": 0.40471892959770117, "num_intersection": 90139, "num_union": 355301, "num_only_computed": 132581, "num_only_roped": 132581, "total_diff": 265162, "diff_percentage": 0.7463024308966201, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:00:30.448051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:02.216579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2518986478189087, "overlap_percentage": 0.4024265834263393, "num_intersection": 92307, "num_union": 366445, "num_only_computed": 137069, "num_only_roped": 137069, "total_diff": 274138, "diff_percentage": 0.7481013521810913, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:05.250446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.14930555555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:37.531350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24259728213466003, "overlap_percentage": 0.3904680713897937, "num_intersection": 92063, "num_union": 379489, "num_only_computed": 143713, "num_only_roped": 143713, "total_diff": 287426, "diff_percentage": 0.75740271786534, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:38.620197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.16885964912280702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:12.533823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23562450943415458, "overlap_percentage": 0.3813852956705385, "num_intersection": 92460, "num_union": 392404, "num_only_computed": 149972, "num_only_roped": 149972, "total_diff": 299944, "diff_percentage": 0.7643754905658454, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:14.863508", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.1937229437229437}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:50.158719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22983245193495774, "overlap_percentage": 0.3737622170781893, "num_intersection": 93004, "num_union": 404660, "num_only_computed": 155828, "num_only_roped": 155828, "total_diff": 311656, "diff_percentage": 0.7701675480650423, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:51.326867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.18571428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:27.886336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2251916999554019, "overlap_percentage": 0.36760239228456915, "num_intersection": 93918, "num_union": 417058, "num_only_computed": 161570, "num_only_roped": 161570, "total_diff": 323140, "diff_percentage": 0.7748083000445981, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:29.093004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.6328125, "l2_diff_relative": 0.16804979253112035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:06.823435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21632694725803983, "overlap_percentage": 0.35570526123046875, "num_intersection": 93246, "num_union": 431042, "num_only_computed": 168898, "num_only_roped": 168898, "total_diff": 337796, "diff_percentage": 0.7836730527419602, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:08.093476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.17647058823529413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:47.416434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20891161760535165, "overlap_percentage": 0.3456193398474738, "num_intersection": 92814, "num_union": 444274, "num_only_computed": 175730, "num_only_roped": 175730, "total_diff": 351460, "diff_percentage": 0.7910883823946483, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:48.724410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.20566502463054187}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:05:29.338472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20022940431201602, "overlap_percentage": 0.3336518895348837, "num_intersection": 91821, "num_union": 458579, "num_only_computed": 183379, "num_only_roped": 183379, "total_diff": 366758, "diff_percentage": 0.7997705956879839, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:05:30.643559", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.80859375, "l2_diff_relative": 0.25492610837438423}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:06:12.373627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2012012012012012, "overlap_percentage": 0.335, "num_intersection": 94336, "num_union": 468864, "num_only_computed": 187264, "num_only_roped": 187264, "total_diff": 374528, "diff_percentage": 0.7987987987987988, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:06:13.760456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.8515625, "l2_diff_relative": 0.2658536585365854}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:06:57.395761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2006839486580319, "overlap_percentage": 0.3342827209147424, "num_intersection": 96359, "num_union": 480153, "num_only_computed": 191897, "num_only_roped": 191897, "total_diff": 383794, "diff_percentage": 0.799316051341968, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:06:58.804272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 5.936622619628906e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.3404761904761905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:07:43.574299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1923296178150812, "overlap_percentage": 0.3226114908854167, "num_intersection": 95142, "num_union": 494682, "num_only_computed": 199770, "num_only_roped": 199770, "total_diff": 399540, "diff_percentage": 0.8076703821849188, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:07:45.035763", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.4894179894179894}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:08:32.648996", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17635208732690197, "overlap_percentage": 0.2998287489379779, "num_intersection": 90342, "num_union": 512282, "num_only_computed": 210970, "num_only_roped": 210970, "total_diff": 421940, "diff_percentage": 0.823647912673098, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:08:34.184714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 8.20159912109375e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.6}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:09:21.862410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1679545208897856, "overlap_percentage": 0.2876045563175395, "num_intersection": 88573, "num_union": 527363, "num_only_computed": 219395, "num_only_roped": 219395, "total_diff": 438790, "diff_percentage": 0.8320454791102144, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:09:24.867813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 9.632110595703125e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.8333333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:10:14.565245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16198903686290164, "overlap_percentage": 0.27881336522801303, "num_intersection": 87650, "num_union": 541086, "num_only_computed": 226718, "num_only_roped": 226718, "total_diff": 453436, "diff_percentage": 0.8380109631370983, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:10:16.200440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 0.00010776519775390625, "l2_diff": 2.15625, "l2_diff_relative": 1.1129032258064515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:11:08.088630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15768386774540794, "overlap_percentage": 0.27241265450558216, "num_intersection": 87451, "num_union": 554597, "num_only_computed": 233573, "num_only_roped": 233573, "total_diff": 467146, "diff_percentage": 0.8423161322545921, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:11:09.760076", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.343292236328125e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.5906735751295337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:12:00.902382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16148332990691971, "overlap_percentage": 0.27806396484375, "num_intersection": 91116, "num_union": 564244, "num_only_computed": 236564, "num_only_roped": 236564, "total_diff": 473128, "diff_percentage": 0.8385166700930803, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:12:02.590544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 0.00010013580322265625, "l2_diff": 2.15625, "l2_diff_relative": 0.8263473053892215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:12:55.616629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.154577893745518, "overlap_percentage": 0.2677652059386973, "num_intersection": 89455, "num_union": 578705, "num_only_computed": 244625, "num_only_roped": 244625, "total_diff": 489250, "diff_percentage": 0.845422106254482, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:12:57.432596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.5239234449760766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:13:53.118398", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15679993753193425, "overlap_percentage": 0.2710925760706236, "num_intersection": 92371, "num_union": 589101, "num_only_computed": 248365, "num_only_roped": 248365, "total_diff": 496730, "diff_percentage": 0.8432000624680658, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:13:54.978978", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.726119995117188e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.8509316770186336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:14:51.953119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15071817124066444, "overlap_percentage": 0.2619549686578171, "num_intersection": 90934, "num_union": 603338, "num_only_computed": 256202, "num_only_roped": 256202, "total_diff": 512404, "diff_percentage": 0.8492818287593356, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:14:53.848569", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.5392670157068062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:15:53.899009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14873686415018986, "overlap_percentage": 0.2589572404124457, "num_intersection": 91617, "num_union": 615967, "num_only_computed": 262175, "num_only_roped": 262175, "total_diff": 524350, "diff_percentage": 0.8512631358498102, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:15:55.803047", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.9609375, "l2_diff_relative": 0.7514970059880239}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:16:55.957305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14354422950325585, "overlap_percentage": 0.25105146928267047, "num_intersection": 90491, "num_union": 630405, "num_only_computed": 269957, "num_only_roped": 269957, "total_diff": 539914, "diff_percentage": 0.8564557704967442, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:16:57.966261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.49130434782608695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:18:01.501435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14470976448837264, "overlap_percentage": 0.25283223569434754, "num_intersection": 92751, "num_union": 640945, "num_only_computed": 274097, "num_only_roped": 274097, "total_diff": 548194, "diff_percentage": 0.8552902355116274, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:18:03.549848", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.6055555555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:19:06.179770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14097016555345623, "overlap_percentage": 0.2471057873543523, "num_intersection": 92295, "num_union": 654713, "num_only_computed": 281209, "num_only_roped": 281209, "total_diff": 562418, "diff_percentage": 0.8590298344465438, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:19:08.346397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.740506329113924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:20:12.492005", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14195880394676527, "overlap_percentage": 0.24862333642183287, "num_intersection": 94453, "num_union": 665355, "num_only_computed": 285451, "num_only_roped": 285451, "total_diff": 570902, "diff_percentage": 0.8580411960532347, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:20:16.044326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.9453125, "l2_diff_relative": 0.8469387755102041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:21.030750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14303793912530513, "overlap_percentage": 0.25027680049668877, "num_intersection": 96747, "num_union": 676373, "num_only_computed": 289813, "num_only_roped": 289813, "total_diff": 579626, "diff_percentage": 0.8569620608746948, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:25.232004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.7265625, "l2_diff_relative": 0.7416107382550335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:22:32.353817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14123682167449084, "overlap_percentage": 0.2475153605143229, "num_intersection": 97327, "num_union": 689105, "num_only_computed": 295889, "num_only_roped": 295889, "total_diff": 591778, "diff_percentage": 0.8587631783255092, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:22:35.224061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 7.2479248046875e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.7105263157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:23:44.100062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14338851192341093, "overlap_percentage": 0.25081328074951953, "num_intersection": 100229, "num_union": 699003, "num_only_computed": 299387, "num_only_roped": 299387, "total_diff": 598774, "diff_percentage": 0.856611488076589, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:23:47.255120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.8125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:24:58.396731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14589523770573876, "overlap_percentage": 0.25463974873976053, "num_intersection": 103453, "num_union": 709091, "num_only_computed": 302819, "num_only_roped": 302819, "total_diff": 605638, "diff_percentage": 0.8541047622942612, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:25:00.762875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.2479248046875e-05, "l2_diff": 1.8515625, "l2_diff_relative": 0.7847682119205298}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:26:12.899383", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14531055508451643, "overlap_percentage": 0.2537487399193548, "num_intersection": 104715, "num_union": 720629, "num_only_computed": 307957, "num_only_roped": 307957, "total_diff": 615914, "diff_percentage": 0.8546894449154836, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:26:16.973460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 7.724761962890625e-05, "l2_diff": 1.96875, "l2_diff_relative": 0.8456375838926175}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:27:30.770303", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.142589332911896, "overlap_percentage": 0.2495898199023199, "num_intersection": 104660, "num_union": 733996, "num_only_computed": 314668, "num_only_roped": 314668, "total_diff": 629336, "diff_percentage": 0.857410667088104, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:27:33.335264", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 7.867813110351562e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.952054794520548}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:28:49.146470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13621032950003534, "overlap_percentage": 0.23976252629206732, "num_intersection": 102135, "num_union": 749833, "num_only_computed": 323849, "num_only_roped": 323849, "total_diff": 647698, "diff_percentage": 0.8637896704999647, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:28:51.948975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.6748466257668712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:30:09.058458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13391377320885345, "overlap_percentage": 0.23619745411486087, "num_intersection": 102128, "num_union": 762640, "num_only_computed": 330256, "num_only_roped": 330256, "total_diff": 660512, "diff_percentage": 0.8660862267911466, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:30:13.014346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.125, "l2_diff_relative": 0.8395061728395061}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:31:32.313419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13181767794858046, "overlap_percentage": 0.23293094023323616, "num_intersection": 102266, "num_union": 775814, "num_only_computed": 336774, "num_only_roped": 336774, "total_diff": 673548, "diff_percentage": 0.8681823220514195, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:31:36.497108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.009506225585938e-05, "l2_diff": 1.8515625, "l2_diff_relative": 0.7745098039215687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:32:56.956304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1302657687603717, "overlap_percentage": 0.23050466954022988, "num_intersection": 102676, "num_union": 788204, "num_only_computed": 342764, "num_only_roped": 342764, "total_diff": 685528, "diff_percentage": 0.8697342312396283, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:32:59.858367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.8225806451612904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:34:21.888595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12173305692951082, "overlap_percentage": 0.21704460999433747, "num_intersection": 98125, "num_union": 806067, "num_only_computed": 353971, "num_only_roped": 353971, "total_diff": 707942, "diff_percentage": 0.8782669430704891, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:34:26.164709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.96875, "l2_diff_relative": 0.9264705882352942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:35:50.426585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12740686492557304, "overlap_percentage": 0.22601754324776785, "num_intersection": 103686, "num_union": 813818, "num_only_computed": 355066, "num_only_roped": 355066, "total_diff": 710132, "diff_percentage": 0.8725931350744269, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:35:53.292120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 7.104873657226562e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.9290780141843972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:37:19.206053", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12904807444913177, "overlap_percentage": 0.2285962438084755, "num_intersection": 106332, "num_union": 823972, "num_only_computed": 358820, "num_only_roped": 358820, "total_diff": 717640, "diff_percentage": 0.8709519255508682, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:37:23.802275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1826171875, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.9296875, "l2_diff_relative": 0.8458904109589042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:38:51.832668", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12527435890312005, "overlap_percentage": 0.22265567132487285, "num_intersection": 99198, "num_union": 791846, "num_only_computed": 346324, "num_only_roped": 346324, "total_diff": 692648, "diff_percentage": 0.87472564109688, "num_computed": 445522, "num_roped": 445522}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 242, "seq_len_k": 15858, "queries_shape": [1, 32, 242, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 242, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:38:54.777292", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.90625, "l2_diff_relative": 0.7218934911242604}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 242, "seq_len_k": 15858, "queries_shape": [1, 32, 242, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 242, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:40:17.237499", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12084161309175921, "overlap_percentage": 0.2156265643250459, "num_intersection": 10338, "num_union": 85550, "num_only_computed": 37606, "num_only_roped": 37606, "total_diff": 75212, "diff_percentage": 0.8791583869082408, "num_computed": 47944, "num_roped": 47944}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:40:19.584881", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08447265625, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.400390625, "l2_diff_relative": 0.4149797570850202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:41:24.690353", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12473315035071668, "overlap_percentage": 0.2218004338394794, "num_intersection": 409, "num_union": 3279, "num_only_computed": 1435, "num_only_roped": 1435, "total_diff": 2870, "diff_percentage": 0.8752668496492834, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:41:26.492631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.05859375, "l2_diff_relative": 0.32608695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:02.159807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:02.494711", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.0728836059570312e-05, "l2_diff": 0.01806640625, "l2_diff_relative": 0.002890625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:04.593264", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8656543174420831, "overlap_percentage": 0.9279900454752452, "num_intersection": 72341, "num_union": 83568, "num_only_computed": 6251, "num_only_roped": 4976, "total_diff": 11227, "diff_percentage": 0.1343456825579169, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:04.728296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.08740234375, "l2_diff_relative": 0.017371894409937888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:09.410755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7417285721604591, "overlap_percentage": 0.8517154555722891, "num_intersection": 72389, "num_union": 97595, "num_only_computed": 12603, "num_only_roped": 12603, "total_diff": 25206, "diff_percentage": 0.25827142783954093, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:09.580067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 0.0001468658447265625, "l2_diff": 0.345703125, "l2_diff_relative": 0.07091346153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:15.316235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6639221488938716, "overlap_percentage": 0.798020687849162, "num_intersection": 73137, "num_union": 110159, "num_only_computed": 18511, "num_only_roped": 18511, "total_diff": 37022, "diff_percentage": 0.3360778511061284, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:16.622995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 0.0001850128173828125, "l2_diff": 0.484375, "l2_diff_relative": 0.11654135338345864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:23.403782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.605749754982032, "overlap_percentage": 0.7544759114583334, "num_intersection": 74168, "num_union": 122440, "num_only_computed": 24136, "num_only_roped": 24136, "total_diff": 48272, "diff_percentage": 0.39425024501796796, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:23.641090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.000141143798828125, "l2_diff": 0.482421875, "l2_diff_relative": 0.11435185185185186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:32.284151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5535755354585988, "overlap_percentage": 0.7126470812958435, "num_intersection": 74617, "num_union": 134791, "num_only_computed": 30087, "num_only_roped": 30087, "total_diff": 60174, "diff_percentage": 0.4464244645414011, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:32.557455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.00011491775512695312, "l2_diff": 0.453125, "l2_diff_relative": 0.10069444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:41.466640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5167942466425127, "overlap_percentage": 0.6814295977011494, "num_intersection": 75884, "num_union": 146836, "num_only_computed": 35476, "num_only_roped": 35476, "total_diff": 70952, "diff_percentage": 0.4832057533574873, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:44.465641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.00014019012451171875, "l2_diff": 0.63671875, "l2_diff_relative": 0.1455357142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:54.560428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47777254901960786, "overlap_percentage": 0.6466117527173914, "num_intersection": 76145, "num_union": 159375, "num_only_computed": 41615, "num_only_roped": 41615, "total_diff": 83230, "diff_percentage": 0.5222274509803921, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:42:54.910121", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00014972686767578125, "l2_diff": 0.76171875, "l2_diff_relative": 0.18606870229007633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:06.050122", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4571689583284533, "overlap_percentage": 0.6274755658436214, "num_intersection": 78068, "num_union": 170764, "num_only_computed": 46348, "num_only_roped": 46348, "total_diff": 92696, "diff_percentage": 0.5428310416715467, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:06.438703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 0.000133514404296875, "l2_diff": 0.69921875, "l2_diff_relative": 0.18723849372384938}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:18.692568", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43930775481518897, "overlap_percentage": 0.610443115234375, "num_intersection": 80012, "num_union": 182132, "num_only_computed": 51060, "num_only_roped": 51060, "total_diff": 102120, "diff_percentage": 0.560692245184811, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:19.113029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.0001354217529296875, "l2_diff": 0.7578125, "l2_diff_relative": 0.189453125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:33.096295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4153111230078656, "overlap_percentage": 0.586883147113594, "num_intersection": 80680, "num_union": 194264, "num_only_computed": 56792, "num_only_roped": 56792, "total_diff": 113584, "diff_percentage": 0.5846888769921345, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:33.560228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 0.00011777877807617188, "l2_diff": 0.7109375, "l2_diff_relative": 0.1864754098360656}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:48.156320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3842954767015795, "overlap_percentage": 0.5552217473357016, "num_intersection": 80023, "num_union": 208233, "num_only_computed": 64105, "num_only_roped": 64105, "total_diff": 128210, "diff_percentage": 0.6157045232984205, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:48.659494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 9.012222290039062e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.16255144032921812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:04.350203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3725790567895831, "overlap_percentage": 0.5428890306122449, "num_intersection": 81720, "num_union": 219336, "num_only_computed": 68808, "num_only_roped": 68808, "total_diff": 137616, "diff_percentage": 0.6274209432104169, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:04.888643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08837890625, "mean_diff": 0.00010156631469726562, "l2_diff": 0.76953125, "l2_diff_relative": 0.2122844827586207}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:24.331593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37068510710657465, "overlap_percentage": 0.5408756616449512, "num_intersection": 85017, "num_union": 229351, "num_only_computed": 72167, "num_only_roped": 72167, "total_diff": 144334, "diff_percentage": 0.6293148928934253, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:24.906975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.00010156631469726562, "l2_diff": 0.74609375, "l2_diff_relative": 0.2076086956521739}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:43.368942", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3642305802809396, "overlap_percentage": 0.53397216796875, "num_intersection": 87486, "num_union": 240194, "num_only_computed": 76354, "num_only_roped": 76354, "total_diff": 152708, "diff_percentage": 0.6357694197190604, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:43.984471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 6.4849853515625e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.1346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:03.332878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33687235947291544, "overlap_percentage": 0.5039708646616541, "num_intersection": 85796, "num_union": 254684, "num_only_computed": 84444, "num_only_roped": 84444, "total_diff": 168888, "diff_percentage": 0.6631276405270845, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:04.788797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.17231075697211157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:25.373762", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32792841485752033, "overlap_percentage": 0.49389471780028943, "num_intersection": 87368, "num_union": 266424, "num_only_computed": 89528, "num_only_roped": 89528, "total_diff": 179056, "diff_percentage": 0.6720715851424797, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:26.070468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 6.628036499023438e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.15461847389558234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:47.799159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3212046073781481, "overlap_percentage": 0.48622992318435754, "num_intersection": 89124, "num_union": 277468, "num_only_computed": 94172, "num_only_roped": 94172, "total_diff": 188344, "diff_percentage": 0.6787953926218518, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:48.536008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.16468253968253968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:46:11.667472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3087501722474852, "overlap_percentage": 0.47182446091644203, "num_intersection": 89624, "num_union": 290280, "num_only_computed": 100328, "num_only_roped": 100328, "total_diff": 200656, "diff_percentage": 0.6912498277525149, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:46:14.941123", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.17886178861788618}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:46:39.830306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29230041146853514, "overlap_percentage": 0.4523722330729167, "num_intersection": 88940, "num_union": 304276, "num_only_computed": 107668, "num_only_roped": 107668, "total_diff": 215336, "diff_percentage": 0.7076995885314649, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:46:42.455470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07080078125, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.16447368421052633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:47:08.004696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2812076957788079, "overlap_percentage": 0.43897284836065575, "num_intersection": 89115, "num_union": 316901, "num_only_computed": 113893, "num_only_roped": 113893, "total_diff": 227786, "diff_percentage": 0.7187923042211921, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:47:10.168287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.888938903808594e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.18037974683544303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:47:37.340874", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.264346190028222, "overlap_percentage": 0.4181547619047619, "num_intersection": 87672, "num_union": 331656, "num_only_computed": 121992, "num_only_roped": 121992, "total_diff": 243984, "diff_percentage": 0.735653809971778, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:47:38.240543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 6.723403930664062e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.23376623376623376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:48:06.827060", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2586997870747685, "overlap_percentage": 0.4110587603672986, "num_intersection": 88815, "num_union": 343313, "num_only_computed": 127249, "num_only_roped": 127249, "total_diff": 254498, "diff_percentage": 0.7413002129252315, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:48:07.765672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.2094017094017094}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:48:37.148413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25232294322881377, "overlap_percentage": 0.40296785201149427, "num_intersection": 89749, "num_union": 355691, "num_only_computed": 132971, "num_only_roped": 132971, "total_diff": 265942, "diff_percentage": 0.7476770567711862, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:48:38.136900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.23809523809523808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:49:08.794853", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23826053157921728, "overlap_percentage": 0.38483101981026785, "num_intersection": 88271, "num_union": 370481, "num_only_computed": 141105, "num_only_roped": 141105, "total_diff": 282210, "diff_percentage": 0.7617394684207827, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:49:09.824872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.23306772908366533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:49:42.284640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24649948057234847, "overlap_percentage": 0.3955067521715527, "num_intersection": 93251, "num_union": 378301, "num_only_computed": 142525, "num_only_roped": 142525, "total_diff": 285050, "diff_percentage": 0.7535005194276515, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:49:43.356381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.2122844827586207}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:50:16.712901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24088334728119137, "overlap_percentage": 0.3882449511615628, "num_intersection": 94123, "num_union": 390741, "num_only_computed": 148309, "num_only_roped": 148309, "total_diff": 296618, "diff_percentage": 0.7591166527188086, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:50:17.833440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.18416030534351144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:50:53.260363", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23808718237047283, "overlap_percentage": 0.3846048739711934, "num_intersection": 95702, "num_union": 401962, "num_only_computed": 153130, "num_only_roped": 153130, "total_diff": 306260, "diff_percentage": 0.7619128176295271, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:50:54.408807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.8671875, "l2_diff_relative": 0.1982142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:51:31.017056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23895195744206232, "overlap_percentage": 0.3857324023046092, "num_intersection": 98550, "num_union": 412426, "num_only_computed": 156938, "num_only_roped": 156938, "total_diff": 313876, "diff_percentage": 0.7610480425579377, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:51:33.526608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.20496323529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:52:11.519930", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24729801422185427, "overlap_percentage": 0.3965339660644531, "num_intersection": 103949, "num_union": 420339, "num_only_computed": 158195, "num_only_roped": 158195, "total_diff": 316390, "diff_percentage": 0.7527019857781457, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:52:14.916113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 2.8133392333984375e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.12037037037037036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:52:54.247227", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23197188720014314, "overlap_percentage": 0.376586332221163, "num_intersection": 101130, "num_union": 435958, "num_only_computed": 167414, "num_only_roped": 167414, "total_diff": 334828, "diff_percentage": 0.7680281127998568, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:52:57.106730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:53:37.787475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21192904578202892, "overlap_percentage": 0.3497383720930233, "num_intersection": 96248, "num_union": 454152, "num_only_computed": 178952, "num_only_roped": 178952, "total_diff": 357904, "diff_percentage": 0.788070954217971, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:53:39.126948", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.41796875, "l2_diff_relative": 0.1148068669527897}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:54:20.868956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20593374216314364, "overlap_percentage": 0.3415340909090909, "num_intersection": 96176, "num_union": 467024, "num_only_computed": 185424, "num_only_roped": 185424, "total_diff": 370848, "diff_percentage": 0.7940662578368564, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:54:22.264687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.23786407766990292}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:55:05.227046", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2007214592471331, "overlap_percentage": 0.3343347579928952, "num_intersection": 96374, "num_union": 480138, "num_only_computed": 191882, "num_only_roped": 191882, "total_diff": 383764, "diff_percentage": 0.7992785407528669, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:55:06.653970", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 5.745887756347656e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.3434065934065934}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:55:51.541357", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18800920881161615, "overlap_percentage": 0.3165113661024306, "num_intersection": 93343, "num_union": 496481, "num_only_computed": 201569, "num_only_roped": 201569, "total_diff": 403138, "diff_percentage": 0.8119907911883838, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:55:53.068697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.42528735632183906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:56:41.818261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17966576815185878, "overlap_percentage": 0.30460452952421413, "num_intersection": 91781, "num_union": 510843, "num_only_computed": 209531, "num_only_roped": 209531, "total_diff": 419062, "diff_percentage": 0.8203342318481412, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:56:43.399206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.866455078125e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.4697802197802198}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:57:31.645945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1695601730977007, "overlap_percentage": 0.2899554499168745, "num_intersection": 89297, "num_union": 526639, "num_only_computed": 218671, "num_only_roped": 218671, "total_diff": 437342, "diff_percentage": 0.8304398269022993, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:57:34.753282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 8.58306884765625e-05, "l2_diff": 1.6796875, "l2_diff_relative": 0.7119205298013245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:58:25.014934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15809153317234811, "overlap_percentage": 0.27302079092019543, "num_intersection": 85829, "num_union": 542907, "num_only_computed": 228539, "num_only_roped": 228539, "total_diff": 457078, "diff_percentage": 0.8419084668276519, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:58:28.615923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.6352941176470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:59:20.477988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1562349178450257, "overlap_percentage": 0.27024770733652315, "num_intersection": 86756, "num_union": 555292, "num_only_computed": 234268, "num_only_roped": 234268, "total_diff": 468536, "diff_percentage": 0.8437650821549744, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:59:24.610301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.75, "l2_diff_relative": 0.6627218934911243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:00:17.575634", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14639965854307047, "overlap_percentage": 0.25540771484375, "num_intersection": 83692, "num_union": 571668, "num_only_computed": 243988, "num_only_roped": 243988, "total_diff": 487976, "diff_percentage": 0.8536003414569295, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:00:21.712926", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.4265402843601896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:01:15.968050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15132310141795943, "overlap_percentage": 0.26286817528735634, "num_intersection": 87819, "num_union": 580341, "num_only_computed": 246261, "num_only_roped": 246261, "total_diff": 492522, "diff_percentage": 0.8486768985820405, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:01:17.751099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 8.916854858398438e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.8598726114649682}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:13.861066", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15329756807527628, "overlap_percentage": 0.26584217693463563, "num_intersection": 90582, "num_union": 590890, "num_only_computed": 250154, "num_only_roped": 250154, "total_diff": 500308, "diff_percentage": 0.8467024319247237, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:15.651043", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 8.821487426757812e-05, "l2_diff": 1.7421875, "l2_diff_relative": 0.832089552238806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:03:11.637414", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.150908928151078, "overlap_percentage": 0.26224304019174044, "num_intersection": 91034, "num_union": 603238, "num_only_computed": 256102, "num_only_roped": 256102, "total_diff": 512204, "diff_percentage": 0.849091071848922, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:03:13.526433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 9.393692016601562e-05, "l2_diff": 1.9609375, "l2_diff_relative": 0.9728682170542635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:04:11.440212", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14564939680422, "overlap_percentage": 0.2542652179811867, "num_intersection": 89957, "num_union": 617627, "num_only_computed": 263835, "num_only_roped": 263835, "total_diff": 527670, "diff_percentage": 0.8543506031957799, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:04:13.318804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.9296875, "l2_diff_relative": 0.7180232558139535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:05:14.320413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.147713396432182, "overlap_percentage": 0.25740467418323865, "num_intersection": 92781, "num_union": 628115, "num_only_computed": 267667, "num_only_roped": 267667, "total_diff": 535334, "diff_percentage": 0.852286603567818, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:05:16.275138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 8.153915405273438e-05, "l2_diff": 1.9765625, "l2_diff_relative": 0.7228571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:06:17.730928", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1433771965366562, "overlap_percentage": 0.2507959699930216, "num_intersection": 92004, "num_union": 641692, "num_only_computed": 274844, "num_only_roped": 274844, "total_diff": 549688, "diff_percentage": 0.8566228034633437, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:06:20.846421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.203125, "mean_diff": 9.012222290039062e-05, "l2_diff": 2.25, "l2_diff_relative": 0.9863013698630136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:07:24.294014", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14137635985820804, "overlap_percentage": 0.24772960932145305, "num_intersection": 92528, "num_union": 654480, "num_only_computed": 280976, "num_only_roped": 280976, "total_diff": 561952, "diff_percentage": 0.8586236401417919, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:07:26.378598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.62939453125e-05, "l2_diff": 1.8828125, "l2_diff_relative": 0.6769662921348315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:08:31.752003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1477063485709711, "overlap_percentage": 0.2573939732142857, "num_intersection": 97785, "num_union": 662023, "num_only_computed": 282119, "num_only_roped": 282119, "total_diff": 564238, "diff_percentage": 0.8522936514290289, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:08:33.813907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.6862068965517242}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:09:40.116416", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1423589819363895, "overlap_percentage": 0.2492368584437086, "num_intersection": 96345, "num_union": 676775, "num_only_computed": 290215, "num_only_roped": 290215, "total_diff": 580430, "diff_percentage": 0.8576410180636105, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:09:42.319019", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.96453857421875e-05, "l2_diff": 2.015625, "l2_diff_relative": 1.0886075949367089}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:10:50.956541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14131300802979135, "overlap_percentage": 0.2476323445638021, "num_intersection": 97373, "num_union": 689059, "num_only_computed": 295843, "num_only_roped": 295843, "total_diff": 591686, "diff_percentage": 0.8586869919702087, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:10:53.203663", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.7738037109375e-05, "l2_diff": 2.25, "l2_diff_relative": 0.96}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:12:02.572560", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14047777712771498, "overlap_percentage": 0.24634899503523383, "num_intersection": 98445, "num_union": 700787, "num_only_computed": 301171, "num_only_roped": 301171, "total_diff": 602342, "diff_percentage": 0.859522222872285, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:12:04.814295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2109375, "mean_diff": 9.202957153320312e-05, "l2_diff": 2.34375, "l2_diff_relative": 1.1952191235059761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:13:16.513936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13775228728334868, "overlap_percentage": 0.2421481175173283, "num_intersection": 98378, "num_union": 714166, "num_only_computed": 307894, "num_only_roped": 307894, "total_diff": 615788, "diff_percentage": 0.8622477127166513, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:13:20.697375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1982421875, "mean_diff": 8.20159912109375e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.9337748344370861}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:14:32.292803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1391518581139367, "overlap_percentage": 0.24430782800868486, "num_intersection": 100819, "num_union": 724525, "num_only_computed": 311853, "num_only_roped": 311853, "total_diff": 623706, "diff_percentage": 0.8608481418860633, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:14:34.696687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.9140625, "l2_diff_relative": 0.9007352941176471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:15:47.570592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13659815819967067, "overlap_percentage": 0.24036315247252749, "num_intersection": 100791, "num_union": 737865, "num_only_computed": 318537, "num_only_roped": 318537, "total_diff": 637074, "diff_percentage": 0.8634018418003293, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:15:52.142709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.6700680272108843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:17:06.989608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13288946865222312, "overlap_percentage": 0.23460270808293268, "num_intersection": 99937, "num_union": 752031, "num_only_computed": 326047, "num_only_roped": 326047, "total_diff": 652094, "diff_percentage": 0.8671105313477769, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:17:09.491691", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.875, "l2_diff_relative": 0.8695652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:18:27.763247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1282947870538778, "overlap_percentage": 0.22741359532267613, "num_intersection": 98330, "num_union": 766438, "num_only_computed": 334054, "num_only_roped": 334054, "total_diff": 668108, "diff_percentage": 0.8717052129461222, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:18:30.410747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.7159763313609467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:19:50.446128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12411362498735808, "overlap_percentage": 0.22082042638483965, "num_intersection": 96949, "num_union": 781131, "num_only_computed": 342091, "num_only_roped": 342091, "total_diff": 684182, "diff_percentage": 0.8758863750126419, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:19:53.055100", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.8125, "l2_diff_relative": 0.6137566137566137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:21:14.313311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12560883930432806, "overlap_percentage": 0.22318381824712644, "num_intersection": 99415, "num_union": 791465, "num_only_computed": 346025, "num_only_roped": 346025, "total_diff": 692050, "diff_percentage": 0.8743911606956719, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:21:16.993288", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.8650970458984375e-05, "l2_diff": 1.578125, "l2_diff_relative": 0.5706214689265536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:22:39.959119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1217789820280534, "overlap_percentage": 0.21711760334088334, "num_intersection": 98158, "num_union": 806034, "num_only_computed": 353938, "num_only_roped": 353938, "total_diff": 707876, "diff_percentage": 0.8782210179719466, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:22:42.656390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.7697368421052632}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:24:06.713906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12322625901790665, "overlap_percentage": 0.21941484723772323, "num_intersection": 100657, "num_union": 816847, "num_only_computed": 358095, "num_only_roped": 358095, "total_diff": 716190, "diff_percentage": 0.8767737409820934, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:24:10.751243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.7961783439490446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:25:35.259728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12051266098425932, "overlap_percentage": 0.21510272071071626, "num_intersection": 34866, "num_union": 289314, "num_only_computed": 127224, "num_only_roped": 127224, "total_diff": 254448, "diff_percentage": 0.8794873390157407, "num_computed": 162090, "num_roped": 162090}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:25:37.919808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.6547085201793722}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:26:56.586221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1124759372994775, "overlap_percentage": 0.20220830586684246, "num_intersection": 13497, "num_union": 119999, "num_only_computed": 53251, "num_only_roped": 53251, "total_diff": 106502, "diff_percentage": 0.8875240627005225, "num_computed": 66748, "num_roped": 66748}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:27:00.564408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 6.866455078125e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.7991266375545851}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:28:05.642875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11530139103554869, "overlap_percentage": 0.20676274944567627, "num_intersection": 373, "num_union": 3235, "num_only_computed": 1431, "num_only_roped": 1431, "total_diff": 2862, "diff_percentage": 0.8846986089644513, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:28:08.829422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 8.487701416015625e-05, "l2_diff": 0.12890625, "l2_diff_relative": 1.8082191780821917}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:29:04.173866", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12538989394884592, "overlap_percentage": 0.22283813747228381, "num_intersection": 402, "num_union": 3206, "num_only_computed": 1402, "num_only_roped": 1402, "total_diff": 2804, "diff_percentage": 0.8746101060511541, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:29:05.923081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.1123046875, "l2_diff_relative": 0.8214285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:29:59.345982", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11903285802851829, "overlap_percentage": 0.21274238227146813, "num_intersection": 384, "num_union": 3226, "num_only_computed": 1421, "num_only_roped": 1421, "total_diff": 2842, "diff_percentage": 0.8809671419714817, "num_computed": 1805, "num_roped": 1805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:01.082828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.07958984375, "l2_diff_relative": 0.4116161616161616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:32.281169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:32.293467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.01708984375, "l2_diff_relative": 0.0030214088397790056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:34.380751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8607113020646855, "overlap_percentage": 0.9251422304036329, "num_intersection": 72119, "num_union": 83790, "num_only_computed": 6473, "num_only_roped": 5198, "total_diff": 11671, "diff_percentage": 0.13928869793531448, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:34.517203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 0.00011301040649414062, "l2_diff": 0.1826171875, "l2_diff_relative": 0.04115316901408451}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:39.217053", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7330274761686293, "overlap_percentage": 0.8459502070783133, "num_intersection": 71899, "num_union": 98085, "num_only_computed": 13093, "num_only_roped": 13093, "total_diff": 26186, "diff_percentage": 0.26697252383137077, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:39.768443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 0.00018596649169921875, "l2_diff": 0.375, "l2_diff_relative": 0.08633093525179857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:45.513680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6556558184068143, "overlap_percentage": 0.7920194657821229, "num_intersection": 72587, "num_union": 110709, "num_only_computed": 19061, "num_only_roped": 19061, "total_diff": 38122, "diff_percentage": 0.34434418159318575, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:45.721818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 0.0001888275146484375, "l2_diff": 0.455078125, "l2_diff_relative": 0.11791497975708502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:52.577907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6071411054980627, "overlap_percentage": 0.75555419921875, "num_intersection": 74274, "num_union": 122334, "num_only_computed": 24030, "num_only_roped": 24030, "total_diff": 48060, "diff_percentage": 0.39285889450193734, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:54.365626", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 0.00016307830810546875, "l2_diff": 0.54296875, "l2_diff_relative": 0.1215034965034965}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:02.228179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5638082578467467, "overlap_percentage": 0.7210708282396088, "num_intersection": 75499, "num_union": 133909, "num_only_computed": 29205, "num_only_roped": 29205, "total_diff": 58410, "diff_percentage": 0.43619174215325335, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:02.503343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 0.00018978118896484375, "l2_diff": 0.73828125, "l2_diff_relative": 0.16996402877697842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:12.512648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5313004915947609, "overlap_percentage": 0.6939206178160919, "num_intersection": 77275, "num_union": 145445, "num_only_computed": 34085, "num_only_roped": 34085, "total_diff": 68170, "diff_percentage": 0.4686995084052391, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:12.821972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.00015544891357421875, "l2_diff": 0.7109375, "l2_diff_relative": 0.16485507246376813}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:22.799745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4992202170661065, "overlap_percentage": 0.6659731657608695, "num_intersection": 78425, "num_union": 157095, "num_only_computed": 39335, "num_only_roped": 39335, "total_diff": 78670, "diff_percentage": 0.5007797829338935, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:23.140152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 0.00013256072998046875, "l2_diff": 0.71875, "l2_diff_relative": 0.17424242424242425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:34.191799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4762483907520898, "overlap_percentage": 0.6452144418724279, "num_intersection": 80275, "num_union": 168557, "num_only_computed": 44141, "num_only_roped": 44141, "total_diff": 88282, "diff_percentage": 0.5237516092479102, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:36.043116", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.00010442733764648438, "l2_diff": 0.63671875, "l2_diff_relative": 0.16235059760956175}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:48.180763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4450759350624294, "overlap_percentage": 0.6159896850585938, "num_intersection": 80739, "num_union": 181405, "num_only_computed": 50333, "num_only_roped": 50333, "total_diff": 100666, "diff_percentage": 0.5549240649375706, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:49.791998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 0.00010538101196289062, "l2_diff": 0.640625, "l2_diff_relative": 0.16015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:03.113828", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4404325321150904, "overlap_percentage": 0.611528165735568, "num_intersection": 84068, "num_union": 190876, "num_only_computed": 53404, "num_only_roped": 53404, "total_diff": 106808, "diff_percentage": 0.5595674678849095, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:03.716102", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.12248995983935743}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:18.412065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41317200874604126, "overlap_percentage": 0.5847441163410302, "num_intersection": 84278, "num_union": 203978, "num_only_computed": 59850, "num_only_roped": 59850, "total_diff": 119700, "diff_percentage": 0.5868279912539588, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:18.915544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.16830708661417323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:34.785347", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3850889098479446, "overlap_percentage": 0.5560493728741497, "num_intersection": 83701, "num_union": 217355, "num_only_computed": 66827, "num_only_roped": 66827, "total_diff": 133654, "diff_percentage": 0.6149110901520554, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:35.315287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.13129496402877697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:52.730774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36463397694124183, "overlap_percentage": 0.5344055374592834, "num_intersection": 84000, "num_union": 230368, "num_only_computed": 73184, "num_only_roped": 73184, "total_diff": 146368, "diff_percentage": 0.6353660230587581, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:53.314340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.11348684210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:33:11.718144", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35206618390377753, "overlap_percentage": 0.520782470703125, "num_intersection": 85325, "num_union": 242355, "num_only_computed": 78515, "num_only_roped": 78515, "total_diff": 157030, "diff_percentage": 0.6479338160962225, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:33:13.794092", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.3984375, "l2_diff_relative": 0.09444444444444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:33:33.429726", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.328225573647705, "overlap_percentage": 0.49423167293233083, "num_intersection": 84138, "num_union": 256342, "num_only_computed": 86102, "num_only_roped": 86102, "total_diff": 172204, "diff_percentage": 0.671774426352295, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:33:34.077134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.29296875, "l2_diff_relative": 0.06510416666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:33:54.872963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32357650579872804, "overlap_percentage": 0.4889426555716353, "num_intersection": 86492, "num_union": 267300, "num_only_computed": 90404, "num_only_roped": 90404, "total_diff": 180808, "diff_percentage": 0.676423494201272, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:33:55.616160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.408203125, "l2_diff_relative": 0.09895833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:34:18.390275", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30974361905850745, "overlap_percentage": 0.47298358938547486, "num_intersection": 86696, "num_union": 279896, "num_only_computed": 96600, "num_only_roped": 96600, "total_diff": 193200, "diff_percentage": 0.6902563809414926, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:34:19.144661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:34:42.551074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30422572926357855, "overlap_percentage": 0.4665231216307278, "num_intersection": 88617, "num_union": 291287, "num_only_computed": 101335, "num_only_roped": 101335, "total_diff": 202670, "diff_percentage": 0.6957742707364215, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:34:43.341000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 5.888938903808594e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.1648471615720524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:35:07.939391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2865247577230878, "overlap_percentage": 0.4454243977864583, "num_intersection": 87574, "num_union": 305642, "num_only_computed": 109034, "num_only_roped": 109034, "total_diff": 218068, "diff_percentage": 0.7134752422769122, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:35:08.774048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.18565400843881857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:35:34.682898", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2905580013032215, "overlap_percentage": 0.4502827474779319, "num_intersection": 91411, "num_union": 314605, "num_only_computed": 111597, "num_only_roped": 111597, "total_diff": 223194, "diff_percentage": 0.7094419986967785, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:35:35.562536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.17666666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:36:02.850421", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2768857396033484, "overlap_percentage": 0.4336891407203907, "num_intersection": 90929, "num_union": 328399, "num_only_computed": 118735, "num_only_roped": 118735, "total_diff": 237470, "diff_percentage": 0.7231142603966516, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:36:03.752354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.15625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:36:33.139782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2772948287838257, "overlap_percentage": 0.43419079531990523, "num_intersection": 93813, "num_union": 338315, "num_only_computed": 122251, "num_only_roped": 122251, "total_diff": 244502, "diff_percentage": 0.7227051712161743, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:36:34.135112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.734375, "l2_diff_relative": 0.1934156378600823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:37:04.144019", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.264929887035491, "overlap_percentage": 0.41888469827586206, "num_intersection": 93294, "num_union": 352146, "num_only_computed": 129426, "num_only_roped": 129426, "total_diff": 258852, "diff_percentage": 0.7350701129645091, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:37:05.141427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.13858695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:37:36.319132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25455878009560584, "overlap_percentage": 0.4058140345982143, "num_intersection": 93084, "num_union": 365668, "num_only_computed": 136292, "num_only_roped": 136292, "total_diff": 272584, "diff_percentage": 0.7454412199043942, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:37:37.687641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.13068181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:38:10.028166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24659833822841296, "overlap_percentage": 0.39563399158523344, "num_intersection": 93281, "num_union": 378271, "num_only_computed": 142495, "num_only_roped": 142495, "total_diff": 284990, "diff_percentage": 0.7534016617715871, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:38:11.109494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.10836330935251799}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:38:44.688612", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24782598625204919, "overlap_percentage": 0.3972124142027455, "num_intersection": 96297, "num_union": 388567, "num_only_computed": 146135, "num_only_roped": 146135, "total_diff": 292270, "diff_percentage": 0.7521740137479508, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:38:47.697965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.07942708333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:39:22.807903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24129571014883158, "overlap_percentage": 0.3887803819444444, "num_intersection": 96741, "num_union": 400923, "num_only_computed": 152091, "num_only_roped": 152091, "total_diff": 304182, "diff_percentage": 0.7587042898511684, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:39:23.963627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.44921875, "l2_diff_relative": 0.10416666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:40:00.231387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23276758465120206, "overlap_percentage": 0.3776341745991984, "num_intersection": 96481, "num_union": 414495, "num_only_computed": 159007, "num_only_roped": 159007, "total_diff": 318014, "diff_percentage": 0.7672324153487979, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:40:01.415788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.51953125, "l2_diff_relative": 0.1269083969465649}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:40:39.612423", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22685237185967277, "overlap_percentage": 0.36981201171875, "num_intersection": 96944, "num_union": 427344, "num_only_computed": 165200, "num_only_roped": 165200, "total_diff": 330400, "diff_percentage": 0.7731476281403272, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:40:40.875390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.361701965332031e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:20.496856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2241628849954073, "overlap_percentage": 0.3662304873689228, "num_intersection": 98349, "num_union": 438739, "num_only_computed": 170195, "num_only_roped": 170195, "total_diff": 340390, "diff_percentage": 0.7758371150045927, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:21.808872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.4345855712890625e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.2002164502164502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:02.461152", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21339585496568586, "overlap_percentage": 0.3517332848837209, "num_intersection": 96797, "num_union": 453603, "num_only_computed": 178403, "num_only_roped": 178403, "total_diff": 356806, "diff_percentage": 0.7866041450343142, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:03.812933", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.20424107142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:46.027261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2035113812173586, "overlap_percentage": 0.3381960227272727, "num_intersection": 95236, "num_union": 467964, "num_only_computed": 186364, "num_only_roped": 186364, "total_diff": 372728, "diff_percentage": 0.7964886187826414, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:47.426546", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.29}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:43:31.384633", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19613261961077222, "overlap_percentage": 0.3279446047957371, "num_intersection": 94532, "num_union": 481980, "num_only_computed": 193724, "num_only_roped": 193724, "total_diff": 387448, "diff_percentage": 0.8038673803892278, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:43:32.815454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.28083700440528636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:44:18.168778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19190555674557147, "overlap_percentage": 0.3220147026909722, "num_intersection": 94966, "num_union": 494858, "num_only_computed": 199946, "num_only_roped": 199946, "total_diff": 399892, "diff_percentage": 0.8080944432544286, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:44:21.973868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 5.817413330078125e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.34375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:45:09.171423", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1718571036875276, "overlap_percentage": 0.29330726954120645, "num_intersection": 88377, "num_union": 514247, "num_only_computed": 212935, "num_only_roped": 212935, "total_diff": 425870, "diff_percentage": 0.8281428963124724, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:45:10.697811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.3224043715846995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:45:58.718008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16683053245963503, "overlap_percentage": 0.2859550342892768, "num_intersection": 88065, "num_union": 527871, "num_only_computed": 219903, "num_only_roped": 219903, "total_diff": 439806, "diff_percentage": 0.833169467540365, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:46:00.333755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 8.296966552734375e-05, "l2_diff": 1.8984375, "l2_diff_relative": 0.675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:46:50.208959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16145884326283452, "overlap_percentage": 0.2780276618485342, "num_intersection": 87403, "num_union": 541333, "num_only_computed": 226965, "num_only_roped": 226965, "total_diff": 453930, "diff_percentage": 0.8385411567371654, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:46:53.402298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.533678756476684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:47:44.453016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15511577280823274, "overlap_percentage": 0.26857182017543857, "num_intersection": 86218, "num_union": 555830, "num_only_computed": 234806, "num_only_roped": 234806, "total_diff": 469612, "diff_percentage": 0.8448842271917673, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:47:46.141409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.43865966796875e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.543859649122807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:48:40.473663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15061431877157314, "overlap_percentage": 0.261798095703125, "num_intersection": 85786, "num_union": 569574, "num_only_computed": 241894, "num_only_roped": 241894, "total_diff": 483788, "diff_percentage": 0.8493856812284268, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:48:44.789540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 7.62939453125e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.5337078651685393}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:49:34.523753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.147690648144494, "overlap_percentage": 0.25737013433588557, "num_intersection": 11227, "num_union": 76017, "num_only_computed": 32395, "num_only_roped": 32395, "total_diff": 64790, "diff_percentage": 0.852309351855506, "num_computed": 43622, "num_roped": 43622}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "mask_shape": [1, 32, 34, 10274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:49:35.945976", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.3125, "l2_diff_relative": 0.21739130434782608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "attention_shape": [1, 32, 34, 10274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:50:20.926706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15135115762310947, "overlap_percentage": 0.2629105058365759, "num_intersection": 8446, "num_union": 55804, "num_only_computed": 23679, "num_only_roped": 23679, "total_diff": 47358, "diff_percentage": 0.8486488423768905, "num_computed": 32125, "num_roped": 32125}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 25, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:50:23.337200", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.453125, "l2_diff_relative": 0.46963562753036436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 25, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:51:04.737590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15699505173189385, "overlap_percentage": 0.2713841368584759, "num_intersection": 349, "num_union": 2223, "num_only_computed": 937, "num_only_roped": 937, "total_diff": 1874, "diff_percentage": 0.8430049482681061, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "mask_shape": [1, 32, 1, 10300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:51:05.935791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 9.965896606445312e-05, "l2_diff": 0.09521484375, "l2_diff_relative": 1.1337209302325582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "attention_shape": [1, 32, 1, 10300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:51:42.599677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1554357592093441, "overlap_percentage": 0.2690513219284603, "num_intersection": 346, "num_union": 2226, "num_only_computed": 940, "num_only_roped": 940, "total_diff": 1880, "diff_percentage": 0.8445642407906558, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "mask_shape": [1, 32, 1, 10301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:51:45.977963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.057861328125, "l2_diff_relative": 0.4030612244897959}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "attention_shape": [1, 32, 1, 10301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:12.067661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:12.329441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1742115020751953e-05, "l2_diff": 0.0181884765625, "l2_diff_relative": 0.003197973901098901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:14.463529", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8565236547232046, "overlap_percentage": 0.922717739194017, "num_intersection": 71930, "num_union": 83979, "num_only_computed": 6662, "num_only_roped": 5387, "total_diff": 12049, "diff_percentage": 0.1434763452767954, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:14.602243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 5.6743621826171875e-05, "l2_diff": 0.11572265625, "l2_diff_relative": 0.022443181818181817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:19.405615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7360718188595998, "overlap_percentage": 0.8479739269578314, "num_intersection": 72071, "num_union": 97913, "num_only_computed": 12921, "num_only_roped": 12921, "total_diff": 25842, "diff_percentage": 0.2639281811404002, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:19.582410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 0.00017642974853515625, "l2_diff": 0.359375, "l2_diff_relative": 0.08098591549295775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:25.446742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.652983190246014, "overlap_percentage": 0.7900663407821229, "num_intersection": 72408, "num_union": 110888, "num_only_computed": 19240, "num_only_roped": 19240, "total_diff": 38480, "diff_percentage": 0.347016809753986, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:26.422857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 0.00019931793212890625, "l2_diff": 0.4921875, "l2_diff_relative": 0.12352941176470589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:33.292167", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5977635471182915, "overlap_percentage": 0.7482503255208334, "num_intersection": 73556, "num_union": 123052, "num_only_computed": 24748, "num_only_roped": 24748, "total_diff": 49496, "diff_percentage": 0.40223645288170856, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:33.536686", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 0.00019741058349609375, "l2_diff": 0.51953125, "l2_diff_relative": 0.15182648401826485}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:42.883872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5432938558026075, "overlap_percentage": 0.7040705226161369, "num_intersection": 73719, "num_union": 135689, "num_only_computed": 30985, "num_only_roped": 30985, "total_diff": 61970, "diff_percentage": 0.4567061441973926, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:43.165900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 0.00022125244140625, "l2_diff": 0.69140625, "l2_diff_relative": 0.2048611111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:52.314457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5012537410013751, "overlap_percentage": 0.6677801724137931, "num_intersection": 74364, "num_union": 148356, "num_only_computed": 36996, "num_only_roped": 36996, "total_diff": 73992, "diff_percentage": 0.4987462589986249, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:54.119059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 0.00013065338134765625, "l2_diff": 0.59765625, "l2_diff_relative": 0.14825581395348839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:04.241245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47806932215409526, "overlap_percentage": 0.6468834918478261, "num_intersection": 76177, "num_union": 159343, "num_only_computed": 41583, "num_only_roped": 41583, "total_diff": 83166, "diff_percentage": 0.5219306778459047, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:04.593254", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 0.00014495849609375, "l2_diff": 0.7265625, "l2_diff_relative": 0.19375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:18.486496", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44682385091723115, "overlap_percentage": 0.6176617155349794, "num_intersection": 76847, "num_union": 171985, "num_only_computed": 47569, "num_only_roped": 47569, "total_diff": 95138, "diff_percentage": 0.5531761490827688, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:21.338148", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 0.000156402587890625, "l2_diff": 0.8125, "l2_diff_relative": 0.23214285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:33.714502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4191732172632582, "overlap_percentage": 0.590728759765625, "num_intersection": 77428, "num_union": 184716, "num_only_computed": 53644, "num_only_roped": 53644, "total_diff": 107288, "diff_percentage": 0.5808267827367418, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:35.584286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 9.1552734375e-05, "l2_diff": 0.58203125, "l2_diff_relative": 0.14217557251908397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:49.123304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4053639611733857, "overlap_percentage": 0.5768811103351955, "num_intersection": 79305, "num_union": 195639, "num_only_computed": 58167, "num_only_roped": 58167, "total_diff": 116334, "diff_percentage": 0.5946360388266143, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:49.578293", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08154296875, "mean_diff": 0.000110626220703125, "l2_diff": 0.80078125, "l2_diff_relative": 0.20833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:04.173845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38225760046034335, "overlap_percentage": 0.5530916962699822, "num_intersection": 79716, "num_union": 208540, "num_only_computed": 64412, "num_only_roped": 64412, "total_diff": 128824, "diff_percentage": 0.6177423995396567, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:04.672500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.5, "l2_diff_relative": 0.11851851851851852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:20.537989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3754700171330668, "overlap_percentage": 0.5459515837585034, "num_intersection": 82181, "num_union": 218875, "num_only_computed": 68347, "num_only_roped": 68347, "total_diff": 136694, "diff_percentage": 0.6245299828669332, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:21.083246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.1475563909774436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:38.683209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36356854104134495, "overlap_percentage": 0.5332603827361564, "num_intersection": 83820, "num_union": 230548, "num_only_computed": 73364, "num_only_roped": 73364, "total_diff": 146728, "diff_percentage": 0.636431458958655, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:39.256538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.1585144927536232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:57.622488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3382778168036201, "overlap_percentage": 0.5055419921875, "num_intersection": 82828, "num_union": 244852, "num_only_computed": 81012, "num_only_roped": 81012, "total_diff": 162024, "diff_percentage": 0.6617221831963799, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:59.231360", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.6640625, "l2_diff_relative": 0.16346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:55:18.720816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31694883130847806, "overlap_percentage": 0.48133811090225564, "num_intersection": 81943, "num_union": 258537, "num_only_computed": 88297, "num_only_roped": 88297, "total_diff": 176594, "diff_percentage": 0.6830511686915219, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:55:19.381413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.13556338028169015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:55:40.082078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31549064299870233, "overlap_percentage": 0.4796547123733719, "num_intersection": 84849, "num_union": 268943, "num_only_computed": 92047, "num_only_roped": 92047, "total_diff": 184094, "diff_percentage": 0.6845093570012977, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:55:40.766758", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.6640625, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:56:02.862581", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30340578190053935, "overlap_percentage": 0.46555844099162014, "num_intersection": 85335, "num_union": 281257, "num_only_computed": 97961, "num_only_roped": 97961, "total_diff": 195922, "diff_percentage": 0.6965942180994606, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:56:03.600326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.19345238095238096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:56:26.647470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29291169223648567, "overlap_percentage": 0.4531039420485175, "num_intersection": 86068, "num_union": 293836, "num_only_computed": 103884, "num_only_roped": 103884, "total_diff": 207768, "diff_percentage": 0.7070883077635144, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:56:27.425153", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.1834016393442623}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:56:51.709272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28571288439845016, "overlap_percentage": 0.4444427490234375, "num_intersection": 87381, "num_union": 305835, "num_only_computed": 109227, "num_only_roped": 109227, "total_diff": 218454, "diff_percentage": 0.7142871156015499, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:56:52.535791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.18522267206477733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:57:18.048604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2792297198093204, "overlap_percentage": 0.4365591503783102, "num_intersection": 88625, "num_union": 317391, "num_only_computed": 114383, "num_only_roped": 114383, "total_diff": 228766, "diff_percentage": 0.7207702801906797, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:57:18.903396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 5.8650970458984375e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.1892430278884462}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:57:45.681751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2770412871278083, "overlap_percentage": 0.43387992216117216, "num_intersection": 90969, "num_union": 328359, "num_only_computed": 118695, "num_only_roped": 118695, "total_diff": 237390, "diff_percentage": 0.7229587128721917, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:57:46.581343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.83203125, "l2_diff_relative": 0.2063953488372093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:58:14.515943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2769098479095317, "overlap_percentage": 0.43371871297393366, "num_intersection": 93711, "num_union": 338417, "num_only_computed": 122353, "num_only_roped": 122353, "total_diff": 244706, "diff_percentage": 0.7230901520904682, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:58:15.455159", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.17458677685950413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:58:44.871441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2703011775039426, "overlap_percentage": 0.4255702227011494, "num_intersection": 94783, "num_union": 350657, "num_only_computed": 127937, "num_only_roped": 127937, "total_diff": 255874, "diff_percentage": 0.7296988224960574, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:58:45.861701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.73828125, "l2_diff_relative": 0.19852941176470587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:59:16.541382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2736919552995072, "overlap_percentage": 0.42976161411830355, "num_intersection": 98577, "num_union": 360175, "num_only_computed": 130799, "num_only_roped": 130799, "total_diff": 261598, "diff_percentage": 0.7263080447004928, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:59:17.570849", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.2794811320754717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:59:49.800566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2613164926696571, "overlap_percentage": 0.4143551506514658, "num_intersection": 97695, "num_union": 373857, "num_only_computed": 138081, "num_only_roped": 138081, "total_diff": 276162, "diff_percentage": 0.7386835073303429, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:59:50.822537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.20188284518828453}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:00:23.276073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25520408612338624, "overlap_percentage": 0.4066336127243928, "num_intersection": 98581, "num_union": 386283, "num_only_computed": 143851, "num_only_roped": 143851, "total_diff": 287702, "diff_percentage": 0.7447959138766138, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:00:24.373647", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.1896551724137931}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:00:57.984611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2408469386737411, "overlap_percentage": 0.38819765946502055, "num_intersection": 96596, "num_union": 401068, "num_only_computed": 152236, "num_only_roped": 152236, "total_diff": 304472, "diff_percentage": 0.7591530613262589, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:00:59.752805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.1747787610619469}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:01:34.657277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23520524467156742, "overlap_percentage": 0.38083589053106215, "num_intersection": 97299, "num_union": 413677, "num_only_computed": 158189, "num_only_roped": 158189, "total_diff": 316378, "diff_percentage": 0.7647947553284326, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:01:35.836164", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.18141592920353983}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:12.305660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2192914319734694, "overlap_percentage": 0.35970306396484375, "num_intersection": 94294, "num_union": 429994, "num_only_computed": 167850, "num_only_roped": 167850, "total_diff": 335700, "diff_percentage": 0.7807085680265307, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:13.507254", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.00543212890625e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.1939252336448598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:51.448359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21113065439949488, "overlap_percentage": 0.3486505004766444, "num_intersection": 93628, "num_union": 443460, "num_only_computed": 174916, "num_only_roped": 174916, "total_diff": 349832, "diff_percentage": 0.7888693456005051, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:52.728005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.22511848341232227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:03:32.420172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20328103957885163, "overlap_percentage": 0.3378779069767442, "num_intersection": 92984, "num_union": 457416, "num_only_computed": 182216, "num_only_roped": 182216, "total_diff": 364432, "diff_percentage": 0.7967189604211483, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:03:33.704989", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.22666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:14.220039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20021310602024509, "overlap_percentage": 0.33362926136363635, "num_intersection": 93950, "num_union": 469250, "num_only_computed": 187650, "num_only_roped": 187650, "total_diff": 375300, "diff_percentage": 0.7997868939797549, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:15.549500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.8623809814453125e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.17775229357798164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:57.932782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19499212337285465, "overlap_percentage": 0.32634880106571934, "num_intersection": 94072, "num_union": 482440, "num_only_computed": 194184, "num_only_roped": 194184, "total_diff": 388368, "diff_percentage": 0.8050078766271453, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:59.336749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.3093220338983051}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:05:43.829586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18934592668619926, "overlap_percentage": 0.3184034559461806, "num_intersection": 93901, "num_union": 495923, "num_only_computed": 201011, "num_only_roped": 201011, "total_diff": 402022, "diff_percentage": 0.8106540733138007, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:05:45.318191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.3852040816326531}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:06:31.352096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18092565520538978, "overlap_percentage": 0.30641328589634664, "num_intersection": 92326, "num_union": 510298, "num_only_computed": 208986, "num_only_roped": 208986, "total_diff": 417972, "diff_percentage": 0.8190743447946102, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:06:33.826814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 7.104873657226562e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.5030120481927711}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:07:22.358646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17731296268332916, "overlap_percentage": 0.30121636014131337, "num_intersection": 92765, "num_union": 523171, "num_only_computed": 215203, "num_only_roped": 215203, "total_diff": 430406, "diff_percentage": 0.8226870373166708, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:07:23.968321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11767578125, "mean_diff": 8.058547973632812e-05, "l2_diff": 1.7265625, "l2_diff_relative": 0.6350574712643678}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:08:15.178792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16711186517446275, "overlap_percentage": 0.28636820541530944, "num_intersection": 90025, "num_union": 538711, "num_only_computed": 224343, "num_only_roped": 224343, "total_diff": 448686, "diff_percentage": 0.8328881348255373, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:08:16.783229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 9.1552734375e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.8188405797101449}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:09:07.248119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16118040898708147, "overlap_percentage": 0.2776147577751196, "num_intersection": 89121, "num_union": 552927, "num_only_computed": 231903, "num_only_roped": 231903, "total_diff": 463806, "diff_percentage": 0.8388195910129185, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:09:08.911778", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.546875, "l2_diff_relative": 0.6971830985915493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:10:00.773168", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15608649480135056, "overlap_percentage": 0.270025634765625, "num_intersection": 88482, "num_union": 566878, "num_only_computed": 239198, "num_only_roped": 239198, "total_diff": 478396, "diff_percentage": 0.8439135051986495, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:10:02.425125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.6466666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:10:54.879340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15809798490673305, "overlap_percentage": 0.27303041187739463, "num_intersection": 91214, "num_union": 576946, "num_only_computed": 242866, "num_only_roped": 242866, "total_diff": 485732, "diff_percentage": 0.841902015093267, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:10:56.793173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.6870967741935484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:11:50.748290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15418827506546032, "overlap_percentage": 0.26718045642374155, "num_intersection": 91038, "num_union": 590434, "num_only_computed": 249698, "num_only_roped": 249698, "total_diff": 499396, "diff_percentage": 0.8458117249345397, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:11:52.529585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 8.726119995117188e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.7751479289940828}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:12:47.874058", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15614305911504778, "overlap_percentage": 0.27011027378318586, "num_intersection": 93765, "num_union": 600507, "num_only_computed": 253371, "num_only_roped": 253371, "total_diff": 506742, "diff_percentage": 0.8438569408849522, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:12:49.657809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 8.249282836914062e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.825}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:13:45.935502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15210920861528843, "overlap_percentage": 0.2640534551374819, "num_intersection": 93420, "num_union": 614164, "num_only_computed": 260372, "num_only_roped": 260372, "total_diff": 520744, "diff_percentage": 0.8478907913847116, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:13:47.789215", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 8.440017700195312e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.8323353293413174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:14:46.214211", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14718191742281264, "overlap_percentage": 0.2565973455255682, "num_intersection": 92490, "num_union": 628406, "num_only_computed": 267958, "num_only_roped": 267958, "total_diff": 535916, "diff_percentage": 0.8528180825771874, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:14:48.218994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 8.916854858398438e-05, "l2_diff": 2.140625, "l2_diff_relative": 1.0}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:15:49.467482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14470262064532435, "overlap_percentage": 0.25282133199581297, "num_intersection": 92747, "num_union": 640949, "num_only_computed": 274101, "num_only_roped": 274101, "total_diff": 548202, "diff_percentage": 0.8552973793546756, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:15:51.437165", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 8.249282836914062e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.8926174496644296}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:16:52.284877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14138856759560745, "overlap_percentage": 0.24774835075394105, "num_intersection": 92535, "num_union": 654473, "num_only_computed": 280969, "num_only_roped": 280969, "total_diff": 561938, "diff_percentage": 0.8586114324043925, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:16:56.234513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.343292236328125e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.6951219512195121}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:17:58.447002", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1410173238184483, "overlap_percentage": 0.2471782345013477, "num_intersection": 93904, "num_union": 665904, "num_only_computed": 286000, "num_only_roped": 286000, "total_diff": 572000, "diff_percentage": 0.8589826761815517, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:18:00.494470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.6953125, "l2_diff_relative": 0.6656441717791411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:19:06.539496", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1414650711274832, "overlap_percentage": 0.2478657905629139, "num_intersection": 95815, "num_union": 677305, "num_only_computed": 290745, "num_only_roped": 290745, "total_diff": 581490, "diff_percentage": 0.8585349288725168, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:19:08.626190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.796875, "l2_diff_relative": 0.7986111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:20:14.149186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1464842240918083, "overlap_percentage": 0.25553639729817706, "num_intersection": 100481, "num_union": 685951, "num_only_computed": 292735, "num_only_roped": 292735, "total_diff": 585470, "diff_percentage": 0.8535157759081917, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:20:16.280058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.5289855072463768}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:21:25.233426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14158876168574713, "overlap_percentage": 0.24805563340807174, "num_intersection": 99127, "num_union": 700105, "num_only_computed": 300489, "num_only_roped": 300489, "total_diff": 600978, "diff_percentage": 0.8584112383142528, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:21:27.504871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.009506225585938e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.7018072289156626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:22:37.968484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13870736735303063, "overlap_percentage": 0.24362249921235035, "num_intersection": 98977, "num_union": 713567, "num_only_computed": 307295, "num_only_roped": 307295, "total_diff": 614590, "diff_percentage": 0.8612926326469694, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:22:40.246902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.486343383789062e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.8666666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:23:53.166558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13920374552099954, "overlap_percentage": 0.2443877946650124, "num_intersection": 100852, "num_union": 724492, "num_only_computed": 311820, "num_only_roped": 311820, "total_diff": 623640, "diff_percentage": 0.8607962544790004, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:23:55.735627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 6.4849853515625e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.6358024691358025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:25:10.243298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13860110485536278, "overlap_percentage": 0.24345858134920634, "num_intersection": 102089, "num_union": 736567, "num_only_computed": 317239, "num_only_roped": 317239, "total_diff": 634478, "diff_percentage": 0.8613988951446372, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:25:12.676687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.4895287958115183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:26:29.415430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1361269949645814, "overlap_percentage": 0.23963341346153846, "num_intersection": 102080, "num_union": 749888, "num_only_computed": 323904, "num_only_roped": 323904, "total_diff": 647808, "diff_percentage": 0.8638730050354186, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:26:31.867248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.4671717171717172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:27:48.661177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13046297361458256, "overlap_percentage": 0.23081335109532267, "num_intersection": 99800, "num_union": 764968, "num_only_computed": 332584, "num_only_roped": 332584, "total_diff": 665168, "diff_percentage": 0.8695370263854174, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:27:51.188349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 4.57763671875e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.4010989010989011}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:29:09.636438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13242051532045998, "overlap_percentage": 0.23387162900874636, "num_intersection": 102679, "num_union": 775401, "num_only_computed": 336361, "num_only_roped": 336361, "total_diff": 672722, "diff_percentage": 0.86757948467954, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:29:14.751270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.7206878662109375e-05, "l2_diff": 1.125, "l2_diff_relative": 0.4186046511627907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:30:35.059036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1293086837915403, "overlap_percentage": 0.2290050287356322, "num_intersection": 102008, "num_union": 788872, "num_only_computed": 343432, "num_only_roped": 343432, "total_diff": 686864, "diff_percentage": 0.8706913162084596, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:30:38.544151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.6304347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:32:01.285500", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1272499694560179, "overlap_percentage": 0.22577063278595697, "num_intersection": 102070, "num_union": 802122, "num_only_computed": 350026, "num_only_roped": 350026, "total_diff": 700052, "diff_percentage": 0.872750030543982, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:32:04.012132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.6338028169014085}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:33:27.800119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12449551122958605, "overlap_percentage": 0.22142464773995535, "num_intersection": 101579, "num_union": 815925, "num_only_computed": 357173, "num_only_roped": 357173, "total_diff": 714346, "diff_percentage": 0.875504488770414, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:33:30.747916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.6986301369863014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:34:58.567509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12493863227978359, "overlap_percentage": 0.22212524078150797, "num_intersection": 103322, "num_union": 826982, "num_only_computed": 361830, "num_only_roped": 361830, "total_diff": 723660, "diff_percentage": 0.8750613677202164, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:35:01.725355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.7368421052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:36:29.392572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12791506594533603, "overlap_percentage": 0.22681684074877917, "num_intersection": 107014, "num_union": 836602, "num_only_computed": 364794, "num_only_roped": 364794, "total_diff": 729588, "diff_percentage": 0.872084934054664, "num_computed": 471808, "num_roped": 471808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 256, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:36:32.310372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11962890625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 1.375, "l2_diff_relative": 0.5605095541401274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 256, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:38:01.803186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12754988358041794, "overlap_percentage": 0.22624255554068523, "num_intersection": 108191, "num_union": 848225, "num_only_computed": 370017, "num_only_roped": 370017, "total_diff": 740034, "diff_percentage": 0.872450116419582, "num_computed": 478208, "num_roped": 478208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "mask_shape": [1, 32, 256, 16128], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:38:04.802016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 6.079673767089844e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.8181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "attention_shape": [1, 32, 256, 16128]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:39:31.860553", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13010459552687215, "overlap_percentage": 0.2302523076923077, "num_intersection": 28062, "num_union": 215688, "num_only_computed": 93813, "num_only_roped": 93813, "total_diff": 187626, "diff_percentage": 0.8698954044731279, "num_computed": 121875, "num_roped": 121875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 16193, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 16193, 128], "mask_shape": [1, 32, 65, 16193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:39:36.112648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.3854625550660793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 16193, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 16193, 128], "attention_shape": [1, 32, 65, 16193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:40:56.521652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1296014115005213, "overlap_percentage": 0.22946396876109337, "num_intersection": 12928, "num_union": 99752, "num_only_computed": 43412, "num_only_roped": 43412, "total_diff": 86824, "diff_percentage": 0.8703985884994787, "num_computed": 56340, "num_roped": 56340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "mask_shape": [1, 32, 30, 16223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:40:59.697370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 5.340576171875e-05, "l2_diff": 0.51171875, "l2_diff_relative": 0.51171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "attention_shape": [1, 32, 30, 16223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:42:08.385465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13852682631100333, "overlap_percentage": 0.24334398296059637, "num_intersection": 457, "num_union": 3299, "num_only_computed": 1421, "num_only_roped": 1421, "total_diff": 2842, "diff_percentage": 0.8614731736889967, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "mask_shape": [1, 32, 1, 16224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:42:10.689710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.0673828125, "l2_diff_relative": 0.38333333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "attention_shape": [1, 32, 1, 16224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:08.964775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12962406015037595, "overlap_percentage": 0.22949946751863684, "num_intersection": 431, "num_union": 3325, "num_only_computed": 1447, "num_only_roped": 1447, "total_diff": 2894, "diff_percentage": 0.870375939849624, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "mask_shape": [1, 32, 1, 16225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:10.862997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.06298828125, "l2_diff_relative": 0.3706896551724138}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "attention_shape": [1, 32, 1, 16225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:45.988652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:46.002057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1265277862548828e-05, "l2_diff": 0.01708984375, "l2_diff_relative": 0.0030381944444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:48.130108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8605558671551488, "overlap_percentage": 0.9250524344329064, "num_intersection": 72112, "num_union": 83797, "num_only_computed": 6480, "num_only_roped": 5205, "total_diff": 11685, "diff_percentage": 0.13944413284485124, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:48.270450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 0.0001316070556640625, "l2_diff": 0.208984375, "l2_diff_relative": 0.04846014492753623}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:53.094630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7325858729996942, "overlap_percentage": 0.8456560617469879, "num_intersection": 71874, "num_union": 98110, "num_only_computed": 13118, "num_only_roped": 13118, "total_diff": 26236, "diff_percentage": 0.26741412700030576, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:53.269915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 0.00025177001953125, "l2_diff": 0.453125, "l2_diff_relative": 0.11693548387096774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:59.206393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6535796766743649, "overlap_percentage": 0.7905027932960894, "num_intersection": 72448, "num_union": 110848, "num_only_computed": 19200, "num_only_roped": 19200, "total_diff": 38400, "diff_percentage": 0.3464203233256351, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:59.698701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 0.00023555755615234375, "l2_diff": 0.546875, "l2_diff_relative": 0.14344262295081966}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:06.683372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5950026365959518, "overlap_percentage": 0.7460835774739584, "num_intersection": 73343, "num_union": 123265, "num_only_computed": 24961, "num_only_roped": 24961, "total_diff": 49922, "diff_percentage": 0.4049973634040482, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:06.926326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 0.00021076202392578125, "l2_diff": 0.59765625, "l2_diff_relative": 0.16071428571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:16.183529", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5550637893392345, "overlap_percentage": 0.7138791259168704, "num_intersection": 74746, "num_union": 134662, "num_only_computed": 29958, "num_only_roped": 29958, "total_diff": 59916, "diff_percentage": 0.4449362106607655, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:16.464728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 0.00014400482177734375, "l2_diff": 0.54296875, "l2_diff_relative": 0.12682481751824817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:25.623868", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5230592483177416, "overlap_percentage": 0.686853448275862, "num_intersection": 76488, "num_union": 146232, "num_only_computed": 34872, "num_only_roped": 34872, "total_diff": 69744, "diff_percentage": 0.4769407516822583, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:27.977450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.06338028169014084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:38.182137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47967581830747, "overlap_percentage": 0.6483525815217391, "num_intersection": 76350, "num_union": 159170, "num_only_computed": 41410, "num_only_roped": 41410, "total_diff": 82820, "diff_percentage": 0.52032418169253, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:38.533810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.353515625, "l2_diff_relative": 0.08570075757575757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:52.321150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4575786686660887, "overlap_percentage": 0.6278613683127572, "num_intersection": 78116, "num_union": 170716, "num_only_computed": 46300, "num_only_roped": 46300, "total_diff": 92600, "diff_percentage": 0.5424213313339112, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:44:55.327233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 8.678436279296875e-05, "l2_diff": 0.4453125, "l2_diff_relative": 0.12391304347826088}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:07.629679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4457693113755943, "overlap_percentage": 0.6166534423828125, "num_intersection": 80826, "num_union": 181318, "num_only_computed": 50246, "num_only_roped": 50246, "total_diff": 100492, "diff_percentage": 0.5542306886244057, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:09.551834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 9.584426879882812e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.15140845070422534}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:23.001455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4113588764321794, "overlap_percentage": 0.5829259776536313, "num_intersection": 80136, "num_union": 194808, "num_only_computed": 57336, "num_only_roped": 57336, "total_diff": 114672, "diff_percentage": 0.5886411235678206, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:23.458614", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 8.678436279296875e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.13789237668161436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:38.112334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37520156481083916, "overlap_percentage": 0.5456677397868561, "num_intersection": 78646, "num_union": 209610, "num_only_computed": 65482, "num_only_roped": 65482, "total_diff": 130964, "diff_percentage": 0.6247984351891608, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:38.612117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.34765625, "l2_diff_relative": 0.0818014705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:54.438972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3544973544973545, "overlap_percentage": 0.5234375, "num_intersection": 78792, "num_union": 222264, "num_only_computed": 71736, "num_only_roped": 71736, "total_diff": 143472, "diff_percentage": 0.6455026455026455, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:54.984957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.455078125, "l2_diff_relative": 0.11201923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:12.510034", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33657022597308733, "overlap_percentage": 0.5036326852605864, "num_intersection": 79163, "num_union": 235205, "num_only_computed": 78021, "num_only_roped": 78021, "total_diff": 156042, "diff_percentage": 0.6634297740269127, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:13.078381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.2255859375, "l2_diff_relative": 0.04348644578313253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:31.282811", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33008065399961845, "overlap_percentage": 0.496331787109375, "num_intersection": 81319, "num_union": 246361, "num_only_computed": 82521, "num_only_roped": 82521, "total_diff": 165042, "diff_percentage": 0.6699193460003815, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:33.548316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.777576446533203e-05, "l2_diff": 0.271484375, "l2_diff_relative": 0.057154605263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:53.005954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3240727057780405, "overlap_percentage": 0.4895089285714286, "num_intersection": 83334, "num_union": 257146, "num_only_computed": 86906, "num_only_roped": 86906, "total_diff": 173812, "diff_percentage": 0.6759272942219595, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:53.657683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.322265625, "l2_diff_relative": 0.07582720588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:14.249992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3092545443779975, "overlap_percentage": 0.47241316931982635, "num_intersection": 83568, "num_union": 270224, "num_only_computed": 93328, "num_only_roped": 93328, "total_diff": 186656, "diff_percentage": 0.6907454556220025, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:15.011289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.375, "l2_diff_relative": 0.08571428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:37.367511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3017811993977444, "overlap_percentage": 0.4636435055865922, "num_intersection": 84984, "num_union": 281608, "num_only_computed": 98312, "num_only_roped": 98312, "total_diff": 196624, "diff_percentage": 0.6982188006022556, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:38.111867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.9591064453125e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.13511029411764705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:01.422486", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2916061781575002, "overlap_percentage": 0.4515403891509434, "num_intersection": 85771, "num_union": 294133, "num_only_computed": 104181, "num_only_roped": 104181, "total_diff": 208362, "diff_percentage": 0.7083938218424998, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:02.200135", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 5.745887756347656e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.166044776119403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:26.453733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27815682463114716, "overlap_percentage": 0.4352467854817708, "num_intersection": 85573, "num_union": 307643, "num_only_computed": 111035, "num_only_roped": 111035, "total_diff": 222070, "diff_percentage": 0.7218431753688529, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:27.268742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.390625, "l2_diff_relative": 0.08333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:52.951552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2743233954672283, "overlap_percentage": 0.4305396831651955, "num_intersection": 87403, "num_union": 318613, "num_only_computed": 115605, "num_only_roped": 115605, "total_diff": 231210, "diff_percentage": 0.7256766045327717, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:53.811648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.1707089552238806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:20.749236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26238593977198493, "overlap_percentage": 0.41569845085470086, "num_intersection": 87157, "num_union": 332171, "num_only_computed": 122507, "num_only_roped": 122507, "total_diff": 245014, "diff_percentage": 0.7376140602280151, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:21.642275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08056640625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.17791970802919707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:49.646613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2627457168488631, "overlap_percentage": 0.41614984449052134, "num_intersection": 89915, "num_union": 342213, "num_only_computed": 126149, "num_only_roped": 126149, "total_diff": 252298, "diff_percentage": 0.7372542831511368, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:50.590282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.1676706827309237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:50:19.932493", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2533694997664564, "overlap_percentage": 0.4043013649425287, "num_intersection": 90046, "num_union": 355394, "num_only_computed": 132674, "num_only_roped": 132674, "total_diff": 265348, "diff_percentage": 0.7466305002335436, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:50:20.913226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.315376281738281e-05, "l2_diff": 0.63671875, "l2_diff_relative": 0.15794573643410853}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:50:51.551634", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25867211014258945, "overlap_percentage": 0.41102382114955355, "num_intersection": 94279, "num_union": 364473, "num_only_computed": 135097, "num_only_roped": 135097, "total_diff": 270194, "diff_percentage": 0.7413278898574106, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:50:52.563089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.16872427983539096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:51:25.002126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24777594902543965, "overlap_percentage": 0.39714814060803477, "num_intersection": 93638, "num_union": 377914, "num_only_computed": 142138, "num_only_roped": 142138, "total_diff": 284276, "diff_percentage": 0.7522240509745604, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:51:26.063297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.1645220588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:51:59.447525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24322189915026948, "overlap_percentage": 0.3912767291446674, "num_intersection": 94858, "num_union": 390006, "num_only_computed": 147574, "num_only_roped": 147574, "total_diff": 295148, "diff_percentage": 0.7567781008497305, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:52:00.556107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.1961669921875e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.1803921568627451}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:52:35.764211", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23772999268798592, "overlap_percentage": 0.3841386959876543, "num_intersection": 95586, "num_union": 402078, "num_only_computed": 153246, "num_only_roped": 153246, "total_diff": 306492, "diff_percentage": 0.7622700073120141, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:52:36.932227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.1712962962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:53:12.837001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23345797235089785, "overlap_percentage": 0.3785422407314629, "num_intersection": 96713, "num_union": 414263, "num_only_computed": 158775, "num_only_roped": 158775, "total_diff": 317550, "diff_percentage": 0.7665420276491022, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:53:16.317876", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.16727941176470587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:53:53.306331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2284592944925431, "overlap_percentage": 0.3719444274902344, "num_intersection": 97503, "num_union": 426785, "num_only_computed": 164641, "num_only_roped": 164641, "total_diff": 329282, "diff_percentage": 0.7715407055074569, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:53:56.553991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.1455223880597015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:54:34.618694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22085432161626448, "overlap_percentage": 0.3618029075309819, "num_intersection": 97160, "num_union": 439928, "num_only_computed": 171384, "num_only_roped": 171384, "total_diff": 342768, "diff_percentage": 0.7791456783837355, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:54:35.892990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.1480392156862745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:55:16.096507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2237229725974098, "overlap_percentage": 0.3656431686046512, "num_intersection": 100625, "num_union": 449775, "num_only_computed": 174575, "num_only_roped": 174575, "total_diff": 349150, "diff_percentage": 0.7762770274025902, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:55:17.341664", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.13991769547325103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:55:59.151583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2238476448755726, "overlap_percentage": 0.36580965909090907, "num_intersection": 103012, "num_union": 460188, "num_only_computed": 178588, "num_only_roped": 178588, "total_diff": 357176, "diff_percentage": 0.7761523551244274, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:56:02.002005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.1659919028340081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:56:43.991384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21875640811529004, "overlap_percentage": 0.3589829873445826, "num_intersection": 103479, "num_union": 473033, "num_only_computed": 184777, "num_only_roped": 184777, "total_diff": 369554, "diff_percentage": 0.7812435918847099, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:56:45.379902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.744529724121094e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.25938967136150237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:57:28.870358", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20755211425623304, "overlap_percentage": 0.3437567816840278, "num_intersection": 101378, "num_union": 488446, "num_only_computed": 193534, "num_only_roped": 193534, "total_diff": 387068, "diff_percentage": 0.792447885743767, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:57:30.319613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11181640625, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.2988095238095238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:58:15.276727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1947177576837752, "overlap_percentage": 0.32596444881053527, "num_intersection": 98217, "num_union": 504407, "num_only_computed": 203095, "num_only_roped": 203095, "total_diff": 406190, "diff_percentage": 0.8052822423162248, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:58:16.743832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.46153846153846156}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:59:04.678756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18004444785041, "overlap_percentage": 0.3051485868661679, "num_intersection": 93976, "num_union": 521960, "num_only_computed": 213992, "num_only_roped": 213992, "total_diff": 427984, "diff_percentage": 0.81995555214959, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:59:06.232408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.75, "l2_diff_relative": 0.6086956521739131}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:59:54.427325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17281362154257104, "overlap_percentage": 0.29469920602605865, "num_intersection": 92644, "num_union": 536092, "num_only_computed": 221724, "num_only_roped": 221724, "total_diff": 443448, "diff_percentage": 0.8271863784574289, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:59:57.897580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 8.726119995117188e-05, "l2_diff": 2.0, "l2_diff_relative": 0.7071823204419889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:00:48.226139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1657427968109695, "overlap_percentage": 0.28435568680223283, "num_intersection": 91285, "num_union": 550763, "num_only_computed": 229739, "num_only_roped": 229739, "total_diff": 459478, "diff_percentage": 0.8342572031890305, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:00:49.864902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.7734375, "l2_diff_relative": 0.5618811881188119}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:01:42.594532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1608640586667139, "overlap_percentage": 0.2771453857421875, "num_intersection": 90815, "num_union": 564545, "num_only_computed": 236865, "num_only_roped": 236865, "total_diff": 473730, "diff_percentage": 0.8391359413332861, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:01:44.284071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.46078431372549017}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:02:38.066158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1630266962111467, "overlap_percentage": 0.2803490181992337, "num_intersection": 93659, "num_union": 574501, "num_only_computed": 240421, "num_only_roped": 240421, "total_diff": 480842, "diff_percentage": 0.8369733037888533, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:02:39.841844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.5418994413407822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:03:34.321281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15862312852999283, "overlap_percentage": 0.2738131574004508, "num_intersection": 93298, "num_union": 588174, "num_only_computed": 247438, "num_only_roped": 247438, "total_diff": 494876, "diff_percentage": 0.8413768714700072, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:03:36.210228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.295608520507812e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.5588235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:04:35.879308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16388020418598023, "overlap_percentage": 0.2816100894174041, "num_intersection": 97757, "num_union": 596515, "num_only_computed": 249379, "num_only_roped": 249379, "total_diff": 498758, "diff_percentage": 0.8361197958140197, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:04:37.761514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12451171875, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.6328125, "l2_diff_relative": 0.5971428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:05:36.911914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16244730590666698, "overlap_percentage": 0.2794919048480463, "num_intersection": 98882, "num_union": 608702, "num_only_computed": 254910, "num_only_roped": 254910, "total_diff": 509820, "diff_percentage": 0.837552694093333, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:05:38.844496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.875, "l2_diff_relative": 0.6936416184971098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:40.218333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1627692416876619, "overlap_percentage": 0.27996826171875, "num_intersection": 100914, "num_union": 619982, "num_only_computed": 259534, "num_only_roped": 259534, "total_diff": 519068, "diff_percentage": 0.8372307583123381, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:42.327081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.5, "l2_diff_relative": 0.6}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:07:43.097929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16010922827095822, "overlap_percentage": 0.2760244024773203, "num_intersection": 101259, "num_union": 632437, "num_only_computed": 265589, "num_only_roped": 265589, "total_diff": 531178, "diff_percentage": 0.8398907717290418, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:07:45.141458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 7.724761962890625e-05, "l2_diff": 1.671875, "l2_diff_relative": 0.781021897810219}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:08:48.173042", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16048550340762743, "overlap_percentage": 0.27658338331048665, "num_intersection": 103305, "num_union": 643703, "num_only_computed": 270199, "num_only_roped": 270199, "total_diff": 540398, "diff_percentage": 0.8395144965923725, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:08:50.248441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 7.581710815429688e-05, "l2_diff": 1.859375, "l2_diff_relative": 0.7345679012345679}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:09:53.030073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16062435260920813, "overlap_percentage": 0.27678956114975073, "num_intersection": 76449, "num_union": 475949, "num_only_computed": 199750, "num_only_roped": 199750, "total_diff": 399500, "diff_percentage": 0.8393756473907918, "num_computed": 276199, "num_roped": 276199}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 187, "seq_len_k": 12219, "queries_shape": [1, 32, 187, 128], "keys_shape": [1, 8, 12219, 128], "mask_shape": [1, 32, 187, 12219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:09:57.317551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.866455078125e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.6493506493506493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 187, "seq_len_k": 12219, "queries_shape": [1, 32, 187, 128], "keys_shape": [1, 8, 12219, 128], "attention_shape": [1, 32, 187, 12219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:10:57.010823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16494483097898657, "overlap_percentage": 0.2831805019305019, "num_intersection": 11735, "num_union": 71145, "num_only_computed": 29705, "num_only_roped": 29705, "total_diff": 59410, "diff_percentage": 0.8350551690210134, "num_computed": 41440, "num_roped": 41440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "mask_shape": [1, 32, 28, 12247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:10:58.812379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 5.412101745605469e-05, "l2_diff": 0.328125, "l2_diff_relative": 0.2978723404255319}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "attention_shape": [1, 32, 28, 12247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:11:49.030143", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17181314330958036, "overlap_percentage": 0.29324324324324325, "num_intersection": 434, "num_union": 2526, "num_only_computed": 1046, "num_only_roped": 1046, "total_diff": 2092, "diff_percentage": 0.8281868566904196, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "mask_shape": [1, 32, 1, 12248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:11:50.460509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 7.2479248046875e-05, "l2_diff": 0.0634765625, "l2_diff_relative": 0.5098039215686274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "attention_shape": [1, 32, 1, 12248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:12:35.417068", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16765285996055226, "overlap_percentage": 0.28716216216216217, "num_intersection": 425, "num_union": 2535, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.8323471400394478, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "mask_shape": [1, 32, 1, 12249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:12:36.847797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.06201171875, "l2_diff_relative": 0.4774436090225564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "attention_shape": [1, 32, 1, 12249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:20.673887", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16936439005132253, "overlap_percentage": 0.28966914247130315, "num_intersection": 429, "num_union": 2533, "num_only_computed": 1052, "num_only_roped": 1052, "total_diff": 2104, "diff_percentage": 0.8306356099486775, "num_computed": 1481, "num_roped": 1481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "mask_shape": [1, 32, 1, 12250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:24.506985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 3.528594970703125e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.15090090090090091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "attention_shape": [1, 32, 1, 12250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:50.629374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:50.668078", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1026859283447266e-05, "l2_diff": 0.0174560546875, "l2_diff_relative": 0.0029871323529411763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:52.825835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8576296631676774, "overlap_percentage": 0.9233591389849207, "num_intersection": 71980, "num_union": 83929, "num_only_computed": 6612, "num_only_roped": 5337, "total_diff": 11949, "diff_percentage": 0.14237033683232256, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:52.965965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.11865234375, "l2_diff_relative": 0.0269281914893617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:57.820226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7385043364424808, "overlap_percentage": 0.849585843373494, "num_intersection": 72208, "num_union": 97776, "num_only_computed": 12784, "num_only_roped": 12784, "total_diff": 25568, "diff_percentage": 0.26149566355751924, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:57.998313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 0.00011587142944335938, "l2_diff": 0.236328125, "l2_diff_relative": 0.05179794520547945}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:03.889031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6642242983865843, "overlap_percentage": 0.7982389141061452, "num_intersection": 73157, "num_union": 110139, "num_only_computed": 18491, "num_only_roped": 18491, "total_diff": 36982, "diff_percentage": 0.3357757016134158, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:04.755138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 0.0001678466796875, "l2_diff": 0.412109375, "l2_diff_relative": 0.09841417910447761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:11.744291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6030265475181006, "overlap_percentage": 0.7523600260416666, "num_intersection": 73960, "num_union": 122648, "num_only_computed": 24344, "num_only_roped": 24344, "total_diff": 48688, "diff_percentage": 0.3969734524818994, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:11.989808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 0.0001373291015625, "l2_diff": 0.455078125, "l2_diff_relative": 0.1142156862745098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:20.084749", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5515266468596492, "overlap_percentage": 0.7109470507334963, "num_intersection": 74439, "num_union": 134969, "num_only_computed": 30265, "num_only_roped": 30265, "total_diff": 60530, "diff_percentage": 0.44847335314035075, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:20.365867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 9.72747802734375e-05, "l2_diff": 0.37890625, "l2_diff_relative": 0.08915441176470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:29.548527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5129201423796973, "overlap_percentage": 0.6780531609195403, "num_intersection": 75508, "num_union": 147212, "num_only_computed": 35852, "num_only_roped": 35852, "total_diff": 71704, "diff_percentage": 0.4870798576203027, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:32.436617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05126953125, "mean_diff": 0.00011920928955078125, "l2_diff": 0.53125, "l2_diff_relative": 0.13877551020408163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:42.669778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4862400373579357, "overlap_percentage": 0.6543223505434783, "num_intersection": 77053, "num_union": 158467, "num_only_computed": 40707, "num_only_roped": 40707, "total_diff": 81414, "diff_percentage": 0.5137599626420642, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:43.035992", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 9.584426879882812e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.12403846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:56.702146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4531184302733006, "overlap_percentage": 0.6236496913580247, "num_intersection": 77592, "num_union": 171240, "num_only_computed": 46824, "num_only_roped": 46824, "total_diff": 93648, "diff_percentage": 0.5468815697266993, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:57.096424", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.296875, "l2_diff_relative": 0.0625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:11.886283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4288268253864434, "overlap_percentage": 0.600250244140625, "num_intersection": 78676, "num_union": 183468, "num_only_computed": 52396, "num_only_roped": 52396, "total_diff": 104792, "diff_percentage": 0.5711731746135565, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:13.947721", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.361328125, "l2_diff_relative": 0.08378623188405797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:27.610541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4186338095754067, "overlap_percentage": 0.5901929120111732, "num_intersection": 81135, "num_union": 193809, "num_only_computed": 56337, "num_only_roped": 56337, "total_diff": 112674, "diff_percentage": 0.5813661904245933, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:28.067419", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.326171875, "l2_diff_relative": 0.06287650602409639}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:42.826391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4009603608157235, "overlap_percentage": 0.5724078596802842, "num_intersection": 82500, "num_union": 205756, "num_only_computed": 61628, "num_only_roped": 61628, "total_diff": 123256, "diff_percentage": 0.5990396391842765, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:43.343622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.41015625, "l2_diff_relative": 0.08868243243243243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:59.293729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37101636716366254, "overlap_percentage": 0.5412282100340136, "num_intersection": 81470, "num_union": 219586, "num_only_computed": 69058, "num_only_roped": 69058, "total_diff": 138116, "diff_percentage": 0.6289836328363375, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:15:59.847207", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.16372549019607843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:17.236694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35306320963423976, "overlap_percentage": 0.5218724552117264, "num_intersection": 82030, "num_union": 232338, "num_only_computed": 75154, "num_only_roped": 75154, "total_diff": 150308, "diff_percentage": 0.6469367903657602, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:17.823122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 9.584426879882812e-05, "l2_diff": 0.75, "l2_diff_relative": 0.21052631578947367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:36.251056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3389887300692214, "overlap_percentage": 0.50633544921875, "num_intersection": 82958, "num_union": 244722, "num_only_computed": 80882, "num_only_roped": 80882, "total_diff": 161764, "diff_percentage": 0.6610112699307786, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:37.636689", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.166}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:57.289782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3235271251535459, "overlap_percentage": 0.48888627819548874, "num_intersection": 83228, "num_union": 257252, "num_only_computed": 87012, "num_only_roped": 87012, "total_diff": 174024, "diff_percentage": 0.676472874846454, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:57.942769", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 6.866455078125e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.16176470588235295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:17:18.841073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3213717478505748, "overlap_percentage": 0.4864214001447178, "num_intersection": 86046, "num_union": 267746, "num_only_computed": 90850, "num_only_roped": 90850, "total_diff": 181700, "diff_percentage": 0.6786282521494252, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:17:19.525774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.15671641791044777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:17:41.880825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3000085108797413, "overlap_percentage": 0.46154853351955305, "num_intersection": 84600, "num_union": 281992, "num_only_computed": 98696, "num_only_roped": 98696, "total_diff": 197392, "diff_percentage": 0.6999914891202588, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:17:42.633251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.44921875, "l2_diff_relative": 0.1183127572016461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:05.458400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28873631219724005, "overlap_percentage": 0.44809214959568733, "num_intersection": 85116, "num_union": 294788, "num_only_computed": 104836, "num_only_roped": 104836, "total_diff": 209672, "diff_percentage": 0.71126368780276, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:06.230748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 5.507469177246094e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.15677966101694915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:30.364334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2806294760771082, "overlap_percentage": 0.4382680257161458, "num_intersection": 86167, "num_union": 307049, "num_only_computed": 110441, "num_only_roped": 110441, "total_diff": 220882, "diff_percentage": 0.7193705239228918, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:31.183440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 5.340576171875e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.16176470588235295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:56.666441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27341613348387905, "overlap_percentage": 0.42942150063051704, "num_intersection": 87176, "num_union": 318840, "num_only_computed": 115832, "num_only_roped": 115832, "total_diff": 231664, "diff_percentage": 0.726583866516121, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:57.540066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.14094650205761317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:19:24.148725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26505947765854426, "overlap_percentage": 0.41904666514041516, "num_intersection": 87859, "num_union": 331469, "num_only_computed": 121805, "num_only_roped": 121805, "total_diff": 243610, "diff_percentage": 0.7349405223414558, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:19:25.239608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.20381526104417672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:19:53.363331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2590555218870915, "overlap_percentage": 0.41150770142180093, "num_intersection": 88912, "num_union": 343216, "num_only_computed": 127152, "num_only_roped": 127152, "total_diff": 254304, "diff_percentage": 0.7409444781129085, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:19:54.287733", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.1928294573643411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:20:24.054577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2573780348387206, "overlap_percentage": 0.4093884698275862, "num_intersection": 91179, "num_union": 354261, "num_only_computed": 131541, "num_only_roped": 131541, "total_diff": 263082, "diff_percentage": 0.7426219651612794, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:20:25.048383", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.57763671875e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.169921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:20:52.681771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30469748449237866, "overlap_percentage": 0.4670775993883792, "num_intersection": 9775, "num_union": 32081, "num_only_computed": 11153, "num_only_roped": 11153, "total_diff": 22306, "diff_percentage": 0.6953025155076213, "num_computed": 20928, "num_roped": 20928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "mask_shape": [1, 32, 24, 6168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:20:53.484330", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.07421875, "l2_diff_relative": 0.0521978021978022}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "attention_shape": [1, 32, 24, 6168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:21:19.150810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27913958284386664, "overlap_percentage": 0.43644897959183676, "num_intersection": 10693, "num_union": 38307, "num_only_computed": 13807, "num_only_roped": 13807, "total_diff": 27614, "diff_percentage": 0.7208604171561334, "num_computed": 24500, "num_roped": 24500}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "mask_shape": [1, 32, 28, 6196], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:21:20.038414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.24609375, "l2_diff_relative": 0.21575342465753425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "attention_shape": [1, 32, 28, 6196]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:21:44.440545", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26995645863570394, "overlap_percentage": 0.42514285714285716, "num_intersection": 372, "num_union": 1378, "num_only_computed": 503, "num_only_roped": 503, "total_diff": 1006, "diff_percentage": 0.7300435413642961, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "mask_shape": [1, 32, 1, 6197], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:21:45.165049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.03564453125, "l2_diff_relative": 0.24172185430463577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "attention_shape": [1, 32, 1, 6197]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:07.443152", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29246676514032494, "overlap_percentage": 0.45257142857142857, "num_intersection": 396, "num_union": 1354, "num_only_computed": 479, "num_only_roped": 479, "total_diff": 958, "diff_percentage": 0.707533234859675, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "mask_shape": [1, 32, 1, 6198], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:08.575006", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04150390625, "mean_diff": 9.1552734375e-05, "l2_diff": 0.05810546875, "l2_diff_relative": 0.39403973509933776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "attention_shape": [1, 32, 1, 6198]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:32.062705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26262626262626265, "overlap_percentage": 0.416, "num_intersection": 364, "num_union": 1386, "num_only_computed": 511, "num_only_roped": 511, "total_diff": 1022, "diff_percentage": 0.7373737373737373, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "mask_shape": [1, 32, 1, 6199], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:32.776857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.02783203125, "l2_diff_relative": 0.12284482758620689}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "attention_shape": [1, 32, 1, 6199]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:51.721160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:51.755825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.0169677734375, "l2_diff_relative": 0.0029998273480662985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:53.846350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.858094579777852, "overlap_percentage": 0.9236285268971002, "num_intersection": 72001, "num_union": 83908, "num_only_computed": 6591, "num_only_roped": 5316, "total_diff": 11907, "diff_percentage": 0.14190542022214805, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:53.985895", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 0.00010251998901367188, "l2_diff": 0.1533203125, "l2_diff_relative": 0.03430944055944056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:58.755908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7340351736238626, "overlap_percentage": 0.8466208584337349, "num_intersection": 71956, "num_union": 98028, "num_only_computed": 13036, "num_only_roped": 13036, "total_diff": 26072, "diff_percentage": 0.26596482637613744, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:22:58.932790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.23046875, "l2_diff_relative": 0.04580745341614907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:04.726179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6686785925622468, "overlap_percentage": 0.8014468400837989, "num_intersection": 73451, "num_union": 109845, "num_only_computed": 18197, "num_only_roped": 18197, "total_diff": 36394, "diff_percentage": 0.3313214074377532, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:05.713290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.265625, "l2_diff_relative": 0.060714285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:12.519022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6191189913447365, "overlap_percentage": 0.7647603352864584, "num_intersection": 75179, "num_union": 121429, "num_only_computed": 23125, "num_only_roped": 23125, "total_diff": 46250, "diff_percentage": 0.3808810086552636, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:12.760171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 0.00010538101196289062, "l2_diff": 0.38671875, "l2_diff_relative": 0.0825}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:21.407763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5648599974592546, "overlap_percentage": 0.7219303942542787, "num_intersection": 75589, "num_union": 133819, "num_only_computed": 29115, "num_only_roped": 29115, "total_diff": 58230, "diff_percentage": 0.4351400025407453, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:21.681641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.2421875, "l2_diff_relative": 0.0490506329113924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:30.594233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5269959891673237, "overlap_percentage": 0.6902388649425287, "num_intersection": 76865, "num_union": 145855, "num_only_computed": 34495, "num_only_roped": 34495, "total_diff": 68990, "diff_percentage": 0.4730040108326763, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:33.421537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.32421875, "l2_diff_relative": 0.06870860927152318}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:43.381420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4874321081217633, "overlap_percentage": 0.6554008152173914, "num_intersection": 77180, "num_union": 158340, "num_only_computed": 40580, "num_only_roped": 40580, "total_diff": 81160, "diff_percentage": 0.5125678918782367, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:43.728878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 6.580352783203125e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.08613782051282051}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:54.763921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45779215072850943, "overlap_percentage": 0.6280623070987654, "num_intersection": 78141, "num_union": 170691, "num_only_computed": 46275, "num_only_roped": 46275, "total_diff": 92550, "diff_percentage": 0.5422078492714906, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:55.144030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 7.534027099609375e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.103125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:07.523507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4357525070789723, "overlap_percentage": 0.6070022583007812, "num_intersection": 79561, "num_union": 182583, "num_only_computed": 51511, "num_only_roped": 51511, "total_diff": 103022, "diff_percentage": 0.5642474929210277, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:07.943142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.49609375, "l2_diff_relative": 0.11503623188405797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:21.650204", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4084740813597873, "overlap_percentage": 0.5800235684357542, "num_intersection": 79737, "num_union": 195207, "num_only_computed": 57735, "num_only_roped": 57735, "total_diff": 115470, "diff_percentage": 0.5915259186402126, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:22.104443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 9.5367431640625e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.16132478632478633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:36.539714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3848208537909432, "overlap_percentage": 0.5557698712255773, "num_intersection": 80102, "num_union": 208154, "num_only_computed": 64026, "num_only_roped": 64026, "total_diff": 128052, "diff_percentage": 0.6151791462090568, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:37.025228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 9.965896606445312e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.18191056910569106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:52.651238", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3774335088738716, "overlap_percentage": 0.548024287840136, "num_intersection": 82493, "num_union": 218563, "num_only_computed": 68035, "num_only_roped": 68035, "total_diff": 136070, "diff_percentage": 0.6225664911261284, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:53.186787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.1621900826446281}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:09.898939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3599349379661193, "overlap_percentage": 0.5293414087947883, "num_intersection": 83204, "num_union": 231164, "num_only_computed": 73980, "num_only_roped": 73980, "total_diff": 147960, "diff_percentage": 0.6400650620338807, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:11.157437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.15648854961832062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:29.130462", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3470693184901379, "overlap_percentage": 0.51529541015625, "num_intersection": 84426, "num_union": 243254, "num_only_computed": 79414, "num_only_roped": 79414, "total_diff": 158828, "diff_percentage": 0.6529306815098621, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:29.749392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 8.392333984375e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.17036290322580644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:48.892313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33563994837575856, "overlap_percentage": 0.5025904605263158, "num_intersection": 85561, "num_union": 254919, "num_only_computed": 84679, "num_only_roped": 84679, "total_diff": 169358, "diff_percentage": 0.6643600516242414, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:49.528844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 7.486343383789062e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.149822695035461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:26:12.375572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32730567362848856, "overlap_percentage": 0.49318808791606367, "num_intersection": 87243, "num_union": 266549, "num_only_computed": 89653, "num_only_roped": 89653, "total_diff": 179306, "diff_percentage": 0.6726943263715114, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:26:13.073899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.14423076923076922}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:26:34.656494", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31505276827159695, "overlap_percentage": 0.4791484811452514, "num_intersection": 87826, "num_union": 278766, "num_only_computed": 95470, "num_only_roped": 95470, "total_diff": 190940, "diff_percentage": 0.684947231728403, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:26:35.374315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.5703125, "l2_diff_relative": 0.15145228215767634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:26:58.575669", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3078355704120379, "overlap_percentage": 0.4707557698787062, "num_intersection": 89421, "num_union": 290483, "num_only_computed": 100531, "num_only_roped": 100531, "total_diff": 201062, "diff_percentage": 0.6921644295879621, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:26:59.344132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 6.103515625e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.16567460317460317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:27:25.113832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29273376422705427, "overlap_percentage": 0.4528910319010417, "num_intersection": 89042, "num_union": 304174, "num_only_computed": 107566, "num_only_roped": 107566, "total_diff": 215132, "diff_percentage": 0.7072662357729458, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:27:25.925020", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.15575396825396826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:27:51.712969", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29177338224486093, "overlap_percentage": 0.4517408180958386, "num_intersection": 91707, "num_union": 314309, "num_only_computed": 111301, "num_only_roped": 111301, "total_diff": 222602, "diff_percentage": 0.7082266177551391, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:27:52.584365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 6.580352783203125e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.21397379912663755}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:20.179874", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2820506548936639, "overlap_percentage": 0.43999923687423687, "num_intersection": 92252, "num_union": 327076, "num_only_computed": 117412, "num_only_roped": 117412, "total_diff": 234824, "diff_percentage": 0.7179493451063361, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:21.075483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.22065217391304348}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:49.526572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2699599434565006, "overlap_percentage": 0.42514717861374407, "num_intersection": 91859, "num_union": 340269, "num_only_computed": 124205, "num_only_roped": 124205, "total_diff": 248410, "diff_percentage": 0.7300400565434995, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:50.480710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.507469177246094e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.2099056603773585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:21.819740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2652460674093473, "overlap_percentage": 0.4192798132183908, "num_intersection": 93382, "num_union": 352058, "num_only_computed": 129338, "num_only_roped": 129338, "total_diff": 258676, "diff_percentage": 0.7347539325906527, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:22.814874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.364418029785156e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.2}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:54.025642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26166294013624525, "overlap_percentage": 0.41479056222098215, "num_intersection": 95143, "num_union": 363609, "num_only_computed": 134233, "num_only_roped": 134233, "total_diff": 268466, "diff_percentage": 0.7383370598637548, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:55.071591", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.22685185185185186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:30:27.510578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2561020114062263, "overlap_percentage": 0.40777263165038, "num_intersection": 96143, "num_union": 375409, "num_only_computed": 139633, "num_only_roped": 139633, "total_diff": 279266, "diff_percentage": 0.7438979885937738, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:30:30.972423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.1744186046511628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:31:04.908708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24441204928740634, "overlap_percentage": 0.39281530491024286, "num_intersection": 95231, "num_union": 389633, "num_only_computed": 147201, "num_only_roped": 147201, "total_diff": 294402, "diff_percentage": 0.7555879507125937, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:31:06.041904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.17653061224489797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:31:41.726442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24360970270655236, "overlap_percentage": 0.39177838863168724, "num_intersection": 97487, "num_union": 400177, "num_only_computed": 151345, "num_only_roped": 151345, "total_diff": 302690, "diff_percentage": 0.7563902972934476, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:31:42.900107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.18016194331983806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:32:19.269975", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23735286069561384, "overlap_percentage": 0.3836461986472946, "num_intersection": 98017, "num_union": 412959, "num_only_computed": 157471, "num_only_roped": 157471, "total_diff": 314942, "diff_percentage": 0.7626471393043861, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:32:22.256029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.21666666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:33:00.794346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23029269105406794, "overlap_percentage": 0.3743705749511719, "num_intersection": 98139, "num_union": 426149, "num_only_computed": 164005, "num_only_roped": 164005, "total_diff": 328010, "diff_percentage": 0.7697073089459321, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:33:03.760774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.18563432835820895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:33:43.341237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2199835544995707, "overlap_percentage": 0.3606336391801716, "num_intersection": 96846, "num_union": 440242, "num_only_computed": 171698, "num_only_roped": 171698, "total_diff": 343396, "diff_percentage": 0.7800164455004293, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:33:45.853190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.19215686274509805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:34:26.951708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2114382307367235, "overlap_percentage": 0.34906976744186047, "num_intersection": 96064, "num_union": 454336, "num_only_computed": 179136, "num_only_roped": 179136, "total_diff": 358272, "diff_percentage": 0.7885617692632765, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:34:28.320749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.1638888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:35:10.594196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2039127163280662, "overlap_percentage": 0.33875, "num_intersection": 95392, "num_union": 467808, "num_only_computed": 186208, "num_only_roped": 186208, "total_diff": 372416, "diff_percentage": 0.7960872836719338, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:35:11.984375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.2354771784232365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:35:56.105721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1924191436685206, "overlap_percentage": 0.3227374278419183, "num_intersection": 93031, "num_union": 483481, "num_only_computed": 195225, "num_only_roped": 195225, "total_diff": 390450, "diff_percentage": 0.8075808563314795, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:35:57.562141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.3877551020408163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:36:42.552046", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1805144976412687, "overlap_percentage": 0.3058234320746528, "num_intersection": 90191, "num_union": 499633, "num_only_computed": 204721, "num_only_roped": 204721, "total_diff": 409442, "diff_percentage": 0.8194855023587313, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:36:46.168093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.3840909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:37:33.699618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16881373815425554, "overlap_percentage": 0.28886337085811387, "num_intersection": 87038, "num_union": 515586, "num_only_computed": 214274, "num_only_roped": 214274, "total_diff": 428548, "diff_percentage": 0.8311862618457444, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:37:35.250117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.5234375, "l2_diff_relative": 0.45774647887323944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:38:23.263546", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15878292574176398, "overlap_percentage": 0.27405120012468825, "num_intersection": 84399, "num_union": 531537, "num_only_computed": 223569, "num_only_roped": 223569, "total_diff": 447138, "diff_percentage": 0.841217074258236, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:38:24.826910", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 9.059906005859375e-05, "l2_diff": 1.9609375, "l2_diff_relative": 0.7560240963855421}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:39:14.349290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15090509374937075, "overlap_percentage": 0.2622372506107492, "num_intersection": 82439, "num_union": 546297, "num_only_computed": 231929, "num_only_roped": 231929, "total_diff": 463858, "diff_percentage": 0.8490949062506292, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:39:17.278905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 9.1552734375e-05, "l2_diff": 2.0, "l2_diff_relative": 0.7619047619047619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:40:08.806670", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1441850518587162, "overlap_percentage": 0.25203100079744817, "num_intersection": 80908, "num_union": 561140, "num_only_computed": 240116, "num_only_roped": 240116, "total_diff": 480232, "diff_percentage": 0.8558149481412838, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:40:11.653965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 8.153915405273438e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.6197604790419161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:41:05.349741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14152936647698078, "overlap_percentage": 0.2479644775390625, "num_intersection": 81253, "num_union": 574107, "num_only_computed": 246427, "num_only_roped": 246427, "total_diff": 492854, "diff_percentage": 0.8584706335230192, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:41:08.317475", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 8.96453857421875e-05, "l2_diff": 1.875, "l2_diff_relative": 0.7741935483870968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:42:03.086277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14044026155571374, "overlap_percentage": 0.24629130747126438, "num_intersection": 82281, "num_union": 585879, "num_only_computed": 251799, "num_only_roped": 251799, "total_diff": 503598, "diff_percentage": 0.8595597384442862, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:42:05.473632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 9.679794311523438e-05, "l2_diff": 2.125, "l2_diff_relative": 0.9379310344827586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:43:00.815518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1393547459460544, "overlap_percentage": 0.24462046863260706, "num_intersection": 83351, "num_union": 598121, "num_only_computed": 257385, "num_only_roped": 257385, "total_diff": 514770, "diff_percentage": 0.8606452540539457, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:43:02.634099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 9.775161743164062e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.9689922480620154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:43:58.425749", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13807992289004947, "overlap_percentage": 0.24265417588495575, "num_intersection": 84234, "num_union": 610038, "num_only_computed": 262902, "num_only_roped": 262902, "total_diff": 525804, "diff_percentage": 0.8619200771099506, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:44:00.222081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 7.82012939453125e-05, "l2_diff": 1.9453125, "l2_diff_relative": 0.7073863636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:44:57.649577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1361481843055145, "overlap_percentage": 0.2396662445730825, "num_intersection": 84792, "num_union": 622792, "num_only_computed": 269000, "num_only_roped": 269000, "total_diff": 538000, "diff_percentage": 0.8638518156944854, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:44:59.541999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 7.677078247070312e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.7435064935064936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:45:58.178951", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13604036755656201, "overlap_percentage": 0.2394991787997159, "num_intersection": 86327, "num_union": 634569, "num_only_computed": 274121, "num_only_roped": 274121, "total_diff": 548242, "diff_percentage": 0.863959632443438, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:46:01.976344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.62939453125e-05, "l2_diff": 1.7265625, "l2_diff_relative": 0.7129032258064516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:47:02.060242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13551678134876047, "overlap_percentage": 0.23868741277041172, "num_intersection": 87562, "num_union": 646134, "num_only_computed": 279286, "num_only_roped": 279286, "total_diff": 558572, "diff_percentage": 0.8644832186512396, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:47:04.019247", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.761437908496732}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:48:06.474782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13745726967498306, "overlap_percentage": 0.241692190712817, "num_intersection": 90273, "num_union": 656735, "num_only_computed": 283231, "num_only_roped": 283231, "total_diff": 566462, "diff_percentage": 0.8625427303250169, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:48:08.526647", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.7621951219512195}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:49:11.300041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13406718060852107, "overlap_percentage": 0.2364360470013477, "num_intersection": 89823, "num_union": 669985, "num_only_computed": 290081, "num_only_roped": 290081, "total_diff": 580162, "diff_percentage": 0.8659328193914789, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:49:14.904248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.655688622754491}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:50:19.140568", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1340759668954025, "overlap_percentage": 0.23644971026490066, "num_intersection": 91402, "num_union": 681718, "num_only_computed": 295158, "num_only_roped": 295158, "total_diff": 590316, "diff_percentage": 0.8659240331045975, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:50:21.251601", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.6186440677966102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:51:28.507177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13067507066431647, "overlap_percentage": 0.23114522298177084, "num_intersection": 90890, "num_union": 695542, "num_only_computed": 302326, "num_only_roped": 302326, "total_diff": 604652, "diff_percentage": 0.8693249293356835, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:51:30.661530", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.390975952148438e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.7653061224489796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:52:39.230916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12733335402097162, "overlap_percentage": 0.2259018657911595, "num_intersection": 90274, "num_union": 708958, "num_only_computed": 309342, "num_only_roped": 309342, "total_diff": 618684, "diff_percentage": 0.8726666459790283, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:52:43.625066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 8.487701416015625e-05, "l2_diff": 2.0625, "l2_diff_relative": 1.0393700787401574}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:53:53.842294", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1275076146006064, "overlap_percentage": 0.22617605938878388, "num_intersection": 91889, "num_union": 720655, "num_only_computed": 314383, "num_only_roped": 314383, "total_diff": 628766, "diff_percentage": 0.8724923853993936, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:53:56.307561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.76}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:55:08.502738", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13808528358916938, "overlap_percentage": 0.2426624534739454, "num_intersection": 100140, "num_union": 725204, "num_only_computed": 312532, "num_only_roped": 312532, "total_diff": 625064, "diff_percentage": 0.8619147164108306, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:55:10.866048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 5.7220458984375e-05, "l2_diff": 1.5, "l2_diff_relative": 0.48}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:56:25.884347", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1327510126679732, "overlap_percentage": 0.23438692384004883, "num_intersection": 98285, "num_union": 740371, "num_only_computed": 321043, "num_only_roped": 321043, "total_diff": 642086, "diff_percentage": 0.8672489873320268, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:56:28.328683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.6848484848484848}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:57:44.363429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1311777303633049, "overlap_percentage": 0.2319312462439904, "num_intersection": 98799, "num_union": 753169, "num_only_computed": 327185, "num_only_roped": 327185, "total_diff": 654370, "diff_percentage": 0.8688222696366951, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:57:48.339150", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 5.8650970458984375e-05, "l2_diff": 1.796875, "l2_diff_relative": 0.5609756097560976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:59:06.935657", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1279960242147237, "overlap_percentage": 0.22694410523978686, "num_intersection": 98127, "num_union": 766641, "num_only_computed": 334257, "num_only_roped": 334257, "total_diff": 668514, "diff_percentage": 0.8720039757852763, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:59:11.706139", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.6607142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:00:31.360670", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12423883929714587, "overlap_percentage": 0.2210185860058309, "num_intersection": 97036, "num_union": 781044, "num_only_computed": 342004, "num_only_roped": 342004, "total_diff": 684008, "diff_percentage": 0.8757611607028541, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:00:35.232770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 6.437301635742188e-05, "l2_diff": 1.6015625, "l2_diff_relative": 0.6655844155844156}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:01:56.081426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1247689557304029, "overlap_percentage": 0.22185704022988506, "num_intersection": 98824, "num_union": 792056, "num_only_computed": 346616, "num_only_roped": 346616, "total_diff": 693232, "diff_percentage": 0.8752310442695971, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:02:00.745475", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 6.866455078125e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.7865612648221344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:03:23.155128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12053199096329179, "overlap_percentage": 0.21513351146659115, "num_intersection": 97261, "num_union": 806931, "num_only_computed": 354835, "num_only_roped": 354835, "total_diff": 709670, "diff_percentage": 0.8794680090367082, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:03:26.015397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.375, "l2_diff_relative": 0.6717557251908397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:04:51.235579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12156213671630041, "overlap_percentage": 0.21677289690290177, "num_intersection": 99445, "num_union": 818059, "num_only_computed": 359307, "num_only_roped": 359307, "total_diff": 718614, "diff_percentage": 0.8784378632836995, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:04:54.021641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.823943661971831}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:06:21.633175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12398315784386572, "overlap_percentage": 0.22061390685195378, "num_intersection": 102619, "num_union": 827685, "num_only_computed": 362533, "num_only_roped": 362533, "total_diff": 725066, "diff_percentage": 0.8760168421561343, "num_computed": 465152, "num_roped": 465152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "mask_shape": [1, 32, 256, 15616], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:06:24.386724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.9173228346456693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15616, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15616, 128], "attention_shape": [1, 32, 256, 15616]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:07:51.887967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12736661135065452, "overlap_percentage": 0.22595420170916983, "num_intersection": 106607, "num_union": 837009, "num_only_computed": 365201, "num_only_roped": 365201, "total_diff": 730402, "diff_percentage": 0.8726333886493455, "num_computed": 471808, "num_roped": 471808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "mask_shape": [1, 32, 256, 15872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:07:54.725511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.90625, "l2_diff_relative": 0.9172932330827067}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15872, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15872, 128], "attention_shape": [1, 32, 256, 15872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:09:24.350202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1234163313153524, "overlap_percentage": 0.2197161067987152, "num_intersection": 105070, "num_union": 851346, "num_only_computed": 373138, "num_only_roped": 373138, "total_diff": 746276, "diff_percentage": 0.8765836686846477, "num_computed": 478208, "num_roped": 478208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "mask_shape": [1, 32, 256, 16128], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:09:27.238000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.984375, "l2_diff_relative": 0.9477611940298507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 16128, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 16128, 128], "attention_shape": [1, 32, 256, 16128]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:10:54.038207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12575909285965073, "overlap_percentage": 0.2234209675183662, "num_intersection": 58026, "num_union": 461406, "num_only_computed": 201690, "num_only_roped": 201690, "total_diff": 403380, "diff_percentage": 0.8742409071403493, "num_computed": 259716, "num_roped": 259716}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 138, "seq_len_k": 16266, "queries_shape": [1, 32, 138, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 138, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:10:59.314899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 5.435943603515625e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.6}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 138, "seq_len_k": 16266, "queries_shape": [1, 32, 138, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 138, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:12:20.157796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1236122494598018, "overlap_percentage": 0.220026525198939, "num_intersection": 11613, "num_union": 93947, "num_only_computed": 41167, "num_only_roped": 41167, "total_diff": 82334, "diff_percentage": 0.8763877505401982, "num_computed": 52780, "num_roped": 52780}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 28, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:12:25.293017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12158203125, "mean_diff": 5.6743621826171875e-05, "l2_diff": 0.58203125, "l2_diff_relative": 0.5775193798449613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 28, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:13:32.532144", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1341756919374248, "overlap_percentage": 0.23660477453580903, "num_intersection": 446, "num_union": 3324, "num_only_computed": 1439, "num_only_roped": 1439, "total_diff": 2878, "diff_percentage": 0.8658243080625753, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:13:34.350908", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.08154296875, "l2_diff_relative": 0.45879120879120877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:14:31.525262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13043478260869565, "overlap_percentage": 0.23076923076923078, "num_intersection": 435, "num_union": 3335, "num_only_computed": 1450, "num_only_roped": 1450, "total_diff": 2900, "diff_percentage": 0.8695652173913043, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:14:33.383022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.0556640625, "l2_diff_relative": 0.3202247191011236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:09.307501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:09.320946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1622905731201172e-05, "l2_diff": 0.018310546875, "l2_diff_relative": 0.0031844429347826085}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:11.433607", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8593354958736822, "overlap_percentage": 0.9243468946629123, "num_intersection": 72057, "num_union": 83852, "num_only_computed": 6535, "num_only_roped": 5260, "total_diff": 11795, "diff_percentage": 0.14066450412631779, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:11.572471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.0849609375, "l2_diff_relative": 0.01720727848101266}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:16.412918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7465425477261985, "overlap_percentage": 0.8548804593373494, "num_intersection": 72658, "num_union": 97326, "num_only_computed": 12334, "num_only_roped": 12334, "total_diff": 24668, "diff_percentage": 0.25345745227380145, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:16.589888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 0.00011491775512695312, "l2_diff": 0.24609375, "l2_diff_relative": 0.054310344827586204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:22.446551", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6591476881856693, "overlap_percentage": 0.7945618016759777, "num_intersection": 72820, "num_union": 110476, "num_only_computed": 18828, "num_only_roped": 18828, "total_diff": 37656, "diff_percentage": 0.34085231181433073, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:23.046317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 0.0001430511474609375, "l2_diff": 0.388671875, "l2_diff_relative": 0.09145220588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:29.958336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.593451391984439, "overlap_percentage": 0.7448628743489584, "num_intersection": 73223, "num_union": 123385, "num_only_computed": 25081, "num_only_roped": 25081, "total_diff": 50162, "diff_percentage": 0.40654860801556103, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:30.202991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 0.00017547607421875, "l2_diff": 0.578125, "l2_diff_relative": 0.13602941176470587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:38.139040", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5422368207862603, "overlap_percentage": 0.703182304400978, "num_intersection": 73626, "num_union": 135782, "num_only_computed": 31078, "num_only_roped": 31078, "total_diff": 62156, "diff_percentage": 0.45776317921373966, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:38.412112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 0.0002193450927734375, "l2_diff": 0.83203125, "l2_diff_relative": 0.21215139442231076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:47.501862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5106113119501889, "overlap_percentage": 0.6760326867816092, "num_intersection": 75283, "num_union": 147437, "num_only_computed": 36077, "num_only_roped": 36077, "total_diff": 72154, "diff_percentage": 0.4893886880498111, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:47.808451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 0.0001468658447265625, "l2_diff": 0.69140625, "l2_diff_relative": 0.1728515625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:57.929897", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4678075746150059, "overlap_percentage": 0.6374235733695652, "num_intersection": 75063, "num_union": 160457, "num_only_computed": 42697, "num_only_roped": 42697, "total_diff": 85394, "diff_percentage": 0.5321924253849941, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:58.274323", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 0.0001430511474609375, "l2_diff": 0.84375, "l2_diff_relative": 0.19852941176470587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:09.941525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4430481050830748, "overlap_percentage": 0.6140448173868313, "num_intersection": 76397, "num_union": 172435, "num_only_computed": 48019, "num_only_roped": 48019, "total_diff": 96038, "diff_percentage": 0.5569518949169252, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:10.327704", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 0.000133514404296875, "l2_diff": 0.73828125, "l2_diff_relative": 0.17763157894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:23.566650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4321365354778086, "overlap_percentage": 0.603485107421875, "num_intersection": 79100, "num_union": 183044, "num_only_computed": 51972, "num_only_roped": 51972, "total_diff": 103944, "diff_percentage": 0.5678634645221914, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:23.977851", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 0.0001373291015625, "l2_diff": 0.8125, "l2_diff_relative": 0.1925925925925926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:38.778907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4153694094390907, "overlap_percentage": 0.5869413407821229, "num_intersection": 80688, "num_union": 194256, "num_only_computed": 56784, "num_only_roped": 56784, "total_diff": 113568, "diff_percentage": 0.5846305905609093, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:39.240097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 0.00015163421630859375, "l2_diff": 0.9921875, "l2_diff_relative": 0.27850877192982454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:53.784424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3951426331226345, "overlap_percentage": 0.5664548179396093, "num_intersection": 81642, "num_union": 206614, "num_only_computed": 62486, "num_only_roped": 62486, "total_diff": 124972, "diff_percentage": 0.6048573668773656, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:16:54.282330", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0966796875, "mean_diff": 0.00014400482177734375, "l2_diff": 1.0234375, "l2_diff_relative": 0.2911111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:10.028665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3697064550765255, "overlap_percentage": 0.5398331207482994, "num_intersection": 81260, "num_union": 219796, "num_only_computed": 69268, "num_only_roped": 69268, "total_diff": 138536, "diff_percentage": 0.6302935449234744, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:10.569451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 0.00013256072998046875, "l2_diff": 1.03125, "l2_diff_relative": 0.28820960698689957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:27.493781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3592410996099999, "overlap_percentage": 0.5285906962540716, "num_intersection": 83086, "num_union": 231282, "num_only_computed": 74098, "num_only_roped": 74098, "total_diff": 148196, "diff_percentage": 0.64075890039, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:28.316576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 0.00012969970703125, "l2_diff": 1.0234375, "l2_diff_relative": 0.28728070175438597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:46.394206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34018257370022575, "overlap_percentage": 0.507666015625, "num_intersection": 83176, "num_union": 244504, "num_only_computed": 80664, "num_only_roped": 80664, "total_diff": 161328, "diff_percentage": 0.6598174262997742, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:46.999505", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06494140625, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.81640625, "l2_diff_relative": 0.2159090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:06.228393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3276972750386049, "overlap_percentage": 0.4936325187969925, "num_intersection": 84036, "num_union": 256444, "num_only_computed": 86204, "num_only_roped": 86204, "total_diff": 172408, "diff_percentage": 0.6723027249613951, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:09.022914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.1794871794871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:29.357843", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3144398457411632, "overlap_percentage": 0.47843930897250364, "num_intersection": 84634, "num_union": 269158, "num_only_computed": 92262, "num_only_roped": 92262, "total_diff": 184524, "diff_percentage": 0.6855601542588368, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:30.050702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.16774891774891776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:51.884850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30197538055020845, "overlap_percentage": 0.46387264315642457, "num_intersection": 85026, "num_union": 281566, "num_only_computed": 98270, "num_only_roped": 98270, "total_diff": 196540, "diff_percentage": 0.6980246194497916, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:52.614076", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.20771144278606965}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:19:15.955352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2879979115599901, "overlap_percentage": 0.44720245114555257, "num_intersection": 84947, "num_union": 294957, "num_only_computed": 105005, "num_only_roped": 105005, "total_diff": 210010, "diff_percentage": 0.7120020884400099, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:19:19.064484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 8.630752563476562e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.271889400921659}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:19:44.125052", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2823166854179915, "overlap_percentage": 0.4403228759765625, "num_intersection": 86571, "num_union": 306645, "num_only_computed": 110037, "num_only_roped": 110037, "total_diff": 220074, "diff_percentage": 0.7176833145820085, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:19:46.732334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 6.580352783203125e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.22560975609756098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:20:12.775261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2638984438474541, "overlap_percentage": 0.41759438051702397, "num_intersection": 84775, "num_union": 321241, "num_only_computed": 118233, "num_only_roped": 118233, "total_diff": 236466, "diff_percentage": 0.7361015561525459, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:20:14.352509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.7890625, "l2_diff_relative": 0.2525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:20:41.551132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25711784580424085, "overlap_percentage": 0.4090592567155067, "num_intersection": 85765, "num_union": 333563, "num_only_computed": 123899, "num_only_roped": 123899, "total_diff": 247798, "diff_percentage": 0.7428821541957591, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:20:42.461905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08056640625, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.2170212765957447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:21:10.861470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25140959071914465, "overlap_percentage": 0.40180224377962087, "num_intersection": 86815, "num_union": 345313, "num_only_computed": 129249, "num_only_roped": 129249, "total_diff": 258498, "diff_percentage": 0.7485904092808553, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:21:11.807837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.1576923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:21:44.604284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2542412015306338, "overlap_percentage": 0.40541038074712643, "num_intersection": 90293, "num_union": 355147, "num_only_computed": 132427, "num_only_roped": 132427, "total_diff": 264854, "diff_percentage": 0.7457587984693662, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:21:45.623611", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.1518987341772152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:22:18.326678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2508745858839248, "overlap_percentage": 0.40111868722098215, "num_intersection": 92007, "num_union": 366745, "num_only_computed": 137369, "num_only_roped": 137369, "total_diff": 274738, "diff_percentage": 0.7491254141160752, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:22:19.401004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.2704741379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:22:53.233537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24680599035451392, "overlap_percentage": 0.3959011943539631, "num_intersection": 93344, "num_union": 378208, "num_only_computed": 142432, "num_only_roped": 142432, "total_diff": 284864, "diff_percentage": 0.7531940096454861, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:22:54.397016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.17971887550200802}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:23:29.603354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24892845367622815, "overlap_percentage": 0.3986272439281943, "num_intersection": 96640, "num_union": 388224, "num_only_computed": 145792, "num_only_roped": 145792, "total_diff": 291584, "diff_percentage": 0.7510715463237718, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:23:30.777670", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.18954918032786885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:24:06.370826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24319031155698556, "overlap_percentage": 0.391235853909465, "num_intersection": 97352, "num_union": 400312, "num_only_computed": 151480, "num_only_roped": 151480, "total_diff": 302960, "diff_percentage": 0.7568096884430144, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:24:08.582328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.796875, "l2_diff_relative": 0.21982758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:24:44.721780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2294336880652713, "overlap_percentage": 0.37323475075150303, "num_intersection": 95357, "num_union": 415619, "num_only_computed": 160131, "num_only_roped": 160131, "total_diff": 320262, "diff_percentage": 0.7705663119347287, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:24:45.916497", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.19874476987447698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:25:25.066926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23644664974954485, "overlap_percentage": 0.3824615478515625, "num_intersection": 100260, "num_union": 424028, "num_only_computed": 161884, "num_only_roped": 161884, "total_diff": 323768, "diff_percentage": 0.7635533502504551, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:25:26.285566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.169921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:26:04.646812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23203688623303934, "overlap_percentage": 0.37667197926596757, "num_intersection": 101153, "num_union": 435935, "num_only_computed": 167391, "num_only_roped": 167391, "total_diff": 334782, "diff_percentage": 0.7679631137669607, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:26:05.919450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.67578125, "l2_diff_relative": 0.16382575757575757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:26:45.915420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22449342813665205, "overlap_percentage": 0.36667151162790695, "num_intersection": 100908, "num_union": 449492, "num_only_computed": 174292, "num_only_roped": 174292, "total_diff": 348584, "diff_percentage": 0.7755065718633479, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:26:47.222147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.17333333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:27:28.406642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21906345104048972, "overlap_percentage": 0.3593963068181818, "num_intersection": 101206, "num_union": 461994, "num_only_computed": 180394, "num_only_roped": 180394, "total_diff": 360788, "diff_percentage": 0.7809365489595103, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:27:29.779711", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0966796875, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.890625, "l2_diff_relative": 0.285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:28:12.150386", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22441732541000667, "overlap_percentage": 0.366569993339254, "num_intersection": 105666, "num_union": 470846, "num_only_computed": 182590, "num_only_roped": 182590, "total_diff": 365180, "diff_percentage": 0.7755826745899933, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:28:13.550599", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07763671875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.0, "l2_diff_relative": 0.25806451612903225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:28:59.097729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21294079905239, "overlap_percentage": 0.3511149088541667, "num_intersection": 103548, "num_union": 486276, "num_only_computed": 191364, "num_only_roped": 191364, "total_diff": 382728, "diff_percentage": 0.78705920094761, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:29:00.557933", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 1.125, "l2_diff_relative": 0.33962264150943394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:29:47.174774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1978976997145515, "overlap_percentage": 0.33040834749362785, "num_intersection": 99556, "num_union": 503068, "num_only_computed": 201756, "num_only_roped": 201756, "total_diff": 403512, "diff_percentage": 0.8021023002854485, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:29:48.681718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.5703125, "l2_diff_relative": 0.5552486187845304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:34.877916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19410716674453726, "overlap_percentage": 0.32510845282626766, "num_intersection": 100123, "num_union": 515813, "num_only_computed": 207845, "num_only_roped": 207845, "total_diff": 415690, "diff_percentage": 0.8058928332554627, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:37.061401", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 9.107589721679688e-05, "l2_diff": 1.625, "l2_diff_relative": 0.7878787878787878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:31:24.800467", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18565229771802816, "overlap_percentage": 0.3131648259364821, "num_intersection": 98449, "num_union": 530287, "num_only_computed": 215919, "num_only_roped": 215919, "total_diff": 431838, "diff_percentage": 0.8143477022819718, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:31:26.387184", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 8.296966552734375e-05, "l2_diff": 1.7265625, "l2_diff_relative": 0.6779141104294478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:32:15.859558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17668361306497668, "overlap_percentage": 0.30030776515151514, "num_intersection": 96406, "num_union": 545642, "num_only_computed": 224618, "num_only_roped": 224618, "total_diff": 449236, "diff_percentage": 0.8233163869350233, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:32:17.487710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.625, "l2_diff_relative": 0.6459627329192547}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:33:08.440958", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1706180862066194, "overlap_percentage": 0.2915008544921875, "num_intersection": 95519, "num_union": 559841, "num_only_computed": 232161, "num_only_roped": 232161, "total_diff": 464322, "diff_percentage": 0.8293819137933807, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:33:10.865190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.46634615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:34:02.986267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1652435961828227, "overlap_percentage": 0.2836206896551724, "num_intersection": 94752, "num_union": 573408, "num_only_computed": 239328, "num_only_roped": 239328, "total_diff": 478656, "diff_percentage": 0.8347564038171773, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:34:06.108308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.5714285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:35:00.155319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16112037811653937, "overlap_percentage": 0.27752570905334334, "num_intersection": 94563, "num_union": 586909, "num_only_computed": 246173, "num_only_roped": 246173, "total_diff": 492346, "diff_percentage": 0.8388796218834607, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:35:01.925106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12158203125, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.5684210526315789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:35:58.535224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15796145198844494, "overlap_percentage": 0.2728267883480826, "num_intersection": 94708, "num_union": 599564, "num_only_computed": 252428, "num_only_roped": 252428, "total_diff": 504856, "diff_percentage": 0.8420385480115551, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:36:00.444636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 8.58306884765625e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.8159509202453987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:36:58.639877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1574122842888689, "overlap_percentage": 0.27200728111432704, "num_intersection": 96234, "num_union": 611350, "num_only_computed": 257558, "num_only_roped": 257558, "total_diff": 515116, "diff_percentage": 0.8425877157111311, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:37:00.600913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.984375, "l2_diff_relative": 0.8193548387096774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:38:01.803685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15257055516829, "overlap_percentage": 0.2647483132102273, "num_intersection": 95428, "num_union": 625468, "num_only_computed": 265020, "num_only_roped": 265020, "total_diff": 530040, "diff_percentage": 0.84742944483171, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:38:03.821585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 8.726119995117188e-05, "l2_diff": 1.9140625, "l2_diff_relative": 0.8166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:39:05.484579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15289947076644583, "overlap_percentage": 0.265243370551291, "num_intersection": 97304, "num_union": 636392, "num_only_computed": 269544, "num_only_roped": 269544, "total_diff": 539088, "diff_percentage": 0.8471005292335542, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:39:08.295596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 9.298324584960938e-05, "l2_diff": 2.296875, "l2_diff_relative": 1.0068493150684932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:40:11.838831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15219269021001455, "overlap_percentage": 0.2641792323509253, "num_intersection": 98672, "num_union": 648336, "num_only_computed": 274832, "num_only_roped": 274832, "total_diff": 549664, "diff_percentage": 0.8478073097899854, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:40:13.915964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1787109375, "mean_diff": 9.34600830078125e-05, "l2_diff": 2.453125, "l2_diff_relative": 1.0397350993377483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:41:17.683576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1468574956265009, "overlap_percentage": 0.2561041736859838, "num_intersection": 97295, "num_union": 662513, "num_only_computed": 282609, "num_only_roped": 282609, "total_diff": 565218, "diff_percentage": 0.853142504373499, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:41:19.748361", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 7.915496826171875e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.7182320441988951}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:42:23.663722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1486455366521511, "overlap_percentage": 0.2588188120860927, "num_intersection": 100049, "num_union": 673071, "num_only_computed": 286511, "num_only_roped": 286511, "total_diff": 573022, "diff_percentage": 0.8513544633478489, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:42:26.267784", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 7.677078247070312e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.7015706806282722}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:43:31.790576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14861752329930755, "overlap_percentage": 0.25877634684244794, "num_intersection": 101755, "num_union": 684677, "num_only_computed": 291461, "num_only_roped": 291461, "total_diff": 582922, "diff_percentage": 0.8513824767006924, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:43:35.650936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.7769784172661871}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:44:42.567941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14498066704773857, "overlap_percentage": 0.2532456157911595, "num_intersection": 101201, "num_union": 698031, "num_only_computed": 298415, "num_only_roped": 298415, "total_diff": 596830, "diff_percentage": 0.8550193329522614, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:44:44.800054", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 7.915496826171875e-05, "l2_diff": 1.6484375, "l2_diff_relative": 0.8755186721991701}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:45:53.838769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14883419084743318, "overlap_percentage": 0.2591047377126654, "num_intersection": 105267, "num_union": 707277, "num_only_computed": 301005, "num_only_roped": 301005, "total_diff": 602010, "diff_percentage": 0.8511658091525668, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:45:56.200806", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 8.535385131835938e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.9637681159420289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:47:08.274445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1435855655133044, "overlap_percentage": 0.25111468672456577, "num_intersection": 103628, "num_union": 721716, "num_only_computed": 309044, "num_only_roped": 309044, "total_diff": 618088, "diff_percentage": 0.8564144344866956, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:47:10.606432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.888938903808594e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.4945945945945946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:48:23.294674", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14038157943044557, "overlap_percentage": 0.24620106456043955, "num_intersection": 103239, "num_union": 735417, "num_only_computed": 316089, "num_only_roped": 316089, "total_diff": 632178, "diff_percentage": 0.8596184205695544, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:48:26.182838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.4849853515625e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.60062893081761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:38.867519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13811418607770376, "overlap_percentage": 0.24270708118258028, "num_intersection": 61784, "num_union": 447340, "num_only_computed": 192778, "num_only_roped": 192778, "total_diff": 385556, "diff_percentage": 0.8618858139222962, "num_computed": 254562, "num_roped": 254562}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 154, "seq_len_k": 13978, "queries_shape": [1, 32, 154, 128], "keys_shape": [1, 8, 13978, 128], "mask_shape": [1, 32, 154, 13978], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:41.247191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.29120879120879123}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 154, "seq_len_k": 13978, "queries_shape": [1, 32, 154, 128], "keys_shape": [1, 8, 13978, 128], "attention_shape": [1, 32, 154, 13978]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:50:51.019682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1419373258641568, "overlap_percentage": 0.2485903957237693, "num_intersection": 14417, "num_union": 101573, "num_only_computed": 43578, "num_only_roped": 43578, "total_diff": 87156, "diff_percentage": 0.8580626741358431, "num_computed": 57995, "num_roped": 57995}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "mask_shape": [1, 32, 35, 14013], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:50:53.186674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08740234375, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.39827586206896554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "attention_shape": [1, 32, 35, 14013]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:51:51.941919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15874125874125875, "overlap_percentage": 0.2739891369945685, "num_intersection": 454, "num_union": 2860, "num_only_computed": 1203, "num_only_roped": 1203, "total_diff": 2406, "diff_percentage": 0.8412587412587412, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "mask_shape": [1, 32, 1, 14014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:51:53.575006", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.068359375, "l2_diff_relative": 0.5109489051094891}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "attention_shape": [1, 32, 1, 14014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:52:43.825555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15631542219120725, "overlap_percentage": 0.2703681351840676, "num_intersection": 448, "num_union": 2866, "num_only_computed": 1209, "num_only_roped": 1209, "total_diff": 2418, "diff_percentage": 0.8436845778087927, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "mask_shape": [1, 32, 1, 14015], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:52:46.753167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 6.961822509765625e-05, "l2_diff": 0.1005859375, "l2_diff_relative": 0.7054794520547946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "attention_shape": [1, 32, 1, 14015]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:20.288987", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:20.303461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1086463928222656e-05, "l2_diff": 0.017822265625, "l2_diff_relative": 0.003099524456521739}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:22.441245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8580724356147732, "overlap_percentage": 0.9236156989012821, "num_intersection": 72000, "num_union": 83909, "num_only_computed": 6592, "num_only_roped": 5317, "total_diff": 11909, "diff_percentage": 0.14192756438522686, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:22.582298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.014438291139240507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:27.466955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7386288087226013, "overlap_percentage": 0.8496682040662651, "num_intersection": 72215, "num_union": 97769, "num_only_computed": 12777, "num_only_roped": 12777, "total_diff": 25554, "diff_percentage": 0.2613711912773988, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:28.389952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 8.344650268554688e-05, "l2_diff": 0.193359375, "l2_diff_relative": 0.042091836734693876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:34.388278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.65250631085467, "overlap_percentage": 0.7897171787709497, "num_intersection": 72376, "num_union": 110920, "num_only_computed": 19272, "num_only_roped": 19272, "total_diff": 38544, "diff_percentage": 0.34749368914532996, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:34.603905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 0.00016021728515625, "l2_diff": 0.41796875, "l2_diff_relative": 0.09834558823529412}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:41.684287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6008598368264204, "overlap_percentage": 0.75067138671875, "num_intersection": 73794, "num_union": 122814, "num_only_computed": 24510, "num_only_roped": 24510, "total_diff": 49020, "diff_percentage": 0.39914016317357953, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:42.193715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 0.00017070770263671875, "l2_diff": 0.4609375, "l2_diff_relative": 0.12394957983193278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:50.355370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5603242727706247, "overlap_percentage": 0.7182151589242054, "num_intersection": 75200, "num_union": 134208, "num_only_computed": 29504, "num_only_roped": 29504, "total_diff": 59008, "diff_percentage": 0.4396757272293753, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:50.644810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.000171661376953125, "l2_diff": 0.59375, "l2_diff_relative": 0.152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:00.452716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5170008718395815, "overlap_percentage": 0.6816091954022988, "num_intersection": 75904, "num_union": 146816, "num_only_computed": 35456, "num_only_roped": 35456, "total_diff": 70912, "diff_percentage": 0.48299912816041846, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:00.788540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.00015354156494140625, "l2_diff": 0.7109375, "l2_diff_relative": 0.1685185185185185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:11.188793", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48163059889280324, "overlap_percentage": 0.6501358695652174, "num_intersection": 76560, "num_union": 158960, "num_only_computed": 41200, "num_only_roped": 41200, "total_diff": 82400, "diff_percentage": 0.5183694011071968, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:11.544780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.4609375, "l2_diff_relative": 0.08526011560693642}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:23.059244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45693859746707965, "overlap_percentage": 0.6272585519547325, "num_intersection": 78041, "num_union": 170791, "num_only_computed": 46375, "num_only_roped": 46375, "total_diff": 92750, "diff_percentage": 0.5430614025329203, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:23.661496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.3203125, "l2_diff_relative": 0.06570512820512821}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:36.365360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4164586372723834, "overlap_percentage": 0.5880279541015625, "num_intersection": 77074, "num_union": 185070, "num_only_computed": 53998, "num_only_roped": 53998, "total_diff": 107996, "diff_percentage": 0.5835413627276166, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:37.444222", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.412109375, "l2_diff_relative": 0.09915413533834587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:51.205368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40716212273976526, "overlap_percentage": 0.5786996624767226, "num_intersection": 79555, "num_union": 195389, "num_only_computed": 57917, "num_only_roped": 57917, "total_diff": 115834, "diff_percentage": 0.5928378772602347, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:51.660688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 9.489059448242188e-05, "l2_diff": 0.625, "l2_diff_relative": 0.15503875968992248}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:06.636689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3870865293002396, "overlap_percentage": 0.5581288854351687, "num_intersection": 80442, "num_union": 207814, "num_only_computed": 63686, "num_only_roped": 63686, "total_diff": 127372, "diff_percentage": 0.6129134706997603, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:07.154172", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.1618217054263566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:23.262709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3711225172952466, "overlap_percentage": 0.5413411458333334, "num_intersection": 81487, "num_union": 219569, "num_only_computed": 69041, "num_only_roped": 69041, "total_diff": 138082, "diff_percentage": 0.6288774827047534, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:23.985376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 8.630752563476562e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.1686046511627907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:41.396673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3529583914338343, "overlap_percentage": 0.5217579397394136, "num_intersection": 82012, "num_union": 232356, "num_only_computed": 75172, "num_only_roped": 75172, "total_diff": 150344, "diff_percentage": 0.6470416085661657, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:41.986060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 8.916854858398438e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.17254901960784313}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:00.419898", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34616727673087744, "overlap_percentage": 0.514300537109375, "num_intersection": 84263, "num_union": 243417, "num_only_computed": 79577, "num_only_roped": 79577, "total_diff": 159154, "diff_percentage": 0.6538327232691226, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:01.067511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.8650970458984375e-05, "l2_diff": 0.5078125, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:20.712552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3238461837552004, "overlap_percentage": 0.489250469924812, "num_intersection": 83290, "num_union": 257190, "num_only_computed": 86950, "num_only_roped": 86950, "total_diff": 173900, "diff_percentage": 0.6761538162447995, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:21.378114", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.14126016260162602}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:42.277473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31738631793741345, "overlap_percentage": 0.48184243849493485, "num_intersection": 85236, "num_union": 268556, "num_only_computed": 91660, "num_only_roped": 91660, "total_diff": 183320, "diff_percentage": 0.6826136820625865, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:42.966403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:57:06.013595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3144209394048046, "overlap_percentage": 0.47841742318435754, "num_intersection": 87692, "num_union": 278900, "num_only_computed": 95604, "num_only_roped": 95604, "total_diff": 191208, "diff_percentage": 0.6855790605951954, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:57:06.763783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.507469177246094e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.14615384615384616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:57:32.359517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2847919971051056, "overlap_percentage": 0.4433277880727763, "num_intersection": 84211, "num_union": 295693, "num_only_computed": 105741, "num_only_roped": 105741, "total_diff": 211482, "diff_percentage": 0.7152080028948944, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:57:33.161980", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 8.0108642578125e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.2216599190283401}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:57:58.025462", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2847676926092923, "overlap_percentage": 0.44329833984375, "num_intersection": 87156, "num_union": 306060, "num_only_computed": 109452, "num_only_roped": 109452, "total_diff": 218904, "diff_percentage": 0.7152323073907078, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:57:58.845961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.63671875, "l2_diff_relative": 0.163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:58:24.960134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2734760448521916, "overlap_percentage": 0.4294953893442623, "num_intersection": 87191, "num_union": 318825, "num_only_computed": 115817, "num_only_roped": 115817, "total_diff": 231634, "diff_percentage": 0.7265239551478083, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:58:25.830661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.2288306451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:58:53.346392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2792151335718927, "overlap_percentage": 0.4365413232600733, "num_intersection": 91527, "num_union": 327801, "num_only_computed": 118137, "num_only_roped": 118137, "total_diff": 236274, "diff_percentage": 0.7207848664281074, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:58:54.276482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 5.936622619628906e-05, "l2_diff": 0.78515625, "l2_diff_relative": 0.19326923076923078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:59:22.974474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27563954964369425, "overlap_percentage": 0.43215898992890994, "num_intersection": 93374, "num_union": 338754, "num_only_computed": 122690, "num_only_roped": 122690, "total_diff": 245380, "diff_percentage": 0.7243604503563058, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:59:23.932142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 1.728534698486328e-05, "l2_diff": 0.267578125, "l2_diff_relative": 0.05253067484662577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:59:53.737629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25358113774645824, "overlap_percentage": 0.40457076149425286, "num_intersection": 90106, "num_union": 355334, "num_only_computed": 132614, "num_only_roped": 132614, "total_diff": 265228, "diff_percentage": 0.7464188622535417, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:59:56.902467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.318359375, "l2_diff_relative": 0.07436131386861314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:00:27.902700", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24598231867132012, "overlap_percentage": 0.39484078543526785, "num_intersection": 90567, "num_union": 368185, "num_only_computed": 138809, "num_only_roped": 138809, "total_diff": 277618, "diff_percentage": 0.7540176813286799, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:00:28.948396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.51953125, "l2_diff_relative": 0.1346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:01:01.676519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24134118508027683, "overlap_percentage": 0.3888394068946797, "num_intersection": 91679, "num_union": 379873, "num_only_computed": 144097, "num_only_roped": 144097, "total_diff": 288194, "diff_percentage": 0.7586588149197232, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:01:02.742971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.15833333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:01:37.887959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23555838695292095, "overlap_percentage": 0.38129867344244983, "num_intersection": 92439, "num_union": 392425, "num_only_computed": 149993, "num_only_roped": 149993, "total_diff": 299986, "diff_percentage": 0.764441613047079, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:01:39.001060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.16304347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:02:14.586461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22623248112593877, "overlap_percentage": 0.36898791152263377, "num_intersection": 91816, "num_union": 405848, "num_only_computed": 157016, "num_only_roped": 157016, "total_diff": 314032, "diff_percentage": 0.7737675188740613, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:02:16.712653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 4.744529724121094e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.20738636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:02:53.236278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22026159243258991, "overlap_percentage": 0.36100717059118237, "num_intersection": 92233, "num_union": 418743, "num_only_computed": 163255, "num_only_roped": 163255, "total_diff": 326510, "diff_percentage": 0.7797384075674101, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:02:54.426069", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.18353174603174602}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:03:34.180835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21862259721544292, "overlap_percentage": 0.35880279541015625, "num_intersection": 94058, "num_union": 430230, "num_only_computed": 168086, "num_only_roped": 168086, "total_diff": 336172, "diff_percentage": 0.7813774027845571, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:03:35.440576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.7578125, "l2_diff_relative": 0.20292887029288703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:04:16.989637", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21389809898994008, "overlap_percentage": 0.35241524666348906, "num_intersection": 94639, "num_union": 442449, "num_only_computed": 173905, "num_only_roped": 173905, "total_diff": 347810, "diff_percentage": 0.78610190101006, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:04:18.288964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.039836883544922e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.14393939393939395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:05:00.697418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21074536511539918, "overlap_percentage": 0.348125, "num_intersection": 95804, "num_union": 454596, "num_only_computed": 179396, "num_only_roped": 179396, "total_diff": 358792, "diff_percentage": 0.7892546348846008, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:05:04.478202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.1689497716894977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:05:46.808606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20945055039448876, "overlap_percentage": 0.3463565340909091, "num_intersection": 97534, "num_union": 465666, "num_only_computed": 184066, "num_only_roped": 184066, "total_diff": 368132, "diff_percentage": 0.7905494496055112, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:05:48.209564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.80078125, "l2_diff_relative": 0.23726851851851852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:06:32.926801", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19717087311706488, "overlap_percentage": 0.32939470470692717, "num_intersection": 94950, "num_union": 481562, "num_only_computed": 193306, "num_only_roped": 193306, "total_diff": 386612, "diff_percentage": 0.8028291268829351, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:06:34.374928", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.36650485436893204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:07:19.476338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1911064439911953, "overlap_percentage": 0.3208889431423611, "num_intersection": 94634, "num_union": 495190, "num_only_computed": 200278, "num_only_roped": 200278, "total_diff": 400556, "diff_percentage": 0.8088935560088047, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:07:22.918244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0966796875, "mean_diff": 6.389617919921875e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.37089201877934275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:08.490710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18654333093120057, "overlap_percentage": 0.3144315526762957, "num_intersection": 94742, "num_union": 507882, "num_only_computed": 206570, "num_only_roped": 206570, "total_diff": 413140, "diff_percentage": 0.8134566690687994, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:09.993237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.4106280193236715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:56.947774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18090191168773403, "overlap_percentage": 0.30637923420615126, "num_intersection": 94355, "num_union": 521581, "num_only_computed": 213613, "num_only_roped": 213613, "total_diff": 427226, "diff_percentage": 0.8190980883122659, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:09:00.793567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.7265625, "l2_diff_relative": 0.6207865168539326}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:09:50.537179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1664774287389333, "overlap_percentage": 0.28543617671009774, "num_intersection": 89732, "num_union": 539004, "num_only_computed": 224636, "num_only_roped": 224636, "total_diff": 449272, "diff_percentage": 0.8335225712610667, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:09:52.187201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 8.726119995117188e-05, "l2_diff": 1.984375, "l2_diff_relative": 0.7134831460674157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:10:43.625912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16416384109082338, "overlap_percentage": 0.2820287579744817, "num_intersection": 90538, "num_union": 551510, "num_only_computed": 230486, "num_only_roped": 230486, "total_diff": 460972, "diff_percentage": 0.8358361589091766, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:10:45.303599", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 7.104873657226562e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.5405405405405406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:11:35.662021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15284279112640353, "overlap_percentage": 0.2651580810546875, "num_intersection": 86887, "num_union": 568473, "num_only_computed": 240793, "num_only_roped": 240793, "total_diff": 481586, "diff_percentage": 0.8471572088735965, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:11:37.265115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.5165876777251185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:12:29.970350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15601415951251416, "overlap_percentage": 0.26991738505747126, "num_intersection": 90174, "num_union": 577986, "num_only_computed": 243906, "num_only_roped": 243906, "total_diff": 487812, "diff_percentage": 0.8439858404874858, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:12:31.712870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.44029850746268656}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:13:26.516131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15761150218791617, "overlap_percentage": 0.2723046581517656, "num_intersection": 92784, "num_union": 588688, "num_only_computed": 247952, "num_only_roped": 247952, "total_diff": 495904, "diff_percentage": 0.8423884978120838, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:13:28.349661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.6775147928994083}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:14:24.777212", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15552729820730427, "overlap_percentage": 0.2691884448746313, "num_intersection": 93445, "num_union": 600827, "num_only_computed": 253691, "num_only_roped": 253691, "total_diff": 507382, "diff_percentage": 0.8444727017926957, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:14:26.616311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.6688311688311688}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:15:24.443000", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15174164984699526, "overlap_percentage": 0.2634994573082489, "num_intersection": 93224, "num_union": 614360, "num_only_computed": 260568, "num_only_roped": 260568, "total_diff": 521136, "diff_percentage": 0.8482583501530048, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:15:28.004000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 8.58306884765625e-05, "l2_diff": 1.8125, "l2_diff_relative": 0.8592592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:16:27.379355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15236236394647534, "overlap_percentage": 0.264434814453125, "num_intersection": 95315, "num_union": 625581, "num_only_computed": 265133, "num_only_roped": 265133, "total_diff": 530266, "diff_percentage": 0.8476376360535246, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:16:29.350351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.249282836914062e-05, "l2_diff": 1.796875, "l2_diff_relative": 0.8914728682170543}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:17:30.792258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1527273927040144, "overlap_percentage": 0.2649844077110956, "num_intersection": 97209, "num_union": 636487, "num_only_computed": 269639, "num_only_roped": 269639, "total_diff": 539278, "diff_percentage": 0.8472726072959856, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:17:34.945798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 8.916854858398438e-05, "l2_diff": 2.09375, "l2_diff_relative": 1.0151515151515151}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:18:38.160092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1491405382288965, "overlap_percentage": 0.2595688399588759, "num_intersection": 96950, "num_union": 650058, "num_only_computed": 276554, "num_only_roped": 276554, "total_diff": 553108, "diff_percentage": 0.8508594617711035, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:18:40.795688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 9.1552734375e-05, "l2_diff": 1.984375, "l2_diff_relative": 1.036734693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:19:47.304304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15067505660177338, "overlap_percentage": 0.26188984585579517, "num_intersection": 99493, "num_union": 660315, "num_only_computed": 280411, "num_only_roped": 280411, "total_diff": 560822, "diff_percentage": 0.8493249433982266, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:19:51.887525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 8.869171142578125e-05, "l2_diff": 1.9765625, "l2_diff_relative": 0.9656488549618321}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:20:58.503772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14642956706387572, "overlap_percentage": 0.25545322847682117, "num_intersection": 98748, "num_union": 674372, "num_only_computed": 287812, "num_only_roped": 287812, "total_diff": 575624, "diff_percentage": 0.8535704329361242, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:21:03.188724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 8.58306884765625e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.9701492537313433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:22:11.407322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14565915696086357, "overlap_percentage": 0.25428009033203125, "num_intersection": 99987, "num_union": 686445, "num_only_computed": 293229, "num_only_roped": 293229, "total_diff": 586458, "diff_percentage": 0.8543408430391364, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:22:13.689905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 8.535385131835938e-05, "l2_diff": 1.8828125, "l2_diff_relative": 1.0432900432900434}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:23:24.459647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14161811317736225, "overlap_percentage": 0.2481006766495836, "num_intersection": 99145, "num_union": 700087, "num_only_computed": 300471, "num_only_roped": 300471, "total_diff": 600942, "diff_percentage": 0.8583818868226377, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:23:26.793556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 8.821487426757812e-05, "l2_diff": 1.84375, "l2_diff_relative": 1.0825688073394495}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:38.433558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14417999476169957, "overlap_percentage": 0.25202327504725897, "num_intersection": 102390, "num_union": 710154, "num_only_computed": 303882, "num_only_roped": 303882, "total_diff": 607764, "diff_percentage": 0.8558200052383004, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:42.942985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 8.630752563476562e-05, "l2_diff": 1.9609375, "l2_diff_relative": 1.0772532188841202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:25:56.091035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14289354195025153, "overlap_percentage": 0.2500557343362283, "num_intersection": 103191, "num_union": 722153, "num_only_computed": 309481, "num_only_roped": 309481, "total_diff": 618962, "diff_percentage": 0.8571064580497485, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:25:58.495996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 7.867813110351562e-05, "l2_diff": 1.8828125, "l2_diff_relative": 0.9060150375939849}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:27:13.097555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14015677808260896, "overlap_percentage": 0.2458552731990232, "num_intersection": 103094, "num_union": 735562, "num_only_computed": 316234, "num_only_roped": 316234, "total_diff": 632468, "diff_percentage": 0.859843221917391, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:27:16.025576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.8918918918918919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:28:33.438608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13483913850219584, "overlap_percentage": 0.23763568584735578, "num_intersection": 101229, "num_union": 750739, "num_only_computed": 324755, "num_only_roped": 324755, "total_diff": 649510, "diff_percentage": 0.8651608614978041, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:28:35.975243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1962890625, "mean_diff": 8.058547973632812e-05, "l2_diff": 2.125, "l2_diff_relative": 1.0225563909774436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:29:53.948558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1332079699652084, "overlap_percentage": 0.23509889357608052, "num_intersection": 101653, "num_union": 763115, "num_only_computed": 330731, "num_only_roped": 330731, "total_diff": 661462, "diff_percentage": 0.8667920300347917, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:29:56.525743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.772445678710938e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.950354609929078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:31:17.437111", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13252275479762837, "overlap_percentage": 0.23403106778425656, "num_intersection": 102749, "num_union": 775331, "num_only_computed": 336291, "num_only_roped": 336291, "total_diff": 672582, "diff_percentage": 0.8674772452023717, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:31:20.067169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 7.104873657226562e-05, "l2_diff": 1.8671875, "l2_diff_relative": 0.8917910447761194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:32:42.266426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13264399293623155, "overlap_percentage": 0.2342200969827586, "num_intersection": 104331, "num_union": 786549, "num_only_computed": 341109, "num_only_roped": 341109, "total_diff": 682218, "diff_percentage": 0.8673560070637685, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:32:44.956957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.2479248046875e-05, "l2_diff": 1.9453125, "l2_diff_relative": 0.9222222222222223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:34:09.193896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13321894931300657, "overlap_percentage": 0.23511599306342015, "num_intersection": 106295, "num_union": 797897, "num_only_computed": 345801, "num_only_roped": 345801, "total_diff": 691602, "diff_percentage": 0.8667810506869934, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:34:14.289584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.8125, "l2_diff_relative": 0.8592592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:35:38.931159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1341239409738961, "overlap_percentage": 0.23652430943080358, "num_intersection": 108506, "num_union": 808998, "num_only_computed": 350246, "num_only_roped": 350246, "total_diff": 700492, "diff_percentage": 0.8658760590261039, "num_computed": 458752, "num_roped": 458752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 256, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:35:41.656303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.82012939453125e-05, "l2_diff": 1.9921875, "l2_diff_relative": 1.1805555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15360, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 256, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:37:04.112612", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1297361478791575, "overlap_percentage": 0.2296751292285546, "num_intersection": 28081, "num_union": 216447, "num_only_computed": 94183, "num_only_roped": 94183, "total_diff": 188366, "diff_percentage": 0.8702638521208426, "num_computed": 122264, "num_roped": 122264}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "mask_shape": [1, 32, 68, 15428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:37:06.641572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.38221153846153844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "attention_shape": [1, 32, 68, 15428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:38:24.019260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12744577582284242, "overlap_percentage": 0.22607876769918944, "num_intersection": 13444, "num_union": 105488, "num_only_computed": 46022, "num_only_roped": 46022, "total_diff": 92044, "diff_percentage": 0.8725542241771576, "num_computed": 59466, "num_roped": 59466}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "mask_shape": [1, 32, 33, 15461], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:38:26.369872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.400390625, "l2_diff_relative": 0.3740875912408759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "attention_shape": [1, 32, 33, 15461]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:39:32.839542", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13368983957219252, "overlap_percentage": 0.2358490566037736, "num_intersection": 425, "num_union": 3179, "num_only_computed": 1377, "num_only_roped": 1377, "total_diff": 2754, "diff_percentage": 0.8663101604278075, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "mask_shape": [1, 32, 1, 15462], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:39:34.706922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.06494140625, "l2_diff_relative": 0.5037878787878788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "attention_shape": [1, 32, 1, 15462]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:40:31.811437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13368983957219252, "overlap_percentage": 0.2358490566037736, "num_intersection": 425, "num_union": 3179, "num_only_computed": 1377, "num_only_roped": 1377, "total_diff": 2754, "diff_percentage": 0.8663101604278075, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "mask_shape": [1, 32, 1, 15463], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:40:33.615088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.3401360544217687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "attention_shape": [1, 32, 1, 15463]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:29.950619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13262099308610936, "overlap_percentage": 0.2341842397336293, "num_intersection": 422, "num_union": 3182, "num_only_computed": 1380, "num_only_roped": 1380, "total_diff": 2760, "diff_percentage": 0.8673790069138906, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15464, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15464, 128], "mask_shape": [1, 32, 1, 15464], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:31.756233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.47651006711409394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15464, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15464, 128], "attention_shape": [1, 32, 1, 15464]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:07.622618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:07.636163", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.0788440704345703e-05, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.002934747409326425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:09.864120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8599343871160156, "overlap_percentage": 0.9246932505500003, "num_intersection": 72084, "num_union": 83825, "num_only_computed": 6508, "num_only_roped": 5233, "total_diff": 11741, "diff_percentage": 0.1400656128839845, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:10.006238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 0.00014400482177734375, "l2_diff": 0.234375, "l2_diff_relative": 0.0528169014084507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:14.968155", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7357704482793832, "overlap_percentage": 0.8477739081325302, "num_intersection": 72054, "num_union": 97930, "num_only_computed": 12938, "num_only_roped": 12938, "total_diff": 25876, "diff_percentage": 0.26422955172061674, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:15.152445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 0.0002593994140625, "l2_diff": 0.462890625, "l2_diff_relative": 0.11993927125506072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:21.454013", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.659944033398839, "overlap_percentage": 0.7951401012569832, "num_intersection": 72873, "num_union": 110423, "num_only_computed": 18775, "num_only_roped": 18775, "total_diff": 37550, "diff_percentage": 0.340055966601161, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:21.671282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.00012683868408203125, "l2_diff": 0.400390625, "l2_diff_relative": 0.08897569444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:28.846917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5983740498353726, "overlap_percentage": 0.7487284342447916, "num_intersection": 73603, "num_union": 123005, "num_only_computed": 24701, "num_only_roped": 24701, "total_diff": 49402, "diff_percentage": 0.40162595016462743, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:29.094776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.234375, "l2_diff_relative": 0.05357142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:37.201778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5414648509385351, "overlap_percentage": 0.7025328545232273, "num_intersection": 73558, "num_union": 135850, "num_only_computed": 31146, "num_only_roped": 31146, "total_diff": 62292, "diff_percentage": 0.45853514906146486, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:37.489777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.00012683868408203125, "l2_diff": 0.4921875, "l2_diff_relative": 0.11666666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:46.774862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4993638205772066, "overlap_percentage": 0.6661009339080459, "num_intersection": 74177, "num_union": 148543, "num_only_computed": 37183, "num_only_roped": 37183, "total_diff": 74366, "diff_percentage": 0.5006361794227934, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:47.090405", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.0001125335693359375, "l2_diff": 0.478515625, "l2_diff_relative": 0.12921940928270043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:57.542612", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46687510510155145, "overlap_percentage": 0.6365574048913043, "num_intersection": 74961, "num_union": 160559, "num_only_computed": 42799, "num_only_roped": 42799, "total_diff": 85598, "diff_percentage": 0.5331248948984485, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:00.468040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 8.344650268554688e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.11016187050359712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:11.894876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44676496581236336, "overlap_percentage": 0.6176054526748971, "num_intersection": 76840, "num_union": 171992, "num_only_computed": 47576, "num_only_roped": 47576, "total_diff": 95152, "diff_percentage": 0.5532350341876366, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:14.412627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 0.0001125335693359375, "l2_diff": 0.60546875, "l2_diff_relative": 0.1655982905982906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:27.005193", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41948829023961015, "overlap_percentage": 0.5910415649414062, "num_intersection": 77469, "num_union": 184675, "num_only_computed": 53603, "num_only_roped": 53603, "total_diff": 107206, "diff_percentage": 0.5805117097603899, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:28.319388", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 9.489059448242188e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.14826839826839827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:41.953267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4068957047680452, "overlap_percentage": 0.5784305167597765, "num_intersection": 79518, "num_union": 195426, "num_only_computed": 57954, "num_only_roped": 57954, "total_diff": 115908, "diff_percentage": 0.5931042952319548, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:42.416520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.1361111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:57.233170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37136767588346115, "overlap_percentage": 0.5416019094138543, "num_intersection": 78060, "num_union": 210196, "num_only_computed": 66068, "num_only_roped": 66068, "total_diff": 132136, "diff_percentage": 0.6286323241165388, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:57.744307", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07958984375, "mean_diff": 0.00012874603271484375, "l2_diff": 0.8671875, "l2_diff_relative": 0.25934579439252337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:13.751170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3677152047102437, "overlap_percentage": 0.5377072704081632, "num_intersection": 80940, "num_union": 220116, "num_only_computed": 69588, "num_only_roped": 69588, "total_diff": 139176, "diff_percentage": 0.6322847952897563, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:14.301144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.12588652482269502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:31.920337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34590322553023883, "overlap_percentage": 0.5140090594462541, "num_intersection": 80794, "num_union": 233574, "num_only_computed": 76390, "num_only_roped": 76390, "total_diff": 152780, "diff_percentage": 0.6540967744697612, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:32.525986", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.4375, "l2_diff_relative": 0.0979020979020979}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:51.116041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33288318154269186, "overlap_percentage": 0.499493408203125, "num_intersection": 81837, "num_union": 245843, "num_only_computed": 82003, "num_only_roped": 82003, "total_diff": 164006, "diff_percentage": 0.6671168184573081, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:51.724250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.10675182481751824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:11.487477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3255882765172161, "overlap_percentage": 0.4912359022556391, "num_intersection": 83628, "num_union": 256852, "num_only_computed": 86612, "num_only_roped": 86612, "total_diff": 173224, "diff_percentage": 0.6744117234827839, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:12.158274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 7.343292236328125e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.1781115879828326}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:33.124608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30419652599604824, "overlap_percentage": 0.4664887843704776, "num_intersection": 82520, "num_union": 271272, "num_only_computed": 94376, "num_only_roped": 94376, "total_diff": 188752, "diff_percentage": 0.6958034740039517, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:33.807181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 7.200241088867188e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.18354430379746836}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:56.541623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3040409789413773, "overlap_percentage": 0.4663058659217877, "num_intersection": 85472, "num_union": 281120, "num_only_computed": 97824, "num_only_roped": 97824, "total_diff": 195648, "diff_percentage": 0.6959590210586226, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:57.292480", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.40625, "l2_diff_relative": 0.08843537414965986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:46:22.519555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.297100929710093, "overlap_percentage": 0.4580999410377358, "num_intersection": 87017, "num_union": 292887, "num_only_computed": 102935, "num_only_roped": 102935, "total_diff": 205870, "diff_percentage": 0.7028990702899071, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:46:23.293027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.07934397163120567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:46:47.602088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29380990454756334, "overlap_percentage": 0.4541778564453125, "num_intersection": 89295, "num_union": 303921, "num_only_computed": 107313, "num_only_roped": 107313, "total_diff": 214626, "diff_percentage": 0.7061900954524366, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:46:48.414071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.37109375, "l2_diff_relative": 0.0796979865771812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:47:14.272434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2843567713935038, "overlap_percentage": 0.4428002837326608, "num_intersection": 89892, "num_union": 316124, "num_only_computed": 113116, "num_only_roped": 113116, "total_diff": 226232, "diff_percentage": 0.7156432286064962, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:47:15.148829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 3.0517578125e-05, "l2_diff": 0.373046875, "l2_diff_relative": 0.09043560606060606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:47:42.163790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28170972878962475, "overlap_percentage": 0.4395842872405372, "num_intersection": 92165, "num_union": 327163, "num_only_computed": 117499, "num_only_roped": 117499, "total_diff": 234998, "diff_percentage": 0.7182902712103753, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:47:43.067177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.50390625, "l2_diff_relative": 0.13109756097560976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:48:11.423185", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26775802382209707, "overlap_percentage": 0.4224118779620853, "num_intersection": 91268, "num_union": 340860, "num_only_computed": 124796, "num_only_roped": 124796, "total_diff": 249592, "diff_percentage": 0.732241976177903, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:48:12.389439", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.8203125, "l2_diff_relative": 0.234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:48:42.105851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2569309822312895, "overlap_percentage": 0.4088227370689655, "num_intersection": 91053, "num_union": 354387, "num_only_computed": 131667, "num_only_roped": 131667, "total_diff": 263334, "diff_percentage": 0.7430690177687105, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:48:43.103094", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.18666666666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:49:14.054097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2511406807811993, "overlap_percentage": 0.401458740234375, "num_intersection": 92085, "num_union": 366667, "num_only_computed": 137291, "num_only_roped": 137291, "total_diff": 274582, "diff_percentage": 0.7488593192188007, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:49:15.474297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.22706422018348624}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:49:47.597488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24527165847140284, "overlap_percentage": 0.3939247421281216, "num_intersection": 92878, "num_union": 378674, "num_only_computed": 142898, "num_only_roped": 142898, "total_diff": 285796, "diff_percentage": 0.7547283415285971, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:49:48.676301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.63671875, "l2_diff_relative": 0.15319548872180452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:50:22.626111", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2430211065221794, "overlap_percentage": 0.3910168624604013, "num_intersection": 94795, "num_union": 390069, "num_only_computed": 147637, "num_only_roped": 147637, "total_diff": 295274, "diff_percentage": 0.7569788934778205, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:50:25.459878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.44921875, "l2_diff_relative": 0.0921474358974359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:51:00.847086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24005232666791254, "overlap_percentage": 0.3871648341049383, "num_intersection": 96339, "num_union": 401325, "num_only_computed": 152493, "num_only_roped": 152493, "total_diff": 304986, "diff_percentage": 0.7599476733320875, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:51:02.088683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 1.537799835205078e-05, "l2_diff": 0.369140625, "l2_diff_relative": 0.073828125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:51:40.494929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2360956894278616, "overlap_percentage": 0.3820022858216433, "num_intersection": 97597, "num_union": 413379, "num_only_computed": 157891, "num_only_roped": 157891, "total_diff": 315782, "diff_percentage": 0.7639043105721384, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:51:41.756858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 1.6927719116210938e-05, "l2_diff": 0.345703125, "l2_diff_relative": 0.07629310344827586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:52:21.380688", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22975594309639133, "overlap_percentage": 0.3736610412597656, "num_intersection": 97953, "num_union": 426335, "num_only_computed": 164191, "num_only_roped": 164191, "total_diff": 328382, "diff_percentage": 0.7702440569036086, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:52:22.689327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.7642974853515625e-05, "l2_diff": 0.341796875, "l2_diff_relative": 0.07543103448275862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:53:03.852700", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2236413427320323, "overlap_percentage": 0.365534139656816, "num_intersection": 98162, "num_union": 438926, "num_only_computed": 170382, "num_only_roped": 170382, "total_diff": 340764, "diff_percentage": 0.7763586572679677, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:53:05.241334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.51953125, "l2_diff_relative": 0.12788461538461537}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:53:47.798273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22210898174607932, "overlap_percentage": 0.363484738372093, "num_intersection": 100031, "num_union": 450369, "num_only_computed": 175169, "num_only_roped": 175169, "total_diff": 350338, "diff_percentage": 0.7778910182539207, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:53:49.131725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.1645021645021645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:54:32.831982", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21195427627048616, "overlap_percentage": 0.3497727272727273, "num_intersection": 98496, "num_union": 464704, "num_only_computed": 183104, "num_only_roped": 183104, "total_diff": 366208, "diff_percentage": 0.7880457237295139, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:54:34.866410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.875, "l2_diff_relative": 0.22134387351778656}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:55:18.377659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20396119002769159, "overlap_percentage": 0.338816884991119, "num_intersection": 97666, "num_union": 478846, "num_only_computed": 190590, "num_only_roped": 190590, "total_diff": 381180, "diff_percentage": 0.7960388099723085, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:55:19.809823", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.2672811059907834}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:56:05.234893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1968588299750411, "overlap_percentage": 0.3289591471354167, "num_intersection": 97014, "num_union": 492810, "num_only_computed": 197898, "num_only_roped": 197898, "total_diff": 395796, "diff_percentage": 0.8031411700249589, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:56:06.751515", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 5.7697296142578125e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.34523809523809523}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:56:55.121192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18601557149267478, "overlap_percentage": 0.31368149957519115, "num_intersection": 94516, "num_union": 508108, "num_only_computed": 206796, "num_only_roped": 206796, "total_diff": 413592, "diff_percentage": 0.8139844285073252, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:56:56.654485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10888671875, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.3225806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:57:44.075118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1781619528915787, "overlap_percentage": 0.30244051330008315, "num_intersection": 93142, "num_union": 522794, "num_only_computed": 214826, "num_only_roped": 214826, "total_diff": 429652, "diff_percentage": 0.8218380471084213, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:57:48.168833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 8.296966552734375e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.7255639097744361}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:58:38.014832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17002655530929398, "overlap_percentage": 0.2906370877442997, "num_intersection": 91367, "num_union": 537369, "num_only_computed": 223001, "num_only_roped": 223001, "total_diff": 446002, "diff_percentage": 0.829973444690706, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:58:39.632789", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.738255033557047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:59:32.815418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16297874190323, "overlap_percentage": 0.28027811004784686, "num_intersection": 89976, "num_union": 552072, "num_only_computed": 231048, "num_only_roped": 231048, "total_diff": 462096, "diff_percentage": 0.83702125809677, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:59:34.538308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 8.058547973632812e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.6677631578947368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:00:26.374324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16001748805661317, "overlap_percentage": 0.2758880615234375, "num_intersection": 90403, "num_union": 564957, "num_only_computed": 237277, "num_only_roped": 237277, "total_diff": 474554, "diff_percentage": 0.8399825119433868, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:00:28.032520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 8.20159912109375e-05, "l2_diff": 2.0, "l2_diff_relative": 0.649746192893401}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:01:20.328520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1595591259573183, "overlap_percentage": 0.27520653735632183, "num_intersection": 91941, "num_union": 576219, "num_only_computed": 242139, "num_only_roped": 242139, "total_diff": 484278, "diff_percentage": 0.8404408740426816, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:01:22.077895", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 9.298324584960938e-05, "l2_diff": 1.8359375, "l2_diff_relative": 0.8103448275862069}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:02:15.904839", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15996221244436123, "overlap_percentage": 0.27580590251690457, "num_intersection": 93977, "num_union": 587495, "num_only_computed": 246759, "num_only_roped": 246759, "total_diff": 493518, "diff_percentage": 0.8400377875556387, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:02:17.715111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 9.250640869140625e-05, "l2_diff": 1.8046875, "l2_diff_relative": 0.8884615384615384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:03:12.994015", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15500825989815287, "overlap_percentage": 0.26841065173303835, "num_intersection": 93175, "num_union": 601097, "num_only_computed": 253961, "num_only_roped": 253961, "total_diff": 507922, "diff_percentage": 0.8449917401018471, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:03:14.997308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 8.630752563476562e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.8028169014084507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:04:04.551654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14386063500983423, "overlap_percentage": 0.2515352493244903, "num_intersection": 2048, "num_union": 14236, "num_only_computed": 6094, "num_only_roped": 6094, "total_diff": 12188, "diff_percentage": 0.8561393649901657, "num_computed": 8142, "num_roped": 8142}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 6, "seq_len_k": 11014, "queries_shape": [1, 32, 6, 128], "keys_shape": [1, 8, 11014, 128], "mask_shape": [1, 32, 6, 11014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:04:05.875294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.087890625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 6, "seq_len_k": 11014, "queries_shape": [1, 32, 6, 128], "keys_shape": [1, 8, 11014, 128], "attention_shape": [1, 32, 6, 11014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:04:51.741866", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1593405837950805, "overlap_percentage": 0.2748814041745731, "num_intersection": 11589, "num_union": 72731, "num_only_computed": 30571, "num_only_roped": 30571, "total_diff": 61142, "diff_percentage": 0.8406594162049195, "num_computed": 42160, "num_roped": 42160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "mask_shape": [1, 32, 31, 11045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:04:53.348082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.408203125, "l2_diff_relative": 0.39285714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "attention_shape": [1, 32, 31, 11045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:37.309467", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16888697894284485, "overlap_percentage": 0.2889705882352941, "num_intersection": 393, "num_union": 2327, "num_only_computed": 967, "num_only_roped": 967, "total_diff": 1934, "diff_percentage": 0.8311130210571551, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "mask_shape": [1, 32, 1, 11046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:39.844862", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.07421875, "l2_diff_relative": 0.6386554621848739}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "attention_shape": [1, 32, 1, 11046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:18.460504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15793954874414645, "overlap_percentage": 0.2727941176470588, "num_intersection": 371, "num_union": 2349, "num_only_computed": 989, "num_only_roped": 989, "total_diff": 1978, "diff_percentage": 0.8420604512558536, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "mask_shape": [1, 32, 1, 11047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:20.636030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04833984375, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.0830078125, "l2_diff_relative": 0.5944055944055944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "attention_shape": [1, 32, 1, 11047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:59.825405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1574468085106383, "overlap_percentage": 0.27205882352941174, "num_intersection": 370, "num_union": 2350, "num_only_computed": 990, "num_only_roped": 990, "total_diff": 1980, "diff_percentage": 0.8425531914893617, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "mask_shape": [1, 32, 1, 11048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:01.066152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.2608108108108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "attention_shape": [1, 32, 1, 11048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:27.073640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:27.087091", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.0166015625, "l2_diff_relative": 0.0029030054644808745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:29.832340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8617778414654534, "overlap_percentage": 0.9257579742029004, "num_intersection": 72167, "num_union": 83742, "num_only_computed": 6425, "num_only_roped": 5150, "total_diff": 11575, "diff_percentage": 0.13822215853454659, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:31.697275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 9.870529174804688e-05, "l2_diff": 0.1650390625, "l2_diff_relative": 0.03799460431654676}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:36.410631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7377223471682682, "overlap_percentage": 0.8490681475903614, "num_intersection": 72164, "num_union": 97820, "num_only_computed": 12828, "num_only_roped": 12828, "total_diff": 25656, "diff_percentage": 0.26227765283173177, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:36.584415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.18359375, "l2_diff_relative": 0.037183544303797465}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:42.359959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6711584398533944, "overlap_percentage": 0.8032253840782123, "num_intersection": 73614, "num_union": 109682, "num_only_computed": 18034, "num_only_roped": 18034, "total_diff": 36068, "diff_percentage": 0.32884156014660565, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:42.568426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 0.00012302398681640625, "l2_diff": 0.34765625, "l2_diff_relative": 0.07725694444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:52.021579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6048584582231364, "overlap_percentage": 0.7537841796875, "num_intersection": 74100, "num_union": 122508, "num_only_computed": 24204, "num_only_roped": 24204, "total_diff": 48408, "diff_percentage": 0.39514154177686356, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:52.261942", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04443359375, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.32421875, "l2_diff_relative": 0.06693548387096775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:00.107378", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5608010911774132, "overlap_percentage": 0.718606738997555, "num_intersection": 75241, "num_union": 134167, "num_only_computed": 29463, "num_only_roped": 29463, "total_diff": 58926, "diff_percentage": 0.4391989088225868, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:00.373803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 9.822845458984375e-05, "l2_diff": 0.41796875, "l2_diff_relative": 0.08916666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:09.266031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5181072735823978, "overlap_percentage": 0.6825700431034483, "num_intersection": 76011, "num_union": 146709, "num_only_computed": 35349, "num_only_roped": 35349, "total_diff": 70698, "diff_percentage": 0.48189272641760217, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:09.576914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.3671875, "l2_diff_relative": 0.07436708860759493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:19.502637", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47890463601941563, "overlap_percentage": 0.6476477581521739, "num_intersection": 76267, "num_union": 159253, "num_only_computed": 41493, "num_only_roped": 41493, "total_diff": 82986, "diff_percentage": 0.5210953639805843, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:19.839650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 9.822845458984375e-05, "l2_diff": 0.5078125, "l2_diff_relative": 0.12596899224806202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:31.439904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45177890057060177, "overlap_percentage": 0.6223797582304527, "num_intersection": 77434, "num_union": 171398, "num_only_computed": 46982, "num_only_roped": 46982, "total_diff": 93964, "diff_percentage": 0.5482210994293982, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:31.816461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 0.0001392364501953125, "l2_diff": 0.74609375, "l2_diff_relative": 0.19895833333333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:43.932077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4301051804652381, "overlap_percentage": 0.60150146484375, "num_intersection": 78840, "num_union": 183304, "num_only_computed": 52232, "num_only_roped": 52232, "total_diff": 104464, "diff_percentage": 0.569894819534762, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:44.343117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 0.00010728836059570312, "l2_diff": 0.6484375, "l2_diff_relative": 0.166}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:57.598492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40768084703328433, "overlap_percentage": 0.5792234054934823, "num_intersection": 79627, "num_union": 195317, "num_only_computed": 57845, "num_only_roped": 57845, "total_diff": 115690, "diff_percentage": 0.5923191529667157, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:58.055177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 9.059906005859375e-05, "l2_diff": 0.6171875, "l2_diff_relative": 0.1420863309352518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:12.289224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3814494253865102, "overlap_percentage": 0.5522452264653641, "num_intersection": 79594, "num_union": 208662, "num_only_computed": 64534, "num_only_roped": 64534, "total_diff": 129068, "diff_percentage": 0.6185505746134897, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:12.773597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06884765625, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.466796875, "l2_diff_relative": 0.100251677852349}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:28.620892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36603338672426233, "overlap_percentage": 0.5359069409013606, "num_intersection": 80669, "num_union": 220387, "num_only_computed": 69859, "num_only_roped": 69859, "total_diff": 139718, "diff_percentage": 0.6339666132757377, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:29.142338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 6.628036499023438e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.1284246575342466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:45.564835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35183552713621646, "overlap_percentage": 0.5205300793973942, "num_intersection": 81819, "num_union": 232549, "num_only_computed": 75365, "num_only_roped": 75365, "total_diff": 150730, "diff_percentage": 0.6481644728637835, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:46.137051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.62109375, "l2_diff_relative": 0.14095744680851063}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:03.752614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3371364680630537, "overlap_percentage": 0.504266357421875, "num_intersection": 82619, "num_union": 245061, "num_only_computed": 81221, "num_only_roped": 81221, "total_diff": 162442, "diff_percentage": 0.6628635319369464, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:04.776088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 5.817413330078125e-05, "l2_diff": 0.5078125, "l2_diff_relative": 0.11443661971830986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:23.690138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3116724517195283, "overlap_percentage": 0.47522908834586464, "num_intersection": 80903, "num_union": 259577, "num_only_computed": 89337, "num_only_roped": 89337, "total_diff": 178674, "diff_percentage": 0.6883275482804717, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:24.438485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 6.914138793945312e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.15344827586206897}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:45.254710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29808108603925887, "overlap_percentage": 0.4592642004341534, "num_intersection": 81242, "num_union": 272550, "num_only_computed": 95654, "num_only_roped": 95654, "total_diff": 191308, "diff_percentage": 0.7019189139607411, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:46.169713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.698204040527344e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.1309931506849315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:08.433964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30046968342485775, "overlap_percentage": 0.46209409916201116, "num_intersection": 84700, "num_union": 281892, "num_only_computed": 98596, "num_only_roped": 98596, "total_diff": 197192, "diff_percentage": 0.6995303165751423, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:09.168808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.51953125, "l2_diff_relative": 0.109375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:32.250611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28671101296519585, "overlap_percentage": 0.4456494272237197, "num_intersection": 84652, "num_union": 295252, "num_only_computed": 105300, "num_only_roped": 105300, "total_diff": 210600, "diff_percentage": 0.7132889870348041, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:33.019771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06396484375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.63671875, "l2_diff_relative": 0.13493377483443708}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:57.515586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2858768590825256, "overlap_percentage": 0.44464111328125, "num_intersection": 87420, "num_union": 305796, "num_only_computed": 109188, "num_only_roped": 109188, "total_diff": 218376, "diff_percentage": 0.7141231409174744, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:58.347093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.59375, "l2_diff_relative": 0.1292517006802721}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:12:24.011508", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29142824426752506, "overlap_percentage": 0.4513270412988651, "num_intersection": 91623, "num_union": 314393, "num_only_computed": 111385, "num_only_roped": 111385, "total_diff": 222770, "diff_percentage": 0.708571755732475, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:12:24.864127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.1588345864661654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:12:51.658396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2782168952346696, "overlap_percentage": 0.43532032203907206, "num_intersection": 91271, "num_union": 328057, "num_only_computed": 118393, "num_only_roped": 118393, "total_diff": 236786, "diff_percentage": 0.7217831047653304, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:12:52.571484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.17100694444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:13:20.802071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26988157160069354, "overlap_percentage": 0.4250499851895735, "num_intersection": 91838, "num_union": 340290, "num_only_computed": 124226, "num_only_roped": 124226, "total_diff": 248452, "diff_percentage": 0.7301184283993065, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:13:21.750541", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 5.4836273193359375e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.19455645161290322}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:13:51.393690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25925486171773626, "overlap_percentage": 0.4117591594827586, "num_intersection": 91707, "num_union": 353733, "num_only_computed": 131013, "num_only_roped": 131013, "total_diff": 262026, "diff_percentage": 0.7407451382822637, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:13:52.403776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.1602112676056338}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:14:23.369436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2584338704456551, "overlap_percentage": 0.41072300502232145, "num_intersection": 94210, "num_union": 364542, "num_only_computed": 135166, "num_only_roped": 135166, "total_diff": 270332, "diff_percentage": 0.7415661295543449, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:14:24.394170", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.1159090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:14:58.297947", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2587408107372231, "overlap_percentage": 0.41111054560260585, "num_intersection": 96930, "num_union": 374622, "num_only_computed": 138846, "num_only_roped": 138846, "total_diff": 277692, "diff_percentage": 0.7412591892627769, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:14:59.380562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.380859375, "l2_diff_relative": 0.08347602739726027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:15:32.888693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24832715860261423, "overlap_percentage": 0.39785589361140444, "num_intersection": 96453, "num_union": 388411, "num_only_computed": 145979, "num_only_roped": 145979, "total_diff": 291958, "diff_percentage": 0.7516728413973858, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:15:36.473064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.14479166666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:16:11.508396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2388237666252617, "overlap_percentage": 0.38556536136831276, "num_intersection": 95941, "num_union": 401723, "num_only_computed": 152891, "num_only_roped": 152891, "total_diff": 305782, "diff_percentage": 0.7611762333747383, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:16:12.685495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.18846153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:16:49.435791", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22810399236665072, "overlap_percentage": 0.3714734155811623, "num_intersection": 94907, "num_union": 416069, "num_only_computed": 160581, "num_only_roped": 160581, "total_diff": 321162, "diff_percentage": 0.7718960076333493, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:16:50.652153", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07080078125, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.20416666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:17:28.254093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22828373699179563, "overlap_percentage": 0.37171173095703125, "num_intersection": 97442, "num_union": 426846, "num_only_computed": 164702, "num_only_roped": 164702, "total_diff": 329404, "diff_percentage": 0.7717162630082044, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:17:29.472503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.24311926605504589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:18:08.361903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21687669643787696, "overlap_percentage": 0.35644810533841753, "num_intersection": 95722, "num_union": 441366, "num_only_computed": 172822, "num_only_roped": 172822, "total_diff": 345644, "diff_percentage": 0.783123303562123, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:18:10.334126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.875, "l2_diff_relative": 0.18791946308724833}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:18:50.648998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22126564302831278, "overlap_percentage": 0.3623546511627907, "num_intersection": 99720, "num_union": 450680, "num_only_computed": 175480, "num_only_roped": 175480, "total_diff": 350960, "diff_percentage": 0.7787343569716872, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:18:52.377894", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:19:33.805088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20795120151680235, "overlap_percentage": 0.34430397727272727, "num_intersection": 96956, "num_union": 466244, "num_only_computed": 184644, "num_only_roped": 184644, "total_diff": 369288, "diff_percentage": 0.7920487984831976, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:19:35.219543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.1650390625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:18.178177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2004089426002003, "overlap_percentage": 0.3339011156749556, "num_intersection": 96249, "num_union": 480263, "num_only_computed": 192007, "num_only_roped": 192007, "total_diff": 384014, "diff_percentage": 0.7995910573997997, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:19.580089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 5.7697296142578125e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.3558139534883721}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:04.057306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19107036479841683, "overlap_percentage": 0.3208380805121528, "num_intersection": 94619, "num_union": 495205, "num_only_computed": 200293, "num_only_roped": 200293, "total_diff": 400586, "diff_percentage": 0.8089296352015832, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:05.539706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.4765625, "l2_diff_relative": 0.44366197183098594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:52.164054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18453521719217758, "overlap_percentage": 0.3115740494902294, "num_intersection": 93881, "num_union": 508743, "num_only_computed": 207431, "num_only_roped": 207431, "total_diff": 414862, "diff_percentage": 0.8154647828078224, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:53.678198", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 8.726119995117188e-05, "l2_diff": 1.9296875, "l2_diff_relative": 0.6675675675675675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:22:41.401986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17667196478787137, "overlap_percentage": 0.30029093931837075, "num_intersection": 92480, "num_union": 523456, "num_only_computed": 215488, "num_only_roped": 215488, "total_diff": 430976, "diff_percentage": 0.8233280352121286, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:22:42.957656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.875, "l2_diff_relative": 0.6382978723404256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:23:32.777770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1691671439516219, "overlap_percentage": 0.28938059853420195, "num_intersection": 90972, "num_union": 537764, "num_only_computed": 223396, "num_only_roped": 223396, "total_diff": 446792, "diff_percentage": 0.8308328560483781, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:23:34.424120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 7.724761962890625e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.6078431372549019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:24:23.951959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16433484637188106, "overlap_percentage": 0.2822810755582137, "num_intersection": 90619, "num_union": 551429, "num_only_computed": 230405, "num_only_roped": 230405, "total_diff": 460810, "diff_percentage": 0.835665153628119, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:24:25.592658", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 9.5367431640625e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.8589743589743589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:25:16.171912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15614971941282216, "overlap_percentage": 0.2701202392578125, "num_intersection": 88513, "num_union": 566847, "num_only_computed": 239167, "num_only_roped": 239167, "total_diff": 478334, "diff_percentage": 0.8438502805871778, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:25:18.669893", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 0.000102996826171875, "l2_diff": 2.015625, "l2_diff_relative": 1.011764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:26:11.736541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.153961734949414, "overlap_percentage": 0.2668402777777778, "num_intersection": 89146, "num_union": 579014, "num_only_computed": 244934, "num_only_roped": 244934, "total_diff": 489868, "diff_percentage": 0.846038265050586, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:26:15.650105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 9.870529174804688e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.9758064516129032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:27:09.432939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15997011018041127, "overlap_percentage": 0.27581764181066865, "num_intersection": 93981, "num_union": 587491, "num_only_computed": 246755, "num_only_roped": 246755, "total_diff": 493510, "diff_percentage": 0.8400298898195887, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:27:12.965692", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 9.107589721679688e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.8069620253164557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:07.898944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1560237041871958, "overlap_percentage": 0.2699316694321534, "num_intersection": 93703, "num_union": 600569, "num_only_computed": 253433, "num_only_roped": 253433, "total_diff": 506866, "diff_percentage": 0.8439762958128042, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:09.694023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 8.7738037109375e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.832258064516129}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:29:05.491921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15692593446445186, "overlap_percentage": 0.27128086559334297, "num_intersection": 95977, "num_union": 611607, "num_only_computed": 257815, "num_only_roped": 257815, "total_diff": 515630, "diff_percentage": 0.8430740655355482, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:29:07.322674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 8.153915405273438e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.7045454545454546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:30:05.230224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1582035454817119, "overlap_percentage": 0.2731878107244318, "num_intersection": 98470, "num_union": 622426, "num_only_computed": 261978, "num_only_roped": 261978, "total_diff": 523956, "diff_percentage": 0.8417964545182881, "num_computed": 360448, "num_roped": 360448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "mask_shape": [1, 32, 256, 11520], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:30:07.120005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.9609375, "l2_diff_relative": 0.7382352941176471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11520, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11520, 128], "attention_shape": [1, 32, 256, 11520]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:31:08.698601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15390398183185025, "overlap_percentage": 0.2667535327983252, "num_intersection": 97858, "num_union": 635838, "num_only_computed": 268990, "num_only_roped": 268990, "total_diff": 537980, "diff_percentage": 0.8460960181681497, "num_computed": 366848, "num_roped": 366848}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "mask_shape": [1, 32, 256, 11776], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:31:10.675996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 8.296966552734375e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.7663043478260869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11776, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11776, 128], "attention_shape": [1, 32, 256, 11776]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:32:11.445532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15347544451564588, "overlap_percentage": 0.26610959989718985, "num_intersection": 99393, "num_union": 647615, "num_only_computed": 274111, "num_only_roped": 274111, "total_diff": 548222, "diff_percentage": 0.8465245554843541, "num_computed": 373504, "num_roped": 373504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "mask_shape": [1, 32, 256, 12032], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:32:13.422058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 8.678436279296875e-05, "l2_diff": 2.671875, "l2_diff_relative": 1.0}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12032, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12032, 128], "attention_shape": [1, 32, 256, 12032]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:33:15.374115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15115796363239692, "overlap_percentage": 0.26261897742587603, "num_intersection": 99770, "num_union": 660038, "num_only_computed": 280134, "num_only_roped": 280134, "total_diff": 560268, "diff_percentage": 0.848842036367603, "num_computed": 379904, "num_roped": 379904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 256, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:33:17.413503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 9.34600830078125e-05, "l2_diff": 2.75, "l2_diff_relative": 1.1891891891891893}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12288, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 256, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:34:19.901683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15027249638828838, "overlap_percentage": 0.2612815604304636, "num_intersection": 101001, "num_union": 672119, "num_only_computed": 285559, "num_only_roped": 285559, "total_diff": 571118, "diff_percentage": 0.8497275036117116, "num_computed": 386560, "num_roped": 386560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "mask_shape": [1, 32, 256, 12544], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:34:23.239718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.208984375, "mean_diff": 9.441375732421875e-05, "l2_diff": 2.3125, "l2_diff_relative": 1.2333333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12544, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12544, 128], "attention_shape": [1, 32, 256, 12544]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:35:28.552430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1508059264678983, "overlap_percentage": 0.26208750406901044, "num_intersection": 103057, "num_union": 683375, "num_only_computed": 290159, "num_only_roped": 290159, "total_diff": 580318, "diff_percentage": 0.8491940735321017, "num_computed": 393216, "num_roped": 393216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "mask_shape": [1, 32, 256, 12800], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:35:33.290586", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 9.298324584960938e-05, "l2_diff": 2.75, "l2_diff_relative": 1.2753623188405796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 12800, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 12800, 128], "attention_shape": [1, 32, 256, 12800]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:36:41.020973", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14868658007786956, "overlap_percentage": 0.25888102578475336, "num_intersection": 103453, "num_union": 695779, "num_only_computed": 296163, "num_only_roped": 296163, "total_diff": 592326, "diff_percentage": 0.8513134199221305, "num_computed": 399616, "num_roped": 399616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "mask_shape": [1, 32, 256, 13056], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:36:43.258600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 6.532669067382812e-05, "l2_diff": 1.8671875, "l2_diff_relative": 0.6065989847715736}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13056, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13056, 128], "attention_shape": [1, 32, 256, 13056]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:37:52.317705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14825460619472777, "overlap_percentage": 0.25822601606805295, "num_intersection": 104910, "num_union": 707634, "num_only_computed": 301362, "num_only_roped": 301362, "total_diff": 602724, "diff_percentage": 0.8517453938052723, "num_computed": 406272, "num_roped": 406272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 256, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:37:54.628747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.71875, "l2_diff_relative": 0.650887573964497}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13312, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 256, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:39:05.609060", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14223397041117122, "overlap_percentage": 0.24904524658808933, "num_intersection": 102774, "num_union": 722570, "num_only_computed": 309898, "num_only_roped": 309898, "total_diff": 619796, "diff_percentage": 0.8577660295888287, "num_computed": 412672, "num_roped": 412672}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "mask_shape": [1, 32, 256, 13568], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:39:07.969967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.581710815429688e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.8496732026143791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13568, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13568, 128], "attention_shape": [1, 32, 256, 13568]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:40:21.692835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14123197467848012, "overlap_percentage": 0.24750791742979242, "num_intersection": 103787, "num_union": 734869, "num_only_computed": 315541, "num_only_roped": 315541, "total_diff": 631082, "diff_percentage": 0.8587680253215199, "num_computed": 419328, "num_roped": 419328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "mask_shape": [1, 32, 256, 13824], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:40:25.136509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 8.296966552734375e-05, "l2_diff": 2.328125, "l2_diff_relative": 1.0642857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 13824, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 13824, 128], "attention_shape": [1, 32, 256, 13824]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:41:38.455830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1399273202138648, "overlap_percentage": 0.24550217848557693, "num_intersection": 104580, "num_union": 747388, "num_only_computed": 321404, "num_only_roped": 321404, "total_diff": 642808, "diff_percentage": 0.8600726797861352, "num_computed": 425984, "num_roped": 425984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "mask_shape": [1, 32, 256, 14080], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:41:40.895239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 7.82012939453125e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.9490196078431372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14080, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14080, 128], "attention_shape": [1, 32, 256, 14080]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:42:57.166704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1382315428688761, "overlap_percentage": 0.2428882659857904, "num_intersection": 105021, "num_union": 759747, "num_only_computed": 327363, "num_only_roped": 327363, "total_diff": 654726, "diff_percentage": 0.8617684571311239, "num_computed": 432384, "num_roped": 432384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 256, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:42:59.662321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.25, "l2_diff_relative": 0.9113924050632911}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14336, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 256, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:44:15.492427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13458169019180177, "overlap_percentage": 0.23723578717201166, "num_intersection": 104156, "num_union": 773924, "num_only_computed": 334884, "num_only_roped": 334884, "total_diff": 669768, "diff_percentage": 0.8654183098081982, "num_computed": 439040, "num_roped": 439040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "mask_shape": [1, 32, 256, 14592], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:44:19.158217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 7.343292236328125e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.8897058823529411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14592, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14592, 128], "attention_shape": [1, 32, 256, 14592]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:45:37.851641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13433710011141176, "overlap_percentage": 0.23685569324712644, "num_intersection": 105505, "num_union": 785375, "num_only_computed": 339935, "num_only_roped": 339935, "total_diff": 679870, "diff_percentage": 0.8656628998885882, "num_computed": 445440, "num_roped": 445440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "mask_shape": [1, 32, 256, 14848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:45:42.385774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.7697296142578125e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.6379310344827587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 14848, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 14848, 128], "attention_shape": [1, 32, 256, 14848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:47:03.106673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13793385527900517, "overlap_percentage": 0.2424285992355606, "num_intersection": 109601, "num_union": 794591, "num_only_computed": 342495, "num_only_roped": 342495, "total_diff": 684990, "diff_percentage": 0.8620661447209949, "num_computed": 452096, "num_roped": 452096}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "mask_shape": [1, 32, 256, 15104], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:47:08.365272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.8650306748466258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 15104, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 15104, 128], "attention_shape": [1, 32, 256, 15104]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:48:19.341730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12627551020408162, "overlap_percentage": 0.22423556058890148, "num_intersection": 1584, "num_union": 12544, "num_only_computed": 5480, "num_only_roped": 5480, "total_diff": 10960, "diff_percentage": 0.8737244897959183, "num_computed": 7064, "num_roped": 7064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4, "seq_len_k": 15108, "queries_shape": [1, 32, 4, 128], "keys_shape": [1, 8, 15108, 128], "mask_shape": [1, 32, 4, 15108], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:48:21.228948", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01385498046875, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.05029296875, "l2_diff_relative": 0.08640939597315436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4, "seq_len_k": 15108, "queries_shape": [1, 32, 4, 128], "keys_shape": [1, 8, 15108, 128], "attention_shape": [1, 32, 4, 15108]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:49:24.726747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13943581560802798, "overlap_percentage": 0.24474536204327046, "num_intersection": 9525, "num_union": 68311, "num_only_computed": 29393, "num_only_roped": 29393, "total_diff": 58786, "diff_percentage": 0.860564184391972, "num_computed": 38918, "num_roped": 38918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "mask_shape": [1, 32, 22, 15130], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:49:27.166573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.345703125, "l2_diff_relative": 0.35119047619047616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "attention_shape": [1, 32, 22, 15130]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:50:28.850580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14129032258064517, "overlap_percentage": 0.2475975127190503, "num_intersection": 438, "num_union": 3100, "num_only_computed": 1331, "num_only_roped": 1331, "total_diff": 2662, "diff_percentage": 0.8587096774193549, "num_computed": 1769, "num_roped": 1769}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "mask_shape": [1, 32, 1, 15131], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:50:30.629432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.3891891891891892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "attention_shape": [1, 32, 1, 15131]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:51:25.386058", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14018691588785046, "overlap_percentage": 0.2459016393442623, "num_intersection": 435, "num_union": 3103, "num_only_computed": 1334, "num_only_roped": 1334, "total_diff": 2668, "diff_percentage": 0.8598130841121495, "num_computed": 1769, "num_roped": 1769}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15132, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15132, 128], "mask_shape": [1, 32, 1, 15132], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:51:27.156814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.18214285714285713}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15132, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15132, 128], "attention_shape": [1, 32, 1, 15132]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:51:59.945215", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:51:59.955666", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.0669231414794922e-05, "l2_diff": 0.0162353515625, "l2_diff_relative": 0.002808277027027027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:02.100989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8661455964378905, "overlap_percentage": 0.9282722613832428, "num_intersection": 72363, "num_union": 83546, "num_only_computed": 6229, "num_only_roped": 4954, "total_diff": 11183, "diff_percentage": 0.1338544035621095, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:02.242540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 8.821487426757812e-05, "l2_diff": 0.1357421875, "l2_diff_relative": 0.03315839694656489}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:07.147743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7357349997957766, "overlap_percentage": 0.8477503765060241, "num_intersection": 72052, "num_union": 97932, "num_only_computed": 12940, "num_only_roped": 12940, "total_diff": 25880, "diff_percentage": 0.26426500020422333, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:07.326574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 0.000232696533203125, "l2_diff": 0.41796875, "l2_diff_relative": 0.10288461538461538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:13.725156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6504975012381252, "overlap_percentage": 0.7882441515363129, "num_intersection": 72241, "num_union": 111055, "num_only_computed": 19407, "num_only_roped": 19407, "total_diff": 38814, "diff_percentage": 0.3495024987618747, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:13.937865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 0.00015735626220703125, "l2_diff": 0.4296875, "l2_diff_relative": 0.09963768115942029}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:20.983452", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5989069971699034, "overlap_percentage": 0.7491455078125, "num_intersection": 73644, "num_union": 122964, "num_only_computed": 24660, "num_only_roped": 24660, "total_diff": 49320, "diff_percentage": 0.40109300283009663, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:21.232771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 0.0001678466796875, "l2_diff": 0.546875, "l2_diff_relative": 0.13157894736842105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:30.510466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5496666197985658, "overlap_percentage": 0.7093998319070904, "num_intersection": 74277, "num_union": 135131, "num_only_computed": 30427, "num_only_roped": 30427, "total_diff": 60854, "diff_percentage": 0.45033338020143415, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:30.800064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 0.0001239776611328125, "l2_diff": 0.5234375, "l2_diff_relative": 0.12226277372262774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:40.045593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5097920917589159, "overlap_percentage": 0.6753142959770115, "num_intersection": 75203, "num_union": 147517, "num_only_computed": 36157, "num_only_roped": 36157, "total_diff": 72314, "diff_percentage": 0.49020790824108407, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:40.808042", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 8.726119995117188e-05, "l2_diff": 0.462890625, "l2_diff_relative": 0.10580357142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:51.157087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4735564439939686, "overlap_percentage": 0.6427394701086957, "num_intersection": 75689, "num_union": 159831, "num_only_computed": 42071, "num_only_roped": 42071, "total_diff": 84142, "diff_percentage": 0.5264435560060313, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:51.524522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 0.0001392364501953125, "l2_diff": 0.6953125, "l2_diff_relative": 0.1765873015873016}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:05.386293", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4473961272009167, "overlap_percentage": 0.6182082690329218, "num_intersection": 76915, "num_union": 171917, "num_only_computed": 47501, "num_only_roped": 47501, "total_diff": 95002, "diff_percentage": 0.5526038727990833, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:08.196901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 0.00012874603271484375, "l2_diff": 0.7109375, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:20.889083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4156554610503578, "overlap_percentage": 0.5872268676757812, "num_intersection": 76969, "num_union": 185175, "num_only_computed": 54103, "num_only_roped": 54103, "total_diff": 108206, "diff_percentage": 0.5843445389496422, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:22.535460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00010442733764648438, "l2_diff": 0.65234375, "l2_diff_relative": 0.151268115942029}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:36.431779", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3849478397969001, "overlap_percentage": 0.55590229283054, "num_intersection": 76421, "num_union": 198523, "num_only_computed": 61051, "num_only_roped": 61051, "total_diff": 122102, "diff_percentage": 0.6150521602030999, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:36.877183", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.11641221374045801}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:51.659188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3752146864623488, "overlap_percentage": 0.5456816163410302, "num_intersection": 78648, "num_union": 209608, "num_only_computed": 65480, "num_only_roped": 65480, "total_diff": 130960, "diff_percentage": 0.6247853135376512, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:52.163672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.1721311475409836}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:54:08.127549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35759412329712253, "overlap_percentage": 0.5268056441326531, "num_intersection": 79299, "num_union": 221757, "num_only_computed": 71229, "num_only_roped": 71229, "total_diff": 142458, "diff_percentage": 0.6424058767028775, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:54:08.684028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 7.581710815429688e-05, "l2_diff": 0.59765625, "l2_diff_relative": 0.1574074074074074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:54:26.147765", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34616833955671267, "overlap_percentage": 0.5143017100977199, "num_intersection": 80840, "num_union": 233528, "num_only_computed": 76344, "num_only_roped": 76344, "total_diff": 152688, "diff_percentage": 0.6538316604432873, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:54:26.738587", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.19162995594713655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:54:45.158704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3333333333333333, "overlap_percentage": 0.5, "num_intersection": 81920, "num_union": 245760, "num_only_computed": 81920, "num_only_roped": 81920, "total_diff": 163840, "diff_percentage": 0.6666666666666666, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:54:46.596380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 0.00010776519775390625, "l2_diff": 0.82421875, "l2_diff_relative": 0.25483091787439616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:06.227993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3228483511018556, "overlap_percentage": 0.4881109022556391, "num_intersection": 83096, "num_union": 257384, "num_only_computed": 87144, "num_only_roped": 87144, "total_diff": 174288, "diff_percentage": 0.6771516488981444, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:06.886503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.18991416309012876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:27.969775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31723917106625066, "overlap_percentage": 0.4816728473227207, "num_intersection": 85206, "num_union": 268586, "num_only_computed": 91690, "num_only_roped": 91690, "total_diff": 183380, "diff_percentage": 0.6827608289337493, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:28.664953", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.15822784810126583}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:51.405308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29796484867368184, "overlap_percentage": 0.4591262220670391, "num_intersection": 84156, "num_union": 282436, "num_only_computed": 99140, "num_only_roped": 99140, "total_diff": 198280, "diff_percentage": 0.7020351513263182, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:52.156066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.16015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:17.623057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2811006761199818, "overlap_percentage": 0.4388424444070081, "num_intersection": 83359, "num_union": 296545, "num_only_computed": 106593, "num_only_roped": 106593, "total_diff": 213186, "diff_percentage": 0.7188993238800182, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:18.401500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.5234375, "l2_diff_relative": 0.10339506172839506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:42.840380", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2759420722506871, "overlap_percentage": 0.4325307210286458, "num_intersection": 85039, "num_union": 308177, "num_only_computed": 111569, "num_only_roped": 111569, "total_diff": 223138, "diff_percentage": 0.7240579277493129, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:43.655755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.841255187988281e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.16276978417266186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:07.707439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2857142857142857, "overlap_percentage": 0.4444444444444444, "num_intersection": 9240, "num_union": 32340, "num_only_computed": 11550, "num_only_roped": 11550, "total_diff": 23100, "diff_percentage": 0.7142857142857143, "num_computed": 20790, "num_roped": 20790}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "mask_shape": [1, 32, 27, 5147], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:08.450675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 7.915496826171875e-05, "l2_diff": 0.26953125, "l2_diff_relative": 0.23958333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "attention_shape": [1, 32, 27, 5147]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:29.562657", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2510154346060114, "overlap_percentage": 0.4012987012987013, "num_intersection": 309, "num_union": 1231, "num_only_computed": 461, "num_only_roped": 461, "total_diff": 922, "diff_percentage": 0.7489845653939886, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "mask_shape": [1, 32, 1, 5148], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:30.936630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.12142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "attention_shape": [1, 32, 1, 5148]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:52.009133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2685337726523888, "overlap_percentage": 0.42337662337662335, "num_intersection": 326, "num_union": 1214, "num_only_computed": 444, "num_only_roped": 444, "total_diff": 888, "diff_percentage": 0.7314662273476112, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "mask_shape": [1, 32, 1, 5149], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:52.637760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.17154811715481172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "attention_shape": [1, 32, 1, 5149]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:12.020375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2701812191103789, "overlap_percentage": 0.4254215304798962, "num_intersection": 328, "num_union": 1214, "num_only_computed": 443, "num_only_roped": 443, "total_diff": 886, "diff_percentage": 0.729818780889621, "num_computed": 771, "num_roped": 771}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "mask_shape": [1, 32, 1, 5150], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:12.787872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.0223388671875, "l2_diff_relative": 0.09945652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "attention_shape": [1, 32, 1, 5150]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:29.068591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 65536, "num_union": 65536, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 65536, "num_roped": 65536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "mask_shape": [1, 32, 256, 256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:29.085146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.0967254638671875e-05, "l2_diff": 0.017333984375, "l2_diff_relative": 0.002919407894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 256, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 256, 128], "attention_shape": [1, 32, 256, 256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:31.235026", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8580502919795019, "overlap_percentage": 0.9236028709054641, "num_intersection": 71999, "num_union": 83910, "num_only_computed": 6593, "num_only_roped": 5318, "total_diff": 11911, "diff_percentage": 0.14194970802049817, "num_computed": 78592, "num_roped": 77317}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "mask_shape": [1, 32, 256, 512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:31.374872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 7.62939453125e-05, "l2_diff": 0.1396484375, "l2_diff_relative": 0.029791666666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 512, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 512, 128], "attention_shape": [1, 32, 256, 512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:36.205975", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7340174846218976, "overlap_percentage": 0.8466090926204819, "num_intersection": 71955, "num_union": 98029, "num_only_computed": 13037, "num_only_roped": 13037, "total_diff": 26074, "diff_percentage": 0.2659825153781024, "num_computed": 84992, "num_roped": 84992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "mask_shape": [1, 32, 256, 768], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:36.387030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 0.00018596649169921875, "l2_diff": 0.408203125, "l2_diff_relative": 0.09330357142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 768, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 768, 128], "attention_shape": [1, 32, 256, 768]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:42.337320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6624281231293875, "overlap_percentage": 0.7969404678770949, "num_intersection": 73038, "num_union": 110258, "num_only_computed": 18610, "num_only_roped": 18610, "total_diff": 37220, "diff_percentage": 0.3375718768706126, "num_computed": 91648, "num_roped": 91648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 256, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:42.801557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 0.0001697540283203125, "l2_diff": 0.466796875, "l2_diff_relative": 0.10445804195804195}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1024, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 256, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:49.820054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6069572040409325, "overlap_percentage": 0.7554117838541666, "num_intersection": 74260, "num_union": 122348, "num_only_computed": 24044, "num_only_roped": 24044, "total_diff": 48088, "diff_percentage": 0.3930427959590676, "num_computed": 98304, "num_roped": 98304}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "mask_shape": [1, 32, 256, 1280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:50.067837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 0.00014495849609375, "l2_diff": 0.455078125, "l2_diff_relative": 0.1103219696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1280, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1280, 128], "attention_shape": [1, 32, 256, 1280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:00.086967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5504009121399009, "overlap_percentage": 0.7100110788508558, "num_intersection": 74341, "num_union": 135067, "num_only_computed": 30363, "num_only_roped": 30363, "total_diff": 60726, "diff_percentage": 0.44959908786009906, "num_computed": 104704, "num_roped": 104704}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "mask_shape": [1, 32, 256, 1536], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:00.369400", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 9.489059448242188e-05, "l2_diff": 0.384765625, "l2_diff_relative": 0.0912037037037037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1536, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1536, 128], "attention_shape": [1, 32, 256, 1536]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:09.559284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5233821930082557, "overlap_percentage": 0.6871318247126437, "num_intersection": 76519, "num_union": 146201, "num_only_computed": 34841, "num_only_roped": 34841, "total_diff": 69682, "diff_percentage": 0.4766178069917442, "num_computed": 111360, "num_roped": 111360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "mask_shape": [1, 32, 256, 1792], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:10.570803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 0.00013828277587890625, "l2_diff": 0.546875, "l2_diff_relative": 0.1590909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 1792, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 1792, 128], "attention_shape": [1, 32, 256, 1792]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:20.865289", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4952701415783125, "overlap_percentage": 0.6624490489130435, "num_intersection": 78010, "num_union": 157510, "num_only_computed": 39750, "num_only_roped": 39750, "total_diff": 79500, "diff_percentage": 0.5047298584216875, "num_computed": 117760, "num_roped": 117760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 256, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:21.219240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07275390625, "mean_diff": 0.0001373291015625, "l2_diff": 0.63671875, "l2_diff_relative": 0.17414529914529914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2048, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 256, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:35.069146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4684079146922228, "overlap_percentage": 0.6379806455761317, "num_intersection": 79375, "num_union": 169457, "num_only_computed": 45041, "num_only_roped": 45041, "total_diff": 90082, "diff_percentage": 0.5315920853077772, "num_computed": 124416, "num_roped": 124416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "mask_shape": [1, 32, 256, 2304], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:37.820070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 0.0001392364501953125, "l2_diff": 0.6875, "l2_diff_relative": 0.1864406779661017}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2304, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2304, 128], "attention_shape": [1, 32, 256, 2304]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:50.488701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44365937339949224, "overlap_percentage": 0.6146316528320312, "num_intersection": 80561, "num_union": 181583, "num_only_computed": 50511, "num_only_roped": 50511, "total_diff": 101022, "diff_percentage": 0.5563406266005078, "num_computed": 131072, "num_roped": 131072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "mask_shape": [1, 32, 256, 2560], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:52.171845", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 7.581710815429688e-05, "l2_diff": 0.408203125, "l2_diff_relative": 0.10534274193548387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2560, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2560, 128], "attention_shape": [1, 32, 256, 2560]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:05.889381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42376883641447877, "overlap_percentage": 0.5952775837988827, "num_intersection": 81834, "num_union": 193110, "num_only_computed": 55638, "num_only_roped": 55638, "total_diff": 111276, "diff_percentage": 0.5762311635855212, "num_computed": 137472, "num_roped": 137472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "mask_shape": [1, 32, 256, 2816], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:06.345011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 9.965896606445312e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.16951219512195123}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 2816, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 2816, 128], "attention_shape": [1, 32, 256, 2816]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:21.203965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40246673315980247, "overlap_percentage": 0.5739412189165186, "num_intersection": 82721, "num_union": 205535, "num_only_computed": 61407, "num_only_roped": 61407, "total_diff": 122814, "diff_percentage": 0.5975332668401976, "num_computed": 144128, "num_roped": 144128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 256, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:21.715965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08447265625, "mean_diff": 0.00010967254638671875, "l2_diff": 0.640625, "l2_diff_relative": 0.21578947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3072, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 256, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:37.963036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37996534685233907, "overlap_percentage": 0.5506882440476191, "num_intersection": 82894, "num_union": 218162, "num_only_computed": 67634, "num_only_roped": 67634, "total_diff": 135268, "diff_percentage": 0.6200346531476609, "num_computed": 150528, "num_roped": 150528}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "mask_shape": [1, 32, 256, 3328], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:38.519816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 0.00012969970703125, "l2_diff": 0.86328125, "l2_diff_relative": 0.27487562189054726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3328, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3328, 128], "attention_shape": [1, 32, 256, 3328]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:55.857620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35624458029362405, "overlap_percentage": 0.5253397292345277, "num_intersection": 82575, "num_union": 231793, "num_only_computed": 74609, "num_only_roped": 74609, "total_diff": 149218, "diff_percentage": 0.643755419706376, "num_computed": 157184, "num_roped": 157184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "mask_shape": [1, 32, 256, 3584], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:56.439055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 6.961822509765625e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.1349206349206349}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3584, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3584, 128], "attention_shape": [1, 32, 256, 3584]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:14.559520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34292880444582874, "overlap_percentage": 0.5107177734375, "num_intersection": 83676, "num_union": 244004, "num_only_computed": 80164, "num_only_roped": 80164, "total_diff": 160328, "diff_percentage": 0.6570711955541713, "num_computed": 163840, "num_roped": 163840}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "mask_shape": [1, 32, 256, 3840], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:15.185916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 8.916854858398438e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.2016509433962264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 3840, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 3840, 128], "attention_shape": [1, 32, 256, 3840]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:34.883174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3309774365549701, "overlap_percentage": 0.4973449248120301, "num_intersection": 84668, "num_union": 255812, "num_only_computed": 85572, "num_only_roped": 85572, "total_diff": 171144, "diff_percentage": 0.66902256344503, "num_computed": 170240, "num_roped": 170240}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 256, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:35.553126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 9.822845458984375e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.23780487804878048}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4096, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 256, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:56.330021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3205579464822273, "overlap_percentage": 0.48548864869753977, "num_intersection": 85881, "num_union": 267911, "num_only_computed": 91015, "num_only_roped": 91015, "total_diff": 182030, "diff_percentage": 0.6794420535177726, "num_computed": 176896, "num_roped": 176896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "mask_shape": [1, 32, 256, 4352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:57.012646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 0.00011777877807617188, "l2_diff": 0.8828125, "l2_diff_relative": 0.3323529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4352, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4352, 128], "attention_shape": [1, 32, 256, 4352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:02:19.455520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3154869130238199, "overlap_percentage": 0.47965040153631283, "num_intersection": 87918, "num_union": 278674, "num_only_computed": 95378, "num_only_roped": 95378, "total_diff": 190756, "diff_percentage": 0.6845130869761801, "num_computed": 183296, "num_roped": 183296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "mask_shape": [1, 32, 256, 4608], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:02:20.182892", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.546875, "l2_diff_relative": 0.11824324324324324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4608, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4608, 128], "attention_shape": [1, 32, 256, 4608]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:02:44.796907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30082280713167997, "overlap_percentage": 0.46251158187331537, "num_intersection": 87855, "num_union": 292049, "num_only_computed": 102097, "num_only_roped": 102097, "total_diff": 204194, "diff_percentage": 0.69917719286832, "num_computed": 189952, "num_roped": 189952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "mask_shape": [1, 32, 256, 4864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:02:45.567126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.341796875, "l2_diff_relative": 0.06751543209876543}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 4864, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 4864, 128], "attention_shape": [1, 32, 256, 4864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:03:09.684250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2845074839443098, "overlap_percentage": 0.4429829915364583, "num_intersection": 87094, "num_union": 306122, "num_only_computed": 109514, "num_only_roped": 109514, "total_diff": 219028, "diff_percentage": 0.7154925160556902, "num_computed": 196608, "num_roped": 196608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 256, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:03:10.485065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.11153017241379311}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5120, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 256, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:03:35.658076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2937326539911354, "overlap_percentage": 0.45408555327868855, "num_intersection": 92183, "num_union": 313833, "num_only_computed": 110825, "num_only_roped": 110825, "total_diff": 221650, "diff_percentage": 0.7062673460088645, "num_computed": 203008, "num_roped": 203008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "mask_shape": [1, 32, 256, 5376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:03:36.507112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041259765625, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.14186046511627906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5376, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5376, 128], "attention_shape": [1, 32, 256, 5376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:04:02.972203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29386281588447655, "overlap_percentage": 0.45424107142857145, "num_intersection": 95238, "num_union": 324090, "num_only_computed": 114426, "num_only_roped": 114426, "total_diff": 228852, "diff_percentage": 0.7061371841155235, "num_computed": 209664, "num_roped": 209664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "mask_shape": [1, 32, 256, 5632], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:04:03.867277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5632, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5632, 128], "attention_shape": [1, 32, 256, 5632]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:04:31.858111", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2834709982862421, "overlap_percentage": 0.4417255998222749, "num_intersection": 95441, "num_union": 336687, "num_only_computed": 120623, "num_only_roped": 120623, "total_diff": 241246, "diff_percentage": 0.7165290017137579, "num_computed": 216064, "num_roped": 216064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "mask_shape": [1, 32, 256, 5888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:04:32.804227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.341796875, "l2_diff_relative": 0.07491438356164383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 5888, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 5888, 128], "attention_shape": [1, 32, 256, 5888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:05:02.032229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2760362208198097, "overlap_percentage": 0.4326463721264368, "num_intersection": 96359, "num_union": 349081, "num_only_computed": 126361, "num_only_roped": 126361, "total_diff": 252722, "diff_percentage": 0.7239637791801903, "num_computed": 222720, "num_roped": 222720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 256, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:05:02.997366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.4960765838623047e-05, "l2_diff": 0.2421875, "l2_diff_relative": 0.04725609756097561}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6144, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 256, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:05:33.523277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25576417193834394, "overlap_percentage": 0.40734427315848215, "num_intersection": 93435, "num_union": 365317, "num_only_computed": 135941, "num_only_roped": 135941, "total_diff": 271882, "diff_percentage": 0.744235828061656, "num_computed": 229376, "num_roped": 229376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "mask_shape": [1, 32, 256, 6400], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:05:34.550426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.361328125, "l2_diff_relative": 0.08200354609929078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6400, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6400, 128], "attention_shape": [1, 32, 256, 6400]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:06:09.397165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26769809799045635, "overlap_percentage": 0.4223373032030402, "num_intersection": 99577, "num_union": 371975, "num_only_computed": 136199, "num_only_roped": 136199, "total_diff": 272398, "diff_percentage": 0.7323019020095437, "num_computed": 235776, "num_roped": 235776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "mask_shape": [1, 32, 256, 6656], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:06:10.453503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.2890625, "l2_diff_relative": 0.0625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6656, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6656, 128], "attention_shape": [1, 32, 256, 6656]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:06:44.094609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2586122309123994, "overlap_percentage": 0.41094822465681097, "num_intersection": 99627, "num_union": 385237, "num_only_computed": 142805, "num_only_roped": 142805, "total_diff": 285610, "diff_percentage": 0.7413877690876006, "num_computed": 242432, "num_roped": 242432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "mask_shape": [1, 32, 256, 6912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:06:47.438507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.26171875, "l2_diff_relative": 0.05403225806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 6912, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 6912, 128], "attention_shape": [1, 32, 256, 6912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:07:21.995570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22907312736163593, "overlap_percentage": 0.37275752314814814, "num_intersection": 92754, "num_union": 404910, "num_only_computed": 156078, "num_only_roped": 156078, "total_diff": 312156, "diff_percentage": 0.7709268726383641, "num_computed": 248832, "num_roped": 248832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 256, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:07:23.156787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.375, "l2_diff_relative": 0.10084033613445378}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7168, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 256, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:07:59.581747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23497238704064, "overlap_percentage": 0.38053059243486975, "num_intersection": 97221, "num_union": 413755, "num_only_computed": 158267, "num_only_roped": 158267, "total_diff": 316534, "diff_percentage": 0.7650276129593601, "num_computed": 255488, "num_roped": 255488}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "mask_shape": [1, 32, 256, 7424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:08:00.787707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.373046875, "l2_diff_relative": 0.08466312056737589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7424, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7424, 128], "attention_shape": [1, 32, 256, 7424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:08:38.182969", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2147375152338012, "overlap_percentage": 0.35355377197265625, "num_intersection": 92682, "num_union": 431606, "num_only_computed": 169462, "num_only_roped": 169462, "total_diff": 338924, "diff_percentage": 0.7852624847661988, "num_computed": 262144, "num_roped": 262144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "mask_shape": [1, 32, 256, 7680], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:08:39.478875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.482421875, "l2_diff_relative": 0.12060546875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7680, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7680, 128], "attention_shape": [1, 32, 256, 7680]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:09:18.334021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20362867080210836, "overlap_percentage": 0.33835795996186846, "num_intersection": 90864, "num_union": 446224, "num_only_computed": 177680, "num_only_roped": 177680, "total_diff": 355360, "diff_percentage": 0.7963713291978917, "num_computed": 268544, "num_roped": 268544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "mask_shape": [1, 32, 256, 7936], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:09:21.669353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.17004504504504506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 7936, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 7936, 128], "attention_shape": [1, 32, 256, 7936]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:10:01.377572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19919385587450297, "overlap_percentage": 0.33221293604651164, "num_intersection": 91425, "num_union": 458975, "num_only_computed": 183775, "num_only_roped": 183775, "total_diff": 367550, "diff_percentage": 0.800806144125497, "num_computed": 275200, "num_roped": 275200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 256, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:10:03.204490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.2381578947368421}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8192, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 256, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:10:44.365218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19459969668367078, "overlap_percentage": 0.3257990056818182, "num_intersection": 91745, "num_union": 471455, "num_only_computed": 189855, "num_only_roped": 189855, "total_diff": 379710, "diff_percentage": 0.8054003033163293, "num_computed": 281600, "num_roped": 281600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "mask_shape": [1, 32, 256, 8448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:10:45.798012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08349609375, "mean_diff": 5.817413330078125e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.31976744186046513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8448, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8448, 128], "attention_shape": [1, 32, 256, 8448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:11:28.259295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18592146133750231, "overlap_percentage": 0.3135476798401421, "num_intersection": 90382, "num_union": 486130, "num_only_computed": 197874, "num_only_roped": 197874, "total_diff": 395748, "diff_percentage": 0.8140785386624977, "num_computed": 288256, "num_roped": 288256}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "mask_shape": [1, 32, 256, 8704], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:11:29.659219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.36470588235294116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8704, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8704, 128], "attention_shape": [1, 32, 256, 8704]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:12:13.892328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1765841748087979, "overlap_percentage": 0.3001641167534722, "num_intersection": 88522, "num_union": 501302, "num_only_computed": 206390, "num_only_roped": 206390, "total_diff": 412780, "diff_percentage": 0.8234158251912022, "num_computed": 294912, "num_roped": 294912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "mask_shape": [1, 32, 256, 8960], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:12:15.350301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.3378995433789954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 8960, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 8960, 128], "attention_shape": [1, 32, 256, 8960]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:13:00.576641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1674393104904561, "overlap_percentage": 0.2868488477060323, "num_intersection": 86431, "num_union": 516193, "num_only_computed": 214881, "num_only_roped": 214881, "total_diff": 429762, "diff_percentage": 0.8325606895095439, "num_computed": 301312, "num_roped": 301312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 256, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:13:02.983031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.30365853658536585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9216, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 256, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:13:49.694060", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15885051156525043, "overlap_percentage": 0.2741518599334996, "num_intersection": 84430, "num_union": 531506, "num_only_computed": 223538, "num_only_roped": 223538, "total_diff": 447076, "diff_percentage": 0.8411494884347496, "num_computed": 307968, "num_roped": 307968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "mask_shape": [1, 32, 256, 9472], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:13:51.263623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 5.91278076171875e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.383248730964467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9472, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9472, 128], "attention_shape": [1, 32, 256, 9472]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:14:39.071575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1526774796180084, "overlap_percentage": 0.2649092782980456, "num_intersection": 83279, "num_union": 545457, "num_only_computed": 231089, "num_only_roped": 231089, "total_diff": 462178, "diff_percentage": 0.8473225203819916, "num_computed": 314368, "num_roped": 314368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "mask_shape": [1, 32, 256, 9728], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:14:41.571494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11865234375, "mean_diff": 8.821487426757812e-05, "l2_diff": 1.6796875, "l2_diff_relative": 0.7678571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9728, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9728, 128], "attention_shape": [1, 32, 256, 9728]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:15:31.603297", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15037214085809195, "overlap_percentage": 0.26143216706539074, "num_intersection": 83926, "num_union": 558122, "num_only_computed": 237098, "num_only_roped": 237098, "total_diff": 474196, "diff_percentage": 0.8496278591419081, "num_computed": 321024, "num_roped": 321024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "mask_shape": [1, 32, 256, 9984], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:15:34.453783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12353515625, "mean_diff": 8.7738037109375e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.7310606060606061}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 9984, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 9984, 128], "attention_shape": [1, 32, 256, 9984]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:16:28.177839", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14823146843835194, "overlap_percentage": 0.25819091796875, "num_intersection": 84604, "num_union": 570756, "num_only_computed": 243076, "num_only_roped": 243076, "total_diff": 486152, "diff_percentage": 0.8517685315616481, "num_computed": 327680, "num_roped": 327680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 256, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:16:31.494275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12158203125, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.48757763975155277}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10240, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 256, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:25.082144", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1460484518328954, "overlap_percentage": 0.2548730842911877, "num_intersection": 85148, "num_union": 583012, "num_only_computed": 248932, "num_only_roped": 248932, "total_diff": 497864, "diff_percentage": 0.8539515481671046, "num_computed": 334080, "num_roped": 334080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "mask_shape": [1, 32, 256, 10496], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:28.762127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.4940828402366864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10496, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10496, 128], "attention_shape": [1, 32, 256, 10496]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:18:23.179280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1427709014929578, "overlap_percentage": 0.24986793294515403, "num_intersection": 85139, "num_union": 596333, "num_only_computed": 255597, "num_only_roped": 255597, "total_diff": 511194, "diff_percentage": 0.8572290985070422, "num_computed": 340736, "num_roped": 340736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "mask_shape": [1, 32, 256, 10752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:18:24.980788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 4.863739013671875e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.3303964757709251}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 10752, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 10752, 128], "attention_shape": [1, 32, 256, 10752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:19:21.011183", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14140851183459677, "overlap_percentage": 0.24777896847345132, "num_intersection": 86013, "num_union": 608259, "num_only_computed": 261123, "num_only_roped": 261123, "total_diff": 522246, "diff_percentage": 0.8585914881654032, "num_computed": 347136, "num_roped": 347136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "mask_shape": [1, 32, 256, 11008], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:19:22.823927", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 5.078315734863281e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.3793103448275862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11008, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11008, 128], "attention_shape": [1, 32, 256, 11008]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:20:20.534343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13839649142000315, "overlap_percentage": 0.24314286360347323, "num_intersection": 86022, "num_union": 621562, "num_only_computed": 267770, "num_only_roped": 267770, "total_diff": 535540, "diff_percentage": 0.8616035085799969, "num_computed": 353792, "num_roped": 353792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 256, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:20:22.317164", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.5195121951219512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 256, "seq_len_k": 11264, "queries_shape": [1, 32, 256, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 256, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:21:20.140988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13734213106034296, "overlap_percentage": 0.24151418875567202, "num_intersection": 31243, "num_union": 227483, "num_only_computed": 98120, "num_only_roped": 98120, "total_diff": 196240, "diff_percentage": 0.862657868939657, "num_computed": 129363, "num_roped": 129363}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 93, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:21:23.775614", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.66796875, "l2_diff_relative": 0.2928082191780822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 93, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:22:16.695881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13769128148787568, "overlap_percentage": 0.24205385719015562, "num_intersection": 8773, "num_union": 63715, "num_only_computed": 27471, "num_only_roped": 27471, "total_diff": 54942, "diff_percentage": 0.8623087185121243, "num_computed": 36244, "num_roped": 36244}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 26, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:22:20.857354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05517578125, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.306640625, "l2_diff_relative": 0.306640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 26, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:23:07.380074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13982011447260834, "overlap_percentage": 0.24533715925394547, "num_intersection": 342, "num_union": 2446, "num_only_computed": 1052, "num_only_roped": 1052, "total_diff": 2104, "diff_percentage": 0.8601798855273917, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:23:08.711181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 8.249282836914062e-05, "l2_diff": 0.08740234375, "l2_diff_relative": 0.683206106870229}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:23:49.589258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12965964343598055, "overlap_percentage": 0.22955523672883787, "num_intersection": 320, "num_union": 2468, "num_only_computed": 1074, "num_only_roped": 1074, "total_diff": 2148, "diff_percentage": 0.8703403565640194, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:23:50.896963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.2531779661016949}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:24:31.711132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13656746840603343, "overlap_percentage": 0.24031563845050216, "num_intersection": 335, "num_union": 2453, "num_only_computed": 1059, "num_only_roped": 1059, "total_diff": 2118, "diff_percentage": 0.8634325315939666, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:24:33.041796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.046875, "l2_diff_relative": 0.17142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
