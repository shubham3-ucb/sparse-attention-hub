{"timestamp": "2025-11-13T05:05:23.373776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:23.418648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030764910130718953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:29.276712", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5108912860089234, "overlap_percentage": 0.6762780230978261, "num_intersection": 318554, "num_union": 623526, "num_only_computed": 152486, "num_only_roped": 152486, "total_diff": 304972, "diff_percentage": 0.4891087139910766, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:32.404580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.625, "l2_diff_relative": 0.07092198581560284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:46.787904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40281140426650186, "overlap_percentage": 0.5742916019094139, "num_intersection": 331086, "num_union": 821938, "num_only_computed": 245426, "num_only_roped": 245426, "total_diff": 490852, "diff_percentage": 0.5971885957334981, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:47.329563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 9.107589721679688e-05, "l2_diff": 1.25, "l2_diff_relative": 0.16194331983805668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:07.583855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3463082099968762, "overlap_percentage": 0.5144560620300752, "num_intersection": 350324, "num_union": 1011596, "num_only_computed": 330636, "num_only_roped": 330636, "total_diff": 661272, "diff_percentage": 0.6536917900031238, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:08.287800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.11481481481481481}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:33.162384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29133703116225457, "overlap_percentage": 0.4512176513671875, "num_intersection": 354852, "num_union": 1218012, "num_only_computed": 431580, "num_only_roped": 431580, "total_diff": 863160, "diff_percentage": 0.7086629688377455, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:34.044051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.18526785714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:04.519506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2582944212337184, "overlap_percentage": 0.410546875, "num_intersection": 365748, "num_union": 1416012, "num_only_computed": 525132, "num_only_roped": 525132, "total_diff": 1050264, "diff_percentage": 0.7417055787662816, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:05.586035", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:44.154647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2434077383183174, "overlap_percentage": 0.39151716820987653, "num_intersection": 389688, "num_union": 1600968, "num_only_computed": 605640, "num_only_roped": 605640, "total_diff": 1211280, "diff_percentage": 0.7565922616816826, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:45.407414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.1154513888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:08:27.214788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22175631910392699, "overlap_percentage": 0.36301235465116277, "num_intersection": 399604, "num_union": 1801996, "num_only_computed": 701196, "num_only_roped": 701196, "total_diff": 1402392, "diff_percentage": 0.778243680896073, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:08:28.654652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.15497737556561086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:09:17.471406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19654374254485743, "overlap_percentage": 0.328519109759983, "num_intersection": 395947, "num_union": 2014549, "num_only_computed": 809301, "num_only_roped": 809301, "total_diff": 1618602, "diff_percentage": 0.8034562574551426, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:09:19.086236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12255859375, "mean_diff": 5.841255187988281e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.3855140186915888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:10:13.674421", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17254653056495986, "overlap_percentage": 0.2943107604980469, "num_intersection": 385759, "num_union": 2235681, "num_only_computed": 924961, "num_only_roped": 924961, "total_diff": 1849922, "diff_percentage": 0.8274534694350402, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:10:15.580361", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 0.00010013580322265625, "l2_diff": 4.375, "l2_diff_relative": 1.044776119402985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:11:18.094708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15873098402246444, "overlap_percentage": 0.27397383208212733, "num_intersection": 387719, "num_union": 2442617, "num_only_computed": 1027449, "num_only_roped": 1027449, "total_diff": 2054898, "diff_percentage": 0.8412690159775356, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:11:20.232619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 6.532669067382812e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.5841836734693877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:12:19.899081", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15328075266205626, "overlap_percentage": 0.2658168920416759, "num_intersection": 23982, "num_union": 156458, "num_only_computed": 66238, "num_only_roped": 66238, "total_diff": 132476, "diff_percentage": 0.8467192473379437, "num_computed": 90220, "num_roped": 90220}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:12:21.603790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10986328125, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.3458149779735683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:13:14.775400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15275105809926895, "overlap_percentage": 0.2650200267022697, "num_intersection": 10322, "num_union": 67574, "num_only_computed": 28626, "num_only_roped": 28626, "total_diff": 57252, "diff_percentage": 0.8472489419007311, "num_computed": 38948, "num_roped": 38948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:13:16.407310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:02.592853", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13923013923013924, "overlap_percentage": 0.24442846872753415, "num_intersection": 340, "num_union": 2442, "num_only_computed": 1051, "num_only_roped": 1051, "total_diff": 2102, "diff_percentage": 0.8607698607698607, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:04.005521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.11888111888111888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:46.654672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14203612479474548, "overlap_percentage": 0.24874191229331416, "num_intersection": 346, "num_union": 2436, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8579638752052545, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:48.048844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.064453125, "l2_diff_relative": 0.2693877551020408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:15:29.521179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1513647642679901, "overlap_percentage": 0.2629310344827586, "num_intersection": 366, "num_union": 2418, "num_only_computed": 1026, "num_only_roped": 1026, "total_diff": 2052, "diff_percentage": 0.8486352357320099, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:15:30.841608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 6.008148193359375e-05, "l2_diff": 0.111328125, "l2_diff_relative": 0.4851063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:11.642570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14615067929188966, "overlap_percentage": 0.2550287356321839, "num_intersection": 355, "num_union": 2429, "num_only_computed": 1037, "num_only_roped": 1037, "total_diff": 2074, "diff_percentage": 0.8538493207081104, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:12.971093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.5294117647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:53.731016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14615067929188966, "overlap_percentage": 0.2550287356321839, "num_intersection": 355, "num_union": 2429, "num_only_computed": 1037, "num_only_roped": 1037, "total_diff": 2074, "diff_percentage": 0.8538493207081104, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "mask_shape": [1, 32, 1, 11362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:55.055418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0264892578125, "l2_diff_relative": 0.1149364406779661}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "attention_shape": [1, 32, 1, 11362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:21.203716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:21.217380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003127639358108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:27.065858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5079191042888812, "overlap_percentage": 0.6736689028532609, "num_intersection": 317325, "num_union": 624755, "num_only_computed": 153715, "num_only_roped": 153715, "total_diff": 307430, "diff_percentage": 0.49208089571111874, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:27.456174", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.07291666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:42.060179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3892541679769724, "overlap_percentage": 0.5603786217806395, "num_intersection": 323065, "num_union": 829959, "num_only_computed": 253447, "num_only_roped": 253447, "total_diff": 506894, "diff_percentage": 0.6107458320230277, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:42.616698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.81640625, "l2_diff_relative": 0.08826013513513513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:02.866516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3237934255507139, "overlap_percentage": 0.48919026080827066, "num_intersection": 333119, "num_union": 1028801, "num_only_computed": 347841, "num_only_roped": 347841, "total_diff": 695682, "diff_percentage": 0.6762065744492861, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:03.597483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.15744274809160305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:29.040350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29392698428890385, "overlap_percentage": 0.45431772867838544, "num_intersection": 357290, "num_union": 1215574, "num_only_computed": 429142, "num_only_roped": 429142, "total_diff": 858284, "diff_percentage": 0.7060730157110962, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:29.932955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 6.103515625e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.17604166666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:01.086827", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26435093231831025, "overlap_percentage": 0.41816069504310344, "num_intersection": 372531, "num_union": 1409229, "num_only_computed": 518349, "num_only_roped": 518349, "total_diff": 1036698, "diff_percentage": 0.7356490676816898, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:03.745082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.125999450683594e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.18571428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:40.789323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23534120795173455, "overlap_percentage": 0.38101409786522633, "num_intersection": 379234, "num_union": 1611422, "num_only_computed": 616094, "num_only_roped": 616094, "total_diff": 1232188, "diff_percentage": 0.7646587920482655, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:44.227136", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.19004065040650406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:20:26.658911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2127281370444489, "overlap_percentage": 0.35082576308139535, "num_intersection": 386189, "num_union": 1815411, "num_only_computed": 714611, "num_only_roped": 714611, "total_diff": 1429222, "diff_percentage": 0.7872718629555511, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:20:28.141354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.1630859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:21:17.910120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19445194608530794, "overlap_percentage": 0.3255919113742566, "num_intersection": 392419, "num_union": 2018077, "num_only_computed": 812829, "num_only_roped": 812829, "total_diff": 1625658, "diff_percentage": 0.8055480539146921, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:21:20.779781", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 5.626678466796875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.3442982456140351}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:22:16.642731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16876267043080914, "overlap_percentage": 0.2887886047363281, "num_intersection": 378521, "num_union": 2242919, "num_only_computed": 932199, "num_only_roped": 932199, "total_diff": 1864398, "diff_percentage": 0.8312373295691908, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:22:18.544895", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 7.43865966796875e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.5989847715736041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:23:20.836613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.166774054850009, "overlap_percentage": 0.2858720660727207, "num_intersection": 404557, "num_union": 2425779, "num_only_computed": 1010611, "num_only_roped": 1010611, "total_diff": 2021222, "diff_percentage": 0.833225945149991, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:23:23.859131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.677078247070312e-05, "l2_diff": 3.8125, "l2_diff_relative": 0.782051282051282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:24:33.297693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15146151328152468, "overlap_percentage": 0.26307698787061995, "num_intersection": 399776, "num_union": 2639456, "num_only_computed": 1119840, "num_only_roped": 1119840, "total_diff": 2239680, "diff_percentage": 0.8485384867184753, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:24:35.677249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.40625, "l2_diff_relative": 0.6488095238095238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:25:51.638119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14295761720659406, "overlap_percentage": 0.2501538378229364, "num_intersection": 406522, "num_union": 2843654, "num_only_computed": 1218566, "num_only_roped": 1218566, "total_diff": 2437132, "diff_percentage": 0.8570423827934059, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:25:54.434239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.640625, "l2_diff_relative": 0.6472222222222223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:27:16.255947", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14312151931864897, "overlap_percentage": 0.25040473283007697, "num_intersection": 433084, "num_union": 3025988, "num_only_computed": 1296452, "num_only_roped": 1296452, "total_diff": 2592904, "diff_percentage": 0.856878480681351, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:27:19.064303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.104873657226562e-05, "l2_diff": 3.75, "l2_diff_relative": 0.9230769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:28:47.264181", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13833289857684195, "overlap_percentage": 0.24304471697126115, "num_intersection": 445989, "num_union": 3224027, "num_only_computed": 1389019, "num_only_roped": 1389019, "total_diff": 2778038, "diff_percentage": 0.861667101423158, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:28:50.286217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.05718994140625e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.9915966386554622}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:30:24.728276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13339525077913536, "overlap_percentage": 0.2353905236278956, "num_intersection": 395836, "num_union": 2967392, "num_only_computed": 1285778, "num_only_roped": 1285778, "total_diff": 2571556, "diff_percentage": 0.8666047492208646, "num_computed": 1681614, "num_roped": 1681614}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 894, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:30:29.390750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 6.246566772460938e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.8978102189781022}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 894, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:31:59.676925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12792556556142107, "overlap_percentage": 0.226833346928787, "num_intersection": 22246, "num_union": 173898, "num_only_computed": 75826, "num_only_roped": 75826, "total_diff": 151652, "diff_percentage": 0.8720744344385789, "num_computed": 98072, "num_roped": 98072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:32:02.392427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09814453125, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.51171875, "l2_diff_relative": 0.4119496855345912}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:33:15.635100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1371721435031655, "overlap_percentage": 0.24125132555673381, "num_intersection": 455, "num_union": 3317, "num_only_computed": 1431, "num_only_roped": 1431, "total_diff": 2862, "diff_percentage": 0.8628278564968345, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:33:17.623050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037353515625, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.0771484375, "l2_diff_relative": 0.7214611872146118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:34:19.110449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14546006680838142, "overlap_percentage": 0.2539766702014846, "num_intersection": 479, "num_union": 3293, "num_only_computed": 1407, "num_only_roped": 1407, "total_diff": 2814, "diff_percentage": 0.8545399331916186, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:34:21.894142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0147705078125, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.4073275862068966}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:35:21.785477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13205282112845138, "overlap_percentage": 0.23329798515376457, "num_intersection": 440, "num_union": 3332, "num_only_computed": 1446, "num_only_roped": 1446, "total_diff": 2892, "diff_percentage": 0.8679471788715486, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:35:23.733085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.27717391304347827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:00.033276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:00.049065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.003156043046357616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:05.926970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.501040441797399, "overlap_percentage": 0.6675908627717392, "num_intersection": 314462, "num_union": 627618, "num_only_computed": 156578, "num_only_roped": 156578, "total_diff": 313156, "diff_percentage": 0.49895955820260096, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:06.333861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 9.632110595703125e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.12781954887218044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:22.003766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3985728304074699, "overlap_percentage": 0.5699707898534636, "num_intersection": 328595, "num_union": 824429, "num_only_computed": 247917, "num_only_roped": 247917, "total_diff": 495834, "diff_percentage": 0.6014271695925301, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:22.564609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 9.584426879882812e-05, "l2_diff": 1.390625, "l2_diff_relative": 0.17943548387096775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:42.345649", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34388506246176315, "overlap_percentage": 0.5117774906015038, "num_intersection": 348500, "num_union": 1013420, "num_only_computed": 332460, "num_only_roped": 332460, "total_diff": 664920, "diff_percentage": 0.6561149375382369, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:43.092395", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:37:08.914292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3034780929618528, "overlap_percentage": 0.46564356486002606, "num_intersection": 366197, "num_union": 1206667, "num_only_computed": 420235, "num_only_roped": 420235, "total_diff": 840470, "diff_percentage": 0.6965219070381472, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:37:10.017781", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.0743838028169014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:37:41.164618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25467132267352816, "overlap_percentage": 0.40595703125, "num_intersection": 361659, "num_union": 1420101, "num_only_computed": 529221, "num_only_roped": 529221, "total_diff": 1058442, "diff_percentage": 0.7453286773264719, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:37:42.260312", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.14050387596899225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:38:19.466584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23792010895081978, "overlap_percentage": 0.38438685538837447, "num_intersection": 382591, "num_union": 1608065, "num_only_computed": 612737, "num_only_roped": 612737, "total_diff": 1225474, "diff_percentage": 0.7620798910491803, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:38:20.758316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.14130434782608695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:39:03.225545", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2166668324552067, "overlap_percentage": 0.35616460755813956, "num_intersection": 392066, "num_union": 1809534, "num_only_computed": 708734, "num_only_roped": 708734, "total_diff": 1417468, "diff_percentage": 0.7833331675447933, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:39:04.671968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.9206275939941406e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.1383399209486166}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:39:52.870448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1953955498779063, "overlap_percentage": 0.3269136310535259, "num_intersection": 394012, "num_union": 2016484, "num_only_computed": 811236, "num_only_roped": 811236, "total_diff": 1622472, "diff_percentage": 0.8046044501220937, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:39:55.172390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:40:49.755899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16497467794145618, "overlap_percentage": 0.2832244873046875, "num_intersection": 371228, "num_union": 2250212, "num_only_computed": 939492, "num_only_roped": 939492, "total_diff": 1878984, "diff_percentage": 0.8350253220585439, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:40:51.655780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 8.535385131835938e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.7771084337349398}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:41:53.331465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15061792636919474, "overlap_percentage": 0.2618035455861071, "num_intersection": 370496, "num_union": 2459840, "num_only_computed": 1044672, "num_only_roped": 1044672, "total_diff": 2089344, "diff_percentage": 0.8493820736308052, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:41:56.432130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.534027099609375e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.7379518072289156}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:43:04.398653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14553388961047284, "overlap_percentage": 0.254089190953504, "num_intersection": 386118, "num_union": 2653114, "num_only_computed": 1133498, "num_only_roped": 1133498, "total_diff": 2266996, "diff_percentage": 0.8544661103895271, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:43:07.915204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.152557373046875e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.7914110429447853}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:44:23.185724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13809889648903248, "overlap_percentage": 0.24268347314114683, "num_intersection": 394382, "num_union": 2855794, "num_only_computed": 1230706, "num_only_roped": 1230706, "total_diff": 2461412, "diff_percentage": 0.8619011035109675, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:44:28.124956", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 7.390975952148438e-05, "l2_diff": 4.71875, "l2_diff_relative": 0.848314606741573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:45:50.351001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13849790522720606, "overlap_percentage": 0.24329935890319715, "num_intersection": 420795, "num_union": 3038277, "num_only_computed": 1308741, "num_only_roped": 1308741, "total_diff": 2617482, "diff_percentage": 0.8615020947727939, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:45:53.357212", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.914138793945312e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.9}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:47:22.436360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13565968233849565, "overlap_percentage": 0.23890904017857142, "num_intersection": 438400, "num_union": 3231616, "num_only_computed": 1396608, "num_only_roped": 1396608, "total_diff": 2793216, "diff_percentage": 0.8643403176615043, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:47:26.732282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.8626760563380281}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:49:02.450264", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12852099543046563, "overlap_percentage": 0.22776890452346843, "num_intersection": 401437, "num_union": 3123513, "num_only_computed": 1361038, "num_only_roped": 1361038, "total_diff": 2722076, "diff_percentage": 0.8714790045695344, "num_computed": 1762475, "num_roped": 1762475}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:49:05.722572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 6.67572021484375e-05, "l2_diff": 4.15625, "l2_diff_relative": 0.9851851851851852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:50:33.128289", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12806213901613225, "overlap_percentage": 0.22704802259887005, "num_intersection": 12860, "num_union": 100420, "num_only_computed": 43780, "num_only_roped": 43780, "total_diff": 87560, "diff_percentage": 0.8719378609838677, "num_computed": 56640, "num_roped": 56640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:50:36.539087", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06982421875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.400390625, "l2_diff_relative": 0.36347517730496454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:51:43.484937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13223388305847075, "overlap_percentage": 0.23358050847457626, "num_intersection": 441, "num_union": 3335, "num_only_computed": 1447, "num_only_roped": 1447, "total_diff": 2894, "diff_percentage": 0.8677661169415293, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:51:46.235206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04150390625, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.07763671875, "l2_diff_relative": 0.6309523809523809}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:52:43.352174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1291866028708134, "overlap_percentage": 0.2288135593220339, "num_intersection": 432, "num_union": 3344, "num_only_computed": 1456, "num_only_roped": 1456, "total_diff": 2912, "diff_percentage": 0.8708133971291866, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "mask_shape": [1, 32, 1, 16327], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:52:45.188487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.042724609375, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.0888671875, "l2_diff_relative": 0.8198198198198198}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "attention_shape": [1, 32, 1, 16327]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:53:19.194016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:53:19.207698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.003043519938650307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:53:27.302528", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5191432888433077, "overlap_percentage": 0.6834684952445652, "num_intersection": 321941, "num_union": 620139, "num_only_computed": 149099, "num_only_roped": 149099, "total_diff": 298198, "diff_percentage": 0.48085671115669226, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:53:27.675312", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.09973404255319149}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:53:43.320472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40569312151250897, "overlap_percentage": 0.5772143511323268, "num_intersection": 332771, "num_union": 820253, "num_only_computed": 243741, "num_only_roped": 243741, "total_diff": 487482, "diff_percentage": 0.5943068784874911, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:53:43.852492", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 0.00010251998901367188, "l2_diff": 1.3671875, "l2_diff_relative": 0.20161290322580644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:54:03.250724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34759373104525787, "overlap_percentage": 0.5158731790413534, "num_intersection": 351289, "num_union": 1010631, "num_only_computed": 329671, "num_only_roped": 329671, "total_diff": 659342, "diff_percentage": 0.6524062689547422, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:54:04.469846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.390625, "l2_diff_relative": 0.2109004739336493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:54:29.737301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.296415139283951, "overlap_percentage": 0.45728429158528644, "num_intersection": 359623, "num_union": 1213241, "num_only_computed": 426809, "num_only_roped": 426809, "total_diff": 853618, "diff_percentage": 0.703584860716049, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:54:32.046848", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.104873657226562e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.22209302325581395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:55:02.432391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2670230263742687, "overlap_percentage": 0.421496722341954, "num_intersection": 375503, "num_union": 1406257, "num_only_computed": 515377, "num_only_roped": 515377, "total_diff": 1030754, "diff_percentage": 0.7329769736257313, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:55:03.495861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.24178403755868544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:55:39.345510", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23995191319459583, "overlap_percentage": 0.3870342238940329, "num_intersection": 385226, "num_union": 1605430, "num_only_computed": 610102, "num_only_roped": 610102, "total_diff": 1220204, "diff_percentage": 0.7600480868054041, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:55:41.154243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.27427184466019416}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:56:22.593704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2278547231917084, "overlap_percentage": 0.37114280523255816, "num_intersection": 408554, "num_union": 1793046, "num_only_computed": 692246, "num_only_roped": 692246, "total_diff": 1384492, "diff_percentage": 0.7721452768082916, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:56:24.003739", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.9114227294921875e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.24879807692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:57:12.388057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19738239504693667, "overlap_percentage": 0.329689823173322, "num_intersection": 397358, "num_union": 2013138, "num_only_computed": 807890, "num_only_roped": 807890, "total_diff": 1615780, "diff_percentage": 0.8026176049530633, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:57:14.043818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.555152893066406e-05, "l2_diff": 2.375, "l2_diff_relative": 0.36538461538461536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:58:10.659815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16485043893404525, "overlap_percentage": 0.2830413818359375, "num_intersection": 370988, "num_union": 2250452, "num_only_computed": 939732, "num_only_roped": 939732, "total_diff": 1879464, "diff_percentage": 0.8351495610659547, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:58:13.797743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 8.440017700195312e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.7745098039215687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:59:15.329989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15144458628991642, "overlap_percentage": 0.2630514539616498, "num_intersection": 372262, "num_union": 2458074, "num_only_computed": 1042906, "num_only_roped": 1042906, "total_diff": 2085812, "diff_percentage": 0.8485554137100836, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:59:17.492434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 7.867813110351562e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.7838709677419354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:00:27.436451", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1589368795594622, "overlap_percentage": 0.274280476120283, "num_intersection": 416801, "num_union": 2622431, "num_only_computed": 1102815, "num_only_roped": 1102815, "total_diff": 2205630, "diff_percentage": 0.8410631204405378, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:00:31.613153", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.772445678710938e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.7789115646258503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:47.805317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15060578769392852, "overlap_percentage": 0.2617852079395085, "num_intersection": 425424, "num_union": 2824752, "num_only_computed": 1199664, "num_only_roped": 1199664, "total_diff": 2399328, "diff_percentage": 0.8493942123060715, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:51.391649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 6.580352783203125e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.6970588235294117}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:03:13.955653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1443199212390818, "overlap_percentage": 0.2522370161708111, "num_intersection": 436253, "num_union": 3022819, "num_only_computed": 1293283, "num_only_roped": 1293283, "total_diff": 2586566, "diff_percentage": 0.8556800787609182, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:03:16.761709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.009506225585938e-05, "l2_diff": 3.78125, "l2_diff_relative": 0.9029850746268657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:04:46.686890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1343507415747007, "overlap_percentage": 0.23687689644949778, "num_intersection": 434671, "num_union": 3235345, "num_only_computed": 1400337, "num_only_roped": 1400337, "total_diff": 2800674, "diff_percentage": 0.8656492584252993, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:04:52.010958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 5.626678466796875e-05, "l2_diff": 3.25, "l2_diff_relative": 0.6842105263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:06:30.631437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13118325281563342, "overlap_percentage": 0.23193987798016738, "num_intersection": 422138, "num_union": 3217926, "num_only_computed": 1397894, "num_only_roped": 1397894, "total_diff": 2795788, "diff_percentage": 0.8688167471843665, "num_computed": 1820032, "num_roped": 1820032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:06:33.940582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 6.341934204101562e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.9147286821705426}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:08:05.464290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13292619291498367, "overlap_percentage": 0.23465993415328978, "num_intersection": 13756, "num_union": 103486, "num_only_computed": 44865, "num_only_roped": 44865, "total_diff": 89730, "diff_percentage": 0.8670738070850164, "num_computed": 58621, "num_roped": 58621}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:08:07.937999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.33984375, "l2_diff_relative": 0.29591836734693877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:09:15.886769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13812819741197713, "overlap_percentage": 0.24272871496562665, "num_intersection": 459, "num_union": 3323, "num_only_computed": 1432, "num_only_roped": 1432, "total_diff": 2864, "diff_percentage": 0.8618718025880229, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:09:17.789080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.387987012987013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:09:52.885774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:09:52.899151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0030174026946107784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:09:58.848918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5428632258170175, "overlap_percentage": 0.7037088145380435, "num_intersection": 331475, "num_union": 610605, "num_only_computed": 139565, "num_only_roped": 139565, "total_diff": 279130, "diff_percentage": 0.45713677418298243, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:09:59.270983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.06793478260869565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:10:14.393507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40344317208070424, "overlap_percentage": 0.5749333925399644, "num_intersection": 331456, "num_union": 821568, "num_only_computed": 245056, "num_only_roped": 245056, "total_diff": 490112, "diff_percentage": 0.5965568279192958, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:10:14.937922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.90234375, "l2_diff_relative": 0.09689597315436242}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:10:34.671671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33788621208608555, "overlap_percentage": 0.5051045582706767, "num_intersection": 343956, "num_union": 1017964, "num_only_computed": 337004, "num_only_roped": 337004, "total_diff": 674008, "diff_percentage": 0.6621137879139144, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:10:35.399195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 5.054473876953125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.11201298701298701}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:11:01.387139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2925382946551838, "overlap_percentage": 0.4526570638020833, "num_intersection": 355984, "num_union": 1216880, "num_only_computed": 430448, "num_only_roped": 430448, "total_diff": 860896, "diff_percentage": 0.7074617053448162, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:11:02.456010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.10669642857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:11:33.553370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25616445985760145, "overlap_percentage": 0.40785178699712643, "num_intersection": 363347, "num_union": 1418413, "num_only_computed": 527533, "num_only_roped": 527533, "total_diff": 1055066, "diff_percentage": 0.7438355401423986, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:11:34.640914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.1701923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:12:11.448332", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23192467808781655, "overlap_percentage": 0.3765241206918724, "num_intersection": 374765, "num_union": 1615891, "num_only_computed": 620563, "num_only_roped": 620563, "total_diff": 1241126, "diff_percentage": 0.7680753219121834, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:12:12.734104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 5.221366882324219e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.23076923076923078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:12:55.100475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21474489308909692, "overlap_percentage": 0.35356377180232557, "num_intersection": 389203, "num_union": 1812397, "num_only_computed": 711597, "num_only_roped": 711597, "total_diff": 1423194, "diff_percentage": 0.7852551069109031, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:12:56.531326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.7265625, "l2_diff_relative": 0.23917748917748918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:13:44.333452", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19647425429326748, "overlap_percentage": 0.3284220343033135, "num_intersection": 395830, "num_union": 2014666, "num_only_computed": 809418, "num_only_roped": 809418, "total_diff": 1618836, "diff_percentage": 0.8035257457067325, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:13:47.566479", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.580352783203125e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.44358974358974357}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:14:42.167789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1645363360089629, "overlap_percentage": 0.2825782775878906, "num_intersection": 370381, "num_union": 2251059, "num_only_computed": 940339, "num_only_roped": 940339, "total_diff": 1880678, "diff_percentage": 0.8354636639910371, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:14:44.061902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 9.34600830078125e-05, "l2_diff": 4.34375, "l2_diff_relative": 0.9205298013245033}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:15:45.662320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15214344477674885, "overlap_percentage": 0.2641050391190304, "num_intersection": 373753, "num_union": 2456583, "num_only_computed": 1041415, "num_only_roped": 1041415, "total_diff": 2082830, "diff_percentage": 0.8478565552232512, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:15:49.011450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 9.107589721679688e-05, "l2_diff": 4.4375, "l2_diff_relative": 0.9861111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:16:57.601461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15515527081553285, "overlap_percentage": 0.26863102257412397, "num_intersection": 408216, "num_union": 2631016, "num_only_computed": 1111400, "num_only_roped": 1111400, "total_diff": 2222800, "diff_percentage": 0.8448447291844672, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:16:59.993641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.9862068965517241}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:18:15.630878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1516519463989971, "overlap_percentage": 0.2633641993541273, "num_intersection": 427990, "num_union": 2822186, "num_only_computed": 1197098, "num_only_roped": 1197098, "total_diff": 2394196, "diff_percentage": 0.848348053601003, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:18:20.219714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 7.724761962890625e-05, "l2_diff": 4.15625, "l2_diff_relative": 0.8986486486486487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:19:42.143511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15010962221730137, "overlap_percentage": 0.26103532970692717, "num_intersection": 451470, "num_union": 3007602, "num_only_computed": 1278066, "num_only_roped": 1278066, "total_diff": 2556132, "diff_percentage": 0.8498903777826986, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:19:45.980553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 6.532669067382812e-05, "l2_diff": 4.28125, "l2_diff_relative": 0.7828571428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:21:06.131060", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14405323749531013, "overlap_percentage": 0.25182960508146923, "num_intersection": 65655, "num_union": 455769, "num_only_computed": 195057, "num_only_roped": 195057, "total_diff": 390114, "diff_percentage": 0.8559467625046899, "num_computed": 260712, "num_roped": 260712}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:21:08.647416", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.6743621826171875e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.5328947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:22:19.338181", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14021708878374617, "overlap_percentage": 0.24594805702011327, "num_intersection": 10076, "num_union": 71860, "num_only_computed": 30892, "num_only_roped": 30892, "total_diff": 61784, "diff_percentage": 0.8597829112162538, "num_computed": 40968, "num_roped": 40968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:22:21.470721", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11767578125, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.48616600790513836}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:23:21.741201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1410427807486631, "overlap_percentage": 0.2472173403632103, "num_intersection": 422, "num_union": 2992, "num_only_computed": 1285, "num_only_roped": 1285, "total_diff": 2570, "diff_percentage": 0.858957219251337, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:23:25.358977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 8.344650268554688e-05, "l2_diff": 0.09423828125, "l2_diff_relative": 0.9278846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:24:18.819890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14794889038332212, "overlap_percentage": 0.2577621558289397, "num_intersection": 440, "num_union": 2974, "num_only_computed": 1267, "num_only_roped": 1267, "total_diff": 2534, "diff_percentage": 0.8520511096166778, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14515, 128], "mask_shape": [1, 32, 1, 14515], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:24:20.560632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.06396484375, "l2_diff_relative": 0.30324074074074076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14515, 128], "attention_shape": [1, 32, 1, 14515]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:14.447897", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1522105973675329, "overlap_percentage": 0.26420620972466313, "num_intersection": 451, "num_union": 2963, "num_only_computed": 1256, "num_only_roped": 1256, "total_diff": 2512, "diff_percentage": 0.847789402632467, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14516, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14516, 128], "mask_shape": [1, 32, 1, 14516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:16.162018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.053955078125, "l2_diff_relative": 0.29864864864864865}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14516, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14516, 128], "attention_shape": [1, 32, 1, 14516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:47.534617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:47.547226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0030623070987654323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:53.477789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5196235782967144, "overlap_percentage": 0.6838845957880435, "num_intersection": 322137, "num_union": 619943, "num_only_computed": 148903, "num_only_roped": 148903, "total_diff": 297806, "diff_percentage": 0.48037642170328565, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:54.440697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 7.62939453125e-05, "l2_diff": 0.953125, "l2_diff_relative": 0.10374149659863946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:09.053864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40526481926330554, "overlap_percentage": 0.5767807088143873, "num_intersection": 332521, "num_union": 820503, "num_only_computed": 243991, "num_only_roped": 243991, "total_diff": 487982, "diff_percentage": 0.5947351807366944, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:09.606240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.10355839416058395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:29.934015", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3372293964244195, "overlap_percentage": 0.5043703007518797, "num_intersection": 343456, "num_union": 1018464, "num_only_computed": 337504, "num_only_roped": 337504, "total_diff": 675008, "diff_percentage": 0.6627706035755805, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:30.648797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.14960629921259844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:56.316687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2977479280030033, "overlap_percentage": 0.45886866251627606, "num_intersection": 360869, "num_union": 1211995, "num_only_computed": 425563, "num_only_roped": 425563, "total_diff": 851126, "diff_percentage": 0.7022520719969967, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:57.233248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.1725206611570248}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:27:28.489937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26717170711447047, "overlap_percentage": 0.42168193247126434, "num_intersection": 375668, "num_union": 1406092, "num_only_computed": 515212, "num_only_roped": 515212, "total_diff": 1030424, "diff_percentage": 0.7328282928855295, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:27:30.898111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06982421875, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.25, "l2_diff_relative": 0.15384615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:28:07.945342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23970635491995007, "overlap_percentage": 0.38671473122427985, "num_intersection": 384908, "num_union": 1605748, "num_only_computed": 610420, "num_only_roped": 610420, "total_diff": 1220840, "diff_percentage": 0.7602936450800499, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:28:10.865871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.17211538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:28:53.632621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22138895268782127, "overlap_percentage": 0.36251998546511627, "num_intersection": 399062, "num_union": 1802538, "num_only_computed": 701738, "num_only_roped": 701738, "total_diff": 1403476, "diff_percentage": 0.7786110473121787, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:28:55.111972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:29:44.102722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1896058723840225, "overlap_percentage": 0.31877090855989804, "num_intersection": 384198, "num_union": 2026298, "num_only_computed": 821050, "num_only_roped": 821050, "total_diff": 1642100, "diff_percentage": 0.8103941276159775, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:29:48.183598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 6.246566772460938e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.4354066985645933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:30:43.309658", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15884368491992235, "overlap_percentage": 0.2741416931152344, "num_intersection": 359323, "num_union": 2262117, "num_only_computed": 951397, "num_only_roped": 951397, "total_diff": 1902794, "diff_percentage": 0.8411563150800776, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:30:45.218921", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 0.00010061264038085938, "l2_diff": 4.6875, "l2_diff_relative": 1.0067114093959733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:31:47.163332", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1498942872883105, "overlap_percentage": 0.2607096825253256, "num_intersection": 368948, "num_union": 2461388, "num_only_computed": 1046220, "num_only_roped": 1046220, "total_diff": 2092440, "diff_percentage": 0.8501057127116896, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:31:50.597843", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.53125, "l2_diff_relative": 0.8055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:32:59.553159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14787757058303877, "overlap_percentage": 0.25765390730289756, "num_intersection": 391535, "num_union": 2647697, "num_only_computed": 1128081, "num_only_roped": 1128081, "total_diff": 2256162, "diff_percentage": 0.8521224294169613, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:33:01.942802", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.390975952148438e-05, "l2_diff": 4.1875, "l2_diff_relative": 0.7486033519553073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:34:18.236121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1511645080844562, "overlap_percentage": 0.2626288545604915, "num_intersection": 426795, "num_union": 2823381, "num_only_computed": 1198293, "num_only_roped": 1198293, "total_diff": 2396586, "diff_percentage": 0.8488354919155439, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:34:22.201920", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 6.866455078125e-05, "l2_diff": 3.890625, "l2_diff_relative": 0.7638036809815951}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:35:45.066469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13945574085646154, "overlap_percentage": 0.24477605554322085, "num_intersection": 423349, "num_union": 3035723, "num_only_computed": 1306187, "num_only_roped": 1306187, "total_diff": 2612374, "diff_percentage": 0.8605442591435385, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:35:47.940445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 6.29425048828125e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.804635761589404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:37:11.845073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13868128217904002, "overlap_percentage": 0.24358226371061845, "num_intersection": 105210, "num_union": 758646, "num_only_computed": 326718, "num_only_roped": 326718, "total_diff": 653436, "diff_percentage": 0.8613187178209599, "num_computed": 431928, "num_roped": 431928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:37:14.501095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.6416184971098265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:38:28.810558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13035611481207335, "overlap_percentage": 0.23064610011641443, "num_intersection": 12680, "num_union": 97272, "num_only_computed": 42296, "num_only_roped": 42296, "total_diff": 84592, "diff_percentage": 0.8696438851879267, "num_computed": 54976, "num_roped": 54976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:38:31.589311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10400390625, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.41847826086956524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:39:31.333232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14190761050182785, "overlap_percentage": 0.24854481955762514, "num_intersection": 427, "num_union": 3009, "num_only_computed": 1291, "num_only_roped": 1291, "total_diff": 2582, "diff_percentage": 0.8580923894981721, "num_computed": 1718, "num_roped": 1718}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:39:33.004353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.047119140625, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.10400390625, "l2_diff_relative": 0.841897233201581}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:05.822053", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:05.834764", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.0030137624172185433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:11.589520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49394464628075846, "overlap_percentage": 0.6612623131793478, "num_intersection": 311481, "num_union": 630599, "num_only_computed": 159559, "num_only_roped": 159559, "total_diff": 319118, "diff_percentage": 0.5060553537192416, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:11.971073", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00011301040649414062, "l2_diff": 1.1953125, "l2_diff_relative": 0.14166666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:26.505547", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41838723010608775, "overlap_percentage": 0.5899478241563055, "num_intersection": 340112, "num_union": 812912, "num_only_computed": 236400, "num_only_roped": 236400, "total_diff": 472800, "diff_percentage": 0.5816127698939123, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:27.041888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.07996323529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:46.240096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3498871063341375, "overlap_percentage": 0.5183946193609023, "num_intersection": 353006, "num_union": 1008914, "num_only_computed": 327954, "num_only_roped": 327954, "total_diff": 655908, "diff_percentage": 0.6501128936658626, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:46.925057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 5.245208740234375e-05, "l2_diff": 1.0, "l2_diff_relative": 0.12648221343873517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:41:11.970651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27828874919236535, "overlap_percentage": 0.4354082743326823, "num_intersection": 342419, "num_union": 1230445, "num_only_computed": 444013, "num_only_roped": 444013, "total_diff": 888026, "diff_percentage": 0.7217112508076347, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:41:15.087651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.1259328358208955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:41:45.086372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2456776434365199, "overlap_percentage": 0.3944481860632184, "num_intersection": 351406, "num_union": 1430354, "num_only_computed": 539474, "num_only_roped": 539474, "total_diff": 1078948, "diff_percentage": 0.7543223565634801, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:41:46.607638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:42:21.944913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2379932461426519, "overlap_percentage": 0.3844823013117284, "num_intersection": 382686, "num_union": 1607970, "num_only_computed": 612642, "num_only_roped": 612642, "total_diff": 1225284, "diff_percentage": 0.7620067538573481, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:42:23.981454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 4.9114227294921875e-05, "l2_diff": 1.6953125, "l2_diff_relative": 0.22142857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:43:04.960993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22851041438232142, "overlap_percentage": 0.3720121729651163, "num_intersection": 409511, "num_union": 1792089, "num_only_computed": 691289, "num_only_roped": 691289, "total_diff": 1382578, "diff_percentage": 0.7714895856176786, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:43:06.358865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.1728515625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:43:53.245291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19571575400903993, "overlap_percentage": 0.32736167162276975, "num_intersection": 394552, "num_union": 2015944, "num_only_computed": 810696, "num_only_roped": 810696, "total_diff": 1621392, "diff_percentage": 0.80428424599096, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:43:54.911338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 7.009506225585938e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.5082417582417582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:44:48.456523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15950541970058732, "overlap_percentage": 0.27512664794921876, "num_intersection": 360614, "num_union": 2260826, "num_only_computed": 950106, "num_only_roped": 950106, "total_diff": 1900212, "diff_percentage": 0.8404945802994127, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:44:50.332016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.0, "l2_diff_relative": 0.8050314465408805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:45:52.082715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1501209109014049, "overlap_percentage": 0.2610523980191751, "num_intersection": 369433, "num_union": 2460903, "num_only_computed": 1045735, "num_only_roped": 1045735, "total_diff": 2091470, "diff_percentage": 0.8498790890985951, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:45:54.175893", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 8.106231689453125e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.8333333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:47:00.060279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1484796371096497, "overlap_percentage": 0.2585672959484501, "num_intersection": 392923, "num_union": 2646309, "num_only_computed": 1126693, "num_only_roped": 1126693, "total_diff": 2253386, "diff_percentage": 0.8515203628903503, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:47:02.328658", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.915496826171875e-05, "l2_diff": 4.0, "l2_diff_relative": 0.8366013071895425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:48:15.293324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15185683442936912, "overlap_percentage": 0.2636731057025835, "num_intersection": 428492, "num_union": 2821684, "num_only_computed": 1196596, "num_only_roped": 1196596, "total_diff": 2393192, "diff_percentage": 0.8481431655706309, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:48:19.575650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.152557373046875e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.8346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:49:40.836409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14390441272032267, "overlap_percentage": 0.25160216381734757, "num_intersection": 435155, "num_union": 3023917, "num_only_computed": 1294381, "num_only_roped": 1294381, "total_diff": 2588762, "diff_percentage": 0.8560955872796773, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:49:44.439584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.580352783203125e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.7919254658385093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:51:12.865221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1290925581126331, "overlap_percentage": 0.22866603306361608, "num_intersection": 419604, "num_union": 3250412, "num_only_computed": 1415404, "num_only_roped": 1415404, "total_diff": 2830808, "diff_percentage": 0.8709074418873669, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:51:17.438276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.5255681818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:49.514078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13171991722558962, "overlap_percentage": 0.2327782965037867, "num_intersection": 188475, "num_union": 1430877, "num_only_computed": 621201, "num_only_roped": 621201, "total_diff": 1242402, "diff_percentage": 0.8682800827744104, "num_computed": 809676, "num_roped": 809676}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 441, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:53.714185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.4836273193359375e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.6351931330472103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 441, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:54:15.800985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1346554518095532, "overlap_percentage": 0.23735038084874863, "num_intersection": 10470, "num_union": 77754, "num_only_computed": 33642, "num_only_roped": 33642, "total_diff": 67284, "diff_percentage": 0.8653445481904468, "num_computed": 44112, "num_roped": 44112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:54:19.034072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 3.0517578125e-05, "l2_diff": 0.177734375, "l2_diff_relative": 0.15689655172413794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:55:24.360161", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13949163050216987, "overlap_percentage": 0.24483133841131666, "num_intersection": 450, "num_union": 3226, "num_only_computed": 1388, "num_only_roped": 1388, "total_diff": 2776, "diff_percentage": 0.8605083694978302, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:55:28.033281", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 5.841255187988281e-05, "l2_diff": 0.095703125, "l2_diff_relative": 0.6125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:56:25.107919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13808049535603714, "overlap_percentage": 0.2426550598476605, "num_intersection": 446, "num_union": 3230, "num_only_computed": 1392, "num_only_roped": 1392, "total_diff": 2784, "diff_percentage": 0.8619195046439628, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:56:27.036270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.0634765625, "l2_diff_relative": 0.35911602209944754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:57:26.448579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1276073619631902, "overlap_percentage": 0.22633297062023938, "num_intersection": 416, "num_union": 3260, "num_only_computed": 1422, "num_only_roped": 1422, "total_diff": 2844, "diff_percentage": 0.8723926380368098, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:57:29.136233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.0751953125, "l2_diff_relative": 0.37745098039215685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:58:29.606369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13597033374536466, "overlap_percentage": 0.23939064200217627, "num_intersection": 440, "num_union": 3236, "num_only_computed": 1398, "num_only_roped": 1398, "total_diff": 2796, "diff_percentage": 0.8640296662546354, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "mask_shape": [1, 32, 1, 15829], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:58:31.506836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.1279296875, "l2_diff_relative": 0.7043010752688172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "attention_shape": [1, 32, 1, 15829]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:59:30.461632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1355356591540599, "overlap_percentage": 0.23871669385535618, "num_intersection": 439, "num_union": 3239, "num_only_computed": 1400, "num_only_roped": 1400, "total_diff": 2800, "diff_percentage": 0.8644643408459401, "num_computed": 1839, "num_roped": 1839}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "mask_shape": [1, 32, 1, 15830], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:59:33.537650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.0810546875, "l2_diff_relative": 0.46111111111111114}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "attention_shape": [1, 32, 1, 15830]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:03.714052", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:03.722446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030967310855263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:09.616801", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5130922763359294, "overlap_percentage": 0.6782035495923913, "num_intersection": 319461, "num_union": 622619, "num_only_computed": 151579, "num_only_roped": 151579, "total_diff": 303158, "diff_percentage": 0.48690772366407065, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:10.004362", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.10009057971014493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:21.716986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45994480827052187, "overlap_percentage": 0.6300852000225695, "num_intersection": 55835, "num_union": 121395, "num_only_computed": 32780, "num_only_roped": 32780, "total_diff": 65560, "diff_percentage": 0.5400551917294781, "num_computed": 88615, "num_roped": 88615}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:22.100246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 0.00013065338134765625, "l2_diff": 0.58203125, "l2_diff_relative": 0.19005102040816327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:33.529648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4720284000489656, "overlap_percentage": 0.6413305613305613, "num_intersection": 7712, "num_union": 16338, "num_only_computed": 4313, "num_only_roped": 4313, "total_diff": 8626, "diff_percentage": 0.5279715999510344, "num_computed": 12025, "num_roped": 12025}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:33.877379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 0.000125885009765625, "l2_diff": 0.1787109375, "l2_diff_relative": 0.1525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:44.024333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45317220543806647, "overlap_percentage": 0.6237006237006237, "num_intersection": 300, "num_union": 662, "num_only_computed": 181, "num_only_roped": 181, "total_diff": 362, "diff_percentage": 0.5468277945619335, "num_computed": 481, "num_roped": 481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:44.337673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 4.57763671875e-05, "l2_diff": 0.01470947265625, "l2_diff_relative": 0.054972627737226276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:53.975392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4672754946727549, "overlap_percentage": 0.6369294605809128, "num_intersection": 307, "num_union": 657, "num_only_computed": 175, "num_only_roped": 175, "total_diff": 350, "diff_percentage": 0.532724505327245, "num_computed": 482, "num_roped": 482}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:56.043459", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.0084228515625, "l2_diff_relative": 0.036702127659574466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:04.232725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:04.245252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031105324074074073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:10.052826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5113469738729228, "overlap_percentage": 0.6766771399456522, "num_intersection": 318742, "num_union": 623338, "num_only_computed": 152298, "num_only_roped": 152298, "total_diff": 304596, "diff_percentage": 0.4886530261270771, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:10.436463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.10541044776119403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:24.873870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39746425511130395, "overlap_percentage": 0.5688363815497336, "num_intersection": 327941, "num_union": 825083, "num_only_computed": 248571, "num_only_roped": 248571, "total_diff": 497142, "diff_percentage": 0.6025357448886961, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:25.418539", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1259259259259259}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:45.696864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3393888015798242, "overlap_percentage": 0.506781602443609, "num_intersection": 345098, "num_union": 1016822, "num_only_computed": 335862, "num_only_roped": 335862, "total_diff": 671724, "diff_percentage": 0.6606111984201758, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:46.434294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.09419642857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:02:12.288596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3034554085231642, "overlap_percentage": 0.4656168619791667, "num_intersection": 366176, "num_union": 1206688, "num_only_computed": 420256, "num_only_roped": 420256, "total_diff": 840512, "diff_percentage": 0.6965445914768358, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:02:13.189993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.11824324324324324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:02:44.382139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2725775451943728, "overlap_percentage": 0.42838653915229885, "num_intersection": 381641, "num_union": 1400119, "num_only_computed": 509239, "num_only_roped": 509239, "total_diff": 1018478, "diff_percentage": 0.7274224548056273, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:02:46.833872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.09685430463576158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:03:23.973827", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24538358937656246, "overlap_percentage": 0.39406909079218105, "num_intersection": 392228, "num_union": 1598428, "num_only_computed": 603100, "num_only_roped": 603100, "total_diff": 1206200, "diff_percentage": 0.7546164106234375, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:03:27.030957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.14248251748251747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:04:09.386463", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.220790930126687, "overlap_percentage": 0.36171784156976744, "num_intersection": 398179, "num_union": 1803421, "num_only_computed": 702621, "num_only_roped": 702621, "total_diff": 1405242, "diff_percentage": 0.779209069873313, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:04:10.846705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.19146825396825398}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:04:59.112838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19602841496325574, "overlap_percentage": 0.3277989260301614, "num_intersection": 395079, "num_union": 2015417, "num_only_computed": 810169, "num_only_roped": 810169, "total_diff": 1620338, "diff_percentage": 0.8039715850367443, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:05:00.729084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.4268867924528302}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:05:55.573036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15780059227393883, "overlap_percentage": 0.2725868225097656, "num_intersection": 357285, "num_union": 2264155, "num_only_computed": 953435, "num_only_roped": 953435, "total_diff": 1906870, "diff_percentage": 0.8421994077260612, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:05:58.889869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2001953125, "mean_diff": 0.00010061264038085938, "l2_diff": 4.4375, "l2_diff_relative": 1.0070921985815602}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:06:59.412705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14941003279287693, "overlap_percentage": 0.2599769073353835, "num_intersection": 367911, "num_union": 2462425, "num_only_computed": 1047257, "num_only_roped": 1047257, "total_diff": 2094514, "diff_percentage": 0.8505899672071231, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:07:01.486496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 8.249282836914062e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.807909604519774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:08:07.385430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14240057270993445, "overlap_percentage": 0.24930059755159314, "num_intersection": 312694, "num_union": 2195876, "num_only_computed": 941591, "num_only_roped": 941591, "total_diff": 1883182, "diff_percentage": 0.8575994272900656, "num_computed": 1254285, "num_roped": 1254285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 855, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:08:09.607930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2021484375, "mean_diff": 9.870529174804688e-05, "l2_diff": 4.625, "l2_diff_relative": 1.2542372881355932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 855, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:09:12.755280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14676015254866792, "overlap_percentage": 0.2559561425682508, "num_intersection": 16201, "num_union": 110391, "num_only_computed": 47095, "num_only_roped": 47095, "total_diff": 94190, "diff_percentage": 0.8532398474513321, "num_computed": 63296, "num_roped": 63296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:09:14.506840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.48427672955974843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:10:04.533954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1604256996452503, "overlap_percentage": 0.2764945652173913, "num_intersection": 407, "num_union": 2537, "num_only_computed": 1065, "num_only_roped": 1065, "total_diff": 2130, "diff_percentage": 0.8395743003547497, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:10:07.109607", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.10986328125, "l2_diff_relative": 0.9574468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:10:49.358617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16363636363636364, "overlap_percentage": 0.28125, "num_intersection": 414, "num_union": 2530, "num_only_computed": 1058, "num_only_roped": 1058, "total_diff": 2116, "diff_percentage": 0.8363636363636363, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:10:50.741583", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.059814453125, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.11865234375, "l2_diff_relative": 0.9274809160305344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:11:33.166954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14775828460038987, "overlap_percentage": 0.25747282608695654, "num_intersection": 379, "num_union": 2565, "num_only_computed": 1093, "num_only_roped": 1093, "total_diff": 2186, "diff_percentage": 0.8522417153996101, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:11:34.549861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014892578125, "mean_diff": 3.0159950256347656e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.18025751072961374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:11:58.777168", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:11:58.786599", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.002972146739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:12:04.592662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5111433346914289, "overlap_percentage": 0.6764988111413044, "num_intersection": 318658, "num_union": 623422, "num_only_computed": 152382, "num_only_roped": 152382, "total_diff": 304764, "diff_percentage": 0.4888566653085711, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:12:04.969492", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 9.489059448242188e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.12226277372262774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:12:19.098878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3994826998166024, "overlap_percentage": 0.5709005189831261, "num_intersection": 329131, "num_union": 823893, "num_only_computed": 247381, "num_only_roped": 247381, "total_diff": 494762, "diff_percentage": 0.6005173001833976, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:12:19.631183", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.11764705882352941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:12:38.866337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3354814732736025, "overlap_percentage": 0.5024127702067669, "num_intersection": 342123, "num_union": 1019797, "num_only_computed": 338837, "num_only_roped": 338837, "total_diff": 677674, "diff_percentage": 0.6645185267263976, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:12:39.586637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 6.008148193359375e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.14204545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:13:04.789788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31031926069277144, "overlap_percentage": 0.47365442911783856, "num_intersection": 372497, "num_union": 1200367, "num_only_computed": 413935, "num_only_roped": 413935, "total_diff": 827870, "diff_percentage": 0.6896807393072285, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:13:05.668841", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.10431985294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:13:35.886027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27256936508662066, "overlap_percentage": 0.4283764367816092, "num_intersection": 381632, "num_union": 1400128, "num_only_computed": 509248, "num_only_roped": 509248, "total_diff": 1018496, "diff_percentage": 0.7274306349133793, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:13:36.943222", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.13468992248062014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:14:12.771577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25041520204824635, "overlap_percentage": 0.4005312821502058, "num_intersection": 398660, "num_union": 1591996, "num_only_computed": 596668, "num_only_roped": 596668, "total_diff": 1193336, "diff_percentage": 0.7495847979517537, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:14:14.600020", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.1437007874015748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:14:56.084625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22212051453849352, "overlap_percentage": 0.36350018168604653, "num_intersection": 400141, "num_union": 1801459, "num_only_computed": 700659, "num_only_roped": 700659, "total_diff": 1401318, "diff_percentage": 0.7778794854615064, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:14:57.525396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.173683166503906e-05, "l2_diff": 1.6328125, "l2_diff_relative": 0.2524154589371981}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:15:43.319813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2028442363405671, "overlap_percentage": 0.33727432066795865, "num_intersection": 200317, "num_union": 987541, "num_only_computed": 393612, "num_only_roped": 393612, "total_diff": 787224, "diff_percentage": 0.7971557636594329, "num_computed": 593929, "num_roped": 593929}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 527, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:15:44.794447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.3520408163265306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 527, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:16:27.195782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1869861815637572, "overlap_percentage": 0.3150604185086944, "num_intersection": 11759, "num_union": 62887, "num_only_computed": 25564, "num_only_roped": 25564, "total_diff": 51128, "diff_percentage": 0.8130138184362428, "num_computed": 37323, "num_roped": 37323}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:16:30.100752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08642578125, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.3536184210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:05.560035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2, "overlap_percentage": 0.3333333333333333, "num_intersection": 377, "num_union": 1885, "num_only_computed": 754, "num_only_roped": 754, "total_diff": 1508, "diff_percentage": 0.8, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:06.598341", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.042724609375, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.0791015625, "l2_diff_relative": 0.7232142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:38.153080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20447284345047922, "overlap_percentage": 0.3395225464190981, "num_intersection": 384, "num_union": 1878, "num_only_computed": 747, "num_only_roped": 747, "total_diff": 1494, "diff_percentage": 0.7955271565495208, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:40.314011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 6.628036499023438e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.3581081081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:12.432080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1911532385466035, "overlap_percentage": 0.3209549071618037, "num_intersection": 363, "num_union": 1899, "num_only_computed": 768, "num_only_roped": 768, "total_diff": 1536, "diff_percentage": 0.8088467614533965, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:13.455148", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.25870646766169153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:36.178205", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:36.191904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030565137987012985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:42.065638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5087136025726027, "overlap_percentage": 0.6743673573369565, "num_intersection": 317654, "num_union": 624426, "num_only_computed": 153386, "num_only_roped": 153386, "total_diff": 306772, "diff_percentage": 0.4912863974273973, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:42.454129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 9.632110595703125e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:57.562266", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4096768080593201, "overlap_percentage": 0.5812350827042628, "num_intersection": 335089, "num_union": 817935, "num_only_computed": 241423, "num_only_roped": 241423, "total_diff": 482846, "diff_percentage": 0.5903231919406798, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:58.114069", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 9.250640869140625e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.167}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:17.858981", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3501319975295693, "overlap_percentage": 0.5186633576127819, "num_intersection": 353189, "num_union": 1008731, "num_only_computed": 327771, "num_only_roped": 327771, "total_diff": 655542, "diff_percentage": 0.6498680024704306, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:18.592617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 7.295608520507812e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.1680327868852459}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:43.908534", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2981035155814777, "overlap_percentage": 0.4592908223470052, "num_intersection": 361201, "num_union": 1211663, "num_only_computed": 425231, "num_only_roped": 425231, "total_diff": 850462, "diff_percentage": 0.7018964844185223, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:44.927702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:15.992475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26187683782910953, "overlap_percentage": 0.4150592672413793, "num_intersection": 369768, "num_union": 1411992, "num_only_computed": 521112, "num_only_roped": 521112, "total_diff": 1042224, "diff_percentage": 0.7381231621708905, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:17.071922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 5.745887756347656e-05, "l2_diff": 1.5703125, "l2_diff_relative": 0.21474358974358973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:54.024611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23489213453034974, "overlap_percentage": 0.3804253472222222, "num_intersection": 378648, "num_union": 1612008, "num_only_computed": 616680, "num_only_roped": 616680, "total_diff": 1233360, "diff_percentage": 0.7651078654696503, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:55.274518", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.4765625, "l2_diff_relative": 0.20723684210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:21:37.732665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22198010064018525, "overlap_percentage": 0.36331213662790696, "num_intersection": 399934, "num_union": 1801666, "num_only_computed": 700866, "num_only_roped": 700866, "total_diff": 1401732, "diff_percentage": 0.7780198993598147, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:21:39.196843", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 2.6941299438476562e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.13365384615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:22:27.775368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19669581336975306, "overlap_percentage": 0.3287315141779949, "num_intersection": 396203, "num_union": 2014293, "num_only_computed": 809045, "num_only_roped": 809045, "total_diff": 1618090, "diff_percentage": 0.8033041866302469, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:22:30.189838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.32207207207207206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:23:25.114249", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15680531732229294, "overlap_percentage": 0.2711006164550781, "num_intersection": 355337, "num_union": 2266103, "num_only_computed": 955383, "num_only_roped": 955383, "total_diff": 1910766, "diff_percentage": 0.843194682677707, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:23:27.013964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.104873657226562e-05, "l2_diff": 3.3125, "l2_diff_relative": 0.5792349726775956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:24:28.635606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14532395061528564, "overlap_percentage": 0.25376916380246023, "num_intersection": 359126, "num_union": 2471210, "num_only_computed": 1056042, "num_only_roped": 1056042, "total_diff": 2112084, "diff_percentage": 0.8546760493847144, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:24:31.846759", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 6.008148193359375e-05, "l2_diff": 3.15625, "l2_diff_relative": 0.51010101010101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:25:40.433944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1433326486651604, "overlap_percentage": 0.25072781544811323, "num_intersection": 381010, "num_union": 2658222, "num_only_computed": 1138606, "num_only_roped": 1138606, "total_diff": 2277212, "diff_percentage": 0.8566673513348396, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:25:42.843558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.62939453125e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.8012820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:27:00.268160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14067318534865333, "overlap_percentage": 0.24664941221644612, "num_intersection": 400827, "num_union": 2849349, "num_only_computed": 1224261, "num_only_roped": 1224261, "total_diff": 2448522, "diff_percentage": 0.8593268146513466, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:27:05.449563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 7.43865966796875e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.897887323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:28:29.125156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13743395112128134, "overlap_percentage": 0.24165614361308466, "num_intersection": 417953, "num_union": 3041119, "num_only_computed": 1311583, "num_only_roped": 1311583, "total_diff": 2623166, "diff_percentage": 0.8625660488787187, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:28:31.999094", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2421875, "mean_diff": 6.961822509765625e-05, "l2_diff": 4.125, "l2_diff_relative": 0.8741721854304636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:30:04.303406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12546037875409932, "overlap_percentage": 0.2229494367327009, "num_intersection": 409114, "num_union": 3260902, "num_only_computed": 1425894, "num_only_roped": 1425894, "total_diff": 2851788, "diff_percentage": 0.8745396212459007, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:30:07.451702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 5.602836608886719e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.6656976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:31:45.266697", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1267981785159063, "overlap_percentage": 0.2250592536152496, "num_intersection": 368334, "num_union": 2904884, "num_only_computed": 1268275, "num_only_roped": 1268275, "total_diff": 2536550, "diff_percentage": 0.8732018214840936, "num_computed": 1636609, "num_roped": 1636609}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 871, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:31:48.513593", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 5.7697296142578125e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.7961783439490446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 871, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:33:16.658733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11640728592365134, "overlap_percentage": 0.20853910108145277, "num_intersection": 13344, "num_union": 114632, "num_only_computed": 50644, "num_only_roped": 50644, "total_diff": 101288, "diff_percentage": 0.8835927140763487, "num_computed": 63988, "num_roped": 63988}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:33:19.129494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.46484375, "l2_diff_relative": 0.4160839160839161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:34:26.912261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12257679689830003, "overlap_percentage": 0.218384697130712, "num_intersection": 411, "num_union": 3353, "num_only_computed": 1471, "num_only_roped": 1471, "total_diff": 2942, "diff_percentage": 0.8774232031017, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:34:28.783260", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.05615234375, "l2_diff_relative": 0.2860696517412935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:35:26.250134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10771041789287816, "overlap_percentage": 0.1944739638682253, "num_intersection": 366, "num_union": 3398, "num_only_computed": 1516, "num_only_roped": 1516, "total_diff": 3032, "diff_percentage": 0.8922895821071218, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:35:28.126078", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.3104575163398693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:36:26.397190", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11163614884819846, "overlap_percentage": 0.20085015940488843, "num_intersection": 378, "num_union": 3386, "num_only_computed": 1504, "num_only_roped": 1504, "total_diff": 3008, "diff_percentage": 0.8883638511518015, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:36:29.242857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.11702127659574468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:37:28.400132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12458918434418882, "overlap_percentage": 0.22157279489904358, "num_intersection": 417, "num_union": 3347, "num_only_computed": 1465, "num_only_roped": 1465, "total_diff": 2930, "diff_percentage": 0.8754108156558111, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:37:30.339687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.04931640625, "l2_diff_relative": 0.20781893004115226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:38:29.853842", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11651348947524459, "overlap_percentage": 0.20870950610727562, "num_intersection": 393, "num_union": 3373, "num_only_computed": 1490, "num_only_roped": 1490, "total_diff": 2980, "diff_percentage": 0.8834865105247555, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:38:33.353205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.07958984375, "l2_diff_relative": 0.4453551912568306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:39:33.067834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11486086441681469, "overlap_percentage": 0.2060541688794477, "num_intersection": 388, "num_union": 3378, "num_only_computed": 1495, "num_only_roped": 1495, "total_diff": 2990, "diff_percentage": 0.8851391355831854, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:39:34.999976", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012939453125, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:34.578276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12350835322195704, "overlap_percentage": 0.21986192246415295, "num_intersection": 414, "num_union": 3352, "num_only_computed": 1469, "num_only_roped": 1469, "total_diff": 2938, "diff_percentage": 0.8764916467780429, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:36.460278", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.1096311475409836}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:11.775171", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:11.787743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0029829545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:17.635148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5049249358624149, "overlap_percentage": 0.6710300611413044, "num_intersection": 316082, "num_union": 625998, "num_only_computed": 154958, "num_only_roped": 154958, "total_diff": 309916, "diff_percentage": 0.4950750641375851, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:18.029001", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 9.965896606445312e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.12237762237762238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:32.473406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40068295539166676, "overlap_percentage": 0.5721251248889876, "num_intersection": 329837, "num_union": 823187, "num_only_computed": 246675, "num_only_roped": 246675, "total_diff": 493350, "diff_percentage": 0.5993170446083332, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:33.011328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 6.4849853515625e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.11472602739726027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:53.482057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34960084350052717, "overlap_percentage": 0.5180803571428572, "num_intersection": 352792, "num_union": 1009128, "num_only_computed": 328168, "num_only_roped": 328168, "total_diff": 656336, "diff_percentage": 0.6503991564994728, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:56.700946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.07628676470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:42:23.522392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3006669285315582, "overlap_percentage": 0.4623273213704427, "num_intersection": 363589, "num_union": 1209275, "num_only_computed": 422843, "num_only_roped": 422843, "total_diff": 845686, "diff_percentage": 0.6993330714684418, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:42:24.942612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.08902877697841727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:42:56.162073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2605261389241637, "overlap_percentage": 0.4133609464798851, "num_intersection": 368255, "num_union": 1413505, "num_only_computed": 522625, "num_only_roped": 522625, "total_diff": 1045250, "diff_percentage": 0.7394738610758363, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:42:57.248834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.09639084507042253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:43:34.170522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23638698954510362, "overlap_percentage": 0.3823834956918724, "num_intersection": 380597, "num_union": 1610059, "num_only_computed": 614731, "num_only_roped": 614731, "total_diff": 1229462, "diff_percentage": 0.7636130104548964, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:43:35.434002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.16702586206896552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:44:18.590515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20999011277156215, "overlap_percentage": 0.3470939316860465, "num_intersection": 382081, "num_union": 1819519, "num_only_computed": 718719, "num_only_roped": 718719, "total_diff": 1437438, "diff_percentage": 0.7900098872284378, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:44:20.145119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.19292237442922375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:45:11.046895", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1905406560060295, "overlap_percentage": 0.32009096882965166, "num_intersection": 385789, "num_union": 2024707, "num_only_computed": 819459, "num_only_roped": 819459, "total_diff": 1638918, "diff_percentage": 0.8094593439939705, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:45:12.794065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.009506225585938e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.4869791666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:46:10.008334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16251966771975074, "overlap_percentage": 0.2795989990234375, "num_intersection": 366476, "num_union": 2254964, "num_only_computed": 944244, "num_only_roped": 944244, "total_diff": 1888488, "diff_percentage": 0.8374803322802493, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:46:11.987086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 9.679794311523438e-05, "l2_diff": 4.53125, "l2_diff_relative": 0.9119496855345912}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:47:15.565265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15313013219495283, "overlap_percentage": 0.26559037513567296, "num_intersection": 375855, "num_union": 2454481, "num_only_computed": 1039313, "num_only_roped": 1039313, "total_diff": 2078626, "diff_percentage": 0.8468698678050471, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:47:17.779223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.62939453125e-05, "l2_diff": 4.25, "l2_diff_relative": 0.7771428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:48:27.456724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14411254286800607, "overlap_percentage": 0.2519202219508086, "num_intersection": 382822, "num_union": 2656410, "num_only_computed": 1136794, "num_only_roped": 1136794, "total_diff": 2273588, "diff_percentage": 0.8558874571319939, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:48:29.858833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 7.534027099609375e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.7988165680473372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:49:45.666147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14552488808827888, "overlap_percentage": 0.25407547160523, "num_intersection": 412895, "num_union": 2837281, "num_only_computed": 1212193, "num_only_roped": 1212193, "total_diff": 2424386, "diff_percentage": 0.8544751119117211, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:49:48.266520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.486343383789062e-05, "l2_diff": 3.96875, "l2_diff_relative": 0.8943661971830986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:51:11.028570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14244835557246568, "overlap_percentage": 0.2493738204928952, "num_intersection": 431301, "num_union": 3027771, "num_only_computed": 1298235, "num_only_roped": 1298235, "total_diff": 2596470, "diff_percentage": 0.8575516444275343, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:51:13.876280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 7.295608520507812e-05, "l2_diff": 4.40625, "l2_diff_relative": 0.9463087248322147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:52:45.350507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13064221121844805, "overlap_percentage": 0.23109381539481028, "num_intersection": 424059, "num_union": 3245957, "num_only_computed": 1410949, "num_only_roped": 1410949, "total_diff": 2821898, "diff_percentage": 0.8693577887815519, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:52:48.450181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.20703125, "mean_diff": 6.914138793945312e-05, "l2_diff": 4.34375, "l2_diff_relative": 0.9858156028368794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:54:22.724723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13056206377783808, "overlap_percentage": 0.23096841466899645, "num_intersection": 211756, "num_union": 1621880, "num_only_computed": 705062, "num_only_roped": 705062, "total_diff": 1410124, "diff_percentage": 0.8694379362221619, "num_computed": 916818, "num_roped": 916818}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 498, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:54:25.788313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.875, "l2_diff_relative": 0.8177777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 498, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:55:49.417875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1222321052385188, "overlap_percentage": 0.217837477056566, "num_intersection": 10444, "num_union": 85444, "num_only_computed": 37500, "num_only_roped": 37500, "total_diff": 75000, "diff_percentage": 0.8777678947614812, "num_computed": 47944, "num_roped": 47944}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:55:51.733459", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.40234375, "l2_diff_relative": 0.40551181102362205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:56:57.048459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1233627779469997, "overlap_percentage": 0.21963123644251628, "num_intersection": 405, "num_union": 3283, "num_only_computed": 1439, "num_only_roped": 1439, "total_diff": 2878, "diff_percentage": 0.8766372220530003, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:56:58.858668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.06103515625, "l2_diff_relative": 0.3980891719745223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:57:55.664338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11656070239176507, "overlap_percentage": 0.20878524945770066, "num_intersection": 385, "num_union": 3303, "num_only_computed": 1459, "num_only_roped": 1459, "total_diff": 2918, "diff_percentage": 0.8834392976082349, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 1, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:57:58.504239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 4.315376281738281e-05, "l2_diff": 0.064453125, "l2_diff_relative": 0.37714285714285717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 1, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:58:31.394343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:58:31.406958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.002877058383233533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:58:37.191375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.51009449311138, "overlap_percentage": 0.6755795686141305, "num_intersection": 318225, "num_union": 623855, "num_only_computed": 152815, "num_only_roped": 152815, "total_diff": 305630, "diff_percentage": 0.48990550688861995, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:58:39.953092", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 9.72747802734375e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.12410071942446044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:58:54.090426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40549607005636495, "overlap_percentage": 0.5770148756660746, "num_intersection": 332656, "num_union": 820368, "num_only_computed": 243856, "num_only_roped": 243856, "total_diff": 487712, "diff_percentage": 0.5945039299436351, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:58:54.621490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 9.34600830078125e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.16265060240963855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:59:14.002271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3497934555949351, "overlap_percentage": 0.5182918233082707, "num_intersection": 352936, "num_union": 1008984, "num_only_computed": 328024, "num_only_roped": 328024, "total_diff": 656048, "diff_percentage": 0.6502065444050649, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:59:14.709049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.1676829268292683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:59:39.478940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3047193781267653, "overlap_percentage": 0.4671033223470052, "num_intersection": 367345, "num_union": 1205519, "num_only_computed": 419087, "num_only_roped": 419087, "total_diff": 838174, "diff_percentage": 0.6952806218732347, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:59:40.362472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.555152893066406e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.15588235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:00:10.820436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2590244002399676, "overlap_percentage": 0.411468435704023, "num_intersection": 366569, "num_union": 1415191, "num_only_computed": 524311, "num_only_roped": 524311, "total_diff": 1048622, "diff_percentage": 0.7409755997600324, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:00:11.888771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.2053191489361702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:00:48.641981", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23747531304335392, "overlap_percentage": 0.3838061422968107, "num_intersection": 382013, "num_union": 1608643, "num_only_computed": 613315, "num_only_roped": 613315, "total_diff": 1226630, "diff_percentage": 0.7625246869566461, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:00:49.903338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.19767441860465115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:01:32.700190", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22946745786829018, "overlap_percentage": 0.3732794331395349, "num_intersection": 410906, "num_union": 1790694, "num_only_computed": 689894, "num_only_roped": 689894, "total_diff": 1379788, "diff_percentage": 0.7705325421317099, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:01:34.154114", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 3.0159950256347656e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.14298561151079137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:02:22.311003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1910842219743915, "overlap_percentage": 0.32085761602591334, "num_intersection": 386713, "num_union": 2023783, "num_only_computed": 818535, "num_only_roped": 818535, "total_diff": 1637070, "diff_percentage": 0.8089157780256084, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:02:23.952830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.375, "l2_diff_relative": 0.41304347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:03:18.688549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15702027027623472, "overlap_percentage": 0.27142181396484377, "num_intersection": 355758, "num_union": 2265682, "num_only_computed": 954962, "num_only_roped": 954962, "total_diff": 1909924, "diff_percentage": 0.8429797297237653, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:03:20.594975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.609375, "l2_diff_relative": 0.6637931034482759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:04:21.835454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15032892250142046, "overlap_percentage": 0.26136684831765555, "num_intersection": 369878, "num_union": 2460458, "num_only_computed": 1045290, "num_only_roped": 1045290, "total_diff": 2090580, "diff_percentage": 0.8496710774985795, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:04:26.120415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 8.7738037109375e-05, "l2_diff": 4.3125, "l2_diff_relative": 0.9517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:05:34.836019", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14589064234351623, "overlap_percentage": 0.25463274932614555, "num_intersection": 386944, "num_union": 2652288, "num_only_computed": 1132672, "num_only_roped": 1132672, "total_diff": 2265344, "diff_percentage": 0.8541093576564838, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:05:37.211615", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.20703125, "mean_diff": 7.963180541992188e-05, "l2_diff": 4.3125, "l2_diff_relative": 0.8789808917197452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:06:52.412593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.142540964906206, "overlap_percentage": 0.24951571853339635, "num_intersection": 405485, "num_union": 2844691, "num_only_computed": 1219603, "num_only_roped": 1219603, "total_diff": 2439206, "diff_percentage": 0.8574590350937941, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:06:57.107151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.310546875, "mean_diff": 8.58306884765625e-05, "l2_diff": 4.8125, "l2_diff_relative": 1.1407407407407408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:08:20.009301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13684517733298188, "overlap_percentage": 0.2407454947454115, "num_intersection": 416378, "num_union": 3042694, "num_only_computed": 1313158, "num_only_roped": 1313158, "total_diff": 2626316, "diff_percentage": 0.8631548226670182, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:08:22.823920", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 7.05718994140625e-05, "l2_diff": 4.0625, "l2_diff_relative": 0.9154929577464789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:54.197262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12633079853743362, "overlap_percentage": 0.2243227277483259, "num_intersection": 411634, "num_union": 3258382, "num_only_computed": 1423374, "num_only_roped": 1423374, "total_diff": 2846748, "diff_percentage": 0.8736692014625664, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:57.524617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.389617919921875e-05, "l2_diff": 4.1875, "l2_diff_relative": 0.8271604938271605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:11:25.610273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12374428907176184, "overlap_percentage": 0.2202356715405022, "num_intersection": 35698, "num_union": 288482, "num_only_computed": 126392, "num_only_roped": 126392, "total_diff": 252784, "diff_percentage": 0.8762557109282382, "num_computed": 162090, "num_roped": 162090}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:11:29.350190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.6772727272727272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:12:47.611631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11467744359646632, "overlap_percentage": 0.20575897405165697, "num_intersection": 13734, "num_union": 119762, "num_only_computed": 53014, "num_only_roped": 53014, "total_diff": 106028, "diff_percentage": 0.8853225564035336, "num_computed": 66748, "num_roped": 66748}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:12:52.046143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.6640625, "l2_diff_relative": 0.7142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:13:58.276129", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11668214175177964, "overlap_percentage": 0.208980044345898, "num_intersection": 377, "num_union": 3231, "num_only_computed": 1427, "num_only_roped": 1427, "total_diff": 2854, "diff_percentage": 0.8833178582482204, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:14:02.536014", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 7.62939453125e-05, "l2_diff": 0.11962890625, "l2_diff_relative": 1.3687150837988826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:14:56.592935", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1275, "overlap_percentage": 0.2261640798226164, "num_intersection": 408, "num_union": 3200, "num_only_computed": 1396, "num_only_roped": 1396, "total_diff": 2792, "diff_percentage": 0.8725, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:14:58.356943", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.09423828125, "l2_diff_relative": 0.5676470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:15:52.341190", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1260137242669994, "overlap_percentage": 0.22382271468144044, "num_intersection": 404, "num_union": 3206, "num_only_computed": 1401, "num_only_roped": 1401, "total_diff": 2802, "diff_percentage": 0.8739862757330006, "num_computed": 1805, "num_roped": 1805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:15:54.080210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.059326171875, "l2_diff_relative": 0.23011363636363635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:24.764416", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:24.773803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.029052734375, "l2_diff_relative": 0.0030784354304635763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:30.553404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5214421142050575, "overlap_percentage": 0.6854577105978261, "num_intersection": 322878, "num_union": 619202, "num_only_computed": 148162, "num_only_roped": 148162, "total_diff": 296324, "diff_percentage": 0.4785578857949425, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:32.063584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 0.00011110305786132812, "l2_diff": 1.1953125, "l2_diff_relative": 0.13660714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:46.246957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4251614242912658, "overlap_percentage": 0.5966501998223801, "num_intersection": 343976, "num_union": 809048, "num_only_computed": 232536, "num_only_roped": 232536, "total_diff": 465072, "diff_percentage": 0.5748385757087342, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:46.790694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1392156862745098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:17:06.178701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34592635709859737, "overlap_percentage": 0.5140345982142858, "num_intersection": 350037, "num_union": 1011883, "num_only_computed": 330923, "num_only_roped": 330923, "total_diff": 661846, "diff_percentage": 0.6540736429014027, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:17:06.888807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.83984375, "l2_diff_relative": 0.09331597222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:17:31.630062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29853112120891895, "overlap_percentage": 0.4597981770833333, "num_intersection": 361600, "num_union": 1211264, "num_only_computed": 424832, "num_only_roped": 424832, "total_diff": 849664, "diff_percentage": 0.7014688787910811, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:17:32.514690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.13516260162601626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:18:02.956603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2722840360400502, "overlap_percentage": 0.42802397629310346, "num_intersection": 381318, "num_union": 1400442, "num_only_computed": 509562, "num_only_roped": 509562, "total_diff": 1019124, "diff_percentage": 0.7277159639599498, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:18:04.017731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.153921568627451}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:18:42.535195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24433420678895046, "overlap_percentage": 0.3927147633744856, "num_intersection": 390880, "num_union": 1599776, "num_only_computed": 604448, "num_only_roped": 604448, "total_diff": 1208896, "diff_percentage": 0.7556657932110495, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:18:43.757381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.875, "l2_diff_relative": 0.10071942446043165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:19:25.557216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22175970912174367, "overlap_percentage": 0.3630168968023256, "num_intersection": 399609, "num_union": 1801991, "num_only_computed": 701191, "num_only_roped": 701191, "total_diff": 1402382, "diff_percentage": 0.7782402908782563, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:19:27.012977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.16495901639344263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:20:17.575899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18882908155464875, "overlap_percentage": 0.31767237946049276, "num_intersection": 382874, "num_union": 2027622, "num_only_computed": 822374, "num_only_roped": 822374, "total_diff": 1644748, "diff_percentage": 0.8111709184453513, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:20:19.256736", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 5.412101745605469e-05, "l2_diff": 2.125, "l2_diff_relative": 0.3417085427135678}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:21:13.280464", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15857838316829714, "overlap_percentage": 0.2737464904785156, "num_intersection": 358805, "num_union": 2262635, "num_only_computed": 951915, "num_only_roped": 951915, "total_diff": 1903830, "diff_percentage": 0.8414216168317029, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:21:15.176816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 8.106231689453125e-05, "l2_diff": 3.859375, "l2_diff_relative": 0.7180232558139535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:22:08.053988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14794736842105263, "overlap_percentage": 0.25775984594929163, "num_intersection": 11244, "num_union": 76000, "num_only_computed": 32378, "num_only_roped": 32378, "total_diff": 64756, "diff_percentage": 0.8520526315789474, "num_computed": 43622, "num_roped": 43622}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "mask_shape": [1, 32, 34, 10274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:22:09.446695", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.32421875, "l2_diff_relative": 0.23184357541899442}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "attention_shape": [1, 32, 34, 10274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:22:53.506630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15316964606217245, "overlap_percentage": 0.2656498054474708, "num_intersection": 8534, "num_union": 55716, "num_only_computed": 23591, "num_only_roped": 23591, "total_diff": 47182, "diff_percentage": 0.8468303539378276, "num_computed": 32125, "num_roped": 32125}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 25, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:22:56.734516", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 7.2479248046875e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.46356275303643724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 25, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:23:37.399957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15960324616771868, "overlap_percentage": 0.27527216174183516, "num_intersection": 354, "num_union": 2218, "num_only_computed": 932, "num_only_roped": 932, "total_diff": 1864, "diff_percentage": 0.8403967538322813, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "mask_shape": [1, 32, 1, 10300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:23:38.572296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 9.72747802734375e-05, "l2_diff": 0.09228515625, "l2_diff_relative": 1.0738636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "attention_shape": [1, 32, 1, 10300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:15.064072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15699505173189385, "overlap_percentage": 0.2713841368584759, "num_intersection": 349, "num_union": 2223, "num_only_computed": 937, "num_only_roped": 937, "total_diff": 1874, "diff_percentage": 0.8430049482681061, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "mask_shape": [1, 32, 1, 10301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:16.697461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 6.008148193359375e-05, "l2_diff": 0.05859375, "l2_diff_relative": 0.40816326530612246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "attention_shape": [1, 32, 1, 10301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:41.333076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:41.346794", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.032470703125, "l2_diff_relative": 0.00326749213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:47.183425", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5015261031374768, "overlap_percentage": 0.6680218240489131, "num_intersection": 314665, "num_union": 627415, "num_only_computed": 156375, "num_only_roped": 156375, "total_diff": 312750, "diff_percentage": 0.4984738968625232, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:47.571747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 0.00011587142944335938, "l2_diff": 1.1171875, "l2_diff_relative": 0.15084388185654007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:25:02.043834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39398724038585925, "overlap_percentage": 0.5652666379884547, "num_intersection": 325883, "num_union": 827141, "num_only_computed": 250629, "num_only_roped": 250629, "total_diff": 501258, "diff_percentage": 0.6060127596141408, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:25:02.600123", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.1551383399209486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:25:23.010080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33556398041057767, "overlap_percentage": 0.5025052866541353, "num_intersection": 342186, "num_union": 1019734, "num_only_computed": 338774, "num_only_roped": 338774, "total_diff": 677548, "diff_percentage": 0.6644360195894223, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:25:23.717021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 6.103515625e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.13777372262773724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:25:48.887355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29072452588647535, "overlap_percentage": 0.45048268636067706, "num_intersection": 354274, "num_union": 1218590, "num_only_computed": 432158, "num_only_roped": 432158, "total_diff": 864316, "diff_percentage": 0.7092754741135247, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:25:49.779152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.16765873015873015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:26:20.533743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2704696522209118, "overlap_percentage": 0.4257790050287356, "num_intersection": 379318, "num_union": 1402442, "num_only_computed": 511562, "num_only_roped": 511562, "total_diff": 1023124, "diff_percentage": 0.7295303477790882, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:26:23.712785", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.18}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:27:00.107781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2539036147765732, "overlap_percentage": 0.40498107156635804, "num_intersection": 403089, "num_union": 1587567, "num_only_computed": 592239, "num_only_roped": 592239, "total_diff": 1184478, "diff_percentage": 0.7460963852234268, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:27:03.630782", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.19978165938864628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:27:45.809818", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21440986443245258, "overlap_percentage": 0.3531095566860465, "num_intersection": 388703, "num_union": 1812897, "num_only_computed": 712097, "num_only_roped": 712097, "total_diff": 1424194, "diff_percentage": 0.7855901355675474, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:27:47.279696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.2002262443438914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:28:35.958442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18963053039694885, "overlap_percentage": 0.3188057561597281, "num_intersection": 384240, "num_union": 2026256, "num_only_computed": 821008, "num_only_roped": 821008, "total_diff": 1642016, "diff_percentage": 0.8103694696030511, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:28:39.998343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12158203125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.39037433155080214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:35.858858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1655491100229736, "overlap_percentage": 0.2840705871582031, "num_intersection": 372337, "num_union": 2249103, "num_only_computed": 938383, "num_only_roped": 938383, "total_diff": 1876766, "diff_percentage": 0.8344508899770264, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:37.764453", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 8.535385131835938e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.8027210884353742}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:30:40.016640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1556217180462594, "overlap_percentage": 0.2693298604829957, "num_intersection": 381147, "num_union": 2449189, "num_only_computed": 1034021, "num_only_roped": 1034021, "total_diff": 2068042, "diff_percentage": 0.8443782819537407, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:30:43.479476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.392333984375e-05, "l2_diff": 4.375, "l2_diff_relative": 0.8860759493670886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:31:52.177579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14453866260754886, "overlap_percentage": 0.252571044263814, "num_intersection": 383811, "num_union": 2655421, "num_only_computed": 1135805, "num_only_roped": 1135805, "total_diff": 2271610, "diff_percentage": 0.8554613373924511, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:31:54.531999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 8.0108642578125e-05, "l2_diff": 4.28125, "l2_diff_relative": 0.9319727891156463}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:33:10.627953", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14361676486577304, "overlap_percentage": 0.25116239859010714, "num_intersection": 408161, "num_union": 2842015, "num_only_computed": 1216927, "num_only_roped": 1216927, "total_diff": 2433854, "diff_percentage": 0.856383235134227, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:33:13.746655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.05718994140625e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.808641975308642}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:34:37.355121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13839449237844462, "overlap_percentage": 0.2431397785301954, "num_intersection": 420519, "num_union": 3038553, "num_only_computed": 1309017, "num_only_roped": 1309017, "total_diff": 2618034, "diff_percentage": 0.8616055076215554, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:34:40.411982", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 5.412101745605469e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.5790960451977402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:36:10.371498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13102514809584886, "overlap_percentage": 0.2316927228655134, "num_intersection": 425158, "num_union": 3244858, "num_only_computed": 1409850, "num_only_roped": 1409850, "total_diff": 2819700, "diff_percentage": 0.8689748519041511, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:36:15.005216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 5.7697296142578125e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.7380952380952381}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:37:51.058258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12985512173861147, "overlap_percentage": 0.22986154461784714, "num_intersection": 359015, "num_union": 2764735, "num_only_computed": 1202860, "num_only_roped": 1202860, "total_diff": 2405720, "diff_percentage": 0.8701448782613885, "num_computed": 1561875, "num_roped": 1561875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "mask_shape": [1, 32, 833, 16193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:37:54.306521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 5.745887756347656e-05, "l2_diff": 3.046875, "l2_diff_relative": 0.75}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "attention_shape": [1, 32, 833, 16193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:39:22.108865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13174572883500899, "overlap_percentage": 0.2328186013489528, "num_intersection": 13117, "num_union": 99563, "num_only_computed": 43223, "num_only_roped": 43223, "total_diff": 86446, "diff_percentage": 0.868254271164991, "num_computed": 56340, "num_roped": 56340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "mask_shape": [1, 32, 30, 16223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:39:24.987090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.5, "l2_diff_relative": 0.5079365079365079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "attention_shape": [1, 32, 30, 16223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:40:32.238498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14233576642335766, "overlap_percentage": 0.24920127795527156, "num_intersection": 468, "num_union": 3288, "num_only_computed": 1410, "num_only_roped": 1410, "total_diff": 2820, "diff_percentage": 0.8576642335766423, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "mask_shape": [1, 32, 1, 16224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:40:35.209033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.36813186813186816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "attention_shape": [1, 32, 1, 16224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:41:31.777161", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1323485076876696, "overlap_percentage": 0.23375931842385517, "num_intersection": 439, "num_union": 3317, "num_only_computed": 1439, "num_only_roped": 1439, "total_diff": 2878, "diff_percentage": 0.8676514923123304, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "mask_shape": [1, 32, 1, 16225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:41:33.580237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.06103515625, "l2_diff_relative": 0.3531073446327684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "attention_shape": [1, 32, 1, 16225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:06.202653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:06.214131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.00312234268707483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:11.926686", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5084623636975005, "overlap_percentage": 0.6741465692934783, "num_intersection": 317550, "num_union": 624530, "num_only_computed": 153490, "num_only_roped": 153490, "total_diff": 306980, "diff_percentage": 0.49153763630249947, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:12.306244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.75, "l2_diff_relative": 0.08888888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:26.453499", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40223477275270103, "overlap_percentage": 0.5737053174955595, "num_intersection": 330748, "num_union": 822276, "num_only_computed": 245764, "num_only_roped": 245764, "total_diff": 491528, "diff_percentage": 0.597765227247299, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:26.987036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.10495780590717299}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:47.010361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3240662694234529, "overlap_percentage": 0.4895015859962406, "num_intersection": 333331, "num_union": 1028589, "num_only_computed": 347629, "num_only_roped": 347629, "total_diff": 695258, "diff_percentage": 0.675933730576547, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:42:47.718090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.06590136054421769}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:43:12.288148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28692265523363797, "overlap_percentage": 0.44590504964192706, "num_intersection": 350674, "num_union": 1222190, "num_only_computed": 435758, "num_only_roped": 435758, "total_diff": 871516, "diff_percentage": 0.713077344766362, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:43:13.157615", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.814697265625e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.1125886524822695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:43:43.234695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25776325170653885, "overlap_percentage": 0.40987562859195403, "num_intersection": 365150, "num_union": 1416610, "num_only_computed": 525730, "num_only_roped": 525730, "total_diff": 1051460, "diff_percentage": 0.7422367482934612, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:43:46.108869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.315376281738281e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.1581439393939394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:44:21.801603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24343336862520965, "overlap_percentage": 0.3915503231095679, "num_intersection": 389721, "num_union": 1600935, "num_only_computed": 605607, "num_only_roped": 605607, "total_diff": 1211214, "diff_percentage": 0.7565666313747904, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:44:23.049306", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.16316793893129772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:45:04.847166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22392298002119185, "overlap_percentage": 0.3659102470930233, "num_intersection": 402794, "num_union": 1798806, "num_only_computed": 698006, "num_only_roped": 698006, "total_diff": 1396012, "diff_percentage": 0.7760770199788082, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:45:08.388058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.1450381679389313}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:45:55.878407", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2089279767612613, "overlap_percentage": 0.34564172684791844, "num_intersection": 416584, "num_union": 1993912, "num_only_computed": 788664, "num_only_roped": 788664, "total_diff": 1577328, "diff_percentage": 0.7910720232387387, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:45:57.498873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11474609375, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.3380952380952381}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:46:51.097349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16999791569127415, "overlap_percentage": 0.29059524536132814, "num_intersection": 380889, "num_union": 2240551, "num_only_computed": 929831, "num_only_roped": 929831, "total_diff": 1859662, "diff_percentage": 0.8300020843087258, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:46:52.981026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.677078247070312e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:47:53.552773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1620826647703291, "overlap_percentage": 0.27895203961649784, "num_intersection": 394764, "num_union": 2435572, "num_only_computed": 1020404, "num_only_roped": 1020404, "total_diff": 2040808, "diff_percentage": 0.8379173352296709, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:47:55.675786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.152557373046875e-05, "l2_diff": 3.59375, "l2_diff_relative": 0.672514619883041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:49:02.257881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1621110927569032, "overlap_percentage": 0.2789941405211498, "num_intersection": 393531, "num_union": 2427539, "num_only_computed": 1017004, "num_only_roped": 1017004, "total_diff": 2034008, "diff_percentage": 0.8378889072430968, "num_computed": 1410535, "num_roped": 1410535}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "mask_shape": [1, 32, 955, 12219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:49:04.703308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.295608520507812e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.7953020134228188}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "attention_shape": [1, 32, 955, 12219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:50:06.623226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16725818263759787, "overlap_percentage": 0.2865830115830116, "num_intersection": 11876, "num_union": 71004, "num_only_computed": 29564, "num_only_roped": 29564, "total_diff": 59128, "diff_percentage": 0.8327418173624022, "num_computed": 41440, "num_roped": 41440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "mask_shape": [1, 32, 28, 12247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:50:08.367421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.340576171875e-05, "l2_diff": 0.326171875, "l2_diff_relative": 0.29401408450704225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "attention_shape": [1, 32, 28, 12247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:50:58.659344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17740652346857597, "overlap_percentage": 0.3013513513513513, "num_intersection": 446, "num_union": 2514, "num_only_computed": 1034, "num_only_roped": 1034, "total_diff": 2068, "diff_percentage": 0.822593476531424, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "mask_shape": [1, 32, 1, 12248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:00.094586", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.5461538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "attention_shape": [1, 32, 1, 12248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:44.173783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17042309213127718, "overlap_percentage": 0.29121621621621624, "num_intersection": 431, "num_union": 2529, "num_only_computed": 1049, "num_only_roped": 1049, "total_diff": 2098, "diff_percentage": 0.8295769078687228, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "mask_shape": [1, 32, 1, 12249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:46.113364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.06689453125, "l2_diff_relative": 0.5150375939849624}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "attention_shape": [1, 32, 1, 12249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:52:31.930118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1726049089469517, "overlap_percentage": 0.29439567859554355, "num_intersection": 436, "num_union": 2526, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8273950910530483, "num_computed": 1481, "num_roped": 1481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "mask_shape": [1, 32, 1, 12250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:52:33.369866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.16046511627906976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "attention_shape": [1, 32, 1, 12250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:52:57.822375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:52:57.830864", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.0030423677884615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:03.838512", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5096976213865283, "overlap_percentage": 0.6752314028532609, "num_intersection": 318061, "num_union": 624019, "num_only_computed": 152979, "num_only_roped": 152979, "total_diff": 305958, "diff_percentage": 0.4903023786134717, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:04.227122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 7.62939453125e-05, "l2_diff": 0.8203125, "l2_diff_relative": 0.10096153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:18.707645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4061182553764916, "overlap_percentage": 0.5776445243117229, "num_intersection": 333019, "num_union": 820005, "num_only_computed": 243493, "num_only_roped": 243493, "total_diff": 486986, "diff_percentage": 0.5938817446235084, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:19.277341", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.06825657894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:38.924518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3351175158689312, "overlap_percentage": 0.5020045230263158, "num_intersection": 341845, "num_union": 1020075, "num_only_computed": 339115, "num_only_roped": 339115, "total_diff": 678230, "diff_percentage": 0.6648824841310688, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:39.650873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.16043307086614172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:54:05.427756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29010942681543445, "overlap_percentage": 0.44974390665690106, "num_intersection": 353693, "num_union": 1219171, "num_only_computed": 432739, "num_only_roped": 432739, "total_diff": 865478, "diff_percentage": 0.7098905731845656, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:54:06.331254", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 4.696846008300781e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.13911290322580644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:54:37.366212", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25846417025881097, "overlap_percentage": 0.4107612697557471, "num_intersection": 365939, "num_union": 1415821, "num_only_computed": 524941, "num_only_roped": 524941, "total_diff": 1049882, "diff_percentage": 0.741535829741189, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:54:38.452164", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.16830708661417323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:55:08.542759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30437221477764964, "overlap_percentage": 0.4666953363914373, "num_intersection": 9767, "num_union": 32089, "num_only_computed": 11161, "num_only_roped": 11161, "total_diff": 22322, "diff_percentage": 0.6956277852223504, "num_computed": 20928, "num_roped": 20928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "mask_shape": [1, 32, 24, 6168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:55:09.347631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.07373046875, "l2_diff_relative": 0.05185439560439561}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "attention_shape": [1, 32, 24, 6168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:55:35.491799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2790728027356496, "overlap_percentage": 0.4363673469387755, "num_intersection": 10691, "num_union": 38309, "num_only_computed": 13809, "num_only_roped": 13809, "total_diff": 27618, "diff_percentage": 0.7209271972643504, "num_computed": 24500, "num_roped": 24500}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "mask_shape": [1, 32, 28, 6196], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:55:36.428623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.24609375, "l2_diff_relative": 0.21428571428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "attention_shape": [1, 32, 28, 6196]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:01.423171", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26811594202898553, "overlap_percentage": 0.4228571428571429, "num_intersection": 370, "num_union": 1380, "num_only_computed": 505, "num_only_roped": 505, "total_diff": 1010, "diff_percentage": 0.7318840579710145, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "mask_shape": [1, 32, 1, 6197], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:02.155187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.841255187988281e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.22096774193548388}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "attention_shape": [1, 32, 1, 6197]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:24.983653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28771155261221487, "overlap_percentage": 0.44685714285714284, "num_intersection": 391, "num_union": 1359, "num_only_computed": 484, "num_only_roped": 484, "total_diff": 968, "diff_percentage": 0.7122884473877852, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "mask_shape": [1, 32, 1, 6198], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:25.725858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.05615234375, "l2_diff_relative": 0.38333333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "attention_shape": [1, 32, 1, 6198]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:48.618796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26262626262626265, "overlap_percentage": 0.416, "num_intersection": 364, "num_union": 1386, "num_only_computed": 511, "num_only_roped": 511, "total_diff": 1022, "diff_percentage": 0.7373737373737373, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "mask_shape": [1, 32, 1, 6199], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:49.475425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 3.6716461181640625e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.11972573839662447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "attention_shape": [1, 32, 1, 6199]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:07.016566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:07.030179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031494140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:12.894260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5199913519513774, "overlap_percentage": 0.6842030400815218, "num_intersection": 322287, "num_union": 619793, "num_only_computed": 148753, "num_only_roped": 148753, "total_diff": 297506, "diff_percentage": 0.4800086480486227, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:13.273880", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.0625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:30.170469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4028079908509137, "overlap_percentage": 0.5742881327708703, "num_intersection": 331084, "num_union": 821940, "num_only_computed": 245428, "num_only_roped": 245428, "total_diff": 490856, "diff_percentage": 0.5971920091490863, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:30.729374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1297709923664122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:50.920740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34360001381167776, "overlap_percentage": 0.511461759868421, "num_intersection": 348285, "num_union": 1013635, "num_only_computed": 332675, "num_only_roped": 332675, "total_diff": 665350, "diff_percentage": 0.6563999861883222, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:51.630707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.14807692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:58:16.928106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3035385886586481, "overlap_percentage": 0.4657147725423177, "num_intersection": 366253, "num_union": 1206611, "num_only_computed": 420179, "num_only_roped": 420179, "total_diff": 840358, "diff_percentage": 0.696461411341352, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:58:17.827935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 5.14984130859375e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.1432806324110672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:58:48.776849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2725493697103882, "overlap_percentage": 0.42835174209770116, "num_intersection": 381610, "num_union": 1400150, "num_only_computed": 509270, "num_only_roped": 509270, "total_diff": 1018540, "diff_percentage": 0.7274506302896119, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:58:49.842958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 5.221366882324219e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.19707207207207209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:59:28.314201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2479443913668199, "overlap_percentage": 0.39736448688271603, "num_intersection": 395508, "num_union": 1595148, "num_only_computed": 599820, "num_only_roped": 599820, "total_diff": 1199640, "diff_percentage": 0.7520556086331801, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:59:29.591369", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.17725409836065573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:00:12.189286", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2219882396953022, "overlap_percentage": 0.3633230377906977, "num_intersection": 399946, "num_union": 1801654, "num_only_computed": 700854, "num_only_roped": 700854, "total_diff": 1401708, "diff_percentage": 0.7780117603046978, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:00:16.159737", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.814697265625e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.181640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:06.247597", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1843408313049733, "overlap_percentage": 0.3112969281011045, "num_intersection": 375190, "num_union": 2035306, "num_only_computed": 830058, "num_only_roped": 830058, "total_diff": 1660116, "diff_percentage": 0.8156591686950267, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:10.030219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 6.29425048828125e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.41627906976744183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:02:07.159959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14798256550525746, "overlap_percentage": 0.2578132629394531, "num_intersection": 337921, "num_union": 2283519, "num_only_computed": 972799, "num_only_roped": 972799, "total_diff": 1945598, "diff_percentage": 0.8520174344947425, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:02:09.052732", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 8.916854858398438e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.8136645962732919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:03:11.053682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1378262620934965, "overlap_percentage": 0.24226240276772792, "num_intersection": 342842, "num_union": 2487494, "num_only_computed": 1072326, "num_only_roped": 1072326, "total_diff": 2144652, "diff_percentage": 0.8621737379065035, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:03:13.717564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 8.726119995117188e-05, "l2_diff": 4.34375, "l2_diff_relative": 0.9455782312925171}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:04:22.708917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13589737264830384, "overlap_percentage": 0.23927755432951484, "num_intersection": 363610, "num_union": 2675622, "num_only_computed": 1156006, "num_only_roped": 1156006, "total_diff": 2312012, "diff_percentage": 0.8641026273516962, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:04:25.076063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.534027099609375e-05, "l2_diff": 4.0, "l2_diff_relative": 0.8258064516129032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:05:41.239001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13035839115238146, "overlap_percentage": 0.23064966327977315, "num_intersection": 374826, "num_union": 2875350, "num_only_computed": 1250262, "num_only_roped": 1250262, "total_diff": 2500524, "diff_percentage": 0.8696416088476185, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:05:44.178467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.197265625, "mean_diff": 7.43865966796875e-05, "l2_diff": 4.0625, "l2_diff_relative": 0.8843537414965986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:07:06.656790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1344422146710924, "overlap_percentage": 0.2370190617599171, "num_intersection": 409933, "num_union": 3049139, "num_only_computed": 1319603, "num_only_roped": 1319603, "total_diff": 2639206, "diff_percentage": 0.8655577853289076, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:07:09.473071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 6.246566772460938e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.7329545454545454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:08:38.282164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12500980930707054, "overlap_percentage": 0.22223772321428573, "num_intersection": 407808, "num_union": 3262208, "num_only_computed": 1427200, "num_only_roped": 1427200, "total_diff": 2854400, "diff_percentage": 0.8749901906929295, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:08:42.389470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.628036499023438e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.9461538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:10:17.519370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12776228979612084, "overlap_percentage": 0.22657663046920634, "num_intersection": 386334, "num_union": 3023850, "num_only_computed": 1318758, "num_only_roped": 1318758, "total_diff": 2637516, "diff_percentage": 0.8722377102038792, "num_computed": 1705092, "num_roped": 1705092}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 906, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:10:21.701356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1953125, "mean_diff": 6.580352783203125e-05, "l2_diff": 4.0, "l2_diff_relative": 1.0199203187250996}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 906, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:11:49.954172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12627367297946118, "overlap_percentage": 0.2242326638878363, "num_intersection": 11835, "num_union": 93725, "num_only_computed": 40945, "num_only_roped": 40945, "total_diff": 81890, "diff_percentage": 0.8737263270205388, "num_computed": 52780, "num_roped": 52780}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 28, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:11:53.692660", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.53515625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 28, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:13:02.692289", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14173228346456693, "overlap_percentage": 0.2482758620689655, "num_intersection": 468, "num_union": 3302, "num_only_computed": 1417, "num_only_roped": 1417, "total_diff": 2834, "diff_percentage": 0.8582677165354331, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:13:04.556278", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.06591796875, "l2_diff_relative": 0.3276699029126214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:02.795533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13247221387804145, "overlap_percentage": 0.2339522546419098, "num_intersection": 441, "num_union": 3329, "num_only_computed": 1444, "num_only_roped": 1444, "total_diff": 2888, "diff_percentage": 0.8675277861219586, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:04.705080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.2608108108108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:40.726614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:40.757127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003058667452830189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:46.636627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4994134958037495, "overlap_percentage": 0.6661451256793478, "num_intersection": 313781, "num_union": 628299, "num_only_computed": 157259, "num_only_roped": 157259, "total_diff": 314518, "diff_percentage": 0.5005865041962505, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:47.023899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 0.00011730194091796875, "l2_diff": 1.3125, "l2_diff_relative": 0.15671641791044777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:15:02.420500", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40224671001825435, "overlap_percentage": 0.5737174594804618, "num_intersection": 330755, "num_union": 822269, "num_only_computed": 245757, "num_only_roped": 245757, "total_diff": 491514, "diff_percentage": 0.5977532899817456, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:15:02.964173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 0.00011444091796875, "l2_diff": 1.671875, "l2_diff_relative": 0.2123015873015873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:15:22.710611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33741455314276514, "overlap_percentage": 0.5045773613721805, "num_intersection": 343597, "num_union": 1018323, "num_only_computed": 337363, "num_only_roped": 337363, "total_diff": 674726, "diff_percentage": 0.6625854468572349, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:15:23.425719", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 8.96453857421875e-05, "l2_diff": 1.6484375, "l2_diff_relative": 0.22351694915254236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:15:48.901024", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.289164101912603, "overlap_percentage": 0.4486071268717448, "num_intersection": 352799, "num_union": 1220065, "num_only_computed": 433633, "num_only_roped": 433633, "total_diff": 867266, "diff_percentage": 0.710835898087397, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:15:50.025888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.2025462962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:16:21.013893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25147060579476627, "overlap_percentage": 0.40188016343390803, "num_intersection": 358027, "num_union": 1423733, "num_only_computed": 532853, "num_only_roped": 532853, "total_diff": 1065706, "diff_percentage": 0.7485293942052337, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:16:22.123635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 4.744529724121094e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.17796610169491525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:16:58.964274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.244024712312536, "overlap_percentage": 0.3923148951903292, "num_intersection": 390482, "num_union": 1600174, "num_only_computed": 604846, "num_only_roped": 604846, "total_diff": 1209692, "diff_percentage": 0.755975287687464, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:17:00.234385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.20520833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:17:42.738737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2280588236606595, "overlap_percentage": 0.37141351744186046, "num_intersection": 408852, "num_union": 1792748, "num_only_computed": 691948, "num_only_roped": 691948, "total_diff": 1383896, "diff_percentage": 0.7719411763393405, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:17:44.218840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.16834677419354838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:18:32.923866", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21118340427263807, "overlap_percentage": 0.3487224206138488, "num_intersection": 420297, "num_union": 1990199, "num_only_computed": 784951, "num_only_roped": 784951, "total_diff": 1569902, "diff_percentage": 0.788816595727362, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:18:36.076285", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 6.532669067382812e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.43478260869565216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:19:31.389276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18176465868016203, "overlap_percentage": 0.30761566162109377, "num_intersection": 403198, "num_union": 2218242, "num_only_computed": 907522, "num_only_roped": 907522, "total_diff": 1815044, "diff_percentage": 0.818235341319838, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:19:33.276430", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 8.344650268554688e-05, "l2_diff": 3.75, "l2_diff_relative": 0.7317073170731707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:20:35.706625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16131547061953955, "overlap_percentage": 0.27781507213277856, "num_intersection": 393155, "num_union": 2437181, "num_only_computed": 1022013, "num_only_roped": 1022013, "total_diff": 2044026, "diff_percentage": 0.8386845293804605, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:20:40.242561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1787109375, "mean_diff": 8.106231689453125e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.8181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:21:49.588579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1527175355953546, "overlap_percentage": 0.26496957126010784, "num_intersection": 402652, "num_union": 2636580, "num_only_computed": 1116964, "num_only_roped": 1116964, "total_diff": 2233928, "diff_percentage": 0.8472824644046454, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:21:52.002608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2109375, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.96875, "l2_diff_relative": 1.06}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:23:08.132132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15039442234037018, "overlap_percentage": 0.2614658406190926, "num_intersection": 424905, "num_union": 2825271, "num_only_computed": 1200183, "num_only_roped": 1200183, "total_diff": 2400366, "diff_percentage": 0.8496055776596299, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:23:10.794772", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.963180541992188e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.9375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:24:31.308849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14463924407300585, "overlap_percentage": 0.2527245939224161, "num_intersection": 278224, "num_union": 1923572, "num_only_computed": 822674, "num_only_roped": 822674, "total_diff": 1645348, "diff_percentage": 0.8553607559269941, "num_computed": 1100898, "num_roped": 1100898}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "mask_shape": [1, 32, 666, 13978], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:24:35.605107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 5.7220458984375e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5612244897959183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "attention_shape": [1, 32, 666, 13978]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:25:48.530804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1461122693991285, "overlap_percentage": 0.2549702560565566, "num_intersection": 14787, "num_union": 101203, "num_only_computed": 43208, "num_only_roped": 43208, "total_diff": 86416, "diff_percentage": 0.8538877306008715, "num_computed": 57995, "num_roped": 57995}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "mask_shape": [1, 32, 35, 14013], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:25:50.637485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.466796875, "l2_diff_relative": 0.4149305555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "attention_shape": [1, 32, 35, 14013]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:26:49.667617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1660802251935257, "overlap_percentage": 0.2848521424260712, "num_intersection": 472, "num_union": 2842, "num_only_computed": 1185, "num_only_roped": 1185, "total_diff": 2370, "diff_percentage": 0.8339197748064743, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "mask_shape": [1, 32, 1, 14014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:26:52.216107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 6.4849853515625e-05, "l2_diff": 0.06689453125, "l2_diff_relative": 0.48928571428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "attention_shape": [1, 32, 1, 14014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:27:42.323800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16158429723098494, "overlap_percentage": 0.27821363910681957, "num_intersection": 461, "num_union": 2853, "num_only_computed": 1196, "num_only_roped": 1196, "total_diff": 2392, "diff_percentage": 0.8384157027690151, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "mask_shape": [1, 32, 1, 14015], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:27:43.915835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.0947265625, "l2_diff_relative": 0.6689655172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "attention_shape": [1, 32, 1, 14015]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:15.399517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:15.443252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031005859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:21.254140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5109930647779254, "overlap_percentage": 0.6763671875, "num_intersection": 318596, "num_union": 623484, "num_only_computed": 152444, "num_only_roped": 152444, "total_diff": 304888, "diff_percentage": 0.48900693522207467, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:21.634422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 8.916854858398438e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.1099290780141844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:36.588458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3967684804492825, "overlap_percentage": 0.5681234735790408, "num_intersection": 327530, "num_union": 825494, "num_only_computed": 248982, "num_only_roped": 248982, "total_diff": 497964, "diff_percentage": 0.6032315195507175, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:37.133754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.11322463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:56.519028", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3377639955326666, "overlap_percentage": 0.5049679863721804, "num_intersection": 343863, "num_union": 1018057, "num_only_computed": 337097, "num_only_roped": 337097, "total_diff": 674194, "diff_percentage": 0.6622360044673333, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:57.249076", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1375968992248062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:29:22.954627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29313657541578386, "overlap_percentage": 0.4533729553222656, "num_intersection": 356547, "num_union": 1216317, "num_only_computed": 429885, "num_only_roped": 429885, "total_diff": 859770, "diff_percentage": 0.7068634245842161, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:29:25.014005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.158203125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:29:55.690410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2650044266919228, "overlap_percentage": 0.41897786458333336, "num_intersection": 373259, "num_union": 1408501, "num_only_computed": 517621, "num_only_roped": 517621, "total_diff": 1035242, "diff_percentage": 0.7349955733080772, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:29:56.764234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.13392857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:30:33.031052", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23356139469198084, "overlap_percentage": 0.37867818447788065, "num_intersection": 376909, "num_union": 1613747, "num_only_computed": 618419, "num_only_roped": 618419, "total_diff": 1236838, "diff_percentage": 0.7664386053080192, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:30:34.518628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.34375, "l2_diff_relative": 0.16165413533834586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:31:16.497834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21349550754218105, "overlap_percentage": 0.3518686409883721, "num_intersection": 387337, "num_union": 1814263, "num_only_computed": 713463, "num_only_roped": 713463, "total_diff": 1426926, "diff_percentage": 0.786504492457819, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:31:17.953945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:32:06.794090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1940466483914399, "overlap_percentage": 0.3250235636151232, "num_intersection": 391734, "num_union": 2018762, "num_only_computed": 813514, "num_only_roped": 813514, "total_diff": 1627028, "diff_percentage": 0.8059533516085601, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:32:10.215715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.39371980676328505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:33:05.194745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1659213168563213, "overlap_percentage": 0.2846183776855469, "num_intersection": 373055, "num_union": 2248385, "num_only_computed": 937665, "num_only_roped": 937665, "total_diff": 1875330, "diff_percentage": 0.8340786831436787, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:33:07.065396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.963180541992188e-05, "l2_diff": 3.9375, "l2_diff_relative": 0.6847826086956522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:34:08.304796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1551071714253065, "overlap_percentage": 0.26855892727930536, "num_intersection": 380056, "num_union": 2450280, "num_only_computed": 1035112, "num_only_roped": 1035112, "total_diff": 2070224, "diff_percentage": 0.8448928285746935, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:34:10.474409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 7.62939453125e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.7704402515723271}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:19.744586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15179708696029504, "overlap_percentage": 0.2635830367671833, "num_intersection": 400545, "num_union": 2638687, "num_only_computed": 1119071, "num_only_roped": 1119071, "total_diff": 2238142, "diff_percentage": 0.848202913039705, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:23.926528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 8.678436279296875e-05, "l2_diff": 4.28125, "l2_diff_relative": 1.096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:36:38.945994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14558545234604958, "overlap_percentage": 0.2541677742989918, "num_intersection": 413045, "num_union": 2837131, "num_only_computed": 1212043, "num_only_roped": 1212043, "total_diff": 2424086, "diff_percentage": 0.8544145476539504, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:36:43.726698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2158203125, "mean_diff": 8.487701416015625e-05, "l2_diff": 4.21875, "l2_diff_relative": 1.173913043478261}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:38:05.891404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1398473644667642, "overlap_percentage": 0.24537910746003552, "num_intersection": 424392, "num_union": 3034680, "num_only_computed": 1305144, "num_only_roped": 1305144, "total_diff": 2610288, "diff_percentage": 0.8601526355332358, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:38:08.728533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1943359375, "mean_diff": 7.772445678710938e-05, "l2_diff": 4.53125, "l2_diff_relative": 1.0820895522388059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:39:38.701191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13520055998859237, "overlap_percentage": 0.23819678170340403, "num_intersection": 437093, "num_union": 3232923, "num_only_computed": 1397915, "num_only_roped": 1397915, "total_diff": 2795830, "diff_percentage": 0.8647994400114076, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:39:42.304118", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 7.2479248046875e-05, "l2_diff": 4.1875, "l2_diff_relative": 1.0850202429149798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:41:06.854324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.131340797631165, "overlap_percentage": 0.23218608911862854, "num_intersection": 28388, "num_union": 216140, "num_only_computed": 93876, "num_only_roped": 93876, "total_diff": 187752, "diff_percentage": 0.868659202368835, "num_computed": 122264, "num_roped": 122264}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "mask_shape": [1, 32, 68, 15428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:41:09.366872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.40487804878048783}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "attention_shape": [1, 32, 68, 15428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:42:22.671876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13016705627458805, "overlap_percentage": 0.23035011603269095, "num_intersection": 13698, "num_union": 105234, "num_only_computed": 45768, "num_only_roped": 45768, "total_diff": 91536, "diff_percentage": 0.869832943725412, "num_computed": 59466, "num_roped": 59466}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "mask_shape": [1, 32, 33, 15461], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:42:25.306775", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.412109375, "l2_diff_relative": 0.3822463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "attention_shape": [1, 32, 33, 15461]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:43:29.584786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13834491471888818, "overlap_percentage": 0.24306326304106549, "num_intersection": 438, "num_union": 3166, "num_only_computed": 1364, "num_only_roped": 1364, "total_diff": 2728, "diff_percentage": 0.8616550852811118, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "mask_shape": [1, 32, 1, 15462], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:43:31.327237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.06494140625, "l2_diff_relative": 0.5215686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "attention_shape": [1, 32, 1, 15462]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:44:25.192170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13333333333333333, "overlap_percentage": 0.23529411764705882, "num_intersection": 424, "num_union": 3180, "num_only_computed": 1378, "num_only_roped": 1378, "total_diff": 2756, "diff_percentage": 0.8666666666666667, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "mask_shape": [1, 32, 1, 15463], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:44:26.922600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0189208984375, "mean_diff": 4.57763671875e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.3611111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "attention_shape": [1, 32, 1, 15463]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:45:21.817502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1315541601255887, "overlap_percentage": 0.232519422863485, "num_intersection": 419, "num_union": 3185, "num_only_computed": 1383, "num_only_roped": 1383, "total_diff": 2766, "diff_percentage": 0.8684458398744113, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15464, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15464, 128], "mask_shape": [1, 32, 1, 15464], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:45:23.910929", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.45222929936305734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15464, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15464, 128], "attention_shape": [1, 32, 1, 15464]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:45:56.595086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:45:56.606614", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.0030048076923076925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:02.354899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.497713875093003, "overlap_percentage": 0.6646314538043478, "num_intersection": 313068, "num_union": 629012, "num_only_computed": 157972, "num_only_roped": 157972, "total_diff": 315944, "diff_percentage": 0.502286124906997, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:02.734221", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.08796296296296297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:16.859361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3924065307699739, "overlap_percentage": 0.5636378774422736, "num_intersection": 324944, "num_union": 828080, "num_only_computed": 251568, "num_only_roped": 251568, "total_diff": 503136, "diff_percentage": 0.6075934692300261, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:17.401266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.16266375545851527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:36.718950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33139119978884185, "overlap_percentage": 0.49781191259398494, "num_intersection": 338990, "num_union": 1022930, "num_only_computed": 341970, "num_only_roped": 341970, "total_diff": 683940, "diff_percentage": 0.6686088002111581, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:37.412513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.11534926470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:47:02.202507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2922409543527556, "overlap_percentage": 0.452301025390625, "num_intersection": 355704, "num_union": 1217160, "num_only_computed": 430728, "num_only_roped": 430728, "total_diff": 861456, "diff_percentage": 0.7077590456472445, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:47:03.067877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.361701965332031e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.09866071428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:47:33.470762", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2673069017071828, "overlap_percentage": 0.42185030531609197, "num_intersection": 375818, "num_union": 1405942, "num_only_computed": 515062, "num_only_roped": 515062, "total_diff": 1030124, "diff_percentage": 0.7326930982928171, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:47:34.539463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.15495867768595042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:48:10.787490", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24112544827895796, "overlap_percentage": 0.3885593492798354, "num_intersection": 386744, "num_union": 1603912, "num_only_computed": 608584, "num_only_roped": 608584, "total_diff": 1217168, "diff_percentage": 0.758874551721042, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:48:12.077825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.12322695035460993}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:48:53.839664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2252048500660017, "overlap_percentage": 0.36761991279069767, "num_intersection": 404676, "num_union": 1796924, "num_only_computed": 696124, "num_only_roped": 696124, "total_diff": 1392248, "diff_percentage": 0.7747951499339983, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:48:55.289463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.1087962962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:49:43.161703", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19762095097372384, "overlap_percentage": 0.33002253478122345, "num_intersection": 397759, "num_union": 2012737, "num_only_computed": 807489, "num_only_roped": 807489, "total_diff": 1614978, "diff_percentage": 0.8023790490262762, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:49:45.822164", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 5.245208740234375e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.3341121495327103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:50:40.787127", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16690949088819357, "overlap_percentage": 0.2860710144042969, "num_intersection": 374959, "num_union": 2246481, "num_only_computed": 935761, "num_only_roped": 935761, "total_diff": 1871522, "diff_percentage": 0.8330905091118064, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:50:43.113434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 8.344650268554688e-05, "l2_diff": 3.78125, "l2_diff_relative": 0.7658227848101266}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:51:42.380473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1579908877171609, "overlap_percentage": 0.2728706924950348, "num_intersection": 286601, "num_union": 1814035, "num_only_computed": 763717, "num_only_roped": 763717, "total_diff": 1527434, "diff_percentage": 0.842009112282839, "num_computed": 1050318, "num_roped": 1050318}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "mask_shape": [1, 32, 774, 11014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:51:44.373057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 8.96453857421875e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.9041666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "attention_shape": [1, 32, 774, 11014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:52:39.548341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16007429318291258, "overlap_percentage": 0.275972485768501, "num_intersection": 11635, "num_union": 72685, "num_only_computed": 30525, "num_only_roped": 30525, "total_diff": 61050, "diff_percentage": 0.8399257068170874, "num_computed": 42160, "num_roped": 42160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "mask_shape": [1, 32, 31, 11045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:52:41.117890", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.4041353383458647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "attention_shape": [1, 32, 31, 11045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:53:25.535661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16738197424892703, "overlap_percentage": 0.2867647058823529, "num_intersection": 390, "num_union": 2330, "num_only_computed": 970, "num_only_roped": 970, "total_diff": 1940, "diff_percentage": 0.8326180257510729, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "mask_shape": [1, 32, 1, 11046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:53:27.968206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 7.82012939453125e-05, "l2_diff": 0.07861328125, "l2_diff_relative": 0.6851063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "attention_shape": [1, 32, 1, 11046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:54:07.307373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16040955631399317, "overlap_percentage": 0.27647058823529413, "num_intersection": 376, "num_union": 2344, "num_only_computed": 984, "num_only_roped": 984, "total_diff": 1968, "diff_percentage": 0.8395904436860068, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "mask_shape": [1, 32, 1, 11047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:54:08.979644", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 7.390975952148438e-05, "l2_diff": 0.08203125, "l2_diff_relative": 0.5753424657534246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "attention_shape": [1, 32, 1, 11047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:54:48.336215", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15942028985507245, "overlap_percentage": 0.275, "num_intersection": 374, "num_union": 2346, "num_only_computed": 986, "num_only_roped": 986, "total_diff": 1972, "diff_percentage": 0.8405797101449275, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "mask_shape": [1, 32, 1, 11048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:54:50.024047", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.23115577889447236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "attention_shape": [1, 32, 1, 11048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:55:16.622736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:55:16.636370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.0030218160377358493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:55:22.795354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5112160566706021, "overlap_percentage": 0.6765625, "num_intersection": 318688, "num_union": 623392, "num_only_computed": 152352, "num_only_roped": 152352, "total_diff": 304704, "diff_percentage": 0.4887839433293979, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:55:23.202756", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.07791666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:55:38.461509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3989919702201698, "overlap_percentage": 0.5703992284635879, "num_intersection": 328842, "num_union": 824182, "num_only_computed": 247670, "num_only_roped": 247670, "total_diff": 495340, "diff_percentage": 0.6010080297798301, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:55:39.025740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05712890625, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.125, "l2_diff_relative": 0.13333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:55:59.538314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3295754187871646, "overlap_percentage": 0.4957603970864662, "num_intersection": 337593, "num_union": 1024327, "num_only_computed": 343367, "num_only_roped": 343367, "total_diff": 686734, "diff_percentage": 0.6704245812128353, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:56:00.298270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 5.555152893066406e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.12413194444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:56:26.625471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2850479544891922, "overlap_percentage": 0.4436378479003906, "num_intersection": 348891, "num_union": 1223973, "num_only_computed": 437541, "num_only_roped": 437541, "total_diff": 875082, "diff_percentage": 0.7149520455108078, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:56:27.544575", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.11833333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:56:59.672615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.269651247803464, "overlap_percentage": 0.42476427801724137, "num_intersection": 378414, "num_union": 1403346, "num_only_computed": 512466, "num_only_roped": 512466, "total_diff": 1024932, "diff_percentage": 0.7303487521965359, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:57:00.799036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08935546875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.15784671532846714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:57:38.874887", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24750252708350437, "overlap_percentage": 0.3967968348122428, "num_intersection": 394943, "num_union": 1595713, "num_only_computed": 600385, "num_only_roped": 600385, "total_diff": 1200770, "diff_percentage": 0.7524974729164956, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:57:40.198173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 2.8133392333984375e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.12764084507042253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:58:24.155604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22104754076721453, "overlap_percentage": 0.362062136627907, "num_intersection": 398558, "num_union": 1803042, "num_only_computed": 702242, "num_only_roped": 702242, "total_diff": 1404484, "diff_percentage": 0.7789524592327854, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:58:27.739575", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.18225190839694658}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:59:16.758737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1944306389186334, "overlap_percentage": 0.3255620420029737, "num_intersection": 392383, "num_union": 2018113, "num_only_computed": 812865, "num_only_roped": 812865, "total_diff": 1625730, "diff_percentage": 0.8055693610813666, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:59:18.460832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 6.67572021484375e-05, "l2_diff": 3.171875, "l2_diff_relative": 0.47877358490566035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:00:16.633765", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16619154895491897, "overlap_percentage": 0.285015869140625, "num_intersection": 373576, "num_union": 2247864, "num_only_computed": 937144, "num_only_roped": 937144, "total_diff": 1874288, "diff_percentage": 0.8338084510450811, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:00:20.132002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 9.1552734375e-05, "l2_diff": 4.375, "l2_diff_relative": 0.8484848484848485}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:21.799410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15680961174230812, "overlap_percentage": 0.27110703464182345, "num_intersection": 383662, "num_union": 2446674, "num_only_computed": 1031506, "num_only_roped": 1031506, "total_diff": 2063012, "diff_percentage": 0.8431903882576919, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:26.498625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1962890625, "mean_diff": 8.96453857421875e-05, "l2_diff": 4.3125, "l2_diff_relative": 0.9261744966442953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:02:35.112277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15501522991181282, "overlap_percentage": 0.268421101120283, "num_intersection": 407897, "num_union": 2631335, "num_only_computed": 1111719, "num_only_roped": 1111719, "total_diff": 2223438, "diff_percentage": 0.8449847700881872, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:02:37.755563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2060546875, "mean_diff": 8.726119995117188e-05, "l2_diff": 5.4375, "l2_diff_relative": 1.10828025477707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:03:53.926029", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15072148100102392, "overlap_percentage": 0.2619599677063642, "num_intersection": 425708, "num_union": 2824468, "num_only_computed": 1199380, "num_only_roped": 1199380, "total_diff": 2398760, "diff_percentage": 0.8492785189989761, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:03:59.009796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2314453125, "mean_diff": 7.963180541992188e-05, "l2_diff": 4.875, "l2_diff_relative": 1.0263157894736843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:05:22.442736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14263780324774575, "overlap_percentage": 0.2496640717510361, "num_intersection": 431803, "num_union": 3027269, "num_only_computed": 1297733, "num_only_roped": 1297733, "total_diff": 2595466, "diff_percentage": 0.8573621967522542, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:05:25.347290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.772445678710938e-05, "l2_diff": 4.8125, "l2_diff_relative": 1.1240875912408759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:06:53.291160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13833646232415342, "overlap_percentage": 0.24305021740533625, "num_intersection": 331363, "num_union": 2395341, "num_only_computed": 1031989, "num_only_roped": 1031989, "total_diff": 2063978, "diff_percentage": 0.8616635376758466, "num_computed": 1363352, "num_roped": 1363352}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "mask_shape": [1, 32, 772, 15108], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:06:56.251341", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.609375, "l2_diff_relative": 0.8492647058823529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "attention_shape": [1, 32, 772, 15108]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:08:15.171591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14124012140228437, "overlap_percentage": 0.24752042756565085, "num_intersection": 9633, "num_union": 68203, "num_only_computed": 29285, "num_only_roped": 29285, "total_diff": 58570, "diff_percentage": 0.8587598785977156, "num_computed": 38918, "num_roped": 38918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "mask_shape": [1, 32, 22, 15130], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:08:17.463581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.3359375, "l2_diff_relative": 0.3359375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "attention_shape": [1, 32, 22, 15130]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:09:19.035662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1394524959742351, "overlap_percentage": 0.2447710570944036, "num_intersection": 433, "num_union": 3105, "num_only_computed": 1336, "num_only_roped": 1336, "total_diff": 2672, "diff_percentage": 0.8605475040257649, "num_computed": 1769, "num_roped": 1769}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "mask_shape": [1, 32, 1, 15131], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:09:20.745171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.3087557603686636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "attention_shape": [1, 32, 1, 15131]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:09:49.115890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:09:49.125244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0031948468543046356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:09:54.844390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5040071522079249, "overlap_percentage": 0.6702190896739131, "num_intersection": 315700, "num_union": 626380, "num_only_computed": 155340, "num_only_roped": 155340, "total_diff": 310680, "diff_percentage": 0.4959928477920751, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:09:55.211043", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 8.678436279296875e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.11488970588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:09.372295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3862410326018349, "overlap_percentage": 0.5572494588143873, "num_intersection": 321261, "num_union": 831763, "num_only_computed": 255251, "num_only_roped": 255251, "total_diff": 510502, "diff_percentage": 0.6137589673981652, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:09.907350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.62939453125e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.14147286821705427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:29.292217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32767268313844383, "overlap_percentage": 0.49360461701127817, "num_intersection": 336125, "num_union": 1025795, "num_only_computed": 344835, "num_only_roped": 344835, "total_diff": 689670, "diff_percentage": 0.6723273168615561, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:29.996848", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.1829004329004329}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:54.796644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.285055303823799, "overlap_percentage": 0.44364674886067706, "num_intersection": 348898, "num_union": 1223966, "num_only_computed": 437534, "num_only_roped": 437534, "total_diff": 875068, "diff_percentage": 0.7149446961762009, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:55.683733", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 4.887580871582031e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.13489208633093525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:11:20.935554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28603241370778176, "overlap_percentage": 0.44482924482924485, "num_intersection": 9248, "num_union": 32332, "num_only_computed": 11542, "num_only_roped": 11542, "total_diff": 23084, "diff_percentage": 0.7139675862922182, "num_computed": 20790, "num_roped": 20790}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "mask_shape": [1, 32, 27, 5147], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:11:21.637514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.26953125, "l2_diff_relative": 0.24125874125874125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "attention_shape": [1, 32, 27, 5147]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:11:42.075010", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2530512611879577, "overlap_percentage": 0.4038961038961039, "num_intersection": 311, "num_union": 1229, "num_only_computed": 459, "num_only_roped": 459, "total_diff": 918, "diff_percentage": 0.7469487388120423, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "mask_shape": [1, 32, 1, 5148], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:11:45.260184", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.13168724279835392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "attention_shape": [1, 32, 1, 5148]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:03.961653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2706270627062706, "overlap_percentage": 0.42597402597402595, "num_intersection": 328, "num_union": 1212, "num_only_computed": 442, "num_only_roped": 442, "total_diff": 884, "diff_percentage": 0.7293729372937293, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "mask_shape": [1, 32, 1, 5149], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:04.567859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.17752100840336135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "attention_shape": [1, 32, 1, 5149]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:23.297780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26705012325390304, "overlap_percentage": 0.42153047989623865, "num_intersection": 325, "num_union": 1217, "num_only_computed": 446, "num_only_roped": 446, "total_diff": 892, "diff_percentage": 0.7329498767460969, "num_computed": 771, "num_roped": 771}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "mask_shape": [1, 32, 1, 5150], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:25.104937", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.10792951541850221}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "attention_shape": [1, 32, 1, 5150]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:39.809989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:39.821501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:45.619694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.515711704580375, "overlap_percentage": 0.6804878566576087, "num_intersection": 320537, "num_union": 621543, "num_only_computed": 150503, "num_only_roped": 150503, "total_diff": 301006, "diff_percentage": 0.48428829541962504, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:12:45.998732", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.1145418326693227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:00.728054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4174369388916685, "overlap_percentage": 0.5890024839031972, "num_intersection": 339567, "num_union": 813457, "num_only_computed": 236945, "num_only_roped": 236945, "total_diff": 473890, "diff_percentage": 0.5825630611083314, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:01.250238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 8.296966552734375e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.14955357142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:20.653082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34200465097946475, "overlap_percentage": 0.5096921992481203, "num_intersection": 347080, "num_union": 1014840, "num_only_computed": 333880, "num_only_roped": 333880, "total_diff": 667760, "diff_percentage": 0.6579953490205352, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:21.358115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 8.058547973632812e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:46.902501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29752203833341856, "overlap_percentage": 0.45860036214192706, "num_intersection": 360658, "num_union": 1212206, "num_only_computed": 425774, "num_only_roped": 425774, "total_diff": 851548, "diff_percentage": 0.7024779616665814, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:49.420613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.12878787878787878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:14:20.155720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.281314451894616, "overlap_percentage": 0.4391029094827586, "num_intersection": 391188, "num_union": 1390572, "num_only_computed": 499692, "num_only_roped": 499692, "total_diff": 999384, "diff_percentage": 0.718685548105384, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:14:21.231527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.09124087591240876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:14:57.232031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24903905882352942, "overlap_percentage": 0.39876904899691357, "num_intersection": 396906, "num_union": 1593750, "num_only_computed": 598422, "num_only_roped": 598422, "total_diff": 1196844, "diff_percentage": 0.7509609411764706, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:14:58.482174", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.625, "l2_diff_relative": 0.07042253521126761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:15:40.100350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21024752464362123, "overlap_percentage": 0.34744549418604653, "num_intersection": 382468, "num_union": 1819132, "num_only_computed": 718332, "num_only_roped": 718332, "total_diff": 1436664, "diff_percentage": 0.7897524753563787, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:15:41.532337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 2.944469451904297e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.1421161825726141}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:16:29.258922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1792571719306485, "overlap_percentage": 0.30401709855564996, "num_intersection": 366416, "num_union": 2044080, "num_only_computed": 838832, "num_only_roped": 838832, "total_diff": 1677664, "diff_percentage": 0.8207428280693515, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:16:33.309923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.36910994764397903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:17:27.643584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15244899367776146, "overlap_percentage": 0.26456527709960936, "num_intersection": 346771, "num_union": 2274669, "num_only_computed": 963949, "num_only_roped": 963949, "total_diff": 1927898, "diff_percentage": 0.8475510063222386, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:17:30.384613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.62939453125e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.6528662420382165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:18:30.898352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14202709551216458, "overlap_percentage": 0.24872806620839363, "num_intersection": 351992, "num_union": 2478344, "num_only_computed": 1063176, "num_only_roped": 1063176, "total_diff": 2126352, "diff_percentage": 0.8579729044878355, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:18:32.998910", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.793571472167969e-05, "l2_diff": 2.984375, "l2_diff_relative": 0.4872448979591837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:19:33.735924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13941075439291847, "overlap_percentage": 0.24470675540919737, "num_intersection": 31656, "num_union": 227070, "num_only_computed": 97707, "num_only_roped": 97707, "total_diff": 195414, "diff_percentage": 0.8605892456070815, "num_computed": 129363, "num_roped": 129363}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 93, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:19:35.474621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.3107638888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 93, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:20:28.319311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13976634852749256, "overlap_percentage": 0.2452543869330096, "num_intersection": 8889, "num_union": 63599, "num_only_computed": 27355, "num_only_roped": 27355, "total_diff": 54710, "diff_percentage": 0.8602336514725074, "num_computed": 36244, "num_roped": 36244}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 26, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:20:29.973771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.3046875, "l2_diff_relative": 0.3058823529411765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 26, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:21:16.318354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13982011447260834, "overlap_percentage": 0.24533715925394547, "num_intersection": 342, "num_union": 2446, "num_only_computed": 1052, "num_only_roped": 1052, "total_diff": 2104, "diff_percentage": 0.8601798855273917, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:21:17.647307", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 7.915496826171875e-05, "l2_diff": 0.08349609375, "l2_diff_relative": 0.6240875912408759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:21:58.423229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1305758313057583, "overlap_percentage": 0.2309899569583931, "num_intersection": 322, "num_union": 2466, "num_only_computed": 1072, "num_only_roped": 1072, "total_diff": 2144, "diff_percentage": 0.8694241686942417, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:21:59.725808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.05712890625, "l2_diff_relative": 0.26}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:22:40.411032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13749490004079967, "overlap_percentage": 0.2417503586800574, "num_intersection": 337, "num_union": 2451, "num_only_computed": 1057, "num_only_roped": 1057, "total_diff": 2114, "diff_percentage": 0.8625050999592003, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:22:41.737083", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.15083333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:06.866177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:06.879894", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003117487980769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:12.714070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5088078387282247, "overlap_percentage": 0.6744501528532608, "num_intersection": 317693, "num_union": 624387, "num_only_computed": 153347, "num_only_roped": 153347, "total_diff": 306694, "diff_percentage": 0.49119216127177534, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:13.437294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.10431654676258993}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:27.923411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3962678162729023, "overlap_percentage": 0.5676100410746003, "num_intersection": 327234, "num_union": 825790, "num_only_computed": 249278, "num_only_roped": 249278, "total_diff": 498556, "diff_percentage": 0.6037321837270977, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:28.475546", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 9.489059448242188e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.17653061224489797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:48.667526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35438016561800456, "overlap_percentage": 0.5233097391917293, "num_intersection": 356353, "num_union": 1005567, "num_only_computed": 324607, "num_only_roped": 324607, "total_diff": 649214, "diff_percentage": 0.6456198343819954, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:49.380618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.866455078125e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.16086065573770492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:14.567582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31070798517680254, "overlap_percentage": 0.4741071065266927, "num_intersection": 372853, "num_union": 1200011, "num_only_computed": 413579, "num_only_roped": 413579, "total_diff": 827158, "diff_percentage": 0.6892920148231975, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:15.468613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.10839160839160839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:46.583183", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2643724653261946, "overlap_percentage": 0.41818763469827586, "num_intersection": 372555, "num_union": 1409205, "num_only_computed": 518325, "num_only_roped": 518325, "total_diff": 1036650, "diff_percentage": 0.7356275346738055, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:47.653214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.09835271317829457}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:25:26.208912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2377800176216713, "overlap_percentage": 0.384204001093107, "num_intersection": 382409, "num_union": 1608247, "num_only_computed": 612919, "num_only_roped": 612919, "total_diff": 1225838, "diff_percentage": 0.7622199823783287, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:25:27.462160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.1891025641025641}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:26:10.206893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22506645328905525, "overlap_percentage": 0.36743550145348836, "num_intersection": 404473, "num_union": 1797127, "num_only_computed": 696327, "num_only_roped": 696327, "total_diff": 1392654, "diff_percentage": 0.7749335467109447, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:26:13.787657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.10328014184397163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:27:02.601532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19287195348261785, "overlap_percentage": 0.32337411055649956, "num_intersection": 389746, "num_union": 2020750, "num_only_computed": 815502, "num_only_roped": 815502, "total_diff": 1631004, "diff_percentage": 0.8071280465173821, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:27:04.278147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 5.269050598144531e-05, "l2_diff": 2.625, "l2_diff_relative": 0.3574468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:27:59.570427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16786864329004791, "overlap_percentage": 0.2874786376953125, "num_intersection": 376804, "num_union": 2244636, "num_only_computed": 933916, "num_only_roped": 933916, "total_diff": 1867832, "diff_percentage": 0.8321313567099521, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:28:01.475466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 9.72747802734375e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.9862068965517241}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:29:04.387765", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15407427523157238, "overlap_percentage": 0.2670092879431983, "num_intersection": 377863, "num_union": 2452473, "num_only_computed": 1037305, "num_only_roped": 1037305, "total_diff": 2074610, "diff_percentage": 0.8459257247684276, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:29:06.553827", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 7.867813110351562e-05, "l2_diff": 3.875, "l2_diff_relative": 0.7948717948717948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:30:15.711012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15250159836242744, "overlap_percentage": 0.26464448913409705, "num_intersection": 402158, "num_union": 2637074, "num_only_computed": 1117458, "num_only_roped": 1117458, "total_diff": 2234916, "diff_percentage": 0.8474984016375725, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:30:18.066197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.295608520507812e-05, "l2_diff": 3.78125, "l2_diff_relative": 0.7707006369426752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:31:34.398214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14913761008584123, "overlap_percentage": 0.25956440512759926, "num_intersection": 421815, "num_union": 2828361, "num_only_computed": 1203273, "num_only_roped": 1203273, "total_diff": 2406546, "diff_percentage": 0.8508623899141587, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:31:37.008748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.205078125, "mean_diff": 6.103515625e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.6394736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:32:59.246928", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14581257023904348, "overlap_percentage": 0.2545138254306698, "num_intersection": 376006, "num_union": 2578694, "num_only_computed": 1101344, "num_only_roped": 1101344, "total_diff": 2202688, "diff_percentage": 0.8541874297609565, "num_computed": 1477350, "num_roped": 1477350}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:33:01.974375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1806640625, "mean_diff": 6.246566772460938e-05, "l2_diff": 3.53125, "l2_diff_relative": 0.6975308641975309}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:34:20.152735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14572766289504488, "overlap_percentage": 0.2543844713093819, "num_intersection": 11952, "num_union": 82016, "num_only_computed": 35032, "num_only_roped": 35032, "total_diff": 70064, "diff_percentage": 0.8542723371049551, "num_computed": 46984, "num_roped": 46984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "mask_shape": [1, 32, 28, 14222], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:34:22.189127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08935546875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.32194244604316546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "attention_shape": [1, 32, 28, 14222]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:35:20.370329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1568424681144433, "overlap_percentage": 0.27115613825983315, "num_intersection": 455, "num_union": 2901, "num_only_computed": 1223, "num_only_roped": 1223, "total_diff": 2446, "diff_percentage": 0.8431575318855568, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "mask_shape": [1, 32, 1, 14223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:35:21.986860", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029541015625, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.0439453125, "l2_diff_relative": 0.2727272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "attention_shape": [1, 32, 1, 14223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:36:12.394759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1501028101439342, "overlap_percentage": 0.26102502979737785, "num_intersection": 438, "num_union": 2918, "num_only_computed": 1240, "num_only_roped": 1240, "total_diff": 2480, "diff_percentage": 0.8498971898560658, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "mask_shape": [1, 32, 1, 14224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:36:14.013582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.2921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "attention_shape": [1, 32, 1, 14224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:37:04.237126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14227365554799182, "overlap_percentage": 0.24910607866507747, "num_intersection": 418, "num_union": 2938, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.8577263444520081, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 1, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:37:05.852946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.19736842105263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 1, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:37:55.693592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14500170590242237, "overlap_percentage": 0.2532777115613826, "num_intersection": 425, "num_union": 2931, "num_only_computed": 1253, "num_only_roped": 1253, "total_diff": 2506, "diff_percentage": 0.8549982940975777, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:37:59.031398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0111083984375, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.19785276073619631}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:38:48.858026", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14892160219103046, "overlap_percentage": 0.2592371871275328, "num_intersection": 435, "num_union": 2921, "num_only_computed": 1243, "num_only_roped": 1243, "total_diff": 2486, "diff_percentage": 0.8510783978089695, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:38:51.248375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.2422360248447205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:39:42.452387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1568424681144433, "overlap_percentage": 0.27115613825983315, "num_intersection": 455, "num_union": 2901, "num_only_computed": 1223, "num_only_roped": 1223, "total_diff": 2446, "diff_percentage": 0.8431575318855568, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:39:44.065355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013916015625, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.21893491124260356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:15.607812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:15.645041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003115110759493671}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:21.398804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5172789220825864, "overlap_percentage": 0.6818507982336957, "num_intersection": 321179, "num_union": 620901, "num_only_computed": 149861, "num_only_roped": 149861, "total_diff": 299722, "diff_percentage": 0.4827210779174136, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:21.779157", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.08928571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:37.236273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4020301655163692, "overlap_percentage": 0.5734971691829485, "num_intersection": 330628, "num_union": 822396, "num_only_computed": 245884, "num_only_roped": 245884, "total_diff": 491768, "diff_percentage": 0.5979698344836307, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:37.771071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.12777777777777777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:57.105501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.328664847531143, "overlap_percentage": 0.49472949953007517, "num_intersection": 336891, "num_union": 1025029, "num_only_computed": 344069, "num_only_roped": 344069, "total_diff": 688138, "diff_percentage": 0.671335152468857, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:40:57.886261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.1322463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:41:23.188229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28451692515755683, "overlap_percentage": 0.4429944356282552, "num_intersection": 348385, "num_union": 1224479, "num_only_computed": 438047, "num_only_roped": 438047, "total_diff": 876094, "diff_percentage": 0.7154830748424432, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:41:26.240962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 6.008148193359375e-05, "l2_diff": 1.5, "l2_diff_relative": 0.18823529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:41:56.621399", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25133701106479805, "overlap_percentage": 0.4017095456178161, "num_intersection": 357875, "num_union": 1423885, "num_only_computed": 533005, "num_only_roped": 533005, "total_diff": 1066010, "diff_percentage": 0.7486629889352019, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:41:57.689120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.316734313964844e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.19602272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:42:33.495433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23971561950407788, "overlap_percentage": 0.38672678755144035, "num_intersection": 384920, "num_union": 1605736, "num_only_computed": 610408, "num_only_roped": 610408, "total_diff": 1220816, "diff_percentage": 0.7602843804959222, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:42:35.533414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.4140625, "l2_diff_relative": 0.15391156462585034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:43:17.232455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21056827866824293, "overlap_percentage": 0.34788335755813954, "num_intersection": 382950, "num_union": 1818650, "num_only_computed": 717850, "num_only_roped": 717850, "total_diff": 1435700, "diff_percentage": 0.7894317213317571, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:43:18.667676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.1821705426356589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:06.919513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19608954237404197, "overlap_percentage": 0.3278843856202209, "num_intersection": 395182, "num_union": 2015314, "num_only_computed": 810066, "num_only_roped": 810066, "total_diff": 1620132, "diff_percentage": 0.803910457625958, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:11.169418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.875, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:55.399876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1870938215102975, "overlap_percentage": 0.3152132007093839, "num_intersection": 8176, "num_union": 43700, "num_only_computed": 17762, "num_only_roped": 17762, "total_diff": 35524, "diff_percentage": 0.8129061784897025, "num_computed": 25938, "num_roped": 25938}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "mask_shape": [1, 32, 22, 9238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:56.553418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.23046875, "l2_diff_relative": 0.18789808917197454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "attention_shape": [1, 32, 22, 9238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:45:37.142240", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18624760523999379, "overlap_percentage": 0.31401134875600173, "num_intersection": 21582, "num_union": 115878, "num_only_computed": 47148, "num_only_roped": 47148, "total_diff": 94296, "diff_percentage": 0.8137523947600062, "num_computed": 68730, "num_roped": 68730}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "mask_shape": [1, 32, 58, 9296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:45:38.568834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10888671875, "mean_diff": 8.0108642578125e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.5579268292682927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "attention_shape": [1, 32, 58, 9296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:46:16.763677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19939271255060728, "overlap_percentage": 0.33248945147679326, "num_intersection": 394, "num_union": 1976, "num_only_computed": 791, "num_only_roped": 791, "total_diff": 1582, "diff_percentage": 0.8006072874493927, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "mask_shape": [1, 32, 1, 9297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:46:17.847278", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06884765625, "mean_diff": 0.0001392364501953125, "l2_diff": 0.126953125, "l2_diff_relative": 1.9548872180451127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "attention_shape": [1, 32, 1, 9297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:46:51.139571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21041879468845762, "overlap_percentage": 0.34767932489451475, "num_intersection": 412, "num_union": 1958, "num_only_computed": 773, "num_only_roped": 773, "total_diff": 1546, "diff_percentage": 0.7895812053115424, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "mask_shape": [1, 32, 1, 9298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:46:52.209359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 0.00011301040649414062, "l2_diff": 0.0888671875, "l2_diff_relative": 1.089820359281437}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "attention_shape": [1, 32, 1, 9298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:16.058575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:16.072189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0031115301724137933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:21.911359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5152387585104312, "overlap_percentage": 0.6800760020380435, "num_intersection": 320343, "num_union": 621737, "num_only_computed": 150697, "num_only_roped": 150697, "total_diff": 301394, "diff_percentage": 0.48476124148956873, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:22.296167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 0.0001430511474609375, "l2_diff": 1.359375, "l2_diff_relative": 0.1891304347826087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:39.371809", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39923474495745953, "overlap_percentage": 0.5706472718694494, "num_intersection": 328985, "num_union": 824039, "num_only_computed": 247527, "num_only_roped": 247527, "total_diff": 495054, "diff_percentage": 0.6007652550425404, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:39.916731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 0.00011205673217773438, "l2_diff": 1.46875, "l2_diff_relative": 0.22065727699530516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:59.612445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3366571793110217, "overlap_percentage": 0.5037300281954887, "num_intersection": 343020, "num_union": 1018900, "num_only_computed": 337940, "num_only_roped": 337940, "total_diff": 675880, "diff_percentage": 0.6633428206889783, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:48:00.346234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.20527522935779816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:48:25.484049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29111230775292557, "overlap_percentage": 0.4509480794270833, "num_intersection": 354640, "num_union": 1218224, "num_only_computed": 431792, "num_only_roped": 431792, "total_diff": 863584, "diff_percentage": 0.7088876922470744, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:48:26.383033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.20666666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:48:57.238985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25865974946330217, "overlap_percentage": 0.4110082165948276, "num_intersection": 366159, "num_union": 1415601, "num_only_computed": 524721, "num_only_roped": 524721, "total_diff": 1049442, "diff_percentage": 0.7413402505366978, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:48:58.295563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.1019467213114754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:49:35.380816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23531974308852277, "overlap_percentage": 0.3809859664351852, "num_intersection": 379206, "num_union": 1611450, "num_only_computed": 616122, "num_only_roped": 616122, "total_diff": 1232244, "diff_percentage": 0.7646802569114772, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:49:36.647807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.1788793103448276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:50:19.576392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.232724996388501, "overlap_percentage": 0.377578125, "num_intersection": 415638, "num_union": 1785962, "num_only_computed": 685162, "num_only_roped": 685162, "total_diff": 1370324, "diff_percentage": 0.767275003611499, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:50:21.030430", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 2.7060508728027344e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1274703557312253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:51:09.527806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2011670349985923, "overlap_percentage": 0.3349526404524214, "num_intersection": 403701, "num_union": 2006795, "num_only_computed": 801547, "num_only_roped": 801547, "total_diff": 1603094, "diff_percentage": 0.7988329650014078, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:51:11.217661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.4777777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:52:05.959805", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1680991786357056, "overlap_percentage": 0.28781661987304685, "num_intersection": 377247, "num_union": 2244193, "num_only_computed": 933473, "num_only_roped": 933473, "total_diff": 1866946, "diff_percentage": 0.8319008213642944, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:52:07.849982", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 9.441375732421875e-05, "l2_diff": 3.75, "l2_diff_relative": 0.967741935483871}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:53:09.415059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15494973912660256, "overlap_percentage": 0.26832291289797394, "num_intersection": 379722, "num_union": 2450614, "num_only_computed": 1035446, "num_only_roped": 1035446, "total_diff": 2070892, "diff_percentage": 0.8450502608733974, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:53:14.059053", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.62939453125e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.7181818181818181}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:54:22.404160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15098140278736646, "overlap_percentage": 0.26235246272742585, "num_intersection": 398675, "num_union": 2640557, "num_only_computed": 1120941, "num_only_roped": 1120941, "total_diff": 2241882, "diff_percentage": 0.8490185972126335, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:54:24.791199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.515625, "l2_diff_relative": 0.6617647058823529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:39.959876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14499461881670334, "overlap_percentage": 0.2532669000078765, "num_intersection": 411581, "num_union": 2838595, "num_only_computed": 1213507, "num_only_roped": 1213507, "total_diff": 2427014, "diff_percentage": 0.8550053811832967, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:43.189142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.295608520507812e-05, "l2_diff": 3.484375, "l2_diff_relative": 0.832089552238806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:57:05.279000", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13903137918385278, "overlap_percentage": 0.24412212292776792, "num_intersection": 422218, "num_union": 3036854, "num_only_computed": 1307318, "num_only_roped": 1307318, "total_diff": 2614636, "diff_percentage": 0.8609686208161472, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:57:08.580687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.375, "l2_diff_relative": 0.7941176470588235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:58:37.258419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1333303276020626, "overlap_percentage": 0.23528943743024552, "num_intersection": 431758, "num_union": 3238258, "num_only_computed": 1403250, "num_only_roped": 1403250, "total_diff": 2806500, "diff_percentage": 0.8666696723979375, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:58:42.854654", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.640625, "l2_diff_relative": 0.9471544715447154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:00:18.486108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1298881115598933, "overlap_percentage": 0.22991322809932613, "num_intersection": 398504, "num_union": 3068056, "num_only_computed": 1334776, "num_only_roped": 1334776, "total_diff": 2669552, "diff_percentage": 0.8701118884401067, "num_computed": 1733280, "num_roped": 1733280}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "mask_shape": [1, 32, 920, 16280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:00:23.000179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.67572021484375e-05, "l2_diff": 3.734375, "l2_diff_relative": 0.991701244813278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "attention_shape": [1, 32, 920, 16280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:01:51.806217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13168720423558075, "overlap_percentage": 0.23272721250662426, "num_intersection": 14053, "num_union": 106715, "num_only_computed": 46331, "num_only_roped": 46331, "total_diff": 92662, "diff_percentage": 0.8683127957644192, "num_computed": 60384, "num_roped": 60384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "mask_shape": [1, 32, 32, 16312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:01:56.004239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.42723880597014924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "attention_shape": [1, 32, 32, 16312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:03:04.684630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14467697907188354, "overlap_percentage": 0.2527821939586645, "num_intersection": 477, "num_union": 3297, "num_only_computed": 1410, "num_only_roped": 1410, "total_diff": 2820, "diff_percentage": 0.8553230209281165, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "mask_shape": [1, 32, 1, 16313], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:03:07.515436", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0172119140625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.052001953125, "l2_diff_relative": 0.3597972972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "attention_shape": [1, 32, 1, 16313]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:05.276977", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13640469738030714, "overlap_percentage": 0.24006359300476948, "num_intersection": 453, "num_union": 3321, "num_only_computed": 1434, "num_only_roped": 1434, "total_diff": 2868, "diff_percentage": 0.8635953026196929, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "mask_shape": [1, 32, 1, 16314], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:07.156557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.6716461181640625e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2366504854368932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "attention_shape": [1, 32, 1, 16314]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:40.375999", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:42.124241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031398338607594935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:48.002375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5240708325379286, "overlap_percentage": 0.6877250339673913, "num_intersection": 323946, "num_union": 618134, "num_only_computed": 147094, "num_only_roped": 147094, "total_diff": 294188, "diff_percentage": 0.4759291674620713, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:48.383289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.08895985401459854}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:05:03.637286", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4129590029839406, "overlap_percentage": 0.5845307643206039, "num_intersection": 336989, "num_union": 816035, "num_only_computed": 239523, "num_only_roped": 239523, "total_diff": 479046, "diff_percentage": 0.5870409970160594, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:05:04.176442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.13157894736842105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:05:23.656556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3436715960539907, "overlap_percentage": 0.5115410596804512, "num_intersection": 348339, "num_union": 1013581, "num_only_computed": 332621, "num_only_roped": 332621, "total_diff": 665242, "diff_percentage": 0.6563284039460092, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:05:24.376218", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:05:50.696509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28700795100927984, "overlap_percentage": 0.44600804646809894, "num_intersection": 350755, "num_union": 1222109, "num_only_computed": 435677, "num_only_roped": 435677, "total_diff": 871354, "diff_percentage": 0.7129920489907201, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:05:52.094638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.5234375, "l2_diff_relative": 0.21195652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:06:23.309268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2530151661980706, "overlap_percentage": 0.4038501257183908, "num_intersection": 359782, "num_union": 1421978, "num_only_computed": 531098, "num_only_roped": 531098, "total_diff": 1062196, "diff_percentage": 0.7469848338019294, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:06:24.394861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.1826171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:07:01.053047", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23201922059306818, "overlap_percentage": 0.37664870273919754, "num_intersection": 374889, "num_union": 1615767, "num_only_computed": 620439, "num_only_roped": 620439, "total_diff": 1240878, "diff_percentage": 0.7679807794069318, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:07:02.315075", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.601478576660156e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.20816326530612245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:07:44.867876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2254128449047906, "overlap_percentage": 0.3678969840116279, "num_intersection": 404981, "num_union": 1796619, "num_only_computed": 695819, "num_only_roped": 695819, "total_diff": 1391638, "diff_percentage": 0.7745871550952094, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:07:46.347207", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:08:33.983409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2081433154554891, "overlap_percentage": 0.34456725918649106, "num_intersection": 415289, "num_union": 1995207, "num_only_computed": 789959, "num_only_roped": 789959, "total_diff": 1579918, "diff_percentage": 0.791856684544511, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:08:37.739698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.3482587064676617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:09:28.060572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1701840108119347, "overlap_percentage": 0.2908670931058991, "num_intersection": 166974, "num_union": 981138, "num_only_computed": 407082, "num_only_roped": 407082, "total_diff": 814164, "diff_percentage": 0.8298159891880653, "num_computed": 574056, "num_roped": 574056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "mask_shape": [1, 32, 469, 9685], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:09:29.689286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.5352697095435685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "attention_shape": [1, 32, 469, 9685]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:10:18.932431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15778704650979775, "overlap_percentage": 0.27256661228928764, "num_intersection": 8020, "num_union": 50828, "num_only_computed": 21404, "num_only_roped": 21404, "total_diff": 42808, "diff_percentage": 0.8422129534902022, "num_computed": 29424, "num_roped": 29424}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "mask_shape": [1, 32, 24, 9709], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:10:20.269296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.2353515625, "l2_diff_relative": 0.20633561643835616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "attention_shape": [1, 32, 24, 9709]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:10:59.371489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15809344030202926, "overlap_percentage": 0.27302363488182557, "num_intersection": 335, "num_union": 2119, "num_only_computed": 892, "num_only_roped": 892, "total_diff": 1784, "diff_percentage": 0.8419065596979708, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 1, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:00.524211", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.18488372093023256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 1, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:35.684512", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.162482235907153, "overlap_percentage": 0.2795436022819886, "num_intersection": 343, "num_union": 2111, "num_only_computed": 884, "num_only_roped": 884, "total_diff": 1768, "diff_percentage": 0.837517764092847, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "mask_shape": [1, 32, 1, 9711], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:39.144743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0216064453125, "l2_diff_relative": 0.09335443037974683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "attention_shape": [1, 32, 1, 9711]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:58.215650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:58.224063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.029541015625, "l2_diff_relative": 0.0030298477564102565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:04.114169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.520921386988347, "overlap_percentage": 0.6850076426630435, "num_intersection": 322666, "num_union": 619414, "num_only_computed": 148374, "num_only_roped": 148374, "total_diff": 296748, "diff_percentage": 0.47907861301165294, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:06.206683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.08197463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:20.755383", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4028370054129158, "overlap_percentage": 0.5743176204484902, "num_intersection": 331101, "num_union": 821923, "num_only_computed": 245411, "num_only_roped": 245411, "total_diff": 490822, "diff_percentage": 0.5971629945870842, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:21.303681", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 8.153915405273438e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.14977477477477477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:36.652433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4041151058065461, "overlap_percentage": 0.5756153525239883, "num_intersection": 5519, "num_union": 13657, "num_only_computed": 4069, "num_only_roped": 4069, "total_diff": 8138, "diff_percentage": 0.5958848941934539, "num_computed": 9588, "num_roped": 9588}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "mask_shape": [1, 32, 17, 3089], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:37.081444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.125, "l2_diff_relative": 0.11267605633802817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "attention_shape": [1, 32, 17, 3089]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:50.787491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3912140801207946, "overlap_percentage": 0.5624067290733957, "num_intersection": 8291, "num_union": 21193, "num_only_computed": 6451, "num_only_roped": 6451, "total_diff": 12902, "diff_percentage": 0.6087859198792054, "num_computed": 14742, "num_roped": 14742}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "mask_shape": [1, 32, 26, 3115], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:51.245077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 9.393692016601562e-05, "l2_diff": 0.18359375, "l2_diff_relative": 0.15878378378378377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "attention_shape": [1, 32, 26, 3115]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:04.502301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3695652173913043, "overlap_percentage": 0.5396825396825397, "num_intersection": 306, "num_union": 828, "num_only_computed": 261, "num_only_roped": 261, "total_diff": 522, "diff_percentage": 0.6304347826086957, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "mask_shape": [1, 32, 1, 3116], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:04.913110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 9.250640869140625e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.17181069958847736}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "attention_shape": [1, 32, 1, 3116]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:17.454133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34679334916864607, "overlap_percentage": 0.5149911816578483, "num_intersection": 292, "num_union": 842, "num_only_computed": 275, "num_only_roped": 275, "total_diff": 550, "diff_percentage": 0.6532066508313539, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "mask_shape": [1, 32, 1, 3117], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:17.862502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 8.726119995117188e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.15649606299212598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "attention_shape": [1, 32, 1, 3117]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:29.597768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:29.611417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.003087197580645161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:35.493779", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5058655034230755, "overlap_percentage": 0.6718601392663044, "num_intersection": 316473, "num_union": 625607, "num_only_computed": 154567, "num_only_roped": 154567, "total_diff": 309134, "diff_percentage": 0.4941344965769245, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:35.882894", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 0.000125885009765625, "l2_diff": 1.25, "l2_diff_relative": 0.1652892561983471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:51.210962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39722209431113414, "overlap_percentage": 0.5685883381438721, "num_intersection": 327798, "num_union": 825226, "num_only_computed": 248714, "num_only_roped": 248714, "total_diff": 497428, "diff_percentage": 0.6027779056888658, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:51.766929", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 0.00011205673217773438, "l2_diff": 1.453125, "l2_diff_relative": 0.21232876712328766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:11.590025", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.339867126957408, "overlap_percentage": 0.5073146734022557, "num_intersection": 345461, "num_union": 1016459, "num_only_computed": 335499, "num_only_roped": 335499, "total_diff": 670998, "diff_percentage": 0.6601328730425919, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:12.314461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.25, "l2_diff_relative": 0.1724137931034483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:38.351814", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2965027667436832, "overlap_percentage": 0.45738855997721356, "num_intersection": 359705, "num_union": 1213159, "num_only_computed": 426727, "num_only_roped": 426727, "total_diff": 853454, "diff_percentage": 0.7034972332563167, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:39.888920", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.17266949152542374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:11.009175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2664592578060862, "overlap_percentage": 0.4207940463362069, "num_intersection": 374877, "num_union": 1406883, "num_only_computed": 516003, "num_only_roped": 516003, "total_diff": 1032006, "diff_percentage": 0.7335407421939137, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:12.107212", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.095703125, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.15406976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:48.963714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24065282953251527, "overlap_percentage": 0.38794548128858025, "num_intersection": 386133, "num_union": 1604523, "num_only_computed": 609195, "num_only_roped": 609195, "total_diff": 1218390, "diff_percentage": 0.7593471704674847, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:50.232036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.16015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:16:32.716474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21375173660881647, "overlap_percentage": 0.35221656976744187, "num_intersection": 387720, "num_union": 1813880, "num_only_computed": 713080, "num_only_roped": 713080, "total_diff": 1426160, "diff_percentage": 0.7862482633911836, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:16:34.176331", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08447265625, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.546875, "l2_diff_relative": 0.21710526315789475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:17:22.709855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19397094442985996, "overlap_percentage": 0.32491736140611727, "num_intersection": 391606, "num_union": 2018890, "num_only_computed": 813642, "num_only_roped": 813642, "total_diff": 1627284, "diff_percentage": 0.80602905557014, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:17:26.013031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.888938903808594e-05, "l2_diff": 2.375, "l2_diff_relative": 0.36893203883495146}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:18:21.129528", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1559294829395631, "overlap_percentage": 0.2697906494140625, "num_intersection": 353620, "num_union": 2267820, "num_only_computed": 957100, "num_only_roped": 957100, "total_diff": 1914200, "diff_percentage": 0.8440705170604369, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:18:23.038768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 9.1552734375e-05, "l2_diff": 3.46875, "l2_diff_relative": 0.8844621513944223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:19:24.536633", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14737242368446868, "overlap_percentage": 0.25688681485166426, "num_intersection": 363538, "num_union": 2466798, "num_only_computed": 1051630, "num_only_roped": 1051630, "total_diff": 2103260, "diff_percentage": 0.8526275763155313, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:19:26.706535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 8.535385131835938e-05, "l2_diff": 3.734375, "l2_diff_relative": 0.8984962406015038}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:20:35.718138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1375456864333984, "overlap_percentage": 0.24182885676381402, "num_intersection": 367487, "num_union": 2671745, "num_only_computed": 1152129, "num_only_roped": 1152129, "total_diff": 2304258, "diff_percentage": 0.8624543135666016, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:20:40.580648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2109375, "mean_diff": 7.62939453125e-05, "l2_diff": 3.96875, "l2_diff_relative": 0.7888198757763976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:21:56.628780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13658771481655943, "overlap_percentage": 0.24034698428638943, "num_intersection": 390585, "num_union": 2859591, "num_only_computed": 1234503, "num_only_roped": 1234503, "total_diff": 2469006, "diff_percentage": 0.8634122851834406, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:22:00.681197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 6.961822509765625e-05, "l2_diff": 3.953125, "l2_diff_relative": 0.7146892655367232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:23:24.083556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13642089078562206, "overlap_percentage": 0.2400886711811723, "num_intersection": 415242, "num_union": 3043830, "num_only_computed": 1314294, "num_only_roped": 1314294, "total_diff": 2628588, "diff_percentage": 0.863579109214378, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:23:26.969536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 6.389617919921875e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.7861635220125787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:24:56.961106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12409942263809975, "overlap_percentage": 0.2207979474748884, "num_intersection": 405166, "num_union": 3264850, "num_only_computed": 1429842, "num_only_roped": 1429842, "total_diff": 2859684, "diff_percentage": 0.8759005773619002, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:25:01.185646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2021484375, "mean_diff": 7.104873657226562e-05, "l2_diff": 4.375, "l2_diff_relative": 1.0526315789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:26:38.090162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11865954608083004, "overlap_percentage": 0.21214595002840328, "num_intersection": 326398, "num_union": 2750710, "num_only_computed": 1212156, "num_only_roped": 1212156, "total_diff": 2424312, "diff_percentage": 0.8813404539191699, "num_computed": 1538554, "num_roped": 1538554}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "mask_shape": [1, 32, 821, 16181], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:26:41.760370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 6.246566772460938e-05, "l2_diff": 3.890625, "l2_diff_relative": 0.8892857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "attention_shape": [1, 32, 821, 16181]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:10.748492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1132858837485172, "overlap_percentage": 0.2035162493340437, "num_intersection": 11460, "num_union": 101160, "num_only_computed": 44850, "num_only_roped": 44850, "total_diff": 89700, "diff_percentage": 0.8867141162514828, "num_computed": 56310, "num_roped": 56310}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "mask_shape": [1, 32, 30, 16211], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:13.720795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.6244725738396625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "attention_shape": [1, 32, 30, 16211]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:29:22.602781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12665066026410565, "overlap_percentage": 0.22482685135855088, "num_intersection": 422, "num_union": 3332, "num_only_computed": 1455, "num_only_roped": 1455, "total_diff": 2910, "diff_percentage": 0.8733493397358943, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "mask_shape": [1, 32, 1, 16212], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:29:26.246829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.08251953125, "l2_diff_relative": 0.7316017316017316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "attention_shape": [1, 32, 1, 16212]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:01.242589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:01.256271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:07.303106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5109930647779254, "overlap_percentage": 0.6763671875, "num_intersection": 318596, "num_union": 623484, "num_only_computed": 152444, "num_only_roped": 152444, "total_diff": 304888, "diff_percentage": 0.48900693522207467, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:07.706199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.08678057553956835}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:22.813776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40724747878493484, "overlap_percentage": 0.57878587089254, "num_intersection": 333677, "num_union": 819347, "num_only_computed": 242835, "num_only_roped": 242835, "total_diff": 485670, "diff_percentage": 0.5927525212150652, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:23.386734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.10994525547445255}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:44.971448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34337471209946685, "overlap_percentage": 0.5112121123120301, "num_intersection": 348115, "num_union": 1013805, "num_only_computed": 332845, "num_only_roped": 332845, "total_diff": 665690, "diff_percentage": 0.6566252879005331, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:47.825366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.9802322387695312e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.06525157232704402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:31:14.283102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2895202864901027, "overlap_percentage": 0.44903564453125, "num_intersection": 353136, "num_union": 1219728, "num_only_computed": 433296, "num_only_roped": 433296, "total_diff": 866592, "diff_percentage": 0.7104797135098972, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:31:16.618232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.10492700729927007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:31:47.592497", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27551188418911043, "overlap_percentage": 0.4320020653735632, "num_intersection": 384862, "num_union": 1396898, "num_only_computed": 506018, "num_only_roped": 506018, "total_diff": 1012036, "diff_percentage": 0.7244881158108896, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:31:48.674519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.719329833984375e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.1309055118110236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:32:25.292858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24360271053534135, "overlap_percentage": 0.3917693463863169, "num_intersection": 389939, "num_union": 1600717, "num_only_computed": 605389, "num_only_roped": 605389, "total_diff": 1210778, "diff_percentage": 0.7563972894646587, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:32:26.600730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07470703125, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.15935114503816794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:33:09.155419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2205378105605127, "overlap_percentage": 0.3613780886627907, "num_intersection": 397805, "num_union": 1803795, "num_only_computed": 702995, "num_only_roped": 702995, "total_diff": 1405990, "diff_percentage": 0.7794621894394873, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:33:10.657038", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.4765625, "l2_diff_relative": 0.19207317073170732}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:33:58.857766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1841220780062898, "overlap_percentage": 0.3109849591121495, "num_intersection": 374814, "num_union": 2035682, "num_only_computed": 830434, "num_only_roped": 830434, "total_diff": 1660868, "diff_percentage": 0.8158779219937102, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:34:02.476448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.3978260869565217}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:34:56.542137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1469202855750308, "overlap_percentage": 0.25619964599609374, "num_intersection": 335806, "num_union": 2285634, "num_only_computed": 974914, "num_only_roped": 974914, "total_diff": 1949828, "diff_percentage": 0.8530797144249692, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:34:59.639710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 8.0108642578125e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.6910112359550562}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:35:59.879594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13561437669594706, "overlap_percentage": 0.23883878097865413, "num_intersection": 337997, "num_union": 2492339, "num_only_computed": 1077171, "num_only_roped": 1077171, "total_diff": 2154342, "diff_percentage": 0.8643856233040529, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:36:01.961501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 9.059906005859375e-05, "l2_diff": 4.5625, "l2_diff_relative": 0.9864864864864865}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:37:09.252474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13912833911724481, "overlap_percentage": 0.24427157913578168, "num_intersection": 371199, "num_union": 2668033, "num_only_computed": 1148417, "num_only_roped": 1148417, "total_diff": 2296834, "diff_percentage": 0.8608716608827552, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:37:11.581123", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.65625, "l2_diff_relative": 1.0205479452054795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:38:27.459113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13979674140990483, "overlap_percentage": 0.24530117753623187, "num_intersection": 398636, "num_union": 2851540, "num_only_computed": 1226452, "num_only_roped": 1226452, "total_diff": 2452904, "diff_percentage": 0.8602032585900952, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:38:30.043125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2041015625, "mean_diff": 7.581710815429688e-05, "l2_diff": 4.5625, "l2_diff_relative": 0.9125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:39:52.092008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13141917373775303, "overlap_percentage": 0.23230854980757845, "num_intersection": 401786, "num_union": 3057286, "num_only_computed": 1327750, "num_only_roped": 1327750, "total_diff": 2655500, "diff_percentage": 0.868580826262247, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:39:54.936473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 7.05718994140625e-05, "l2_diff": 4.4375, "l2_diff_relative": 0.9161290322580645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:41:24.718478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1302191568540256, "overlap_percentage": 0.23043169294084823, "num_intersection": 422844, "num_union": 3247172, "num_only_computed": 1412164, "num_only_roped": 1412164, "total_diff": 2824328, "diff_percentage": 0.8697808431459744, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:41:28.382052", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 5.888938903808594e-05, "l2_diff": 3.875, "l2_diff_relative": 0.779874213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:43:04.517913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13470734417063704, "overlap_percentage": 0.23743099022434772, "num_intersection": 432132, "num_union": 3207932, "num_only_computed": 1387900, "num_only_roped": 1387900, "total_diff": 2775800, "diff_percentage": 0.865292655829363, "num_computed": 1820032, "num_roped": 1820032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:43:07.800735", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 4.982948303222656e-05, "l2_diff": 3.140625, "l2_diff_relative": 0.6165644171779141}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:44:37.990105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13408336202396687, "overlap_percentage": 0.23646121002017353, "num_intersection": 12073, "num_union": 90041, "num_only_computed": 38984, "num_only_roped": 38984, "total_diff": 77968, "diff_percentage": 0.8659166379760331, "num_computed": 51057, "num_roped": 51057}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 27, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:44:41.456362", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.39453125, "l2_diff_relative": 0.37969924812030076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 27, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:45:50.393445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15269734836939958, "overlap_percentage": 0.26493918561607616, "num_intersection": 501, "num_union": 3281, "num_only_computed": 1390, "num_only_roped": 1390, "total_diff": 2780, "diff_percentage": 0.8473026516306005, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:45:52.316425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.1015625, "l2_diff_relative": 1.7854077253218885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:46:51.353927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13267445342917042, "overlap_percentage": 0.23426758328926495, "num_intersection": 443, "num_union": 3339, "num_only_computed": 1448, "num_only_roped": 1448, "total_diff": 2896, "diff_percentage": 0.8673255465708296, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:46:53.270676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.07763671875, "l2_diff_relative": 0.8238341968911918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:47:52.364195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13267445342917042, "overlap_percentage": 0.23426758328926495, "num_intersection": 443, "num_union": 3339, "num_only_computed": 1448, "num_only_roped": 1448, "total_diff": 2896, "diff_percentage": 0.8673255465708296, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:47:54.817487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.045166015625, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.09228515625, "l2_diff_relative": 1.0558659217877095}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:48:53.741249", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1371016235718581, "overlap_percentage": 0.24114225277630882, "num_intersection": 456, "num_union": 3326, "num_only_computed": 1435, "num_only_roped": 1435, "total_diff": 2870, "diff_percentage": 0.8628983764281419, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:48:55.654327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.0537109375, "l2_diff_relative": 0.3005464480874317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:30.830423", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:30.843022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.003022989649681529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:36.911354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5087136025726027, "overlap_percentage": 0.6743673573369565, "num_intersection": 317654, "num_union": 624426, "num_only_computed": 153386, "num_only_roped": 153386, "total_diff": 306772, "diff_percentage": 0.4912863974273973, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:37.313398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.00011110305786132812, "l2_diff": 1.0859375, "l2_diff_relative": 0.1373517786561265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:53.252852", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4042755830423551, "overlap_percentage": 0.5757781277753108, "num_intersection": 331943, "num_union": 821081, "num_only_computed": 244569, "num_only_roped": 244569, "total_diff": 489138, "diff_percentage": 0.5957244169576449, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:53.817468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 7.43865966796875e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.13796296296296295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:13.606152", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3428025205154219, "overlap_percentage": 0.5105777138157894, "num_intersection": 347683, "num_union": 1014237, "num_only_computed": 333277, "num_only_roped": 333277, "total_diff": 666554, "diff_percentage": 0.6571974794845781, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:14.340178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.10264598540145986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:39.550768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31113082099057704, "overlap_percentage": 0.4745992024739583, "num_intersection": 373240, "num_union": 1199624, "num_only_computed": 413192, "num_only_roped": 413192, "total_diff": 826384, "diff_percentage": 0.6888691790094229, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:40.805382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.9591064453125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.14556962025316456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:11.720432", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2589060879346355, "overlap_percentage": 0.41131914511494255, "num_intersection": 366436, "num_union": 1415324, "num_only_computed": 524444, "num_only_roped": 524444, "total_diff": 1048888, "diff_percentage": 0.7410939120653646, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:12.796531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:49.469322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23118332772577038, "overlap_percentage": 0.37554655349794236, "num_intersection": 373792, "num_union": 1616864, "num_only_computed": 621536, "num_only_roped": 621536, "total_diff": 1243072, "diff_percentage": 0.7688166722742297, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:50.740904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.15716911764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:52:32.923448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22984725784170074, "overlap_percentage": 0.3737817950581395, "num_intersection": 411459, "num_union": 1790141, "num_only_computed": 689341, "num_only_roped": 689341, "total_diff": 1378682, "diff_percentage": 0.7701527421582992, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:52:34.389767", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.11676356589147287}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:53:22.975450", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19893977835617896, "overlap_percentage": 0.3318595011151232, "num_intersection": 399973, "num_union": 2010523, "num_only_computed": 805275, "num_only_roped": 805275, "total_diff": 1610550, "diff_percentage": 0.8010602216438211, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:53:26.639145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.3419811320754717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:54:21.606706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16939561628314162, "overlap_percentage": 0.2897148132324219, "num_intersection": 379735, "num_union": 2241705, "num_only_computed": 930985, "num_only_roped": 930985, "total_diff": 1861970, "diff_percentage": 0.8306043837168584, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:54:23.503846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.8618421052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:55:25.163359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15894544389916324, "overlap_percentage": 0.2742932287897974, "num_intersection": 388171, "num_union": 2442165, "num_only_computed": 1026997, "num_only_roped": 1026997, "total_diff": 2053994, "diff_percentage": 0.8410545561008368, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:55:29.875276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 8.296966552734375e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.8618421052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:56:38.605411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15720665013676766, "overlap_percentage": 0.2717002190026954, "num_intersection": 412880, "num_union": 2626352, "num_only_computed": 1106736, "num_only_roped": 1106736, "total_diff": 2213472, "diff_percentage": 0.8427933498632324, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:56:41.164631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.96875, "l2_diff_relative": 0.8581081081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:57:57.326880", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15435398745551537, "overlap_percentage": 0.2674292099873976, "num_intersection": 434596, "num_union": 2815580, "num_only_computed": 1190492, "num_only_roped": 1190492, "total_diff": 2380984, "diff_percentage": 0.8456460125444846, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:58:02.309422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 7.534027099609375e-05, "l2_diff": 3.953125, "l2_diff_relative": 0.9730769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:59:26.417020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14906966824833473, "overlap_percentage": 0.259461497187685, "num_intersection": 448748, "num_union": 3010324, "num_only_computed": 1280788, "num_only_roped": 1280788, "total_diff": 2561576, "diff_percentage": 0.8509303317516652, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:59:29.343837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.343292236328125e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.9626865671641791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:00:48.242965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14681490932288344, "overlap_percentage": 0.25603941513032424, "num_intersection": 22554, "num_union": 153622, "num_only_computed": 65534, "num_only_roped": 65534, "total_diff": 131068, "diff_percentage": 0.8531850906771166, "num_computed": 88088, "num_roped": 88088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "mask_shape": [1, 32, 52, 14388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:00:51.182234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.19977678571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "attention_shape": [1, 32, 52, 14388]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:01:59.235417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1436594406379872, "overlap_percentage": 0.2512276566489884, "num_intersection": 12790, "num_union": 89030, "num_only_computed": 38120, "num_only_roped": 38120, "total_diff": 76240, "diff_percentage": 0.8563405593620128, "num_computed": 50910, "num_roped": 50910}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "mask_shape": [1, 32, 30, 14418], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:02:01.399181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.330078125, "l2_diff_relative": 0.2725806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "attention_shape": [1, 32, 30, 14418]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:03:02.061715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14778491714575584, "overlap_percentage": 0.2575132586918091, "num_intersection": 437, "num_union": 2957, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.8522150828542442, "num_computed": 1697, "num_roped": 1697}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "mask_shape": [1, 32, 1, 14419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:03:03.759821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.09651360544217687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "attention_shape": [1, 32, 1, 14419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:03:56.569838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13768844221105528, "overlap_percentage": 0.2420494699646643, "num_intersection": 411, "num_union": 2985, "num_only_computed": 1287, "num_only_roped": 1287, "total_diff": 2574, "diff_percentage": 0.8623115577889447, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "mask_shape": [1, 32, 1, 14420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:03:58.302916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.06201171875, "l2_diff_relative": 0.2809734513274336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "attention_shape": [1, 32, 1, 14420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:04:50.305743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1380697050938338, "overlap_percentage": 0.24263839811542992, "num_intersection": 412, "num_union": 2984, "num_only_computed": 1286, "num_only_roped": 1286, "total_diff": 2572, "diff_percentage": 0.8619302949061662, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "mask_shape": [1, 32, 1, 14421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:04:51.961748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0108642578125, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.15186915887850466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "attention_shape": [1, 32, 1, 14421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:05:43.875459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1469098277608916, "overlap_percentage": 0.25618374558303886, "num_intersection": 435, "num_union": 2961, "num_only_computed": 1263, "num_only_roped": 1263, "total_diff": 2526, "diff_percentage": 0.8530901722391084, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14422, 128], "mask_shape": [1, 32, 1, 14422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:05:45.612137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023681640625, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.12121212121212122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14422, 128], "attention_shape": [1, 32, 1, 14422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:06:38.372987", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1523583305055989, "overlap_percentage": 0.26442873969375735, "num_intersection": 449, "num_union": 2947, "num_only_computed": 1249, "num_only_roped": 1249, "total_diff": 2498, "diff_percentage": 0.8476416694944011, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14423, 128], "mask_shape": [1, 32, 1, 14423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:06:40.061114", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0272216796875, "l2_diff_relative": 0.12279735682819383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14423, 128], "attention_shape": [1, 32, 1, 14423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:10.847659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:10.862455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:16.815777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5123417152544114, "overlap_percentage": 0.6775475543478261, "num_intersection": 319152, "num_union": 622928, "num_only_computed": 151888, "num_only_roped": 151888, "total_diff": 303776, "diff_percentage": 0.4876582847455886, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:18.317449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.08106884057971014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:32.815605", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41167021719434854, "overlap_percentage": 0.5832385102131439, "num_intersection": 336244, "num_union": 816780, "num_only_computed": 240268, "num_only_roped": 240268, "total_diff": 480536, "diff_percentage": 0.5883297828056515, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:33.361915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.7265625, "l2_diff_relative": 0.07404458598726114}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:53.573748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3417190775681342, "overlap_percentage": 0.509375, "num_intersection": 346864, "num_union": 1015056, "num_only_computed": 334096, "num_only_roped": 334096, "total_diff": 668192, "diff_percentage": 0.6582809224318659, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:54.321607", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.0859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:08:19.535892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2805721306149965, "overlap_percentage": 0.4381980895996094, "num_intersection": 344613, "num_union": 1228251, "num_only_computed": 441819, "num_only_roped": 441819, "total_diff": 883638, "diff_percentage": 0.7194278693850036, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:08:20.421544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 2.872943878173828e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.08232758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:08:51.075425", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26778121211086253, "overlap_percentage": 0.4224407327586207, "num_intersection": 376344, "num_union": 1405416, "num_only_computed": 514536, "num_only_roped": 514536, "total_diff": 1029072, "diff_percentage": 0.7322187878891374, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:08:54.677101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.0, "l2_diff_relative": 0.1322314049586777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:09:31.387738", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23884226955792262, "overlap_percentage": 0.38558947402263377, "num_intersection": 383788, "num_union": 1606868, "num_only_computed": 611540, "num_only_roped": 611540, "total_diff": 1223080, "diff_percentage": 0.7611577304420774, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:09:32.649616", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07373046875, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.17786561264822134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:10:17.652008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21169559230317928, "overlap_percentage": 0.3494204215116279, "num_intersection": 384642, "num_union": 1816958, "num_only_computed": 716158, "num_only_roped": 716158, "total_diff": 1432316, "diff_percentage": 0.7883044076968208, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:10:19.178649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.1812015503875969}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:11:09.273957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18100839323308748, "overlap_percentage": 0.3065319336767205, "num_intersection": 369447, "num_union": 2041049, "num_only_computed": 835801, "num_only_roped": 835801, "total_diff": 1671602, "diff_percentage": 0.8189916067669125, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:11:13.213538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.09375, "l2_diff_relative": 0.4230769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:12:08.774436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15800414973868662, "overlap_percentage": 0.2728904724121094, "num_intersection": 357683, "num_union": 2263757, "num_only_computed": 953037, "num_only_roped": 953037, "total_diff": 1906074, "diff_percentage": 0.8419958502613134, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:12:10.710172", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1953125, "mean_diff": 9.298324584960938e-05, "l2_diff": 4.625, "l2_diff_relative": 0.8757396449704142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:13:12.452139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15078494138808848, "overlap_percentage": 0.26205581245477566, "num_intersection": 370853, "num_union": 2459483, "num_only_computed": 1044315, "num_only_roped": 1044315, "total_diff": 2088630, "diff_percentage": 0.8492150586119115, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:13:14.616118", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1982421875, "mean_diff": 9.870529174804688e-05, "l2_diff": 4.96875, "l2_diff_relative": 1.1521739130434783}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:14:24.228435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14718432852186825, "overlap_percentage": 0.2566010097287736, "num_intersection": 389935, "num_union": 2649297, "num_only_computed": 1129681, "num_only_roped": 1129681, "total_diff": 2259362, "diff_percentage": 0.8528156714781318, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:14:27.430556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.21875, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.6875, "l2_diff_relative": 0.9433962264150944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:15:41.893610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14150286694871383, "overlap_percentage": 0.2479238047416509, "num_intersection": 402898, "num_union": 2847278, "num_only_computed": 1222190, "num_only_roped": 1222190, "total_diff": 2444380, "diff_percentage": 0.8584971330512862, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:15:44.447713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2119140625, "mean_diff": 8.249282836914062e-05, "l2_diff": 4.6875, "l2_diff_relative": 1.048951048951049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:17:04.808265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13650438069800377, "overlap_percentage": 0.24021795782989813, "num_intersection": 354886, "num_union": 2599814, "num_only_computed": 1122464, "num_only_roped": 1122464, "total_diff": 2244928, "diff_percentage": 0.8634956193019963, "num_computed": 1477350, "num_roped": 1477350}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:17:07.535614", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.915496826171875e-05, "l2_diff": 4.0, "l2_diff_relative": 1.024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:18:24.052000", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1371670291954048, "overlap_percentage": 0.24124341574070515, "num_intersection": 12549, "num_union": 91487, "num_only_computed": 39469, "num_only_roped": 39469, "total_diff": 78938, "diff_percentage": 0.8628329708045952, "num_computed": 52018, "num_roped": 52018}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 31, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:18:26.131675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.40625, "l2_diff_relative": 0.3939393939393939}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 31, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:24.667517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14227365554799182, "overlap_percentage": 0.24910607866507747, "num_intersection": 418, "num_union": 2938, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.8577263444520081, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:26.296776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052978515625, "mean_diff": 8.344650268554688e-05, "l2_diff": 0.099609375, "l2_diff_relative": 1.2289156626506024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:20:15.783694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14110846650799047, "overlap_percentage": 0.24731823599523242, "num_intersection": 415, "num_union": 2941, "num_only_computed": 1263, "num_only_roped": 1263, "total_diff": 2526, "diff_percentage": 0.8588915334920095, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:20:17.399192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.0830078125, "l2_diff_relative": 1.328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:21:07.051414", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12882610158089472, "overlap_percentage": 0.22824791418355184, "num_intersection": 383, "num_union": 2973, "num_only_computed": 1295, "num_only_roped": 1295, "total_diff": 2590, "diff_percentage": 0.8711738984191053, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:21:11.057950", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 9.012222290039062e-05, "l2_diff": 0.126953125, "l2_diff_relative": 1.5204678362573099}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:00.699690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14072059823249491, "overlap_percentage": 0.2467222884386174, "num_intersection": 414, "num_union": 2942, "num_only_computed": 1264, "num_only_roped": 1264, "total_diff": 2528, "diff_percentage": 0.8592794017675051, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "mask_shape": [1, 32, 1, 14229], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:02.287151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.051025390625, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.10986328125, "l2_diff_relative": 1.076555023923445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "attention_shape": [1, 32, 1, 14229]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:33.746683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:33.759202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.003142528044871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:39.553912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.511344549274151, "overlap_percentage": 0.6766750169836957, "num_intersection": 318741, "num_union": 623339, "num_only_computed": 152299, "num_only_roped": 152299, "total_diff": 304598, "diff_percentage": 0.48865545072584904, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:39.926810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 0.00012493133544921875, "l2_diff": 1.2421875, "l2_diff_relative": 0.15711462450592886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:54.911681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40393873937935754, "overlap_percentage": 0.5754364176287744, "num_intersection": 331746, "num_union": 821278, "num_only_computed": 244766, "num_only_roped": 244766, "total_diff": 489532, "diff_percentage": 0.5960612606206425, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:55.460753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 8.058547973632812e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.15816326530612246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:23:14.931845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3387515654090313, "overlap_percentage": 0.5060708411654136, "num_intersection": 344614, "num_union": 1017306, "num_only_computed": 336346, "num_only_roped": 336346, "total_diff": 672692, "diff_percentage": 0.6612484345909687, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:23:15.641499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 7.915496826171875e-05, "l2_diff": 1.359375, "l2_diff_relative": 0.19247787610619468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:23:41.020487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2939823384521218, "overlap_percentage": 0.45438385009765625, "num_intersection": 357342, "num_union": 1215522, "num_only_computed": 429090, "num_only_roped": 429090, "total_diff": 858180, "diff_percentage": 0.7060176615478782, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:23:42.771748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.18482905982905984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:24:13.363553", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2618652200240084, "overlap_percentage": 0.41504467492816094, "num_intersection": 369755, "num_union": 1412005, "num_only_computed": 521125, "num_only_roped": 521125, "total_diff": 1042250, "diff_percentage": 0.7381347799759916, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:24:14.409273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.2152777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:24:50.707655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24254934541101097, "overlap_percentage": 0.390405976723251, "num_intersection": 388582, "num_union": 1602074, "num_only_computed": 606746, "num_only_roped": 606746, "total_diff": 1213492, "diff_percentage": 0.757450654588989, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:24:52.147466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.7220458984375e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.2638190954773869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:25:34.026641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21678047270727577, "overlap_percentage": 0.35631813226744186, "num_intersection": 392235, "num_union": 1809365, "num_only_computed": 708565, "num_only_roped": 708565, "total_diff": 1417130, "diff_percentage": 0.7832195272927243, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:25:35.484390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 5.173683166503906e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.26732673267326734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:26:24.313998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.188885370643829, "overlap_percentage": 0.31775203111724726, "num_intersection": 382970, "num_union": 2027526, "num_only_computed": 822278, "num_only_roped": 822278, "total_diff": 1644556, "diff_percentage": 0.8111146293561711, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:26:27.590928", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.4557291666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:27:22.766379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1566368827139386, "overlap_percentage": 0.27084884643554685, "num_intersection": 355007, "num_union": 2266433, "num_only_computed": 955713, "num_only_roped": 955713, "total_diff": 1911426, "diff_percentage": 0.8433631172860614, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:27:25.133452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.486343383789062e-05, "l2_diff": 3.4375, "l2_diff_relative": 0.6111111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:25.752485", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14656181665128648, "overlap_percentage": 0.25565445233357453, "num_intersection": 361794, "num_union": 2468542, "num_only_computed": 1053374, "num_only_roped": 1053374, "total_diff": 2106748, "diff_percentage": 0.8534381833487136, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:27.859993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.62939453125e-05, "l2_diff": 3.25, "l2_diff_relative": 0.7482014388489209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:37.398865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14802369152665296, "overlap_percentage": 0.25787567385444743, "num_intersection": 391872, "num_union": 2647360, "num_only_computed": 1127744, "num_only_roped": 1127744, "total_diff": 2255488, "diff_percentage": 0.851976308473347, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:42.234821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.234375, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.4375, "l2_diff_relative": 1.0757575757575757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:57.320260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1442210811141927, "overlap_percentage": 0.25208604087901704, "num_intersection": 409662, "num_union": 2840514, "num_only_computed": 1215426, "num_only_roped": 1215426, "total_diff": 2430852, "diff_percentage": 0.8557789188858073, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:59.916536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.152557373046875e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:32:21.878174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13783017440445255, "overlap_percentage": 0.2422684465660154, "num_intersection": 419012, "num_union": 3040060, "num_only_computed": 1310524, "num_only_roped": 1310524, "total_diff": 2621048, "diff_percentage": 0.8621698255955474, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:32:24.692130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 7.390975952148438e-05, "l2_diff": 3.640625, "l2_diff_relative": 0.9789915966386554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:33:54.578602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12700422394428262, "overlap_percentage": 0.22538375854492188, "num_intersection": 413581, "num_union": 3256435, "num_only_computed": 1421427, "num_only_roped": 1421427, "total_diff": 2842854, "diff_percentage": 0.8729957760557173, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:33:57.673948", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 6.914138793945312e-05, "l2_diff": 3.546875, "l2_diff_relative": 0.908}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:35:31.313228", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12491787054034639, "overlap_percentage": 0.22209242792159214, "num_intersection": 195637, "num_union": 1566125, "num_only_computed": 685244, "num_only_roped": 685244, "total_diff": 1370488, "diff_percentage": 0.8750821294596536, "num_computed": 880881, "num_roped": 880881}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "mask_shape": [1, 32, 479, 15839], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:35:34.373602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 5.793571472167969e-05, "l2_diff": 1.65625, "l2_diff_relative": 0.572972972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "attention_shape": [1, 32, 479, 15839]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:37:01.064040", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1276526536294677, "overlap_percentage": 0.22640420916601284, "num_intersection": 19622, "num_union": 153714, "num_only_computed": 67046, "num_only_roped": 67046, "total_diff": 134092, "diff_percentage": 0.8723473463705322, "num_computed": 86668, "num_roped": 86668}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 47, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:37:04.099861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.43167701863354035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 47, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:38:13.498315", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1354679802955665, "overlap_percentage": 0.2386117136659436, "num_intersection": 440, "num_union": 3248, "num_only_computed": 1404, "num_only_roped": 1404, "total_diff": 2808, "diff_percentage": 0.8645320197044335, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "mask_shape": [1, 32, 1, 15887], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:38:16.123818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.4836273193359375e-05, "l2_diff": 0.07275390625, "l2_diff_relative": 0.5518518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "attention_shape": [1, 32, 1, 15887]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:39:13.601927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1372186247301881, "overlap_percentage": 0.2413232104121475, "num_intersection": 445, "num_union": 3243, "num_only_computed": 1399, "num_only_roped": 1399, "total_diff": 2798, "diff_percentage": 0.8627813752698119, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "mask_shape": [1, 32, 1, 15888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:39:15.480521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.032958984375, "mean_diff": 6.914138793945312e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.8055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "attention_shape": [1, 32, 1, 15888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:12.285776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13651771956856704, "overlap_percentage": 0.24023861171366595, "num_intersection": 443, "num_union": 3245, "num_only_computed": 1401, "num_only_roped": 1401, "total_diff": 2802, "diff_percentage": 0.8634822804314329, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "mask_shape": [1, 32, 1, 15889], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:14.060117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.0869140625, "l2_diff_relative": 0.726530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "attention_shape": [1, 32, 1, 15889]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:48.283105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:48.295651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0031754032258064515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:54.066705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5119800602493753, "overlap_percentage": 0.6772312330163044, "num_intersection": 319003, "num_union": 623077, "num_only_computed": 152037, "num_only_roped": 152037, "total_diff": 304074, "diff_percentage": 0.48801993975062474, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:54.447504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 0.00010013580322265625, "l2_diff": 1.0390625, "l2_diff_relative": 0.1259469696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:41:09.225487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3968953949448704, "overlap_percentage": 0.5682535662744227, "num_intersection": 327605, "num_union": 825419, "num_only_computed": 248907, "num_only_roped": 248907, "total_diff": 497814, "diff_percentage": 0.6031046050551295, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:41:09.750602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.1455357142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:41:29.165007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34353374075773047, "overlap_percentage": 0.5113883341165414, "num_intersection": 348235, "num_union": 1013685, "num_only_computed": 332725, "num_only_roped": 332725, "total_diff": 665450, "diff_percentage": 0.6564662592422695, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:41:29.934350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.80078125, "l2_diff_relative": 0.08429276315789473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:41:55.759987", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2906059069403349, "overlap_percentage": 0.45034027099609375, "num_intersection": 354162, "num_union": 1218702, "num_only_computed": 432270, "num_only_roped": 432270, "total_diff": 864540, "diff_percentage": 0.7093940930596652, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:41:58.506498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.11517857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:42:28.927917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25392696686146676, "overlap_percentage": 0.40501077586206896, "num_intersection": 360816, "num_union": 1420944, "num_only_computed": 530064, "num_only_roped": 530064, "total_diff": 1060128, "diff_percentage": 0.7460730331385332, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:42:29.994256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.15391791044776118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:43:05.907966", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24168129371741662, "overlap_percentage": 0.3892807195216049, "num_intersection": 387462, "num_union": 1603194, "num_only_computed": 607866, "num_only_roped": 607866, "total_diff": 1215732, "diff_percentage": 0.7583187062825834, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:43:08.191258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.17782426778242677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:43:49.691338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22391073278986715, "overlap_percentage": 0.3658938953488372, "num_intersection": 402776, "num_union": 1798824, "num_only_computed": 698024, "num_only_roped": 698024, "total_diff": 1396048, "diff_percentage": 0.7760892672101328, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:43:51.136244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.375, "l2_diff_relative": 0.19047619047619047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:44:38.827878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19258277097227444, "overlap_percentage": 0.3229675552251487, "num_intersection": 389256, "num_union": 2021240, "num_only_computed": 815992, "num_only_roped": 815992, "total_diff": 1631984, "diff_percentage": 0.8074172290277255, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:44:40.484321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.297244094488189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:45:38.269113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16547915338439062, "overlap_percentage": 0.28396759033203123, "num_intersection": 372202, "num_union": 2249238, "num_only_computed": 938518, "num_only_roped": 938518, "total_diff": 1877036, "diff_percentage": 0.8345208466156093, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:45:42.540584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19140625, "mean_diff": 9.489059448242188e-05, "l2_diff": 4.78125, "l2_diff_relative": 0.9161676646706587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:46:44.555943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15862236096749446, "overlap_percentage": 0.2738120138386397, "num_intersection": 387490, "num_union": 2442846, "num_only_computed": 1027678, "num_only_roped": 1027678, "total_diff": 2055356, "diff_percentage": 0.8413776390325055, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:46:46.733750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2099609375, "mean_diff": 9.250640869140625e-05, "l2_diff": 4.96875, "l2_diff_relative": 1.0324675324675325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:47:57.667769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.157475046110758, "overlap_percentage": 0.27210097814184636, "num_intersection": 413489, "num_union": 2625743, "num_only_computed": 1106127, "num_only_roped": 1106127, "total_diff": 2212254, "diff_percentage": 0.842524953889242, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:48:02.517973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1806640625, "mean_diff": 7.772445678710938e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.8411764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:18.160558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15649521930765625, "overlap_percentage": 0.27063703627126656, "num_intersection": 439809, "num_union": 2810367, "num_only_computed": 1185279, "num_only_roped": 1185279, "total_diff": 2370558, "diff_percentage": 0.8435047806923437, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:20.764289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2265625, "mean_diff": 8.249282836914062e-05, "l2_diff": 4.75, "l2_diff_relative": 1.178294573643411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:50:40.183395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15347761115310912, "overlap_percentage": 0.2661128567544203, "num_intersection": 218249, "num_union": 1422025, "num_only_computed": 601888, "num_only_roped": 601888, "total_diff": 1203776, "diff_percentage": 0.8465223888468909, "num_computed": 820137, "num_roped": 820137}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "mask_shape": [1, 32, 501, 13813], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:50:42.821227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.9490740740740741}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "attention_shape": [1, 32, 501, 13813]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:51:53.975602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14728103721667754, "overlap_percentage": 0.2567479674796748, "num_intersection": 12632, "num_union": 85768, "num_only_computed": 36568, "num_only_roped": 36568, "total_diff": 73136, "diff_percentage": 0.8527189627833225, "num_computed": 49200, "num_roped": 49200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "mask_shape": [1, 32, 30, 13843], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:51:56.737260", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08154296875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.2962328767123288}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "attention_shape": [1, 32, 30, 13843]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:52:52.691707", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1586012009890498, "overlap_percentage": 0.27378048780487807, "num_intersection": 449, "num_union": 2831, "num_only_computed": 1191, "num_only_roped": 1191, "total_diff": 2382, "diff_percentage": 0.8413987990109502, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "mask_shape": [1, 32, 1, 13844], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:52:54.944679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.6702880859375e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.13846153846153847}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "attention_shape": [1, 32, 1, 13844]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:53:43.140335", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15128115128115127, "overlap_percentage": 0.2628048780487805, "num_intersection": 431, "num_union": 2849, "num_only_computed": 1209, "num_only_roped": 1209, "total_diff": 2418, "diff_percentage": 0.8487188487188487, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "mask_shape": [1, 32, 1, 13845], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:53:44.690621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.022216796875, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.1480392156862745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "attention_shape": [1, 32, 1, 13845]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:54:32.815043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14605171208944795, "overlap_percentage": 0.2548780487804878, "num_intersection": 418, "num_union": 2862, "num_only_computed": 1222, "num_only_roped": 1222, "total_diff": 2444, "diff_percentage": 0.8539482879105521, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "mask_shape": [1, 32, 1, 13846], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:54:34.377093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.13060538116591927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "attention_shape": [1, 32, 1, 13846]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:55:22.555565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1484593837535014, "overlap_percentage": 0.25853658536585367, "num_intersection": 424, "num_union": 2856, "num_only_computed": 1216, "num_only_roped": 1216, "total_diff": 2432, "diff_percentage": 0.8515406162464986, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "mask_shape": [1, 32, 1, 13847], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:55:25.022583", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.1447841726618705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "attention_shape": [1, 32, 1, 13847]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:56:14.434931", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15533638605142655, "overlap_percentage": 0.26890243902439026, "num_intersection": 441, "num_union": 2839, "num_only_computed": 1199, "num_only_roped": 1199, "total_diff": 2398, "diff_percentage": 0.8446636139485735, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "mask_shape": [1, 32, 1, 13848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:56:15.973117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.18275862068965518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "attention_shape": [1, 32, 1, 13848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:57:03.950793", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14126652748782184, "overlap_percentage": 0.2475609756097561, "num_intersection": 406, "num_union": 2874, "num_only_computed": 1234, "num_only_roped": 1234, "total_diff": 2468, "diff_percentage": 0.8587334725121781, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "mask_shape": [1, 32, 1, 13849], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:57:05.918290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.02685546875, "l2_diff_relative": 0.09963768115942029}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "attention_shape": [1, 32, 1, 13849]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:57:53.676096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13642659279778394, "overlap_percentage": 0.2400975015234613, "num_intersection": 394, "num_union": 2888, "num_only_computed": 1247, "num_only_roped": 1247, "total_diff": 2494, "diff_percentage": 0.8635734072022161, "num_computed": 1641, "num_roped": 1641}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "mask_shape": [1, 32, 1, 13850], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:57:55.240768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0174560546875, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.19154228855721392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "attention_shape": [1, 32, 1, 13850]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:24.604580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:24.617130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003045333059210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:30.283841", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5046052663100853, "overlap_percentage": 0.670747707201087, "num_intersection": 315949, "num_union": 626131, "num_only_computed": 155091, "num_only_roped": 155091, "total_diff": 310182, "diff_percentage": 0.4953947336899147, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:30.680638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 0.00010061264038085938, "l2_diff": 0.9765625, "l2_diff_relative": 0.12703252032520326}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:44.901630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3982217608738886, "overlap_percentage": 0.5696117340142096, "num_intersection": 328388, "num_union": 824636, "num_only_computed": 248124, "num_only_roped": 248124, "total_diff": 496248, "diff_percentage": 0.6017782391261114, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:45.434773", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 9.012222290039062e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.1711111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:59:05.696926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32797432042138847, "overlap_percentage": 0.4939467810150376, "num_intersection": 336358, "num_union": 1025562, "num_only_computed": 344602, "num_only_roped": 344602, "total_diff": 689204, "diff_percentage": 0.6720256795786115, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:59:06.403816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.18835616438356165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:59:31.076638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28884296470985416, "overlap_percentage": 0.44822057088216144, "num_intersection": 352495, "num_union": 1220369, "num_only_computed": 433937, "num_only_roped": 433937, "total_diff": 867874, "diff_percentage": 0.7111570352901458, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:59:31.940291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.2079207920792079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:00:02.252251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26259487566867373, "overlap_percentage": 0.415960623204023, "num_intersection": 370571, "num_union": 1411189, "num_only_computed": 520309, "num_only_roped": 520309, "total_diff": 1040618, "diff_percentage": 0.7374051243313263, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:00:03.318868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 6.079673767089844e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.23241206030150754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:00:41.709498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24287207381351075, "overlap_percentage": 0.39082392939814814, "num_intersection": 388998, "num_union": 1601658, "num_only_computed": 606330, "num_only_roped": 606330, "total_diff": 1212660, "diff_percentage": 0.7571279261864893, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:00:42.972511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.17410714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:01:25.918279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22124193248666624, "overlap_percentage": 0.36232285610465115, "num_intersection": 398845, "num_union": 1802755, "num_only_computed": 701955, "num_only_roped": 701955, "total_diff": 1403910, "diff_percentage": 0.7787580675133338, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:01:29.838595", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.1782608695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:02:19.291345", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20422320605165004, "overlap_percentage": 0.3391783267841971, "num_intersection": 408794, "num_union": 2001702, "num_only_computed": 796454, "num_only_roped": 796454, "total_diff": 1592908, "diff_percentage": 0.79577679394835, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:02:20.966313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.5, "l2_diff_relative": 0.37037037037037035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:03:17.039661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1698538084376884, "overlap_percentage": 0.29038467407226565, "num_intersection": 380613, "num_union": 2240827, "num_only_computed": 930107, "num_only_roped": 930107, "total_diff": 1860214, "diff_percentage": 0.8301461915623116, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:03:18.959969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 9.298324584960938e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.85}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:04:23.133232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1589122258914478, "overlap_percentage": 0.27424376469790157, "num_intersection": 388101, "num_union": 2442235, "num_only_computed": 1027067, "num_only_roped": 1027067, "total_diff": 2054134, "diff_percentage": 0.8410877741085522, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:04:25.313455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 9.393692016601562e-05, "l2_diff": 4.4375, "l2_diff_relative": 1.0441176470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:05:34.841632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15497484824773783, "overlap_percentage": 0.2683605595097709, "num_intersection": 407805, "num_union": 2631427, "num_only_computed": 1111811, "num_only_roped": 1111811, "total_diff": 2223622, "diff_percentage": 0.8450251517522622, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:05:37.254584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 9.107589721679688e-05, "l2_diff": 4.125, "l2_diff_relative": 1.11864406779661}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:06:54.711473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14897552284393162, "overlap_percentage": 0.2593188799621928, "num_intersection": 421416, "num_union": 2828760, "num_only_computed": 1203672, "num_only_roped": 1203672, "total_diff": 2407344, "diff_percentage": 0.8510244771560684, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:06:57.309907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 8.058547973632812e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.98}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:08:19.516056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14156610104382314, "overlap_percentage": 0.24802085646092362, "num_intersection": 428961, "num_union": 3030111, "num_only_computed": 1300575, "num_only_roped": 1300575, "total_diff": 2601150, "diff_percentage": 0.8584338989561768, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:08:22.349593", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 7.200241088867188e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.89453125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:09:51.789549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13380545157235268, "overlap_percentage": 0.23602894374302455, "num_intersection": 433115, "num_union": 3236901, "num_only_computed": 1401893, "num_only_roped": 1401893, "total_diff": 2803786, "diff_percentage": 0.8661945484276473, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:09:56.221975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 6.67572021484375e-05, "l2_diff": 3.421875, "l2_diff_relative": 0.8795180722891566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:11:34.803894", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13506839986616295, "overlap_percentage": 0.23799164857745844, "num_intersection": 458177, "num_union": 3392185, "num_only_computed": 1467004, "num_only_roped": 1467004, "total_diff": 2934008, "diff_percentage": 0.8649316001338371, "num_computed": 1925181, "num_roped": 1925181}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1017, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:11:38.162001", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.84375, "l2_diff_relative": 1.0423728813559323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1017, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:06.751037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11772681719035548, "overlap_percentage": 0.21065400843881857, "num_intersection": 9985, "num_union": 84815, "num_only_computed": 37415, "num_only_roped": 37415, "total_diff": 74830, "diff_percentage": 0.8822731828096445, "num_computed": 47400, "num_roped": 47400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "mask_shape": [1, 32, 25, 16402], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:11.329892", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.744529724121094e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.4215686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "attention_shape": [1, 32, 25, 16402]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:14:17.926266", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11990549320732427, "overlap_percentage": 0.2141350210970464, "num_intersection": 406, "num_union": 3386, "num_only_computed": 1490, "num_only_roped": 1490, "total_diff": 2980, "diff_percentage": 0.8800945067926758, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "mask_shape": [1, 32, 1, 16403], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:14:20.554795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 0.11328125, "l2_diff_relative": 0.8226950354609929}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "attention_shape": [1, 32, 1, 16403]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:15:17.534900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1192443919716647, "overlap_percentage": 0.21308016877637131, "num_intersection": 404, "num_union": 3388, "num_only_computed": 1492, "num_only_roped": 1492, "total_diff": 2984, "diff_percentage": 0.8807556080283353, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "mask_shape": [1, 32, 1, 16404], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:15:19.395877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.051513671875, "l2_diff_relative": 0.31398809523809523}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "attention_shape": [1, 32, 1, 16404]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:16:16.478331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10974539069359086, "overlap_percentage": 0.19778481012658228, "num_intersection": 375, "num_union": 3417, "num_only_computed": 1521, "num_only_roped": 1521, "total_diff": 3042, "diff_percentage": 0.8902546093064091, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "mask_shape": [1, 32, 1, 16405], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:16:18.342182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.3734375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "attention_shape": [1, 32, 1, 16405]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:17:18.059413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12189349112426036, "overlap_percentage": 0.21729957805907174, "num_intersection": 412, "num_union": 3380, "num_only_computed": 1484, "num_only_roped": 1484, "total_diff": 2968, "diff_percentage": 0.8781065088757396, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "mask_shape": [1, 32, 1, 16406], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:17:22.259645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.3424657534246575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "attention_shape": [1, 32, 1, 16406]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:18:21.362520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11858407079646018, "overlap_percentage": 0.2120253164556962, "num_intersection": 402, "num_union": 3390, "num_only_computed": 1494, "num_only_roped": 1494, "total_diff": 2988, "diff_percentage": 0.8814159292035398, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "mask_shape": [1, 32, 1, 16407], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:18:23.293779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.0869140625, "l2_diff_relative": 0.6223776223776224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "attention_shape": [1, 32, 1, 16407]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:19:22.206644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14010823812387252, "overlap_percentage": 0.24578059071729957, "num_intersection": 466, "num_union": 3326, "num_only_computed": 1430, "num_only_roped": 1430, "total_diff": 2860, "diff_percentage": 0.8598917618761275, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "mask_shape": [1, 32, 1, 16408], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:19:24.105667", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.059326171875, "l2_diff_relative": 0.25961538461538464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "attention_shape": [1, 32, 1, 16408]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:19:59.543674", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:19:59.556216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1739473342895508e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0029779128086419755}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:05.531555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5332834217636144, "overlap_percentage": 0.6956097146739131, "num_intersection": 327660, "num_union": 614420, "num_only_computed": 143380, "num_only_roped": 143380, "total_diff": 286760, "diff_percentage": 0.4667165782363855, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:05.923944", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.75, "l2_diff_relative": 0.07947019867549669}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:23.054905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41787269416028144, "overlap_percentage": 0.5894361262211367, "num_intersection": 339817, "num_union": 813207, "num_only_computed": 236695, "num_only_roped": 236695, "total_diff": 473390, "diff_percentage": 0.5821273058397185, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:23.588448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.06875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:43.258473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3603256982816139, "overlap_percentage": 0.5297638627819549, "num_intersection": 360748, "num_union": 1001172, "num_only_computed": 320212, "num_only_roped": 320212, "total_diff": 640424, "diff_percentage": 0.639674301718386, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:43.980104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 5.9604644775390625e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1485042735042735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:21:09.412073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29336519469583966, "overlap_percentage": 0.45364634195963544, "num_intersection": 356762, "num_union": 1216102, "num_only_computed": 429670, "num_only_roped": 429670, "total_diff": 859340, "diff_percentage": 0.7066348053041603, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:21:10.315565", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 6.29425048828125e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.1892430278884462}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:21:41.378435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2558448350477243, "overlap_percentage": 0.407446569683908, "num_intersection": 362986, "num_union": 1418774, "num_only_computed": 527894, "num_only_roped": 527894, "total_diff": 1055788, "diff_percentage": 0.7441551649522757, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:21:42.430017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.16018518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:22:19.476233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23821733069847897, "overlap_percentage": 0.38477466724537035, "num_intersection": 382977, "num_union": 1607679, "num_only_computed": 612351, "num_only_roped": 612351, "total_diff": 1224702, "diff_percentage": 0.761782669301521, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:22:20.739870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 2.7060508728027344e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.12325174825174826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:23:03.218314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21708316863976473, "overlap_percentage": 0.35672692587209304, "num_intersection": 392685, "num_union": 1808915, "num_only_computed": 708115, "num_only_roped": 708115, "total_diff": 1416230, "diff_percentage": 0.7829168313602353, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:23:04.672870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.19796380090497737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:23:52.550269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18748266558156695, "overlap_percentage": 0.315764888222175, "num_intersection": 380575, "num_union": 2029921, "num_only_computed": 824673, "num_only_roped": 824673, "total_diff": 1649346, "diff_percentage": 0.812517334418433, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:23:54.231877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.75, "l2_diff_relative": 0.4512820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:24:48.794630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16001543477568245, "overlap_percentage": 0.275885009765625, "num_intersection": 361608, "num_union": 2259832, "num_only_computed": 949112, "num_only_roped": 949112, "total_diff": 1898224, "diff_percentage": 0.8399845652243175, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:24:50.726967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.208984375, "mean_diff": 8.96453857421875e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.8709677419354839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:25:51.356355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14803235201064338, "overlap_percentage": 0.25788881602749636, "num_intersection": 364956, "num_union": 2465380, "num_only_computed": 1050212, "num_only_roped": 1050212, "total_diff": 2100424, "diff_percentage": 0.8519676479893566, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:25:53.472350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1923828125, "mean_diff": 8.0108642578125e-05, "l2_diff": 3.71875, "l2_diff_relative": 0.8263888888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:27:03.586493", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15033404074044215, "overlap_percentage": 0.2613745841054582, "num_intersection": 397189, "num_union": 2642043, "num_only_computed": 1122427, "num_only_roped": 1122427, "total_diff": 2244854, "diff_percentage": 0.8496659592595579, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:27:07.635449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 8.153915405273438e-05, "l2_diff": 4.15625, "l2_diff_relative": 0.9300699300699301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:28:22.110307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15878899202938956, "overlap_percentage": 0.2740602355072464, "num_intersection": 445372, "num_union": 2804804, "num_only_computed": 1179716, "num_only_roped": 1179716, "total_diff": 2359432, "diff_percentage": 0.8412110079706104, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:28:24.672111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 6.961822509765625e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.75}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:29:46.446371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14647077306118228, "overlap_percentage": 0.25551593028419184, "num_intersection": 441924, "num_union": 3017148, "num_only_computed": 1287612, "num_only_roped": 1287612, "total_diff": 2575224, "diff_percentage": 0.8535292269388177, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:29:49.234927", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 6.437301635742188e-05, "l2_diff": 3.765625, "l2_diff_relative": 0.7724358974358975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:31:21.270206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1402317363323472, "overlap_percentage": 0.24597058977399552, "num_intersection": 451358, "num_union": 3218658, "num_only_computed": 1383650, "num_only_roped": 1383650, "total_diff": 2767300, "diff_percentage": 0.8597682636676528, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:31:24.422106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 5.984306335449219e-05, "l2_diff": 3.53125, "l2_diff_relative": 0.7635135135135135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:54.139850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1406997353533882, "overlap_percentage": 0.2466902217870674, "num_intersection": 69540, "num_union": 494244, "num_only_computed": 212352, "num_only_roped": 212352, "total_diff": 424704, "diff_percentage": 0.8593002646466118, "num_computed": 281892, "num_roped": 281892}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "mask_shape": [1, 32, 156, 15516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:58.820652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.5032258064516129}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "attention_shape": [1, 32, 156, 15516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:34:17.414739", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14181175876860963, "overlap_percentage": 0.24839779005524862, "num_intersection": 13488, "num_union": 95112, "num_only_computed": 40812, "num_only_roped": 40812, "total_diff": 81624, "diff_percentage": 0.8581882412313904, "num_computed": 54300, "num_roped": 54300}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "mask_shape": [1, 32, 30, 15546], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:34:21.140915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.484375, "l2_diff_relative": 0.4626865671641791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "attention_shape": [1, 32, 30, 15546]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:35:27.274655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13231154207069126, "overlap_percentage": 0.23370165745856353, "num_intersection": 423, "num_union": 3197, "num_only_computed": 1387, "num_only_roped": 1387, "total_diff": 2774, "diff_percentage": 0.8676884579293087, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "mask_shape": [1, 32, 1, 15547], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:35:31.545792", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 4.00543212890625e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.2676470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "attention_shape": [1, 32, 1, 15547]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:36:27.340608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15691914349632471, "overlap_percentage": 0.2712707182320442, "num_intersection": 491, "num_union": 3129, "num_only_computed": 1319, "num_only_roped": 1319, "total_diff": 2638, "diff_percentage": 0.8430808565036753, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "mask_shape": [1, 32, 1, 15548], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:36:29.124628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.05615234375, "l2_diff_relative": 0.3362573099415205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "attention_shape": [1, 32, 1, 15548]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:37:24.343291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15433673469387754, "overlap_percentage": 0.2674033149171271, "num_intersection": 484, "num_union": 3136, "num_only_computed": 1326, "num_only_roped": 1326, "total_diff": 2652, "diff_percentage": 0.8456632653061225, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15549, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15549, 128], "mask_shape": [1, 32, 1, 15549], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:37:26.125274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.06494140625, "l2_diff_relative": 0.41823899371069184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15549, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15549, 128], "attention_shape": [1, 32, 1, 15549]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:38:21.003590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15313594396688954, "overlap_percentage": 0.26559911651021534, "num_intersection": 481, "num_union": 3141, "num_only_computed": 1330, "num_only_roped": 1330, "total_diff": 2660, "diff_percentage": 0.8468640560331104, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15550, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15550, 128], "mask_shape": [1, 32, 1, 15550], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:38:22.789875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.0537109375, "l2_diff_relative": 0.3055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15550, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15550, 128], "attention_shape": [1, 32, 1, 15550]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:39:17.476748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1642558662809386, "overlap_percentage": 0.28216454997239093, "num_intersection": 511, "num_union": 3111, "num_only_computed": 1300, "num_only_roped": 1300, "total_diff": 2600, "diff_percentage": 0.8357441337190614, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15551, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15551, 128], "mask_shape": [1, 32, 1, 15551], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:39:19.253768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.08642578125, "l2_diff_relative": 0.6807692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15551, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15551, 128], "attention_shape": [1, 32, 1, 15551]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:40:13.967143", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15829868883914294, "overlap_percentage": 0.27332965212589727, "num_intersection": 495, "num_union": 3127, "num_only_computed": 1316, "num_only_roped": 1316, "total_diff": 2632, "diff_percentage": 0.841701311160857, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15552, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15552, 128], "mask_shape": [1, 32, 1, 15552], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:40:15.752111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.076171875, "l2_diff_relative": 0.7761194029850746}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15552, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15552, 128], "attention_shape": [1, 32, 1, 15552]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:10.528514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1535031847133758, "overlap_percentage": 0.26615129762562123, "num_intersection": 482, "num_union": 3140, "num_only_computed": 1329, "num_only_roped": 1329, "total_diff": 2658, "diff_percentage": 0.8464968152866242, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15553, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15553, 128], "mask_shape": [1, 32, 1, 15553], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:12.293621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.18121693121693122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15553, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15553, 128], "attention_shape": [1, 32, 1, 15553]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:44.766955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:44.818157", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.0030976313694267518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:53.348378", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.518110226069637, "overlap_percentage": 0.6825726052989131, "num_intersection": 321519, "num_union": 620561, "num_only_computed": 149521, "num_only_roped": 149521, "total_diff": 299042, "diff_percentage": 0.48188977393036303, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:53.758421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 8.487701416015625e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.10558712121212122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:42:09.311229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41910122178010417, "overlap_percentage": 0.5906572629884547, "num_intersection": 340521, "num_union": 812503, "num_only_computed": 235991, "num_only_roped": 235991, "total_diff": 471982, "diff_percentage": 0.5808987782198958, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:42:09.838696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.11743951612903226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:42:29.100814", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35581746558739114, "overlap_percentage": 0.5248751762218045, "num_intersection": 357419, "num_union": 1004501, "num_only_computed": 323541, "num_only_roped": 323541, "total_diff": 647082, "diff_percentage": 0.6441825344126089, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:42:30.233768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.14958158995815898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:42:55.681591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30871112841787857, "overlap_percentage": 0.47177886962890625, "num_intersection": 371022, "num_union": 1201842, "num_only_computed": 415410, "num_only_roped": 415410, "total_diff": 830820, "diff_percentage": 0.6912888715821215, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:42:58.956133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.19361702127659575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:43:29.454449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2729139295688013, "overlap_percentage": 0.4288018588362069, "num_intersection": 382011, "num_union": 1399749, "num_only_computed": 508869, "num_only_roped": 508869, "total_diff": 1017738, "diff_percentage": 0.7270860704311988, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:43:30.518880", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.80078125, "l2_diff_relative": 0.10168650793650794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:44:06.666079", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.245701555675148, "overlap_percentage": 0.39447900591563784, "num_intersection": 392636, "num_union": 1598020, "num_only_computed": 602692, "num_only_roped": 602692, "total_diff": 1205384, "diff_percentage": 0.754298444324852, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:44:09.710152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.13204225352112675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:44:51.369963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2264245013054714, "overlap_percentage": 0.36924327761627906, "num_intersection": 406463, "num_union": 1795137, "num_only_computed": 694337, "num_only_roped": 694337, "total_diff": 1388674, "diff_percentage": 0.7735754986945286, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:44:52.807233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.8515625, "l2_diff_relative": 0.09945255474452555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:45:41.509541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18987011858737673, "overlap_percentage": 0.31914427570093457, "num_intersection": 384648, "num_union": 2025848, "num_only_computed": 820600, "num_only_roped": 820600, "total_diff": 1641200, "diff_percentage": 0.8101298814126232, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:45:45.799478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.5, "l2_diff_relative": 0.47904191616766467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:46:40.901920", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15585557978187495, "overlap_percentage": 0.2696800231933594, "num_intersection": 353475, "num_union": 2267965, "num_only_computed": 957245, "num_only_roped": 957245, "total_diff": 1914490, "diff_percentage": 0.8441444202181251, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:46:43.281827", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2421875, "mean_diff": 8.344650268554688e-05, "l2_diff": 3.609375, "l2_diff_relative": 0.721875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:47:45.450630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1427865419144934, "overlap_percentage": 0.24989188562771347, "num_intersection": 353639, "num_union": 2476697, "num_only_computed": 1061529, "num_only_roped": 1061529, "total_diff": 2123058, "diff_percentage": 0.8572134580855066, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:47:47.624551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1982421875, "mean_diff": 7.677078247070312e-05, "l2_diff": 4.125, "l2_diff_relative": 0.7586206896551724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:48:58.290904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14083486671756676, "overlap_percentage": 0.2468979005222372, "num_intersection": 375190, "num_union": 2664042, "num_only_computed": 1144426, "num_only_roped": 1144426, "total_diff": 2288852, "diff_percentage": 0.8591651332824333, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:49:01.589626", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1884765625, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.6875, "l2_diff_relative": 1.0869565217391304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:50:18.133618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1392410121380433, "overlap_percentage": 0.24444522388941398, "num_intersection": 397245, "num_union": 2852931, "num_only_computed": 1227843, "num_only_roped": 1227843, "total_diff": 2455686, "diff_percentage": 0.8607589878619567, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:50:20.763785", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.295608520507812e-05, "l2_diff": 4.4375, "l2_diff_relative": 0.8554216867469879}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:35.386741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13871070336391436, "overlap_percentage": 0.24362764476375448, "num_intersection": 28349, "num_union": 204375, "num_only_computed": 88013, "num_only_roped": 88013, "total_diff": 176026, "diff_percentage": 0.8612892966360857, "num_computed": 116362, "num_roped": 116362}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "mask_shape": [1, 32, 73, 13385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:37.577639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.3487394957983193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "attention_shape": [1, 32, 73, 13385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:52:42.799835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1332150683502035, "overlap_percentage": 0.23510994880106081, "num_intersection": 12766, "num_union": 95830, "num_only_computed": 41532, "num_only_roped": 41532, "total_diff": 83064, "diff_percentage": 0.8667849316497965, "num_computed": 54298, "num_roped": 54298}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "mask_shape": [1, 32, 34, 13419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:52:46.278699", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.41836734693877553}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "attention_shape": [1, 32, 34, 13419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:53:42.805959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13898788310762653, "overlap_percentage": 0.24405506883604505, "num_intersection": 390, "num_union": 2806, "num_only_computed": 1208, "num_only_roped": 1208, "total_diff": 2416, "diff_percentage": 0.8610121168923734, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "mask_shape": [1, 32, 1, 13420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:53:44.386033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.38285714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "attention_shape": [1, 32, 1, 13420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:54:32.757815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14469914040114612, "overlap_percentage": 0.2528160200250313, "num_intersection": 404, "num_union": 2792, "num_only_computed": 1194, "num_only_roped": 1194, "total_diff": 2388, "diff_percentage": 0.8553008595988538, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "mask_shape": [1, 32, 1, 13421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:54:35.360757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.4447852760736196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "attention_shape": [1, 32, 1, 13421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:55:25.332280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14798850574712644, "overlap_percentage": 0.25782227784730916, "num_intersection": 412, "num_union": 2784, "num_only_computed": 1186, "num_only_roped": 1186, "total_diff": 2372, "diff_percentage": 0.8520114942528736, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "mask_shape": [1, 32, 1, 13422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:55:26.914680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.3717948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "attention_shape": [1, 32, 1, 13422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:56:16.150585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1393939393939394, "overlap_percentage": 0.24468085106382978, "num_intersection": 391, "num_union": 2805, "num_only_computed": 1207, "num_only_roped": 1207, "total_diff": 2414, "diff_percentage": 0.8606060606060606, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "mask_shape": [1, 32, 1, 13423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:56:17.742129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.30025125628140703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "attention_shape": [1, 32, 1, 13423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:08.566687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13655761024182078, "overlap_percentage": 0.24030037546933666, "num_intersection": 384, "num_union": 2812, "num_only_computed": 1214, "num_only_roped": 1214, "total_diff": 2428, "diff_percentage": 0.8634423897581792, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "mask_shape": [1, 32, 1, 13424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:11.497641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.22596153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "attention_shape": [1, 32, 1, 13424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:42.136951", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:42.149579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.0032252261513157896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:47.927933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5155044496065171, "overlap_percentage": 0.6803074048913044, "num_intersection": 320452, "num_union": 621628, "num_only_computed": 150588, "num_only_roped": 150588, "total_diff": 301176, "diff_percentage": 0.4844955503934829, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:48.306277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 0.00011396408081054688, "l2_diff": 1.1640625, "l2_diff_relative": 0.14437984496124032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:58:02.492430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39385074381484053, "overlap_percentage": 0.5651261378774423, "num_intersection": 325802, "num_union": 827222, "num_only_computed": 250710, "num_only_roped": 250710, "total_diff": 501420, "diff_percentage": 0.6061492561851595, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:58:03.035189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.1495983935742972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:58:25.111209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33935587163063863, "overlap_percentage": 0.5067448895676692, "num_intersection": 345073, "num_union": 1016847, "num_only_computed": 335887, "num_only_roped": 335887, "total_diff": 671774, "diff_percentage": 0.6606441283693614, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:58:25.824335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.14522058823529413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:58:50.746199", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31095815739859406, "overlap_percentage": 0.47439829508463544, "num_intersection": 373082, "num_union": 1199782, "num_only_computed": 413350, "num_only_roped": 413350, "total_diff": 826700, "diff_percentage": 0.6890418426014059, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:58:51.643184", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.10299295774647887}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:59:22.081086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2556580936373535, "overlap_percentage": 0.40720972521551724, "num_intersection": 362775, "num_union": 1418985, "num_only_computed": 528105, "num_only_roped": 528105, "total_diff": 1056210, "diff_percentage": 0.7443419063626465, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:59:23.152945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.13617886178861788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:59:58.963306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22925831606351998, "overlap_percentage": 0.3730026684670782, "num_intersection": 371260, "num_union": 1619396, "num_only_computed": 624068, "num_only_roped": 624068, "total_diff": 1248136, "diff_percentage": 0.77074168393648, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:00:00.225106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.20242914979757085}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:00:41.936808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21432814548551338, "overlap_percentage": 0.3529987281976744, "num_intersection": 388581, "num_union": 1813019, "num_only_computed": 712219, "num_only_roped": 712219, "total_diff": 1424438, "diff_percentage": 0.7856718545144866, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:00:43.356056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:01:31.059590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19170428084816066, "overlap_percentage": 0.32173129513593884, "num_intersection": 387766, "num_union": 2022730, "num_only_computed": 817482, "num_only_roped": 817482, "total_diff": 1634964, "diff_percentage": 0.8082957191518394, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:01:32.720017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1806640625, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.5344827586206896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:02:30.238619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17944643260466786, "overlap_percentage": 0.30428924560546877, "num_intersection": 398838, "num_union": 2222602, "num_only_computed": 911882, "num_only_roped": 911882, "total_diff": 1823764, "diff_percentage": 0.8205535673953321, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:02:33.952410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 0.00010585784912109375, "l2_diff": 4.375, "l2_diff_relative": 1.1764705882352942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:03:35.750569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16225732032526202, "overlap_percentage": 0.27921066615412443, "num_intersection": 395130, "num_union": 2435206, "num_only_computed": 1020038, "num_only_roped": 1020038, "total_diff": 2040076, "diff_percentage": 0.837742679674738, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:03:37.895829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.208984375, "mean_diff": 9.489059448242188e-05, "l2_diff": 4.28125, "l2_diff_relative": 1.113821138211382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:04:48.665999", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15217216588799573, "overlap_percentage": 0.2641483111522911, "num_intersection": 401404, "num_union": 2637828, "num_only_computed": 1118212, "num_only_roped": 1118212, "total_diff": 2236424, "diff_percentage": 0.8478278341120042, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:04:51.598497", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.265625, "mean_diff": 9.870529174804688e-05, "l2_diff": 4.75, "l2_diff_relative": 1.4074074074074074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:06:08.372936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14707897158115743, "overlap_percentage": 0.2564408819706994, "num_intersection": 416739, "num_union": 2833437, "num_only_computed": 1208349, "num_only_roped": 1208349, "total_diff": 2416698, "diff_percentage": 0.8529210284188425, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:06:11.030720", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 8.487701416015625e-05, "l2_diff": 4.53125, "l2_diff_relative": 1.1068702290076335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:07:35.871448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1453023714119407, "overlap_percentage": 0.2537362622113677, "num_intersection": 438846, "num_union": 3020226, "num_only_computed": 1290690, "num_only_roped": 1290690, "total_diff": 2581380, "diff_percentage": 0.8546976285880593, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:07:39.328688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.486343383789062e-05, "l2_diff": 4.3125, "l2_diff_relative": 1.0072992700729928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:09:08.413910", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14027850015814694, "overlap_percentage": 0.24604252406529017, "num_intersection": 451490, "num_union": 3218526, "num_only_computed": 1383518, "num_only_roped": 1383518, "total_diff": 2767036, "diff_percentage": 0.8597214998418531, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:09:11.492856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 5.936622619628906e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.7062146892655368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:10:46.858282", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13557706514509651, "overlap_percentage": 0.2387809146669819, "num_intersection": 290881, "num_union": 2145503, "num_only_computed": 927311, "num_only_roped": 927311, "total_diff": 1854622, "diff_percentage": 0.8644229348549035, "num_computed": 1218192, "num_roped": 1218192}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "mask_shape": [1, 32, 656, 16016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:10:50.017010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.6346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "attention_shape": [1, 32, 656, 16016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:12:14.530970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13150157152996045, "overlap_percentage": 0.23243727598566308, "num_intersection": 10376, "num_union": 78904, "num_only_computed": 34264, "num_only_roped": 34264, "total_diff": 68528, "diff_percentage": 0.8684984284700396, "num_computed": 44640, "num_roped": 44640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "mask_shape": [1, 32, 24, 16040], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:12:17.056103", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.3515625, "l2_diff_relative": 0.30201342281879195}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "attention_shape": [1, 32, 24, 16040]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:22.375194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13657195233730524, "overlap_percentage": 0.2403225806451613, "num_intersection": 447, "num_union": 3273, "num_only_computed": 1413, "num_only_roped": 1413, "total_diff": 2826, "diff_percentage": 0.8634280476626948, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "mask_shape": [1, 32, 1, 16041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:24.187590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 5.364418029785156e-05, "l2_diff": 0.10009765625, "l2_diff_relative": 0.6487341772151899}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "attention_shape": [1, 32, 1, 16041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:14:21.289726", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12386706948640483, "overlap_percentage": 0.22043010752688172, "num_intersection": 410, "num_union": 3310, "num_only_computed": 1450, "num_only_roped": 1450, "total_diff": 2900, "diff_percentage": 0.8761329305135952, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "mask_shape": [1, 32, 1, 16042], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:14:24.316016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.1259765625, "l2_diff_relative": 0.9626865671641791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "attention_shape": [1, 32, 1, 16042]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:15:20.207684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12590799031476999, "overlap_percentage": 0.22365591397849463, "num_intersection": 416, "num_union": 3304, "num_only_computed": 1444, "num_only_roped": 1444, "total_diff": 2888, "diff_percentage": 0.87409200968523, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "mask_shape": [1, 32, 1, 16043], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:15:22.008219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.09619140625, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "attention_shape": [1, 32, 1, 16043]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:15:55.128141", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:15:55.141766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:00.883707", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5070820442103848, "overlap_percentage": 0.6729322350543478, "num_intersection": 316978, "num_union": 625102, "num_only_computed": 154062, "num_only_roped": 154062, "total_diff": 308124, "diff_percentage": 0.4929179557896151, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:02.171640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 9.34600830078125e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.11870503597122302}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:16.323767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37824757018696203, "overlap_percentage": 0.5488818966474245, "num_intersection": 316437, "num_union": 836587, "num_only_computed": 260075, "num_only_roped": 260075, "total_diff": 520150, "diff_percentage": 0.621752429813038, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:16.862350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.14717741935483872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:36.801808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31953137413721605, "overlap_percentage": 0.48431038533834586, "num_intersection": 329796, "num_union": 1032124, "num_only_computed": 351164, "num_only_roped": 351164, "total_diff": 702328, "diff_percentage": 0.6804686258627839, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:37.505761", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.20164609053497942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:17:02.347146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2779948128262297, "overlap_percentage": 0.4350484212239583, "num_intersection": 342136, "num_union": 1230728, "num_only_computed": 444296, "num_only_roped": 444296, "total_diff": 888592, "diff_percentage": 0.7220051871737703, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:17:03.227684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.22745901639344263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:17:34.326126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2494907043462467, "overlap_percentage": 0.39934783584770117, "num_intersection": 355771, "num_union": 1425989, "num_only_computed": 535109, "num_only_roped": 535109, "total_diff": 1070218, "diff_percentage": 0.7505092956537532, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:17:35.417238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 5.5789947509765625e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.20535714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:18:12.996102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22351396651135003, "overlap_percentage": 0.36536398051697533, "num_intersection": 363657, "num_union": 1626999, "num_only_computed": 631671, "num_only_roped": 631671, "total_diff": 1263342, "diff_percentage": 0.77648603348865, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:18:14.255067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09716796875, "mean_diff": 5.054473876953125e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.24507389162561577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:18:57.318619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2047889485130028, "overlap_percentage": 0.33995821220930234, "num_intersection": 374226, "num_union": 1827374, "num_only_computed": 726574, "num_only_roped": 726574, "total_diff": 1453148, "diff_percentage": 0.7952110514869972, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:18:58.775101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.14271653543307086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:19:47.696805", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20590159866647723, "overlap_percentage": 0.3414898842395922, "num_intersection": 411580, "num_union": 1998916, "num_only_computed": 793668, "num_only_roped": 793668, "total_diff": 1587336, "diff_percentage": 0.7940984013335227, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:19:49.355732", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 5.030632019042969e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.3263598326359833}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:20:44.918002", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20039747047591136, "overlap_percentage": 0.33388519287109375, "num_intersection": 437630, "num_union": 2183810, "num_only_computed": 873090, "num_only_roped": 873090, "total_diff": 1746180, "diff_percentage": 0.7996025295240886, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:20:46.829893", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.963180541992188e-05, "l2_diff": 3.75, "l2_diff_relative": 0.7142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:21:49.164130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19059800045346723, "overlap_percentage": 0.3201718806530391, "num_intersection": 453097, "num_union": 2377239, "num_only_computed": 962071, "num_only_roped": 962071, "total_diff": 1924142, "diff_percentage": 0.8094019995465328, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:21:53.110988", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.821487426757812e-05, "l2_diff": 3.671875, "l2_diff_relative": 0.9251968503937008}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:23:03.130041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18042729837557017, "overlap_percentage": 0.30569828167115903, "num_intersection": 464544, "num_union": 2574688, "num_only_computed": 1055072, "num_only_roped": 1055072, "total_diff": 2110144, "diff_percentage": 0.8195727016244299, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:23:05.513514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 8.440017700195312e-05, "l2_diff": 3.75, "l2_diff_relative": 0.9486166007905138}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:24:20.341217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1751666386449797, "overlap_percentage": 0.29811370215028354, "num_intersection": 484461, "num_union": 2765715, "num_only_computed": 1140627, "num_only_roped": 1140627, "total_diff": 2281254, "diff_percentage": 0.8248333613550203, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:24:24.669770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.765625, "l2_diff_relative": 0.7626582278481012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:25:46.426210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17332566283548817, "overlap_percentage": 0.29544340216104203, "num_intersection": 510980, "num_union": 2948092, "num_only_computed": 1218556, "num_only_roped": 1218556, "total_diff": 2437112, "diff_percentage": 0.8266743371645118, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:25:50.736584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.05718994140625e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.94921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:27:19.992933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16401059847645316, "overlap_percentage": 0.2818025861467634, "num_intersection": 517110, "num_union": 3152906, "num_only_computed": 1317898, "num_only_roped": 1317898, "total_diff": 2635796, "diff_percentage": 0.8359894015235468, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:27:23.062678", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.341934204101562e-05, "l2_diff": 3.375, "l2_diff_relative": 0.8181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:28:53.480535", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15076877382066772, "overlap_percentage": 0.262031395447237, "num_intersection": 123857, "num_union": 821503, "num_only_computed": 348823, "num_only_roped": 348823, "total_diff": 697646, "diff_percentage": 0.8492312261793322, "num_computed": 472680, "num_roped": 472680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "mask_shape": [1, 32, 260, 15620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:28:56.316755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 5.0067901611328125e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.46938775510204084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "attention_shape": [1, 32, 260, 15620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:30:15.097419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1492048643592142, "overlap_percentage": 0.25966625966625967, "num_intersection": 12760, "num_union": 85520, "num_only_computed": 36380, "num_only_roped": 36380, "total_diff": 72760, "diff_percentage": 0.8507951356407858, "num_computed": 49140, "num_roped": 49140}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "mask_shape": [1, 32, 27, 15647], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:30:17.312409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044189453125, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.2490234375, "l2_diff_relative": 0.2244718309859155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "attention_shape": [1, 32, 27, 15647]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:31:21.090352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16442738323736406, "overlap_percentage": 0.2824175824175824, "num_intersection": 514, "num_union": 3126, "num_only_computed": 1306, "num_only_roped": 1306, "total_diff": 2612, "diff_percentage": 0.835572616762636, "num_computed": 1820, "num_roped": 1820}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "mask_shape": [1, 32, 1, 15648], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:31:24.415476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.024169921875, "l2_diff_relative": 0.08839285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "attention_shape": [1, 32, 1, 15648]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:32:18.914145", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14573497009757633, "overlap_percentage": 0.2543956043956044, "num_intersection": 463, "num_union": 3177, "num_only_computed": 1357, "num_only_roped": 1357, "total_diff": 2714, "diff_percentage": 0.8542650299024237, "num_computed": 1820, "num_roped": 1820}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "mask_shape": [1, 32, 1, 15649], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:32:21.735931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 6.914138793945312e-05, "l2_diff": 0.095703125, "l2_diff_relative": 0.8099173553719008}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "attention_shape": [1, 32, 1, 15649]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:33:17.118784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15619047619047619, "overlap_percentage": 0.2701812191103789, "num_intersection": 492, "num_union": 3150, "num_only_computed": 1329, "num_only_roped": 1329, "total_diff": 2658, "diff_percentage": 0.8438095238095238, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "mask_shape": [1, 32, 1, 15650], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:33:18.955517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.026611328125, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.22705314009661837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "attention_shape": [1, 32, 1, 15650]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:34:15.241329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15399239543726237, "overlap_percentage": 0.26688632619439867, "num_intersection": 486, "num_union": 3156, "num_only_computed": 1335, "num_only_roped": 1335, "total_diff": 2670, "diff_percentage": 0.8460076045627376, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "mask_shape": [1, 32, 1, 15651], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:34:17.089400", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.1662621359223301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "attention_shape": [1, 32, 1, 15651]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:35:13.406366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15253164556962026, "overlap_percentage": 0.26468973091707854, "num_intersection": 482, "num_union": 3160, "num_only_computed": 1339, "num_only_roped": 1339, "total_diff": 2678, "diff_percentage": 0.8474683544303797, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "mask_shape": [1, 32, 1, 15652], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:35:15.239573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.24743589743589745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "attention_shape": [1, 32, 1, 15652]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:11.525606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1532615579480684, "overlap_percentage": 0.26578802855573863, "num_intersection": 484, "num_union": 3158, "num_only_computed": 1337, "num_only_roped": 1337, "total_diff": 2674, "diff_percentage": 0.8467384420519316, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "mask_shape": [1, 32, 1, 15653], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:13.357344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029541015625, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.05126953125, "l2_diff_relative": 0.24193548387096775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "attention_shape": [1, 32, 1, 15653]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:37:09.628791", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16098182977366912, "overlap_percentage": 0.2773201537616694, "num_intersection": 505, "num_union": 3137, "num_only_computed": 1316, "num_only_roped": 1316, "total_diff": 2632, "diff_percentage": 0.8390181702263309, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15654, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15654, 128], "mask_shape": [1, 32, 1, 15654], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:37:11.451073", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.14895833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15654, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15654, 128], "attention_shape": [1, 32, 1, 15654]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
