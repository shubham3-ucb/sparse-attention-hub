{"timestamp": "2025-11-13T19:22:05.710472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:05.755154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.0030674078525641025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:11.811150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.753999651747597, "overlap_percentage": 0.8597489184177998, "num_intersection": 1112859, "num_union": 1475941, "num_only_computed": 197861, "num_only_roped": 165221, "total_diff": 363082, "diff_percentage": 0.24600034825240305, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:12.207679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.8710575103759766e-06, "l2_diff": 0.08642578125, "l2_diff_relative": 0.00980718085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:27.121458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6310798012313488, "overlap_percentage": 0.7738184247698102, "num_intersection": 1419963, "num_union": 2250053, "num_only_computed": 415045, "num_only_roped": 415045, "total_diff": 830090, "diff_percentage": 0.36892019876865123, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:30.321115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 7.331371307373047e-06, "l2_diff": 0.12060546875, "l2_diff_relative": 0.015314980158730158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:51.378813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5692667175943679, "overlap_percentage": 0.7255193922254775, "num_intersection": 1711715, "num_union": 3006877, "num_only_computed": 647581, "num_only_roped": 647581, "total_diff": 1295162, "diff_percentage": 0.43073328240563213, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:52.133915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.11767578125, "l2_diff_relative": 0.014483173076923078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:23:18.573549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5363137004182317, "overlap_percentage": 0.6981825395063921, "num_intersection": 2013268, "num_union": 3753900, "num_only_computed": 870316, "num_only_roped": 870316, "total_diff": 1740632, "diff_percentage": 0.46368629958176827, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:23:19.496812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.017376077586206896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:23:51.991722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5126352845197181, "overlap_percentage": 0.677804213303786, "num_intersection": 2309870, "num_union": 4505874, "num_only_computed": 1098002, "num_only_roped": 1098002, "total_diff": 2196004, "diff_percentage": 0.487364715480282, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:23:53.562866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.016176470588235296}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:24:32.183073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49999542237725103, "overlap_percentage": 0.66666259765625, "num_intersection": 2621424, "num_union": 5242896, "num_only_computed": 1310736, "num_only_roped": 1310736, "total_diff": 2621472, "diff_percentage": 0.500004577622749, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:24:35.085491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.9653310775756836e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014955357142857144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:25:19.844160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48762261179373195, "overlap_percentage": 0.6555730034323299, "num_intersection": 2921527, "num_union": 5991369, "num_only_computed": 1534921, "num_only_roped": 1534921, "total_diff": 3069842, "diff_percentage": 0.5123773882062681, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:25:21.375991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.592802047729492e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.017553191489361703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:26:12.905783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4810302998405303, "overlap_percentage": 0.6495887354800576, "num_intersection": 3235430, "num_union": 6726042, "num_only_computed": 1745306, "num_only_roped": 1745306, "total_diff": 3490612, "diff_percentage": 0.5189697001594697, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:26:14.667542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.4007091522216797e-05, "l2_diff": 0.35546875, "l2_diff_relative": 0.04443359375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:27:13.901592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46967085122804414, "overlap_percentage": 0.6391510736374628, "num_intersection": 3518542, "num_union": 7491506, "num_only_computed": 1986482, "num_only_roped": 1986482, "total_diff": 3972964, "diff_percentage": 0.5303291487719559, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:27:18.548245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.29296875, "l2_diff_relative": 0.03939075630252101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:28:24.814855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4712069275156361, "overlap_percentage": 0.6405719259510869, "num_intersection": 3862208, "num_union": 8196416, "num_only_computed": 2167104, "num_only_roped": 2167104, "total_diff": 4334208, "diff_percentage": 0.5287930724843639, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:28:28.016193", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 9.715557098388672e-06, "l2_diff": 0.29296875, "l2_diff_relative": 0.03324468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:29:35.213943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4727769196822595, "overlap_percentage": 0.6420210873270034, "num_intersection": 342820, "num_union": 725120, "num_only_computed": 191150, "num_only_roped": 191150, "total_diff": 382300, "diff_percentage": 0.5272230803177406, "num_computed": 533970, "num_roped": 533970}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 11354, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 11354, 128], "mask_shape": [1, 32, 90, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:29:38.941453", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.203125, "l2_diff_relative": 0.08024691358024691}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 11354, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 11354, 128], "attention_shape": [1, 32, 90, 11354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:30:43.368973", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4775024179022369, "overlap_percentage": 0.6463643133392587, "num_intersection": 107630, "num_union": 225402, "num_only_computed": 58886, "num_only_roped": 58886, "total_diff": 117772, "diff_percentage": 0.5224975820977631, "num_computed": 166516, "num_roped": 166516}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11382, 128], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:30:45.449363", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015380859375, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.06396484375, "l2_diff_relative": 0.051819620253164556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11382, 128], "attention_shape": [1, 32, 28, 11382]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:31:43.680258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46821380076533764, "overlap_percentage": 0.637800571716832, "num_intersection": 3793, "num_union": 8101, "num_only_computed": 2154, "num_only_roped": 2154, "total_diff": 4308, "diff_percentage": 0.5317861992346624, "num_computed": 5947, "num_roped": 5947}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:31:45.356842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00732421875, "mean_diff": 1.4603137969970703e-05, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.0691793893129771}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 1, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:32:37.813718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4412406106130361, "overlap_percentage": 0.6123066577000672, "num_intersection": 3642, "num_union": 8254, "num_only_computed": 2306, "num_only_roped": 2306, "total_diff": 4612, "diff_percentage": 0.5587593893869639, "num_computed": 5948, "num_roped": 5948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:32:39.465916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.01141357421875, "l2_diff_relative": 0.054360465116279066}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:33:31.821360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46991226986284446, "overlap_percentage": 0.6393745796906524, "num_intersection": 3803, "num_union": 8093, "num_only_computed": 2145, "num_only_roped": 2145, "total_diff": 4290, "diff_percentage": 0.5300877301371556, "num_computed": 5948, "num_roped": 5948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:33:34.023071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.0517578125e-05, "l2_diff": 0.0203857421875, "l2_diff_relative": 0.1605769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:34:26.403427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4679827267119062, "overlap_percentage": 0.6375861489325937, "num_intersection": 3793, "num_union": 8105, "num_only_computed": 2156, "num_only_roped": 2156, "total_diff": 4312, "diff_percentage": 0.5320172732880938, "num_computed": 5949, "num_roped": 5949}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:34:28.727007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.17132867132867133}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:21.144279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43713008817490034, "overlap_percentage": 0.6083375357202891, "num_intersection": 3619, "num_union": 8279, "num_only_computed": 2330, "num_only_roped": 2330, "total_diff": 4660, "diff_percentage": 0.5628699118250996, "num_computed": 5949, "num_roped": 5949}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11387, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11387, 128], "mask_shape": [1, 32, 1, 11387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:23.402466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.0159912109375, "l2_diff_relative": 0.07511467889908256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11387, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11387, 128], "attention_shape": [1, 32, 1, 11387]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:54.885748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:54.899425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4570693969726562e-06, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.003071032072368421}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:00.850523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7470844246424746, "overlap_percentage": 0.855235630407911, "num_intersection": 1107017, "num_union": 1481783, "num_only_computed": 203703, "num_only_roped": 171063, "total_diff": 374766, "diff_percentage": 0.25291557535752535, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:03.218485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.900859832763672e-06, "l2_diff": 0.08837890625, "l2_diff_relative": 0.009554476351351352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:17.969918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6201215571463383, "overlap_percentage": 0.7655247279575893, "num_intersection": 1404744, "num_union": 2265272, "num_only_computed": 430264, "num_only_roped": 430264, "total_diff": 860528, "diff_percentage": 0.37987844285366174, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:18.514027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.09228515625, "l2_diff_relative": 0.010325611888111888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:39.222265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5505230304946133, "overlap_percentage": 0.7101126776801215, "num_intersection": 1675366, "num_union": 3043226, "num_only_computed": 683930, "num_only_roped": 683930, "total_diff": 1367860, "diff_percentage": 0.44947696950538674, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:39.964669", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.0175046992481203}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:06.446875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5235599383302459, "overlap_percentage": 0.6872849897904829, "num_intersection": 1981844, "num_union": 3785324, "num_only_computed": 901740, "num_only_roped": 901740, "total_diff": 1803480, "diff_percentage": 0.47644006166975406, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:07.352070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.973743438720703e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.021796218487394957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:39.714394", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49867552654059233, "overlap_percentage": 0.6654883164625901, "num_intersection": 2267899, "num_union": 4547845, "num_only_computed": 1139973, "num_only_roped": 1139973, "total_diff": 2279946, "diff_percentage": 0.5013244734594077, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:40.821898", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.751848220825195e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.022807459677419355}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:38:18.469598", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49537714523887033, "overlap_percentage": 0.6625447591145833, "num_intersection": 2605232, "num_union": 5259088, "num_only_computed": 1326928, "num_only_roped": 1326928, "total_diff": 2653856, "diff_percentage": 0.5046228547611297, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:38:21.188266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 4.589557647705078e-06, "l2_diff": 0.16796875, "l2_diff_relative": 0.022119341563786008}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:39:04.688824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47897247632131296, "overlap_percentage": 0.6477097903980928, "num_intersection": 2886485, "num_union": 6026411, "num_only_computed": 1569963, "num_only_roped": 1569963, "total_diff": 3139926, "diff_percentage": 0.521027523678687, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:39:06.166179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.6209821701049805e-06, "l2_diff": 0.1708984375, "l2_diff_relative": 0.02055921052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:39:56.712997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46427118293276637, "overlap_percentage": 0.6341327868009868, "num_intersection": 3158448, "num_union": 6803024, "num_only_computed": 1822288, "num_only_roped": 1822288, "total_diff": 3644576, "diff_percentage": 0.5357288170672336, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:39:58.422314", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.032470703125, "mean_diff": 1.341104507446289e-05, "l2_diff": 0.28515625, "l2_diff_relative": 0.03354779411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:40:56.123402", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4661088641674036, "overlap_percentage": 0.6358448210216704, "num_intersection": 3500341, "num_union": 7509707, "num_only_computed": 2004683, "num_only_roped": 2004683, "total_diff": 4009366, "diff_percentage": 0.5338911358325964, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:40:58.100250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 1.4603137969970703e-05, "l2_diff": 0.341796875, "l2_diff_relative": 0.039917883211678835}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:42:03.369784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4580888851324104, "overlap_percentage": 0.6283415089482847, "num_intersection": 3788467, "num_union": 8270157, "num_only_computed": 2240845, "num_only_roped": 2240845, "total_diff": 4481690, "diff_percentage": 0.5419111148675896, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:42:05.595553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.034912109375, "mean_diff": 7.4803829193115234e-06, "l2_diff": 0.2216796875, "l2_diff_relative": 0.0277099609375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:43:18.442271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45813009988711817, "overlap_percentage": 0.6283802795410156, "num_intersection": 4118153, "num_union": 8989047, "num_only_computed": 2435447, "num_only_roped": 2435447, "total_diff": 4870894, "diff_percentage": 0.5418699001128818, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:43:22.784462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 1.1444091796875e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.05302254098360656}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:44:44.896329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4580419040210911, "overlap_percentage": 0.6282973112883391, "num_intersection": 4447018, "num_union": 9708758, "num_only_computed": 2630870, "num_only_roped": 2630870, "total_diff": 5261740, "diff_percentage": 0.541958095978909, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:44:48.407332", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.466796875, "l2_diff_relative": 0.0541213768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:46:17.008834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44862815117443444, "overlap_percentage": 0.6193834502121498, "num_intersection": 4708662, "num_union": 10495690, "num_only_computed": 2893514, "num_only_roped": 2893514, "total_diff": 5787028, "diff_percentage": 0.5513718488255656, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:46:20.007782", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 1.0073184967041016e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.061708860759493674}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:47:57.200664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4482901626061105, "overlap_percentage": 0.6190612546859249, "num_intersection": 5030779, "num_union": 11222149, "num_only_computed": 3095685, "num_only_roped": 3095685, "total_diff": 6191370, "diff_percentage": 0.5517098373938896, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:48:00.888246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 1.4483928680419922e-05, "l2_diff": 0.6640625, "l2_diff_relative": 0.09883720930232558}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:47.478039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44205134895732184, "overlap_percentage": 0.6130868353293355, "num_intersection": 4729968, "num_union": 10700042, "num_only_computed": 2985037, "num_only_roped": 2985037, "total_diff": 5970074, "diff_percentage": 0.5579486510426781, "num_computed": 7715005, "num_roped": 7715005}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 919, "seq_len_k": 16279, "queries_shape": [1, 32, 919, 128], "keys_shape": [1, 8, 16279, 128], "mask_shape": [1, 32, 919, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:52.623981", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 1.1146068572998047e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.08590534979423868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 919, "seq_len_k": 16279, "queries_shape": [1, 32, 919, 128], "keys_shape": [1, 8, 16279, 128], "attention_shape": [1, 32, 919, 16279]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:51:38.717656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4272974400093873, "overlap_percentage": 0.5987503768052397, "num_intersection": 262188, "num_union": 613596, "num_only_computed": 175704, "num_only_roped": 175704, "total_diff": 351408, "diff_percentage": 0.5727025599906127, "num_computed": 437892, "num_roped": 437892}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16331, 128], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:51:44.339178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.173828125, "l2_diff_relative": 0.09888888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16331, 128], "attention_shape": [1, 32, 52, 16331]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:53:14.516744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4598717282024614, "overlap_percentage": 0.6300166231298979, "num_intersection": 5306, "num_union": 11538, "num_only_computed": 3116, "num_only_roped": 3116, "total_diff": 6232, "diff_percentage": 0.5401282717975385, "num_computed": 8422, "num_roped": 8422}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16332, 128], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:53:17.227093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.16875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16332, 128], "attention_shape": [1, 32, 1, 16332]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:54:34.724578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.456463467358409, "overlap_percentage": 0.6268107337924483, "num_intersection": 5279, "num_union": 11565, "num_only_computed": 3143, "num_only_roped": 3143, "total_diff": 6286, "diff_percentage": 0.543536532641591, "num_computed": 8422, "num_roped": 8422}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16333, 128], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:54:37.226105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.055419921875, "l2_diff_relative": 0.20413669064748202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16333, 128], "attention_shape": [1, 32, 1, 16333]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:55:54.236402", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4610581092801388, "overlap_percentage": 0.6311290514068622, "num_intersection": 5316, "num_union": 11530, "num_only_computed": 3107, "num_only_roped": 3107, "total_diff": 6214, "diff_percentage": 0.5389418907198612, "num_computed": 8423, "num_roped": 8423}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16334, 128], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:55:58.193273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0164794921875, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.1200199203187251}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16334, 128], "attention_shape": [1, 32, 1, 16334]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:57:15.189945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42052449616325155, "overlap_percentage": 0.5920693339665203, "num_intersection": 4987, "num_union": 11859, "num_only_computed": 3436, "num_only_roped": 3436, "total_diff": 6872, "diff_percentage": 0.5794755038367485, "num_computed": 8423, "num_roped": 8423}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16335, 128], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:57:18.984073", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 1.537799835205078e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.15359477124183007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16335, 128], "attention_shape": [1, 32, 1, 16335]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:05.940837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:05.954541", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.029541015625, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:11.972401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7414386107237585, "overlap_percentage": 0.8515242583436341, "num_intersection": 1102213, "num_union": 1486587, "num_only_computed": 208507, "num_only_roped": 175867, "total_diff": 384374, "diff_percentage": 0.2585613892762415, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:12.377508", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 9.059906005859375e-06, "l2_diff": 0.1162109375, "l2_diff_relative": 0.013980263157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:29.832961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6186895640407255, "overlap_percentage": 0.7644326346261161, "num_intersection": 1402740, "num_union": 2267276, "num_only_computed": 432268, "num_only_roped": 432268, "total_diff": 864536, "diff_percentage": 0.3813104359592745, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:30.375151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 8.285045623779297e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.016875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:50.611571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5606260904077195, "overlap_percentage": 0.7184630499945747, "num_intersection": 1695067, "num_union": 3023525, "num_only_computed": 664229, "num_only_roped": 664229, "total_diff": 1328458, "diff_percentage": 0.4393739095922805, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:51.535264", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.125, "l2_diff_relative": 0.016}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:59:17.476767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5285311765424608, "overlap_percentage": 0.6915543296120383, "num_intersection": 1994155, "num_union": 3773013, "num_only_computed": 889429, "num_only_roped": 889429, "total_diff": 1778858, "diff_percentage": 0.4714688234575391, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:59:18.378993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 3.904104232788086e-06, "l2_diff": 0.1181640625, "l2_diff_relative": 0.014004629629629629}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:59:50.117594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.505597605090949, "overlap_percentage": 0.6716238168569711, "num_intersection": 2288808, "num_union": 4526936, "num_only_computed": 1119064, "num_only_roped": 1119064, "total_diff": 2238128, "diff_percentage": 0.4944023949090511, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:59:53.269873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.017518939393939392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:00:30.839368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49435563570901003, "overlap_percentage": 0.6616305033365886, "num_intersection": 2601637, "num_union": 5262683, "num_only_computed": 1330523, "num_only_roped": 1330523, "total_diff": 2661046, "diff_percentage": 0.50564436429099, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:00:32.114048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.844499588012695e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.019829317269076305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:01:18.561176", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4813760453728855, "overlap_percentage": 0.6499039145076976, "num_intersection": 2896263, "num_union": 6016633, "num_only_computed": 1560185, "num_only_roped": 1560185, "total_diff": 3120370, "diff_percentage": 0.5186239546271145, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:01:20.062867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.169921875, "l2_diff_relative": 0.021837349397590362}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:02:10.672998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46432477922612464, "overlap_percentage": 0.6341827794125205, "num_intersection": 3158697, "num_union": 6802775, "num_only_computed": 1822039, "num_only_roped": 1822039, "total_diff": 3644078, "diff_percentage": 0.5356752207738754, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:02:13.684682", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.2421875, "l2_diff_relative": 0.030632411067193676}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:03:12.011717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4615358883152507, "overlap_percentage": 0.6315765380859375, "num_intersection": 3476844, "num_union": 7533204, "num_only_computed": 2028180, "num_only_roped": 2028180, "total_diff": 4056360, "diff_percentage": 0.5384641116847493, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:03:14.020631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.043081283569336e-05, "l2_diff": 0.251953125, "l2_diff_relative": 0.030772900763358778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:04:21.025186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4558688592992101, "overlap_percentage": 0.6262498938519022, "num_intersection": 3775856, "num_union": 8282768, "num_only_computed": 2253456, "num_only_roped": 2253456, "total_diff": 4506912, "diff_percentage": 0.5441311407007898, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:04:23.304856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 8.285045623779297e-06, "l2_diff": 0.259765625, "l2_diff_relative": 0.03125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:05:38.441919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4527720511626876, "overlap_percentage": 0.623321533203125, "num_intersection": 4085000, "num_union": 9022200, "num_only_computed": 2468600, "num_only_roped": 2468600, "total_diff": 4937200, "diff_percentage": 0.5472279488373124, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:05:41.395613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037841796875, "mean_diff": 7.3015689849853516e-06, "l2_diff": 0.3125, "l2_diff_relative": 0.03759398496240601}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:07:04.816304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44809619291778097, "overlap_percentage": 0.6188762806080006, "num_intersection": 4380337, "num_union": 9775439, "num_only_computed": 2697551, "num_only_roped": 2697551, "total_diff": 5395102, "diff_percentage": 0.551903807082219, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:07:07.679489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.043414429530201346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:08:37.906583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43616898983946245, "overlap_percentage": 0.6074062215870825, "num_intersection": 4617609, "num_union": 10586743, "num_only_computed": 2984567, "num_only_roped": 2984567, "total_diff": 5969134, "diff_percentage": 0.5638310101605376, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:08:42.973945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08349609375, "mean_diff": 7.62939453125e-06, "l2_diff": 0.298828125, "l2_diff_relative": 0.036778846153846155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:20.041761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43748012765354144, "overlap_percentage": 0.6086764181813886, "num_intersection": 4946387, "num_union": 11306541, "num_only_computed": 3180077, "num_only_roped": 3180077, "total_diff": 6360154, "diff_percentage": 0.5625198723464586, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:23.306832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.4609375, "l2_diff_relative": 0.05923694779116466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:12:08.480487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43644124072128576, "overlap_percentage": 0.6076701619930291, "num_intersection": 4909586, "num_union": 11249134, "num_only_computed": 3169774, "num_only_roped": 3169774, "total_diff": 6339548, "diff_percentage": 0.5635587592787142, "num_computed": 8079360, "num_roped": 8079360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 960, "seq_len_k": 16320, "queries_shape": [1, 32, 960, 128], "keys_shape": [1, 8, 16320, 128], "mask_shape": [1, 32, 960, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:12:11.962870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 1.1920928955078125e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.07608695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 960, "seq_len_k": 16320, "queries_shape": [1, 32, 960, 128], "keys_shape": [1, 8, 16320, 128], "attention_shape": [1, 32, 960, 16320]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:13:56.827317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4448890755006384, "overlap_percentage": 0.6158106986122642, "num_intersection": 155757, "num_union": 350103, "num_only_computed": 97173, "num_only_roped": 97173, "total_diff": 194346, "diff_percentage": 0.5551109244993616, "num_computed": 252930, "num_roped": 252930}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16350, 128], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:14:00.079244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.1943359375, "l2_diff_relative": 0.13373655913978494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16350, 128], "attention_shape": [1, 32, 30, 16350]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:15:29.103262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43849172496161065, "overlap_percentage": 0.6096548452140909, "num_intersection": 5140, "num_union": 11722, "num_only_computed": 3291, "num_only_roped": 3291, "total_diff": 6582, "diff_percentage": 0.5615082750383894, "num_computed": 8431, "num_roped": 8431}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:15:31.611679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.052734375, "l2_diff_relative": 0.19014084507042253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 1, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:16:49.724829", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45442000862440707, "overlap_percentage": 0.624881404174573, "num_intersection": 5269, "num_union": 11595, "num_only_computed": 3163, "num_only_roped": 3163, "total_diff": 6326, "diff_percentage": 0.5455799913755929, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:16:53.514849", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.2218952178955078e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.11521084337349398}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:18:11.800755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4600865800865801, "overlap_percentage": 0.6302182163187856, "num_intersection": 5314, "num_union": 11550, "num_only_computed": 3118, "num_only_roped": 3118, "total_diff": 6236, "diff_percentage": 0.5399134199134199, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:18:15.177017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.2278556823730469e-05, "l2_diff": 0.039794921875, "l2_diff_relative": 0.11133879781420765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:19:34.665671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45559678950548027, "overlap_percentage": 0.6259931222577968, "num_intersection": 5279, "num_union": 11587, "num_only_computed": 3154, "num_only_roped": 3154, "total_diff": 6308, "diff_percentage": 0.5444032104945197, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:19:38.482628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.239776611328125e-05, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.11474609375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:25.361621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:25.375268", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.03125, "l2_diff_relative": 0.0030303030303030303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:31.330515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7538368568598678, "overlap_percentage": 0.8596430778739185, "num_intersection": 1112722, "num_union": 1476078, "num_only_computed": 197998, "num_only_roped": 165358, "total_diff": 363356, "diff_percentage": 0.24616314314013216, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:31.710192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.1083984375, "l2_diff_relative": 0.012300531914893617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:49.234630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6265032902201044, "overlap_percentage": 0.7703683035714286, "num_intersection": 1413632, "num_union": 2256384, "num_only_computed": 421376, "num_only_roped": 421376, "total_diff": 842752, "diff_percentage": 0.37349670977989563, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:49.795610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 8.881092071533203e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.01905829596412556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:10.462129", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5714643490864137, "overlap_percentage": 0.7273017035590278, "num_intersection": 1715920, "num_union": 3002672, "num_only_computed": 643376, "num_only_roped": 643376, "total_diff": 1286752, "diff_percentage": 0.4285356509135863, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:11.200456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.867813110351562e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.022569444444444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:37.831888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5296083446762057, "overlap_percentage": 0.6924757523970171, "num_intersection": 1996812, "num_union": 3770356, "num_only_computed": 886772, "num_only_roped": 886772, "total_diff": 1773544, "diff_percentage": 0.47039165532379434, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:38.752558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 8.344650268554688e-06, "l2_diff": 0.185546875, "l2_diff_relative": 0.026625560538116592}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:11.405389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5101153389478824, "overlap_percentage": 0.6755978510929987, "num_intersection": 2302351, "num_union": 4513393, "num_only_computed": 1105521, "num_only_roped": 1105521, "total_diff": 2211042, "diff_percentage": 0.48988466105211753, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:13.892941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.794929504394531e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.025555555555555557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:52.491963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4937723396681848, "overlap_percentage": 0.661107889811198, "num_intersection": 2599582, "num_union": 5264738, "num_only_computed": 1332578, "num_only_roped": 1332578, "total_diff": 2665156, "diff_percentage": 0.5062276603318152, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:55.712386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.193359375, "l2_diff_relative": 0.027257709251101322}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:23:40.353618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48481895259485674, "overlap_percentage": 0.6530344345990349, "num_intersection": 2910214, "num_union": 6002682, "num_only_computed": 1546234, "num_only_roped": 1546234, "total_diff": 3092468, "diff_percentage": 0.5151810474051433, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:23:41.932429", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.19140625, "l2_diff_relative": 0.02734375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:24:32.828249", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4794327599893366, "overlap_percentage": 0.6481305172568873, "num_intersection": 3228167, "num_union": 6733305, "num_only_computed": 1752569, "num_only_roped": 1752569, "total_diff": 3505138, "diff_percentage": 0.5205672400106635, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:24:34.552757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.21484375, "l2_diff_relative": 0.026647286821705425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:25:32.793689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4799225389607064, "overlap_percentage": 0.6485779171898252, "num_intersection": 3570437, "num_union": 7439611, "num_only_computed": 1934587, "num_only_roped": 1934587, "total_diff": 3869174, "diff_percentage": 0.5200774610392935, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:25:34.778684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048095703125, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.0375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:26:41.409959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4621378870909169, "overlap_percentage": 0.63213995228643, "num_intersection": 3811369, "num_union": 8247255, "num_only_computed": 2217943, "num_only_roped": 2217943, "total_diff": 4435886, "diff_percentage": 0.537862112909083, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:26:43.648843", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 7.569789886474609e-06, "l2_diff": 0.212890625, "l2_diff_relative": 0.02640503875968992}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:27:56.906613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46644797640651325, "overlap_percentage": 0.6361602783203125, "num_intersection": 4169140, "num_union": 8938060, "num_only_computed": 2384460, "num_only_roped": 2384460, "total_diff": 4768920, "diff_percentage": 0.5335520235934867, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:28:01.063865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 1.2695789337158203e-05, "l2_diff": 0.462890625, "l2_diff_relative": 0.062237394957983194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:23.621222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45324364062387396, "overlap_percentage": 0.6237682766384549, "num_intersection": 4414962, "num_union": 9740814, "num_only_computed": 2662926, "num_only_roped": 2662926, "total_diff": 5325852, "diff_percentage": 0.5467563593761261, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:27.055052", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.054443359375, "mean_diff": 7.808208465576172e-06, "l2_diff": 0.26171875, "l2_diff_relative": 0.03271484375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:30:55.713843", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4530459788953876, "overlap_percentage": 0.6235810641584725, "num_intersection": 4740573, "num_union": 10463779, "num_only_computed": 2861603, "num_only_roped": 2861603, "total_diff": 5723206, "diff_percentage": 0.5469540211046124, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:30:58.711974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 1.1444091796875e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.06169181034482758}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:32:36.299852", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45731743729777197, "overlap_percentage": 0.6276154056672127, "num_intersection": 5100294, "num_union": 11152634, "num_only_computed": 3026170, "num_only_roped": 3026170, "total_diff": 6052340, "diff_percentage": 0.542682562702228, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:32:39.559593", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 1.2278556823730469e-05, "l2_diff": 0.58203125, "l2_diff_relative": 0.07959401709401709}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:34:26.096554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4462105419731366, "overlap_percentage": 0.6170754935368532, "num_intersection": 5144725, "num_union": 11529815, "num_only_computed": 3192545, "num_only_roped": 3192545, "total_diff": 6385090, "diff_percentage": 0.5537894580268634, "num_computed": 8337270, "num_roped": 8337270}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 989, "seq_len_k": 16349, "queries_shape": [1, 32, 989, 128], "keys_shape": [1, 8, 16349, 128], "mask_shape": [1, 32, 989, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:34:29.664609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 1.341104507446289e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.09879912663755458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 989, "seq_len_k": 16349, "queries_shape": [1, 32, 989, 128], "keys_shape": [1, 8, 16349, 128], "attention_shape": [1, 32, 989, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:36:15.799377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.442853678966627, "overlap_percentage": 0.6138580584052004, "num_intersection": 160724, "num_union": 362928, "num_only_computed": 101102, "num_only_roped": 101102, "total_diff": 202204, "diff_percentage": 0.557146321033373, "num_computed": 261826, "num_roped": 261826}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16380, 128], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:36:19.367487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.10888671875, "l2_diff_relative": 0.09050324675324675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16380, 128], "attention_shape": [1, 32, 31, 16380]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:37:49.643262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45407592321597656, "overlap_percentage": 0.6245560028415819, "num_intersection": 5275, "num_union": 11617, "num_only_computed": 3171, "num_only_roped": 3171, "total_diff": 6342, "diff_percentage": 0.5459240767840234, "num_computed": 8446, "num_roped": 8446}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16381, 128], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:37:52.192514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.5616416931152344e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.10823170731707317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16381, 128], "attention_shape": [1, 32, 1, 16381]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:38:37.771322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:38:37.783825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2186508178710938e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.003053977272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:38:43.644358", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7587625616191921, "overlap_percentage": 0.8628368355995055, "num_intersection": 1116856, "num_union": 1471944, "num_only_computed": 193864, "num_only_roped": 161224, "total_diff": 355088, "diff_percentage": 0.24123743838080797, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:38:44.027649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.930662155151367e-06, "l2_diff": 0.09033203125, "l2_diff_relative": 0.009508634868421052}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:38:58.968360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6306623614998296, "overlap_percentage": 0.7735045296805245, "num_intersection": 1419387, "num_union": 2250629, "num_only_computed": 415621, "num_only_roped": 415621, "total_diff": 831242, "diff_percentage": 0.3693376385001704, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:38:59.521715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.930662155151367e-06, "l2_diff": 0.1142578125, "l2_diff_relative": 0.0126953125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:39:19.541297", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5661535540719862, "overlap_percentage": 0.7229860093858507, "num_intersection": 1705738, "num_union": 3012854, "num_only_computed": 653558, "num_only_roped": 653558, "total_diff": 1307116, "diff_percentage": 0.43384644592801375, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:39:20.253786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.8710575103759766e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015196917808219178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:39:46.540304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5300604206362977, "overlap_percentage": 0.6928620771928267, "num_intersection": 1997926, "num_union": 3769242, "num_only_computed": 885658, "num_only_roped": 885658, "total_diff": 1771316, "diff_percentage": 0.4699395793637023, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:39:47.433412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.933906555175781e-06, "l2_diff": 0.11376953125, "l2_diff_relative": 0.013895515267175572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:40:19.133706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5099862000332759, "overlap_percentage": 0.6754845839280349, "num_intersection": 2301965, "num_union": 4513779, "num_only_computed": 1105907, "num_only_roped": 1105907, "total_diff": 2211814, "diff_percentage": 0.4900137999667241, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:40:20.233375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.993511199951172e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.01679981203007519}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:40:57.719599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49164822888205856, "overlap_percentage": 0.6592013041178385, "num_intersection": 2592085, "num_union": 5272235, "num_only_computed": 1340075, "num_only_roped": 1340075, "total_diff": 2680150, "diff_percentage": 0.5083517711179415, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:40:58.998911", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.1806640625, "l2_diff_relative": 0.022760826771653545}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:41:42.808270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47675259756075333, "overlap_percentage": 0.6456770055434283, "num_intersection": 2877426, "num_union": 6035470, "num_only_computed": 1579022, "num_only_roped": 1579022, "total_diff": 3158044, "diff_percentage": 0.5232474024392466, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:41:44.299963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.2001953125, "l2_diff_relative": 0.025522908366533866}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:42:34.962807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46927724748869626, "overlap_percentage": 0.6387865166915091, "num_intersection": 3181627, "num_union": 6779845, "num_only_computed": 1799109, "num_only_roped": 1799109, "total_diff": 3598218, "diff_percentage": 0.5307227525113037, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:42:36.692208", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 1.4603137969970703e-05, "l2_diff": 0.28515625, "l2_diff_relative": 0.03694331983805668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:43:34.876396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4617528265078227, "overlap_percentage": 0.6317796253022694, "num_intersection": 3477962, "num_union": 7532086, "num_only_computed": 2027062, "num_only_roped": 2027062, "total_diff": 4054124, "diff_percentage": 0.5382471734921773, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:43:36.878178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 1.4126300811767578e-05, "l2_diff": 0.3203125, "l2_diff_relative": 0.0400390625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:44:44.183482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45640779626998695, "overlap_percentage": 0.6267582437266475, "num_intersection": 3778921, "num_union": 8279703, "num_only_computed": 2250391, "num_only_roped": 2250391, "total_diff": 4500782, "diff_percentage": 0.543592203730013, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:44:48.417343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.424551010131836e-05, "l2_diff": 0.3515625, "l2_diff_relative": 0.04326923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:46:02.510178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45289701492802026, "overlap_percentage": 0.62343994140625, "num_intersection": 4085776, "num_union": 9021424, "num_only_computed": 2467824, "num_only_roped": 2467824, "total_diff": 4935648, "diff_percentage": 0.5471029850719797, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:46:05.044581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 1.4603137969970703e-05, "l2_diff": 0.466796875, "l2_diff_relative": 0.057013358778625955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:47:26.882640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4529104239248334, "overlap_percentage": 0.6234526457609953, "num_intersection": 4412728, "num_union": 9743048, "num_only_computed": 2665160, "num_only_roped": 2665160, "total_diff": 5330320, "diff_percentage": 0.5470895760751666, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:47:29.688163", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 1.3947486877441406e-05, "l2_diff": 0.5625, "l2_diff_relative": 0.06766917293233082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:49:00.905758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44809117162949913, "overlap_percentage": 0.6188714915308459, "num_intersection": 4704770, "num_union": 10499582, "num_only_computed": 2897406, "num_only_roped": 2897406, "total_diff": 5794812, "diff_percentage": 0.5519088283705008, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:49:03.942976", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 7.18235969543457e-06, "l2_diff": 0.35546875, "l2_diff_relative": 0.04005281690140845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:50:35.816138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45134942719344323, "overlap_percentage": 0.6219721022886173, "num_intersection": 831772, "num_union": 1842856, "num_only_computed": 505542, "num_only_roped": 505542, "total_diff": 1011084, "diff_percentage": 0.5486505728065568, "num_computed": 1337314, "num_roped": 1337314}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 178, "seq_len_k": 14514, "queries_shape": [1, 32, 178, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 178, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:50:38.718972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.259765625, "l2_diff_relative": 0.07165948275862069}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 178, "seq_len_k": 14514, "queries_shape": [1, 32, 178, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 178, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:07.398072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4590225518352904, "overlap_percentage": 0.6292192691029901, "num_intersection": 113637, "num_union": 247563, "num_only_computed": 66963, "num_only_roped": 66963, "total_diff": 133926, "diff_percentage": 0.5409774481647096, "num_computed": 180600, "num_roped": 180600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14538, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14538, 128], "mask_shape": [1, 32, 24, 14538], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:10.904757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.0908203125, "l2_diff_relative": 0.06961077844311377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14538, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14538, 128], "attention_shape": [1, 32, 24, 14538]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:53:31.162755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4576271186440678, "overlap_percentage": 0.627906976744186, "num_intersection": 4725, "num_union": 10325, "num_only_computed": 2800, "num_only_roped": 2800, "total_diff": 5600, "diff_percentage": 0.5423728813559322, "num_computed": 7525, "num_roped": 7525}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14539, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14539, 128], "mask_shape": [1, 32, 1, 14539], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:53:35.279945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 9.119510650634766e-06, "l2_diff": 0.0223388671875, "l2_diff_relative": 0.06848802395209581}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14539, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14539, 128], "attention_shape": [1, 32, 1, 14539]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:18.277090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:18.289750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.031982421875, "l2_diff_relative": 0.003120236280487805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:24.352734", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.749586392586425, "overlap_percentage": 0.8568726823238566, "num_intersection": 1109136, "num_union": 1479664, "num_only_computed": 201584, "num_only_roped": 168944, "total_diff": 370528, "diff_percentage": 0.250413607413575, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:24.746106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 8.046627044677734e-06, "l2_diff": 0.10986328125, "l2_diff_relative": 0.012555803571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:39.574905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6220678047905155, "overlap_percentage": 0.7670059204101562, "num_intersection": 1407462, "num_union": 2262554, "num_only_computed": 427546, "num_only_roped": 427546, "total_diff": 855092, "diff_percentage": 0.3779321952094845, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:42.609137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.543231964111328e-06, "l2_diff": 0.10205078125, "l2_diff_relative": 0.01218516791044776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:03.643048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5629512422379793, "overlap_percentage": 0.7203695509168837, "num_intersection": 1699565, "num_union": 3019027, "num_only_computed": 659731, "num_only_roped": 659731, "total_diff": 1319462, "diff_percentage": 0.4370487577620207, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:04.381223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.496906280517578e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.016807768924302788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:30.750308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5297365545193155, "overlap_percentage": 0.6925853382457386, "num_intersection": 1997128, "num_union": 3770040, "num_only_computed": 886456, "num_only_roped": 886456, "total_diff": 1772912, "diff_percentage": 0.47026344548068455, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:31.651471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.841255187988281e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.020391949152542374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:56:04.014707", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5128871036624075, "overlap_percentage": 0.6780242919921875, "num_intersection": 2310620, "num_union": 4505124, "num_only_computed": 1097252, "num_only_roped": 1097252, "total_diff": 2194504, "diff_percentage": 0.48711289633759247, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:56:05.640621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.01971153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:56:44.072635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4981277974455141, "overlap_percentage": 0.6650004069010417, "num_intersection": 2614888, "num_union": 5249432, "num_only_computed": 1317272, "num_only_roped": 1317272, "total_diff": 2634544, "diff_percentage": 0.501872202554486, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:56:47.021025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.231929779052734e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.020241477272727272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:57:31.659672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4905662428378652, "overlap_percentage": 0.6582280327292049, "num_intersection": 2933359, "num_union": 5979537, "num_only_computed": 1523089, "num_only_roped": 1523089, "total_diff": 3046178, "diff_percentage": 0.5094337571621348, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:57:33.188408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.9802322387695312e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.017140858208955223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:58:25.036922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4874833186821949, "overlap_percentage": 0.6554471066123561, "num_intersection": 3264609, "num_union": 6696863, "num_only_computed": 1716127, "num_only_roped": 1716127, "total_diff": 3432254, "diff_percentage": 0.512516681317805, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:58:26.768763", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 1.1444091796875e-05, "l2_diff": 0.271484375, "l2_diff_relative": 0.033935546875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:59:26.080896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47255364565779123, "overlap_percentage": 0.641815185546875, "num_intersection": 3533208, "num_union": 7476840, "num_only_computed": 1971816, "num_only_roped": 1971816, "total_diff": 3943632, "diff_percentage": 0.5274463543422088, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:59:28.104511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 1.3887882232666016e-05, "l2_diff": 0.30859375, "l2_diff_relative": 0.03769083969465649}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:00:35.675576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47319175314307604, "overlap_percentage": 0.6424034782077955, "num_intersection": 3873251, "num_union": 8185373, "num_only_computed": 2156061, "num_only_roped": 2156061, "total_diff": 4312122, "diff_percentage": 0.526808246856924, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:00:37.915137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 1.3947486877441406e-05, "l2_diff": 0.369140625, "l2_diff_relative": 0.04045376712328767}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:01:52.416916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46650671503704194, "overlap_percentage": 0.6362149047851563, "num_intersection": 4169498, "num_union": 8937702, "num_only_computed": 2384102, "num_only_roped": 2384102, "total_diff": 4768204, "diff_percentage": 0.533493284962958, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:01:54.931849", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 1.2636184692382812e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.052300347222222224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:03:15.846079", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4569917153127353, "overlap_percentage": 0.6273085982711227, "num_intersection": 4440020, "num_union": 9715756, "num_only_computed": 2637868, "num_only_roped": 2637868, "total_diff": 5275736, "diff_percentage": 0.5430082846872647, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:03:18.610181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 8.046627044677734e-06, "l2_diff": 0.353515625, "l2_diff_relative": 0.044189453125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:04:47.944904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.444518254244528, "overlap_percentage": 0.6154553643588362, "num_intersection": 4678800, "num_union": 10525552, "num_only_computed": 2923376, "num_only_roped": 2923376, "total_diff": 5846752, "diff_percentage": 0.555481745755472, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:04:52.220257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 7.987022399902344e-06, "l2_diff": 0.37109375, "l2_diff_relative": 0.04731075697211155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:06:24.733579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46418138823202115, "overlap_percentage": 0.6340490214706441, "num_intersection": 1328126, "num_union": 2861222, "num_only_computed": 766548, "num_only_roped": 766548, "total_diff": 1533096, "diff_percentage": 0.5358186117679788, "num_computed": 2094674, "num_roped": 2094674}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 277, "seq_len_k": 14613, "queries_shape": [1, 32, 277, 128], "keys_shape": [1, 8, 14613, 128], "mask_shape": [1, 32, 277, 14613], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:06:29.484460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 1.0907649993896484e-05, "l2_diff": 0.259765625, "l2_diff_relative": 0.06112132352941176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 277, "seq_len_k": 14613, "queries_shape": [1, 32, 277, 128], "keys_shape": [1, 8, 14613, 128], "attention_shape": [1, 32, 277, 14613]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:07:59.150475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44413344608678046, "overlap_percentage": 0.615086434415413, "num_intersection": 149156, "num_union": 335836, "num_only_computed": 93340, "num_only_roped": 93340, "total_diff": 186680, "diff_percentage": 0.5558665539132196, "num_computed": 242496, "num_roped": 242496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14645, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14645, 128], "mask_shape": [1, 32, 32, 14645], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:08:03.842384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.12451171875, "l2_diff_relative": 0.08854166666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14645, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14645, 128], "attention_shape": [1, 32, 32, 14645]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:23.313174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4541442824251727, "overlap_percentage": 0.6246206623565114, "num_intersection": 4734, "num_union": 10424, "num_only_computed": 2845, "num_only_roped": 2845, "total_diff": 5690, "diff_percentage": 0.5458557175748273, "num_computed": 7579, "num_roped": 7579}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14646, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14646, 128], "mask_shape": [1, 32, 1, 14646], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:27.261465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008544921875, "mean_diff": 1.5974044799804688e-05, "l2_diff": 0.021240234375, "l2_diff_relative": 0.0725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14646, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14646, 128], "attention_shape": [1, 32, 1, 14646]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:09.542401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:09.555086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0302734375, "l2_diff_relative": 0.003125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:15.533292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7675345255725131, "overlap_percentage": 0.8684803770086527, "num_intersection": 1124161, "num_union": 1464639, "num_only_computed": 186559, "num_only_roped": 153919, "total_diff": 340478, "diff_percentage": 0.2324654744274869, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:15.920060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.417533874511719e-06, "l2_diff": 0.1240234375, "l2_diff_relative": 0.014073581560283687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:31.009851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6270830562427402, "overlap_percentage": 0.7708064488002232, "num_intersection": 1414436, "num_union": 2255580, "num_only_computed": 420572, "num_only_roped": 420572, "total_diff": 841144, "diff_percentage": 0.37291694375725976, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:31.550068", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.09423828125, "l2_diff_relative": 0.011510019083969465}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:51.938772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.572262871495465, "overlap_percentage": 0.7279480828179253, "num_intersection": 1717445, "num_union": 3001147, "num_only_computed": 641851, "num_only_roped": 641851, "total_diff": 1283702, "diff_percentage": 0.4277371285045351, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:52.675036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.018336776859504134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:11:19.020854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5391296364696111, "overlap_percentage": 0.7005642977627841, "num_intersection": 2020136, "num_union": 3747032, "num_only_computed": 863448, "num_only_roped": 863448, "total_diff": 1726896, "diff_percentage": 0.46087036353038885, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:11:19.941276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.811452865600586e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.01953125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:11:52.272254", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5082116089743731, "overlap_percentage": 0.6739261333759015, "num_intersection": 2296654, "num_union": 4519090, "num_only_computed": 1111218, "num_only_roped": 1111218, "total_diff": 2222436, "diff_percentage": 0.4917883910256268, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:11:53.387730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.288290023803711e-06, "l2_diff": 0.1904296875, "l2_diff_relative": 0.023991141732283464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:12:32.308798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49310586798625733, "overlap_percentage": 0.66051025390625, "num_intersection": 2597232, "num_union": 5267088, "num_only_computed": 1334928, "num_only_roped": 1334928, "total_diff": 2669856, "diff_percentage": 0.5068941320137427, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:12:33.625573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.364418029785156e-06, "l2_diff": 0.197265625, "l2_diff_relative": 0.02576530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:13:18.417401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.487650172968682, "overlap_percentage": 0.6555979111615349, "num_intersection": 2921638, "num_union": 5991258, "num_only_computed": 1534810, "num_only_roped": 1534810, "total_diff": 3069620, "diff_percentage": 0.5123498270313179, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:13:21.197840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.112720489501953e-06, "l2_diff": 0.173828125, "l2_diff_relative": 0.021728515625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:14:13.375722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4730096089323353, "overlap_percentage": 0.6422356053402549, "num_intersection": 3198806, "num_union": 6762666, "num_only_computed": 1781930, "num_only_roped": 1781930, "total_diff": 3563860, "diff_percentage": 0.5269903910676648, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:14:16.952983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.4722347259521484e-05, "l2_diff": 0.361328125, "l2_diff_relative": 0.04941239316239316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:15:15.924506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46216262338188374, "overlap_percentage": 0.63216309320359, "num_intersection": 3480073, "num_union": 7529975, "num_only_computed": 2024951, "num_only_roped": 2024951, "total_diff": 4049902, "diff_percentage": 0.5378373766181163, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:15:17.954550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.0585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:16:23.517567", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45299681653761714, "overlap_percentage": 0.6235344928243886, "num_intersection": 3759484, "num_union": 8299140, "num_only_computed": 2269828, "num_only_roped": 2269828, "total_diff": 4539656, "diff_percentage": 0.5470031834623829, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:16:25.763179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 9.5367431640625e-06, "l2_diff": 0.302734375, "l2_diff_relative": 0.03986625514403292}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:17:39.160142", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4561481353433878, "overlap_percentage": 0.6265133666992188, "num_intersection": 4105918, "num_union": 9001282, "num_only_computed": 2447682, "num_only_roped": 2447682, "total_diff": 4895364, "diff_percentage": 0.5438518646566123, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:17:41.672059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041748046875, "mean_diff": 1.2695789337158203e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.05133928571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:19:02.992620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45681912979099215, "overlap_percentage": 0.62714597913954, "num_intersection": 4438869, "num_union": 9716907, "num_only_computed": 2639019, "num_only_roped": 2639019, "total_diff": 5278038, "diff_percentage": 0.5431808702090078, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:19:08.001760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 1.2159347534179688e-05, "l2_diff": 0.34765625, "l2_diff_relative": 0.05150462962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:20:36.811737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43673463216655684, "overlap_percentage": 0.6079544856630522, "num_intersection": 4621777, "num_union": 10582575, "num_only_computed": 2980399, "num_only_roped": 2980399, "total_diff": 5960798, "diff_percentage": 0.5632653678334432, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:20:39.814062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 9.655952453613281e-06, "l2_diff": 0.3828125, "l2_diff_relative": 0.04748062015503876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:22:18.652935", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4463987333075609, "overlap_percentage": 0.6172554262222782, "num_intersection": 5016104, "num_union": 11236824, "num_only_computed": 3110360, "num_only_roped": 3110360, "total_diff": 6220720, "diff_percentage": 0.553601266692439, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:22:23.878624", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 9.834766387939453e-06, "l2_diff": 0.5859375, "l2_diff_relative": 0.07530120481927711}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:24:04.634528", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4432752750627469, "overlap_percentage": 0.6142629652454559, "num_intersection": 2338348, "num_union": 5275160, "num_only_computed": 1468406, "num_only_roped": 1468406, "total_diff": 2936812, "diff_percentage": 0.5567247249372531, "num_computed": 3806754, "num_roped": 3806754}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 466, "seq_len_k": 15826, "queries_shape": [1, 32, 466, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 466, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:24:07.908098", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 8.881092071533203e-06, "l2_diff": 0.28515625, "l2_diff_relative": 0.05097765363128492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 466, "seq_len_k": 15826, "queries_shape": [1, 32, 466, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 466, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:25:46.276650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4695307237482224, "overlap_percentage": 0.6390213095383612, "num_intersection": 125468, "num_union": 267220, "num_only_computed": 70876, "num_only_roped": 70876, "total_diff": 141752, "diff_percentage": 0.5304692762517775, "num_computed": 196344, "num_roped": 196344}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15850, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15850, 128], "mask_shape": [1, 32, 24, 15850], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:25:51.123075", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.5854835510253906e-05, "l2_diff": 0.10595703125, "l2_diff_relative": 0.08529874213836477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15850, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15850, 128], "attention_shape": [1, 32, 24, 15850]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:18.762689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49903802107191936, "overlap_percentage": 0.6658110255469991, "num_intersection": 5447, "num_union": 10915, "num_only_computed": 2734, "num_only_roped": 2734, "total_diff": 5468, "diff_percentage": 0.5009619789280806, "num_computed": 8181, "num_roped": 8181}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15851, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15851, 128], "mask_shape": [1, 32, 1, 15851], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:21.260648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.2278556823730469e-05, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.11342592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15851, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15851, 128], "attention_shape": [1, 32, 1, 15851]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:39.560584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46617686587223367, "overlap_percentage": 0.6359080909313126, "num_intersection": 5203, "num_union": 11161, "num_only_computed": 2979, "num_only_roped": 2979, "total_diff": 5958, "diff_percentage": 0.5338231341277663, "num_computed": 8182, "num_roped": 8182}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15852, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15852, 128], "mask_shape": [1, 32, 1, 15852], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:42.062426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.0264892578125, "l2_diff_relative": 0.09757194244604317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15852, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15852, 128], "attention_shape": [1, 32, 1, 15852]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:29:59.222513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.459507670353193, "overlap_percentage": 0.6296748961134196, "num_intersection": 5152, "num_union": 11212, "num_only_computed": 3030, "num_only_roped": 3030, "total_diff": 6060, "diff_percentage": 0.540492329646807, "num_computed": 8182, "num_roped": 8182}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15853, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15853, 128], "mask_shape": [1, 32, 1, 15853], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:30:01.720296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.031005859375, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.14963503649635038}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15853, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15853, 128], "attention_shape": [1, 32, 1, 15853]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:31:19.227781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4802821997105644, "overlap_percentage": 0.6489062690944641, "num_intersection": 5310, "num_union": 11056, "num_only_computed": 2873, "num_only_roped": 2873, "total_diff": 5746, "diff_percentage": 0.5197178002894356, "num_computed": 8183, "num_roped": 8183}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15854, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15854, 128], "mask_shape": [1, 32, 1, 15854], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:31:22.775536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.049072265625, "l2_diff_relative": 0.1675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15854, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15854, 128], "attention_shape": [1, 32, 1, 15854]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:32:39.411523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4944753903753082, "overlap_percentage": 0.6617377489918123, "num_intersection": 5415, "num_union": 10951, "num_only_computed": 2768, "num_only_roped": 2768, "total_diff": 5536, "diff_percentage": 0.5055246096246918, "num_computed": 8183, "num_roped": 8183}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15855, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15855, 128], "mask_shape": [1, 32, 1, 15855], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:32:42.781319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.2695789337158203e-05, "l2_diff": 0.028076171875, "l2_diff_relative": 0.11318897637795275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15855, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15855, 128], "attention_shape": [1, 32, 1, 15855]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:25.514518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:25.522891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003005783279220779}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:31.451731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7515454912656148, "overlap_percentage": 0.8581512669962917, "num_intersection": 1110791, "num_union": 1478009, "num_only_computed": 199929, "num_only_roped": 167289, "total_diff": 367218, "diff_percentage": 0.24845450873438524, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:31.831502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 8.702278137207031e-06, "l2_diff": 0.1162109375, "l2_diff_relative": 0.013473731884057972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:43.965396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5820693369016245, "overlap_percentage": 0.7358329035585354, "num_intersection": 214017, "num_union": 367683, "num_only_computed": 76833, "num_only_roped": 76833, "total_diff": 153666, "diff_percentage": 0.4179306630983755, "num_computed": 290850, "num_roped": 290850}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 210, "seq_len_k": 2258, "queries_shape": [1, 32, 210, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 210, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:44.364163", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.424551010131836e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.01994047619047619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 210, "seq_len_k": 2258, "queries_shape": [1, 32, 210, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 210, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:56.483536", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5706158792975513, "overlap_percentage": 0.7266141732283464, "num_intersection": 25377, "num_union": 44473, "num_only_computed": 9548, "num_only_roped": 9548, "total_diff": 19096, "diff_percentage": 0.4293841207024487, "num_computed": 34925, "num_roped": 34925}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2283, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2283, 128], "mask_shape": [1, 32, 25, 2283], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:56.872953", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00341796875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.0225830078125, "l2_diff_relative": 0.019143211920529802}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2283, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2283, 128], "attention_shape": [1, 32, 25, 2283]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:08.295095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5541967759866593, "overlap_percentage": 0.7131616595135909, "num_intersection": 997, "num_union": 1799, "num_only_computed": 401, "num_only_roped": 401, "total_diff": 802, "diff_percentage": 0.44580322401334077, "num_computed": 1398, "num_roped": 1398}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2284, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2284, 128], "mask_shape": [1, 32, 1, 2284], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:08.647903", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 7.12275505065918e-06, "l2_diff": 0.00186920166015625, "l2_diff_relative": 0.007595486111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2284, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2284, 128], "attention_shape": [1, 32, 1, 2284]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:19.613086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5620111731843576, "overlap_percentage": 0.7195994277539342, "num_intersection": 1006, "num_union": 1790, "num_only_computed": 392, "num_only_roped": 392, "total_diff": 784, "diff_percentage": 0.43798882681564244, "num_computed": 1398, "num_roped": 1398}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2285, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2285, 128], "mask_shape": [1, 32, 1, 2285], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:20.423855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 1.049041748046875e-05, "l2_diff": 0.0022735595703125, "l2_diff_relative": 0.010166484716157205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2285, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2285, 128], "attention_shape": [1, 32, 1, 2285]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:31.341997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5605131065253764, "overlap_percentage": 0.7183702644746247, "num_intersection": 1005, "num_union": 1793, "num_only_computed": 394, "num_only_roped": 394, "total_diff": 788, "diff_percentage": 0.43948689347462355, "num_computed": 1399, "num_roped": 1399}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2286, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2286, 128], "mask_shape": [1, 32, 1, 2286], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:34.212939", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 8.821487426757812e-06, "l2_diff": 0.002105712890625, "l2_diff_relative": 0.011408730158730158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2286, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2286, 128], "attention_shape": [1, 32, 1, 2286]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:45.132574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5553085047248472, "overlap_percentage": 0.7140814867762688, "num_intersection": 999, "num_union": 1799, "num_only_computed": 400, "num_only_roped": 400, "total_diff": 800, "diff_percentage": 0.44469149527515284, "num_computed": 1399, "num_roped": 1399}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2287, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2287, 128], "mask_shape": [1, 32, 1, 2287], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:48.047971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.5974044799804688e-05, "l2_diff": 0.00433349609375, "l2_diff_relative": 0.018802966101694914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2287, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2287, 128], "attention_shape": [1, 32, 1, 2287]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:56.782648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:56.795236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0030066287878787877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:02.707541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.751819285440709, "overlap_percentage": 0.8583297280593325, "num_intersection": 1111022, "num_union": 1477778, "num_only_computed": 199698, "num_only_roped": 167058, "total_diff": 366756, "diff_percentage": 0.24818071455929105, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:03.098104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 7.62939453125e-06, "l2_diff": 0.09814453125, "l2_diff_relative": 0.01171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:17.801165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6259966939688191, "overlap_percentage": 0.7699851989746094, "num_intersection": 1412929, "num_union": 2257087, "num_only_computed": 422079, "num_only_roped": 422079, "total_diff": 844158, "diff_percentage": 0.37400330603118087, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:18.359958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.407499313354492e-06, "l2_diff": 0.10888671875, "l2_diff_relative": 0.013001399253731344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:40.109003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5586619914875625, "overlap_percentage": 0.71684816148546, "num_intersection": 1691257, "num_union": 3027335, "num_only_computed": 668039, "num_only_roped": 668039, "total_diff": 1336078, "diff_percentage": 0.4413380085124375, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:40.862726", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.26173210144043e-06, "l2_diff": 0.103515625, "l2_diff_relative": 0.012001811594202898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:09.505249", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5339416257392535, "overlap_percentage": 0.6961694197221235, "num_intersection": 2007463, "num_union": 3759705, "num_only_computed": 876121, "num_only_roped": 876121, "total_diff": 1752242, "diff_percentage": 0.46605837426074653, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:12.451109", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.5299530029296875e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.014668367346938776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:44.963096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5160095599381206, "overlap_percentage": 0.6807471055250901, "num_intersection": 2319899, "num_union": 4495845, "num_only_computed": 1087973, "num_only_roped": 1087973, "total_diff": 2175946, "diff_percentage": 0.48399044006187936, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:46.098168", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.291534423828125e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.016267123287671232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:37:24.607701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4988824593479936, "overlap_percentage": 0.6656725565592448, "num_intersection": 2617531, "num_union": 5246789, "num_only_computed": 1314629, "num_only_roped": 1314629, "total_diff": 2629258, "diff_percentage": 0.5011175406520064, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:37:25.926214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.5315752029418945e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.017263986013986012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:38:11.277830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49275337075113856, "overlap_percentage": 0.6601939481847426, "num_intersection": 2942120, "num_union": 5970776, "num_only_computed": 1514328, "num_only_roped": 1514328, "total_diff": 3028656, "diff_percentage": 0.5072466292488614, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:38:12.807108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.6954879760742188e-06, "l2_diff": 0.18359375, "l2_diff_relative": 0.021599264705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:39:07.586123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4870321149980706, "overlap_percentage": 0.6550391347784745, "num_intersection": 3262577, "num_union": 6698895, "num_only_computed": 1718159, "num_only_roped": 1718159, "total_diff": 3436318, "diff_percentage": 0.5129678850019295, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:39:11.679286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.310546875, "l2_diff_relative": 0.037642045454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:40:10.724049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4871680647921587, "overlap_percentage": 0.6551620846702939, "num_intersection": 3606683, "num_union": 7403365, "num_only_computed": 1898341, "num_only_roped": 1898341, "total_diff": 3796682, "diff_percentage": 0.5128319352078413, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:40:12.739204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07666015625, "mean_diff": 1.4841556549072266e-05, "l2_diff": 0.376953125, "l2_diff_relative": 0.048443775100401605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:41:19.367154", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47301467551439547, "overlap_percentage": 0.6422402755073879, "num_intersection": 3872267, "num_union": 8186357, "num_only_computed": 2157045, "num_only_roped": 2157045, "total_diff": 4314090, "diff_percentage": 0.5269853244856045, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:41:21.652068", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 1.2695789337158203e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.03857758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:42:34.341627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46367420695546463, "overlap_percentage": 0.6335757025054591, "num_intersection": 3528155, "num_union": 7609125, "num_only_computed": 2040485, "num_only_roped": 2040485, "total_diff": 4080970, "diff_percentage": 0.5363257930445353, "num_computed": 5568640, "num_roped": 5568640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 880, "seq_len_k": 12144, "queries_shape": [1, 32, 880, 128], "keys_shape": [1, 8, 12144, 128], "mask_shape": [1, 32, 880, 12144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:42:38.553700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 1.329183578491211e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.06025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 880, "seq_len_k": 12144, "queries_shape": [1, 32, 880, 128], "keys_shape": [1, 8, 12144, 128], "attention_shape": [1, 32, 880, 12144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:43:50.924561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47602467547212657, "overlap_percentage": 0.6450091023307095, "num_intersection": 176092, "num_union": 369922, "num_only_computed": 96915, "num_only_roped": 96915, "total_diff": 193830, "diff_percentage": 0.5239753245278734, "num_computed": 273007, "num_roped": 273007}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12187, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12187, 128], "mask_shape": [1, 32, 43, 12187], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:43:53.200613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.115234375, "l2_diff_relative": 0.06704545454545455}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12187, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12187, 128], "attention_shape": [1, 32, 43, 12187]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:44:55.914094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4673599075678798, "overlap_percentage": 0.637007874015748, "num_intersection": 4045, "num_union": 8655, "num_only_computed": 2305, "num_only_roped": 2305, "total_diff": 4610, "diff_percentage": 0.5326400924321202, "num_computed": 6350, "num_roped": 6350}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12188, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12188, 128], "mask_shape": [1, 32, 1, 12188], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:44:58.684327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.1572052401746725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12188, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12188, 128], "attention_shape": [1, 32, 1, 12188]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:45:53.908054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4646522892399954, "overlap_percentage": 0.6344881889763779, "num_intersection": 4029, "num_union": 8671, "num_only_computed": 2321, "num_only_roped": 2321, "total_diff": 4642, "diff_percentage": 0.5353477107600046, "num_computed": 6350, "num_roped": 6350}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12189, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12189, 128], "mask_shape": [1, 32, 1, 12189], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:45:55.680165", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.16028225806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12189, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12189, 128], "attention_shape": [1, 32, 1, 12189]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:46:50.974648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4913702007749208, "overlap_percentage": 0.6589513462446859, "num_intersection": 4185, "num_union": 8517, "num_only_computed": 2166, "num_only_roped": 2166, "total_diff": 4332, "diff_percentage": 0.5086297992250792, "num_computed": 6351, "num_roped": 6351}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12190, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12190, 128], "mask_shape": [1, 32, 1, 12190], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:46:52.748718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.2755393981933594e-05, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.09821428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12190, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12190, 128], "attention_shape": [1, 32, 1, 12190]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:23.186718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:23.196190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.0030206715838509315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:29.012468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.750369505923589, "overlap_percentage": 0.8573841161928306, "num_intersection": 1109798, "num_union": 1479002, "num_only_computed": 200922, "num_only_roped": 168282, "total_diff": 369204, "diff_percentage": 0.249630494076411, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:30.098629", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.154296875, "l2_diff_relative": 0.018287037037037036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:44.540340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6366384217701394, "overlap_percentage": 0.7779829842703683, "num_intersection": 1427605, "num_union": 2242411, "num_only_computed": 407403, "num_only_roped": 407403, "total_diff": 814806, "diff_percentage": 0.36336157822986065, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:45.077741", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 6.4373016357421875e-06, "l2_diff": 0.1025390625, "l2_diff_relative": 0.012918307086614173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:48:05.598328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5682095540435986, "overlap_percentage": 0.7246602376302084, "num_intersection": 1709688, "num_union": 3008904, "num_only_computed": 649608, "num_only_roped": 649608, "total_diff": 1299216, "diff_percentage": 0.4317904459564014, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:48:06.315854", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.241964340209961e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.01834753787878788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:48:32.116459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5388491387418733, "overlap_percentage": 0.7003274397416548, "num_intersection": 2019453, "num_union": 3747715, "num_only_computed": 864131, "num_only_roped": 864131, "total_diff": 1728262, "diff_percentage": 0.4611508612581266, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:48:33.018114", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.708766937255859e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.015744274809160304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:49:04.741236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.523149910084744, "overlap_percentage": 0.6869316101074219, "num_intersection": 2340975, "num_union": 4474769, "num_only_computed": 1066897, "num_only_roped": 1066897, "total_diff": 2133794, "diff_percentage": 0.47685008991525596, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:49:07.144131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.019471153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:49:44.689970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5085780580648478, "overlap_percentage": 0.6742482503255208, "num_intersection": 2651252, "num_union": 5213068, "num_only_computed": 1280908, "num_only_roped": 1280908, "total_diff": 2561816, "diff_percentage": 0.4914219419351522, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:49:48.541350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.173828125, "l2_diff_relative": 0.0220734126984127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:50:32.241080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49612987492154587, "overlap_percentage": 0.6632176567526424, "num_intersection": 2955595, "num_union": 5957301, "num_only_computed": 1500853, "num_only_roped": 1500853, "total_diff": 3001706, "diff_percentage": 0.5038701250784542, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:50:33.721469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.827976226806641e-06, "l2_diff": 0.177734375, "l2_diff_relative": 0.024836244541484715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:51:22.363831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4795769172295463, "overlap_percentage": 0.6482622317838488, "num_intersection": 1656087, "num_union": 3453225, "num_only_computed": 898569, "num_only_roped": 898569, "total_diff": 1797138, "diff_percentage": 0.5204230827704537, "num_computed": 2554656, "num_roped": 2554656}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 552, "seq_len_k": 8744, "queries_shape": [1, 32, 552, 128], "keys_shape": [1, 8, 8744, 128], "mask_shape": [1, 32, 552, 8744], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:51:25.016575", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.5974044799804688e-05, "l2_diff": 0.251953125, "l2_diff_relative": 0.04633620689655173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 552, "seq_len_k": 8744, "queries_shape": [1, 32, 552, 128], "keys_shape": [1, 8, 8744, 128], "attention_shape": [1, 32, 552, 8744]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:52:14.415831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4504602134254549, "overlap_percentage": 0.6211272936079137, "num_intersection": 95189, "num_union": 211315, "num_only_computed": 58063, "num_only_roped": 58063, "total_diff": 116126, "diff_percentage": 0.5495397865745452, "num_computed": 153252, "num_roped": 153252}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8777, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8777, 128], "mask_shape": [1, 32, 33, 8777], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:52:15.963532", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.05126953125, "l2_diff_relative": 0.037286931818181816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8777, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8777, 128], "attention_shape": [1, 32, 33, 8777]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:00.265675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45908591173237, "overlap_percentage": 0.6292787944025834, "num_intersection": 2923, "num_union": 6367, "num_only_computed": 1722, "num_only_roped": 1722, "total_diff": 3444, "diff_percentage": 0.54091408826763, "num_computed": 4645, "num_roped": 4645}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8778, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8778, 128], "mask_shape": [1, 32, 1, 8778], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:01.723632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 1.5735626220703125e-05, "l2_diff": 0.00762939453125, "l2_diff_relative": 0.030517578125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8778, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8778, 128], "attention_shape": [1, 32, 1, 8778]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:41.739284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43964047729738104, "overlap_percentage": 0.6107642626480086, "num_intersection": 2837, "num_union": 6453, "num_only_computed": 1808, "num_only_roped": 1808, "total_diff": 3616, "diff_percentage": 0.5603595227026189, "num_computed": 4645, "num_roped": 4645}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8779, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8779, 128], "mask_shape": [1, 32, 1, 8779], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:43.676175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0096435546875, "l2_diff_relative": 0.04238197424892704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8779, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8779, 128], "attention_shape": [1, 32, 1, 8779]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:23.826193", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44938387147090936, "overlap_percentage": 0.620103314679294, "num_intersection": 2881, "num_union": 6411, "num_only_computed": 1765, "num_only_roped": 1765, "total_diff": 3530, "diff_percentage": 0.5506161285290906, "num_computed": 4646, "num_roped": 4646}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8780, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8780, 128], "mask_shape": [1, 32, 1, 8780], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:25.093410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.01177978515625, "l2_diff_relative": 0.041309931506849314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8780, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8780, 128], "attention_shape": [1, 32, 1, 8780]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:52.236083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:52.249802", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.029052734375, "l2_diff_relative": 0.002979767628205128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:58.239109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7484803458057544, "overlap_percentage": 0.8561495673671199, "num_intersection": 1108200, "num_union": 1480600, "num_only_computed": 202520, "num_only_roped": 169880, "total_diff": 372400, "diff_percentage": 0.2515196541942456, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:58.632858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 8.821487426757812e-06, "l2_diff": 0.1103515625, "l2_diff_relative": 0.01358173076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:55:14.305432", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6258562288628536, "overlap_percentage": 0.7698789324079242, "num_intersection": 1412734, "num_union": 2257282, "num_only_computed": 422274, "num_only_roped": 422274, "total_diff": 844548, "diff_percentage": 0.37414377113714636, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:55:14.861337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.018289728682170544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:55:35.416252", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5628383917171346, "overlap_percentage": 0.7202771504720052, "num_intersection": 1699347, "num_union": 3019245, "num_only_computed": 659949, "num_only_roped": 659949, "total_diff": 1319898, "diff_percentage": 0.43716160828286543, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:55:36.150145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 7.987022399902344e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.019783266129032258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:02.815865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5342158475331289, "overlap_percentage": 0.6964024630459872, "num_intersection": 2008135, "num_union": 3759033, "num_only_computed": 875449, "num_only_roped": 875449, "total_diff": 1750898, "diff_percentage": 0.46578415246687116, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:03.759026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 6.8247318267822266e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.022898706896551723}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:36.727442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5106662674126009, "overlap_percentage": 0.6760808504544772, "num_intersection": 2303997, "num_union": 4511747, "num_only_computed": 1103875, "num_only_roped": 1103875, "total_diff": 2207750, "diff_percentage": 0.4893337325873991, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:37.868990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 7.62939453125e-06, "l2_diff": 0.224609375, "l2_diff_relative": 0.029456967213114756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:57:16.857964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5030994430692715, "overlap_percentage": 0.6694160461425781, "num_intersection": 2632251, "num_union": 5232069, "num_only_computed": 1299909, "num_only_roped": 1299909, "total_diff": 2599818, "diff_percentage": 0.49690055693072854, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:57:18.194411", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.18359375, "l2_diff_relative": 0.025543478260869567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:58:03.306344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4893179085007074, "overlap_percentage": 0.657103370217716, "num_intersection": 2928347, "num_union": 5984549, "num_only_computed": 1528101, "num_only_roped": 1528101, "total_diff": 3056202, "diff_percentage": 0.5106820914992926, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:58:06.608213", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 3.516674041748047e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.02099802371541502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:58:59.798655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48565621477028154, "overlap_percentage": 0.6537935357344778, "num_intersection": 3256373, "num_union": 6705099, "num_only_computed": 1724363, "num_only_roped": 1724363, "total_diff": 3448726, "diff_percentage": 0.5143437852297185, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:59:01.874893", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.036865234375, "mean_diff": 1.2278556823730469e-05, "l2_diff": 0.275390625, "l2_diff_relative": 0.034156976744186045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:00:01.520181", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4789476547498393, "overlap_percentage": 0.6476870945521763, "num_intersection": 3565533, "num_union": 7444515, "num_only_computed": 1939491, "num_only_roped": 1939491, "total_diff": 3878982, "diff_percentage": 0.5210523452501606, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:00:03.578053", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 1.1265277862548828e-05, "l2_diff": 0.322265625, "l2_diff_relative": 0.03997093023255814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:01:11.346724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4715315241436808, "overlap_percentage": 0.6408717943274457, "num_intersection": 3864016, "num_union": 8194608, "num_only_computed": 2165296, "num_only_roped": 2165296, "total_diff": 4330592, "diff_percentage": 0.5284684758563192, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:01:13.660988", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0311279296875, "mean_diff": 9.834766387939453e-06, "l2_diff": 0.265625, "l2_diff_relative": 0.03244274809160305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:02:28.261989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4658088827758845, "overlap_percentage": 0.6355656433105469, "num_intersection": 4165243, "num_union": 8941957, "num_only_computed": 2388357, "num_only_roped": 2388357, "total_diff": 4776714, "diff_percentage": 0.5341911172241155, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:02:31.016134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.34375, "l2_diff_relative": 0.044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:03:51.784501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4610963019723874, "overlap_percentage": 0.6311648333514178, "num_intersection": 4467314, "num_union": 9688462, "num_only_computed": 2610574, "num_only_roped": 2610574, "total_diff": 5221148, "diff_percentage": 0.5389036980276126, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:03:54.557524", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 1.5854835510253906e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.09016393442622951}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:23.653077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4483516094106001, "overlap_percentage": 0.6191198414769666, "num_intersection": 4706658, "num_union": 10497694, "num_only_computed": 2895518, "num_only_roped": 2895518, "total_diff": 5791036, "diff_percentage": 0.5516483905894, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:27.375933", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.609375, "l2_diff_relative": 0.076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:07:04.753227", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4511667242862082, "overlap_percentage": 0.6217986076108871, "num_intersection": 5053024, "num_union": 11199904, "num_only_computed": 3073440, "num_only_roped": 3073440, "total_diff": 6146880, "diff_percentage": 0.5488332757137918, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:07:08.025090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.5234375, "l2_diff_relative": 0.06442307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:08:54.323391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.449803350866116, "overlap_percentage": 0.620502567603258, "num_intersection": 4661255, "num_union": 10362873, "num_only_computed": 2850809, "num_only_roped": 2850809, "total_diff": 5701618, "diff_percentage": 0.550196649133884, "num_computed": 7512064, "num_roped": 7512064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 896, "seq_len_k": 16256, "queries_shape": [1, 32, 896, 128], "keys_shape": [1, 8, 16256, 128], "mask_shape": [1, 32, 896, 16256], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:08:58.145797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 1.0609626770019531e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.06768774703557312}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 896, "seq_len_k": 16256, "queries_shape": [1, 32, 896, 128], "keys_shape": [1, 8, 16256, 128], "attention_shape": [1, 32, 896, 16256]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:10:44.701277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.444799643901304, "overlap_percentage": 0.6157250187302632, "num_intersection": 175872, "num_union": 395396, "num_only_computed": 109762, "num_only_roped": 109762, "total_diff": 219524, "diff_percentage": 0.555200356098696, "num_computed": 285634, "num_roped": 285634}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16290, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16290, 128], "mask_shape": [1, 32, 34, 16290], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:10:49.121543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.1416015625, "l2_diff_relative": 0.09692513368983957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16290, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16290, 128], "attention_shape": [1, 32, 34, 16290]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:12:20.410500", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46435419208645634, "overlap_percentage": 0.6342102130698727, "num_intersection": 5328, "num_union": 11474, "num_only_computed": 3073, "num_only_roped": 3073, "total_diff": 6146, "diff_percentage": 0.5356458079135437, "num_computed": 8401, "num_roped": 8401}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16291, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16291, 128], "mask_shape": [1, 32, 1, 16291], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:12:25.728390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.4483928680419922e-05, "l2_diff": 0.0255126953125, "l2_diff_relative": 0.10048076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16291, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16291, 128], "attention_shape": [1, 32, 1, 16291]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:13:46.336304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4696519153402134, "overlap_percentage": 0.6391335396334206, "num_intersection": 5370, "num_union": 11434, "num_only_computed": 3032, "num_only_roped": 3032, "total_diff": 6064, "diff_percentage": 0.5303480846597866, "num_computed": 8402, "num_roped": 8402}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16292, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16292, 128], "mask_shape": [1, 32, 1, 16292], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:13:48.950117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.16598360655737704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16292, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16292, 128], "attention_shape": [1, 32, 1, 16292]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:15:09.638221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4684960237699904, "overlap_percentage": 0.6380623661033087, "num_intersection": 5361, "num_union": 11443, "num_only_computed": 3041, "num_only_roped": 3041, "total_diff": 6082, "diff_percentage": 0.5315039762300097, "num_computed": 8402, "num_roped": 8402}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16293, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16293, 128], "mask_shape": [1, 32, 1, 16293], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:15:12.223941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.1742115020751953e-05, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.09755067567567567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16293, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16293, 128], "attention_shape": [1, 32, 1, 16293]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:16:32.701834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4545611909295482, "overlap_percentage": 0.6250148756396525, "num_intersection": 5252, "num_union": 11554, "num_only_computed": 3151, "num_only_roped": 3151, "total_diff": 6302, "diff_percentage": 0.5454388090704518, "num_computed": 8403, "num_roped": 8403}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16294, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 1, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:16:35.290769", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 1.4066696166992188e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.16182572614107885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16294, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 1, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:17:56.114550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5124190064794817, "overlap_percentage": 0.6776151374509104, "num_intersection": 5694, "num_union": 11112, "num_only_computed": 2709, "num_only_roped": 2709, "total_diff": 5418, "diff_percentage": 0.48758099352051837, "num_computed": 8403, "num_roped": 8403}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:17:58.806078", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0184326171875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2708333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:19:19.740662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4765878942282351, "overlap_percentage": 0.6455259400285578, "num_intersection": 5425, "num_union": 11383, "num_only_computed": 2979, "num_only_roped": 2979, "total_diff": 5958, "diff_percentage": 0.5234121057717649, "num_computed": 8404, "num_roped": 8404}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:19:22.335467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.18094405594405594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:20:42.432507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4798379996478253, "overlap_percentage": 0.6485007139457402, "num_intersection": 5450, "num_union": 11358, "num_only_computed": 2954, "num_only_roped": 2954, "total_diff": 5908, "diff_percentage": 0.5201620003521746, "num_computed": 8404, "num_roped": 8404}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16297, 128], "mask_shape": [1, 32, 1, 16297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:20:45.000257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.0132789611816406e-05, "l2_diff": 0.0244140625, "l2_diff_relative": 0.09057971014492754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16297, 128], "attention_shape": [1, 32, 1, 16297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:21:30.565940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:21:30.578564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.03173828125, "l2_diff_relative": 0.0030591114457831324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:21:36.471111", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7448988601674666, "overlap_percentage": 0.853801761433869, "num_intersection": 1105161, "num_union": 1483639, "num_only_computed": 205559, "num_only_roped": 172919, "total_diff": 378478, "diff_percentage": 0.2551011398325334, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:21:37.041376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.59634780883789e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.015184859154929578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:21:51.644103", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6256164137818007, "overlap_percentage": 0.7696974618094308, "num_intersection": 1412401, "num_union": 2257615, "num_only_computed": 422607, "num_only_roped": 422607, "total_diff": 845214, "diff_percentage": 0.3743835862181993, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:21:52.174315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.539987564086914e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.01540948275862069}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:22:13.160099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5618033089659035, "overlap_percentage": 0.7194290161132812, "num_intersection": 1697346, "num_union": 3021246, "num_only_computed": 661950, "num_only_roped": 661950, "total_diff": 1323900, "diff_percentage": 0.43819669103409653, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:22:13.890031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 4.0531158447265625e-06, "l2_diff": 0.09619140625, "l2_diff_relative": 0.011485541044776119}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:22:39.985075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5390934904673456, "overlap_percentage": 0.7005337801846591, "num_intersection": 2020048, "num_union": 3747120, "num_only_computed": 863536, "num_only_roped": 863536, "total_diff": 1727072, "diff_percentage": 0.4609065095326544, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:22:40.897984", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.9637088775634766e-06, "l2_diff": 0.11767578125, "l2_diff_relative": 0.014050839552238806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:23:13.146794", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5187228166592502, "overlap_percentage": 0.683104001558744, "num_intersection": 2327931, "num_union": 4487813, "num_only_computed": 1079941, "num_only_roped": 1079941, "total_diff": 2159882, "diff_percentage": 0.4812771833407497, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:23:14.729349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.119140625, "l2_diff_relative": 0.01381340579710145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:23:52.806758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4927705883011713, "overlap_percentage": 0.6602094014485677, "num_intersection": 2596049, "num_union": 5268271, "num_only_computed": 1336111, "num_only_roped": 1336111, "total_diff": 2672222, "diff_percentage": 0.5072294116988287, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:23:56.349399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.606081008911133e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.01856694560669456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:24:40.556986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4860810619742883, "overlap_percentage": 0.6541783949908089, "num_intersection": 2915312, "num_union": 5997584, "num_only_computed": 1541136, "num_only_roped": 1541136, "total_diff": 3082272, "diff_percentage": 0.5139189380257116, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:24:42.126705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.019751082251082252}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:25:33.434156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.474897649677399, "overlap_percentage": 0.6439737018785978, "num_intersection": 3207463, "num_union": 6754009, "num_only_computed": 1773273, "num_only_roped": 1773273, "total_diff": 3546546, "diff_percentage": 0.525102350322601, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:25:35.168130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.062255859375, "mean_diff": 1.3589859008789062e-05, "l2_diff": 0.2890625, "l2_diff_relative": 0.038702928870292884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:26:34.012276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46410660564520345, "overlap_percentage": 0.633979252406529, "num_intersection": 3490071, "num_union": 7519977, "num_only_computed": 2014953, "num_only_roped": 2014953, "total_diff": 4029906, "diff_percentage": 0.5358933943547965, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:26:36.026459", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 1.4007091522216797e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.04190891472868217}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:43.171988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45456528082404857, "overlap_percentage": 0.6250187417735225, "num_intersection": 3768433, "num_union": 8290191, "num_only_computed": 2260879, "num_only_roped": 2260879, "total_diff": 4521758, "diff_percentage": 0.5454347191759514, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:45.445644", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 8.225440979003906e-06, "l2_diff": 0.310546875, "l2_diff_relative": 0.034746503496503496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:29:00.183995", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4535137746246339, "overlap_percentage": 0.6240240478515625, "num_intersection": 4089604, "num_union": 9017596, "num_only_computed": 2463996, "num_only_roped": 2463996, "total_diff": 4927992, "diff_percentage": 0.5464862253753661, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:29:02.760411", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 7.241964340209961e-06, "l2_diff": 0.306640625, "l2_diff_relative": 0.03607536764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:30:25.629298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45467639206594856, "overlap_percentage": 0.6251237657335069, "num_intersection": 4424556, "num_union": 9731220, "num_only_computed": 2653332, "num_only_roped": 2653332, "total_diff": 5306664, "diff_percentage": 0.5453236079340514, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:30:28.455462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.06000996015936255}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:31:59.543660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.450391307545571, "overlap_percentage": 0.6210617854677397, "num_intersection": 4721421, "num_union": 10482931, "num_only_computed": 2880755, "num_only_roped": 2880755, "total_diff": 5761510, "diff_percentage": 0.549608692454429, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:32:02.595577", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 1.1444091796875e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.06204379562043796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:33:41.543020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4436751461602095, "overlap_percentage": 0.6146467885663432, "num_intersection": 4994905, "num_union": 11258023, "num_only_computed": 3131559, "num_only_roped": 3131559, "total_diff": 6263118, "diff_percentage": 0.5563248538397905, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:33:44.852607", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 1.1563301086425781e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.06682692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:35:28.704557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43946444385684363, "overlap_percentage": 0.6105943717225277, "num_intersection": 2617637, "num_union": 5956425, "num_only_computed": 1669394, "num_only_roped": 1669394, "total_diff": 3338788, "diff_percentage": 0.5605355561431563, "num_computed": 4287031, "num_roped": 4287031}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 523, "seq_len_k": 15883, "queries_shape": [1, 32, 523, 128], "keys_shape": [1, 8, 15883, 128], "mask_shape": [1, 32, 523, 15883], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:35:32.004412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 1.4126300811767578e-05, "l2_diff": 0.53125, "l2_diff_relative": 0.08673469387755102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 523, "seq_len_k": 15883, "queries_shape": [1, 32, 523, 128], "keys_shape": [1, 8, 15883, 128], "attention_shape": [1, 32, 523, 15883]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:37:11.179840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4470834279593656, "overlap_percentage": 0.6179096786283145, "num_intersection": 131899, "num_union": 295021, "num_only_computed": 81561, "num_only_roped": 81561, "total_diff": 163122, "diff_percentage": 0.5529165720406344, "num_computed": 213460, "num_roped": 213460}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15909, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15909, 128], "mask_shape": [1, 32, 26, 15909], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:37:14.309800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.1572265625, "l2_diff_relative": 0.11434659090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15909, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15909, 128], "attention_shape": [1, 32, 26, 15909]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:38:41.142730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46025253423439444, "overlap_percentage": 0.6303738886859092, "num_intersection": 5176, "num_union": 11246, "num_only_computed": 3035, "num_only_roped": 3035, "total_diff": 6070, "diff_percentage": 0.5397474657656055, "num_computed": 8211, "num_roped": 8211}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15910, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15910, 128], "mask_shape": [1, 32, 1, 15910], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:38:43.584605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 1.5854835510253906e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.1488970588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15910, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15910, 128], "attention_shape": [1, 32, 1, 15910]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:39:59.209915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4475099162626708, "overlap_percentage": 0.6183168919741809, "num_intersection": 5077, "num_union": 11345, "num_only_computed": 3134, "num_only_roped": 3134, "total_diff": 6268, "diff_percentage": 0.5524900837373292, "num_computed": 8211, "num_roped": 8211}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15911, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15911, 128], "mask_shape": [1, 32, 1, 15911], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:40:01.648263", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.1920928955078125e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.11299435028248588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15911, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15911, 128], "attention_shape": [1, 32, 1, 15911]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:41:17.642671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4428533778441536, "overlap_percentage": 0.6138577691183633, "num_intersection": 5041, "num_union": 11383, "num_only_computed": 3171, "num_only_roped": 3171, "total_diff": 6342, "diff_percentage": 0.5571466221558464, "num_computed": 8212, "num_roped": 8212}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15912, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15912, 128], "mask_shape": [1, 32, 1, 15912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:41:20.065298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.151}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15912, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15912, 128], "attention_shape": [1, 32, 1, 15912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:42:35.575913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45757898473553427, "overlap_percentage": 0.6278616658548466, "num_intersection": 5156, "num_union": 11268, "num_only_computed": 3056, "num_only_roped": 3056, "total_diff": 6112, "diff_percentage": 0.5424210152644657, "num_computed": 8212, "num_roped": 8212}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15913, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15913, 128], "mask_shape": [1, 32, 1, 15913], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:42:39.567295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 1.4662742614746094e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.1318181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15913, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15913, 128], "attention_shape": [1, 32, 1, 15913]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:43:55.615604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4628194852613768, "overlap_percentage": 0.6327773042737124, "num_intersection": 5197, "num_union": 11229, "num_only_computed": 3016, "num_only_roped": 3016, "total_diff": 6032, "diff_percentage": 0.5371805147386232, "num_computed": 8213, "num_roped": 8213}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15914, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15914, 128], "mask_shape": [1, 32, 1, 15914], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:43:58.915430", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.11146496815286625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15914, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15914, 128], "attention_shape": [1, 32, 1, 15914]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:45:18.604037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44913983237759153, "overlap_percentage": 0.6198709363204675, "num_intersection": 5091, "num_union": 11335, "num_only_computed": 3122, "num_only_roped": 3122, "total_diff": 6244, "diff_percentage": 0.5508601676224084, "num_computed": 8213, "num_roped": 8213}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15915, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15915, 128], "mask_shape": [1, 32, 1, 15915], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:45:22.132271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.2159347534179688e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.1172945205479452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15915, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15915, 128], "attention_shape": [1, 32, 1, 15915]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:46:41.346356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4502118644067797, "overlap_percentage": 0.620891161431702, "num_intersection": 5100, "num_union": 11328, "num_only_computed": 3114, "num_only_roped": 3114, "total_diff": 6228, "diff_percentage": 0.5497881355932204, "num_computed": 8214, "num_roped": 8214}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15916, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15916, 128], "mask_shape": [1, 32, 1, 15916], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:46:45.395929", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0123291015625, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.025634765625, "l2_diff_relative": 0.09442446043165467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15916, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15916, 128], "attention_shape": [1, 32, 1, 15916]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:47:31.206766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:47:31.219378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.030517578125, "l2_diff_relative": 0.0028892381656804734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:47:37.220978", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7458955807692516, "overlap_percentage": 0.8544561186650186, "num_intersection": 1106008, "num_union": 1482792, "num_only_computed": 204712, "num_only_roped": 172072, "total_diff": 376784, "diff_percentage": 0.2541044192307485, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:47:37.615924", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.0967254638671875e-05, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01674910071942446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:47:52.521656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.624540637684752, "overlap_percentage": 0.7688827514648438, "num_intersection": 1410906, "num_union": 2259110, "num_only_computed": 424102, "num_only_roped": 424102, "total_diff": 848204, "diff_percentage": 0.375459362315248, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:47:55.095254", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.018700787401574805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:48:15.579821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5622490385328488, "overlap_percentage": 0.7197943793402778, "num_intersection": 1698208, "num_union": 3020384, "num_only_computed": 661088, "num_only_roped": 661088, "total_diff": 1322176, "diff_percentage": 0.4377509614671512, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:48:16.318246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 7.867813110351562e-06, "l2_diff": 0.1572265625, "l2_diff_relative": 0.020369433198380568}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:48:42.805773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5395170803469965, "overlap_percentage": 0.7008913213556464, "num_intersection": 2021079, "num_union": 3746089, "num_only_computed": 862505, "num_only_roped": 862505, "total_diff": 1725010, "diff_percentage": 0.4604829196530034, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:48:43.732887", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.735324859619141e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.02075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:49:16.320437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5189238590761895, "overlap_percentage": 0.6832783038799579, "num_intersection": 2328525, "num_union": 4487219, "num_only_computed": 1079347, "num_only_roped": 1079347, "total_diff": 2158694, "diff_percentage": 0.4810761409238105, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:49:19.471434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.4373016357421875e-06, "l2_diff": 0.1875, "l2_diff_relative": 0.024691358024691357}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:49:58.320405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49991760706504157, "overlap_percentage": 0.6665934244791667, "num_intersection": 2621152, "num_union": 5243168, "num_only_computed": 1311008, "num_only_roped": 1311008, "total_diff": 2622016, "diff_percentage": 0.5000823929349584, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:50:00.913921", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.27501106262207e-06, "l2_diff": 0.197265625, "l2_diff_relative": 0.023910984848484848}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:50:45.742000", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4881740293988345, "overlap_percentage": 0.6560711580164292, "num_intersection": 2923747, "num_union": 5989149, "num_only_computed": 1532701, "num_only_roped": 1532701, "total_diff": 3065402, "diff_percentage": 0.5118259706011655, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:50:47.280682", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.993511199951172e-06, "l2_diff": 0.1943359375, "l2_diff_relative": 0.02189700704225352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:51:39.294536", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47039394830410103, "overlap_percentage": 0.6398202996504935, "num_intersection": 3186776, "num_union": 6774696, "num_only_computed": 1793960, "num_only_roped": 1793960, "total_diff": 3587920, "diff_percentage": 0.529606051695899, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:51:41.071393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0235595703125, "mean_diff": 1.0609626770019531e-05, "l2_diff": 0.2333984375, "l2_diff_relative": 0.03219288793103448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:52:40.649440", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4704182780876045, "overlap_percentage": 0.6398428054082961, "num_intersection": 3522350, "num_union": 7487698, "num_only_computed": 1982674, "num_only_roped": 1982674, "total_diff": 3965348, "diff_percentage": 0.5295817219123955, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:52:42.695928", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.034423828125, "mean_diff": 1.3768672943115234e-05, "l2_diff": 0.302734375, "l2_diff_relative": 0.03859561752988048}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:53:51.642189", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4645970981393243, "overlap_percentage": 0.634436731753142, "num_intersection": 3825217, "num_union": 8233407, "num_only_computed": 2204095, "num_only_roped": 2204095, "total_diff": 4408190, "diff_percentage": 0.5354029018606756, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:53:55.065197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.024658203125, "mean_diff": 8.106231689453125e-06, "l2_diff": 0.2255859375, "l2_diff_relative": 0.027764423076923075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:55:10.641652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4650801075962915, "overlap_percentage": 0.6348869323730468, "num_intersection": 4160795, "num_union": 8946405, "num_only_computed": 2392805, "num_only_roped": 2392805, "total_diff": 4785610, "diff_percentage": 0.5349198924037085, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:55:13.227020", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 8.761882781982422e-06, "l2_diff": 0.341796875, "l2_diff_relative": 0.04021139705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:56:41.385850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4564178878437596, "overlap_percentage": 0.6267677589699074, "num_intersection": 4436192, "num_union": 9719584, "num_only_computed": 2641696, "num_only_roped": 2641696, "total_diff": 5283392, "diff_percentage": 0.5435821121562404, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:56:44.234714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.06005859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:58:16.796230", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4519277322662937, "overlap_percentage": 0.6225209729424839, "num_intersection": 4732514, "num_union": 10471838, "num_only_computed": 2869662, "num_only_roped": 2869662, "total_diff": 5739324, "diff_percentage": 0.5480722677337063, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:58:21.530737", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 8.344650268554688e-06, "l2_diff": 0.3515625, "l2_diff_relative": 0.04573170731707317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:00:01.065672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4494343765299925, "overlap_percentage": 0.6201513967206401, "num_intersection": 5039638, "num_union": 11213290, "num_only_computed": 3086826, "num_only_roped": 3086826, "total_diff": 6173652, "diff_percentage": 0.5505656234700075, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:00:04.394601", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 7.241964340209961e-06, "l2_diff": 0.3671875, "l2_diff_relative": 0.042572463768115944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:01:46.391637", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4457093246556749, "overlap_percentage": 0.6165960432769978, "num_intersection": 566772, "num_union": 1271618, "num_only_computed": 352423, "num_only_roped": 352423, "total_diff": 704846, "diff_percentage": 0.5542906753443251, "num_computed": 919195, "num_roped": 919195}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 115, "seq_len_k": 15475, "queries_shape": [1, 32, 115, 128], "keys_shape": [1, 8, 15475, 128], "mask_shape": [1, 32, 115, 15475], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:01:49.554771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.3359375, "l2_diff_relative": 0.11139896373056994}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 115, "seq_len_k": 15475, "queries_shape": [1, 32, 115, 128], "keys_shape": [1, 8, 15475, 128], "attention_shape": [1, 32, 115, 15475]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:03:25.537032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.441403068604784, "overlap_percentage": 0.6124630621635115, "num_intersection": 181561, "num_union": 411327, "num_only_computed": 114883, "num_only_roped": 114883, "total_diff": 229766, "diff_percentage": 0.5585969313952159, "num_computed": 296444, "num_roped": 296444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15512, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15512, 128], "mask_shape": [1, 32, 37, 15512], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:03:28.632039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.189453125, "l2_diff_relative": 0.11714975845410629}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15512, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15512, 128], "attention_shape": [1, 32, 37, 15512]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:04:54.134865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4678025098470276, "overlap_percentage": 0.6374188716924613, "num_intersection": 5107, "num_union": 10917, "num_only_computed": 2905, "num_only_roped": 2905, "total_diff": 5810, "diff_percentage": 0.5321974901529725, "num_computed": 8012, "num_roped": 8012}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15513, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15513, 128], "mask_shape": [1, 32, 1, 15513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:04:56.647974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.050048828125, "l2_diff_relative": 0.24061032863849766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15513, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15513, 128], "attention_shape": [1, 32, 1, 15513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:06:11.123056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45850018201674553, "overlap_percentage": 0.6287283164857107, "num_intersection": 5038, "num_union": 10988, "num_only_computed": 2975, "num_only_roped": 2975, "total_diff": 5950, "diff_percentage": 0.5414998179832544, "num_computed": 8013, "num_roped": 8013}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15514, 128], "mask_shape": [1, 32, 1, 15514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:06:13.502750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.17732558139534885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15514, 128], "attention_shape": [1, 32, 1, 15514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:07:27.232505", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4324276010010726, "overlap_percentage": 0.6037688755771871, "num_intersection": 4838, "num_union": 11188, "num_only_computed": 3175, "num_only_roped": 3175, "total_diff": 6350, "diff_percentage": 0.5675723989989274, "num_computed": 8013, "num_roped": 8013}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15515, 128], "mask_shape": [1, 32, 1, 15515], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:07:29.634125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.16884328358208955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15515, 128], "attention_shape": [1, 32, 1, 15515]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:11.103129", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:11.112540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.0031403186274509805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:16.899813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7505553320327688, "overlap_percentage": 0.8575054079110013, "num_intersection": 1109955, "num_union": 1478845, "num_only_computed": 200765, "num_only_roped": 168125, "total_diff": 368890, "diff_percentage": 0.2494446679672312, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:17.283126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.150369644165039e-05, "l2_diff": 0.1435546875, "l2_diff_relative": 0.016289893617021278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:31.785913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6363852007216115, "overlap_percentage": 0.7777938842773438, "num_intersection": 1427258, "num_union": 2242758, "num_only_computed": 407750, "num_only_roped": 407750, "total_diff": 815500, "diff_percentage": 0.36361479927838847, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:32.333010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 9.238719940185547e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.018353174603174604}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:53.196413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5713858497107055, "overlap_percentage": 0.7272381252712674, "num_intersection": 1715770, "num_union": 3002822, "num_only_computed": 643526, "num_only_roped": 643526, "total_diff": 1287052, "diff_percentage": 0.42861415028929456, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:56.169733", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.4373016357421875e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.016309306569343065}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:23.039651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.540029314980628, "overlap_percentage": 0.7013234225186434, "num_intersection": 2022325, "num_union": 3744843, "num_only_computed": 861259, "num_only_roped": 861259, "total_diff": 1722518, "diff_percentage": 0.459970685019372, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:25.467298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.241964340209961e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.02305327868852459}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:57.366413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5286677460746236, "overlap_percentage": 0.6916712247408353, "num_intersection": 2357127, "num_union": 4458617, "num_only_computed": 1050745, "num_only_roped": 1050745, "total_diff": 2101490, "diff_percentage": 0.4713322539253764, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:58.469958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.632638931274414e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.021460843373493976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:10:36.847602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5055730162671463, "overlap_percentage": 0.6716021219889323, "num_intersection": 2640847, "num_union": 5223473, "num_only_computed": 1291313, "num_only_roped": 1291313, "total_diff": 2582626, "diff_percentage": 0.4944269837328536, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:10:38.166309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.231929779052734e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.0203125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:11:24.237299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49289288933837927, "overlap_percentage": 0.6603191600126379, "num_intersection": 2942678, "num_union": 5970218, "num_only_computed": 1513770, "num_only_roped": 1513770, "total_diff": 3027540, "diff_percentage": 0.5071071106616207, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:11:25.762276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.019010416666666665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:12:20.251228", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48483906708051183, "overlap_percentage": 0.6530526813707853, "num_intersection": 3252683, "num_union": 6708789, "num_only_computed": 1728053, "num_only_roped": 1728053, "total_diff": 3456106, "diff_percentage": 0.5151609329194882, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:12:23.924520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 1.3053417205810547e-05, "l2_diff": 0.298828125, "l2_diff_relative": 0.040348101265822785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:13:23.616820", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4720514009763629, "overlap_percentage": 0.641351790655227, "num_intersection": 3530657, "num_union": 7479391, "num_only_computed": 1974367, "num_only_roped": 1974367, "total_diff": 3948734, "diff_percentage": 0.5279485990236371, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:13:25.650693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 1.2695789337158203e-05, "l2_diff": 0.306640625, "l2_diff_relative": 0.03774038461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:14:25.770263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49862306853641114, "overlap_percentage": 0.6654416030354819, "num_intersection": 212206, "num_union": 425584, "num_only_computed": 106689, "num_only_roped": 106689, "total_diff": 213378, "diff_percentage": 0.5013769314635889, "num_computed": 318895, "num_roped": 318895}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 59, "seq_len_k": 10299, "queries_shape": [1, 32, 59, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 59, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:14:30.101027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0289306640625, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.15234375, "l2_diff_relative": 0.07330827067669173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 59, "seq_len_k": 10299, "queries_shape": [1, 32, 59, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 59, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:15:27.548974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4570391286809197, "overlap_percentage": 0.6273532668881506, "num_intersection": 84975, "num_union": 185925, "num_only_computed": 50475, "num_only_roped": 50475, "total_diff": 100950, "diff_percentage": 0.5429608713190803, "num_computed": 135450, "num_roped": 135450}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10324, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10324, 128], "mask_shape": [1, 32, 25, 10324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:15:29.427109", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.068359375, "l2_diff_relative": 0.0587248322147651}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10324, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10324, 128], "attention_shape": [1, 32, 25, 10324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:16:22.102184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4457638425617078, "overlap_percentage": 0.6166482096714655, "num_intersection": 3341, "num_union": 7495, "num_only_computed": 2077, "num_only_roped": 2077, "total_diff": 4154, "diff_percentage": 0.5542361574382922, "num_computed": 5418, "num_roped": 5418}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10325, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10325, 128], "mask_shape": [1, 32, 1, 10325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:16:23.629215", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.0191650390625, "l2_diff_relative": 0.11822289156626506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10325, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10325, 128], "attention_shape": [1, 32, 1, 10325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:10.992438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4649905379832387, "overlap_percentage": 0.6348034692747739, "num_intersection": 3440, "num_union": 7398, "num_only_computed": 1979, "num_only_roped": 1979, "total_diff": 3958, "diff_percentage": 0.5350094620167613, "num_computed": 5419, "num_roped": 5419}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10326, 128], "mask_shape": [1, 32, 1, 10326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:12.966235", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0157470703125, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.0972682119205298}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10326, 128], "attention_shape": [1, 32, 1, 10326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:43.247473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:43.261134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.03125, "l2_diff_relative": 0.003125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:49.280113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7482406505119182, "overlap_percentage": 0.8559927379480841, "num_intersection": 1107997, "num_union": 1480803, "num_only_computed": 202723, "num_only_roped": 170083, "total_diff": 372806, "diff_percentage": 0.2517593494880818, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:49.674124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.1259765625, "l2_diff_relative": 0.017009493670886076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:04.997626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6216141220323376, "overlap_percentage": 0.7666609627859933, "num_intersection": 1406829, "num_union": 2263187, "num_only_computed": 428179, "num_only_roped": 428179, "total_diff": 856358, "diff_percentage": 0.37838587796766243, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:05.567499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.017444779116465862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:26.156373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.559225454945591, "overlap_percentage": 0.7173118591308594, "num_intersection": 1692351, "num_union": 3026241, "num_only_computed": 666945, "num_only_roped": 666945, "total_diff": 1333890, "diff_percentage": 0.4407745450544091, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:26.900347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 8.285045623779297e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.020370370370370372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:53.455912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5213819559912133, "overlap_percentage": 0.6854057312011719, "num_intersection": 1976425, "num_union": 3790743, "num_only_computed": 907159, "num_only_roped": 907159, "total_diff": 1814318, "diff_percentage": 0.47861804400878666, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:54.397022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.063150405883789e-06, "l2_diff": 0.1748046875, "l2_diff_relative": 0.022464859437751002}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:19:27.064115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5067522323032311, "overlap_percentage": 0.6726417541503906, "num_intersection": 2292277, "num_union": 4523467, "num_only_computed": 1115595, "num_only_roped": 1115595, "total_diff": 2231190, "diff_percentage": 0.49324776769676887, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:19:28.193451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.407499313354492e-06, "l2_diff": 0.1953125, "l2_diff_relative": 0.025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:20:06.974723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.493575172260287, "overlap_percentage": 0.660931142171224, "num_intersection": 2598887, "num_union": 5265433, "num_only_computed": 1333273, "num_only_roped": 1333273, "total_diff": 2666546, "diff_percentage": 0.506424827739713, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:20:08.299698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.02415966386554622}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:20:53.540439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48411629026875924, "overlap_percentage": 0.6523967069738051, "num_intersection": 2907372, "num_union": 6005524, "num_only_computed": 1549076, "num_only_roped": 1549076, "total_diff": 3098152, "diff_percentage": 0.5158837097312408, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:20:57.348160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.0531158447265625e-06, "l2_diff": 0.173828125, "l2_diff_relative": 0.023569915254237288}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:21:50.122334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47128848841095816, "overlap_percentage": 0.6406472858629728, "num_intersection": 3190895, "num_union": 6770577, "num_only_computed": 1789841, "num_only_roped": 1789841, "total_diff": 3579682, "diff_percentage": 0.5287115115890418, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:21:53.512605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020751953125, "mean_diff": 1.239776611328125e-05, "l2_diff": 0.25, "l2_diff_relative": 0.03404255319148936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:22:52.611333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.458045036311917, "overlap_percentage": 0.6283002580915179, "num_intersection": 3458808, "num_union": 7551240, "num_only_computed": 2046216, "num_only_roped": 2046216, "total_diff": 4092432, "diff_percentage": 0.541954963688083, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:22:54.613674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048583984375, "mean_diff": 1.239776611328125e-05, "l2_diff": 0.296875, "l2_diff_relative": 0.0405982905982906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:24:01.240313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45251376190992426, "overlap_percentage": 0.6230767291525136, "num_intersection": 3756724, "num_union": 8301900, "num_only_computed": 2272588, "num_only_roped": 2272588, "total_diff": 4545176, "diff_percentage": 0.5474862380900758, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:24:03.529199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 1.2934207916259766e-05, "l2_diff": 0.33203125, "l2_diff_relative": 0.03994360902255639}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:17.716936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4432392370096962, "overlap_percentage": 0.6142283630371094, "num_intersection": 4025407, "num_union": 9081793, "num_only_computed": 2528193, "num_only_roped": 2528193, "total_diff": 5056386, "diff_percentage": 0.5567607629903037, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:20.540134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 1.0907649993896484e-05, "l2_diff": 0.28515625, "l2_diff_relative": 0.03564453125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:43.595611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44553014094448246, "overlap_percentage": 0.616424560546875, "num_intersection": 4362984, "num_union": 9792792, "num_only_computed": 2714904, "num_only_roped": 2714904, "total_diff": 5429808, "diff_percentage": 0.5544698590555176, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:46.428189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 9.775161743164062e-06, "l2_diff": 0.29296875, "l2_diff_relative": 0.03524436090225564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:28:16.795088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45079597752177075, "overlap_percentage": 0.6214464121851427, "num_intersection": 4724345, "num_union": 10480007, "num_only_computed": 2877831, "num_only_roped": 2877831, "total_diff": 5755662, "diff_percentage": 0.5492040224782293, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:28:20.155640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 1.0609626770019531e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.0597718253968254}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:29:59.072949", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44789497071413886, "overlap_percentage": 0.618684337985131, "num_intersection": 5027716, "num_union": 11225212, "num_only_computed": 3098748, "num_only_roped": 3098748, "total_diff": 6197496, "diff_percentage": 0.5521050292858611, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:30:02.372940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 1.0192394256591797e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.0765625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:31:48.786847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4453262464284301, "overlap_percentage": 0.6162293773172435, "num_intersection": 4422783, "num_union": 9931557, "num_only_computed": 2754387, "num_only_roped": 2754387, "total_diff": 5508774, "diff_percentage": 0.5546737535715699, "num_computed": 7177170, "num_roped": 7177170}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 858, "seq_len_k": 16218, "queries_shape": [1, 32, 858, 128], "keys_shape": [1, 8, 16218, 128], "mask_shape": [1, 32, 858, 16218], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:31:52.328178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.09085648148148148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 858, "seq_len_k": 16218, "queries_shape": [1, 32, 858, 128], "keys_shape": [1, 8, 16218, 128], "attention_shape": [1, 32, 858, 16218]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:33:38.144641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44080327361507515, "overlap_percentage": 0.6118854415274463, "num_intersection": 153828, "num_union": 348972, "num_only_computed": 97572, "num_only_roped": 97572, "total_diff": 195144, "diff_percentage": 0.5591967263849249, "num_computed": 251400, "num_roped": 251400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16248, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16248, 128], "mask_shape": [1, 32, 30, 16248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:33:42.025269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03466796875, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.1708984375, "l2_diff_relative": 0.13338414634146342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16248, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16248, 128], "attention_shape": [1, 32, 30, 16248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:35:11.301401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.453095196809433, "overlap_percentage": 0.6236276849642005, "num_intersection": 5226, "num_union": 11534, "num_only_computed": 3154, "num_only_roped": 3154, "total_diff": 6308, "diff_percentage": 0.546904803190567, "num_computed": 8380, "num_roped": 8380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16249, 128], "mask_shape": [1, 32, 1, 16249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:35:14.344867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.14444444444444443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16249, 128], "attention_shape": [1, 32, 1, 16249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:36:35.247152", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4922104513487047, "overlap_percentage": 0.6597064789404605, "num_intersection": 5529, "num_union": 11233, "num_only_computed": 2852, "num_only_roped": 2852, "total_diff": 5704, "diff_percentage": 0.5077895486512953, "num_computed": 8381, "num_roped": 8381}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16250, 128], "mask_shape": [1, 32, 1, 16250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:36:38.507718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.027099609375, "l2_diff_relative": 0.12967289719626168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16250, 128], "attention_shape": [1, 32, 1, 16250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:37:59.231944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4387982832618026, "overlap_percentage": 0.6099510798234101, "num_intersection": 5112, "num_union": 11650, "num_only_computed": 3269, "num_only_roped": 3269, "total_diff": 6538, "diff_percentage": 0.5612017167381974, "num_computed": 8381, "num_roped": 8381}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16251, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16251, 128], "mask_shape": [1, 32, 1, 16251], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:38:04.225212", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2113526570048309}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16251, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16251, 128], "attention_shape": [1, 32, 1, 16251]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:39:25.158509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4733696607488135, "overlap_percentage": 0.6425674063469339, "num_intersection": 5386, "num_union": 11378, "num_only_computed": 2996, "num_only_roped": 2996, "total_diff": 5992, "diff_percentage": 0.5266303392511865, "num_computed": 8382, "num_roped": 8382}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16252, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16252, 128], "mask_shape": [1, 32, 1, 16252], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:39:27.829438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0211181640625, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.22735507246376813}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16252, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16252, 128], "attention_shape": [1, 32, 1, 16252]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:40:48.734372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4434303426898571, "overlap_percentage": 0.6144118348842759, "num_intersection": 5150, "num_union": 11614, "num_only_computed": 3232, "num_only_roped": 3232, "total_diff": 6464, "diff_percentage": 0.556569657310143, "num_computed": 8382, "num_roped": 8382}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16253, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16253, 128], "mask_shape": [1, 32, 1, 16253], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:40:51.307433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.23295454545454544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16253, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16253, 128], "attention_shape": [1, 32, 1, 16253]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:42:12.383484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47328646748681896, "overlap_percentage": 0.6424907550996063, "num_intersection": 5386, "num_union": 11380, "num_only_computed": 2997, "num_only_roped": 2997, "total_diff": 5994, "diff_percentage": 0.526713532513181, "num_computed": 8383, "num_roped": 8383}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16254, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 1, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:42:14.939596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.25886524822695034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16254, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 1, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:43:35.026790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44310552590807367, "overlap_percentage": 0.6140999642132888, "num_intersection": 5148, "num_union": 11618, "num_only_computed": 3235, "num_only_roped": 3235, "total_diff": 6470, "diff_percentage": 0.5568944740919263, "num_computed": 8383, "num_roped": 8383}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16255, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16255, 128], "mask_shape": [1, 32, 1, 16255], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:43:37.560249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.052978515625, "l2_diff_relative": 0.13630653266331658}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16255, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16255, 128], "attention_shape": [1, 32, 1, 16255]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:21.818565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:21.831160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003106648489932886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:27.682035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.750596763613987, "overlap_percentage": 0.8575324474660074, "num_intersection": 1109990, "num_union": 1478810, "num_only_computed": 200730, "num_only_roped": 168090, "total_diff": 368820, "diff_percentage": 0.24940323638601308, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:30.411388", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.08349609375, "l2_diff_relative": 0.010120738636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:44.949193", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6286788232735858, "overlap_percentage": 0.7720108032226562, "num_intersection": 1416646, "num_union": 2253370, "num_only_computed": 418362, "num_only_roped": 418362, "total_diff": 836724, "diff_percentage": 0.37132117672641424, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:45.489758", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.735324859619141e-06, "l2_diff": 0.10986328125, "l2_diff_relative": 0.015219155844155844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:45:05.840860", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5677510412707357, "overlap_percentage": 0.7242872450086806, "num_intersection": 1708808, "num_union": 3009784, "num_only_computed": 650488, "num_only_roped": 650488, "total_diff": 1300976, "diff_percentage": 0.4322489587292643, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:45:06.564971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.410743713378906e-06, "l2_diff": 0.1083984375, "l2_diff_relative": 0.012752757352941176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:45:32.520730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5281484319645317, "overlap_percentage": 0.6912266124378551, "num_intersection": 1993210, "num_union": 3773958, "num_only_computed": 890374, "num_only_roped": 890374, "total_diff": 1780748, "diff_percentage": 0.47185156803546835, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:45:33.427889", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.01844454887218045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:46:05.298311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5015827135253269, "overlap_percentage": 0.6680720402644231, "num_intersection": 2276704, "num_union": 4539040, "num_only_computed": 1131168, "num_only_roped": 1131168, "total_diff": 2262336, "diff_percentage": 0.49841728647467304, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:46:08.212378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.019822761194029852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:46:46.353011", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49364155087015704, "overlap_percentage": 0.6609906514485677, "num_intersection": 2599121, "num_union": 5265199, "num_only_computed": 1333039, "num_only_roped": 1333039, "total_diff": 2666078, "diff_percentage": 0.506358449129843, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:46:49.742978", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.112720489501953e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.020432692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:47:33.801948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48424060465400537, "overlap_percentage": 0.6525095771340763, "num_intersection": 2907875, "num_union": 6005021, "num_only_computed": 1548573, "num_only_roped": 1548573, "total_diff": 3097146, "diff_percentage": 0.5157593953459946, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:47:35.313805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.082918167114258e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.022286821705426358}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:48:26.284933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48591882294432776, "overlap_percentage": 0.6540314523797286, "num_intersection": 3257558, "num_union": 6703914, "num_only_computed": 1723178, "num_only_roped": 1723178, "total_diff": 3446356, "diff_percentage": 0.5140811770556722, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:48:28.067730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.150369644165039e-05, "l2_diff": 0.2236328125, "l2_diff_relative": 0.02932889344262295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:49:26.677487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4715042637351828, "overlap_percentage": 0.6408466157459077, "num_intersection": 3527876, "num_union": 7482172, "num_only_computed": 1977148, "num_only_roped": 1977148, "total_diff": 3954296, "diff_percentage": 0.5284957362648173, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:49:28.672623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 1.2934207916259766e-05, "l2_diff": 0.322265625, "l2_diff_relative": 0.036830357142857144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:50:35.524512", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4652954505161503, "overlap_percentage": 0.6350875522779382, "num_intersection": 3829141, "num_union": 8229483, "num_only_computed": 2200171, "num_only_roped": 2200171, "total_diff": 4400342, "diff_percentage": 0.5347045494838497, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:50:37.814640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.0967254638671875e-05, "l2_diff": 0.341796875, "l2_diff_relative": 0.04239341085271318}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:51:52.182176", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45318448191924027, "overlap_percentage": 0.6237122506575538, "num_intersection": 3898476, "num_union": 8602404, "num_only_computed": 2351964, "num_only_roped": 2351964, "total_diff": 4703928, "diff_percentage": 0.5468155180807598, "num_computed": 6250440, "num_roped": 6250440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 980, "seq_len_k": 12244, "queries_shape": [1, 32, 980, 128], "keys_shape": [1, 8, 12244, 128], "mask_shape": [1, 32, 980, 12244], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:51:55.301870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 8.225440979003906e-06, "l2_diff": 0.26953125, "l2_diff_relative": 0.0359375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 980, "seq_len_k": 12244, "queries_shape": [1, 32, 980, 128], "keys_shape": [1, 8, 12244, 128], "attention_shape": [1, 32, 980, 12244]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:53:09.599330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4703850214220283, "overlap_percentage": 0.6398120418380118, "num_intersection": 114511, "num_union": 243441, "num_only_computed": 64465, "num_only_roped": 64465, "total_diff": 128930, "diff_percentage": 0.5296149785779717, "num_computed": 178976, "num_roped": 178976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12272, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12272, 128], "mask_shape": [1, 32, 28, 12272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:53:11.933504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.10546875, "l2_diff_relative": 0.07627118644067797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12272, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12272, 128], "attention_shape": [1, 32, 28, 12272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:17.192305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48254667749043256, "overlap_percentage": 0.6509699624530664, "num_intersection": 4161, "num_union": 8623, "num_only_computed": 2231, "num_only_roped": 2231, "total_diff": 4462, "diff_percentage": 0.5174533225095674, "num_computed": 6392, "num_roped": 6392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12273, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12273, 128], "mask_shape": [1, 32, 1, 12273], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:19.055116", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0120849609375, "mean_diff": 1.4960765838623047e-05, "l2_diff": 0.01953125, "l2_diff_relative": 0.09615384615384616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12273, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12273, 128], "attention_shape": [1, 32, 1, 12273]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:55:16.462693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4822629260375609, "overlap_percentage": 0.6507117159393087, "num_intersection": 4160, "num_union": 8626, "num_only_computed": 2233, "num_only_roped": 2233, "total_diff": 4466, "diff_percentage": 0.5177370739624392, "num_computed": 6393, "num_roped": 6393}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12274, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12274, 128], "mask_shape": [1, 32, 1, 12274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:55:18.799309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.4066696166992188e-05, "l2_diff": 0.01904296875, "l2_diff_relative": 0.08783783783783784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12274, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12274, 128], "attention_shape": [1, 32, 1, 12274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:17.840520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.483983286908078, "overlap_percentage": 0.652275926794932, "num_intersection": 4170, "num_union": 8616, "num_only_computed": 2223, "num_only_roped": 2223, "total_diff": 4446, "diff_percentage": 0.516016713091922, "num_computed": 6393, "num_roped": 6393}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12275, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12275, 128], "mask_shape": [1, 32, 1, 12275], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:19.684868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014892578125, "mean_diff": 8.404254913330078e-06, "l2_diff": 0.0194091796875, "l2_diff_relative": 0.04824029126213592}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12275, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12275, 128], "attention_shape": [1, 32, 1, 12275]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:50.968659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:50.977016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0302734375, "l2_diff_relative": 0.003125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:57.043539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.753931915896905, "overlap_percentage": 0.8597048825710754, "num_intersection": 1112802, "num_union": 1475998, "num_only_computed": 197918, "num_only_roped": 165278, "total_diff": 363196, "diff_percentage": 0.246068084103095, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:59.128570", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.450580596923828e-06, "l2_diff": 0.10107421875, "l2_diff_relative": 0.012536337209302325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:57:13.958914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6266034938581582, "overlap_percentage": 0.7704440525599888, "num_intersection": 1413771, "num_union": 2256245, "num_only_computed": 421237, "num_only_roped": 421237, "total_diff": 842474, "diff_percentage": 0.3733965061418419, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:57:14.512123", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 5.9604644775390625e-06, "l2_diff": 0.10791015625, "l2_diff_relative": 0.011665962837837838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:57:35.829138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5645307875154303, "overlap_percentage": 0.7216614617241753, "num_intersection": 1702613, "num_union": 3015979, "num_only_computed": 656683, "num_only_roped": 656683, "total_diff": 1313366, "diff_percentage": 0.4354692124845697, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:57:36.568625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.018280632411067192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:58:03.163518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5305529761050141, "overlap_percentage": 0.693282734264027, "num_intersection": 1999139, "num_union": 3768029, "num_only_computed": 884445, "num_only_roped": 884445, "total_diff": 1768890, "diff_percentage": 0.46944702389498594, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:58:04.073586", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.9604644775390625e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.019339139344262294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:58:39.153727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5084215621203768, "overlap_percentage": 0.6741107060359075, "num_intersection": 2297283, "num_union": 4518461, "num_only_computed": 1110589, "num_only_roped": 1110589, "total_diff": 2221178, "diff_percentage": 0.4915784378796232, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:58:40.279353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.155801773071289e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.02075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:14.287751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5022797429858459, "overlap_percentage": 0.6686900297111685, "num_intersection": 109831, "num_union": 218665, "num_only_computed": 54417, "num_only_roped": 54417, "total_diff": 108834, "diff_percentage": 0.49772025701415407, "num_computed": 164248, "num_roped": 164248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 49, "seq_len_k": 6193, "queries_shape": [1, 32, 49, 128], "keys_shape": [1, 8, 6193, 128], "mask_shape": [1, 32, 49, 6193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:17.452495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 3.5762786865234375e-06, "l2_diff": 0.02734375, "l2_diff_relative": 0.014644351464435146}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 49, "seq_len_k": 6193, "queries_shape": [1, 32, 49, 128], "keys_shape": [1, 8, 6193, 128], "attention_shape": [1, 32, 49, 6193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:49.440267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4978425841312726, "overlap_percentage": 0.6647462015109074, "num_intersection": 62651, "num_union": 125845, "num_only_computed": 31597, "num_only_roped": 31597, "total_diff": 63194, "diff_percentage": 0.5021574158687274, "num_computed": 94248, "num_roped": 94248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6221, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6221, 128], "mask_shape": [1, 32, 28, 6221], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:50.475602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 9.894371032714844e-06, "l2_diff": 0.0252685546875, "l2_diff_relative": 0.021707214765100673}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6221, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6221, 128], "attention_shape": [1, 32, 28, 6221]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:00:20.121152", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5122389400404221, "overlap_percentage": 0.6774576774576775, "num_intersection": 2281, "num_union": 4453, "num_only_computed": 1086, "num_only_roped": 1086, "total_diff": 2172, "diff_percentage": 0.4877610599595778, "num_computed": 3367, "num_roped": 3367}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6222, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6222, 128], "mask_shape": [1, 32, 1, 6222], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:00:20.997533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00244140625, "mean_diff": 6.705522537231445e-06, "l2_diff": 0.003936767578125, "l2_diff_relative": 0.022775423728813558}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6222, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6222, 128], "attention_shape": [1, 32, 1, 6222]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:00:48.222851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49279538904899134, "overlap_percentage": 0.6602316602316602, "num_intersection": 2223, "num_union": 4511, "num_only_computed": 1144, "num_only_roped": 1144, "total_diff": 2288, "diff_percentage": 0.5072046109510087, "num_computed": 3367, "num_roped": 3367}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6223, 128], "mask_shape": [1, 32, 1, 6223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:00:49.101538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 4.589557647705078e-06, "l2_diff": 0.0021209716796875, "l2_diff_relative": 0.01143092105263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6223, 128], "attention_shape": [1, 32, 1, 6223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:16.353960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4955595026642984, "overlap_percentage": 0.66270783847981, "num_intersection": 2232, "num_union": 4504, "num_only_computed": 1136, "num_only_roped": 1136, "total_diff": 2272, "diff_percentage": 0.5044404973357016, "num_computed": 3368, "num_roped": 3368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6224, 128], "mask_shape": [1, 32, 1, 6224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:17.231563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 6.794929504394531e-06, "l2_diff": 0.005584716796875, "l2_diff_relative": 0.02859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6224, 128], "attention_shape": [1, 32, 1, 6224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:44.353577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4905952644390352, "overlap_percentage": 0.6582541567695962, "num_intersection": 2217, "num_union": 4519, "num_only_computed": 1151, "num_only_roped": 1151, "total_diff": 2302, "diff_percentage": 0.5094047355609648, "num_computed": 3368, "num_roped": 3368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6225, 128], "mask_shape": [1, 32, 1, 6225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:45.229616", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 1.1682510375976562e-05, "l2_diff": 0.00909423828125, "l2_diff_relative": 0.043313953488372095}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6225, 128], "attention_shape": [1, 32, 1, 6225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:12.373185", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48479506390480387, "overlap_percentage": 0.6530127634312852, "num_intersection": 2200, "num_union": 4538, "num_only_computed": 1169, "num_only_roped": 1169, "total_diff": 2338, "diff_percentage": 0.5152049360951961, "num_computed": 3369, "num_roped": 3369}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6226, 128], "mask_shape": [1, 32, 1, 6226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:13.250776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00341796875, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.003936767578125, "l2_diff_relative": 0.02264747191011236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6226, 128], "attention_shape": [1, 32, 1, 6226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:40.438733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5006681514476615, "overlap_percentage": 0.6672603146334224, "num_intersection": 2248, "num_union": 4490, "num_only_computed": 1121, "num_only_roped": 1121, "total_diff": 2242, "diff_percentage": 0.49933184855233853, "num_computed": 3369, "num_roped": 3369}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6227, 128], "mask_shape": [1, 32, 1, 6227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:41.313606", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 8.046627044677734e-06, "l2_diff": 0.006561279296875, "l2_diff_relative": 0.039755917159763315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6227, 128], "attention_shape": [1, 32, 1, 6227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:08.377609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4528993317525329, "overlap_percentage": 0.6234421364985163, "num_intersection": 2101, "num_union": 4639, "num_only_computed": 1269, "num_only_roped": 1269, "total_diff": 2538, "diff_percentage": 0.5471006682474672, "num_computed": 3370, "num_roped": 3370}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6228, 128], "mask_shape": [1, 32, 1, 6228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:09.253561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.011962890625, "l2_diff_relative": 0.03223684210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6228, 128], "attention_shape": [1, 32, 1, 6228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:30.227317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:30.241076", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.0030315375766871164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:36.083532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7507767178076337, "overlap_percentage": 0.8576498763906056, "num_intersection": 1110142, "num_union": 1478658, "num_only_computed": 200578, "num_only_roped": 167938, "total_diff": 368516, "diff_percentage": 0.2492232821923663, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:36.463347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.09228515625, "l2_diff_relative": 0.009909815436241611}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:50.979739", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6203883705189502, "overlap_percentage": 0.7657279968261719, "num_intersection": 1405117, "num_union": 2264899, "num_only_computed": 429891, "num_only_roped": 429891, "total_diff": 859782, "diff_percentage": 0.3796116294810497, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:53.894942", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.496906280517578e-06, "l2_diff": 0.11328125, "l2_diff_relative": 0.013731060606060606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:04:14.040927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.557223249680212, "overlap_percentage": 0.7156626383463541, "num_intersection": 1688460, "num_union": 3030132, "num_only_computed": 670836, "num_only_roped": 670836, "total_diff": 1341672, "diff_percentage": 0.442776750319788, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:04:14.762182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017974624060150376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:04:40.779555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5233052039418303, "overlap_percentage": 0.6870654713023793, "num_intersection": 1981211, "num_union": 3785957, "num_only_computed": 902373, "num_only_roped": 902373, "total_diff": 1804746, "diff_percentage": 0.4766947960581697, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:04:41.681385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.662441253662109e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.018774703557312252}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:05:13.476554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5045344123298754, "overlap_percentage": 0.6706851078913763, "num_intersection": 2285609, "num_union": 4530135, "num_only_computed": 1122263, "num_only_roped": 1122263, "total_diff": 2244526, "diff_percentage": 0.4954655876701246, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:05:16.553701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.15625, "l2_diff_relative": 0.021367521367521368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:05:54.227488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48623268573467443, "overlap_percentage": 0.654315694173177, "num_intersection": 2572874, "num_union": 5291446, "num_only_computed": 1359286, "num_only_roped": 1359286, "total_diff": 2718572, "diff_percentage": 0.5137673142653256, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:05:57.838552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.112720489501953e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.0200098814229249}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:06:42.022600", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4766838459704517, "overlap_percentage": 0.6456139508415671, "num_intersection": 2877145, "num_union": 6035751, "num_only_computed": 1579303, "num_only_roped": 1579303, "total_diff": 3158606, "diff_percentage": 0.5233161540295482, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:06:43.529943", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.9637088775634766e-06, "l2_diff": 0.189453125, "l2_diff_relative": 0.022964015151515152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:07:34.746025", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46383158314238493, "overlap_percentage": 0.633722606458162, "num_intersection": 3156405, "num_union": 6805067, "num_only_computed": 1824331, "num_only_roped": 1824331, "total_diff": 3648662, "diff_percentage": 0.5361684168576151, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:07:36.474229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0257568359375, "mean_diff": 1.2755393981933594e-05, "l2_diff": 0.265625, "l2_diff_relative": 0.032692307692307694}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:08:35.342727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4532921080642709, "overlap_percentage": 0.6238141741071429, "num_intersection": 3434112, "num_union": 7575936, "num_only_computed": 2070912, "num_only_roped": 2070912, "total_diff": 4141824, "diff_percentage": 0.5467078919357291, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:08:37.365447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.3649463653564453e-05, "l2_diff": 0.27734375, "l2_diff_relative": 0.03507905138339921}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:09:45.044049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4522762029073407, "overlap_percentage": 0.6228514961574388, "num_intersection": 3755366, "num_union": 8303258, "num_only_computed": 2273946, "num_only_roped": 2273946, "total_diff": 4547892, "diff_percentage": 0.5477237970926593, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:09:47.370458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 1.2099742889404297e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.046118951612903226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:11:05.667561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4479062183789707, "overlap_percentage": 0.618695068359375, "num_intersection": 4054680, "num_union": 9052520, "num_only_computed": 2498920, "num_only_roped": 2498920, "total_diff": 4997840, "diff_percentage": 0.5520937816210293, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:11:08.240662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.376953125, "l2_diff_relative": 0.04883603238866397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:12:31.090309", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44454889481484866, "overlap_percentage": 0.6154847321686922, "num_intersection": 4356332, "num_union": 9799444, "num_only_computed": 2721556, "num_only_roped": 2721556, "total_diff": 5443112, "diff_percentage": 0.5554511051851513, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:12:33.903618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07470703125, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.052490234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:14:05.594790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4469662139688392, "overlap_percentage": 0.617797720021215, "num_intersection": 4696607, "num_union": 10507745, "num_only_computed": 2905569, "num_only_roped": 2905569, "total_diff": 5811138, "diff_percentage": 0.5530337860311608, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:14:08.651923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 7.450580596923828e-06, "l2_diff": 0.32421875, "l2_diff_relative": 0.03732014388489208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:15:47.751717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43654894390690363, "overlap_percentage": 0.6077745499149445, "num_intersection": 4939058, "num_union": 11313870, "num_only_computed": 3187406, "num_only_roped": 3187406, "total_diff": 6374812, "diff_percentage": 0.5634510560930963, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:15:51.161900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 8.761882781982422e-06, "l2_diff": 0.375, "l2_diff_relative": 0.05150214592274678}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:17:37.754509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44410843556462737, "overlap_percentage": 0.6150624490895475, "num_intersection": 4810607, "num_union": 10832055, "num_only_computed": 3010724, "num_only_roped": 3010724, "total_diff": 6021448, "diff_percentage": 0.5558915644353726, "num_computed": 7821331, "num_roped": 7821331}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 931, "seq_len_k": 16291, "queries_shape": [1, 32, 931, 128], "keys_shape": [1, 8, 16291, 128], "mask_shape": [1, 32, 931, 16291], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:17:42.076428", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 1.239776611328125e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.08776595744680851}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 931, "seq_len_k": 16291, "queries_shape": [1, 32, 931, 128], "keys_shape": [1, 8, 16291, 128], "attention_shape": [1, 32, 931, 16291]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:27.856158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4334252975656348, "overlap_percentage": 0.6047406841524489, "num_intersection": 142489, "num_union": 328751, "num_only_computed": 93131, "num_only_roped": 93131, "total_diff": 186262, "diff_percentage": 0.5665747024343653, "num_computed": 235620, "num_roped": 235620}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16319, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16319, 128], "mask_shape": [1, 32, 28, 16319], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:31.382367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.1376953125, "l2_diff_relative": 0.09957627118644068}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16319, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16319, 128], "attention_shape": [1, 32, 28, 16319]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:21:02.149526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4642888212266203, "overlap_percentage": 0.6341492395437263, "num_intersection": 5337, "num_union": 11495, "num_only_computed": 3079, "num_only_roped": 3079, "total_diff": 6158, "diff_percentage": 0.5357111787733797, "num_computed": 8416, "num_roped": 8416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16320, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16320, 128], "mask_shape": [1, 32, 1, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:21:04.682620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.11279296875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16320, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16320, 128], "attention_shape": [1, 32, 1, 16320]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:22:23.328393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43397512353041406, "overlap_percentage": 0.6052756653992395, "num_intersection": 5094, "num_union": 11738, "num_only_computed": 3322, "num_only_roped": 3322, "total_diff": 6644, "diff_percentage": 0.566024876469586, "num_computed": 8416, "num_roped": 8416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16321, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16321, 128], "mask_shape": [1, 32, 1, 16321], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:22:25.852263", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 1.5616416931152344e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.14309210526315788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16321, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16321, 128], "attention_shape": [1, 32, 1, 16321]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:09.987139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:09.999812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.0031225119426751594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:15.811302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7471752155960765, "overlap_percentage": 0.8552951174289246, "num_intersection": 1107094, "num_union": 1481706, "num_only_computed": 203626, "num_only_roped": 170986, "total_diff": 374612, "diff_percentage": 0.2528247844039236, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:16.192114", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.1026859283447266e-05, "l2_diff": 0.1376953125, "l2_diff_relative": 0.016947115384615383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:30.839263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6243436264043651, "overlap_percentage": 0.7687334333147321, "num_intersection": 1410632, "num_union": 2259384, "num_only_computed": 424376, "num_only_roped": 424376, "total_diff": 848752, "diff_percentage": 0.3756563735956349, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:31.385909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.2099742889404297e-05, "l2_diff": 0.1953125, "l2_diff_relative": 0.02422480620155039}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:52.387304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5592373054419741, "overlap_percentage": 0.7173216078016493, "num_intersection": 1692374, "num_union": 3026218, "num_only_computed": 666922, "num_only_roped": 666922, "total_diff": 1333844, "diff_percentage": 0.4407626945580259, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:55.337195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.2636184692382812e-05, "l2_diff": 0.23046875, "l2_diff_relative": 0.030729166666666665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:21.866285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5278500647072147, "overlap_percentage": 0.6909710277210582, "num_intersection": 1992473, "num_union": 3774695, "num_only_computed": 891111, "num_only_roped": 891111, "total_diff": 1782222, "diff_percentage": 0.47214993529278526, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:23.796311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 8.821487426757812e-06, "l2_diff": 0.1953125, "l2_diff_relative": 0.028935185185185185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:55.757150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5056518186354827, "overlap_percentage": 0.6716716472919171, "num_intersection": 2288971, "num_union": 4526773, "num_only_computed": 1118901, "num_only_roped": 1118901, "total_diff": 2237802, "diff_percentage": 0.4943481813645173, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:56.856116", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.632638931274414e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.02219012605042017}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:25:35.193401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4943272409293714, "overlap_percentage": 0.6616050720214843, "num_intersection": 2601537, "num_union": 5262783, "num_only_computed": 1330623, "num_only_roped": 1330623, "total_diff": 2661246, "diff_percentage": 0.5056727590706286, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:25:36.494522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.543231964111328e-06, "l2_diff": 0.1943359375, "l2_diff_relative": 0.025591563786008232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:20.760799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4782758256373802, "overlap_percentage": 0.6470725115607766, "num_intersection": 2883645, "num_union": 6029251, "num_only_computed": 1572803, "num_only_roped": 1572803, "total_diff": 3145606, "diff_percentage": 0.5217241743626199, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:22.274857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 5.245208740234375e-06, "l2_diff": 0.2177734375, "l2_diff_relative": 0.02765376984126984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:13.526506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47829285966885493, "overlap_percentage": 0.6470881010356703, "num_intersection": 3222975, "num_union": 6738497, "num_only_computed": 1757761, "num_only_roped": 1757761, "total_diff": 3515522, "diff_percentage": 0.5217071403311451, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:15.271738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021728515625, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.30859375, "l2_diff_relative": 0.03872549019607843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:13.758746", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4812326223313208, "overlap_percentage": 0.649773188999721, "num_intersection": 3577017, "num_union": 7433031, "num_only_computed": 1928007, "num_only_roped": 1928007, "total_diff": 3856014, "diff_percentage": 0.5187673776686792, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:15.771872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 1.1622905731201172e-05, "l2_diff": 0.31640625, "l2_diff_relative": 0.041666666666666664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:29:23.788625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4735786286676254, "overlap_percentage": 0.6427599036175272, "num_intersection": 3875400, "num_union": 8183224, "num_only_computed": 2153912, "num_only_roped": 2153912, "total_diff": 4307824, "diff_percentage": 0.5264213713323747, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:29:28.592806", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.31640625, "l2_diff_relative": 0.0375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:30:43.619307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4665761245676676, "overlap_percentage": 0.6362794494628906, "num_intersection": 4169921, "num_union": 8937279, "num_only_computed": 2383679, "num_only_roped": 2383679, "total_diff": 4767358, "diff_percentage": 0.5334238754323324, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:30:46.174617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 1.0192394256591797e-05, "l2_diff": 0.33984375, "l2_diff_relative": 0.04057835820895522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:32:08.490016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4682692310684296, "overlap_percentage": 0.6378519976580584, "num_intersection": 4514645, "num_union": 9641131, "num_only_computed": 2563243, "num_only_roped": 2563243, "total_diff": 5126486, "diff_percentage": 0.5317307689315703, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:32:11.268509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 1.436471939086914e-05, "l2_diff": 0.48828125, "l2_diff_relative": 0.06351626016260163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:33:40.268988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4583748730542252, "overlap_percentage": 0.6286104917513645, "num_intersection": 3152222, "num_union": 6876952, "num_only_computed": 1862365, "num_only_roped": 1862365, "total_diff": 3724730, "diff_percentage": 0.5416251269457748, "num_computed": 5014587, "num_roped": 5014587}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 691, "seq_len_k": 14003, "queries_shape": [1, 32, 691, 128], "keys_shape": [1, 8, 14003, 128], "mask_shape": [1, 32, 691, 14003], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:33:43.149812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 9.417533874511719e-06, "l2_diff": 0.310546875, "l2_diff_relative": 0.046875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 691, "seq_len_k": 14003, "queries_shape": [1, 32, 691, 128], "keys_shape": [1, 8, 14003, 128], "attention_shape": [1, 32, 691, 14003]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:35:08.793925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4580076615189047, "overlap_percentage": 0.6282650957290132, "num_intersection": 159972, "num_union": 349278, "num_only_computed": 94653, "num_only_roped": 94653, "total_diff": 189306, "diff_percentage": 0.5419923384810953, "num_computed": 254625, "num_roped": 254625}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14038, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14038, 128], "mask_shape": [1, 32, 35, 14038], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:35:11.489161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.1005859375, "l2_diff_relative": 0.06602564102564103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14038, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14038, 128], "attention_shape": [1, 32, 35, 14038]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:36:26.824699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4646668008858466, "overlap_percentage": 0.6345017182130585, "num_intersection": 4616, "num_union": 9934, "num_only_computed": 2659, "num_only_roped": 2659, "total_diff": 5318, "diff_percentage": 0.5353331991141534, "num_computed": 7275, "num_roped": 7275}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14039, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14039, 128], "mask_shape": [1, 32, 1, 14039], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:36:28.978004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.5020370483398438e-05, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.11035564853556486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14039, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14039, 128], "attention_shape": [1, 32, 1, 14039]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:37:35.765103", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46324786324786327, "overlap_percentage": 0.633177570093458, "num_intersection": 4607, "num_union": 9945, "num_only_computed": 2669, "num_only_roped": 2669, "total_diff": 5338, "diff_percentage": 0.5367521367521367, "num_computed": 7276, "num_roped": 7276}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14040, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14040, 128], "mask_shape": [1, 32, 1, 14040], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:37:37.900375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.027099609375, "l2_diff_relative": 0.14682539682539683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14040, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14040, 128], "attention_shape": [1, 32, 1, 14040]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:38:44.776657", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4700474795433882, "overlap_percentage": 0.6394997251236944, "num_intersection": 4653, "num_union": 9899, "num_only_computed": 2623, "num_only_roped": 2623, "total_diff": 5246, "diff_percentage": 0.5299525204566118, "num_computed": 7276, "num_roped": 7276}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14041, 128], "mask_shape": [1, 32, 1, 14041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:38:46.937952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.16709844559585493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14041, 128], "attention_shape": [1, 32, 1, 14041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:39:53.542576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48966223132036846, "overlap_percentage": 0.6574137694104714, "num_intersection": 4784, "num_union": 9770, "num_only_computed": 2493, "num_only_roped": 2493, "total_diff": 4986, "diff_percentage": 0.5103377686796315, "num_computed": 7277, "num_roped": 7277}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14042, 128], "mask_shape": [1, 32, 1, 14042], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:39:55.721566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.1434729064039409}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14042, 128], "attention_shape": [1, 32, 1, 14042]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:41:02.711983", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4509022031701725, "overlap_percentage": 0.6215473409371994, "num_intersection": 4523, "num_union": 10031, "num_only_computed": 2754, "num_only_roped": 2754, "total_diff": 5508, "diff_percentage": 0.5490977968298275, "num_computed": 7277, "num_roped": 7277}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14043, 128], "mask_shape": [1, 32, 1, 14043], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:41:04.933514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.1240530303030303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14043, 128], "attention_shape": [1, 32, 1, 14043]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:42:10.665773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4379136619579176, "overlap_percentage": 0.6090959054685353, "num_intersection": 4433, "num_union": 10123, "num_only_computed": 2845, "num_only_roped": 2845, "total_diff": 5690, "diff_percentage": 0.5620863380420824, "num_computed": 7278, "num_roped": 7278}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14044, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14044, 128], "mask_shape": [1, 32, 1, 14044], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:42:12.791347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0133056640625, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.13447867298578198}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14044, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14044, 128], "attention_shape": [1, 32, 1, 14044]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:43:18.556387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45371017677019876, "overlap_percentage": 0.6242099477878538, "num_intersection": 4543, "num_union": 10013, "num_only_computed": 2735, "num_only_roped": 2735, "total_diff": 5470, "diff_percentage": 0.5462898232298012, "num_computed": 7278, "num_roped": 7278}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14045, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14045, 128], "mask_shape": [1, 32, 1, 14045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:43:20.658643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.2993812561035156e-05, "l2_diff": 0.0269775390625, "l2_diff_relative": 0.12116228070175439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14045, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14045, 128], "attention_shape": [1, 32, 1, 14045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:00.296216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:00.325734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.03173828125, "l2_diff_relative": 0.003134645061728395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:06.193469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.74792076560658, "overlap_percentage": 0.8557833745364648, "num_intersection": 1107726, "num_union": 1481074, "num_only_computed": 202994, "num_only_roped": 170354, "total_diff": 373348, "diff_percentage": 0.2520792343934199, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:06.573304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.62939453125e-06, "l2_diff": 0.10888671875, "l2_diff_relative": 0.012624547101449276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:21.789234", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6244334978858113, "overlap_percentage": 0.7688015529087612, "num_intersection": 1410757, "num_union": 2259259, "num_only_computed": 424251, "num_only_roped": 424251, "total_diff": 848502, "diff_percentage": 0.3755665021141888, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:22.332204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.930662155151367e-06, "l2_diff": 0.10498046875, "l2_diff_relative": 0.01244212962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:42.384303", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5630760179754378, "overlap_percentage": 0.7204717000325521, "num_intersection": 1699806, "num_union": 3018786, "num_only_computed": 659490, "num_only_roped": 659490, "total_diff": 1318980, "diff_percentage": 0.4369239820245622, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:43.104183", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 5.692243576049805e-06, "l2_diff": 0.12451171875, "l2_diff_relative": 0.015811011904761904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:09.209277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5304745845653467, "overlap_percentage": 0.6932158036665483, "num_intersection": 1998946, "num_union": 3768222, "num_only_computed": 884638, "num_only_roped": 884638, "total_diff": 1769276, "diff_percentage": 0.46952541543465326, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:10.613468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 6.3478946685791016e-06, "l2_diff": 0.16796875, "l2_diff_relative": 0.021245059288537548}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:42.436586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5105490861566141, "overlap_percentage": 0.6759781470665565, "num_intersection": 2303647, "num_union": 4512097, "num_only_computed": 1104225, "num_only_roped": 1104225, "total_diff": 2208450, "diff_percentage": 0.4894509138433859, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:43.536088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.291534423828125e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.017096920289855072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:46:21.586390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4921619149896972, "overlap_percentage": 0.6596628824869791, "num_intersection": 2593900, "num_union": 5270420, "num_only_computed": 1338260, "num_only_roped": 1338260, "total_diff": 2676520, "diff_percentage": 0.5078380850103028, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:46:22.898313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.01597481343283582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:47:07.580725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48480559531520295, "overlap_percentage": 0.6530223173253676, "num_intersection": 2910160, "num_union": 6002736, "num_only_computed": 1546288, "num_only_roped": 1546288, "total_diff": 3092576, "diff_percentage": 0.515194404684797, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:47:09.090266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.8461217880249023e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.01743027888446215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:48:00.407273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47790246602624786, "overlap_percentage": 0.6467307241339433, "num_intersection": 3221195, "num_union": 6740277, "num_only_computed": 1759541, "num_only_roped": 1759541, "total_diff": 3519082, "diff_percentage": 0.5220975339737521, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:48:02.134169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0269775390625, "mean_diff": 1.2516975402832031e-05, "l2_diff": 0.279296875, "l2_diff_relative": 0.034375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:49:01.144619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4736327297622322, "overlap_percentage": 0.6428097316196987, "num_intersection": 3538683, "num_union": 7471365, "num_only_computed": 1966341, "num_only_roped": 1966341, "total_diff": 3932682, "diff_percentage": 0.5263672702377677, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:49:03.862177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.034912109375, "mean_diff": 1.0371208190917969e-05, "l2_diff": 0.3046875, "l2_diff_relative": 0.03507194244604316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:50:10.635228", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4639754771908811, "overlap_percentage": 0.633856897768767, "num_intersection": 3821721, "num_union": 8236903, "num_only_computed": 2207591, "num_only_roped": 2207591, "total_diff": 4415182, "diff_percentage": 0.5360245228091189, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:50:14.985305", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 8.463859558105469e-06, "l2_diff": 0.2451171875, "l2_diff_relative": 0.03162802419354839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:51:28.449733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45360404461066806, "overlap_percentage": 0.6241094970703125, "num_intersection": 4090164, "num_union": 9017036, "num_only_computed": 2463436, "num_only_roped": 2463436, "total_diff": 4926872, "diff_percentage": 0.5463959553893319, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:51:31.027243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.4140625, "l2_diff_relative": 0.05520833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:53:00.003259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4492232005919018, "overlap_percentage": 0.6199503298158999, "num_intersection": 4387939, "num_union": 9767837, "num_only_computed": 2689949, "num_only_roped": 2689949, "total_diff": 5379898, "diff_percentage": 0.5507767994080982, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:53:02.878971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.08874458874458875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:54:35.567847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4425607231991772, "overlap_percentage": 0.6135765601848734, "num_intersection": 4664517, "num_union": 10539835, "num_only_computed": 2937659, "num_only_roped": 2937659, "total_diff": 5875318, "diff_percentage": 0.5574392768008228, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:54:38.700684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 1.4066696166992188e-05, "l2_diff": 0.640625, "l2_diff_relative": 0.080078125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:56:18.978267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.437524626994184, "overlap_percentage": 0.608719487344065, "num_intersection": 4946737, "num_union": 11306191, "num_only_computed": 3179727, "num_only_roped": 3179727, "total_diff": 6359454, "diff_percentage": 0.5624753730058161, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:56:22.288873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 1.537799835205078e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.0938818565400844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:58:02.820233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.451946896163908, "overlap_percentage": 0.6225391539566174, "num_intersection": 462127, "num_union": 1022525, "num_only_computed": 280199, "num_only_roped": 280199, "total_diff": 560398, "diff_percentage": 0.5480531038360921, "num_computed": 742326, "num_roped": 742326}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 15453, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 15453, 128], "mask_shape": [1, 32, 93, 15453], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:58:06.705308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.40625, "l2_diff_relative": 0.16049382716049382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 15453, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 15453, 128], "attention_shape": [1, 32, 93, 15453]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:59:42.934532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4390729902932205, "overlap_percentage": 0.6102164285687226, "num_intersection": 161077, "num_union": 366857, "num_only_computed": 102890, "num_only_roped": 102890, "total_diff": 205780, "diff_percentage": 0.5609270097067794, "num_computed": 263967, "num_roped": 263967}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15486, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15486, 128], "mask_shape": [1, 32, 33, 15486], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:59:46.031096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.2080078125, "l2_diff_relative": 0.14957865168539325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15486, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15486, 128], "attention_shape": [1, 32, 33, 15486]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:01:11.718793", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46918908990724584, "overlap_percentage": 0.6387048381047631, "num_intersection": 5109, "num_union": 10889, "num_only_computed": 2890, "num_only_roped": 2890, "total_diff": 5780, "diff_percentage": 0.5308109100927542, "num_computed": 7999, "num_roped": 7999}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15487, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 1, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:01:14.127457", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.9087066650390625e-05, "l2_diff": 0.042236328125, "l2_diff_relative": 0.23763736263736263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15487, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 1, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:02:30.159918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4234875444839858, "overlap_percentage": 0.595, "num_intersection": 4760, "num_union": 11240, "num_only_computed": 3240, "num_only_roped": 3240, "total_diff": 6480, "diff_percentage": 0.5765124555160143, "num_computed": 8000, "num_roped": 8000}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:02:32.518871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.1419491525423729}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:13.158054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:13.169586", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.0030354299363057327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:18.968970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.747704820972998, "overlap_percentage": 0.8556419962917182, "num_intersection": 1107543, "num_union": 1481257, "num_only_computed": 203177, "num_only_roped": 170537, "total_diff": 373714, "diff_percentage": 0.25229517902700205, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:19.347158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 8.225440979003906e-06, "l2_diff": 0.11474609375, "l2_diff_relative": 0.01380404135338346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:33.780247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6290525835462856, "overlap_percentage": 0.7722925458635602, "num_intersection": 1417163, "num_union": 2252853, "num_only_computed": 417845, "num_only_roped": 417845, "total_diff": 835690, "diff_percentage": 0.3709474164537145, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:36.649334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.0183982683982684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:56.637589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.561981673679475, "overlap_percentage": 0.7195752461751302, "num_intersection": 1697691, "num_union": 3020901, "num_only_computed": 661605, "num_only_roped": 661605, "total_diff": 1323210, "diff_percentage": 0.4380183263205249, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:57.369573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.0162080223880597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:23.268302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5273285056292611, "overlap_percentage": 0.6905240145596591, "num_intersection": 1991184, "num_union": 3775984, "num_only_computed": 892400, "num_only_roped": 892400, "total_diff": 1784800, "diff_percentage": 0.47267149437073885, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:24.171649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.291534423828125e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.014605978260869566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:55.919377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5072060467415065, "overlap_percentage": 0.6730414170485276, "num_intersection": 2293639, "num_union": 4522105, "num_only_computed": 1114233, "num_only_roped": 1114233, "total_diff": 2228466, "diff_percentage": 0.49279395325849357, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:57.016865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.202127456665039e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.017459514170040488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:05:37.005325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4963052429817882, "overlap_percentage": 0.6633743286132813, "num_intersection": 2608494, "num_union": 5255826, "num_only_computed": 1323666, "num_only_roped": 1323666, "total_diff": 2647332, "diff_percentage": 0.5036947570182118, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:05:38.300693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.2186508178710938e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.016191123188405796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:06:24.604244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4860173852557945, "overlap_percentage": 0.6541207257439109, "num_intersection": 2915055, "num_union": 5997841, "num_only_computed": 1541393, "num_only_roped": 1541393, "total_diff": 3082786, "diff_percentage": 0.5139826147442055, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:06:26.109722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.518296241760254e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.015967153284671534}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:07:18.042879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48265137479222137, "overlap_percentage": 0.6510652240953947, "num_intersection": 3242784, "num_union": 6718688, "num_only_computed": 1737952, "num_only_roped": 1737952, "total_diff": 3475904, "diff_percentage": 0.5173486252077787, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:07:20.506934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.244140625, "l2_diff_relative": 0.030517578125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:08:19.122911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4678774225038093, "overlap_percentage": 0.6374884105864025, "num_intersection": 3509389, "num_union": 7500659, "num_only_computed": 1995635, "num_only_roped": 1995635, "total_diff": 3991270, "diff_percentage": 0.5321225774961906, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:08:21.126487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046630859375, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.30078125, "l2_diff_relative": 0.03896761133603239}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:09:25.366859", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4650742566555389, "overlap_percentage": 0.6348814806386771, "num_intersection": 2929486, "num_union": 6298964, "num_only_computed": 1684739, "num_only_roped": 1684739, "total_diff": 3369478, "diff_percentage": 0.5349257433444611, "num_computed": 4614225, "num_roped": 4614225}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 799, "seq_len_k": 11039, "queries_shape": [1, 32, 799, 128], "keys_shape": [1, 8, 11039, 128], "mask_shape": [1, 32, 799, 11039], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:09:27.520632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.41015625, "l2_diff_relative": 0.061910377358490566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 799, "seq_len_k": 11039, "queries_shape": [1, 32, 799, 128], "keys_shape": [1, 8, 11039, 128], "attention_shape": [1, 32, 799, 11039]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:10:31.881651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4564534841269197, "overlap_percentage": 0.6268013212938877, "num_intersection": 112524, "num_union": 246518, "num_only_computed": 66997, "num_only_roped": 66997, "total_diff": 133994, "diff_percentage": 0.5435465158730802, "num_computed": 179521, "num_roped": 179521}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11070, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11070, 128], "mask_shape": [1, 32, 31, 11070], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:10:33.907485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.11279296875, "l2_diff_relative": 0.0859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11070, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11070, 128], "attention_shape": [1, 32, 31, 11070]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:11:30.007348", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5066996227396904, "overlap_percentage": 0.6725954066655154, "num_intersection": 3895, "num_union": 7687, "num_only_computed": 1896, "num_only_roped": 1896, "total_diff": 3792, "diff_percentage": 0.4933003772603096, "num_computed": 5791, "num_roped": 5791}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11071, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11071, 128], "mask_shape": [1, 32, 1, 11071], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:11:31.606691", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015380859375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.1801470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11071, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11071, 128], "attention_shape": [1, 32, 1, 11071]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:12:22.019593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5026592294720457, "overlap_percentage": 0.6690262430939227, "num_intersection": 3875, "num_union": 7709, "num_only_computed": 1917, "num_only_roped": 1917, "total_diff": 3834, "diff_percentage": 0.49734077052795433, "num_computed": 5792, "num_roped": 5792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11072, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11072, 128], "mask_shape": [1, 32, 1, 11072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:12:23.649171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.00543212890625e-05, "l2_diff": 0.0269775390625, "l2_diff_relative": 0.21087786259541985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11072, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11072, 128], "attention_shape": [1, 32, 1, 11072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:14.161716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47117094234188467, "overlap_percentage": 0.6405386740331491, "num_intersection": 3710, "num_union": 7874, "num_only_computed": 2082, "num_only_roped": 2082, "total_diff": 4164, "diff_percentage": 0.5288290576581153, "num_computed": 5792, "num_roped": 5792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11073, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11073, 128], "mask_shape": [1, 32, 1, 11073], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:16.289394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.10622529644268774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11073, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11073, 128], "attention_shape": [1, 32, 1, 11073]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:49.401255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:49.418065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.00301513671875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:55.234292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7467095697256799, "overlap_percentage": 0.854989956736712, "num_intersection": 1106699, "num_union": 1482101, "num_only_computed": 204021, "num_only_roped": 171381, "total_diff": 375402, "diff_percentage": 0.25329043027432, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:55.605813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 7.450580596923828e-06, "l2_diff": 0.10205078125, "l2_diff_relative": 0.011338975694444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:14:10.081979", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6228776103563018, "overlap_percentage": 0.7676211765834263, "num_intersection": 1408591, "num_union": 2261425, "num_only_computed": 426417, "num_only_roped": 426417, "total_diff": 852834, "diff_percentage": 0.3771223896436981, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:14:13.301058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 7.987022399902344e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.01574248120300752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:14:33.270371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.565436525498684, "overlap_percentage": 0.7224010891384549, "num_intersection": 1704358, "num_union": 3014234, "num_only_computed": 654938, "num_only_roped": 654938, "total_diff": 1309876, "diff_percentage": 0.4345634745013161, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:14:33.989224", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 7.271766662597656e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.018795289855072464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:14:59.839147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5226484387169678, "overlap_percentage": 0.6864991621537642, "num_intersection": 1979578, "num_union": 3787590, "num_only_computed": 904006, "num_only_roped": 904006, "total_diff": 1808012, "diff_percentage": 0.47735156128303224, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:15:00.746620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.496906280517578e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.01991637323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:15:32.527051", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.507373380635142, "overlap_percentage": 0.673188723050631, "num_intersection": 2294141, "num_union": 4521603, "num_only_computed": 1113731, "num_only_roped": 1113731, "total_diff": 2227462, "diff_percentage": 0.492626619364858, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:15:36.264632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 6.139278411865234e-06, "l2_diff": 0.189453125, "l2_diff_relative": 0.023317307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:16:14.159484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5004911122796386, "overlap_percentage": 0.6671030680338542, "num_intersection": 2623156, "num_union": 5241164, "num_only_computed": 1309004, "num_only_roped": 1309004, "total_diff": 2618008, "diff_percentage": 0.49950888772036134, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:16:15.452695", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.56137752532959e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.017233455882352942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:17:00.973693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48951677459786924, "overlap_percentage": 0.6572826609892004, "num_intersection": 2929146, "num_union": 5983750, "num_only_computed": 1527302, "num_only_roped": 1527302, "total_diff": 3054604, "diff_percentage": 0.5104832254021308, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:17:02.468526", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.019791666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:17:54.026242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47445142896303505, "overlap_percentage": 0.6435633207622328, "num_intersection": 3205419, "num_union": 6756053, "num_only_computed": 1775317, "num_only_roped": 1775317, "total_diff": 3550634, "diff_percentage": 0.525548571036965, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:17:56.367380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.051025390625, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.2392578125, "l2_diff_relative": 0.02754046762589928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:18:54.981562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4622593308937659, "overlap_percentage": 0.6322535560244605, "num_intersection": 3480571, "num_union": 7529477, "num_only_computed": 2024453, "num_only_roped": 2024453, "total_diff": 4048906, "diff_percentage": 0.5377406691062341, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:18:56.982402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.287109375, "l2_diff_relative": 0.03506679389312977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:20:04.024184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4578766420665233, "overlap_percentage": 0.6281418178392493, "num_intersection": 3787263, "num_union": 8271361, "num_only_computed": 2242049, "num_only_roped": 2242049, "total_diff": 4484098, "diff_percentage": 0.5421233579334768, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:20:06.283185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.1444091796875e-05, "l2_diff": 0.306640625, "l2_diff_relative": 0.03878458498023715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:21:20.984242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4478807875547117, "overlap_percentage": 0.6186708068847656, "num_intersection": 4054521, "num_union": 9052679, "num_only_computed": 2499079, "num_only_roped": 2499079, "total_diff": 4998158, "diff_percentage": 0.5521192124452883, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:21:23.555261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 9.834766387939453e-06, "l2_diff": 0.296875, "l2_diff_relative": 0.03298611111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:45.659117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4488144168936317, "overlap_percentage": 0.6195609481246384, "num_intersection": 4385183, "num_union": 9770593, "num_only_computed": 2692705, "num_only_roped": 2692705, "total_diff": 5385410, "diff_percentage": 0.5511855831063682, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:48.481692", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 1.1086463928222656e-05, "l2_diff": 0.43359375, "l2_diff_relative": 0.05063868613138686}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:24:19.713220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4432140136974963, "overlap_percentage": 0.6142041436557112, "num_intersection": 4669288, "num_union": 10535064, "num_only_computed": 2932888, "num_only_roped": 2932888, "total_diff": 5865776, "diff_percentage": 0.5567859863025038, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:24:24.388672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 8.702278137207031e-06, "l2_diff": 0.37890625, "l2_diff_relative": 0.04699612403100775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:26:00.365634", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4480575679938307, "overlap_percentage": 0.6188394410514756, "num_intersection": 3857928, "num_union": 8610340, "num_only_computed": 2376206, "num_only_roped": 2376206, "total_diff": 4752412, "diff_percentage": 0.5519424320061693, "num_computed": 6234134, "num_roped": 6234134}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 797, "seq_len_k": 15133, "queries_shape": [1, 32, 797, 128], "keys_shape": [1, 8, 15133, 128], "mask_shape": [1, 32, 797, 15133], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:26:03.526621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.5234375, "l2_diff_relative": 0.07411504424778761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 797, "seq_len_k": 15133, "queries_shape": [1, 32, 797, 128], "keys_shape": [1, 8, 15133, 128], "attention_shape": [1, 32, 797, 15133]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:27:37.742858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4694368292922101, "overlap_percentage": 0.6389343453686617, "num_intersection": 110105, "num_union": 234547, "num_only_computed": 62221, "num_only_roped": 62221, "total_diff": 124442, "diff_percentage": 0.5305631707077899, "num_computed": 172326, "num_roped": 172326}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15155, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15155, 128], "mask_shape": [1, 32, 22, 15155], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:27:40.680124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.158203125, "l2_diff_relative": 0.12980769230769232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15155, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15155, 128], "attention_shape": [1, 32, 22, 15155]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:29:03.369879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4897784539317296, "overlap_percentage": 0.6575185090630584, "num_intersection": 5151, "num_union": 10517, "num_only_computed": 2683, "num_only_roped": 2683, "total_diff": 5366, "diff_percentage": 0.5102215460682704, "num_computed": 7834, "num_roped": 7834}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15156, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15156, 128], "mask_shape": [1, 32, 1, 15156], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:29:05.717659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.05419921875, "l2_diff_relative": 0.19964028776978418}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15156, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15156, 128], "attention_shape": [1, 32, 1, 15156]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:30:18.993222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48737421682172016, "overlap_percentage": 0.6553484809803422, "num_intersection": 5134, "num_union": 10534, "num_only_computed": 2700, "num_only_roped": 2700, "total_diff": 5400, "diff_percentage": 0.5126257831782799, "num_computed": 7834, "num_roped": 7834}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15157, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15157, 128], "mask_shape": [1, 32, 1, 15157], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:30:22.935451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.05810546875, "l2_diff_relative": 0.16807909604519775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15157, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15157, 128], "attention_shape": [1, 32, 1, 15157]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:31:36.475704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4889775750665146, "overlap_percentage": 0.6567964262922782, "num_intersection": 5146, "num_union": 10524, "num_only_computed": 2689, "num_only_roped": 2689, "total_diff": 5378, "diff_percentage": 0.5110224249334854, "num_computed": 7835, "num_roped": 7835}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15158, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15158, 128], "mask_shape": [1, 32, 1, 15158], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:31:40.584907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.2993812561035156e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.09272875816993464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15158, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15158, 128], "attention_shape": [1, 32, 1, 15158]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:32:54.605505", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48911907250784, "overlap_percentage": 0.6569240587109125, "num_intersection": 5147, "num_union": 10523, "num_only_computed": 2688, "num_only_roped": 2688, "total_diff": 5376, "diff_percentage": 0.5108809274921601, "num_computed": 7835, "num_roped": 7835}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15159, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15159, 128], "mask_shape": [1, 32, 1, 15159], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:32:56.972854", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.1258741258741259}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15159, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15159, 128], "attention_shape": [1, 32, 1, 15159]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:34:10.889914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4733477484253079, "overlap_percentage": 0.6425472179683512, "num_intersection": 5035, "num_union": 10637, "num_only_computed": 2801, "num_only_roped": 2801, "total_diff": 5602, "diff_percentage": 0.5266522515746921, "num_computed": 7836, "num_roped": 7836}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15160, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15160, 128], "mask_shape": [1, 32, 1, 15160], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:34:15.177537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.04541015625, "l2_diff_relative": 0.17884615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15160, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15160, 128], "attention_shape": [1, 32, 1, 15160]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:35:28.694632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46906636670416196, "overlap_percentage": 0.6385911179173047, "num_intersection": 5004, "num_union": 10668, "num_only_computed": 2832, "num_only_roped": 2832, "total_diff": 5664, "diff_percentage": 0.530933633295838, "num_computed": 7836, "num_roped": 7836}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15161, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15161, 128], "mask_shape": [1, 32, 1, 15161], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:35:31.048761", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.3887882232666016e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.10828025477707007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15161, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15161, 128], "attention_shape": [1, 32, 1, 15161]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:36:44.544147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4704944178628389, "overlap_percentage": 0.6399132321041214, "num_intersection": 5015, "num_union": 10659, "num_only_computed": 2822, "num_only_roped": 2822, "total_diff": 5644, "diff_percentage": 0.529505582137161, "num_computed": 7837, "num_roped": 7837}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15162, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15162, 128], "mask_shape": [1, 32, 1, 15162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:36:49.095442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.16605839416058393}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15162, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15162, 128], "attention_shape": [1, 32, 1, 15162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:29.565264", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:29.573591", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030565137987012985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:35.508695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7508347372429087, "overlap_percentage": 0.8576877317676144, "num_intersection": 1110191, "num_union": 1478609, "num_only_computed": 200529, "num_only_roped": 167889, "total_diff": 368418, "diff_percentage": 0.2491652627570913, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:35.897088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.761882781982422e-06, "l2_diff": 0.1162109375, "l2_diff_relative": 0.013773148148148149}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:50.753925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6268125915632182, "overlap_percentage": 0.7706020900181362, "num_intersection": 1414061, "num_union": 2255955, "num_only_computed": 420947, "num_only_roped": 420947, "total_diff": 841894, "diff_percentage": 0.3731874084367818, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:51.316902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 7.3909759521484375e-06, "l2_diff": 0.123046875, "l2_diff_relative": 0.01514423076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:12.311360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5632370650742511, "overlap_percentage": 0.720603519015842, "num_intersection": 1700117, "num_union": 3018475, "num_only_computed": 659179, "num_only_roped": 659179, "total_diff": 1318358, "diff_percentage": 0.4367629349257489, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:13.046771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.821487426757812e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.02209051724137931}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:39.738537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5312149532710281, "overlap_percentage": 0.69384765625, "num_intersection": 2000768, "num_union": 3766400, "num_only_computed": 882816, "num_only_roped": 882816, "total_diff": 1765632, "diff_percentage": 0.468785046728972, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:40.662025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 6.973743438720703e-06, "l2_diff": 0.1845703125, "l2_diff_relative": 0.021714154411764705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:08.446026", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5218373980239792, "overlap_percentage": 0.6857991513437058, "num_intersection": 48486, "num_union": 92914, "num_only_computed": 22214, "num_only_roped": 22214, "total_diff": 44428, "diff_percentage": 0.47816260197602084, "num_computed": 70700, "num_roped": 70700}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 5145, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 5145, 128], "mask_shape": [1, 32, 25, 5145], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:09.284970", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.900859832763672e-06, "l2_diff": 0.0250244140625, "l2_diff_relative": 0.01740828804347826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 5145, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 5145, 128], "attention_shape": [1, 32, 25, 5145]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:35.998571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4980233681806202, "overlap_percentage": 0.6649073422472437, "num_intersection": 51021, "num_union": 102447, "num_only_computed": 25713, "num_only_roped": 25713, "total_diff": 51426, "diff_percentage": 0.5019766318193798, "num_computed": 76734, "num_roped": 76734}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5172, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5172, 128], "mask_shape": [1, 32, 27, 5172], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:36.864339", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.3172626495361328e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.02440767973856209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5172, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5172, 128], "attention_shape": [1, 32, 27, 5172]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:01.773474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5017173051519155, "overlap_percentage": 0.6681914144968332, "num_intersection": 1899, "num_union": 3785, "num_only_computed": 943, "num_only_roped": 943, "total_diff": 1886, "diff_percentage": 0.4982826948480845, "num_computed": 2842, "num_roped": 2842}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5173, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5173, 128], "mask_shape": [1, 32, 1, 5173], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:02.499621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.513429641723633e-06, "l2_diff": 0.0029449462890625, "l2_diff_relative": 0.014568236714975846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5173, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5173, 128], "attention_shape": [1, 32, 1, 5173]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:25.411583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.495528669121515, "overlap_percentage": 0.6626802673232501, "num_intersection": 1884, "num_union": 3802, "num_only_computed": 959, "num_only_roped": 959, "total_diff": 1918, "diff_percentage": 0.5044713308784851, "num_computed": 2843, "num_roped": 2843}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5174, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5174, 128], "mask_shape": [1, 32, 1, 5174], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:28.277702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 7.510185241699219e-06, "l2_diff": 0.006072998046875, "l2_diff_relative": 0.02865783410138249}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5174, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5174, 128], "attention_shape": [1, 32, 1, 5174]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:51.167369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45310503450038336, "overlap_percentage": 0.6236370031656701, "num_intersection": 1773, "num_union": 3913, "num_only_computed": 1070, "num_only_roped": 1070, "total_diff": 2140, "diff_percentage": 0.5468949654996167, "num_computed": 2843, "num_roped": 2843}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5175, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5175, 128], "mask_shape": [1, 32, 1, 5175], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:51.910169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.0059814453125, "l2_diff_relative": 0.023200757575757576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5175, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5175, 128], "attention_shape": [1, 32, 1, 5175]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:06.620223", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:06.633639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.03125, "l2_diff_relative": 0.003067484662576687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:15.056494", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7521678745759683, "overlap_percentage": 0.8585568603213845, "num_intersection": 1111316, "num_union": 1477484, "num_only_computed": 199404, "num_only_roped": 166764, "total_diff": 366168, "diff_percentage": 0.24783212542403166, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:15.438134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.09716796875, "l2_diff_relative": 0.01229001976284585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:31.186716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6244708873511812, "overlap_percentage": 0.7688298906598773, "num_intersection": 1410809, "num_union": 2259207, "num_only_computed": 424199, "num_only_roped": 424199, "total_diff": 848398, "diff_percentage": 0.37552911264881883, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:31.727842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.09716796875, "l2_diff_relative": 0.013344957081545065}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:52.190311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5604181051929807, "overlap_percentage": 0.718292236328125, "num_intersection": 1694664, "num_union": 3023928, "num_only_computed": 664632, "num_only_roped": 664632, "total_diff": 1329264, "diff_percentage": 0.4395818948070192, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:52.925537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.539987564086914e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01997282608695652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:42:19.415948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.530472959955162, "overlap_percentage": 0.6932144165039062, "num_intersection": 1998942, "num_union": 3768226, "num_only_computed": 884642, "num_only_roped": 884642, "total_diff": 1769284, "diff_percentage": 0.4695270400448381, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:42:20.322572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.036592483520508e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.01629901960784314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:42:52.799250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5098507282822322, "overlap_percentage": 0.6753657414362981, "num_intersection": 2301560, "num_union": 4514184, "num_only_computed": 1106312, "num_only_roped": 1106312, "total_diff": 2212624, "diff_percentage": 0.49014927171776784, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:42:53.937044", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 3.039836883544922e-06, "l2_diff": 0.1123046875, "l2_diff_relative": 0.013510338345864662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:43:33.018051", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4982259775412414, "overlap_percentage": 0.665087890625, "num_intersection": 2615232, "num_union": 5249088, "num_only_computed": 1316928, "num_only_roped": 1316928, "total_diff": 2633856, "diff_percentage": 0.5017740224587586, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:43:34.346139", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.9355287551879883e-06, "l2_diff": 0.125, "l2_diff_relative": 0.015037593984962405}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:44:19.707007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4727392989692357, "overlap_percentage": 0.6419863981359145, "num_intersection": 2860979, "num_union": 6051917, "num_only_computed": 1595469, "num_only_roped": 1595469, "total_diff": 3190938, "diff_percentage": 0.5272607010307643, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:44:23.417105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.01773313492063492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:45:16.437543", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4634748041863298, "overlap_percentage": 0.6333895231548109, "num_intersection": 3154746, "num_union": 6806726, "num_only_computed": 1825990, "num_only_roped": 1825990, "total_diff": 3651980, "diff_percentage": 0.5365251958136702, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:45:19.376095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046630859375, "mean_diff": 1.2040138244628906e-05, "l2_diff": 0.291015625, "l2_diff_relative": 0.039797008547008544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:46:18.767430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4637799792731786, "overlap_percentage": 0.6336744399297805, "num_intersection": 3488393, "num_union": 7521655, "num_only_computed": 2016631, "num_only_roped": 2016631, "total_diff": 4033262, "diff_percentage": 0.5362200207268214, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:46:20.785630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 1.233816146850586e-05, "l2_diff": 0.333984375, "l2_diff_relative": 0.049479166666666664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:47:28.278565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46526162096598495, "overlap_percentage": 0.6350560395613961, "num_intersection": 3828951, "num_union": 8229673, "num_only_computed": 2200361, "num_only_roped": 2200361, "total_diff": 4400722, "diff_percentage": 0.5347383790340151, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:47:30.607241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07373046875, "mean_diff": 1.1444091796875e-05, "l2_diff": 0.396484375, "l2_diff_relative": 0.04879807692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:48:41.753059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.472556366127758, "overlap_percentage": 0.6418176947214519, "num_intersection": 450393, "num_union": 953099, "num_only_computed": 251353, "num_only_roped": 251353, "total_diff": 502706, "diff_percentage": 0.527443633872242, "num_computed": 701746, "num_roped": 701746}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 118, "seq_len_k": 11382, "queries_shape": [1, 32, 118, 128], "keys_shape": [1, 8, 11382, 128], "mask_shape": [1, 32, 118, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:48:44.549405", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.291015625, "l2_diff_relative": 0.09266169154228855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 118, "seq_len_k": 11382, "queries_shape": [1, 32, 118, 128], "keys_shape": [1, 8, 11382, 128], "attention_shape": [1, 32, 118, 11382]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:49:49.350043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45116052573665405, "overlap_percentage": 0.6217927207021167, "num_intersection": 96353, "num_union": 213567, "num_only_computed": 58607, "num_only_roped": 58607, "total_diff": 117214, "diff_percentage": 0.5488394742633459, "num_computed": 154960, "num_roped": 154960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11408, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11408, 128], "mask_shape": [1, 32, 26, 11408], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:49:51.448441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.682209014892578e-05, "l2_diff": 0.150390625, "l2_diff_relative": 0.1203125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11408, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11408, 128], "attention_shape": [1, 32, 26, 11408]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:50:49.934697", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48387899912859456, "overlap_percentage": 0.6521812080536913, "num_intersection": 3887, "num_union": 8033, "num_only_computed": 2073, "num_only_roped": 2073, "total_diff": 4146, "diff_percentage": 0.5161210008714054, "num_computed": 5960, "num_roped": 5960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11409, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11409, 128], "mask_shape": [1, 32, 1, 11409], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:50:51.615661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 4.1961669921875e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.2752659574468085}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11409, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11409, 128], "attention_shape": [1, 32, 1, 11409]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:51:44.297730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4253945480631277, "overlap_percentage": 0.5968797181680926, "num_intersection": 3558, "num_union": 8364, "num_only_computed": 2403, "num_only_roped": 2403, "total_diff": 4806, "diff_percentage": 0.5746054519368723, "num_computed": 5961, "num_roped": 5961}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11410, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11410, 128], "mask_shape": [1, 32, 1, 11410], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:51:46.514790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.057373046875, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11410, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11410, 128], "attention_shape": [1, 32, 1, 11410]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:52:38.819876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45549993895739227, "overlap_percentage": 0.6259016943465862, "num_intersection": 3731, "num_union": 8191, "num_only_computed": 2230, "num_only_roped": 2230, "total_diff": 4460, "diff_percentage": 0.5445000610426077, "num_computed": 5961, "num_roped": 5961}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11411, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11411, 128], "mask_shape": [1, 32, 1, 11411], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:52:41.620407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.12731481481481483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11411, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11411, 128], "attention_shape": [1, 32, 1, 11411]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:12.715269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:12.731011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.0030095322327044027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:18.608690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7477579171651323, "overlap_percentage": 0.855676761433869, "num_intersection": 1107588, "num_union": 1481212, "num_only_computed": 203132, "num_only_roped": 170492, "total_diff": 373624, "diff_percentage": 0.25224208283486765, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:21.345252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.361173629760742e-06, "l2_diff": 0.11279296875, "l2_diff_relative": 0.013269761029411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:35.895740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6224521643948014, "overlap_percentage": 0.7672980172293526, "num_intersection": 1407998, "num_union": 2262018, "num_only_computed": 427010, "num_only_roped": 427010, "total_diff": 854020, "diff_percentage": 0.37754783560519856, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:36.435382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 8.106231689453125e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.017168972332015812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:56.559521", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5532874011212024, "overlap_percentage": 0.7124082777235243, "num_intersection": 1680782, "num_union": 3037810, "num_only_computed": 678514, "num_only_roped": 678514, "total_diff": 1357028, "diff_percentage": 0.44671259887879755, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:53:57.282516", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 8.046627044677734e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.022821576763485476}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:54:23.517210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5352842881927113, "overlap_percentage": 0.6973096674138849, "num_intersection": 2010751, "num_union": 3756417, "num_only_computed": 872833, "num_only_roped": 872833, "total_diff": 1745666, "diff_percentage": 0.4647157118072887, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:54:24.423787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.4836273193359375e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017840485074626867}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:54:56.367816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5264677182280215, "overlap_percentage": 0.6897855905386118, "num_intersection": 2350701, "num_union": 4465043, "num_only_computed": 1057171, "num_only_roped": 1057171, "total_diff": 2114342, "diff_percentage": 0.4735322817719785, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:54:59.305056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.2186508178710938e-06, "l2_diff": 0.10986328125, "l2_diff_relative": 0.014408299180327868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:55:37.074026", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5105144932616393, "overlap_percentage": 0.6759478251139323, "num_intersection": 2657935, "num_union": 5206385, "num_only_computed": 1274225, "num_only_roped": 1274225, "total_diff": 2548450, "diff_percentage": 0.48948550673836067, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:55:40.244769", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.01883187772925764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:24.357784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5053751963023378, "overlap_percentage": 0.6714275584501379, "num_intersection": 2992182, "num_union": 5920714, "num_only_computed": 1464266, "num_only_roped": 1464266, "total_diff": 2928532, "diff_percentage": 0.49462480369766215, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:25.871651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.8908252716064453e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01724537037037037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:17.427039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4650445117997339, "overlap_percentage": 0.63485376458419, "num_intersection": 3162039, "num_union": 6799433, "num_only_computed": 1818697, "num_only_roped": 1818697, "total_diff": 3637394, "diff_percentage": 0.5349554882002661, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:19.179948", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0147705078125, "mean_diff": 6.67572021484375e-06, "l2_diff": 0.189453125, "l2_diff_relative": 0.020761986301369863}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:58:18.275106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.461844627439036, "overlap_percentage": 0.6318655468168712, "num_intersection": 3478435, "num_union": 7531613, "num_only_computed": 2026589, "num_only_roped": 2026589, "total_diff": 4053178, "diff_percentage": 0.538155372560964, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:58:20.303929", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.314453125, "l2_diff_relative": 0.03993055555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:59:28.773642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.455933545832126, "overlap_percentage": 0.6263109290081522, "num_intersection": 3776224, "num_union": 8282400, "num_only_computed": 2253088, "num_only_roped": 2253088, "total_diff": 4506176, "diff_percentage": 0.544066454167874, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:59:31.078603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 1.2278556823730469e-05, "l2_diff": 0.37890625, "l2_diff_relative": 0.04928861788617886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:00:46.931357", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4566692249953379, "overlap_percentage": 0.6270046997070312, "num_intersection": 4109138, "num_union": 8998062, "num_only_computed": 2444462, "num_only_roped": 2444462, "total_diff": 4888924, "diff_percentage": 0.5433307750046621, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:00:49.498056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 1.1742115020751953e-05, "l2_diff": 0.416015625, "l2_diff_relative": 0.0545594262295082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:02:12.635080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45256498858688204, "overlap_percentage": 0.6231252882215712, "num_intersection": 4410411, "num_union": 9745365, "num_only_computed": 2667477, "num_only_roped": 2667477, "total_diff": 5334954, "diff_percentage": 0.5474350114131179, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:02:15.530292", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07470703125, "mean_diff": 9.59634780883789e-06, "l2_diff": 0.353515625, "l2_diff_relative": 0.040692446043165464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:03:50.406826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4494511333941895, "overlap_percentage": 0.6201673489215284, "num_intersection": 4142752, "num_union": 9217358, "num_only_computed": 2537303, "num_only_roped": 2537303, "total_diff": 5074606, "diff_percentage": 0.5505488666058105, "num_computed": 6680055, "num_roped": 6680055}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 907, "seq_len_k": 14219, "queries_shape": [1, 32, 907, 128], "keys_shape": [1, 8, 14219, 128], "mask_shape": [1, 32, 907, 14219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:03:53.500020", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 1.2934207916259766e-05, "l2_diff": 0.51171875, "l2_diff_relative": 0.06396484375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 907, "seq_len_k": 14219, "queries_shape": [1, 32, 907, 128], "keys_shape": [1, 8, 14219, 128], "attention_shape": [1, 32, 907, 14219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:05:24.734925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4604238234587274, "overlap_percentage": 0.6305345284881807, "num_intersection": 130276, "num_union": 282948, "num_only_computed": 76336, "num_only_roped": 76336, "total_diff": 152672, "diff_percentage": 0.5395761765412727, "num_computed": 206612, "num_roped": 206612}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14247, 128], "mask_shape": [1, 32, 28, 14247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:05:27.544949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.2001953125, "l2_diff_relative": 0.14985380116959066}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14247, 128], "attention_shape": [1, 32, 28, 14247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:06:45.858337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4834170854271357, "overlap_percentage": 0.6517615176151762, "num_intersection": 4810, "num_union": 9950, "num_only_computed": 2570, "num_only_roped": 2570, "total_diff": 5140, "diff_percentage": 0.5165829145728643, "num_computed": 7380, "num_roped": 7380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14248, 128], "mask_shape": [1, 32, 1, 14248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:06:48.068497", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.1871584699453552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14248, 128], "attention_shape": [1, 32, 1, 14248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:07:56.828514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47085201793721976, "overlap_percentage": 0.6402439024390244, "num_intersection": 4725, "num_union": 10035, "num_only_computed": 2655, "num_only_roped": 2655, "total_diff": 5310, "diff_percentage": 0.5291479820627802, "num_computed": 7380, "num_roped": 7380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14249, 128], "mask_shape": [1, 32, 1, 14249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:07:59.040522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.18531976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14249, 128], "attention_shape": [1, 32, 1, 14249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:09:09.707525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4615841584158416, "overlap_percentage": 0.6316217314727002, "num_intersection": 4662, "num_union": 10100, "num_only_computed": 2719, "num_only_roped": 2719, "total_diff": 5438, "diff_percentage": 0.5384158415841584, "num_computed": 7381, "num_roped": 7381}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14250, 128], "mask_shape": [1, 32, 1, 14250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:09:12.003039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.17733990147783252}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14250, 128], "attention_shape": [1, 32, 1, 14250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:10:23.196972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4529527559055118, "overlap_percentage": 0.6234927516596667, "num_intersection": 4602, "num_union": 10160, "num_only_computed": 2779, "num_only_roped": 2779, "total_diff": 5558, "diff_percentage": 0.5470472440944882, "num_computed": 7381, "num_roped": 7381}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14251, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14251, 128], "mask_shape": [1, 32, 1, 14251], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:10:27.720950", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.1871584699453552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14251, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14251, 128], "attention_shape": [1, 32, 1, 14251]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:11:38.290596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4367458154924095, "overlap_percentage": 0.6079653210512056, "num_intersection": 4488, "num_union": 10276, "num_only_computed": 2894, "num_only_roped": 2894, "total_diff": 5788, "diff_percentage": 0.5632541845075905, "num_computed": 7382, "num_roped": 7382}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14252, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14252, 128], "mask_shape": [1, 32, 1, 14252], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:11:40.558211", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020751953125, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14252, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14252, 128], "attention_shape": [1, 32, 1, 14252]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:12:50.415867", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4487292709253263, "overlap_percentage": 0.6194798157680845, "num_intersection": 4573, "num_union": 10191, "num_only_computed": 2809, "num_only_roped": 2809, "total_diff": 5618, "diff_percentage": 0.5512707290746738, "num_computed": 7382, "num_roped": 7382}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14253, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14253, 128], "mask_shape": [1, 32, 1, 14253], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:12:52.619585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.037841796875, "l2_diff_relative": 0.16847826086956522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14253, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14253, 128], "attention_shape": [1, 32, 1, 14253]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:31.528663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:31.539139", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.00311279296875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:37.506119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7530197742905782, "overlap_percentage": 0.8591115574783683, "num_intersection": 1112034, "num_union": 1476766, "num_only_computed": 198686, "num_only_roped": 166046, "total_diff": 364732, "diff_percentage": 0.2469802257094218, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:39.970322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 7.808208465576172e-06, "l2_diff": 0.1083984375, "l2_diff_relative": 0.01171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:54.745781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6278545547127514, "overlap_percentage": 0.7713890075683594, "num_intersection": 1415505, "num_union": 2254511, "num_only_computed": 419503, "num_only_roped": 419503, "total_diff": 839006, "diff_percentage": 0.3721454452872485, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:55.301975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 8.404254913330078e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.016666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:15.797870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5622376594404859, "overlap_percentage": 0.7197850545247396, "num_intersection": 1698186, "num_union": 3020406, "num_only_computed": 661110, "num_only_roped": 661110, "total_diff": 1322220, "diff_percentage": 0.4377623405595142, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:16.532501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.017563868613138685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:42.945399", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5298424655662839, "overlap_percentage": 0.6926758506081321, "num_intersection": 1997389, "num_union": 3769779, "num_only_computed": 886195, "num_only_roped": 886195, "total_diff": 1772390, "diff_percentage": 0.47015753443371616, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:43.905322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.705522537231445e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.02214566929133858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:16.157443", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5049450208538543, "overlap_percentage": 0.6710477975698618, "num_intersection": 2286845, "num_union": 4528899, "num_only_computed": 1121027, "num_only_roped": 1121027, "total_diff": 2242054, "diff_percentage": 0.49505497914614566, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:17.895995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.197265625, "l2_diff_relative": 0.02355410447761194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:55.812514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4864737152089711, "overlap_percentage": 0.6545338948567708, "num_intersection": 2573732, "num_union": 5290588, "num_only_computed": 1358428, "num_only_roped": 1358428, "total_diff": 2716856, "diff_percentage": 0.5135262847910289, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:59.551501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.0531158447265625e-06, "l2_diff": 0.1708984375, "l2_diff_relative": 0.019121503496503496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:16:43.895180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47970171866878086, "overlap_percentage": 0.6483762404497933, "num_intersection": 2889455, "num_union": 6023441, "num_only_computed": 1566993, "num_only_roped": 1566993, "total_diff": 3133986, "diff_percentage": 0.5202982813312191, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:16:45.418036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 3.904104232788086e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.022286821705426358}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:17:37.212982", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47080079765864213, "overlap_percentage": 0.6401965492650082, "num_intersection": 3188650, "num_union": 6772822, "num_only_computed": 1792086, "num_only_roped": 1792086, "total_diff": 3584172, "diff_percentage": 0.5291992023413579, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:17:38.976580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 1.4722347259521484e-05, "l2_diff": 0.32421875, "l2_diff_relative": 0.04304979253112033}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:18:31.391475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48351552534272013, "overlap_percentage": 0.651850981109239, "num_intersection": 149723, "num_union": 309655, "num_only_computed": 79966, "num_only_roped": 79966, "total_diff": 159932, "diff_percentage": 0.5164844746572799, "num_computed": 229689, "num_roped": 229689}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 9263, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 9263, 128], "mask_shape": [1, 32, 47, 9263], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:18:33.026090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.039794921875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.1689453125, "l2_diff_relative": 0.10446859903381643}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 9263, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 9263, 128], "attention_shape": [1, 32, 47, 9263]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:19:23.470567", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4548979987549623, "overlap_percentage": 0.6253331836929379, "num_intersection": 178300, "num_union": 391956, "num_only_computed": 106828, "num_only_roped": 106828, "total_diff": 213656, "diff_percentage": 0.5451020012450377, "num_computed": 285128, "num_roped": 285128}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9321, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9321, 128], "mask_shape": [1, 32, 58, 9321], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:19:26.740507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.11083984375, "l2_diff_relative": 0.05814549180327869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9321, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9321, 128], "attention_shape": [1, 32, 58, 9321]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:20:13.086488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4642644431209053, "overlap_percentage": 0.6341264998983119, "num_intersection": 3118, "num_union": 6716, "num_only_computed": 1799, "num_only_roped": 1799, "total_diff": 3598, "diff_percentage": 0.5357355568790947, "num_computed": 4917, "num_roped": 4917}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9322, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9322, 128], "mask_shape": [1, 32, 1, 9322], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:20:14.480785", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.0218505859375, "l2_diff_relative": 0.11474358974358974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9322, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9322, 128], "attention_shape": [1, 32, 1, 9322]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:20:56.782862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4668854415274463, "overlap_percentage": 0.6365670124059386, "num_intersection": 3130, "num_union": 6704, "num_only_computed": 1787, "num_only_roped": 1787, "total_diff": 3574, "diff_percentage": 0.5331145584725537, "num_computed": 4917, "num_roped": 4917}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9323, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9323, 128], "mask_shape": [1, 32, 1, 9323], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:20:58.132106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.021240234375, "l2_diff_relative": 0.12219101123595505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9323, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9323, 128], "attention_shape": [1, 32, 1, 9323]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:21:40.483468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44371055335388226, "overlap_percentage": 0.6146807645384302, "num_intersection": 3023, "num_union": 6813, "num_only_computed": 1895, "num_only_roped": 1895, "total_diff": 3790, "diff_percentage": 0.5562894466461177, "num_computed": 4918, "num_roped": 4918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9324, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9324, 128], "mask_shape": [1, 32, 1, 9324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:21:42.678517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005126953125, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.01312255859375, "l2_diff_relative": 0.057920258620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9324, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9324, 128], "attention_shape": [1, 32, 1, 9324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:22:26.113804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4621673851642634, "overlap_percentage": 0.6321675477836519, "num_intersection": 3109, "num_union": 6727, "num_only_computed": 1809, "num_only_roped": 1809, "total_diff": 3618, "diff_percentage": 0.5378326148357366, "num_computed": 4918, "num_roped": 4918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9325, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9325, 128], "mask_shape": [1, 32, 1, 9325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:22:27.432231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00537109375, "mean_diff": 1.4424324035644531e-05, "l2_diff": 0.01361083984375, "l2_diff_relative": 0.06832107843137254}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9325, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9325, 128], "attention_shape": [1, 32, 1, 9325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:08.943586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4523176852671981, "overlap_percentage": 0.622890831469811, "num_intersection": 3064, "num_union": 6774, "num_only_computed": 1855, "num_only_roped": 1855, "total_diff": 3710, "diff_percentage": 0.5476823147328019, "num_computed": 4919, "num_roped": 4919}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9326, 128], "mask_shape": [1, 32, 1, 9326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:10.279124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0047607421875, "mean_diff": 1.2636184692382812e-05, "l2_diff": 0.01129150390625, "l2_diff_relative": 0.05724009900990099}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9326, 128], "attention_shape": [1, 32, 1, 9326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:35.983457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:35.997120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.5762786865234375e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.003125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:41.866689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7454894591666178, "overlap_percentage": 0.854189585908529, "num_intersection": 1105663, "num_union": 1483137, "num_only_computed": 205057, "num_only_roped": 172417, "total_diff": 377474, "diff_percentage": 0.2545105408333822, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:42.247242", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.1533203125, "l2_diff_relative": 0.020528242677824268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:57.170326", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6194281105018793, "overlap_percentage": 0.7649961199079242, "num_intersection": 1403774, "num_union": 2266242, "num_only_computed": 431234, "num_only_roped": 431234, "total_diff": 862468, "diff_percentage": 0.38057188949812065, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:57.710965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.1591796875, "l2_diff_relative": 0.022841928251121076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:24:17.720429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5605223489165354, "overlap_percentage": 0.7183778550889757, "num_intersection": 1694866, "num_union": 3023726, "num_only_computed": 664430, "num_only_roped": 664430, "total_diff": 1328860, "diff_percentage": 0.4394776510834646, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:24:18.428702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.049041748046875e-05, "l2_diff": 0.1904296875, "l2_diff_relative": 0.026726973684210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:24:44.410915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5241522331866486, "overlap_percentage": 0.6877951188520952, "num_intersection": 1983315, "num_union": 3783853, "num_only_computed": 900269, "num_only_roped": 900269, "total_diff": 1800538, "diff_percentage": 0.4758477668133514, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:24:45.314186", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.119510650634766e-06, "l2_diff": 0.203125, "l2_diff_relative": 0.02850877192982456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:25:17.411680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5039992303189035, "overlap_percentage": 0.6702120854304388, "num_intersection": 2283997, "num_union": 4531747, "num_only_computed": 1123875, "num_only_roped": 1123875, "total_diff": 2247750, "diff_percentage": 0.4960007696810965, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:25:18.526997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.844499588012695e-06, "l2_diff": 0.125, "l2_diff_relative": 0.016260162601626018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:25:59.257371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49095481874090346, "overlap_percentage": 0.6585777282714844, "num_intersection": 2589633, "num_union": 5274687, "num_only_computed": 1342527, "num_only_roped": 1342527, "total_diff": 2685054, "diff_percentage": 0.5090451812590965, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:26:00.630096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.112720489501953e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.021265560165975105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:26:47.599459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4778806946866477, "overlap_percentage": 0.6467107885024127, "num_intersection": 2882033, "num_union": 6030863, "num_only_computed": 1574415, "num_only_roped": 1574415, "total_diff": 3148830, "diff_percentage": 0.5221193053133524, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:26:50.392404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.0994415283203125e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.018208661417322834}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:27:44.414807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47026547063386825, "overlap_percentage": 0.6397014417146382, "num_intersection": 3186184, "num_union": 6775288, "num_only_computed": 1794552, "num_only_roped": 1794552, "total_diff": 3589104, "diff_percentage": 0.5297345293661317, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:27:46.275080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056884765625, "mean_diff": 1.3768672943115234e-05, "l2_diff": 0.298828125, "l2_diff_relative": 0.0412176724137931}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:28:45.973055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4607728476282579, "overlap_percentage": 0.6308617364792597, "num_intersection": 3472909, "num_union": 7537139, "num_only_computed": 2032115, "num_only_roped": 2032115, "total_diff": 4064230, "diff_percentage": 0.5392271523717421, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:28:48.018216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.1742115020751953e-05, "l2_diff": 0.2578125, "l2_diff_relative": 0.038551401869158876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:29:57.717937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4594191018610443, "overlap_percentage": 0.6295917345129926, "num_intersection": 3796005, "num_union": 8262619, "num_only_computed": 2233307, "num_only_roped": 2233307, "total_diff": 4466614, "diff_percentage": 0.5405808981389557, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:30:01.327656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 1.4603137969970703e-05, "l2_diff": 0.39453125, "l2_diff_relative": 0.0505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:31:17.132333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45052396570543113, "overlap_percentage": 0.6211878967285156, "num_intersection": 4071017, "num_union": 9036183, "num_only_computed": 2482583, "num_only_roped": 2482583, "total_diff": 4965166, "diff_percentage": 0.5494760342945688, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:31:19.702878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.43359375, "l2_diff_relative": 0.052161654135338346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:32:44.829380", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4451463050027702, "overlap_percentage": 0.6160570780436198, "num_intersection": 4360383, "num_union": 9795393, "num_only_computed": 2717505, "num_only_roped": 2717505, "total_diff": 5435010, "diff_percentage": 0.5548536949972298, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:32:48.462265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 1.436471939086914e-05, "l2_diff": 0.56640625, "l2_diff_relative": 0.07647679324894514}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:34:19.618986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4426507876279144, "overlap_percentage": 0.6136631143504175, "num_intersection": 4665175, "num_union": 10539177, "num_only_computed": 2937001, "num_only_roped": 2937001, "total_diff": 5874002, "diff_percentage": 0.5573492123720856, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:34:24.791805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 1.537799835205078e-05, "l2_diff": 0.65625, "l2_diff_relative": 0.08786610878661087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:04.605466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4326408563339481, "overlap_percentage": 0.6039767111501386, "num_intersection": 4908195, "num_union": 11344733, "num_only_computed": 3218269, "num_only_roped": 3218269, "total_diff": 6436538, "diff_percentage": 0.5673591436660519, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:07.948890", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056884765625, "mean_diff": 1.4603137969970703e-05, "l2_diff": 0.58203125, "l2_diff_relative": 0.08028017241379311}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:55.958173", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4323874683853624, "overlap_percentage": 0.6037297559895086, "num_intersection": 4796971, "num_union": 11094149, "num_only_computed": 3148589, "num_only_roped": 3148589, "total_diff": 6297178, "diff_percentage": 0.5676125316146375, "num_computed": 7945560, "num_roped": 7945560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 945, "seq_len_k": 16305, "queries_shape": [1, 32, 945, 128], "keys_shape": [1, 8, 16305, 128], "mask_shape": [1, 32, 945, 16305], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:59.531022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.08442982456140351}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 945, "seq_len_k": 16305, "queries_shape": [1, 32, 945, 128], "keys_shape": [1, 8, 16305, 128], "attention_shape": [1, 32, 945, 16305]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:39:48.984203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43488744697046317, "overlap_percentage": 0.6061624525166192, "num_intersection": 163402, "num_union": 375734, "num_only_computed": 106166, "num_only_roped": 106166, "total_diff": 212332, "diff_percentage": 0.5651125530295369, "num_computed": 269568, "num_roped": 269568}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16337, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16337, 128], "mask_shape": [1, 32, 32, 16337], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:39:52.320037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.107421875, "l2_diff_relative": 0.07902298850574713}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16337, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16337, 128], "attention_shape": [1, 32, 32, 16337]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:41:24.081860", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4402940422258313, "overlap_percentage": 0.6113946587537092, "num_intersection": 5151, "num_union": 11699, "num_only_computed": 3274, "num_only_roped": 3274, "total_diff": 6548, "diff_percentage": 0.5597059577741688, "num_computed": 8425, "num_roped": 8425}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16338, 128], "mask_shape": [1, 32, 1, 16338], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:41:26.661051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.10998062015503876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16338, 128], "attention_shape": [1, 32, 1, 16338]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:42:46.912969", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45534634651926065, "overlap_percentage": 0.6257566765578635, "num_intersection": 5272, "num_union": 11578, "num_only_computed": 3153, "num_only_roped": 3153, "total_diff": 6306, "diff_percentage": 0.5446536534807394, "num_computed": 8425, "num_roped": 8425}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16339, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16339, 128], "mask_shape": [1, 32, 1, 16339], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:42:49.508832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.2040138244628906e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.09203296703296704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16339, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16339, 128], "attention_shape": [1, 32, 1, 16339]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:43:33.315977", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:43:33.327533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:43:39.243031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7567288796238993, "overlap_percentage": 0.8615203955500618, "num_intersection": 1115152, "num_union": 1473648, "num_only_computed": 195568, "num_only_roped": 162928, "total_diff": 358496, "diff_percentage": 0.24327112037610066, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:43:39.625177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 6.3478946685791016e-06, "l2_diff": 0.08642578125, "l2_diff_relative": 0.010243055555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:43:54.445978", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6374906078945443, "overlap_percentage": 0.7786189488002232, "num_intersection": 1428772, "num_union": 2241244, "num_only_computed": 406236, "num_only_roped": 406236, "total_diff": 812472, "diff_percentage": 0.36250939210545574, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:43:54.997417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.11083984375, "l2_diff_relative": 0.013641826923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:44:16.070588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5750606846348374, "overlap_percentage": 0.7302076551649306, "num_intersection": 1722776, "num_union": 2995816, "num_only_computed": 636520, "num_only_roped": 636520, "total_diff": 1273040, "diff_percentage": 0.4249393153651626, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:44:16.807177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.015088263358778626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:44:45.973624", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5426740098699372, "overlap_percentage": 0.7035498185591265, "num_intersection": 2028745, "num_union": 3738423, "num_only_computed": 854839, "num_only_roped": 854839, "total_diff": 1709678, "diff_percentage": 0.45732599013006286, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:44:48.357961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.808208465576172e-06, "l2_diff": 0.173828125, "l2_diff_relative": 0.02377136752136752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:45:20.781517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5173433561307004, "overlap_percentage": 0.6819067734938401, "num_intersection": 2323851, "num_union": 4491893, "num_only_computed": 1084021, "num_only_roped": 1084021, "total_diff": 2168042, "diff_percentage": 0.48265664386929963, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:45:21.882829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 5.811452865600586e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.021460843373493976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:46:00.396745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5035506172546825, "overlap_percentage": 0.6698153177897136, "num_intersection": 2633821, "num_union": 5230499, "num_only_computed": 1298339, "num_only_roped": 1298339, "total_diff": 2596678, "diff_percentage": 0.4964493827453174, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:46:01.690815", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.602836608886719e-06, "l2_diff": 0.1875, "l2_diff_relative": 0.025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:46:46.077035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48843845736992714, "overlap_percentage": 0.656309913186466, "num_intersection": 2924811, "num_union": 5988085, "num_only_computed": 1531637, "num_only_roped": 1531637, "total_diff": 3063274, "diff_percentage": 0.5115615426300729, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:46:47.564993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.01875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:47:38.461530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4887039608618382, "overlap_percentage": 0.6565495541221217, "num_intersection": 3270100, "num_union": 6691372, "num_only_computed": 1710636, "num_only_roped": 1710636, "total_diff": 3421272, "diff_percentage": 0.5112960391381618, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:47:40.199338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 1.2278556823730469e-05, "l2_diff": 0.31640625, "l2_diff_relative": 0.04066265060240964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:48:35.402180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.483812161124974, "overlap_percentage": 0.652120495842499, "num_intersection": 1646496, "num_union": 3403172, "num_only_computed": 878338, "num_only_roped": 878338, "total_diff": 1756676, "diff_percentage": 0.516187838875026, "num_computed": 2524834, "num_roped": 2524834}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 494, "seq_len_k": 9710, "queries_shape": [1, 32, 494, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 494, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:48:37.200070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.36328125, "l2_diff_relative": 0.06567796610169492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 494, "seq_len_k": 9710, "queries_shape": [1, 32, 494, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 494, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:49:31.557578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49491166851070556, "overlap_percentage": 0.6621283102348884, "num_intersection": 81410, "num_union": 164494, "num_only_computed": 41542, "num_only_roped": 41542, "total_diff": 83084, "diff_percentage": 0.5050883314892944, "num_computed": 122952, "num_roped": 122952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9734, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9734, 128], "mask_shape": [1, 32, 24, 9734], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:49:33.273716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.051513671875, "l2_diff_relative": 0.04309640522875817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9734, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9734, 128], "attention_shape": [1, 32, 24, 9734]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:50:21.472428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5244755244755245, "overlap_percentage": 0.6880733944954128, "num_intersection": 3525, "num_union": 6721, "num_only_computed": 1598, "num_only_roped": 1598, "total_diff": 3196, "diff_percentage": 0.4755244755244755, "num_computed": 5123, "num_roped": 5123}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9735, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9735, 128], "mask_shape": [1, 32, 1, 9735], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:50:22.850144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0035400390625, "mean_diff": 8.821487426757812e-06, "l2_diff": 0.007537841796875, "l2_diff_relative": 0.031895661157024795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9735, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9735, 128], "attention_shape": [1, 32, 1, 9735]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:06.262569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4755939524838013, "overlap_percentage": 0.6446135831381733, "num_intersection": 3303, "num_union": 6945, "num_only_computed": 1821, "num_only_roped": 1821, "total_diff": 3642, "diff_percentage": 0.5244060475161987, "num_computed": 5124, "num_roped": 5124}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9736, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9736, 128], "mask_shape": [1, 32, 1, 9736], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:07.666112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 9.119510650634766e-06, "l2_diff": 0.00848388671875, "l2_diff_relative": 0.03147644927536232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9736, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9736, 128], "attention_shape": [1, 32, 1, 9736]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:31.194301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:31.201609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.003034099842767296}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:37.042972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7523517104179231, "overlap_percentage": 0.8586766069221261, "num_intersection": 1111471, "num_union": 1477329, "num_only_computed": 199249, "num_only_roped": 166609, "total_diff": 365858, "diff_percentage": 0.24764828958207685, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:37.425001", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 5.662441253662109e-06, "l2_diff": 0.078125, "l2_diff_relative": 0.009124087591240875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:51.988428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6302900348845009, "overlap_percentage": 0.7732244219098773, "num_intersection": 1418873, "num_union": 2251143, "num_only_computed": 416135, "num_only_roped": 416135, "total_diff": 832270, "diff_percentage": 0.3697099651154991, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:52.530510", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.152557373046875e-06, "l2_diff": 0.10693359375, "l2_diff_relative": 0.015413851351351352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:08.997821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5536512211544348, "overlap_percentage": 0.7127097943424474, "num_intersection": 54270, "num_union": 98022, "num_only_computed": 21876, "num_only_roped": 21876, "total_diff": 43752, "diff_percentage": 0.4463487788455653, "num_computed": 76146, "num_roped": 76146}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 42, "seq_len_k": 3114, "queries_shape": [1, 32, 42, 128], "keys_shape": [1, 8, 3114, 128], "mask_shape": [1, 32, 42, 3114], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:11.152347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 7.241964340209961e-06, "l2_diff": 0.021728515625, "l2_diff_relative": 0.014046717171717172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 42, "seq_len_k": 3114, "queries_shape": [1, 32, 42, 128], "keys_shape": [1, 8, 3114, 128], "attention_shape": [1, 32, 42, 3114]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:27.016415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5437090507080264, "overlap_percentage": 0.7044190749010026, "num_intersection": 33443, "num_union": 61509, "num_only_computed": 14033, "num_only_roped": 14033, "total_diff": 28066, "diff_percentage": 0.45629094929197356, "num_computed": 47476, "num_roped": 47476}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3140, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3140, 128], "mask_shape": [1, 32, 26, 3140], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:27.536353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.019886363636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3140, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3140, 128], "attention_shape": [1, 32, 26, 3140]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:42.572605", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5396290050590219, "overlap_percentage": 0.7009857612267251, "num_intersection": 1280, "num_union": 2372, "num_only_computed": 546, "num_only_roped": 546, "total_diff": 1092, "diff_percentage": 0.46037099494097805, "num_computed": 1826, "num_roped": 1826}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3141, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3141, 128], "mask_shape": [1, 32, 1, 3141], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:43.030217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.00823974609375, "l2_diff_relative": 0.03716960352422907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3141, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3141, 128], "attention_shape": [1, 32, 1, 3141]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:57.055866", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5404721753794266, "overlap_percentage": 0.7016967706622879, "num_intersection": 1282, "num_union": 2372, "num_only_computed": 545, "num_only_roped": 545, "total_diff": 1090, "diff_percentage": 0.45952782462057334, "num_computed": 1827, "num_roped": 1827}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3142, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3142, 128], "mask_shape": [1, 32, 1, 3142], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:57.513058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00244140625, "mean_diff": 1.3709068298339844e-05, "l2_diff": 0.004608154296875, "l2_diff_relative": 0.022686298076923076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3142, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3142, 128], "attention_shape": [1, 32, 1, 3142]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:11.532966", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5385263157894736, "overlap_percentage": 0.7000547345374931, "num_intersection": 1279, "num_union": 2375, "num_only_computed": 548, "num_only_roped": 548, "total_diff": 1096, "diff_percentage": 0.4614736842105263, "num_computed": 1827, "num_roped": 1827}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3143, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3143, 128], "mask_shape": [1, 32, 1, 3143], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:11.988269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00244140625, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.004058837890625, "l2_diff_relative": 0.019791666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3143, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3143, 128], "attention_shape": [1, 32, 1, 3143]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:26.045542", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.540016849199663, "overlap_percentage": 0.7013129102844639, "num_intersection": 1282, "num_union": 2374, "num_only_computed": 546, "num_only_roped": 546, "total_diff": 1092, "diff_percentage": 0.45998315080033697, "num_computed": 1828, "num_roped": 1828}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3144, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3144, 128], "mask_shape": [1, 32, 1, 3144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:26.502476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00244140625, "mean_diff": 1.0311603546142578e-05, "l2_diff": 0.003204345703125, "l2_diff_relative": 0.017179319371727748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3144, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3144, 128], "attention_shape": [1, 32, 1, 3144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:40.510327", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5195344970906068, "overlap_percentage": 0.6838074398249453, "num_intersection": 1250, "num_union": 2406, "num_only_computed": 578, "num_only_roped": 578, "total_diff": 1156, "diff_percentage": 0.48046550290939316, "num_computed": 1828, "num_roped": 1828}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3145, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3145, 128], "mask_shape": [1, 32, 1, 3145], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:40.964562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 7.271766662597656e-06, "l2_diff": 0.0030975341796875, "l2_diff_relative": 0.01219951923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3145, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3145, 128], "attention_shape": [1, 32, 1, 3145]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:52.577729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:52.591386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0030955188679245285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:58.450728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7496987298328094, "overlap_percentage": 0.8569460754017305, "num_intersection": 1109231, "num_union": 1479569, "num_only_computed": 201489, "num_only_roped": 168849, "total_diff": 370338, "diff_percentage": 0.25030127016719056, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:54:01.071356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.134765625, "l2_diff_relative": 0.017045454545454544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:54:15.556418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6248340861255712, "overlap_percentage": 0.7691050938197544, "num_intersection": 1411314, "num_union": 2258702, "num_only_computed": 423694, "num_only_roped": 423694, "total_diff": 847388, "diff_percentage": 0.37516591387442877, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:54:16.094414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.049041748046875e-05, "l2_diff": 0.1533203125, "l2_diff_relative": 0.020877659574468084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:54:36.639580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5619004997586938, "overlap_percentage": 0.7195087009006076, "num_intersection": 1697534, "num_union": 3021058, "num_only_computed": 661762, "num_only_roped": 661762, "total_diff": 1323524, "diff_percentage": 0.4380995002413062, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:54:37.361640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 8.463859558105469e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.022228033472803346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:55:03.397150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5304485912162717, "overlap_percentage": 0.6931936090642755, "num_intersection": 1998882, "num_union": 3768286, "num_only_computed": 884702, "num_only_roped": 884702, "total_diff": 1769404, "diff_percentage": 0.4695514087837282, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:55:04.306643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.258487701416016e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.021219135802469136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:55:36.336985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5124832263615134, "overlap_percentage": 0.6776712857759916, "num_intersection": 2309417, "num_union": 4506327, "num_only_computed": 1098455, "num_only_roped": 1098455, "total_diff": 2196910, "diff_percentage": 0.4875167736384865, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:55:38.166804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.181640625, "l2_diff_relative": 0.023065476190476192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:56:16.330677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5037288625606826, "overlap_percentage": 0.6699729919433594, "num_intersection": 2634441, "num_union": 5229879, "num_only_computed": 1297719, "num_only_roped": 1297719, "total_diff": 2595438, "diff_percentage": 0.49627113743931744, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:56:19.092965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.1728515625, "l2_diff_relative": 0.022125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:57:04.029071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.486104849230211, "overlap_percentage": 0.6541999368106618, "num_intersection": 2915408, "num_union": 5997488, "num_only_computed": 1541040, "num_only_roped": 1541040, "total_diff": 3082080, "diff_percentage": 0.513895150769789, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:57:05.574766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.2197265625, "l2_diff_relative": 0.028237951807228916}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:57:57.728440", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4848067539780904, "overlap_percentage": 0.6530233684339022, "num_intersection": 3252537, "num_union": 6708935, "num_only_computed": 1728199, "num_only_roped": 1728199, "total_diff": 3456398, "diff_percentage": 0.5151932460219096, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:57:59.503743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.3589859008789062e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.036290322580645164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:58:59.048847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47341304003664647, "overlap_percentage": 0.6426073710123698, "num_intersection": 3537569, "num_union": 7472479, "num_only_computed": 1967455, "num_only_roped": 1967455, "total_diff": 3934910, "diff_percentage": 0.5265869599633535, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:59:01.071867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.4960765838623047e-05, "l2_diff": 0.298828125, "l2_diff_relative": 0.04406682027649769}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:00:10.809419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4606832707727775, "overlap_percentage": 0.6307777736497961, "num_intersection": 3803156, "num_union": 8255468, "num_only_computed": 2226156, "num_only_roped": 2226156, "total_diff": 4452312, "diff_percentage": 0.5393167292272225, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:00:14.778205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.046807359307359304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:01:29.514535", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4530936831465988, "overlap_percentage": 0.6236262512207031, "num_intersection": 4086997, "num_union": 9020203, "num_only_computed": 2466603, "num_only_roped": 2466603, "total_diff": 4933206, "diff_percentage": 0.5469063168534012, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:01:32.053269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 1.341104507446289e-05, "l2_diff": 0.404296875, "l2_diff_relative": 0.049005681818181816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:02:54.583145", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4578924922189061, "overlap_percentage": 0.6281567326298466, "num_intersection": 4446023, "num_union": 9709753, "num_only_computed": 2631865, "num_only_roped": 2631865, "total_diff": 5263730, "diff_percentage": 0.542107507781094, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:02:57.371842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.36328125, "l2_diff_relative": 0.042119565217391304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:04:27.822175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4489231626313795, "overlap_percentage": 0.6196645539382408, "num_intersection": 4710799, "num_union": 10493553, "num_only_computed": 2891377, "num_only_roped": 2891377, "total_diff": 5782754, "diff_percentage": 0.5510768373686206, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:04:30.843237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 6.288290023803711e-06, "l2_diff": 0.265625, "l2_diff_relative": 0.03148148148148148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:06:09.362797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4479950707545573, "overlap_percentage": 0.6187798284715221, "num_intersection": 5028492, "num_union": 11224436, "num_only_computed": 3097972, "num_only_roped": 3097972, "total_diff": 6195944, "diff_percentage": 0.5520049292454428, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:06:14.665523", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 8.702278137207031e-06, "l2_diff": 0.408203125, "l2_diff_relative": 0.051630434782608696}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:07:59.648620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4471522005450983, "overlap_percentage": 0.6179753592976186, "num_intersection": 4370145, "num_union": 9773283, "num_only_computed": 2701569, "num_only_roped": 2701569, "total_diff": 5403138, "diff_percentage": 0.5528477994549017, "num_computed": 7071714, "num_roped": 7071714}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 846, "seq_len_k": 16206, "queries_shape": [1, 32, 846, 128], "keys_shape": [1, 8, 16206, 128], "mask_shape": [1, 32, 846, 16206], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:08:05.518866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.0858739837398374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 846, "seq_len_k": 16206, "queries_shape": [1, 32, 846, 128], "keys_shape": [1, 8, 16206, 128], "attention_shape": [1, 32, 846, 16206]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:09:49.312848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4271998545644603, "overlap_percentage": 0.5986545657192899, "num_intersection": 150394, "num_union": 352046, "num_only_computed": 100826, "num_only_roped": 100826, "total_diff": 201652, "diff_percentage": 0.5728001454355397, "num_computed": 251220, "num_roped": 251220}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16236, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16236, 128], "mask_shape": [1, 32, 30, 16236], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:09:52.541403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.09423828125, "l2_diff_relative": 0.075390625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16236, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16236, 128], "attention_shape": [1, 32, 30, 16236]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:11:21.513648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4319425444596443, "overlap_percentage": 0.6032959159302603, "num_intersection": 5052, "num_union": 11696, "num_only_computed": 3322, "num_only_roped": 3322, "total_diff": 6644, "diff_percentage": 0.5680574555403557, "num_computed": 8374, "num_roped": 8374}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16237, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16237, 128], "mask_shape": [1, 32, 1, 16237], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:11:24.054360", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.22487437185929648}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16237, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16237, 128], "attention_shape": [1, 32, 1, 16237]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:12:43.060157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44620963564151267, "overlap_percentage": 0.6170746268656716, "num_intersection": 5168, "num_union": 11582, "num_only_computed": 3207, "num_only_roped": 3207, "total_diff": 6414, "diff_percentage": 0.5537903643584873, "num_computed": 8375, "num_roped": 8375}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16238, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16238, 128], "mask_shape": [1, 32, 1, 16238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:12:45.652066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033935546875, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.23067010309278352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16238, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16238, 128], "attention_shape": [1, 32, 1, 16238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:05.382393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.462754344598725, "overlap_percentage": 0.6327164179104477, "num_intersection": 5299, "num_union": 11451, "num_only_computed": 3076, "num_only_roped": 3076, "total_diff": 6152, "diff_percentage": 0.537245655401275, "num_computed": 8375, "num_roped": 8375}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16239, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16239, 128], "mask_shape": [1, 32, 1, 16239], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:07.947459", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.0233154296875, "l2_diff_relative": 0.17817164179104478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16239, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16239, 128], "attention_shape": [1, 32, 1, 16239]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:27.791080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4383102944964368, "overlap_percentage": 0.6094794651384909, "num_intersection": 5105, "num_union": 11647, "num_only_computed": 3271, "num_only_roped": 3271, "total_diff": 6542, "diff_percentage": 0.5616897055035631, "num_computed": 8376, "num_roped": 8376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16240, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16240, 128], "mask_shape": [1, 32, 1, 16240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:30.366445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.19103773584905662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16240, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16240, 128], "attention_shape": [1, 32, 1, 16240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:16:50.505246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.434737923946557, "overlap_percentage": 0.6060171919770774, "num_intersection": 5076, "num_union": 11676, "num_only_computed": 3300, "num_only_roped": 3300, "total_diff": 6600, "diff_percentage": 0.5652620760534429, "num_computed": 8376, "num_roped": 8376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16241, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16241, 128], "mask_shape": [1, 32, 1, 16241], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:16:53.548589", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.13700873362445415}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16241, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16241, 128], "attention_shape": [1, 32, 1, 16241]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:39.381369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:39.395043", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.003132864932885906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:45.278043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7431341535921505, "overlap_percentage": 0.8526413782447466, "num_intersection": 1103659, "num_union": 1485141, "num_only_computed": 207061, "num_only_roped": 174421, "total_diff": 381482, "diff_percentage": 0.2568658464078495, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:47.059923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 5.990266799926758e-06, "l2_diff": 0.08349609375, "l2_diff_relative": 0.009823069852941176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:01.612351", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6185096722069143, "overlap_percentage": 0.7642953055245536, "num_intersection": 1402488, "num_union": 2267528, "num_only_computed": 432520, "num_only_roped": 432520, "total_diff": 865040, "diff_percentage": 0.38149032779308567, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:02.139903", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.1171875, "l2_diff_relative": 0.013888888888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:22.983296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5656796181256275, "overlap_percentage": 0.7225994533962674, "num_intersection": 1704826, "num_union": 3013766, "num_only_computed": 654470, "num_only_roped": 654470, "total_diff": 1308940, "diff_percentage": 0.43432038187437244, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:23.725012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.1142578125, "l2_diff_relative": 0.0121875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:49.686109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5261975948863946, "overlap_percentage": 0.6895536942915483, "num_intersection": 1988386, "num_union": 3778782, "num_only_computed": 895198, "num_only_roped": 895198, "total_diff": 1790396, "diff_percentage": 0.4738024051136054, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:50.591913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.470348358154297e-06, "l2_diff": 0.125, "l2_diff_relative": 0.015151515151515152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:19:22.456722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5074610624283952, "overlap_percentage": 0.6732658973106971, "num_intersection": 2294404, "num_union": 4521340, "num_only_computed": 1113468, "num_only_roped": 1113468, "total_diff": 2226936, "diff_percentage": 0.4925389375716049, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:19:24.112850", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.1201171875, "l2_diff_relative": 0.015883264462809916}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:20:02.644235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49261334498425263, "overlap_percentage": 0.6600682576497395, "num_intersection": 2595494, "num_union": 5268826, "num_only_computed": 1336666, "num_only_roped": 1336666, "total_diff": 2673332, "diff_percentage": 0.5073866550157473, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:20:05.778866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.017101377952755906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:20:50.846775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4771253376935528, "overlap_percentage": 0.646018757539637, "num_intersection": 2878949, "num_union": 6033947, "num_only_computed": 1577499, "num_only_roped": 1577499, "total_diff": 3154998, "diff_percentage": 0.5228746623064472, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:20:52.397502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.020627470355731224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:21:44.395775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4591321731528886, "overlap_percentage": 0.6293222527754935, "num_intersection": 3134488, "num_union": 6826984, "num_only_computed": 1846248, "num_only_roped": 1846248, "total_diff": 3692496, "diff_percentage": 0.5408678268471114, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:21:46.171955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 1.2099742889404297e-05, "l2_diff": 0.2578125, "l2_diff_relative": 0.02925531914893617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:22:45.432004", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45496371724826196, "overlap_percentage": 0.6253952752976191, "num_intersection": 3442816, "num_union": 7567232, "num_only_computed": 2062208, "num_only_roped": 2062208, "total_diff": 4124416, "diff_percentage": 0.545036282751738, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:22:47.460590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.329183578491211e-05, "l2_diff": 0.287109375, "l2_diff_relative": 0.03453947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:23:55.729121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4442311651544623, "overlap_percentage": 0.615180139956267, "num_intersection": 3709113, "num_union": 8349511, "num_only_computed": 2320199, "num_only_roped": 2320199, "total_diff": 4640398, "diff_percentage": 0.5557688348455376, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:24:00.416742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.5020370483398438e-05, "l2_diff": 0.3203125, "l2_diff_relative": 0.04083665338645418}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:25:15.187873", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4379004231577532, "overlap_percentage": 0.6090830993652344, "num_intersection": 3991687, "num_union": 9115513, "num_only_computed": 2561913, "num_only_roped": 2561913, "total_diff": 5123826, "diff_percentage": 0.5620995768422469, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:25:17.759303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0247802734375, "mean_diff": 1.1980533599853516e-05, "l2_diff": 0.279296875, "l2_diff_relative": 0.03334888059701493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:26:41.381366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43586668340991885, "overlap_percentage": 0.6071130258065683, "num_intersection": 4297078, "num_union": 9858698, "num_only_computed": 2780810, "num_only_roped": 2780810, "total_diff": 5561620, "diff_percentage": 0.5641333165900811, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:26:44.230771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 1.0609626770019531e-05, "l2_diff": 0.3515625, "l2_diff_relative": 0.0398936170212766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:28:16.479753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4299749826006809, "overlap_percentage": 0.6013741328798491, "num_intersection": 4571752, "num_union": 10632600, "num_only_computed": 3030424, "num_only_roped": 3030424, "total_diff": 6060848, "diff_percentage": 0.5700250173993191, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:28:19.567132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.3984375, "l2_diff_relative": 0.046532846715328466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:30:00.065540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4345871101781551, "overlap_percentage": 0.6058706468151461, "num_intersection": 4923586, "num_union": 11329342, "num_only_computed": 3202878, "num_only_roped": 3202878, "total_diff": 6405756, "diff_percentage": 0.5654128898218449, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:30:03.417596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 7.18235969543457e-06, "l2_diff": 0.37109375, "l2_diff_relative": 0.04532442748091603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:31:52.036590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4438274996330802, "overlap_percentage": 0.6147929718001216, "num_intersection": 5125695, "num_union": 11548845, "num_only_computed": 3211575, "num_only_roped": 3211575, "total_diff": 6423150, "diff_percentage": 0.5561725003669198, "num_computed": 8337270, "num_roped": 8337270}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 989, "seq_len_k": 16349, "queries_shape": [1, 32, 989, 128], "keys_shape": [1, 8, 16349, 128], "mask_shape": [1, 32, 989, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:31:55.768347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 9.953975677490234e-06, "l2_diff": 0.60546875, "l2_diff_relative": 0.07598039215686274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 989, "seq_len_k": 16349, "queries_shape": [1, 32, 989, 128], "keys_shape": [1, 8, 16349, 128], "attention_shape": [1, 32, 989, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:43.716181", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43216189306589864, "overlap_percentage": 0.6035098338509044, "num_intersection": 137593, "num_union": 318383, "num_only_computed": 90395, "num_only_roped": 90395, "total_diff": 180790, "diff_percentage": 0.5678381069341014, "num_computed": 227988, "num_roped": 227988}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16376, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16376, 128], "mask_shape": [1, 32, 27, 16376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:46.983242", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.633167266845703e-05, "l2_diff": 0.09619140625, "l2_diff_relative": 0.07417168674698796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16376, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16376, 128], "attention_shape": [1, 32, 27, 16376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:35:16.860525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42647183039108033, "overlap_percentage": 0.5979393652297489, "num_intersection": 5049, "num_union": 11839, "num_only_computed": 3395, "num_only_roped": 3395, "total_diff": 6790, "diff_percentage": 0.5735281696089197, "num_computed": 8444, "num_roped": 8444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:35:21.536367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.0247802734375, "l2_diff_relative": 0.126875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:36:40.544417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44408344733242133, "overlap_percentage": 0.6150384843102428, "num_intersection": 5194, "num_union": 11696, "num_only_computed": 3251, "num_only_roped": 3251, "total_diff": 6502, "diff_percentage": 0.5559165526675787, "num_computed": 8445, "num_roped": 8445}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16378, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16378, 128], "mask_shape": [1, 32, 1, 16378], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:36:44.458704", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.020751953125, "l2_diff_relative": 0.09615384615384616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16378, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16378, 128], "attention_shape": [1, 32, 1, 16378]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:38:04.161878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4475488515598217, "overlap_percentage": 0.6183540556542333, "num_intersection": 5222, "num_union": 11668, "num_only_computed": 3223, "num_only_roped": 3223, "total_diff": 6446, "diff_percentage": 0.5524511484401783, "num_computed": 8445, "num_roped": 8445}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16379, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16379, 128], "mask_shape": [1, 32, 1, 16379], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:38:07.166828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.0196533203125, "l2_diff_relative": 0.09448356807511737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16379, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16379, 128], "attention_shape": [1, 32, 1, 16379]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:39:28.020664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4394546229228803, "overlap_percentage": 0.6105848922566895, "num_intersection": 5157, "num_union": 11735, "num_only_computed": 3289, "num_only_roped": 3289, "total_diff": 6578, "diff_percentage": 0.5605453770771197, "num_computed": 8446, "num_roped": 8446}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16380, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16380, 128], "mask_shape": [1, 32, 1, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:39:30.641311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.0255126953125, "l2_diff_relative": 0.07594476744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16380, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16380, 128], "attention_shape": [1, 32, 1, 16380]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:16.293624", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:16.306287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.003083235062893082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:22.362903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7489055828784521, "overlap_percentage": 0.8564276885043264, "num_intersection": 1108560, "num_union": 1480240, "num_only_computed": 202160, "num_only_roped": 169520, "total_diff": 371680, "diff_percentage": 0.25109441712154784, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:23.770965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 9.298324584960938e-06, "l2_diff": 0.11279296875, "l2_diff_relative": 0.014553931451612902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:38.742207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6232810214506584, "overlap_percentage": 0.7679274422781808, "num_intersection": 1409153, "num_union": 2260863, "num_only_computed": 425855, "num_only_roped": 425855, "total_diff": 851710, "diff_percentage": 0.37671897854934155, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:39.299502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 9.238719940185547e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.017652671755725192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:41:01.052080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5592620374929366, "overlap_percentage": 0.7173419528537326, "num_intersection": 1692422, "num_union": 3026170, "num_only_computed": 666874, "num_only_roped": 666874, "total_diff": 1333748, "diff_percentage": 0.4407379625070634, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:41:01.797343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 5.364418029785156e-06, "l2_diff": 0.11669921875, "l2_diff_relative": 0.014253339694656489}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:41:31.283872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.527890137116661, "overlap_percentage": 0.6910053599964489, "num_intersection": 1992572, "num_union": 3774596, "num_only_computed": 891012, "num_only_roped": 891012, "total_diff": 1782024, "diff_percentage": 0.47210986288333906, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:41:33.283637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.125999450683594e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.018295940170940172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:42:06.152602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5065747126436781, "overlap_percentage": 0.6724853515625, "num_intersection": 2291744, "num_union": 4524000, "num_only_computed": 1116128, "num_only_roped": 1116128, "total_diff": 2232256, "diff_percentage": 0.49342528735632185, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:42:07.278237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.125999450683594e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.019931102362204724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:42:46.514226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49197592825906356, "overlap_percentage": 0.6594957987467448, "num_intersection": 2593243, "num_union": 5271077, "num_only_computed": 1338917, "num_only_roped": 1338917, "total_diff": 2677834, "diff_percentage": 0.5080240717409364, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:42:47.847774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.904104232788086e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.018612132352941176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:43:33.089586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4822696002631629, "overlap_percentage": 0.6507177913890165, "num_intersection": 2899890, "num_union": 6013006, "num_only_computed": 1556558, "num_only_roped": 1556558, "total_diff": 3113116, "diff_percentage": 0.5177303997368371, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:43:34.638415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.019137596899224806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:44:29.772255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46322071332338804, "overlap_percentage": 0.633152208830181, "num_intersection": 3153564, "num_union": 6807908, "num_only_computed": 1827172, "num_only_roped": 1827172, "total_diff": 3654344, "diff_percentage": 0.536779286676612, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:44:32.914473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 6.973743438720703e-06, "l2_diff": 0.2158203125, "l2_diff_relative": 0.027083333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:45:32.256064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4660717716900778, "overlap_percentage": 0.635810307094029, "num_intersection": 3500151, "num_union": 7509897, "num_only_computed": 2004873, "num_only_roped": 2004873, "total_diff": 4009746, "diff_percentage": 0.5339282283099223, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:45:34.319996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.051513671875, "mean_diff": 1.0371208190917969e-05, "l2_diff": 0.3359375, "l2_diff_relative": 0.04282868525896414}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:46:42.101567", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46181919306373714, "overlap_percentage": 0.6318417424740999, "num_intersection": 3809571, "num_union": 8249053, "num_only_computed": 2219741, "num_only_roped": 2219741, "total_diff": 4439482, "diff_percentage": 0.5381808069362629, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:46:44.425737", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.050048828125, "mean_diff": 9.000301361083984e-06, "l2_diff": 0.2734375, "l2_diff_relative": 0.0341796875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:47:59.647249", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45601096629353277, "overlap_percentage": 0.6263839721679687, "num_intersection": 4105070, "num_union": 9002130, "num_only_computed": 2448530, "num_only_roped": 2448530, "total_diff": 4897060, "diff_percentage": 0.5439890337064672, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:48:02.217485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.44140625, "l2_diff_relative": 0.056051587301587304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:49:25.914369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45131045996586555, "overlap_percentage": 0.6219351026746962, "num_intersection": 4401987, "num_union": 9753789, "num_only_computed": 2675901, "num_only_roped": 2675901, "total_diff": 5351802, "diff_percentage": 0.5486895400341344, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:49:28.762727", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 1.0669231414794922e-05, "l2_diff": 0.4296875, "l2_diff_relative": 0.060043668122270744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:51:00.330944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4477339118294852, "overlap_percentage": 0.618530668061355, "num_intersection": 4702179, "num_union": 10502173, "num_only_computed": 2899997, "num_only_roped": 2899997, "total_diff": 5799994, "diff_percentage": 0.5522660881705148, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:51:03.428460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 1.3053417205810547e-05, "l2_diff": 0.494140625, "l2_diff_relative": 0.0664390756302521}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:52:34.525566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4628634569287388, "overlap_percentage": 0.632818401111084, "num_intersection": 363601, "num_union": 785547, "num_only_computed": 210973, "num_only_roped": 210973, "total_diff": 421946, "diff_percentage": 0.5371365430712611, "num_computed": 574574, "num_roped": 574574}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 77, "seq_len_k": 14413, "queries_shape": [1, 32, 77, 128], "keys_shape": [1, 8, 14413, 128], "mask_shape": [1, 32, 77, 14413], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:52:37.458862", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.353515625, "l2_diff_relative": 0.14229559748427673}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 77, "seq_len_k": 14413, "queries_shape": [1, 32, 77, 128], "keys_shape": [1, 8, 14413, 128], "attention_shape": [1, 32, 77, 14413]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:54:04.561091", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43425301320374693, "overlap_percentage": 0.6055458963042218, "num_intersection": 135830, "num_union": 312790, "num_only_computed": 88480, "num_only_roped": 88480, "total_diff": 176960, "diff_percentage": 0.5657469867962531, "num_computed": 224310, "num_roped": 224310}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14443, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14443, 128], "mask_shape": [1, 32, 30, 14443], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:54:07.387724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.11572265625, "l2_diff_relative": 0.08713235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14443, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14443, 128], "attention_shape": [1, 32, 30, 14443]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:55:26.513372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4526029526029526, "overlap_percentage": 0.6231612730676651, "num_intersection": 4660, "num_union": 10296, "num_only_computed": 2818, "num_only_roped": 2818, "total_diff": 5636, "diff_percentage": 0.5473970473970474, "num_computed": 7478, "num_roped": 7478}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14444, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14444, 128], "mask_shape": [1, 32, 1, 14444], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:55:28.730515", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.09208015267175572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14444, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14444, 128], "attention_shape": [1, 32, 1, 14444]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:37.803007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4340780515869211, "overlap_percentage": 0.6053757689221717, "num_intersection": 4527, "num_union": 10429, "num_only_computed": 2951, "num_only_roped": 2951, "total_diff": 5902, "diff_percentage": 0.565921948413079, "num_computed": 7478, "num_roped": 7478}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14445, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14445, 128], "mask_shape": [1, 32, 1, 14445], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:40.020331", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.01708984375, "l2_diff_relative": 0.07352941176470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14445, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14445, 128], "attention_shape": [1, 32, 1, 14445]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:57:48.750164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44298668724676826, "overlap_percentage": 0.6139858269822168, "num_intersection": 4592, "num_union": 10366, "num_only_computed": 2887, "num_only_roped": 2887, "total_diff": 5774, "diff_percentage": 0.5570133127532317, "num_computed": 7479, "num_roped": 7479}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14446, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14446, 128], "mask_shape": [1, 32, 1, 14446], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:57:50.986754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.3709068298339844e-05, "l2_diff": 0.0245361328125, "l2_diff_relative": 0.09738372093023256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14446, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14446, 128], "attention_shape": [1, 32, 1, 14446]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:31.270124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:31.282712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.003080432046979866}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:37.217465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7490178327123356, "overlap_percentage": 0.8565010815822003, "num_intersection": 1108655, "num_union": 1480145, "num_only_computed": 202065, "num_only_roped": 169425, "total_diff": 371490, "diff_percentage": 0.25098216728766437, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:37.672573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.079673767089844e-06, "l2_diff": 0.087890625, "l2_diff_relative": 0.010190217391304348}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:52.466517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6277058273832148, "overlap_percentage": 0.7712767464773995, "num_intersection": 1415299, "num_union": 2254717, "num_only_computed": 419709, "num_only_roped": 419709, "total_diff": 839418, "diff_percentage": 0.37229417261678516, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:53.014999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 5.9604644775390625e-06, "l2_diff": 0.1083984375, "l2_diff_relative": 0.011262175324675324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:59:13.487627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5728550871545062, "overlap_percentage": 0.7284270392523872, "num_intersection": 1718575, "num_union": 3000017, "num_only_computed": 640721, "num_only_roped": 640721, "total_diff": 1281442, "diff_percentage": 0.4271449128454939, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:59:14.212486", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 5.155801773071289e-06, "l2_diff": 0.11669921875, "l2_diff_relative": 0.014253339694656489}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:59:40.687179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5286596110579809, "overlap_percentage": 0.6916642622514204, "num_intersection": 1994472, "num_union": 3772696, "num_only_computed": 889112, "num_only_roped": 889112, "total_diff": 1778224, "diff_percentage": 0.4713403889420192, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:59:41.593057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.410743713378906e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.015285326086956522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:00:13.502408", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5072620427927236, "overlap_percentage": 0.6730907146747296, "num_intersection": 2293807, "num_union": 4521937, "num_only_computed": 1114065, "num_only_roped": 1114065, "total_diff": 2228130, "diff_percentage": 0.4927379572072764, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:00:16.095437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.231929779052734e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.017657520325203253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:00:53.867051", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4945425002731838, "overlap_percentage": 0.661797841389974, "num_intersection": 2602295, "num_union": 5262025, "num_only_computed": 1329865, "num_only_roped": 1329865, "total_diff": 2659730, "diff_percentage": 0.5054574997268162, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:00:57.600909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.7401914596557617e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01830179282868526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:01:41.532938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47683530368515553, "overlap_percentage": 0.6457528507008272, "num_intersection": 2877764, "num_union": 6035132, "num_only_computed": 1578684, "num_only_roped": 1578684, "total_diff": 3157368, "diff_percentage": 0.5231646963148445, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:01:43.038013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 4.26173210144043e-06, "l2_diff": 0.197265625, "l2_diff_relative": 0.023910984848484848}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:02:33.964934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4650503293964208, "overlap_percentage": 0.6348591854697779, "num_intersection": 3162066, "num_union": 6799406, "num_only_computed": 1818670, "num_only_roped": 1818670, "total_diff": 3637340, "diff_percentage": 0.5349496706035792, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:02:35.702662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 1.2278556823730469e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.03308823529411765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:03:33.929802", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46637871962122046, "overlap_percentage": 0.6360958644321987, "num_intersection": 3501723, "num_union": 7508325, "num_only_computed": 2003301, "num_only_roped": 2003301, "total_diff": 4006602, "diff_percentage": 0.5336212803787795, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:03:35.919451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.267578125, "l2_diff_relative": 0.030580357142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:04:42.504771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45760737270861485, "overlap_percentage": 0.6278883892556896, "num_intersection": 3785735, "num_union": 8272889, "num_only_computed": 2243577, "num_only_roped": 2243577, "total_diff": 4487154, "diff_percentage": 0.5423926272913852, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:04:44.775490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 1.3768672943115234e-05, "l2_diff": 0.341796875, "l2_diff_relative": 0.04050925925925926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:05:59.100935", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45031483312947873, "overlap_percentage": 0.6209890747070312, "num_intersection": 4069714, "num_union": 9037486, "num_only_computed": 2483886, "num_only_roped": 2483886, "total_diff": 4967772, "diff_percentage": 0.5496851668705213, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:06:02.206332", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 1.2993812561035156e-05, "l2_diff": 0.4296875, "l2_diff_relative": 0.04807692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:07:25.264125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45147162233743127, "overlap_percentage": 0.6220881144205729, "num_intersection": 4403070, "num_union": 9752706, "num_only_computed": 2674818, "num_only_roped": 2674818, "total_diff": 5349636, "diff_percentage": 0.5485283776625687, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:07:28.068035", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 1.2993812561035156e-05, "l2_diff": 0.5234375, "l2_diff_relative": 0.06158088235294118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:08:57.519778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45212352295743824, "overlap_percentage": 0.6227066992711886, "num_intersection": 4159715, "num_union": 9200395, "num_only_computed": 2520340, "num_only_roped": 2520340, "total_diff": 5040680, "diff_percentage": 0.5478764770425617, "num_computed": 6680055, "num_roped": 6680055}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 907, "seq_len_k": 14219, "queries_shape": [1, 32, 907, 128], "keys_shape": [1, 8, 14219, 128], "mask_shape": [1, 32, 907, 14219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:09:00.831538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.049560546875, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.5234375, "l2_diff_relative": 0.06979166666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 907, "seq_len_k": 14219, "queries_shape": [1, 32, 907, 128], "keys_shape": [1, 8, 14219, 128], "attention_shape": [1, 32, 907, 14219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:10:29.338169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45506864821209403, "overlap_percentage": 0.6254944036781448, "num_intersection": 143120, "num_union": 314502, "num_only_computed": 85691, "num_only_roped": 85691, "total_diff": 171382, "diff_percentage": 0.544931351787906, "num_computed": 228811, "num_roped": 228811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14250, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14250, 128], "mask_shape": [1, 32, 31, 14250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:10:32.065881", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.11376953125, "l2_diff_relative": 0.091015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14250, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14250, 128], "attention_shape": [1, 32, 31, 14250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:11:48.140757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4769384692346173, "overlap_percentage": 0.6458474461455087, "num_intersection": 4767, "num_union": 9995, "num_only_computed": 2614, "num_only_roped": 2614, "total_diff": 5228, "diff_percentage": 0.5230615307653826, "num_computed": 7381, "num_roped": 7381}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14251, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14251, 128], "mask_shape": [1, 32, 1, 14251], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:11:50.268180", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.17822966507177032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14251, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14251, 128], "attention_shape": [1, 32, 1, 14251]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:12:56.479099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4550113333990342, "overlap_percentage": 0.625440260092116, "num_intersection": 4617, "num_union": 10147, "num_only_computed": 2765, "num_only_roped": 2765, "total_diff": 5530, "diff_percentage": 0.5449886666009658, "num_computed": 7382, "num_roped": 7382}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14252, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14252, 128], "mask_shape": [1, 32, 1, 14252], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:12:58.609610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.5854835510253906e-05, "l2_diff": 0.0234375, "l2_diff_relative": 0.09836065573770492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14252, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14252, 128], "attention_shape": [1, 32, 1, 14252]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:37.531338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:37.543936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.002997248427672956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:43.375016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.744510835468935, "overlap_percentage": 0.8535468170580964, "num_intersection": 1104831, "num_union": 1483969, "num_only_computed": 205889, "num_only_roped": 173249, "total_diff": 379138, "diff_percentage": 0.255489164531065, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:43.753672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.2755393981933594e-05, "l2_diff": 0.158203125, "l2_diff_relative": 0.019176136363636364}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:59.308717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6171161524964728, "overlap_percentage": 0.763230460030692, "num_intersection": 1400534, "num_union": 2269482, "num_only_computed": 434474, "num_only_roped": 434474, "total_diff": 868948, "diff_percentage": 0.3828838475035272, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:59.848533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.043081283569336e-05, "l2_diff": 0.1806640625, "l2_diff_relative": 0.023501016260162603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:14:19.807339", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5528687444238832, "overlap_percentage": 0.7120611402723525, "num_intersection": 1679963, "num_union": 3038629, "num_only_computed": 679333, "num_only_roped": 679333, "total_diff": 1358666, "diff_percentage": 0.4471312555761167, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:14:20.523223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.177734375, "l2_diff_relative": 0.02451508620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:14:46.990096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5236597627101807, "overlap_percentage": 0.6873709938742898, "num_intersection": 1982092, "num_union": 3785076, "num_only_computed": 901492, "num_only_roped": 901492, "total_diff": 1802984, "diff_percentage": 0.4763402372898193, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:14:47.894797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.4803829193115234e-06, "l2_diff": 0.1826171875, "l2_diff_relative": 0.02445083682008368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:15:20.652991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5061462400064349, "overlap_percentage": 0.6721076965332031, "num_intersection": 2290457, "num_union": 4525287, "num_only_computed": 1117415, "num_only_roped": 1117415, "total_diff": 2234830, "diff_percentage": 0.49385375999356507, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:15:21.780609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.377696990966797e-06, "l2_diff": 0.1865234375, "l2_diff_relative": 0.026294052863436123}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:16:00.958730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48982446209655467, "overlap_percentage": 0.6575599670410156, "num_intersection": 2585631, "num_union": 5278689, "num_only_computed": 1346529, "num_only_roped": 1346529, "total_diff": 2693058, "diff_percentage": 0.5101755379034454, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:16:02.485406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.1708984375, "l2_diff_relative": 0.02463400900900901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:16:47.730900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47723575187586104, "overlap_percentage": 0.6461199592141544, "num_intersection": 2879400, "num_union": 6033496, "num_only_computed": 1577048, "num_only_roped": 1577048, "total_diff": 3154096, "diff_percentage": 0.522764248124139, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:16:51.785205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.2041015625, "l2_diff_relative": 0.02889933628318584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:17:45.003388", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4682873220038394, "overlap_percentage": 0.6378687808388158, "num_intersection": 3177056, "num_union": 6784416, "num_only_computed": 1803680, "num_only_roped": 1803680, "total_diff": 3607360, "diff_percentage": 0.5317126779961606, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:17:48.618126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.30078125, "l2_diff_relative": 0.040957446808510635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:18:47.947566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46695371401482294, "overlap_percentage": 0.6366304670061383, "num_intersection": 3504666, "num_union": 7505382, "num_only_computed": 2000358, "num_only_roped": 2000358, "total_diff": 4000716, "diff_percentage": 0.533046285985177, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:18:49.975354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 1.52587890625e-05, "l2_diff": 0.353515625, "l2_diff_relative": 0.04453740157480315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:19:57.525341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47222716005008586, "overlap_percentage": 0.6415139903192935, "num_intersection": 3867888, "num_union": 8190736, "num_only_computed": 2161424, "num_only_roped": 2161424, "total_diff": 4322848, "diff_percentage": 0.5277728399499142, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:19:59.825042", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04443359375, "mean_diff": 1.2099742889404297e-05, "l2_diff": 0.31640625, "l2_diff_relative": 0.045200892857142856}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:21:15.126961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45431692640627314, "overlap_percentage": 0.624783935546875, "num_intersection": 4094584, "num_union": 9012616, "num_only_computed": 2459016, "num_only_roped": 2459016, "total_diff": 4918032, "diff_percentage": 0.5456830735937268, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:21:17.707376", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.255859375, "l2_diff_relative": 0.03328252032520325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:22:41.092780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4541789249815271, "overlap_percentage": 0.6246534276891638, "num_intersection": 4421227, "num_union": 9734549, "num_only_computed": 2656661, "num_only_roped": 2656661, "total_diff": 5313322, "diff_percentage": 0.5458210750184729, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:22:43.953282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 1.4185905456542969e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.07785087719298246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:24:16.289085", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43679681485283145, "overlap_percentage": 0.6080147315715921, "num_intersection": 4622235, "num_union": 10582117, "num_only_computed": 2979941, "num_only_roped": 2979941, "total_diff": 5959882, "diff_percentage": 0.5632031851471686, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:24:19.351253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 1.2576580047607422e-05, "l2_diff": 0.46875, "l2_diff_relative": 0.06818181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:26:00.244875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4523724631177257, "overlap_percentage": 0.6229427706810736, "num_intersection": 5062322, "num_union": 11190606, "num_only_computed": 3064142, "num_only_roped": 3064142, "total_diff": 6128284, "diff_percentage": 0.5476275368822743, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:26:06.046757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.734375, "l2_diff_relative": 0.10633484162895927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:27:50.951967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45382037422535465, "overlap_percentage": 0.6243142306588814, "num_intersection": 2576390, "num_union": 5677114, "num_only_computed": 1550362, "num_only_roped": 1550362, "total_diff": 3100724, "diff_percentage": 0.5461796257746454, "num_computed": 4126752, "num_roped": 4126752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 504, "seq_len_k": 15864, "queries_shape": [1, 32, 504, 128], "keys_shape": [1, 8, 15864, 128], "mask_shape": [1, 32, 504, 15864], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:27:56.489738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 504, "seq_len_k": 15864, "queries_shape": [1, 32, 504, 128], "keys_shape": [1, 8, 15864, 128], "attention_shape": [1, 32, 504, 15864]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:29:37.641293", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4258737202247897, "overlap_percentage": 0.5973512439203248, "num_intersection": 230528, "num_union": 541306, "num_only_computed": 155389, "num_only_roped": 155389, "total_diff": 310778, "diff_percentage": 0.5741262797752104, "num_computed": 385917, "num_roped": 385917}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15911, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15911, 128], "mask_shape": [1, 32, 47, 15911], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:29:40.839896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.1865234375, "l2_diff_relative": 0.11478365384615384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15911, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15911, 128], "attention_shape": [1, 32, 47, 15911]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:09.033950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43378437363596684, "overlap_percentage": 0.6050901120311739, "num_intersection": 4969, "num_union": 11455, "num_only_computed": 3243, "num_only_roped": 3243, "total_diff": 6486, "diff_percentage": 0.5662156263640332, "num_computed": 8212, "num_roped": 8212}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15912, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15912, 128], "mask_shape": [1, 32, 1, 15912], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:13.632058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.1784351145038168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15912, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15912, 128], "attention_shape": [1, 32, 1, 15912]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:32:30.206814", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4712890799964167, "overlap_percentage": 0.6406478324403312, "num_intersection": 5261, "num_union": 11163, "num_only_computed": 2951, "num_only_roped": 2951, "total_diff": 5902, "diff_percentage": 0.5287109200035832, "num_computed": 8212, "num_roped": 8212}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15913, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15913, 128], "mask_shape": [1, 32, 1, 15913], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:32:34.003498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.054443359375, "l2_diff_relative": 0.2266260162601626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15913, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15913, 128], "attention_shape": [1, 32, 1, 15913]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:33:50.472099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45646391204114206, "overlap_percentage": 0.6268111530500426, "num_intersection": 5148, "num_union": 11278, "num_only_computed": 3065, "num_only_roped": 3065, "total_diff": 6130, "diff_percentage": 0.543536087958858, "num_computed": 8213, "num_roped": 8213}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15914, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15914, 128], "mask_shape": [1, 32, 1, 15914], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:33:52.961553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.10607569721115538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15914, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15914, 128], "attention_shape": [1, 32, 1, 15914]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:39.163378", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:39.192276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003115110759493671}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:45.066570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7497365729954709, "overlap_percentage": 0.8569707972805933, "num_intersection": 1109263, "num_union": 1479537, "num_only_computed": 201457, "num_only_roped": 168817, "total_diff": 370274, "diff_percentage": 0.25026342700452914, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:45.449084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 9.953975677490234e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.01574074074074074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:00.860267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6314430606627452, "overlap_percentage": 0.7740914481026786, "num_intersection": 1420464, "num_union": 2249552, "num_only_computed": 414544, "num_only_roped": 414544, "total_diff": 829088, "diff_percentage": 0.3685569393372547, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:01.391406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.47713851928711e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017075892857142855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:21.731863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5697778168121473, "overlap_percentage": 0.7259343465169271, "num_intersection": 1712694, "num_union": 3005898, "num_only_computed": 646602, "num_only_roped": 646602, "total_diff": 1293204, "diff_percentage": 0.43022218318785266, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:22.456011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.1220703125, "l2_diff_relative": 0.013563368055555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:48.762914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5352062285977137, "overlap_percentage": 0.6972434303977273, "num_intersection": 2010560, "num_union": 3756608, "num_only_computed": 873024, "num_only_roped": 873024, "total_diff": 1746048, "diff_percentage": 0.46479377140228634, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:49.680798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.018606870229007633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:36:21.712629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5155841299751152, "overlap_percentage": 0.6803767864520733, "num_intersection": 2318637, "num_union": 4497107, "num_only_computed": 1089235, "num_only_roped": 1089235, "total_diff": 2178470, "diff_percentage": 0.4844158700248849, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:36:22.814192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.1572265625, "l2_diff_relative": 0.018914473684210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:37:00.625680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49861511416852067, "overlap_percentage": 0.6654345194498698, "num_intersection": 2616595, "num_union": 5247725, "num_only_computed": 1315565, "num_only_roped": 1315565, "total_diff": 2631130, "diff_percentage": 0.5013848858314793, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:37:01.905956", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 3.933906555175781e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.02001953125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:37:46.722538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4869904750083251, "overlap_percentage": 0.6550014720243567, "num_intersection": 2918980, "num_union": 5993916, "num_only_computed": 1537468, "num_only_roped": 1537468, "total_diff": 3074936, "diff_percentage": 0.5130095249916748, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:37:48.215519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.6507844924926758e-06, "l2_diff": 0.1572265625, "l2_diff_relative": 0.020452235772357722}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:38:39.369475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4826588778049889, "overlap_percentage": 0.6510720503957648, "num_intersection": 3242818, "num_union": 6718654, "num_only_computed": 1737918, "num_only_roped": 1737918, "total_diff": 3475836, "diff_percentage": 0.517341122195011, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:38:41.120926", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 9.953975677490234e-06, "l2_diff": 0.26953125, "l2_diff_relative": 0.029947916666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:39:40.149307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46052074434498386, "overlap_percentage": 0.6306254069010416, "num_intersection": 3471608, "num_union": 7538440, "num_only_computed": 2033416, "num_only_roped": 2033416, "total_diff": 4066832, "diff_percentage": 0.5394792556550162, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:39:43.670336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.062255859375, "mean_diff": 1.3887882232666016e-05, "l2_diff": 0.35546875, "l2_diff_relative": 0.0446078431372549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:40:49.995330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.457431379298342, "overlap_percentage": 0.6277226987092391, "num_intersection": 3784736, "num_union": 8273888, "num_only_computed": 2244576, "num_only_roped": 2244576, "total_diff": 4489152, "diff_percentage": 0.542568620701658, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:40:53.689605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.453125, "l2_diff_relative": 0.054924242424242424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:42:08.789695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4583155316300664, "overlap_percentage": 0.6285546875, "num_intersection": 4119296, "num_union": 8987904, "num_only_computed": 2434304, "num_only_roped": 2434304, "total_diff": 4868608, "diff_percentage": 0.5416844683699337, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:42:11.357781", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 8.344650268554688e-06, "l2_diff": 0.27734375, "l2_diff_relative": 0.03169642857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:43:34.827917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45047858045944095, "overlap_percentage": 0.6211447539152922, "num_intersection": 4396393, "num_union": 9759383, "num_only_computed": 2681495, "num_only_roped": 2681495, "total_diff": 5362990, "diff_percentage": 0.5495214195405591, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:43:40.234135", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.443359375, "l2_diff_relative": 0.05886929460580913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:45:08.220700", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4538629037772391, "overlap_percentage": 0.6243544733111644, "num_intersection": 2356345, "num_union": 5191755, "num_only_computed": 1417705, "num_only_roped": 1417705, "total_diff": 2835410, "diff_percentage": 0.5461370962227609, "num_computed": 3774050, "num_roped": 3774050}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 526, "seq_len_k": 13838, "queries_shape": [1, 32, 526, 128], "keys_shape": [1, 8, 13838, 128], "mask_shape": [1, 32, 526, 13838], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:45:11.099612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 1.329183578491211e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.07577720207253887}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 526, "seq_len_k": 13838, "queries_shape": [1, 32, 526, 128], "keys_shape": [1, 8, 13838, 128], "attention_shape": [1, 32, 526, 13838]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:46:37.065184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4726816529264171, "overlap_percentage": 0.6419332406119611, "num_intersection": 138465, "num_union": 292935, "num_only_computed": 77235, "num_only_roped": 77235, "total_diff": 154470, "diff_percentage": 0.5273183470735828, "num_computed": 215700, "num_roped": 215700}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13868, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13868, 128], "mask_shape": [1, 32, 30, 13868], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:46:40.162471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.12060546875, "l2_diff_relative": 0.08624301675977654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13868, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13868, 128], "attention_shape": [1, 32, 30, 13868]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:47:54.757282", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4463890565278616, "overlap_percentage": 0.6172461752433936, "num_intersection": 4438, "num_union": 9942, "num_only_computed": 2752, "num_only_roped": 2752, "total_diff": 5504, "diff_percentage": 0.5536109434721384, "num_computed": 7190, "num_roped": 7190}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13869, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13869, 128], "mask_shape": [1, 32, 1, 13869], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:47:56.877649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 1.3172626495361328e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.11509146341463415}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13869, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13869, 128], "attention_shape": [1, 32, 1, 13869]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:49:02.897905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44760946149974834, "overlap_percentage": 0.6184119037685997, "num_intersection": 4447, "num_union": 9935, "num_only_computed": 2744, "num_only_roped": 2744, "total_diff": 5488, "diff_percentage": 0.5523905385002517, "num_computed": 7191, "num_roped": 7191}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13870, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13870, 128], "mask_shape": [1, 32, 1, 13870], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:49:05.011102", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.150369644165039e-05, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.11800373134328358}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13870, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13870, 128], "attention_shape": [1, 32, 1, 13870]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:50:10.823539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44731810405554995, "overlap_percentage": 0.6181337783340286, "num_intersection": 4445, "num_union": 9937, "num_only_computed": 2746, "num_only_roped": 2746, "total_diff": 5492, "diff_percentage": 0.55268189594445, "num_computed": 7191, "num_roped": 7191}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13871, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13871, 128], "mask_shape": [1, 32, 1, 13871], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:50:12.927927", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.043081283569336e-05, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.09849683544303797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13871, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13871, 128], "attention_shape": [1, 32, 1, 13871]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:18.635920", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45646010530579184, "overlap_percentage": 0.6268075639599555, "num_intersection": 4508, "num_union": 9876, "num_only_computed": 2684, "num_only_roped": 2684, "total_diff": 5368, "diff_percentage": 0.5435398946942082, "num_computed": 7192, "num_roped": 7192}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13872, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13872, 128], "mask_shape": [1, 32, 1, 13872], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:21.471131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.1682510375976562e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.11148648648648649}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13872, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13872, 128], "attention_shape": [1, 32, 1, 13872]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:52:26.209660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4700051098620337, "overlap_percentage": 0.639460511679644, "num_intersection": 4599, "num_union": 9785, "num_only_computed": 2593, "num_only_roped": 2593, "total_diff": 5186, "diff_percentage": 0.5299948901379663, "num_computed": 7192, "num_roped": 7192}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13873, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13873, 128], "mask_shape": [1, 32, 1, 13873], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:52:29.376141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.19268774703557312}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13873, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13873, 128], "attention_shape": [1, 32, 1, 13873]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:53:34.113031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48646414548460426, "overlap_percentage": 0.6545252328652857, "num_intersection": 4708, "num_union": 9678, "num_only_computed": 2485, "num_only_roped": 2485, "total_diff": 4970, "diff_percentage": 0.5135358545153957, "num_computed": 7193, "num_roped": 7193}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13874, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13874, 128], "mask_shape": [1, 32, 1, 13874], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:53:37.366373", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 1.436471939086914e-05, "l2_diff": 0.051513671875, "l2_diff_relative": 0.20445736434108527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13874, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13874, 128], "attention_shape": [1, 32, 1, 13874]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:54:42.965817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4852364237043155, "overlap_percentage": 0.6534130404559989, "num_intersection": 4700, "num_union": 9686, "num_only_computed": 2493, "num_only_roped": 2493, "total_diff": 4986, "diff_percentage": 0.5147635762956845, "num_computed": 7193, "num_roped": 7193}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13875, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13875, 128], "mask_shape": [1, 32, 1, 13875], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:54:45.043814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.07177734375, "l2_diff_relative": 0.18846153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13875, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13875, 128], "attention_shape": [1, 32, 1, 13875]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:55:23.840395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:55:23.854061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.030517578125, "l2_diff_relative": 0.0031502016129032256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:55:30.460354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7439032769591629, "overlap_percentage": 0.8531474042027194, "num_intersection": 1104314, "num_union": 1484486, "num_only_computed": 206406, "num_only_roped": 173766, "total_diff": 380172, "diff_percentage": 0.256096723040837, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:55:30.835676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.894371032714844e-06, "l2_diff": 0.1123046875, "l2_diff_relative": 0.014549595141700405}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:55:45.375036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6228948337778218, "overlap_percentage": 0.7676342555454799, "num_intersection": 1408615, "num_union": 2261401, "num_only_computed": 426393, "num_only_roped": 426393, "total_diff": 852786, "diff_percentage": 0.3771051662221782, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:55:45.904422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 9.715557098388672e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.02052038626609442}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:56:06.268612", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5595104320075301, "overlap_percentage": 0.7175462510850694, "num_intersection": 1692904, "num_union": 3025688, "num_only_computed": 666392, "num_only_roped": 666392, "total_diff": 1332784, "diff_percentage": 0.4404895679924698, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:56:06.991410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.238719940185547e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.024699781659388645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:56:33.160977", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5262048648711589, "overlap_percentage": 0.6895599365234375, "num_intersection": 1988404, "num_union": 3778764, "num_only_computed": 895180, "num_only_roped": 895180, "total_diff": 1790360, "diff_percentage": 0.4737951351288411, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:56:34.069943", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 8.165836334228516e-06, "l2_diff": 0.189453125, "l2_diff_relative": 0.02793778801843318}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:57:06.117896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5078742709510252, "overlap_percentage": 0.6736294673039362, "num_intersection": 2295643, "num_union": 4520101, "num_only_computed": 1112229, "num_only_roped": 1112229, "total_diff": 2224458, "diff_percentage": 0.4921257290489748, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:57:08.185635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.510185241699219e-06, "l2_diff": 0.2099609375, "l2_diff_relative": 0.03139602803738318}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:57:46.060274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4941373076072509, "overlap_percentage": 0.6614349365234375, "num_intersection": 2600868, "num_union": 5263452, "num_only_computed": 1331292, "num_only_roped": 1331292, "total_diff": 2662584, "diff_percentage": 0.5058626923927491, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:57:50.089567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.827976226806641e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.023305084745762712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:58:34.390156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49466313676318896, "overlap_percentage": 0.661905849681181, "num_intersection": 2949749, "num_union": 5963147, "num_only_computed": 1506699, "num_only_roped": 1506699, "total_diff": 3013398, "diff_percentage": 0.505336863236811, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:58:35.888600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.020025510204081633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:59:27.377170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4814778681173883, "overlap_percentage": 0.6499967073139391, "num_intersection": 3237462, "num_union": 6724010, "num_only_computed": 1743274, "num_only_roped": 1743274, "total_diff": 3486548, "diff_percentage": 0.5185221318826118, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:59:29.129816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.040283203125, "mean_diff": 1.4007091522216797e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.041970802919708027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:00:27.645613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47715927276318004, "overlap_percentage": 0.6460498628162202, "num_intersection": 3556520, "num_union": 7453528, "num_only_computed": 1948504, "num_only_roped": 1948504, "total_diff": 3897008, "diff_percentage": 0.52284072723682, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:00:29.635650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.0371208190917969e-05, "l2_diff": 0.259765625, "l2_diff_relative": 0.03221899224806202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:01:36.496417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48204833110427164, "overlap_percentage": 0.6505163441533628, "num_intersection": 3922166, "num_union": 8136458, "num_only_computed": 2107146, "num_only_roped": 2107146, "total_diff": 4214292, "diff_percentage": 0.5179516688957283, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:01:38.883985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.027587890625, "mean_diff": 9.238719940185547e-06, "l2_diff": 0.275390625, "l2_diff_relative": 0.0331296992481203}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:02:55.156659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46422429692724254, "overlap_percentage": 0.6340890502929688, "num_intersection": 4155566, "num_union": 8951634, "num_only_computed": 2398034, "num_only_roped": 2398034, "total_diff": 4796068, "diff_percentage": 0.5357757030727575, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:02:57.797832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 1.239776611328125e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.06169871794871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:04:22.198179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4573311578028625, "overlap_percentage": 0.6276283264160156, "num_intersection": 4442283, "num_union": 9713493, "num_only_computed": 2635605, "num_only_roped": 2635605, "total_diff": 5271210, "diff_percentage": 0.5426688421971375, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:04:25.104915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.051025390625, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.435546875, "l2_diff_relative": 0.058808016877637134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:06:00.342551", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4588613315514733, "overlap_percentage": 0.6290677826980065, "num_intersection": 4782284, "num_union": 10422068, "num_only_computed": 2819892, "num_only_roped": 2819892, "total_diff": 5639784, "diff_percentage": 0.5411386684485268, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:06:03.424249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 1.3053417205810547e-05, "l2_diff": 0.5078125, "l2_diff_relative": 0.07004310344827586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:07:44.565471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4512167398632691, "overlap_percentage": 0.6218461067445816, "num_intersection": 5053410, "num_union": 11199518, "num_only_computed": 3073054, "num_only_roped": 3073054, "total_diff": 6146108, "diff_percentage": 0.5487832601367308, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:07:47.902166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 1.2755393981933594e-05, "l2_diff": 0.490234375, "l2_diff_relative": 0.0694137168141593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:09:35.935983", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44160014704709716, "overlap_percentage": 0.6126527497262666, "num_intersection": 5299907, "num_union": 12001597, "num_only_computed": 3350845, "num_only_roped": 3350845, "total_diff": 6701690, "diff_percentage": 0.5583998529529028, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 16384, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 16384, 128], "mask_shape": [1, 32, 1024, 16384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:09:39.520964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 1.239776611328125e-05, "l2_diff": 0.58984375, "l2_diff_relative": 0.0824235807860262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 16384, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 16384, 128], "attention_shape": [1, 32, 1024, 16384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:11:24.429823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.475079579645053, "overlap_percentage": 0.6441409483268299, "num_intersection": 98055, "num_union": 206397, "num_only_computed": 54171, "num_only_roped": 54171, "total_diff": 108342, "diff_percentage": 0.524920420354947, "num_computed": 152226, "num_roped": 152226}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 18, "seq_len_k": 16402, "queries_shape": [1, 32, 18, 128], "keys_shape": [1, 8, 16402, 128], "mask_shape": [1, 32, 18, 16402], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:11:29.962930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 1.2218952178955078e-05, "l2_diff": 0.1171875, "l2_diff_relative": 0.08333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 18, "seq_len_k": 16402, "queries_shape": [1, 32, 18, 128], "keys_shape": [1, 8, 16402, 128], "attention_shape": [1, 32, 18, 16402]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:13:10.057488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.446327567833429, "overlap_percentage": 0.6171873893021608, "num_intersection": 130674, "num_union": 292776, "num_only_computed": 81051, "num_only_roped": 81051, "total_diff": 162102, "diff_percentage": 0.553672432166571, "num_computed": 211725, "num_roped": 211725}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16427, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16427, 128], "mask_shape": [1, 32, 25, 16427], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:13:13.369840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.14453125, "l2_diff_relative": 0.11011904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16427, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16427, 128], "attention_shape": [1, 32, 25, 16427]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:14:44.959826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4645111091899369, "overlap_percentage": 0.6343565525383708, "num_intersection": 5373, "num_union": 11567, "num_only_computed": 3097, "num_only_roped": 3097, "total_diff": 6194, "diff_percentage": 0.5354888908100631, "num_computed": 8470, "num_roped": 8470}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16428, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16428, 128], "mask_shape": [1, 32, 1, 16428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:14:47.583399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010986328125, "mean_diff": 1.4841556549072266e-05, "l2_diff": 0.0245361328125, "l2_diff_relative": 0.11525229357798165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16428, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16428, 128], "attention_shape": [1, 32, 1, 16428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:16:08.510898", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4692107545533391, "overlap_percentage": 0.6387249114521841, "num_intersection": 5410, "num_union": 11530, "num_only_computed": 3060, "num_only_roped": 3060, "total_diff": 6120, "diff_percentage": 0.5307892454466608, "num_computed": 8470, "num_roped": 8470}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16429, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16429, 128], "mask_shape": [1, 32, 1, 16429], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:16:11.143257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.52587890625e-05, "l2_diff": 0.0179443359375, "l2_diff_relative": 0.08352272727272728}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16429, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16429, 128], "attention_shape": [1, 32, 1, 16429]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:17:32.971689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4644308064655545, "overlap_percentage": 0.6342816668634164, "num_intersection": 5373, "num_union": 11569, "num_only_computed": 3098, "num_only_roped": 3098, "total_diff": 6196, "diff_percentage": 0.5355691935344455, "num_computed": 8471, "num_roped": 8471}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16430, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16430, 128], "mask_shape": [1, 32, 1, 16430], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:17:35.641868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.07177734375, "l2_diff_relative": 0.2433774834437086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16430, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16430, 128], "attention_shape": [1, 32, 1, 16430]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:18:56.391183", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4474156343442973, "overlap_percentage": 0.6182268917483178, "num_intersection": 5237, "num_union": 11705, "num_only_computed": 3234, "num_only_roped": 3234, "total_diff": 6468, "diff_percentage": 0.5525843656557027, "num_computed": 8471, "num_roped": 8471}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16431, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16431, 128], "mask_shape": [1, 32, 1, 16431], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:18:59.030595", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.046875, "l2_diff_relative": 0.23645320197044334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16431, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16431, 128], "attention_shape": [1, 32, 1, 16431]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:20:19.655865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48034247772147476, "overlap_percentage": 0.648961284230406, "num_intersection": 5498, "num_union": 11446, "num_only_computed": 2974, "num_only_roped": 2974, "total_diff": 5948, "diff_percentage": 0.5196575222785252, "num_computed": 8472, "num_roped": 8472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16432, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16432, 128], "mask_shape": [1, 32, 1, 16432], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:20:22.300284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.060302734375, "l2_diff_relative": 0.25729166666666664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16432, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16432, 128], "attention_shape": [1, 32, 1, 16432]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:21:43.034820", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4505607396627001, "overlap_percentage": 0.621222851746931, "num_intersection": 5263, "num_union": 11681, "num_only_computed": 3209, "num_only_roped": 3209, "total_diff": 6418, "diff_percentage": 0.5494392603372998, "num_computed": 8472, "num_roped": 8472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16433, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16433, 128], "mask_shape": [1, 32, 1, 16433], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:21:45.640286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 1.7881393432617188e-05, "l2_diff": 0.05322265625, "l2_diff_relative": 0.15935672514619884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16433, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16433, 128], "attention_shape": [1, 32, 1, 16433]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:33.844868", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:33.857385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.032470703125, "l2_diff_relative": 0.0031678734756097563}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:39.707359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7569649462146663, "overlap_percentage": 0.8616733621755254, "num_intersection": 1115350, "num_union": 1473450, "num_only_computed": 195370, "num_only_roped": 162730, "total_diff": 358100, "diff_percentage": 0.24303505378533374, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:40.087588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.09326171875, "l2_diff_relative": 0.010082347972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:55.479893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.631932012319032, "overlap_percentage": 0.774458748953683, "num_intersection": 1421138, "num_union": 2248878, "num_only_computed": 413870, "num_only_roped": 413870, "total_diff": 827740, "diff_percentage": 0.36806798768096805, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:56.019639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.0966796875, "l2_diff_relative": 0.010668103448275863}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:23:16.224328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5678515785035242, "overlap_percentage": 0.7243690490722656, "num_intersection": 1709001, "num_union": 3009591, "num_only_computed": 650295, "num_only_roped": 650295, "total_diff": 1300590, "diff_percentage": 0.43214842149647575, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:23:16.952285", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.115234375, "l2_diff_relative": 0.016032608695652175}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:23:43.693926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5333539298926444, "overlap_percentage": 0.6956696943803267, "num_intersection": 2006022, "num_union": 3761146, "num_only_computed": 877562, "num_only_roped": 877562, "total_diff": 1755124, "diff_percentage": 0.4666460701073556, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:23:44.604092", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 7.12275505065918e-06, "l2_diff": 0.1845703125, "l2_diff_relative": 0.023815524193548387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:24:16.594928", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5070554113524717, "overlap_percentage": 0.6729087829589844, "num_intersection": 2293187, "num_union": 4522557, "num_only_computed": 1114685, "num_only_roped": 1114685, "total_diff": 2229370, "diff_percentage": 0.4929445886475284, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:24:17.672643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 6.377696990966797e-06, "l2_diff": 0.20703125, "l2_diff_relative": 0.024356617647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:24:55.501513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4986902239596971, "overlap_percentage": 0.6655014038085938, "num_intersection": 2616858, "num_union": 5247462, "num_only_computed": 1315302, "num_only_roped": 1315302, "total_diff": 2630604, "diff_percentage": 0.5013097760403029, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:24:56.801452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.6954879760742188e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.018465909090909092}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:25:40.797115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4765157862964881, "overlap_percentage": 0.6454597921932445, "num_intersection": 2876458, "num_union": 6036438, "num_only_computed": 1579990, "num_only_roped": 1579990, "total_diff": 3159980, "diff_percentage": 0.523484213703512, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:25:42.304027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.5315752029418945e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.021805555555555557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:33.502530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47122004013651375, "overlap_percentage": 0.6405840421977796, "num_intersection": 3190580, "num_union": 6770892, "num_only_computed": 1790156, "num_only_roped": 1790156, "total_diff": 3580312, "diff_percentage": 0.5287799598634862, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:35.257847", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0264892578125, "mean_diff": 1.3470649719238281e-05, "l2_diff": 0.283203125, "l2_diff_relative": 0.036989795918367346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:27:33.955538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4622921522137227, "overlap_percentage": 0.6322842552548363, "num_intersection": 3480740, "num_union": 7529308, "num_only_computed": 2024284, "num_only_roped": 2024284, "total_diff": 4048568, "diff_percentage": 0.5377078477862773, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:27:35.970768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.245737075805664e-05, "l2_diff": 0.3046875, "l2_diff_relative": 0.040289256198347105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:28:43.462276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.467845702805232, "overlap_percentage": 0.6374589671259341, "num_intersection": 3843439, "num_union": 8215185, "num_only_computed": 2185873, "num_only_roped": 2185873, "total_diff": 4371746, "diff_percentage": 0.532154297194768, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:28:48.122870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.050537109375, "mean_diff": 1.1742115020751953e-05, "l2_diff": 0.3203125, "l2_diff_relative": 0.04555555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:30:02.102742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4553541102217108, "overlap_percentage": 0.6257640075683594, "num_intersection": 4101007, "num_union": 9006193, "num_only_computed": 2452593, "num_only_roped": 2452593, "total_diff": 4905186, "diff_percentage": 0.5446458897782892, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:30:04.630149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.515625, "l2_diff_relative": 0.06818181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:31:26.803517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44984378802366654, "overlap_percentage": 0.6205410427517362, "num_intersection": 4392120, "num_union": 9763656, "num_only_computed": 2685768, "num_only_roped": 2685768, "total_diff": 5371536, "diff_percentage": 0.5501562119763335, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:31:29.601576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 1.3172626495361328e-05, "l2_diff": 0.62890625, "l2_diff_relative": 0.07509328358208955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:33:01.725365", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44878716909691496, "overlap_percentage": 0.6195349857724947, "num_intersection": 4709814, "num_union": 10494538, "num_only_computed": 2892362, "num_only_roped": 2892362, "total_diff": 5784724, "diff_percentage": 0.551212830903085, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:33:04.857177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 1.3709068298339844e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.07973251028806584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:34:46.374723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4543304395134374, "overlap_percentage": 0.6247967135521674, "num_intersection": 5077388, "num_union": 11175540, "num_only_computed": 3049076, "num_only_roped": 3049076, "total_diff": 6098152, "diff_percentage": 0.5456695604865626, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:34:51.413040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 1.4960765838623047e-05, "l2_diff": 0.703125, "l2_diff_relative": 0.09259259259259259}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:36:33.861768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4435280486665779, "overlap_percentage": 0.6145056191686411, "num_intersection": 892696, "num_union": 2012716, "num_only_computed": 560010, "num_only_roped": 560010, "total_diff": 1120020, "diff_percentage": 0.5564719513334221, "num_computed": 1452706, "num_roped": 1452706}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 181, "seq_len_k": 15541, "queries_shape": [1, 32, 181, 128], "keys_shape": [1, 8, 15541, 128], "mask_shape": [1, 32, 181, 15541], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:36:39.217412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.09644396551724138}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 181, "seq_len_k": 15541, "queries_shape": [1, 32, 181, 128], "keys_shape": [1, 8, 15541, 128], "attention_shape": [1, 32, 181, 15541]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:38:17.377422", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4433372124678775, "overlap_percentage": 0.6143224308750984, "num_intersection": 148193, "num_union": 334267, "num_only_computed": 93037, "num_only_roped": 93037, "total_diff": 186074, "diff_percentage": 0.5566627875321225, "num_computed": 241230, "num_roped": 241230}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15571, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15571, 128], "mask_shape": [1, 32, 30, 15571], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:38:20.446871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.09521484375, "l2_diff_relative": 0.06380890052356021}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15571, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15571, 128], "attention_shape": [1, 32, 30, 15571]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:39:45.475757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47735831725911637, "overlap_percentage": 0.646232280527232, "num_intersection": 5197, "num_union": 10887, "num_only_computed": 2845, "num_only_roped": 2845, "total_diff": 5690, "diff_percentage": 0.5226416827408836, "num_computed": 8042, "num_roped": 8042}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15572, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15572, 128], "mask_shape": [1, 32, 1, 15572], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:39:47.860284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.2934207916259766e-05, "l2_diff": 0.023193359375, "l2_diff_relative": 0.08731617647058823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15572, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15572, 128], "attention_shape": [1, 32, 1, 15572]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:41:01.219745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4478350886668467, "overlap_percentage": 0.6186272071623974, "num_intersection": 4975, "num_union": 11109, "num_only_computed": 3067, "num_only_roped": 3067, "total_diff": 6134, "diff_percentage": 0.5521649113331533, "num_computed": 8042, "num_roped": 8042}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15573, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15573, 128], "mask_shape": [1, 32, 1, 15573], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:41:05.353788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.2636184692382812e-05, "l2_diff": 0.0164794921875, "l2_diff_relative": 0.04635989010989011}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15573, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15573, 128], "attention_shape": [1, 32, 1, 15573]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:19.488121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4377904898105113, "overlap_percentage": 0.608976749968917, "num_intersection": 4898, "num_union": 11188, "num_only_computed": 3145, "num_only_roped": 3145, "total_diff": 6290, "diff_percentage": 0.5622095101894887, "num_computed": 8043, "num_roped": 8043}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15574, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15574, 128], "mask_shape": [1, 32, 1, 15574], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:21.890803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023681640625, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.0439453125, "l2_diff_relative": 0.14331210191082802}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15574, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15574, 128], "attention_shape": [1, 32, 1, 15574]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:43:37.551789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.429358450328772, "overlap_percentage": 0.6007708566455303, "num_intersection": 4832, "num_union": 11254, "num_only_computed": 3211, "num_only_roped": 3211, "total_diff": 6422, "diff_percentage": 0.570641549671228, "num_computed": 8043, "num_roped": 8043}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15575, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15575, 128], "mask_shape": [1, 32, 1, 15575], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:43:39.949316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0277099609375, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.23958333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15575, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15575, 128], "attention_shape": [1, 32, 1, 15575]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:44:54.716516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43437945791726107, "overlap_percentage": 0.6056688214818499, "num_intersection": 4872, "num_union": 11216, "num_only_computed": 3172, "num_only_roped": 3172, "total_diff": 6344, "diff_percentage": 0.5656205420827389, "num_computed": 8044, "num_roped": 8044}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15576, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15576, 128], "mask_shape": [1, 32, 1, 15576], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:44:57.154460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0133056640625, "mean_diff": 2.753734588623047e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.18854748603351956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15576, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15576, 128], "attention_shape": [1, 32, 1, 15576]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:46:11.863808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4038394415357766, "overlap_percentage": 0.5753356539035306, "num_intersection": 4628, "num_union": 11460, "num_only_computed": 3416, "num_only_roped": 3416, "total_diff": 6832, "diff_percentage": 0.5961605584642233, "num_computed": 8044, "num_roped": 8044}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15577, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15577, 128], "mask_shape": [1, 32, 1, 15577], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:46:14.448131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 1.5616416931152344e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.14859437751004015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15577, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15577, 128], "attention_shape": [1, 32, 1, 15577]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:47:29.694926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4128907622058307, "overlap_percentage": 0.5844623990055935, "num_intersection": 4702, "num_union": 11388, "num_only_computed": 3343, "num_only_roped": 3343, "total_diff": 6686, "diff_percentage": 0.5871092377941693, "num_computed": 8045, "num_roped": 8045}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15578, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15578, 128], "mask_shape": [1, 32, 1, 15578], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:47:32.375100", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.0234375, "l2_diff_relative": 0.1111111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15578, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15578, 128], "attention_shape": [1, 32, 1, 15578]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:15.080424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:15.091996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.030517578125, "l2_diff_relative": 0.0030709512578616354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:21.103669", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7518026894177259, "overlap_percentage": 0.85831891223733, "num_intersection": 1111008, "num_union": 1477792, "num_only_computed": 199712, "num_only_roped": 167072, "total_diff": 366784, "diff_percentage": 0.2481973105822741, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:21.501940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.099609375, "l2_diff_relative": 0.012073863636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:37.229550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.626948173282081, "overlap_percentage": 0.7707045418875558, "num_intersection": 1414249, "num_union": 2255767, "num_only_computed": 420759, "num_only_roped": 420759, "total_diff": 841518, "diff_percentage": 0.373051826717919, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:37.777799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.11083984375, "l2_diff_relative": 0.014418191056910569}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:58.216371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5697167179804492, "overlap_percentage": 0.725884755452474, "num_intersection": 1712577, "num_union": 3006015, "num_only_computed": 646719, "num_only_roped": 646719, "total_diff": 1293438, "diff_percentage": 0.4302832820195508, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:58.961545", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 6.139278411865234e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.01689369658119658}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:49:25.473359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5342697240496624, "overlap_percentage": 0.6964482394131747, "num_intersection": 2008267, "num_union": 3758901, "num_only_computed": 875317, "num_only_roped": 875317, "total_diff": 1750634, "diff_percentage": 0.4657302759503376, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:49:26.397132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 8.881092071533203e-06, "l2_diff": 0.201171875, "l2_diff_relative": 0.027277542372881356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:49:58.876586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5126127927551648, "overlap_percentage": 0.6777845529409555, "num_intersection": 2309803, "num_union": 4505941, "num_only_computed": 1098069, "num_only_roped": 1098069, "total_diff": 2196138, "diff_percentage": 0.4873872072448352, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:49:59.994840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.874301910400391e-06, "l2_diff": 0.12451171875, "l2_diff_relative": 0.016396604938271605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:50:39.323774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4953532609315687, "overlap_percentage": 0.6625233968098958, "num_intersection": 2605148, "num_union": 5259172, "num_only_computed": 1327012, "num_only_roped": 1327012, "total_diff": 2654024, "diff_percentage": 0.5046467390684313, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:50:40.647962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.380941390991211e-06, "l2_diff": 0.1728515625, "l2_diff_relative": 0.02018704379562044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:51:25.461138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48490627554737503, "overlap_percentage": 0.6531136456657859, "num_intersection": 2910567, "num_union": 6002329, "num_only_computed": 1545881, "num_only_roped": 1545881, "total_diff": 3091762, "diff_percentage": 0.515093724452625, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:51:29.042606", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.1591796875, "l2_diff_relative": 0.01944179389312977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:52:22.176517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4663283030199544, "overlap_percentage": 0.6360489694695723, "num_intersection": 3167992, "num_union": 6793480, "num_only_computed": 1812744, "num_only_roped": 1812744, "total_diff": 3625488, "diff_percentage": 0.5336716969800456, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:52:25.961686", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 1.1086463928222656e-05, "l2_diff": 0.248046875, "l2_diff_relative": 0.03674768518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:53:25.567577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4644886981470508, "overlap_percentage": 0.6343356541224888, "num_intersection": 3492033, "num_union": 7518015, "num_only_computed": 2012991, "num_only_roped": 2012991, "total_diff": 4025982, "diff_percentage": 0.5355113018529493, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:53:27.589366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.039794921875, "mean_diff": 1.436471939086914e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.04846398305084746}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:54:35.190544", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.454416333777186, "overlap_percentage": 0.6248779296875, "num_intersection": 3767584, "num_union": 8291040, "num_only_computed": 2261728, "num_only_roped": 2261728, "total_diff": 4523456, "diff_percentage": 0.5455836662228141, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:54:37.506853", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029052734375, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.2421875, "l2_diff_relative": 0.028703703703703703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:55:56.026159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45080333120702626, "overlap_percentage": 0.6214533996582031, "num_intersection": 4072757, "num_union": 9034443, "num_only_computed": 2480843, "num_only_roped": 2480843, "total_diff": 4961686, "diff_percentage": 0.5491966687929737, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:55:58.597206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.034912109375, "mean_diff": 9.59634780883789e-06, "l2_diff": 0.328125, "l2_diff_relative": 0.041176470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:57:22.517808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45315368390450794, "overlap_percentage": 0.6236830817328559, "num_intersection": 4414359, "num_union": 9741417, "num_only_computed": 2663529, "num_only_roped": 2663529, "total_diff": 5327058, "diff_percentage": 0.5468463160954921, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:57:25.360403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 1.0251998901367188e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.05570652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:58:51.323755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4475265319460226, "overlap_percentage": 0.6183327518624171, "num_intersection": 421813, "num_union": 942543, "num_only_computed": 260365, "num_only_roped": 260365, "total_diff": 520730, "diff_percentage": 0.5524734680539773, "num_computed": 682178, "num_roped": 682178}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 98, "seq_len_k": 13410, "queries_shape": [1, 32, 98, 128], "keys_shape": [1, 8, 13410, 128], "mask_shape": [1, 32, 98, 13410], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:58:55.478434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.29296875, "l2_diff_relative": 0.11094674556213018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 98, "seq_len_k": 13410, "queries_shape": [1, 32, 98, 128], "keys_shape": [1, 8, 13410, 128], "attention_shape": [1, 32, 98, 13410]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:00:15.402453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4346043609186228, "overlap_percentage": 0.6058874108542815, "num_intersection": 143748, "num_union": 330756, "num_only_computed": 93504, "num_only_roped": 93504, "total_diff": 187008, "diff_percentage": 0.5653956390813772, "num_computed": 237252, "num_roped": 237252}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13444, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13444, 128], "mask_shape": [1, 32, 34, 13444], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:00:18.260204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.11474609375, "l2_diff_relative": 0.07896505376344086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13444, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13444, 128], "attention_shape": [1, 32, 34, 13444]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:01:30.077133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4412888567592688, "overlap_percentage": 0.612353109773574, "num_intersection": 4273, "num_union": 9683, "num_only_computed": 2705, "num_only_roped": 2705, "total_diff": 5410, "diff_percentage": 0.5587111432407311, "num_computed": 6978, "num_roped": 6978}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13445, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13445, 128], "mask_shape": [1, 32, 1, 13445], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:01:32.084070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.3232231140136719e-05, "l2_diff": 0.020751953125, "l2_diff_relative": 0.09004237288135593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13445, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13445, 128], "attention_shape": [1, 32, 1, 13445]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:02:35.446102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44522675502174364, "overlap_percentage": 0.6161341166356211, "num_intersection": 4300, "num_union": 9658, "num_only_computed": 2679, "num_only_roped": 2679, "total_diff": 5358, "diff_percentage": 0.5547732449782564, "num_computed": 6979, "num_roped": 6979}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13446, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13446, 128], "mask_shape": [1, 32, 1, 13446], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:02:37.476558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01080322265625, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.0206298828125, "l2_diff_relative": 0.11480978260869565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13446, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13446, 128], "attention_shape": [1, 32, 1, 13446]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:03:41.044344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45577805590321235, "overlap_percentage": 0.6261642069064336, "num_intersection": 4370, "num_union": 9588, "num_only_computed": 2609, "num_only_roped": 2609, "total_diff": 5218, "diff_percentage": 0.5442219440967877, "num_computed": 6979, "num_roped": 6979}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13447, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13447, 128], "mask_shape": [1, 32, 1, 13447], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:03:43.835579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.0788440704345703e-05, "l2_diff": 0.0269775390625, "l2_diff_relative": 0.09727112676056338}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13447, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13447, 128], "attention_shape": [1, 32, 1, 13447]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:04:47.163023", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43947205609404, "overlap_percentage": 0.6106017191977078, "num_intersection": 4262, "num_union": 9698, "num_only_computed": 2718, "num_only_roped": 2718, "total_diff": 5436, "diff_percentage": 0.56052794390596, "num_computed": 6980, "num_roped": 6980}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13448, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13448, 128], "mask_shape": [1, 32, 1, 13448], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:04:49.186523", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.0283203125, "l2_diff_relative": 0.12831858407079647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13448, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13448, 128], "attention_shape": [1, 32, 1, 13448]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:05:52.529972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4224577134705523, "overlap_percentage": 0.5939828080229226, "num_intersection": 4146, "num_union": 9814, "num_only_computed": 2834, "num_only_roped": 2834, "total_diff": 5668, "diff_percentage": 0.5775422865294477, "num_computed": 6980, "num_roped": 6980}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13449, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13449, 128], "mask_shape": [1, 32, 1, 13449], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:05:54.545082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.1026859283447266e-05, "l2_diff": 0.017333984375, "l2_diff_relative": 0.071}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13449, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13449, 128], "attention_shape": [1, 32, 1, 13449]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:31.629795", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:31.642360", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.0030780261075949366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:37.447575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7485582904546603, "overlap_percentage": 0.8562005562422744, "num_intersection": 1108266, "num_union": 1480534, "num_only_computed": 202454, "num_only_roped": 169814, "total_diff": 372268, "diff_percentage": 0.25144170954533973, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:37.826244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.834766387939453e-06, "l2_diff": 0.12255859375, "l2_diff_relative": 0.015084134615384616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:52.896609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6198205140767086, "overlap_percentage": 0.7652953011648995, "num_intersection": 1404323, "num_union": 2265693, "num_only_computed": 430685, "num_only_roped": 430685, "total_diff": 861370, "diff_percentage": 0.3801794859232915, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:53.423090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.015871062992125984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:13.343759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5581431825919323, "overlap_percentage": 0.71642091539171, "num_intersection": 1690249, "num_union": 3028343, "num_only_computed": 669047, "num_only_roped": 669047, "total_diff": 1338094, "diff_percentage": 0.4418568174080677, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:14.062353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 8.52346420288086e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.021146616541353382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:40.287164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5279621917869192, "overlap_percentage": 0.6910670887340199, "num_intersection": 1992750, "num_union": 3774418, "num_only_computed": 890834, "num_only_roped": 890834, "total_diff": 1781668, "diff_percentage": 0.4720378082130808, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:41.192481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.036592483520508e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.016917293233082706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:12.977538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5031902087827892, "overlap_percentage": 0.6694963895357572, "num_intersection": 2281558, "num_union": 4534186, "num_only_computed": 1126314, "num_only_roped": 1126314, "total_diff": 2252628, "diff_percentage": 0.49680979121721075, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:14.070689", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.021214430894308942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:51.845847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4843095014213988, "overlap_percentage": 0.6525721232096354, "num_intersection": 2566018, "num_union": 5298302, "num_only_computed": 1366142, "num_only_roped": 1366142, "total_diff": 2732284, "diff_percentage": 0.5156904985786013, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:53.140554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.022899797570850203}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:09:37.966373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4728843503757279, "overlap_percentage": 0.6421201369341683, "num_intersection": 2861575, "num_union": 6051321, "num_only_computed": 1594873, "num_only_roped": 1594873, "total_diff": 3189746, "diff_percentage": 0.5271156496242722, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:09:39.479875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.02050395256916996}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:10:31.549477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4664152930991361, "overlap_percentage": 0.6361298812063116, "num_intersection": 3168395, "num_union": 6793077, "num_only_computed": 1812341, "num_only_roped": 1812341, "total_diff": 3624682, "diff_percentage": 0.5335847069008639, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:10:33.314517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0213623046875, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.255859375, "l2_diff_relative": 0.03638888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:11:32.947845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.465213507692537, "overlap_percentage": 0.6350112188430059, "num_intersection": 3495752, "num_union": 7514296, "num_only_computed": 2009272, "num_only_roped": 2009272, "total_diff": 4018544, "diff_percentage": 0.534786492307463, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:11:36.817868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 1.3649463653564453e-05, "l2_diff": 0.322265625, "l2_diff_relative": 0.04603794642857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:12:44.142051", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4580835959331996, "overlap_percentage": 0.6283365332561991, "num_intersection": 3788437, "num_union": 8270187, "num_only_computed": 2240875, "num_only_roped": 2240875, "total_diff": 4481750, "diff_percentage": 0.5419164040668004, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:12:46.428231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 1.4424324035644531e-05, "l2_diff": 0.416015625, "l2_diff_relative": 0.05689102564102564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:14:02.131430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44827722610801685, "overlap_percentage": 0.6190489196777343, "num_intersection": 4056999, "num_union": 9050201, "num_only_computed": 2496601, "num_only_roped": 2496601, "total_diff": 4993202, "diff_percentage": 0.5517227738919832, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:14:04.713996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 1.4126300811767578e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.061958874458874456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:15:30.757685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44555021640707076, "overlap_percentage": 0.6164437753182871, "num_intersection": 4363120, "num_union": 9792656, "num_only_computed": 2714768, "num_only_roped": 2714768, "total_diff": 5429536, "diff_percentage": 0.5544497835929292, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:15:33.589668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.44921875, "l2_diff_relative": 0.06014644351464435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:17:06.006143", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4482591763821487, "overlap_percentage": 0.6190317088160021, "num_intersection": 4705988, "num_union": 10498364, "num_only_computed": 2896188, "num_only_roped": 2896188, "total_diff": 5792376, "diff_percentage": 0.5517408236178513, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:17:09.340820", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.41796875, "l2_diff_relative": 0.05459183673469388}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:18:49.054425", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44463819354806594, "overlap_percentage": 0.615570314468876, "num_intersection": 5002410, "num_union": 11250518, "num_only_computed": 3124054, "num_only_roped": 3124054, "total_diff": 6248108, "diff_percentage": 0.555361806451934, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:18:52.386763", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 1.1026859283447266e-05, "l2_diff": 0.5078125, "l2_diff_relative": 0.057624113475177305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:39.756538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4403226797775558, "overlap_percentage": 0.6114222680233842, "num_intersection": 3445949, "num_union": 7825963, "num_only_computed": 2190007, "num_only_roped": 2190007, "total_diff": 4380014, "diff_percentage": 0.5596773202224442, "num_computed": 5635956, "num_roped": 5635956}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 681, "seq_len_k": 16041, "queries_shape": [1, 32, 681, 128], "keys_shape": [1, 8, 16041, 128], "mask_shape": [1, 32, 681, 16041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:43.241241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06396484375, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.57421875, "l2_diff_relative": 0.0900735294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 681, "seq_len_k": 16041, "queries_shape": [1, 32, 681, 128], "keys_shape": [1, 8, 16041, 128], "attention_shape": [1, 32, 681, 16041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:22:29.135964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46387989402413893, "overlap_percentage": 0.6337676962676962, "num_intersection": 126064, "num_union": 271760, "num_only_computed": 72848, "num_only_roped": 72848, "total_diff": 145696, "diff_percentage": 0.536120105975861, "num_computed": 198912, "num_roped": 198912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16065, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16065, 128], "mask_shape": [1, 32, 24, 16065], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:22:32.370077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 1.5616416931152344e-05, "l2_diff": 0.1318359375, "l2_diff_relative": 0.09375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16065, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16065, 128], "attention_shape": [1, 32, 24, 16065]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:24:02.061323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4588173178458289, "overlap_percentage": 0.6290264205573651, "num_intersection": 5214, "num_union": 11364, "num_only_computed": 3075, "num_only_roped": 3075, "total_diff": 6150, "diff_percentage": 0.5411826821541711, "num_computed": 8289, "num_roped": 8289}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16066, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16066, 128], "mask_shape": [1, 32, 1, 16066], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:24:06.797131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.4662742614746094e-05, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.11436170212765957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16066, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16066, 128], "attention_shape": [1, 32, 1, 16066]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:25:25.489339", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4647464216292631, "overlap_percentage": 0.6345759440221981, "num_intersection": 5260, "num_union": 11318, "num_only_computed": 3029, "num_only_roped": 3029, "total_diff": 6058, "diff_percentage": 0.5352535783707368, "num_computed": 8289, "num_roped": 8289}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16067, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16067, 128], "mask_shape": [1, 32, 1, 16067], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:25:30.132317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.0302734375, "l2_diff_relative": 0.12653061224489795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16067, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16067, 128], "attention_shape": [1, 32, 1, 16067]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:26:48.116237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44475426978041127, "overlap_percentage": 0.6156815440289506, "num_intersection": 5104, "num_union": 11476, "num_only_computed": 3186, "num_only_roped": 3186, "total_diff": 6372, "diff_percentage": 0.5552457302195887, "num_computed": 8290, "num_roped": 8290}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16068, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16068, 128], "mask_shape": [1, 32, 1, 16068], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:26:51.313346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.1682510375976562e-05, "l2_diff": 0.033935546875, "l2_diff_relative": 0.11430921052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16068, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16068, 128], "attention_shape": [1, 32, 1, 16068]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:27:37.332393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:27:37.346051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.003080432046979866}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:27:43.317610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7452823510614415, "overlap_percentage": 0.8540536155747837, "num_intersection": 1105487, "num_union": 1483313, "num_only_computed": 205233, "num_only_roped": 172593, "total_diff": 377826, "diff_percentage": 0.25471764893855847, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:27:43.707398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.13671875, "l2_diff_relative": 0.01608455882352941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:01.190558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.626068736771634, "overlap_percentage": 0.7700396946498326, "num_intersection": 1413029, "num_union": 2256987, "num_only_computed": 421979, "num_only_roped": 421979, "total_diff": 843958, "diff_percentage": 0.37393126322836595, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:01.742624", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.119140625, "l2_diff_relative": 0.015754132231404958}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:22.224908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5550729289772147, "overlap_percentage": 0.7138866848415799, "num_intersection": 1684270, "num_union": 3034322, "num_only_computed": 675026, "num_only_roped": 675026, "total_diff": 1350052, "diff_percentage": 0.44492707102278534, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:22.961597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 8.52346420288086e-06, "l2_diff": 0.169921875, "l2_diff_relative": 0.02166334661354582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:49.460580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5205488264668505, "overlap_percentage": 0.6846854469992898, "num_intersection": 1974348, "num_union": 3792820, "num_only_computed": 909236, "num_only_roped": 909236, "total_diff": 1818472, "diff_percentage": 0.4794511735331495, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:50.392550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 8.225440979003906e-06, "l2_diff": 0.1904296875, "l2_diff_relative": 0.02447289156626506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:29:23.350401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5010499595762811, "overlap_percentage": 0.6675993112417368, "num_intersection": 2275093, "num_union": 4540651, "num_only_computed": 1132779, "num_only_roped": 1132779, "total_diff": 2265558, "diff_percentage": 0.498950040423719, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:29:26.263201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 7.599592208862305e-06, "l2_diff": 0.22265625, "l2_diff_relative": 0.028051181102362203}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:04.723695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4877107118190439, "overlap_percentage": 0.6556526184082031, "num_intersection": 2578131, "num_union": 5286189, "num_only_computed": 1354029, "num_only_roped": 1354029, "total_diff": 2708058, "diff_percentage": 0.5122892881809561, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:08.132584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.1708984375, "l2_diff_relative": 0.02567488262910798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:52.434304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4726604575065666, "overlap_percentage": 0.6419136944939109, "num_intersection": 2860655, "num_union": 6052241, "num_only_computed": 1595793, "num_only_roped": 1595793, "total_diff": 3191586, "diff_percentage": 0.5273395424934334, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:53.928532", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.591179847717285e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.019767992424242424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:31:45.287924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47579767966589087, "overlap_percentage": 0.6448006880910773, "num_intersection": 3211582, "num_union": 6749890, "num_only_computed": 1769154, "num_only_roped": 1769154, "total_diff": 3538308, "diff_percentage": 0.5242023203341092, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:31:47.039831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0220947265625, "mean_diff": 9.59634780883789e-06, "l2_diff": 0.25, "l2_diff_relative": 0.028169014084507043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:32:45.487262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4582408526579204, "overlap_percentage": 0.6284844534737724, "num_intersection": 3459822, "num_union": 7550226, "num_only_computed": 2045202, "num_only_roped": 2045202, "total_diff": 4090404, "diff_percentage": 0.5417591473420795, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:32:47.499158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0274658203125, "mean_diff": 8.106231689453125e-06, "l2_diff": 0.2392578125, "l2_diff_relative": 0.029000946969696968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:33:53.963673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45481833265791977, "overlap_percentage": 0.6252579067064368, "num_intersection": 3769875, "num_union": 8288749, "num_only_computed": 2259437, "num_only_roped": 2259437, "total_diff": 4518874, "diff_percentage": 0.5451816673420802, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:33:56.222343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.32421875, "l2_diff_relative": 0.04611111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:35:10.672753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45641251746734984, "overlap_percentage": 0.6267626953125, "num_intersection": 4107552, "num_union": 8999648, "num_only_computed": 2446048, "num_only_roped": 2446048, "total_diff": 4892096, "diff_percentage": 0.5435874825326502, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:35:13.449504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 1.633167266845703e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.07924107142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:36:35.449283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4556162163312729, "overlap_percentage": 0.6260114599157263, "num_intersection": 4430839, "num_union": 9724937, "num_only_computed": 2647049, "num_only_roped": 2647049, "total_diff": 5294098, "diff_percentage": 0.5443837836687271, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:36:39.866914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04443359375, "mean_diff": 8.761882781982422e-06, "l2_diff": 0.392578125, "l2_diff_relative": 0.050049800796812746}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:38:10.111914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4613815041096799, "overlap_percentage": 0.6314319742136988, "num_intersection": 4800257, "num_union": 10404095, "num_only_computed": 2801919, "num_only_roped": 2801919, "total_diff": 5603838, "diff_percentage": 0.5386184958903201, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:38:13.149876", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 1.0132789611816406e-05, "l2_diff": 0.44140625, "l2_diff_relative": 0.0601063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:39:53.612748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4592790825921681, "overlap_percentage": 0.6294602424867691, "num_intersection": 5115286, "num_union": 11137642, "num_only_computed": 3011178, "num_only_roped": 3011178, "total_diff": 6022356, "diff_percentage": 0.5407209174078319, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:39:56.990814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 1.4424324035644531e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.0930493273542601}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:41:38.507064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4607812749341461, "overlap_percentage": 0.6308696350929316, "num_intersection": 1452407, "num_union": 3152053, "num_only_computed": 849823, "num_only_roped": 849823, "total_diff": 1699646, "diff_percentage": 0.5392187250658539, "num_computed": 2302230, "num_roped": 2302230}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 285, "seq_len_k": 15645, "queries_shape": [1, 32, 285, 128], "keys_shape": [1, 8, 15645, 128], "mask_shape": [1, 32, 285, 15645], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:41:41.762446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 285, "seq_len_k": 15645, "queries_shape": [1, 32, 285, 128], "keys_shape": [1, 8, 15645, 128], "attention_shape": [1, 32, 285, 15645]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:43:19.690112", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4666997845102475, "overlap_percentage": 0.6363944270518666, "num_intersection": 139042, "num_union": 297926, "num_only_computed": 79442, "num_only_roped": 79442, "total_diff": 158884, "diff_percentage": 0.5333002154897525, "num_computed": 218484, "num_roped": 218484}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15672, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15672, 128], "mask_shape": [1, 32, 27, 15672], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:43:22.772557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.11279296875, "l2_diff_relative": 0.0849264705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15672, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15672, 128], "attention_shape": [1, 32, 27, 15672]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:44:47.829649", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46527840651878677, "overlap_percentage": 0.6350716757291152, "num_intersection": 5139, "num_union": 11045, "num_only_computed": 2953, "num_only_roped": 2953, "total_diff": 5906, "diff_percentage": 0.5347215934812132, "num_computed": 8092, "num_roped": 8092}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15673, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15673, 128], "mask_shape": [1, 32, 1, 15673], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:44:50.224975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0145263671875, "mean_diff": 1.0073184967041016e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.11948529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15673, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15673, 128], "attention_shape": [1, 32, 1, 15673]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:46:03.829913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47884878940155323, "overlap_percentage": 0.6475966884962313, "num_intersection": 5241, "num_union": 10945, "num_only_computed": 2852, "num_only_roped": 2852, "total_diff": 5704, "diff_percentage": 0.5211512105984468, "num_computed": 8093, "num_roped": 8093}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15674, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15674, 128], "mask_shape": [1, 32, 1, 15674], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:46:06.978668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.52587890625e-05, "l2_diff": 0.038330078125, "l2_diff_relative": 0.1699134199134199}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15674, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15674, 128], "attention_shape": [1, 32, 1, 15674]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:47:23.128070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4575416479063485, "overlap_percentage": 0.6278265167428642, "num_intersection": 5081, "num_union": 11105, "num_only_computed": 3012, "num_only_roped": 3012, "total_diff": 6024, "diff_percentage": 0.5424583520936516, "num_computed": 8093, "num_roped": 8093}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15675, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15675, 128], "mask_shape": [1, 32, 1, 15675], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:47:25.688678", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.329183578491211e-05, "l2_diff": 0.0252685546875, "l2_diff_relative": 0.11057692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15675, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15675, 128], "attention_shape": [1, 32, 1, 15675]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:48:40.144513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43867756843227873, "overlap_percentage": 0.6098344452680998, "num_intersection": 4936, "num_union": 11252, "num_only_computed": 3158, "num_only_roped": 3158, "total_diff": 6316, "diff_percentage": 0.5613224315677213, "num_computed": 8094, "num_roped": 8094}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15676, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15676, 128], "mask_shape": [1, 32, 1, 15676], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:48:43.888682", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 1.424551010131836e-05, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.12267441860465116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15676, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15676, 128], "attention_shape": [1, 32, 1, 15676]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:49:59.992346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47835616438356166, "overlap_percentage": 0.6471460340993328, "num_intersection": 5238, "num_union": 10950, "num_only_computed": 2856, "num_only_roped": 2856, "total_diff": 5712, "diff_percentage": 0.5216438356164383, "num_computed": 8094, "num_roped": 8094}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15677, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15677, 128], "mask_shape": [1, 32, 1, 15677], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:50:03.285474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.17025862068965517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15677, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15677, 128], "attention_shape": [1, 32, 1, 15677]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:51:21.256675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4374500577110894, "overlap_percentage": 0.6086473131562693, "num_intersection": 4927, "num_union": 11263, "num_only_computed": 3168, "num_only_roped": 3168, "total_diff": 6336, "diff_percentage": 0.5625499422889106, "num_computed": 8095, "num_roped": 8095}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15678, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15678, 128], "mask_shape": [1, 32, 1, 15678], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:51:23.713609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.055419921875, "l2_diff_relative": 0.20413669064748202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15678, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15678, 128], "attention_shape": [1, 32, 1, 15678]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:52:40.179825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4483807478976561, "overlap_percentage": 0.6191476219888821, "num_intersection": 5012, "num_union": 11178, "num_only_computed": 3083, "num_only_roped": 3083, "total_diff": 6166, "diff_percentage": 0.5516192521023439, "num_computed": 8095, "num_roped": 8095}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15679, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15679, 128], "mask_shape": [1, 32, 1, 15679], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:52:42.639404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.2159347534179688e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.15120967741935484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15679, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15679, 128], "attention_shape": [1, 32, 1, 15679]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
