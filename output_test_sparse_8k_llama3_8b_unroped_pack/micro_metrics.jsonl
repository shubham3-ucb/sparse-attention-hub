{"timestamp": "2025-11-11T15:53:58.888748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:53:58.942067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 9.052455425262451e-07, "l2_diff": 0.0556640625, "l2_diff_relative": 0.0030711206896551725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:54:26.967185", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:54:28.730192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 7.450580596923828e-06, "l2_diff": 0.609375, "l2_diff_relative": 0.03721374045801527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:55:36.116128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16936868707214428, "overlap_percentage": 0.28967542733884594, "num_intersection": 1261292, "num_union": 7447020, "num_only_computed": 3092864, "num_only_roped": 3092864, "total_diff": 6185728, "diff_percentage": 0.8306313129278557, "num_computed": 4354156, "num_roped": 4354156}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3137, "seq_len_k": 11329, "queries_shape": [1, 32, 3137, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 3137, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:55:39.072707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 6.961822509765625e-05, "l2_diff": 6.6875, "l2_diff_relative": 0.6772151898734177}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3137, "seq_len_k": 11329, "queries_shape": [1, 32, 3137, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 3137, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:56:47.378239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1504186912023157, "overlap_percentage": 0.26150251617541337, "num_intersection": 10185, "num_union": 67711, "num_only_computed": 28763, "num_only_roped": 28763, "total_diff": 57526, "diff_percentage": 0.8495813087976842, "num_computed": 38948, "num_roped": 38948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:56:49.022167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.35546875, "l2_diff_relative": 0.30743243243243246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:57:35.774190", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13690232938291785, "overlap_percentage": 0.24083393242271747, "num_intersection": 335, "num_union": 2447, "num_only_computed": 1056, "num_only_roped": 1056, "total_diff": 2112, "diff_percentage": 0.8630976706170821, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:57:37.123198", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.10884353741496598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:58:18.606812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13969684555510037, "overlap_percentage": 0.24514737598849748, "num_intersection": 341, "num_union": 2441, "num_only_computed": 1050, "num_only_roped": 1050, "total_diff": 2100, "diff_percentage": 0.8603031544448996, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:58:19.953902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.0546875, "l2_diff_relative": 0.20588235294117646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:59:01.407653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14804123711340206, "overlap_percentage": 0.2579022988505747, "num_intersection": 359, "num_union": 2425, "num_only_computed": 1033, "num_only_roped": 1033, "total_diff": 2066, "diff_percentage": 0.8519587628865979, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:59:02.754679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08642578125, "mean_diff": 6.341934204101562e-05, "l2_diff": 0.1279296875, "l2_diff_relative": 0.48518518518518516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:59:44.307875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1395824805566926, "overlap_percentage": 0.2449712643678161, "num_intersection": 341, "num_union": 2443, "num_only_computed": 1051, "num_only_roped": 1051, "total_diff": 2102, "diff_percentage": 0.8604175194433074, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T15:59:45.655313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 4.1961669921875e-05, "l2_diff": 0.049072265625, "l2_diff_relative": 0.30640243902439024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:00:27.105090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1442663378545006, "overlap_percentage": 0.2521551724137931, "num_intersection": 351, "num_union": 2433, "num_only_computed": 1041, "num_only_roped": 1041, "total_diff": 2082, "diff_percentage": 0.8557336621454994, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "mask_shape": [1, 32, 1, 11362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:00:28.450223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.10809426229508197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "attention_shape": [1, 32, 1, 11362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:00:57.074406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:00:57.113374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 9.052455425262451e-07, "l2_diff": 0.058349609375, "l2_diff_relative": 0.0031119791666666665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:01:25.121604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:01:26.906003", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 1.1920928955078125e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.05534351145038168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:02:40.944418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1635370203551752, "overlap_percentage": 0.28110325240060646, "num_intersection": 1708676, "num_union": 10448252, "num_only_computed": 4369788, "num_only_roped": 4369788, "total_diff": 8739576, "diff_percentage": 0.8364629796448247, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:02:44.891232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2080078125, "mean_diff": 6.246566772460938e-05, "l2_diff": 7.375, "l2_diff_relative": 0.6413043478260869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:04:34.451094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1358953350467077, "overlap_percentage": 0.23927439589514596, "num_intersection": 1784998, "num_union": 13135094, "num_only_computed": 5675048, "num_only_roped": 5675048, "total_diff": 11350096, "diff_percentage": 0.8641046649532923, "num_computed": 7460046, "num_roped": 7460046}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3966, "seq_len_k": 16254, "queries_shape": [1, 32, 3966, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 3966, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:04:41.352408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1962890625, "mean_diff": 6.151199340820312e-05, "l2_diff": 8.25, "l2_diff_relative": 0.9635036496350365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3966, "seq_len_k": 16254, "queries_shape": [1, 32, 3966, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 3966, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:06:29.370910", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12828890601810838, "overlap_percentage": 0.22740435598335917, "num_intersection": 22302, "num_union": 173842, "num_only_computed": 75770, "num_only_roped": 75770, "total_diff": 151540, "diff_percentage": 0.8717110939818916, "num_computed": 98072, "num_roped": 98072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:06:32.355086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.5546875, "l2_diff_relative": 0.44936708860759494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:07:46.132828", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14268403514086642, "overlap_percentage": 0.24973488865323437, "num_intersection": 471, "num_union": 3301, "num_only_computed": 1415, "num_only_roped": 1415, "total_diff": 2830, "diff_percentage": 0.8573159648591336, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:07:48.140176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.040771484375, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.08447265625, "l2_diff_relative": 0.8398058252427184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:08:49.987012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1489491318915626, "overlap_percentage": 0.25927889713679747, "num_intersection": 489, "num_union": 3283, "num_only_computed": 1397, "num_only_roped": 1397, "total_diff": 2794, "diff_percentage": 0.8510508681084374, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:08:51.995160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.046875, "l2_diff_relative": 0.43636363636363634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:09:52.861403", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1296795447738844, "overlap_percentage": 0.2295864262990456, "num_intersection": 433, "num_union": 3339, "num_only_computed": 1453, "num_only_roped": 1453, "total_diff": 2906, "diff_percentage": 0.8703204552261156, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:09:54.814504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.059814453125, "l2_diff_relative": 0.3561046511627907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:10:32.420154", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:10:32.459169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 9.164214134216309e-07, "l2_diff": 0.05517578125, "l2_diff_relative": 0.003130540780141844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:11:00.584331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:11:02.416092", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 7.450580596923828e-06, "l2_diff": 0.65625, "l2_diff_relative": 0.03804347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:12:16.385045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15683775380496914, "overlap_percentage": 0.2711490929287399, "num_intersection": 1648170, "num_union": 10508758, "num_only_computed": 4430294, "num_only_roped": 4430294, "total_diff": 8860588, "diff_percentage": 0.8431622461950309, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:12:20.047790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1884765625, "mean_diff": 6.67572021484375e-05, "l2_diff": 7.96875, "l2_diff_relative": 0.75}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:14:10.308143", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13221503315799418, "overlap_percentage": 0.23355109989878456, "num_intersection": 1764057, "num_union": 13342333, "num_only_computed": 5789138, "num_only_roped": 5789138, "total_diff": 11578276, "diff_percentage": 0.8677849668420058, "num_computed": 7553195, "num_roped": 7553195}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4007, "seq_len_k": 16295, "queries_shape": [1, 32, 4007, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 4007, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:14:17.543216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.21484375, "mean_diff": 6.341934204101562e-05, "l2_diff": 9.375, "l2_diff_relative": 1.0416666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4007, "seq_len_k": 16295, "queries_shape": [1, 32, 4007, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 4007, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:16:02.729183", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12493669251929017, "overlap_percentage": 0.22212217514124294, "num_intersection": 12581, "num_union": 100699, "num_only_computed": 44059, "num_only_roped": 44059, "total_diff": 88118, "diff_percentage": 0.8750633074807098, "num_computed": 56640, "num_roped": 56640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:16:07.421085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.40234375, "l2_diff_relative": 0.37050359712230213}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:17:16.577484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1271641791044776, "overlap_percentage": 0.225635593220339, "num_intersection": 426, "num_union": 3350, "num_only_computed": 1462, "num_only_roped": 1462, "total_diff": 2924, "diff_percentage": 0.8728358208955224, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:17:18.540599", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.0791015625, "l2_diff_relative": 0.6721991701244814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:18:18.167271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1271641791044776, "overlap_percentage": 0.225635593220339, "num_intersection": 426, "num_union": 3350, "num_only_computed": 1462, "num_only_roped": 1462, "total_diff": 2924, "diff_percentage": 0.8728358208955224, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "mask_shape": [1, 32, 1, 16327], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:18:20.105166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05126953125, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.0947265625, "l2_diff_relative": 0.8981481481481481}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "attention_shape": [1, 32, 1, 16327]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:18:57.594625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:18:57.633601", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 9.387731552124023e-07, "l2_diff": 0.053466796875, "l2_diff_relative": 0.003122148722627737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:19:25.624098", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:19:27.418321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 1.5854835510253906e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.07251082251082251}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:20:41.648598", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1611859200812424, "overlap_percentage": 0.27762293237238883, "num_intersection": 1687521, "num_union": 10469407, "num_only_computed": 4390943, "num_only_roped": 4390943, "total_diff": 8781886, "diff_percentage": 0.8388140799187576, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:20:46.438754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1953125, "mean_diff": 6.580352783203125e-05, "l2_diff": 7.34375, "l2_diff_relative": 0.7121212121212122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:22:35.542374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13615512011871528, "overlap_percentage": 0.23967699076951504, "num_intersection": 1826331, "num_union": 13413605, "num_only_computed": 5793637, "num_only_roped": 5793637, "total_diff": 11587274, "diff_percentage": 0.8638448798812847, "num_computed": 7619968, "num_roped": 7619968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4036, "seq_len_k": 16324, "queries_shape": [1, 32, 4036, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 4036, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:22:42.387034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2001953125, "mean_diff": 5.888938903808594e-05, "l2_diff": 8.0625, "l2_diff_relative": 0.9214285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4036, "seq_len_k": 16324, "queries_shape": [1, 32, 4036, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 4036, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:24:26.257203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13131917439425667, "overlap_percentage": 0.2321523003701745, "num_intersection": 13609, "num_union": 103633, "num_only_computed": 45012, "num_only_roped": 45012, "total_diff": 90024, "diff_percentage": 0.8686808256057433, "num_computed": 58621, "num_roped": 58621}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:24:28.768448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.2922297297297297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:25:37.505623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1347134713471347, "overlap_percentage": 0.2374405076679006, "num_intersection": 449, "num_union": 3333, "num_only_computed": 1442, "num_only_roped": 1442, "total_diff": 2884, "diff_percentage": 0.8652865286528653, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:25:41.955375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.57763671875e-05, "l2_diff": 0.06298828125, "l2_diff_relative": 0.4215686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:26:17.040908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:26:17.085534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 8.605420589447021e-07, "l2_diff": 0.0634765625, "l2_diff_relative": 0.003134645061728395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:26:47.527955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:26:51.305007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.0728836059570312e-05, "l2_diff": 0.875, "l2_diff_relative": 0.05185185185185185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:28:04.675468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16148612633531806, "overlap_percentage": 0.2780681106279481, "num_intersection": 1690227, "num_union": 10466701, "num_only_computed": 4388237, "num_only_roped": 4388237, "total_diff": 8776474, "diff_percentage": 0.8385138736646819, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:28:08.257594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2158203125, "mean_diff": 7.486343383789062e-05, "l2_diff": 8.75, "l2_diff_relative": 0.8860759493670886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:29:45.755449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14799773247350165, "overlap_percentage": 0.2578362801372829, "num_intersection": 967016, "num_union": 6533992, "num_only_computed": 2783488, "num_only_roped": 2783488, "total_diff": 5566976, "diff_percentage": 0.8520022675264983, "num_computed": 3750504, "num_roped": 3750504}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 2201, "seq_len_k": 14489, "queries_shape": [1, 32, 2201, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 2201, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:29:51.565533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1982421875, "mean_diff": 6.866455078125e-05, "l2_diff": 6.59375, "l2_diff_relative": 0.9017094017094017}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 2201, "seq_len_k": 14489, "queries_shape": [1, 32, 2201, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 2201, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:31:16.133165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13950351157777624, "overlap_percentage": 0.24484963874243312, "num_intersection": 10031, "num_union": 71905, "num_only_computed": 30937, "num_only_roped": 30937, "total_diff": 61874, "diff_percentage": 0.8604964884222238, "num_computed": 40968, "num_roped": 40968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:31:18.321528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.269050598144531e-05, "l2_diff": 0.4609375, "l2_diff_relative": 0.466403162055336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:32:20.131772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14448541736506873, "overlap_percentage": 0.252489748096075, "num_intersection": 431, "num_union": 2983, "num_only_computed": 1276, "num_only_roped": 1276, "total_diff": 2552, "diff_percentage": 0.8555145826349313, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:32:21.843155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.10302734375, "l2_diff_relative": 1.0656565656565657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:33:16.506064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1467920725562647, "overlap_percentage": 0.2560046865846514, "num_intersection": 437, "num_union": 2977, "num_only_computed": 1270, "num_only_roped": 1270, "total_diff": 2540, "diff_percentage": 0.8532079274437353, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14515, 128], "mask_shape": [1, 32, 1, 14515], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:33:18.211433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.09130859375, "l2_diff_relative": 0.46984924623115576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14515, 128], "attention_shape": [1, 32, 1, 14515]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:34:12.069458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15885947046843177, "overlap_percentage": 0.2741652021089631, "num_intersection": 468, "num_union": 2946, "num_only_computed": 1239, "num_only_roped": 1239, "total_diff": 2478, "diff_percentage": 0.8411405295315683, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14516, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14516, 128], "mask_shape": [1, 32, 1, 14516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:34:13.786323", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.453416149068323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14516, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14516, 128], "attention_shape": [1, 32, 1, 14516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:34:48.659997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:34:48.697923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 8.903443813323975e-07, "l2_diff": 0.058349609375, "l2_diff_relative": 0.0031119791666666665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:35:16.608470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:35:18.400548", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 9.953975677490234e-06, "l2_diff": 0.82421875, "l2_diff_relative": 0.04778079710144927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:36:33.301729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15511279400702233, "overlap_percentage": 0.2685673551739387, "num_intersection": 1632477, "num_union": 10524451, "num_only_computed": 4445987, "num_only_roped": 4445987, "total_diff": 8891974, "diff_percentage": 0.8448872059929777, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:36:36.818418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2158203125, "mean_diff": 7.343292236328125e-05, "l2_diff": 9.125, "l2_diff_relative": 0.8342857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:38:12.512944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14262675752919354, "overlap_percentage": 0.249647151336817, "num_intersection": 984159, "num_union": 6900241, "num_only_computed": 2958041, "num_only_roped": 2958041, "total_diff": 5916082, "diff_percentage": 0.8573732424708065, "num_computed": 3942200, "num_roped": 3942200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 2300, "seq_len_k": 14588, "queries_shape": [1, 32, 2300, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 2300, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:38:17.250330", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 6.532669067382812e-05, "l2_diff": 6.25, "l2_diff_relative": 0.8888888888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 2300, "seq_len_k": 14588, "queries_shape": [1, 32, 2300, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 2300, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:39:42.708902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.131298165467996, "overlap_percentage": 0.23211947031431898, "num_intersection": 12761, "num_union": 97191, "num_only_computed": 42215, "num_only_roped": 42215, "total_diff": 84430, "diff_percentage": 0.868701834532004, "num_computed": 54976, "num_roped": 54976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:39:44.931166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.49609375, "l2_diff_relative": 0.47388059701492535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:40:46.094589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14190761050182785, "overlap_percentage": 0.24854481955762514, "num_intersection": 427, "num_union": 3009, "num_only_computed": 1291, "num_only_roped": 1291, "total_diff": 2582, "diff_percentage": 0.8580923894981721, "num_computed": 1718, "num_roped": 1718}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:40:50.129814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 7.581710815429688e-05, "l2_diff": 0.115234375, "l2_diff_relative": 0.9402390438247012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:41:22.676304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:41:22.716609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 9.164214134216309e-07, "l2_diff": 0.05615234375, "l2_diff_relative": 0.00314138986013986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:41:51.207927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:41:53.047126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 1.0669231414794922e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.0531478102189781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:43:06.101705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15509380667660908, "overlap_percentage": 0.26853889403638814, "num_intersection": 1632304, "num_union": 10524624, "num_only_computed": 4446160, "num_only_roped": 4446160, "total_diff": 8892320, "diff_percentage": 0.8449061933233909, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:43:10.714290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 7.343292236328125e-05, "l2_diff": 8.25, "l2_diff_relative": 0.8516129032258064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:44:55.602108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13809584727676322, "overlap_percentage": 0.2426787648987545, "num_intersection": 1565246, "num_union": 11334490, "num_only_computed": 4884622, "num_only_roped": 4884622, "total_diff": 9769244, "diff_percentage": 0.8619041527232367, "num_computed": 6449868, "num_roped": 6449868}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3513, "seq_len_k": 15801, "queries_shape": [1, 32, 3513, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 3513, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:45:00.294085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 5.745887756347656e-05, "l2_diff": 7.1875, "l2_diff_relative": 0.8156028368794326}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3513, "seq_len_k": 15801, "queries_shape": [1, 32, 3513, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 3513, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:46:38.079714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13437825466421507, "overlap_percentage": 0.2369196590496917, "num_intersection": 10451, "num_union": 77773, "num_only_computed": 33661, "num_only_roped": 33661, "total_diff": 67322, "diff_percentage": 0.865621745335785, "num_computed": 44112, "num_roped": 44112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:46:40.378441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.1875, "l2_diff_relative": 0.16901408450704225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:47:45.843758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1419695557626592, "overlap_percentage": 0.2486398258977149, "num_intersection": 457, "num_union": 3219, "num_only_computed": 1381, "num_only_roped": 1381, "total_diff": 2762, "diff_percentage": 0.8580304442373408, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:47:49.761099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04443359375, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.09326171875, "l2_diff_relative": 0.6452702702702703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:48:47.277582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13843295137813563, "overlap_percentage": 0.24319912948857453, "num_intersection": 447, "num_union": 3229, "num_only_computed": 1391, "num_only_roped": 1391, "total_diff": 2782, "diff_percentage": 0.8615670486218644, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:48:49.147485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.06396484375, "l2_diff_relative": 0.3638888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:49:46.639137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.128992628992629, "overlap_percentage": 0.22850924918389554, "num_intersection": 420, "num_union": 3256, "num_only_computed": 1418, "num_only_roped": 1418, "total_diff": 2836, "diff_percentage": 0.871007371007371, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:49:48.504431", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.087890625, "l2_diff_relative": 0.4639175257731959}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:50:46.027914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13247073321010475, "overlap_percentage": 0.23394994559303592, "num_intersection": 430, "num_union": 3246, "num_only_computed": 1408, "num_only_roped": 1408, "total_diff": 2816, "diff_percentage": 0.8675292667898953, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "mask_shape": [1, 32, 1, 15829], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:50:49.634391", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.08837890625, "l2_diff_relative": 0.4393203883495146}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "attention_shape": [1, 32, 1, 15829]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:51:47.419191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1337854500616523, "overlap_percentage": 0.2359978249048396, "num_intersection": 434, "num_union": 3244, "num_only_computed": 1405, "num_only_roped": 1405, "total_diff": 2810, "diff_percentage": 0.8662145499383477, "num_computed": 1839, "num_roped": 1839}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "mask_shape": [1, 32, 1, 15830], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:51:49.294862", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012451171875, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.16855203619909503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "attention_shape": [1, 32, 1, 15830]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:19.982873", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4986289, "num_union": 4986289, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4986289, "num_roped": 4986289}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 2233, "seq_len_k": 2233, "queries_shape": [1, 32, 2233, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 2233, 2233], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:19.998143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.6242265701293945e-06, "l2_diff": 0.0400390625, "l2_diff_relative": 0.002979651162790698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 2233, "seq_len_k": 2233, "queries_shape": [1, 32, 2233, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 2233, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:25.413800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 12025, "num_union": 12025, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 12025, "num_roped": 12025}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:27.582531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 9.012222290039062e-05, "l2_diff": 0.11328125, "l2_diff_relative": 0.09731543624161074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:37.912031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 481, "num_union": 481, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 481, "num_roped": 481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:38.230800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.867813110351562e-05, "l2_diff": 0.020751953125, "l2_diff_relative": 0.09703196347031963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:50.576981", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 482, "num_union": 482, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 482, "num_roped": 482}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:52:50.895941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.0115966796875, "l2_diff_relative": 0.048868312757201646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:53:00.677423", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 482, "num_union": 482, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 482, "num_roped": 482}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "mask_shape": [1, 32, 1, 2261], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:53:00.988833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00634765625, "mean_diff": 4.9591064453125e-05, "l2_diff": 0.011474609375, "l2_diff_relative": 0.05439814814814815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "attention_shape": [1, 32, 1, 2261]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:53:10.525869", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:53:10.559796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 8.977949619293213e-07, "l2_diff": 0.057861328125, "l2_diff_relative": 0.003127639358108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:53:38.513188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:53:40.287994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.76953125, "l2_diff_relative": 0.04131711409395973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:54:52.774248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1573552938992591, "overlap_percentage": 0.27192219144582913, "num_intersection": 1566519, "num_union": 9955299, "num_only_computed": 4194390, "num_only_roped": 4194390, "total_diff": 8388780, "diff_percentage": 0.8426447061007409, "num_computed": 5760909, "num_roped": 5760909}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3927, "seq_len_k": 12119, "queries_shape": [1, 32, 3927, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 3927, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:54:56.327067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.22265625, "mean_diff": 7.963180541992188e-05, "l2_diff": 9.125, "l2_diff_relative": 0.906832298136646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3927, "seq_len_k": 12119, "queries_shape": [1, 32, 3927, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 3927, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:56:11.447417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14745658242993365, "overlap_percentage": 0.2570146612740142, "num_intersection": 16268, "num_union": 110324, "num_only_computed": 47028, "num_only_roped": 47028, "total_diff": 94056, "diff_percentage": 0.8525434175700664, "num_computed": 63296, "num_roped": 63296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:56:13.575765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 6.866455078125e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.6027397260273972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:57:04.440471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15768777034998033, "overlap_percentage": 0.27241847826086957, "num_intersection": 401, "num_union": 2543, "num_only_computed": 1071, "num_only_roped": 1071, "total_diff": 2142, "diff_percentage": 0.8423122296500196, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:57:06.377811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 9.918212890625e-05, "l2_diff": 0.1318359375, "l2_diff_relative": 1.5517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:57:51.375433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16134122287968442, "overlap_percentage": 0.27785326086956524, "num_intersection": 409, "num_union": 2535, "num_only_computed": 1063, "num_only_roped": 1063, "total_diff": 2126, "diff_percentage": 0.8386587771203156, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:57:52.797568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 9.34600830078125e-05, "l2_diff": 0.1552734375, "l2_diff_relative": 1.4196428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:58:36.666718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14064316156528478, "overlap_percentage": 0.24660326086956522, "num_intersection": 363, "num_union": 2581, "num_only_computed": 1109, "num_only_roped": 1109, "total_diff": 2218, "diff_percentage": 0.8593568384347152, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:58:38.091447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.06787109375, "l2_diff_relative": 0.4186746987951807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:59:03.264394", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:59:03.298384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 9.08970832824707e-07, "l2_diff": 0.056396484375, "l2_diff_relative": 0.0030902183219178084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:59:31.203942", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 4403200, "num_union": 4403200, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "roped_vs_roped", "extend_context": true, "unroped_used": false}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T16:59:32.964438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.0371208190917969e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.049577067669172935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:00:24.247924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20082571691698653, "overlap_percentage": 0.3344793737972047, "num_intersection": 198657, "num_union": 989201, "num_only_computed": 395272, "num_only_roped": 395272, "total_diff": 790544, "diff_percentage": 0.7991742830830134, "num_computed": 593929, "num_roped": 593929}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 527, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:00:26.169096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 5.888938903808594e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.3277027027027027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 527, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:01:09.218037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18519577022006287, "overlap_percentage": 0.31251507113576077, "num_intersection": 11664, "num_union": 62982, "num_only_computed": 25659, "num_only_roped": 25659, "total_diff": 51318, "diff_percentage": 0.8148042297799372, "num_computed": 37323, "num_roped": 37323}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:01:10.475891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.40234375, "l2_diff_relative": 0.3301282051282051}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:01:46.485400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1899000526038927, "overlap_percentage": 0.3191865605658709, "num_intersection": 361, "num_union": 1901, "num_only_computed": 770, "num_only_roped": 770, "total_diff": 1540, "diff_percentage": 0.8100999473961074, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:01:48.002348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.0771484375, "l2_diff_relative": 0.5096774193548387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:02:21.764361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1987281399046105, "overlap_percentage": 0.33156498673740054, "num_intersection": 375, "num_union": 1887, "num_only_computed": 756, "num_only_roped": 756, "total_diff": 1512, "diff_percentage": 0.8012718600953895, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:02:22.805389", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 5.4836273193359375e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.25140449438202245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:02:54.954860", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18181818181818182, "overlap_percentage": 0.3076923076923077, "num_intersection": 348, "num_union": 1914, "num_only_computed": 783, "num_only_roped": 783, "total_diff": 1566, "diff_percentage": 0.8181818181818182, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-11T17:02:55.996016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.16569767441860464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
