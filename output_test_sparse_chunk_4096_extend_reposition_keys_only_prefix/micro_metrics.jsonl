{"timestamp": "2025-11-09T21:43:33.478564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:33.718398", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:33.785151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:33.836111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.066394805908203e-07, "l2_diff": 0.1181640625, "l2_diff_relative": 0.0027640716374269006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:33.996081", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2285599451009596, "overlap_percentage": 0.3720778070494186, "num_intersection": 1638333, "num_union": 7168067, "num_only_computed": 2764867, "num_only_roped": 2764867, "total_diff": 5529734, "diff_percentage": 0.7714400548990404, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:42.330377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5692983206455108, "overlap_percentage": 0.7255450581395348, "num_intersection": 3194720, "num_union": 5611680, "num_only_computed": 1208480, "num_only_roped": 1208480, "total_diff": 2416960, "diff_percentage": 0.4307016793544892, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:43.786595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3502676953544376, "overlap_percentage": 0.5188122274709303, "num_intersection": 2284434, "num_union": 6521966, "num_only_computed": 2118766, "num_only_roped": 2118766, "total_diff": 4237532, "diff_percentage": 0.6497323046455624, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:44.237611", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1923828125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.703125, "l2_diff_relative": 0.016544117647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:44.408892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18173102072744962, "overlap_percentage": 0.30756748793067934, "num_intersection": 1352787, "num_union": 7443897, "num_only_computed": 3045555, "num_only_roped": 3045555, "total_diff": 6091110, "diff_percentage": 0.8182689792725504, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:50.649017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5279695166339622, "overlap_percentage": 0.6910733635538119, "num_intersection": 3039577, "num_union": 5757107, "num_only_computed": 1358765, "num_only_roped": 1358765, "total_diff": 2717530, "diff_percentage": 0.4720304833660378, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:52.904665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28660043149538994, "overlap_percentage": 0.4455158330116212, "num_intersection": 1959531, "num_union": 6837153, "num_only_computed": 2438811, "num_only_roped": 2438811, "total_diff": 4877622, "diff_percentage": 0.7133995685046101, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:53.435319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.69140625, "l2_diff_relative": 0.018686655405405407}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "attention_shape": [1, 32, 3162, 11354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:53.462627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1714461501523132, "overlap_percentage": 0.2927085468333675, "num_intersection": 11425, "num_union": 66639, "num_only_computed": 27607, "num_only_roped": 27607, "total_diff": 55214, "diff_percentage": 0.8285538498476868, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:55.409943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5712100475002013, "overlap_percentage": 0.7270957163353147, "num_intersection": 28380, "num_union": 49684, "num_only_computed": 10652, "num_only_roped": 10652, "total_diff": 21304, "diff_percentage": 0.42878995249979873, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:55.911310", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3271225051851348, "overlap_percentage": 0.49298011887681903, "num_intersection": 19242, "num_union": 58822, "num_only_computed": 19790, "num_only_roped": 19790, "total_diff": 39580, "diff_percentage": 0.6728774948148651, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:56.071241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0308837890625, "mean_diff": 9.894371032714844e-06, "l2_diff": 0.09765625, "l2_diff_relative": 0.034340659340659344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "attention_shape": [1, 32, 28, 11382]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:56.079313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16995383969785985, "overlap_percentage": 0.29053084648493543, "num_intersection": 405, "num_union": 2383, "num_only_computed": 989, "num_only_roped": 989, "total_diff": 1978, "diff_percentage": 0.8300461603021402, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:56.923367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4861407249466951, "overlap_percentage": 0.6542324246771879, "num_intersection": 912, "num_union": 1876, "num_only_computed": 482, "num_only_roped": 482, "total_diff": 964, "diff_percentage": 0.5138592750533049, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:57.136285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34167468719923005, "overlap_percentage": 0.509325681492109, "num_intersection": 710, "num_union": 2078, "num_only_computed": 684, "num_only_roped": 684, "total_diff": 1368, "diff_percentage": 0.65832531280077, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:57.204403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 1.728534698486328e-05, "l2_diff": 0.08056640625, "l2_diff_relative": 0.15625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "attention_shape": [1, 32, 1, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:57.211366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1679932970255551, "overlap_percentage": 0.28766140602582496, "num_intersection": 401, "num_union": 2387, "num_only_computed": 993, "num_only_roped": 993, "total_diff": 1986, "diff_percentage": 0.8320067029744449, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:58.054582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4704641350210971, "overlap_percentage": 0.6398852223816356, "num_intersection": 892, "num_union": 1896, "num_only_computed": 502, "num_only_roped": 502, "total_diff": 1004, "diff_percentage": 0.5295358649789029, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:58.267498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2638259292837715, "overlap_percentage": 0.41750358680057387, "num_intersection": 582, "num_union": 2206, "num_only_computed": 812, "num_only_roped": 812, "total_diff": 1624, "diff_percentage": 0.7361740707162284, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:58.335683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.189453125, "l2_diff_relative": 0.4311111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:58.341774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17537942664418213, "overlap_percentage": 0.2984218077474892, "num_intersection": 416, "num_union": 2372, "num_only_computed": 978, "num_only_roped": 978, "total_diff": 1956, "diff_percentage": 0.8246205733558178, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:59.179330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46351706036745405, "overlap_percentage": 0.633428981348637, "num_intersection": 883, "num_union": 1905, "num_only_computed": 511, "num_only_roped": 511, "total_diff": 1022, "diff_percentage": 0.5364829396325459, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:59.391905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24910394265232974, "overlap_percentage": 0.3988522238163558, "num_intersection": 556, "num_union": 2232, "num_only_computed": 838, "num_only_roped": 838, "total_diff": 1676, "diff_percentage": 0.7508960573476703, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:43:59.460446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.25, "l2_diff_relative": 0.5844748858447488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:00.614452", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:00.854242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:00.922853", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:00.953190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.140900611877441e-07, "l2_diff": 0.11767578125, "l2_diff_relative": 0.002768841911764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:01.105426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23432062818263583, "overlap_percentage": 0.3796754632994186, "num_intersection": 1671787, "num_union": 7134613, "num_only_computed": 2731413, "num_only_roped": 2731413, "total_diff": 5462826, "diff_percentage": 0.7656793718173641, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:06.622930", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6342843399394567, "overlap_percentage": 0.7762227470930233, "num_intersection": 3417864, "num_union": 5388536, "num_only_computed": 985336, "num_only_roped": 985336, "total_diff": 1970672, "diff_percentage": 0.36571566006054335, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:08.098768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3424422986397528, "overlap_percentage": 0.5101780523255814, "num_intersection": 2246416, "num_union": 6559984, "num_only_computed": 2156784, "num_only_roped": 2156784, "total_diff": 4313568, "diff_percentage": 0.6575577013602473, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:08.554041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.933906555175781e-06, "l2_diff": 0.71484375, "l2_diff_relative": 0.016919378698224852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:08.774124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17801493472477584, "overlap_percentage": 0.30222865513392855, "num_intersection": 1837086, "num_union": 10319842, "num_only_computed": 4241378, "num_only_roped": 4241378, "total_diff": 8482756, "diff_percentage": 0.8219850652752242, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:16.293276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5229936190987563, "overlap_percentage": 0.6867968618387803, "num_intersection": 4174670, "num_union": 7982258, "num_only_computed": 1903794, "num_only_roped": 1903794, "total_diff": 3807588, "diff_percentage": 0.47700638090124375, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:21.756565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2703533080689282, "overlap_percentage": 0.42563483143109837, "num_intersection": 2587206, "num_union": 9569722, "num_only_computed": 3491258, "num_only_roped": 3491258, "total_diff": 6982516, "diff_percentage": 0.7296466919310718, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:22.375457", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 2.60770320892334e-06, "l2_diff": 0.70703125, "l2_diff_relative": 0.0167344674556213}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:22.897878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15096812353851818, "overlap_percentage": 0.26233241468822643, "num_intersection": 1971442, "num_union": 13058664, "num_only_computed": 5543611, "num_only_roped": 5543611, "total_diff": 11087222, "diff_percentage": 0.8490318764614818, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:33.039842", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5034718651682336, "overlap_percentage": 0.6697456425124347, "num_intersection": 5033174, "num_union": 9996932, "num_only_computed": 2481879, "num_only_roped": 2481879, "total_diff": 4963758, "diff_percentage": 0.4965281348317664, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:37.587288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2500703627457373, "overlap_percentage": 0.40009005924509117, "num_intersection": 3006698, "num_union": 12023408, "num_only_computed": 4508355, "num_only_roped": 4508355, "total_diff": 9016710, "diff_percentage": 0.7499296372542626, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:39.288357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.33203125, "mean_diff": 2.115964889526367e-06, "l2_diff": 0.85546875, "l2_diff_relative": 0.020865091463414635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "attention_shape": [1, 32, 3991, 16279]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:39.328860", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13948969589401822, "overlap_percentage": 0.24482835851284765, "num_intersection": 24049, "num_union": 172407, "num_only_computed": 74179, "num_only_roped": 74179, "total_diff": 148358, "diff_percentage": 0.8605103041059817, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:42.320347", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5752774392199628, "overlap_percentage": 0.7303823756973572, "num_intersection": 71744, "num_union": 124712, "num_only_computed": 26484, "num_only_roped": 26484, "total_diff": 52968, "diff_percentage": 0.42472256078003723, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:43.076022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2718809278717605, "overlap_percentage": 0.42752575640346946, "num_intersection": 41995, "num_union": 154461, "num_only_computed": 56233, "num_only_roped": 56233, "total_diff": 112466, "diff_percentage": 0.7281190721282395, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:43.327897", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.781650543212891e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.04141566265060241}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "attention_shape": [1, 32, 52, 16331]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:43.334146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1321546299071022, "overlap_percentage": 0.23345685547908945, "num_intersection": 441, "num_union": 3337, "num_only_computed": 1448, "num_only_roped": 1448, "total_diff": 2896, "diff_percentage": 0.8678453700928979, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:44.315644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.560512185047501, "overlap_percentage": 0.718369507676019, "num_intersection": 1357, "num_union": 2421, "num_only_computed": 532, "num_only_roped": 532, "total_diff": 1064, "diff_percentage": 0.43948781495249895, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:44.558301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20395156150414276, "overlap_percentage": 0.33880359978824776, "num_intersection": 640, "num_union": 3138, "num_only_computed": 1249, "num_only_roped": 1249, "total_diff": 2498, "diff_percentage": 0.7960484384958573, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:44.636837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.142578125, "l2_diff_relative": 0.2967479674796748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "attention_shape": [1, 32, 1, 16332]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:44.643323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14484848484848484, "overlap_percentage": 0.25304393859184754, "num_intersection": 478, "num_union": 3300, "num_only_computed": 1411, "num_only_roped": 1411, "total_diff": 2822, "diff_percentage": 0.8551515151515151, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:45.608719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3541218637992832, "overlap_percentage": 0.5230280571731075, "num_intersection": 988, "num_union": 2790, "num_only_computed": 901, "num_only_roped": 901, "total_diff": 1802, "diff_percentage": 0.6458781362007169, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:48.479270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22344559585492227, "overlap_percentage": 0.3652726310217046, "num_intersection": 690, "num_union": 3088, "num_only_computed": 1199, "num_only_roped": 1199, "total_diff": 2398, "diff_percentage": 0.7765544041450777, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:48.558096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.10595703125, "l2_diff_relative": 0.22604166666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "attention_shape": [1, 32, 1, 16333]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:48.564477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16389402341343193, "overlap_percentage": 0.28163049232398096, "num_intersection": 532, "num_union": 3246, "num_only_computed": 1357, "num_only_roped": 1357, "total_diff": 2714, "diff_percentage": 0.836105976586568, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:49.531861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3274771609276177, "overlap_percentage": 0.4933827421916358, "num_intersection": 932, "num_union": 2846, "num_only_computed": 957, "num_only_roped": 957, "total_diff": 1914, "diff_percentage": 0.6725228390723823, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:49.775971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18879798615481436, "overlap_percentage": 0.31762837480148226, "num_intersection": 600, "num_union": 3178, "num_only_computed": 1289, "num_only_roped": 1289, "total_diff": 2578, "diff_percentage": 0.8112020138451856, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:49.854986", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.0791015625, "l2_diff_relative": 0.15576923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "attention_shape": [1, 32, 1, 16334]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:49.861348", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1365824308062575, "overlap_percentage": 0.24033880359978824, "num_intersection": 454, "num_union": 3324, "num_only_computed": 1435, "num_only_roped": 1435, "total_diff": 2870, "diff_percentage": 0.8634175691937425, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:50.829654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3483226266952177, "overlap_percentage": 0.5166754896770778, "num_intersection": 976, "num_union": 2802, "num_only_computed": 913, "num_only_roped": 913, "total_diff": 1826, "diff_percentage": 0.6516773733047823, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:51.074355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23828253031792854, "overlap_percentage": 0.3848597141344627, "num_intersection": 727, "num_union": 3051, "num_only_computed": 1162, "num_only_roped": 1162, "total_diff": 2324, "diff_percentage": 0.7617174696820714, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:51.153406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.2373046875, "l2_diff_relative": 0.6044776119402985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "attention_shape": [1, 32, 1, 16335]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:51.159892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1493763310009127, "overlap_percentage": 0.2599258867125463, "num_intersection": 491, "num_union": 3287, "num_only_computed": 1398, "num_only_roped": 1398, "total_diff": 2796, "diff_percentage": 0.8506236689990874, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "mask_shape": [1, 32, 1, 16336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:52.127861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44695518958253544, "overlap_percentage": 0.617787188988883, "num_intersection": 1167, "num_union": 2611, "num_only_computed": 722, "num_only_roped": 722, "total_diff": 1444, "diff_percentage": 0.5530448104174646, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "mask_shape": [1, 32, 1, 16336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:52.371408", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2538997676734152, "overlap_percentage": 0.4049761778718899, "num_intersection": 765, "num_union": 3013, "num_only_computed": 1124, "num_only_roped": 1124, "total_diff": 2248, "diff_percentage": 0.7461002323265848, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "mask_shape": [1, 32, 1, 16336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:52.450519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.2333984375, "l2_diff_relative": 0.6096938775510204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "attention_shape": [1, 32, 1, 16336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:52.457020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1355575593627893, "overlap_percentage": 0.23875066172578083, "num_intersection": 451, "num_union": 3327, "num_only_computed": 1438, "num_only_roped": 1438, "total_diff": 2876, "diff_percentage": 0.8644424406372107, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "mask_shape": [1, 32, 1, 16337], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:53.424891", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3935817041682036, "overlap_percentage": 0.5648491265219693, "num_intersection": 1067, "num_union": 2711, "num_only_computed": 822, "num_only_roped": 822, "total_diff": 1644, "diff_percentage": 0.6064182958317964, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "mask_shape": [1, 32, 1, 16337], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:53.668401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2559840425531915, "overlap_percentage": 0.4076230809952356, "num_intersection": 770, "num_union": 3008, "num_only_computed": 1119, "num_only_roped": 1119, "total_diff": 2238, "diff_percentage": 0.7440159574468085, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "mask_shape": [1, 32, 1, 16337], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:53.747249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.11279296875, "l2_diff_relative": 0.23863636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "attention_shape": [1, 32, 1, 16337]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:53.753695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15996315627878416, "overlap_percentage": 0.27580730545262044, "num_intersection": 521, "num_union": 3257, "num_only_computed": 1368, "num_only_roped": 1368, "total_diff": 2736, "diff_percentage": 0.8400368437212159, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "mask_shape": [1, 32, 1, 16338], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:54.720374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3108952116585704, "overlap_percentage": 0.47432503970354684, "num_intersection": 896, "num_union": 2882, "num_only_computed": 993, "num_only_roped": 993, "total_diff": 1986, "diff_percentage": 0.6891047883414295, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "mask_shape": [1, 32, 1, 16338], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:54.965786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2093469910371319, "overlap_percentage": 0.3462149285336157, "num_intersection": 654, "num_union": 3124, "num_only_computed": 1235, "num_only_roped": 1235, "total_diff": 2470, "diff_percentage": 0.7906530089628682, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "mask_shape": [1, 32, 1, 16338], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:55.045108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.10400390625, "l2_diff_relative": 0.2173469387755102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "attention_shape": [1, 32, 1, 16338]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:56.130489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:56.370012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:56.434424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:56.464694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.029141902923584e-07, "l2_diff": 0.1181640625, "l2_diff_relative": 0.0027640716374269006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:44:56.615749", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23472576480538038, "overlap_percentage": 0.38020712209302326, "num_intersection": 1674128, "num_union": 7132272, "num_only_computed": 2729072, "num_only_roped": 2729072, "total_diff": 5458144, "diff_percentage": 0.7652742351946196, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:02.150043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5993485211874088, "overlap_percentage": 0.7494908248546511, "num_intersection": 3300158, "num_union": 5506242, "num_only_computed": 1103042, "num_only_roped": 1103042, "total_diff": 2206084, "diff_percentage": 0.4006514788125912, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:03.891134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33115505029923176, "overlap_percentage": 0.4975454215116279, "num_intersection": 2190792, "num_union": 6615608, "num_only_computed": 2212408, "num_only_roped": 2212408, "total_diff": 4424816, "diff_percentage": 0.6688449497007682, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:04.349453", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.4570693969726562e-06, "l2_diff": 0.64453125, "l2_diff_relative": 0.0152551775147929}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:04.569202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17502699572127967, "overlap_percentage": 0.2979114460495283, "num_intersection": 1810844, "num_union": 10346084, "num_only_computed": 4267620, "num_only_roped": 4267620, "total_diff": 8535240, "diff_percentage": 0.8249730042787203, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:12.057972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.504809055100079, "overlap_percentage": 0.6709277212137803, "num_intersection": 4078210, "num_union": 8078718, "num_only_computed": 2000254, "num_only_roped": 2000254, "total_diff": 4000508, "diff_percentage": 0.495190944899921, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:14.816677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2640116684449788, "overlap_percentage": 0.417736125442217, "num_intersection": 2539194, "num_union": 9617734, "num_only_computed": 3539270, "num_only_roped": 3539270, "total_diff": 7078540, "diff_percentage": 0.7359883315550212, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:17.074274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 2.384185791015625e-06, "l2_diff": 0.640625, "l2_diff_relative": 0.015073529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:17.351384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14837370763161395, "overlap_percentage": 0.258406660907654, "num_intersection": 1967099, "num_union": 13257733, "num_only_computed": 5645317, "num_only_roped": 5645317, "total_diff": 11290634, "diff_percentage": 0.851626292368386, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:27.569513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4980663661054833, "overlap_percentage": 0.6649456624546005, "num_intersection": 5061843, "num_union": 10162989, "num_only_computed": 2550573, "num_only_roped": 2550573, "total_diff": 5101146, "diff_percentage": 0.5019336338945166, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:33.517508", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2524996384370014, "overlap_percentage": 0.40319315181934356, "num_intersection": 3069274, "num_union": 12155558, "num_only_computed": 4543142, "num_only_roped": 4543142, "total_diff": 9086284, "diff_percentage": 0.7475003615629986, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:35.209620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.333984375, "mean_diff": 1.7583370208740234e-06, "l2_diff": 0.8203125, "l2_diff_relative": 0.01941568047337278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "attention_shape": [1, 32, 4032, 16320]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:35.249690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13869931754315537, "overlap_percentage": 0.243610082848581, "num_intersection": 13820, "num_union": 99640, "num_only_computed": 42910, "num_only_roped": 42910, "total_diff": 85820, "diff_percentage": 0.8613006824568447, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:37.977366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5429597193135148, "overlap_percentage": 0.7037898818967037, "num_intersection": 39926, "num_union": 73534, "num_only_computed": 16804, "num_only_roped": 16804, "total_diff": 33608, "diff_percentage": 0.45704028068648517, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:38.669265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26848901559617644, "overlap_percentage": 0.423320994182972, "num_intersection": 24015, "num_union": 89445, "num_only_computed": 32715, "num_only_roped": 32715, "total_diff": 65430, "diff_percentage": 0.7315109844038236, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:38.887915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 6.586313247680664e-06, "l2_diff": 0.0986328125, "l2_diff_relative": 0.0333994708994709}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "attention_shape": [1, 32, 30, 16350]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:38.894017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13335331135750675, "overlap_percentage": 0.23532522474881015, "num_intersection": 445, "num_union": 3337, "num_only_computed": 1446, "num_only_roped": 1446, "total_diff": 2892, "diff_percentage": 0.8666466886424933, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:39.858669", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5998307952622673, "overlap_percentage": 0.7498677948175568, "num_intersection": 1418, "num_union": 2364, "num_only_computed": 473, "num_only_roped": 473, "total_diff": 946, "diff_percentage": 0.40016920473773265, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:40.102902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21764327108821635, "overlap_percentage": 0.3574828133262824, "num_intersection": 676, "num_union": 3106, "num_only_computed": 1215, "num_only_roped": 1215, "total_diff": 2430, "diff_percentage": 0.7823567289117836, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:40.182333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 1.3530254364013672e-05, "l2_diff": 0.09326171875, "l2_diff_relative": 0.17685185185185184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "attention_shape": [1, 32, 1, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:40.188795", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13064275037369208, "overlap_percentage": 0.2310946589106293, "num_intersection": 437, "num_union": 3345, "num_only_computed": 1454, "num_only_roped": 1454, "total_diff": 2908, "diff_percentage": 0.8693572496263079, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:41.158176", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39815157116451017, "overlap_percentage": 0.5695399259650978, "num_intersection": 1077, "num_union": 2705, "num_only_computed": 814, "num_only_roped": 814, "total_diff": 1628, "diff_percentage": 0.6018484288354898, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:41.402229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23433420365535249, "overlap_percentage": 0.3796932839767319, "num_intersection": 718, "num_union": 3064, "num_only_computed": 1173, "num_only_roped": 1173, "total_diff": 2346, "diff_percentage": 0.7656657963446475, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:41.481557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.06982421875, "l2_diff_relative": 0.13541666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:41.488058", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1590560833588722, "overlap_percentage": 0.2744579587519831, "num_intersection": 519, "num_union": 3263, "num_only_computed": 1372, "num_only_roped": 1372, "total_diff": 2744, "diff_percentage": 0.8409439166411278, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:42.458575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45685670261941447, "overlap_percentage": 0.627181385510312, "num_intersection": 1186, "num_union": 2596, "num_only_computed": 705, "num_only_roped": 705, "total_diff": 1410, "diff_percentage": 0.5431432973805855, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:42.702730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2498347653668209, "overlap_percentage": 0.39978847170809095, "num_intersection": 756, "num_union": 3026, "num_only_computed": 1135, "num_only_roped": 1135, "total_diff": 2270, "diff_percentage": 0.7501652346331791, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:42.782292", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 1.0967254638671875e-05, "l2_diff": 0.056396484375, "l2_diff_relative": 0.11413043478260869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:42.788786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13881361035832582, "overlap_percentage": 0.24378635642517188, "num_intersection": 461, "num_union": 3321, "num_only_computed": 1430, "num_only_roped": 1430, "total_diff": 2860, "diff_percentage": 0.8611863896416742, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:43.758066", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3363957597173145, "overlap_percentage": 0.5034373347435219, "num_intersection": 952, "num_union": 2830, "num_only_computed": 939, "num_only_roped": 939, "total_diff": 1878, "diff_percentage": 0.6636042402826855, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:46.586353", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2255346727154893, "overlap_percentage": 0.3680592279217345, "num_intersection": 696, "num_union": 3086, "num_only_computed": 1195, "num_only_roped": 1195, "total_diff": 2390, "diff_percentage": 0.7744653272845107, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:46.667312", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.08642578125, "l2_diff_relative": 0.1791497975708502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:46.673994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1371016235718581, "overlap_percentage": 0.24114225277630882, "num_intersection": 456, "num_union": 3326, "num_only_computed": 1435, "num_only_roped": 1435, "total_diff": 2870, "diff_percentage": 0.8628983764281419, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:47.647630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38534798534798537, "overlap_percentage": 0.5563194077207827, "num_intersection": 1052, "num_union": 2730, "num_only_computed": 839, "num_only_roped": 839, "total_diff": 1678, "diff_percentage": 0.6146520146520147, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:47.892231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2259319286871961, "overlap_percentage": 0.3685880486515071, "num_intersection": 697, "num_union": 3085, "num_only_computed": 1194, "num_only_roped": 1194, "total_diff": 2388, "diff_percentage": 0.7740680713128039, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:47.971378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.1682510375976562e-05, "l2_diff": 0.0576171875, "l2_diff_relative": 0.11090225563909774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:47.977874", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13030484160191272, "overlap_percentage": 0.23056583818085669, "num_intersection": 436, "num_union": 3346, "num_only_computed": 1455, "num_only_roped": 1455, "total_diff": 2910, "diff_percentage": 0.8696951583980873, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:48.946963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3312214009151707, "overlap_percentage": 0.49762030671602325, "num_intersection": 941, "num_union": 2841, "num_only_computed": 950, "num_only_roped": 950, "total_diff": 1900, "diff_percentage": 0.6687785990848293, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:49.191433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22394822006472492, "overlap_percentage": 0.3659439450026441, "num_intersection": 692, "num_union": 3090, "num_only_computed": 1199, "num_only_roped": 1199, "total_diff": 2398, "diff_percentage": 0.7760517799352751, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:49.270821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 1.5974044799804688e-05, "l2_diff": 0.1005859375, "l2_diff_relative": 0.1965648854961832}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:49.277322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1319964082609997, "overlap_percentage": 0.2332099418297197, "num_intersection": 441, "num_union": 3341, "num_only_computed": 1450, "num_only_roped": 1450, "total_diff": 2900, "diff_percentage": 0.8680035917390003, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:50.249520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3678119349005425, "overlap_percentage": 0.5378106821787414, "num_intersection": 1017, "num_union": 2765, "num_only_computed": 874, "num_only_roped": 874, "total_diff": 1748, "diff_percentage": 0.6321880650994575, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:50.493800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24448831852583086, "overlap_percentage": 0.39291380222104705, "num_intersection": 743, "num_union": 3039, "num_only_computed": 1148, "num_only_roped": 1148, "total_diff": 2296, "diff_percentage": 0.7555116814741691, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:50.573202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.08447265625, "l2_diff_relative": 0.15900735294117646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:51.660384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:51.900108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:51.964534", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:51.994851", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.140900611877441e-07, "l2_diff": 0.11767578125, "l2_diff_relative": 0.002768841911764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:52.145836", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23957036747805618, "overlap_percentage": 0.3865377452761628, "num_intersection": 1702003, "num_union": 7104397, "num_only_computed": 2701197, "num_only_roped": 2701197, "total_diff": 5402394, "diff_percentage": 0.7604296325219438, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:45:57.690461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6150104422572881, "overlap_percentage": 0.761617914244186, "num_intersection": 3353556, "num_union": 5452844, "num_only_computed": 1049644, "num_only_roped": 1049644, "total_diff": 2099288, "diff_percentage": 0.3849895577427119, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:01.970454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3413937187971812, "overlap_percentage": 0.5090134447674418, "num_intersection": 2241288, "num_union": 6565112, "num_only_computed": 2161912, "num_only_roped": 2161912, "total_diff": 4323824, "diff_percentage": 0.6586062812028188, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:02.424666", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.333984375, "mean_diff": 3.6954879760742188e-06, "l2_diff": 0.8203125, "l2_diff_relative": 0.019301470588235295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:02.644198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18977055505469043, "overlap_percentage": 0.3190036167031671, "num_intersection": 1939052, "num_union": 10217876, "num_only_computed": 4139412, "num_only_roped": 4139412, "total_diff": 8278824, "diff_percentage": 0.8102294449453096, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:10.217081", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5193729003359463, "overlap_percentage": 0.6836674528301887, "num_intersection": 4155648, "num_union": 8001280, "num_only_computed": 1922816, "num_only_roped": 1922816, "total_diff": 3845632, "diff_percentage": 0.48062709966405376, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:12.993695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2802118949101666, "overlap_percentage": 0.4377586179666442, "num_intersection": 2660900, "num_union": 9496028, "num_only_computed": 3417564, "num_only_roped": 3417564, "total_diff": 6835128, "diff_percentage": 0.7197881050898334, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:15.184072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.7578125, "l2_diff_relative": 0.0182605421686747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:16.056805", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1764150492975918, "overlap_percentage": 0.2999197424462138, "num_intersection": 2301971, "num_union": 13048609, "num_only_computed": 5373319, "num_only_roped": 5373319, "total_diff": 10746638, "diff_percentage": 0.8235849507024082, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:26.066247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5024410563748416, "overlap_percentage": 0.6688329691777118, "num_intersection": 5133487, "num_union": 10217093, "num_only_computed": 2541803, "num_only_roped": 2541803, "total_diff": 5083606, "diff_percentage": 0.49755894362515835, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:31.902045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25246158555808884, "overlap_percentage": 0.40314463688017, "num_intersection": 3094252, "num_union": 12256328, "num_only_computed": 4581038, "num_only_roped": 4581038, "total_diff": 9162076, "diff_percentage": 0.7475384144419112, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:33.243597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08056640625, "mean_diff": 1.9669532775878906e-06, "l2_diff": 0.71484375, "l2_diff_relative": 0.017020089285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "attention_shape": [1, 32, 4061, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:33.282427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16617508317195492, "overlap_percentage": 0.28499165446060565, "num_intersection": 16733, "num_union": 100695, "num_only_computed": 41981, "num_only_roped": 41981, "total_diff": 83962, "diff_percentage": 0.833824916828045, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:35.997558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5561209615435584, "overlap_percentage": 0.7147528698436488, "num_intersection": 41966, "num_union": 75462, "num_only_computed": 16748, "num_only_roped": 16748, "total_diff": 33496, "diff_percentage": 0.44387903845644167, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:36.665551", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27067327461207175, "overlap_percentage": 0.42603127022515924, "num_intersection": 25014, "num_union": 92414, "num_only_computed": 33700, "num_only_roped": 33700, "total_diff": 67400, "diff_percentage": 0.7293267253879282, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:36.901665", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 6.616115570068359e-06, "l2_diff": 0.11083984375, "l2_diff_relative": 0.036946614583333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "attention_shape": [1, 32, 31, 16380]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:36.907827", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16089488201041985, "overlap_percentage": 0.2771911298838437, "num_intersection": 525, "num_union": 3263, "num_only_computed": 1369, "num_only_roped": 1369, "total_diff": 2738, "diff_percentage": 0.8391051179895801, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:37.876701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6555944055944056, "overlap_percentage": 0.791974656810982, "num_intersection": 1500, "num_union": 2288, "num_only_computed": 394, "num_only_roped": 394, "total_diff": 788, "diff_percentage": 0.34440559440559443, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:38.121487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2530598742970559, "overlap_percentage": 0.40390707497360084, "num_intersection": 765, "num_union": 3023, "num_only_computed": 1129, "num_only_roped": 1129, "total_diff": 2258, "diff_percentage": 0.7469401257029441, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:38.201039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 1.3709068298339844e-05, "l2_diff": 0.0849609375, "l2_diff_relative": 0.17261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "attention_shape": [1, 32, 1, 16381]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:38.207562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1562881562881563, "overlap_percentage": 0.2703273495248152, "num_intersection": 512, "num_union": 3276, "num_only_computed": 1382, "num_only_roped": 1382, "total_diff": 2764, "diff_percentage": 0.8437118437118437, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "mask_shape": [1, 32, 1, 16382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:39.183411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3226256983240223, "overlap_percentage": 0.48785638859556496, "num_intersection": 924, "num_union": 2864, "num_only_computed": 970, "num_only_roped": 970, "total_diff": 1940, "diff_percentage": 0.6773743016759777, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "mask_shape": [1, 32, 1, 16382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:39.429688", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20483460559796438, "overlap_percentage": 0.3400211193241816, "num_intersection": 644, "num_union": 3144, "num_only_computed": 1250, "num_only_roped": 1250, "total_diff": 2500, "diff_percentage": 0.7951653944020356, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "mask_shape": [1, 32, 1, 16382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:39.509517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.11572265625, "l2_diff_relative": 0.23987854251012145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "attention_shape": [1, 32, 1, 16382]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:39.516032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1496206373292868, "overlap_percentage": 0.26029567053854274, "num_intersection": 493, "num_union": 3295, "num_only_computed": 1401, "num_only_roped": 1401, "total_diff": 2802, "diff_percentage": 0.8503793626707132, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "mask_shape": [1, 32, 1, 16383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:40.488148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35819290068124776, "overlap_percentage": 0.5274551214361141, "num_intersection": 999, "num_union": 2789, "num_only_computed": 895, "num_only_roped": 895, "total_diff": 1790, "diff_percentage": 0.6418070993187522, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "mask_shape": [1, 32, 1, 16383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:43.168832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19082049669915122, "overlap_percentage": 0.3204857444561774, "num_intersection": 607, "num_union": 3181, "num_only_computed": 1287, "num_only_roped": 1287, "total_diff": 2574, "diff_percentage": 0.8091795033008488, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "mask_shape": [1, 32, 1, 16383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:43.249253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 1.633167266845703e-05, "l2_diff": 0.0888671875, "l2_diff_relative": 0.18801652892561985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "attention_shape": [1, 32, 1, 16383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:43.255840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16446357208730403, "overlap_percentage": 0.2824709609292503, "num_intersection": 535, "num_union": 3253, "num_only_computed": 1359, "num_only_roped": 1359, "total_diff": 2718, "diff_percentage": 0.835536427912696, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "mask_shape": [1, 32, 1, 16384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:44.233005", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4642442984151527, "overlap_percentage": 0.6341077085533263, "num_intersection": 1201, "num_union": 2587, "num_only_computed": 693, "num_only_roped": 693, "total_diff": 1386, "diff_percentage": 0.5357557015848473, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "mask_shape": [1, 32, 1, 16384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:44.479520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22747893713545042, "overlap_percentage": 0.3706441393875396, "num_intersection": 702, "num_union": 3086, "num_only_computed": 1192, "num_only_roped": 1192, "total_diff": 2384, "diff_percentage": 0.7725210628645496, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "mask_shape": [1, 32, 1, 16384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:44.559397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0284423828125, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.04931640625, "l2_diff_relative": 0.09148550724637682}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "attention_shape": [1, 32, 1, 16384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:44.565970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15699450213805743, "overlap_percentage": 0.2713833157338965, "num_intersection": 514, "num_union": 3274, "num_only_computed": 1380, "num_only_roped": 1380, "total_diff": 2760, "diff_percentage": 0.8430054978619426, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "mask_shape": [1, 32, 1, 16385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:45.543831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2959288402326377, "overlap_percentage": 0.4567053854276663, "num_intersection": 865, "num_union": 2923, "num_only_computed": 1029, "num_only_roped": 1029, "total_diff": 2058, "diff_percentage": 0.7040711597673623, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "mask_shape": [1, 32, 1, 16385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:45.789571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2141025641025641, "overlap_percentage": 0.3526927138331573, "num_intersection": 668, "num_union": 3120, "num_only_computed": 1226, "num_only_roped": 1226, "total_diff": 2452, "diff_percentage": 0.7858974358974359, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "mask_shape": [1, 32, 1, 16385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:45.868498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.134765625, "l2_diff_relative": 0.27380952380952384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "attention_shape": [1, 32, 1, 16385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:45.874899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15066828675577157, "overlap_percentage": 0.26187961985216474, "num_intersection": 496, "num_union": 3292, "num_only_computed": 1398, "num_only_roped": 1398, "total_diff": 2796, "diff_percentage": 0.8493317132442284, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "mask_shape": [1, 32, 1, 16386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:46.851857", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3375706214689266, "overlap_percentage": 0.5047518479408659, "num_intersection": 956, "num_union": 2832, "num_only_computed": 938, "num_only_roped": 938, "total_diff": 1876, "diff_percentage": 0.6624293785310734, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "mask_shape": [1, 32, 1, 16386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:47.097259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22193548387096773, "overlap_percentage": 0.3632523759239704, "num_intersection": 688, "num_union": 3100, "num_only_computed": 1206, "num_only_roped": 1206, "total_diff": 2412, "diff_percentage": 0.7780645161290323, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "mask_shape": [1, 32, 1, 16386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:47.176457", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.080078125, "l2_diff_relative": 0.15298507462686567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "attention_shape": [1, 32, 1, 16386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:47.182890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16625615763546797, "overlap_percentage": 0.28511087645195354, "num_intersection": 540, "num_union": 3248, "num_only_computed": 1354, "num_only_roped": 1354, "total_diff": 2708, "diff_percentage": 0.833743842364532, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "mask_shape": [1, 32, 1, 16387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:48.158090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23146944083224968, "overlap_percentage": 0.3759239704329461, "num_intersection": 712, "num_union": 3076, "num_only_computed": 1182, "num_only_roped": 1182, "total_diff": 2364, "diff_percentage": 0.7685305591677504, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "mask_shape": [1, 32, 1, 16387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:48.403395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20867900446713467, "overlap_percentage": 0.3453009503695882, "num_intersection": 654, "num_union": 3134, "num_only_computed": 1240, "num_only_roped": 1240, "total_diff": 2480, "diff_percentage": 0.7913209955328654, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "mask_shape": [1, 32, 1, 16387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:46:48.482346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.1357421875, "l2_diff_relative": 0.3088888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "attention_shape": [1, 32, 1, 16387]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
