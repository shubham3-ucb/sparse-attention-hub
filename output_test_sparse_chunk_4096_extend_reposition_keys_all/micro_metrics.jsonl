{"timestamp": "2025-11-09T21:37:03.785761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:04.025635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:04.092453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:04.143210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.066394805908203e-07, "l2_diff": 0.1181640625, "l2_diff_relative": 0.0027640716374269006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:04.303415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2285599451009596, "overlap_percentage": 0.3720778070494186, "num_intersection": 1638333, "num_union": 7168067, "num_only_computed": 2764867, "num_only_roped": 2764867, "total_diff": 5529734, "diff_percentage": 0.7714400548990404, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:09.811518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45575898777935425, "overlap_percentage": 0.6261462118459302, "num_intersection": 2757047, "num_union": 6049353, "num_only_computed": 1646153, "num_only_roped": 1646153, "total_diff": 3292306, "diff_percentage": 0.5442410122206457, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:13.847144", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39923495227389183, "overlap_percentage": 0.5706474836482558, "num_intersection": 2512675, "num_union": 6293725, "num_only_computed": 1890525, "num_only_roped": 1890525, "total_diff": 3781050, "diff_percentage": 0.6007650477261082, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:14.290810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.58203125, "mean_diff": 4.887580871582031e-05, "l2_diff": 11.1875, "l2_diff_relative": 0.30236486486486486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:14.462137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18173102072744962, "overlap_percentage": 0.30756748793067934, "num_intersection": 1352787, "num_union": 7443897, "num_only_computed": 3045555, "num_only_roped": 3045555, "total_diff": 6091110, "diff_percentage": 0.8182689792725504, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:20.393988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34249955016942474, "overlap_percentage": 0.5102415864887269, "num_intersection": 2244217, "num_union": 6552467, "num_only_computed": 2154125, "num_only_roped": 2154125, "total_diff": 4308250, "diff_percentage": 0.6575004498305753, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:21.986955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3049628345932455, "overlap_percentage": 0.46738930260539086, "num_intersection": 2055738, "num_union": 6740946, "num_only_computed": 2342604, "num_only_roped": 2342604, "total_diff": 4685208, "diff_percentage": 0.6950371654067545, "num_computed": 4398342, "num_roped": 4398342}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "mask_shape": [1, 32, 3162, 11354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:22.488201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.5625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 9.3125, "l2_diff_relative": 0.29563492063492064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3162, "seq_len_k": 11354, "queries_shape": [1, 32, 3162, 64], "keys_shape": [1, 8, 11354, 64], "attention_shape": [1, 32, 3162, 11354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:22.514827", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1714461501523132, "overlap_percentage": 0.2927085468333675, "num_intersection": 11425, "num_union": 66639, "num_only_computed": 27607, "num_only_roped": 27607, "total_diff": 55214, "diff_percentage": 0.8285538498476868, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:24.168253", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3178027617407745, "overlap_percentage": 0.48232219717155156, "num_intersection": 18826, "num_union": 59238, "num_only_computed": 20206, "num_only_roped": 20206, "total_diff": 40412, "diff_percentage": 0.6821972382592255, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:26.697667", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2730386001532917, "overlap_percentage": 0.4289557286329166, "num_intersection": 16743, "num_union": 61321, "num_only_computed": 22289, "num_only_roped": 22289, "total_diff": 44578, "diff_percentage": 0.7269613998467083, "num_computed": 39032, "num_roped": 39032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "mask_shape": [1, 32, 28, 11382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:26.818195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.25252525252525254}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11382, "queries_shape": [1, 32, 28, 64], "keys_shape": [1, 8, 11382, 64], "attention_shape": [1, 32, 28, 11382]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:26.826390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1679932970255551, "overlap_percentage": 0.28766140602582496, "num_intersection": 401, "num_union": 2387, "num_only_computed": 993, "num_only_roped": 993, "total_diff": 1986, "diff_percentage": 0.8320067029744449, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:27.657438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49973103819257664, "overlap_percentage": 0.6664275466284074, "num_intersection": 929, "num_union": 1859, "num_only_computed": 465, "num_only_roped": 465, "total_diff": 930, "diff_percentage": 0.5002689618074233, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:27.867587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.265546981389015, "overlap_percentage": 0.41965566714490676, "num_intersection": 585, "num_union": 2203, "num_only_computed": 809, "num_only_roped": 809, "total_diff": 1618, "diff_percentage": 0.734453018610985, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "mask_shape": [1, 32, 1, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:27.935666", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.496906280517578e-06, "l2_diff": 0.01953125, "l2_diff_relative": 0.034722222222222224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11383, 64], "attention_shape": [1, 32, 1, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:27.942273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16555183946488294, "overlap_percentage": 0.28407460545193686, "num_intersection": 396, "num_union": 2392, "num_only_computed": 998, "num_only_roped": 998, "total_diff": 1996, "diff_percentage": 0.8344481605351171, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:28.772227", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37543167242229897, "overlap_percentage": 0.5459110473457676, "num_intersection": 761, "num_union": 2027, "num_only_computed": 633, "num_only_roped": 633, "total_diff": 1266, "diff_percentage": 0.6245683275777011, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:28.981491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2919369786839666, "overlap_percentage": 0.4519368723098996, "num_intersection": 630, "num_union": 2158, "num_only_computed": 764, "num_only_roped": 764, "total_diff": 1528, "diff_percentage": 0.7080630213160334, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:29.049504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.004638671875, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.00823974609375, "l2_diff_relative": 0.013266509433962265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11384, 64], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:29.055697", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16409185803757828, "overlap_percentage": 0.281922525107604, "num_intersection": 393, "num_union": 2395, "num_only_computed": 1001, "num_only_roped": 1001, "total_diff": 2002, "diff_percentage": 0.8359081419624217, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:29.886270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41236068895643363, "overlap_percentage": 0.5839311334289814, "num_intersection": 814, "num_union": 1974, "num_only_computed": 580, "num_only_roped": 580, "total_diff": 1160, "diff_percentage": 0.5876393110435664, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:30.095660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2800734618916437, "overlap_percentage": 0.4375896700143472, "num_intersection": 610, "num_union": 2178, "num_only_computed": 784, "num_only_roped": 784, "total_diff": 1568, "diff_percentage": 0.7199265381083563, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:30.163680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.01434326171875, "l2_diff_relative": 0.023843344155844156}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11385, 64], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:30.169782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1729070256625999, "overlap_percentage": 0.29483500717360117, "num_intersection": 411, "num_union": 2377, "num_only_computed": 983, "num_only_roped": 983, "total_diff": 1966, "diff_percentage": 0.8270929743374, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:30.994263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3333333333333333, "overlap_percentage": 0.5, "num_intersection": 697, "num_union": 2091, "num_only_computed": 697, "num_only_roped": 697, "total_diff": 1394, "diff_percentage": 0.6666666666666666, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:31.211334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3009799346710219, "overlap_percentage": 0.46269727403156385, "num_intersection": 645, "num_union": 2143, "num_only_computed": 749, "num_only_roped": 749, "total_diff": 1498, "diff_percentage": 0.6990200653289781, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:31.279133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.0233154296875, "l2_diff_relative": 0.03753930817610063}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11386, 64], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:31.285109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.164578111946533, "overlap_percentage": 0.28263988522238165, "num_intersection": 394, "num_union": 2394, "num_only_computed": 1000, "num_only_roped": 1000, "total_diff": 2000, "diff_percentage": 0.835421888053467, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11387, 64], "mask_shape": [1, 32, 1, 11387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:32.116077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19043552519214346, "overlap_percentage": 0.3199426111908178, "num_intersection": 446, "num_union": 2342, "num_only_computed": 948, "num_only_roped": 948, "total_diff": 1896, "diff_percentage": 0.8095644748078565, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11387, 64], "mask_shape": [1, 32, 1, 11387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:32.324956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.361328125, "overlap_percentage": 0.5308464849354376, "num_intersection": 740, "num_union": 2048, "num_only_computed": 654, "num_only_roped": 654, "total_diff": 1308, "diff_percentage": 0.638671875, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11387, 64], "mask_shape": [1, 32, 1, 11387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:32.392315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.0128173828125, "l2_diff_relative": 0.02076740506329114}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11387, 64], "attention_shape": [1, 32, 1, 11387]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:32.398379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15445134575569358, "overlap_percentage": 0.26757532281205165, "num_intersection": 373, "num_union": 2415, "num_only_computed": 1021, "num_only_roped": 1021, "total_diff": 2042, "diff_percentage": 0.8455486542443064, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11388, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11388, 64], "mask_shape": [1, 32, 1, 11388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:33.226523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2859778597785978, "overlap_percentage": 0.4447632711621234, "num_intersection": 620, "num_union": 2168, "num_only_computed": 774, "num_only_roped": 774, "total_diff": 1548, "diff_percentage": 0.7140221402214022, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11388, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11388, 64], "mask_shape": [1, 32, 1, 11388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:33.435924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31695795937647614, "overlap_percentage": 0.4813486370157819, "num_intersection": 671, "num_union": 2117, "num_only_computed": 723, "num_only_roped": 723, "total_diff": 1446, "diff_percentage": 0.6830420406235238, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11388, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11388, 64], "mask_shape": [1, 32, 1, 11388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:33.503449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 3.2186508178710938e-06, "l2_diff": 0.00927734375, "l2_diff_relative": 0.01430722891566265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11388, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11388, 64], "attention_shape": [1, 32, 1, 11388]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:33.509384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1729070256625999, "overlap_percentage": 0.29483500717360117, "num_intersection": 411, "num_union": 2377, "num_only_computed": 983, "num_only_roped": 983, "total_diff": 1966, "diff_percentage": 0.8270929743374, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11389, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11389, 64], "mask_shape": [1, 32, 1, 11389], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:34.334383", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36, "overlap_percentage": 0.5294117647058824, "num_intersection": 738, "num_union": 2050, "num_only_computed": 656, "num_only_roped": 656, "total_diff": 1312, "diff_percentage": 0.64, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11389, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11389, 64], "mask_shape": [1, 32, 1, 11389], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:34.542959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30830595964335994, "overlap_percentage": 0.4713055954088953, "num_intersection": 657, "num_union": 2131, "num_only_computed": 737, "num_only_roped": 737, "total_diff": 1474, "diff_percentage": 0.6916940403566401, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11389, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11389, 64], "mask_shape": [1, 32, 1, 11389], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:34.610420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.410743713378906e-06, "l2_diff": 0.0142822265625, "l2_diff_relative": 0.021763392857142856}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11389, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 11389, 64], "attention_shape": [1, 32, 1, 11389]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:35.741783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:35.981420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:36.045846", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:36.076192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.140900611877441e-07, "l2_diff": 0.11767578125, "l2_diff_relative": 0.002768841911764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:36.227393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23432062818263583, "overlap_percentage": 0.3796754632994186, "num_intersection": 1671787, "num_union": 7134613, "num_only_computed": 2731413, "num_only_roped": 2731413, "total_diff": 5462826, "diff_percentage": 0.7656793718173641, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:41.658848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4544075664073867, "overlap_percentage": 0.624869640261628, "num_intersection": 2751426, "num_union": 6054974, "num_only_computed": 1651774, "num_only_roped": 1651774, "total_diff": 3303548, "diff_percentage": 0.5455924335926133, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:43.136691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39583193653453463, "overlap_percentage": 0.5671627452761628, "num_intersection": 2497331, "num_union": 6309069, "num_only_computed": 1905869, "num_only_roped": 1905869, "total_diff": 3811738, "diff_percentage": 0.6041680634654654, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:43.587809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.6328125, "mean_diff": 5.507469177246094e-05, "l2_diff": 11.1875, "l2_diff_relative": 0.3065068493150685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:43.807933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17801493472477584, "overlap_percentage": 0.30222865513392855, "num_intersection": 1837086, "num_union": 10319842, "num_only_computed": 4241378, "num_only_roped": 4241378, "total_diff": 8482756, "diff_percentage": 0.8219850652752242, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:51.072384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3233744561200308, "overlap_percentage": 0.4887119509139151, "num_intersection": 2970618, "num_union": 9186310, "num_only_computed": 3107846, "num_only_roped": 3107846, "total_diff": 6215692, "diff_percentage": 0.6766255438799692, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:56.542530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3168825845498438, "overlap_percentage": 0.4812617134855121, "num_intersection": 2925332, "num_union": 9231596, "num_only_computed": 3153132, "num_only_roped": 3153132, "total_diff": 6306264, "diff_percentage": 0.6831174154501561, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:57.132030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.7890625, "mean_diff": 2.944469451904297e-05, "l2_diff": 11.1875, "l2_diff_relative": 0.29635761589403975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:37:57.520090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15096812353851818, "overlap_percentage": 0.26233241468822643, "num_intersection": 1971442, "num_union": 13058664, "num_only_computed": 5543611, "num_only_roped": 5543611, "total_diff": 11087222, "diff_percentage": 0.8490318764614818, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:07.310385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3706300759349241, "overlap_percentage": 0.5408170774045107, "num_intersection": 4064269, "num_union": 10965837, "num_only_computed": 3450784, "num_only_roped": 3450784, "total_diff": 6901568, "diff_percentage": 0.629369924065076, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:12.272649", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3109116973317248, "overlap_percentage": 0.47434422618177147, "num_intersection": 3564722, "num_union": 11465384, "num_only_computed": 3950331, "num_only_roped": 3950331, "total_diff": 7900662, "diff_percentage": 0.6890883026682753, "num_computed": 7515053, "num_roped": 7515053}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "mask_shape": [1, 32, 3991, 16279], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:13.932940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.67578125, "mean_diff": 2.4437904357910156e-05, "l2_diff": 11.4375, "l2_diff_relative": 0.3091216216216216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 3991, "seq_len_k": 16279, "queries_shape": [1, 32, 3991, 64], "keys_shape": [1, 8, 16279, 64], "attention_shape": [1, 32, 3991, 16279]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:13.973552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13948969589401822, "overlap_percentage": 0.24482835851284765, "num_intersection": 24049, "num_union": 172407, "num_only_computed": 74179, "num_only_roped": 74179, "total_diff": 148358, "diff_percentage": 0.8605103041059817, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:16.528509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3938189970769362, "overlap_percentage": 0.5650934560410473, "num_intersection": 55508, "num_union": 140948, "num_only_computed": 42720, "num_only_roped": 42720, "total_diff": 85440, "diff_percentage": 0.6061810029230639, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:17.110647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2689398588028601, "overlap_percentage": 0.42388117441055506, "num_intersection": 41637, "num_union": 154819, "num_only_computed": 56591, "num_only_roped": 56591, "total_diff": 113182, "diff_percentage": 0.7310601411971399, "num_computed": 98228, "num_roped": 98228}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "mask_shape": [1, 32, 52, 16331], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:17.301904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2001953125, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.2468354430379747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16331, "queries_shape": [1, 32, 52, 64], "keys_shape": [1, 8, 16331, 64], "attention_shape": [1, 32, 52, 16331]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:17.308037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14902676399026765, "overlap_percentage": 0.2593965060878772, "num_intersection": 490, "num_union": 3288, "num_only_computed": 1399, "num_only_roped": 1399, "total_diff": 2798, "diff_percentage": 0.8509732360097324, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:18.286200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5702410640066501, "overlap_percentage": 0.7263102170460561, "num_intersection": 1372, "num_union": 2406, "num_only_computed": 517, "num_only_roped": 517, "total_diff": 1034, "diff_percentage": 0.42975893599334997, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:18.527918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2526525198938992, "overlap_percentage": 0.4033880359978825, "num_intersection": 762, "num_union": 3016, "num_only_computed": 1127, "num_only_roped": 1127, "total_diff": 2254, "diff_percentage": 0.7473474801061007, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "mask_shape": [1, 32, 1, 16332], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:18.606482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.592802047729492e-06, "l2_diff": 0.00848388671875, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16332, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16332, 64], "attention_shape": [1, 32, 1, 16332]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:18.613150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14763061968408261, "overlap_percentage": 0.25727898358920065, "num_intersection": 486, "num_union": 3292, "num_only_computed": 1403, "num_only_roped": 1403, "total_diff": 2806, "diff_percentage": 0.8523693803159174, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:19.575985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5283171521035599, "overlap_percentage": 0.691371095817893, "num_intersection": 1306, "num_union": 2472, "num_only_computed": 583, "num_only_roped": 583, "total_diff": 1166, "diff_percentage": 0.4716828478964401, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:19.818100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2639678822348612, "overlap_percentage": 0.41768131286394916, "num_intersection": 789, "num_union": 2989, "num_only_computed": 1100, "num_only_roped": 1100, "total_diff": 2200, "diff_percentage": 0.7360321177651389, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "mask_shape": [1, 32, 1, 16333], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:19.896610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 2.0563602447509766e-06, "l2_diff": 0.00823974609375, "l2_diff_relative": 0.015066964285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16333, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16333, 64], "attention_shape": [1, 32, 1, 16333]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:19.902964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1335133513351335, "overlap_percentage": 0.235574377977766, "num_intersection": 445, "num_union": 3333, "num_only_computed": 1444, "num_only_roped": 1444, "total_diff": 2888, "diff_percentage": 0.8664866486648665, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:20.861746", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3521832498210451, "overlap_percentage": 0.5209105346744309, "num_intersection": 984, "num_union": 2794, "num_only_computed": 905, "num_only_roped": 905, "total_diff": 1810, "diff_percentage": 0.6478167501789549, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:23.498507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30006882312456984, "overlap_percentage": 0.46161990471148756, "num_intersection": 872, "num_union": 2906, "num_only_computed": 1017, "num_only_roped": 1017, "total_diff": 2034, "diff_percentage": 0.6999311768754302, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "mask_shape": [1, 32, 1, 16334], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:23.577046", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.5050172805786133e-06, "l2_diff": 0.0093994140625, "l2_diff_relative": 0.01636904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16334, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16334, 64], "attention_shape": [1, 32, 1, 16334]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:23.583443", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16497070613629355, "overlap_percentage": 0.2832186341979884, "num_intersection": 535, "num_union": 3243, "num_only_computed": 1354, "num_only_roped": 1354, "total_diff": 2708, "diff_percentage": 0.8350292938637064, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:24.544092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.340667139815472, "overlap_percentage": 0.5082053996823717, "num_intersection": 960, "num_union": 2818, "num_only_computed": 929, "num_only_roped": 929, "total_diff": 1858, "diff_percentage": 0.6593328601845281, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:24.786552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3302816901408451, "overlap_percentage": 0.4965590259396506, "num_intersection": 938, "num_union": 2840, "num_only_computed": 951, "num_only_roped": 951, "total_diff": 1902, "diff_percentage": 0.6697183098591549, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "mask_shape": [1, 32, 1, 16335], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:24.864906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.5869736671447754e-06, "l2_diff": 0.01031494140625, "l2_diff_relative": 0.018086472602739725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16335, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16335, 64], "attention_shape": [1, 32, 1, 16335]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:24.871574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15112736136502133, "overlap_percentage": 0.262572789835892, "num_intersection": 496, "num_union": 3282, "num_only_computed": 1393, "num_only_roped": 1393, "total_diff": 2786, "diff_percentage": 0.8488726386349786, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "mask_shape": [1, 32, 1, 16336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:25.829222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4381423677198325, "overlap_percentage": 0.6093170989941769, "num_intersection": 1151, "num_union": 2627, "num_only_computed": 738, "num_only_roped": 738, "total_diff": 1476, "diff_percentage": 0.5618576322801675, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "mask_shape": [1, 32, 1, 16336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:26.070941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4086502609992543, "overlap_percentage": 0.5802011646373743, "num_intersection": 1096, "num_union": 2682, "num_only_computed": 793, "num_only_roped": 793, "total_diff": 1586, "diff_percentage": 0.5913497390007457, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "mask_shape": [1, 32, 1, 16336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:26.149326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.3543834686279297e-06, "l2_diff": 0.0106201171875, "l2_diff_relative": 0.019844890510948905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16336, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16336, 64], "attention_shape": [1, 32, 1, 16336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:26.155845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14207980652962515, "overlap_percentage": 0.24880889359449443, "num_intersection": 470, "num_union": 3308, "num_only_computed": 1419, "num_only_roped": 1419, "total_diff": 2838, "diff_percentage": 0.8579201934703748, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "mask_shape": [1, 32, 1, 16337], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:27.116498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5722014148980441, "overlap_percentage": 0.7278983589200635, "num_intersection": 1375, "num_union": 2403, "num_only_computed": 514, "num_only_roped": 514, "total_diff": 1028, "diff_percentage": 0.4277985851019559, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "mask_shape": [1, 32, 1, 16337], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:27.358848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3219034289713086, "overlap_percentage": 0.48703017469560617, "num_intersection": 920, "num_union": 2858, "num_only_computed": 969, "num_only_roped": 969, "total_diff": 1938, "diff_percentage": 0.6780965710286914, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "mask_shape": [1, 32, 1, 16337], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:27.437452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.01239013671875, "l2_diff_relative": 0.022984601449275364}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16337, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16337, 64], "attention_shape": [1, 32, 1, 16337]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:27.443978", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1348753379393211, "overlap_percentage": 0.23769190047644256, "num_intersection": 449, "num_union": 3329, "num_only_computed": 1440, "num_only_roped": 1440, "total_diff": 2880, "diff_percentage": 0.8651246620606788, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "mask_shape": [1, 32, 1, 16338], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:28.406148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7290617848970252, "overlap_percentage": 0.8433033350979354, "num_intersection": 1593, "num_union": 2185, "num_only_computed": 296, "num_only_roped": 296, "total_diff": 592, "diff_percentage": 0.27093821510297483, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "mask_shape": [1, 32, 1, 16338], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:28.648550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3541218637992832, "overlap_percentage": 0.5230280571731075, "num_intersection": 988, "num_union": 2790, "num_only_computed": 901, "num_only_roped": 901, "total_diff": 1802, "diff_percentage": 0.6458781362007169, "num_computed": 1889, "num_roped": 1889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "mask_shape": [1, 32, 1, 16338], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:28.727117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.271766662597656e-06, "l2_diff": 0.025634765625, "l2_diff_relative": 0.05048076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16338, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16338, 64], "attention_shape": [1, 32, 1, 16338]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:29.801026", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:30.040605", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:30.106108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:30.136402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.029141902923584e-07, "l2_diff": 0.1181640625, "l2_diff_relative": 0.0027640716374269006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:30.289579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23472576480538038, "overlap_percentage": 0.38020712209302326, "num_intersection": 1674128, "num_union": 7132272, "num_only_computed": 2729072, "num_only_roped": 2729072, "total_diff": 5458144, "diff_percentage": 0.7652742351946196, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:35.789736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4335062220231965, "overlap_percentage": 0.6048194494912791, "num_intersection": 2663141, "num_union": 6143259, "num_only_computed": 1740059, "num_only_roped": 1740059, "total_diff": 3480118, "diff_percentage": 0.5664937779768036, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:38.897413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.364983093485315, "overlap_percentage": 0.534780386991279, "num_intersection": 2354745, "num_union": 6451655, "num_only_computed": 2048455, "num_only_roped": 2048455, "total_diff": 4096910, "diff_percentage": 0.635016906514685, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:39.349420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.6171875, "mean_diff": 4.363059997558594e-05, "l2_diff": 10.3125, "l2_diff_relative": 0.2731788079470199}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:39.569217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17502699572127967, "overlap_percentage": 0.2979114460495283, "num_intersection": 1810844, "num_union": 10346084, "num_only_computed": 4267620, "num_only_roped": 4267620, "total_diff": 8535240, "diff_percentage": 0.8249730042787203, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:46.840665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2955189187697261, "overlap_percentage": 0.4562170640477594, "num_intersection": 2773099, "num_union": 9383829, "num_only_computed": 3305365, "num_only_roped": 3305365, "total_diff": 6610730, "diff_percentage": 0.7044810812302739, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:49.094835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2994994700742965, "overlap_percentage": 0.4609458902775438, "num_intersection": 2801843, "num_union": 9355085, "num_only_computed": 3276621, "num_only_roped": 3276621, "total_diff": 6553242, "diff_percentage": 0.7005005299257036, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:52.105880", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.734375, "mean_diff": 3.0159950256347656e-05, "l2_diff": 11.25, "l2_diff_relative": 0.2980132450331126}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:38:52.384061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14837370763161395, "overlap_percentage": 0.258406660907654, "num_intersection": 1967099, "num_union": 13257733, "num_only_computed": 5645317, "num_only_roped": 5645317, "total_diff": 11290634, "diff_percentage": 0.851626292368386, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:01.683007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33293538899773795, "overlap_percentage": 0.4995521789665725, "num_intersection": 3802799, "num_union": 11422033, "num_only_computed": 3809617, "num_only_roped": 3809617, "total_diff": 7619234, "diff_percentage": 0.667064611002262, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:07.640946", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25825307422097366, "overlap_percentage": 0.4104946445386064, "num_intersection": 3124856, "num_union": 12099976, "num_only_computed": 4487560, "num_only_roped": 4487560, "total_diff": 8975120, "diff_percentage": 0.7417469257790263, "num_computed": 7612416, "num_roped": 7612416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "mask_shape": [1, 32, 4032, 16320], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:09.281847", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.625, "mean_diff": 1.895427703857422e-05, "l2_diff": 9.25, "l2_diff_relative": 0.23870967741935484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4032, "seq_len_k": 16320, "queries_shape": [1, 32, 4032, 64], "keys_shape": [1, 8, 16320, 64], "attention_shape": [1, 32, 4032, 16320]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:09.318391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13869931754315537, "overlap_percentage": 0.243610082848581, "num_intersection": 13820, "num_union": 99640, "num_only_computed": 42910, "num_only_roped": 42910, "total_diff": 85820, "diff_percentage": 0.8613006824568447, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:11.704896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43369809699512246, "overlap_percentage": 0.6050061695751807, "num_intersection": 34322, "num_union": 79138, "num_only_computed": 22408, "num_only_roped": 22408, "total_diff": 44816, "diff_percentage": 0.5663019030048776, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:12.449985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23344856826038746, "overlap_percentage": 0.37852987837123214, "num_intersection": 21474, "num_union": 91986, "num_only_computed": 35256, "num_only_roped": 35256, "total_diff": 70512, "diff_percentage": 0.7665514317396126, "num_computed": 56730, "num_roped": 56730}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "mask_shape": [1, 32, 30, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:12.627061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.5859375, "l2_diff_relative": 0.21067415730337077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16350, "queries_shape": [1, 32, 30, 64], "keys_shape": [1, 8, 16350, 64], "attention_shape": [1, 32, 30, 16350]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:12.633279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1633343586588742, "overlap_percentage": 0.2808038075092544, "num_intersection": 531, "num_union": 3251, "num_only_computed": 1360, "num_only_roped": 1360, "total_diff": 2720, "diff_percentage": 0.8366656413411258, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:13.602944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39095255608679663, "overlap_percentage": 0.5621364357482813, "num_intersection": 1063, "num_union": 2719, "num_only_computed": 828, "num_only_roped": 828, "total_diff": 1656, "diff_percentage": 0.6090474439132034, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:13.847454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22911927201819954, "overlap_percentage": 0.372818614489688, "num_intersection": 705, "num_union": 3077, "num_only_computed": 1186, "num_only_roped": 1186, "total_diff": 2372, "diff_percentage": 0.7708807279818004, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:13.926983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.5480985641479492e-06, "l2_diff": 0.0140380859375, "l2_diff_relative": 0.025487588652482268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16351, 64], "attention_shape": [1, 32, 1, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:13.933446", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15834609494640123, "overlap_percentage": 0.27340031729243786, "num_intersection": 517, "num_union": 3265, "num_only_computed": 1374, "num_only_roped": 1374, "total_diff": 2748, "diff_percentage": 0.8416539050535988, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:14.902645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3363957597173145, "overlap_percentage": 0.5034373347435219, "num_intersection": 952, "num_union": 2830, "num_only_computed": 939, "num_only_roped": 939, "total_diff": 1878, "diff_percentage": 0.6636042402826855, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:15.146905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32053072625698326, "overlap_percentage": 0.4854574299312533, "num_intersection": 918, "num_union": 2864, "num_only_computed": 973, "num_only_roped": 973, "total_diff": 1946, "diff_percentage": 0.6794692737430168, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:15.226356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.013916015625, "l2_diff_relative": 0.02526595744680851}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16352, 64], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:15.232901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12727272727272726, "overlap_percentage": 0.22580645161290322, "num_intersection": 427, "num_union": 3355, "num_only_computed": 1464, "num_only_roped": 1464, "total_diff": 2928, "diff_percentage": 0.8727272727272727, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:16.200429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5115907274180655, "overlap_percentage": 0.6768905341089371, "num_intersection": 1280, "num_union": 2502, "num_only_computed": 611, "num_only_roped": 611, "total_diff": 1222, "diff_percentage": 0.48840927258193445, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:16.444214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2708333333333333, "overlap_percentage": 0.4262295081967213, "num_intersection": 806, "num_union": 2976, "num_only_computed": 1085, "num_only_roped": 1085, "total_diff": 2170, "diff_percentage": 0.7291666666666666, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:16.523590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 1.8849968910217285e-06, "l2_diff": 0.0086669921875, "l2_diff_relative": 0.01596223021582734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16353, 64], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:16.530084", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1299671347475351, "overlap_percentage": 0.23003701745108407, "num_intersection": 435, "num_union": 3347, "num_only_computed": 1456, "num_only_roped": 1456, "total_diff": 2912, "diff_percentage": 0.8700328652524649, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:17.495392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42340986074520137, "overlap_percentage": 0.594923320994183, "num_intersection": 1125, "num_union": 2657, "num_only_computed": 766, "num_only_roped": 766, "total_diff": 1532, "diff_percentage": 0.5765901392547986, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:20.099270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27382957224654764, "overlap_percentage": 0.42993125330512955, "num_intersection": 813, "num_union": 2969, "num_only_computed": 1078, "num_only_roped": 1078, "total_diff": 2156, "diff_percentage": 0.7261704277534523, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:20.178990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.7418136596679688e-06, "l2_diff": 0.01153564453125, "l2_diff_relative": 0.022038246268656716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16354, 64], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:20.185519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12895522388059702, "overlap_percentage": 0.22845055526176627, "num_intersection": 432, "num_union": 3350, "num_only_computed": 1459, "num_only_roped": 1459, "total_diff": 2918, "diff_percentage": 0.871044776119403, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:21.155301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5392755392755393, "overlap_percentage": 0.7006874669487044, "num_intersection": 1325, "num_union": 2457, "num_only_computed": 566, "num_only_roped": 566, "total_diff": 1132, "diff_percentage": 0.4607244607244607, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:21.403251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22355224846328048, "overlap_percentage": 0.3654151242728715, "num_intersection": 691, "num_union": 3091, "num_only_computed": 1200, "num_only_roped": 1200, "total_diff": 2400, "diff_percentage": 0.7764477515367195, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:21.482942", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 1.341104507446289e-06, "l2_diff": 0.0074462890625, "l2_diff_relative": 0.013237847222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16355, 64], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:21.489616", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1262656343061346, "overlap_percentage": 0.2242199894235854, "num_intersection": 424, "num_union": 3358, "num_only_computed": 1467, "num_only_roped": 1467, "total_diff": 2934, "diff_percentage": 0.8737343656938654, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:22.458645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38839941262848754, "overlap_percentage": 0.5594923320994183, "num_intersection": 1058, "num_union": 2724, "num_only_computed": 833, "num_only_roped": 833, "total_diff": 1666, "diff_percentage": 0.6116005873715125, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:22.703321", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21764327108821635, "overlap_percentage": 0.3574828133262824, "num_intersection": 676, "num_union": 3106, "num_only_computed": 1215, "num_only_roped": 1215, "total_diff": 2430, "diff_percentage": 0.7823567289117836, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:22.782896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.3783574104309082e-06, "l2_diff": 0.01068115234375, "l2_diff_relative": 0.018857758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16356, 64], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:22.789441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15799142682180037, "overlap_percentage": 0.27287149656266524, "num_intersection": 516, "num_union": 3266, "num_only_computed": 1375, "num_only_roped": 1375, "total_diff": 2750, "diff_percentage": 0.8420085731781997, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:23.758688", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46475600309837334, "overlap_percentage": 0.6345848757271285, "num_intersection": 1200, "num_union": 2582, "num_only_computed": 691, "num_only_roped": 691, "total_diff": 1382, "diff_percentage": 0.5352439969016266, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:24.002615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2598267821452365, "overlap_percentage": 0.41248016922263353, "num_intersection": 780, "num_union": 3002, "num_only_computed": 1111, "num_only_roped": 1111, "total_diff": 2222, "diff_percentage": 0.7401732178547635, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:24.082121", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 1.3709068298339844e-06, "l2_diff": 0.00836181640625, "l2_diff_relative": 0.015400179856115108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16357, 64], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:25.189390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:25.428985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:25.493400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 16777216, "num_union": 16777216, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 16777216, "num_roped": 16777216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "mask_shape": [1, 32, 4096, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:25.523668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 5.140900611877441e-07, "l2_diff": 0.11767578125, "l2_diff_relative": 0.002768841911764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 4096, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 4096, 64], "attention_shape": [1, 32, 4096, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:25.674624", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23957036747805618, "overlap_percentage": 0.3865377452761628, "num_intersection": 1702003, "num_union": 7104397, "num_only_computed": 2701197, "num_only_roped": 2701197, "total_diff": 5402394, "diff_percentage": 0.7604296325219438, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:31.159948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42876148262558283, "overlap_percentage": 0.6001862281976744, "num_intersection": 2642740, "num_union": 6163660, "num_only_computed": 1760460, "num_only_roped": 1760460, "total_diff": 3520920, "diff_percentage": 0.5712385173744171, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:35.378140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3698154970644255, "overlap_percentage": 0.5399493550145349, "num_intersection": 2377505, "num_union": 6428895, "num_only_computed": 2025695, "num_only_roped": 2025695, "total_diff": 4051390, "diff_percentage": 0.6301845029355745, "num_computed": 4403200, "num_roped": 4403200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "mask_shape": [1, 32, 4096, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:35.830080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.609375, "mean_diff": 5.5789947509765625e-05, "l2_diff": 11.375, "l2_diff_relative": 0.32269503546099293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 8192, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 8192, 64], "attention_shape": [1, 32, 4096, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:36.049723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18977055505469043, "overlap_percentage": 0.3190036167031671, "num_intersection": 1939052, "num_union": 10217876, "num_only_computed": 4139412, "num_only_roped": 4139412, "total_diff": 8278824, "diff_percentage": 0.8102294449453096, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:43.315047", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3230887039530951, "overlap_percentage": 0.48838555266593664, "num_intersection": 2968634, "num_union": 9188294, "num_only_computed": 3109830, "num_only_roped": 3109830, "total_diff": 6219660, "diff_percentage": 0.6769112960469049, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:46.003260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30994801338639677, "overlap_percentage": 0.47322185341559975, "num_intersection": 2876462, "num_union": 9280466, "num_only_computed": 3202002, "num_only_roped": 3202002, "total_diff": 6404004, "diff_percentage": 0.6900519866136032, "num_computed": 6078464, "num_roped": 6078464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "mask_shape": [1, 32, 4096, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:48.709145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.52734375, "mean_diff": 4.9591064453125e-05, "l2_diff": 13.5625, "l2_diff_relative": 0.42054263565891475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4096, "seq_len_k": 12288, "queries_shape": [1, 32, 4096, 64], "keys_shape": [1, 8, 12288, 64], "attention_shape": [1, 32, 4096, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:49.569700", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1764150492975918, "overlap_percentage": 0.2999197424462138, "num_intersection": 2301971, "num_union": 13048609, "num_only_computed": 5373319, "num_only_roped": 5373319, "total_diff": 10746638, "diff_percentage": 0.8235849507024082, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:39:59.071990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34870358021144415, "overlap_percentage": 0.5170944680917594, "num_intersection": 3968850, "num_union": 11381730, "num_only_computed": 3706440, "num_only_roped": 3706440, "total_diff": 7412880, "diff_percentage": 0.6512964197885559, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:05.006573", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3010313440934307, "overlap_percentage": 0.4627580195666874, "num_intersection": 3551802, "num_union": 11798778, "num_only_computed": 4123488, "num_only_roped": 4123488, "total_diff": 8246976, "diff_percentage": 0.6989686559065693, "num_computed": 7675290, "num_roped": 7675290}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "mask_shape": [1, 32, 4061, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:06.687135", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.90234375, "mean_diff": 3.0159950256347656e-05, "l2_diff": 11.5625, "l2_diff_relative": 0.3351449275362319}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 4061, "seq_len_k": 16349, "queries_shape": [1, 32, 4061, 64], "keys_shape": [1, 8, 16349, 64], "attention_shape": [1, 32, 4061, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:06.725947", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16617508317195492, "overlap_percentage": 0.28499165446060565, "num_intersection": 16733, "num_union": 100695, "num_only_computed": 41981, "num_only_roped": 41981, "total_diff": 83962, "diff_percentage": 0.833824916828045, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:09.143877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3458025328061429, "overlap_percentage": 0.513897877848554, "num_intersection": 30173, "num_union": 87255, "num_only_computed": 28541, "num_only_roped": 28541, "total_diff": 57082, "diff_percentage": 0.6541974671938571, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:09.693296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22334850868328662, "overlap_percentage": 0.36514289607248696, "num_intersection": 21439, "num_union": 95989, "num_only_computed": 37275, "num_only_roped": 37275, "total_diff": 74550, "diff_percentage": 0.7766514913167134, "num_computed": 58714, "num_roped": 58714}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "mask_shape": [1, 32, 31, 16380], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:09.883692", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.279296875, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.3923841059602649}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16380, "queries_shape": [1, 32, 31, 64], "keys_shape": [1, 8, 16380, 64], "attention_shape": [1, 32, 31, 16380]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:09.889592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15347137637028013, "overlap_percentage": 0.26610348468849, "num_intersection": 504, "num_union": 3284, "num_only_computed": 1390, "num_only_roped": 1390, "total_diff": 2780, "diff_percentage": 0.8465286236297198, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:10.849397", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3769538349691021, "overlap_percentage": 0.5475184794086589, "num_intersection": 1037, "num_union": 2751, "num_only_computed": 857, "num_only_roped": 857, "total_diff": 1714, "diff_percentage": 0.6230461650308978, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:11.093849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24034053700065489, "overlap_percentage": 0.38753959873284055, "num_intersection": 734, "num_union": 3054, "num_only_computed": 1160, "num_only_roped": 1160, "total_diff": 2320, "diff_percentage": 0.7596594629993452, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "mask_shape": [1, 32, 1, 16381], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:11.173347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.6507844924926758e-06, "l2_diff": 0.0167236328125, "l2_diff_relative": 0.031479779411764705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16381, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16381, 64], "attention_shape": [1, 32, 1, 16381]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:11.179880", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1591187270501836, "overlap_percentage": 0.27455121436114044, "num_intersection": 520, "num_union": 3268, "num_only_computed": 1374, "num_only_roped": 1374, "total_diff": 2748, "diff_percentage": 0.8408812729498164, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "mask_shape": [1, 32, 1, 16382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:12.150522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4403041825095057, "overlap_percentage": 0.6114044350580782, "num_intersection": 1158, "num_union": 2630, "num_only_computed": 736, "num_only_roped": 736, "total_diff": 1472, "diff_percentage": 0.5596958174904944, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "mask_shape": [1, 32, 1, 16382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:12.394382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20945083014048532, "overlap_percentage": 0.34635691657866946, "num_intersection": 656, "num_union": 3132, "num_only_computed": 1238, "num_only_roped": 1238, "total_diff": 2476, "diff_percentage": 0.7905491698595147, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "mask_shape": [1, 32, 1, 16382], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:12.473690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.8710575103759766e-06, "l2_diff": 0.020263671875, "l2_diff_relative": 0.039299242424242424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16382, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16382, 64], "attention_shape": [1, 32, 1, 16382]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:12.480232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15523025312595304, "overlap_percentage": 0.26874340021119325, "num_intersection": 509, "num_union": 3279, "num_only_computed": 1385, "num_only_roped": 1385, "total_diff": 2770, "diff_percentage": 0.8447697468740469, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "mask_shape": [1, 32, 1, 16383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:13.451983", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3080110497237569, "overlap_percentage": 0.470960929250264, "num_intersection": 892, "num_union": 2896, "num_only_computed": 1002, "num_only_roped": 1002, "total_diff": 2004, "diff_percentage": 0.6919889502762431, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "mask_shape": [1, 32, 1, 16383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:13.696312", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19419924337957126, "overlap_percentage": 0.3252375923970433, "num_intersection": 616, "num_union": 3172, "num_only_computed": 1278, "num_only_roped": 1278, "total_diff": 2556, "diff_percentage": 0.8058007566204287, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "mask_shape": [1, 32, 1, 16383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:13.775770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.01556396484375, "l2_diff_relative": 0.029296875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16383, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16383, 64], "attention_shape": [1, 32, 1, 16383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:13.782249", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.169857936998147, "overlap_percentage": 0.29039070749736007, "num_intersection": 550, "num_union": 3238, "num_only_computed": 1344, "num_only_roped": 1344, "total_diff": 2688, "diff_percentage": 0.830142063001853, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "mask_shape": [1, 32, 1, 16384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:14.751918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3084628670120898, "overlap_percentage": 0.47148891235480467, "num_intersection": 893, "num_union": 2895, "num_only_computed": 1001, "num_only_roped": 1001, "total_diff": 2002, "diff_percentage": 0.6915371329879102, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "mask_shape": [1, 32, 1, 16384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:15.001962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2266839378238342, "overlap_percentage": 0.36958817317845827, "num_intersection": 700, "num_union": 3088, "num_only_computed": 1194, "num_only_roped": 1194, "total_diff": 2388, "diff_percentage": 0.7733160621761658, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "mask_shape": [1, 32, 1, 16384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:17.829126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 7.3909759521484375e-06, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.035679133858267716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16384, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16384, 64], "attention_shape": [1, 32, 1, 16384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:17.836043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16769420468557336, "overlap_percentage": 0.28722280887011614, "num_intersection": 544, "num_union": 3244, "num_only_computed": 1350, "num_only_roped": 1350, "total_diff": 2700, "diff_percentage": 0.8323057953144266, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "mask_shape": [1, 32, 1, 16385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:18.806445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4831636648394675, "overlap_percentage": 0.6515311510031679, "num_intersection": 1234, "num_union": 2554, "num_only_computed": 660, "num_only_roped": 660, "total_diff": 1320, "diff_percentage": 0.5168363351605325, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "mask_shape": [1, 32, 1, 16385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:19.049482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27929753461668355, "overlap_percentage": 0.43664202745512143, "num_intersection": 827, "num_union": 2961, "num_only_computed": 1067, "num_only_roped": 1067, "total_diff": 2134, "diff_percentage": 0.7207024653833164, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "mask_shape": [1, 32, 1, 16385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:19.127865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 1.2040138244628906e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.07967557251908397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16385, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16385, 64], "attention_shape": [1, 32, 1, 16385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:19.134221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15276932440657334, "overlap_percentage": 0.26504751847940866, "num_intersection": 502, "num_union": 3286, "num_only_computed": 1392, "num_only_roped": 1392, "total_diff": 2784, "diff_percentage": 0.8472306755934267, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "mask_shape": [1, 32, 1, 16386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:20.103208", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3249387897866387, "overlap_percentage": 0.4904963041182682, "num_intersection": 929, "num_union": 2859, "num_only_computed": 965, "num_only_roped": 965, "total_diff": 1930, "diff_percentage": 0.6750612102133613, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "mask_shape": [1, 32, 1, 16386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:20.346532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20983711274353242, "overlap_percentage": 0.3468848996832101, "num_intersection": 657, "num_union": 3131, "num_only_computed": 1237, "num_only_roped": 1237, "total_diff": 2474, "diff_percentage": 0.7901628872564675, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "mask_shape": [1, 32, 1, 16386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:20.424835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 4.500150680541992e-06, "l2_diff": 0.00885009765625, "l2_diff_relative": 0.016537408759124086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16386, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16386, 64], "attention_shape": [1, 32, 1, 16386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:20.431232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15770171149144255, "overlap_percentage": 0.27243928194297784, "num_intersection": 516, "num_union": 3272, "num_only_computed": 1378, "num_only_roped": 1378, "total_diff": 2756, "diff_percentage": 0.8422982885085575, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 0, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "mask_shape": [1, 32, 1, 16387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:21.398355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3366266760762174, "overlap_percentage": 0.5036958817317846, "num_intersection": 954, "num_union": 2834, "num_only_computed": 940, "num_only_roped": 940, "total_diff": 1880, "diff_percentage": 0.6633733239237827, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 12, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "mask_shape": [1, 32, 1, 16387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:21.641383", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22987012987012986, "overlap_percentage": 0.3738120380147835, "num_intersection": 708, "num_union": 3080, "num_only_computed": 1186, "num_only_roped": 1186, "total_diff": 2372, "diff_percentage": 0.7701298701298701, "num_computed": 1894, "num_roped": 1894}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "mask_shape": [1, 32, 1, 16387], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-09T21:40:21.719617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.8908252716064453e-06, "l2_diff": 0.011474609375, "l2_diff_relative": 0.020982142857142855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16387, "queries_shape": [1, 32, 1, 64], "keys_shape": [1, 8, 16387, 64], "attention_shape": [1, 32, 1, 16387]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
