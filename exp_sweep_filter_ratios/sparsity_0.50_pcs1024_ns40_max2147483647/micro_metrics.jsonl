{"timestamp": "2025-11-12T07:53:01.315950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:53:01.363231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030764910130718953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:53:07.469054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7372421281216069, "overlap_percentage": 0.84875, "num_intersection": 1098622, "num_union": 1490178, "num_only_computed": 212098, "num_only_roped": 179458, "total_diff": 391556, "diff_percentage": 0.26275787187839306, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:53:07.862511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.463859558105469e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.01819349315068493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:53:22.876799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5945304801644749, "overlap_percentage": 0.7457122802734375, "num_intersection": 1368388, "num_union": 2301628, "num_only_computed": 466620, "num_only_roped": 466620, "total_diff": 933240, "diff_percentage": 0.4054695198355251, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:53:25.714900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.1861324310302734e-05, "l2_diff": 0.20703125, "l2_diff_relative": 0.024720149253731342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:53:49.504504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5294594697091247, "overlap_percentage": 0.6923484802246094, "num_intersection": 1633455, "num_union": 3085137, "num_only_computed": 725841, "num_only_roped": 725841, "total_diff": 1451682, "diff_percentage": 0.4705405302908752, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:53:50.245194", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 8.52346420288086e-06, "l2_diff": 0.23046875, "l2_diff_relative": 0.025607638888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:19.940655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4897577296205943, "overlap_percentage": 0.6574998335404829, "num_intersection": 1895956, "num_union": 3871212, "num_only_computed": 987628, "num_only_roped": 987628, "total_diff": 1975256, "diff_percentage": 0.5102422703794057, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:22.925936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 9.417533874511719e-06, "l2_diff": 0.2138671875, "l2_diff_relative": 0.027820121951219513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:55.534684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4544858574960051, "overlap_percentage": 0.6249436598557693, "num_intersection": 2129728, "num_union": 4686016, "num_only_computed": 1278144, "num_only_roped": 1278144, "total_diff": 2556288, "diff_percentage": 0.5455141425039949, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:54:56.648335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.973743438720703e-06, "l2_diff": 0.216796875, "l2_diff_relative": 0.025694444444444443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:35.732921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4440052991222296, "overlap_percentage": 0.6149635314941406, "num_intersection": 2418135, "num_union": 5446185, "num_only_computed": 1514025, "num_only_roped": 1514025, "total_diff": 3028050, "diff_percentage": 0.5559947008777704, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:55:37.062547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.036592483520508e-06, "l2_diff": 0.23828125, "l2_diff_relative": 0.025248344370860928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:22.398849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4381899475271574, "overlap_percentage": 0.6093631071202895, "num_intersection": 2715595, "num_union": 6197301, "num_only_computed": 1740853, "num_only_roped": 1740853, "total_diff": 3481706, "diff_percentage": 0.5618100524728427, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:56:23.935165", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 4.738569259643555e-06, "l2_diff": 0.205078125, "l2_diff_relative": 0.0274581589958159}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:17.980403", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4261236114708105, "overlap_percentage": 0.5975970218056127, "num_intersection": 2976473, "num_union": 6984999, "num_only_computed": 2004263, "num_only_roped": 2004263, "total_diff": 4008526, "diff_percentage": 0.5738763885291894, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:57:19.733640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08544921875, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.2288135593220339}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:22.119715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40948947131317376, "overlap_percentage": 0.5810465131487165, "num_intersection": 3198675, "num_union": 7811373, "num_only_computed": 2306349, "num_only_roped": 2306349, "total_diff": 4612698, "diff_percentage": 0.5905105286868263, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:58:24.204256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 7.43865966796875e-05, "l2_diff": 3.140625, "l2_diff_relative": 0.6242236024844721}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:59:33.481767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4016425731375351, "overlap_percentage": 0.5731027022652004, "num_intersection": 3455415, "num_union": 8603209, "num_only_computed": 2573897, "num_only_roped": 2573897, "total_diff": 5147794, "diff_percentage": 0.598357426862465, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T07:59:35.829053", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 4.220008850097656e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.3268398268398268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:00:44.018915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3904044747320725, "overlap_percentage": 0.5615696465696466, "num_intersection": 216092, "num_union": 553508, "num_only_computed": 168708, "num_only_roped": 168708, "total_diff": 337416, "diff_percentage": 0.6095955252679275, "num_computed": 384800, "num_roped": 384800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:00:46.147438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.380859375, "l2_diff_relative": 0.1904296875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:01:49.866467", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3895096005887469, "overlap_percentage": 0.5606432664066637, "num_intersection": 93152, "num_union": 239152, "num_only_computed": 73000, "num_only_roped": 73000, "total_diff": 146000, "diff_percentage": 0.610490399411253, "num_computed": 166152, "num_roped": 166152}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:01:51.910254", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.1318359375, "l2_diff_relative": 0.10680379746835443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:02:50.447172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3894416481329744, "overlap_percentage": 0.5605728727885425, "num_intersection": 3327, "num_union": 8543, "num_only_computed": 2608, "num_only_roped": 2608, "total_diff": 5216, "diff_percentage": 0.6105583518670257, "num_computed": 5935, "num_roped": 5935}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:02:52.136025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0069580078125, "mean_diff": 1.4007091522216797e-05, "l2_diff": 0.0150146484375, "l2_diff_relative": 0.0637966804979253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:03:45.682341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3839337763786872, "overlap_percentage": 0.5548441449031171, "num_intersection": 3293, "num_union": 8577, "num_only_computed": 2642, "num_only_roped": 2642, "total_diff": 5284, "diff_percentage": 0.6160662236213128, "num_computed": 5935, "num_roped": 5935}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:03:47.398797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.015380859375, "l2_diff_relative": 0.061046511627906974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:04:40.293247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3900011708230886, "overlap_percentage": 0.5611522911051213, "num_intersection": 3331, "num_union": 8541, "num_only_computed": 2605, "num_only_roped": 2605, "total_diff": 5210, "diff_percentage": 0.6099988291769114, "num_computed": 5936, "num_roped": 5936}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:04:42.002285", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0216064453125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.1548076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:05:34.522245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3811074918566775, "overlap_percentage": 0.5518867924528302, "num_intersection": 3276, "num_union": 8596, "num_only_computed": 2660, "num_only_roped": 2660, "total_diff": 5320, "diff_percentage": 0.6188925081433225, "num_computed": 5936, "num_roped": 5936}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:05:36.245172", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0057373046875, "mean_diff": 1.3172626495361328e-05, "l2_diff": 0.01416015625, "l2_diff_relative": 0.06651376146788991}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:10.176147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:10.212543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003127639358108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:16.245697", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.734317417335537, "overlap_percentage": 0.8468085599505563, "num_intersection": 1096109, "num_union": 1492691, "num_only_computed": 214611, "num_only_roped": 181971, "total_diff": 396582, "diff_percentage": 0.26568258266446304, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:16.632061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.165836334228516e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.017237903225806452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:32.496219", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5783956001231745, "overlap_percentage": 0.7328905378069196, "num_intersection": 1344860, "num_union": 2325156, "num_only_computed": 490148, "num_only_roped": 490148, "total_diff": 980296, "diff_percentage": 0.42160439987682546, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:33.067558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.867813110351562e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.017857142857142856}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:54.105733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5136781742673633, "overlap_percentage": 0.6787151760525174, "num_intersection": 1601290, "num_union": 3117302, "num_only_computed": 758006, "num_only_roped": 758006, "total_diff": 1516012, "diff_percentage": 0.48632182573263677, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:06:54.881655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.2040138244628906e-05, "l2_diff": 0.25390625, "l2_diff_relative": 0.028609154929577465}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:07:22.187044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4960589191905278, "overlap_percentage": 0.6631542552601207, "num_intersection": 1912261, "num_union": 3854907, "num_only_computed": 971323, "num_only_roped": 971323, "total_diff": 1942646, "diff_percentage": 0.5039410808094722, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:07:23.135840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 9.000301361083984e-06, "l2_diff": 0.2041015625, "l2_diff_relative": 0.02512019230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:07:56.666072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4638949272288455, "overlap_percentage": 0.63378172654372, "num_intersection": 2159847, "num_union": 4655897, "num_only_computed": 1248025, "num_only_roped": 1248025, "total_diff": 2496050, "diff_percentage": 0.5361050727711545, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:07:57.825628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 8.106231689453125e-06, "l2_diff": 0.23828125, "l2_diff_relative": 0.02845149253731343}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:08:39.248764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44627076309011204, "overlap_percentage": 0.6171330769856771, "num_intersection": 2426666, "num_union": 5437654, "num_only_computed": 1505494, "num_only_roped": 1505494, "total_diff": 3010988, "diff_percentage": 0.553729236909888, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:08:42.407700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.28125, "l2_diff_relative": 0.03333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:09:28.641642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43633788708089805, "overlap_percentage": 0.607569975011489, "num_intersection": 2707604, "num_union": 6205292, "num_only_computed": 1748844, "num_only_roped": 1748844, "total_diff": 3497688, "diff_percentage": 0.563662112919102, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:09:30.215803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.5730342864990234e-06, "l2_diff": 0.25, "l2_diff_relative": 0.02877697841726619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:10:23.380814", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42840640359193993, "overlap_percentage": 0.5998382568359375, "num_intersection": 2987636, "num_union": 6973836, "num_only_computed": 1993100, "num_only_roped": 1993100, "total_diff": 3986200, "diff_percentage": 0.5715935964080601, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:10:25.171129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 2.9921531677246094e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.15310077519379844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:11:24.450871", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40600872641066693, "overlap_percentage": 0.5775337219238281, "num_intersection": 3179337, "num_union": 7830711, "num_only_computed": 2325687, "num_only_roped": 2325687, "total_diff": 4651374, "diff_percentage": 0.5939912735893331, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:11:28.876803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.32096069868995636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:12:35.981550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38287670258886625, "overlap_percentage": 0.5537394648012908, "num_intersection": 3338668, "num_union": 8719956, "num_only_computed": 2690644, "num_only_roped": 2690644, "total_diff": 5381288, "diff_percentage": 0.6171232974111337, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:12:38.730593", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12451171875, "mean_diff": 5.269050598144531e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.4521276595744681}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:13:52.879078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36868761599390504, "overlap_percentage": 0.5387461853027343, "num_intersection": 3530727, "num_union": 9576473, "num_only_computed": 3022873, "num_only_roped": 3022873, "total_diff": 6045746, "diff_percentage": 0.6313123840060949, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:13:55.423061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.9453125, "l2_diff_relative": 0.30365853658536585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:15:17.981027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3571930548506038, "overlap_percentage": 0.526370295771846, "num_intersection": 3725590, "num_union": 10430186, "num_only_computed": 3352298, "num_only_roped": 3352298, "total_diff": 6704596, "diff_percentage": 0.6428069451493962, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:15:20.777428", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 4.172325134277344e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.35046728971962615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:16:53.110555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3567211510911028, "overlap_percentage": 0.5258577281031115, "num_intersection": 3997663, "num_union": 11206689, "num_only_computed": 3604513, "num_only_roped": 3604513, "total_diff": 7209026, "diff_percentage": 0.6432788489088972, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:16:56.140936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.0067901611328125e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.4936708860759494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:18:34.416124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3532107070721704, "overlap_percentage": 0.5220335683514995, "num_intersection": 4242287, "num_union": 12010641, "num_only_computed": 3884177, "num_only_roped": 3884177, "total_diff": 7768354, "diff_percentage": 0.6467892929278296, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:18:39.477252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.5273972602739726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:20:25.476431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3601877662628005, "overlap_percentage": 0.5296147711318395, "num_intersection": 3969146, "num_union": 11019658, "num_only_computed": 3525256, "num_only_roped": 3525256, "total_diff": 7050512, "diff_percentage": 0.6398122337371994, "num_computed": 7494402, "num_roped": 7494402}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 894, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:20:31.301872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 894, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:16.121813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33969990119258253, "overlap_percentage": 0.5071283514915338, "num_intersection": 221751, "num_union": 652785, "num_only_computed": 215517, "num_only_roped": 215517, "total_diff": 431034, "diff_percentage": 0.6603000988074175, "num_computed": 437268, "num_roped": 437268}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:22:19.377534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.203125, "l2_diff_relative": 0.1262135922330097}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:49.558742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3379474940334129, "overlap_percentage": 0.5051730288976097, "num_intersection": 4248, "num_union": 12570, "num_only_computed": 4161, "num_only_roped": 4161, "total_diff": 8322, "diff_percentage": 0.6620525059665872, "num_computed": 8409, "num_roped": 8409}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:23:52.155043", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025634765625, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.19633507853403143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:25:11.902065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3386390768006367, "overlap_percentage": 0.5059453032104637, "num_intersection": 4255, "num_union": 12565, "num_only_computed": 4155, "num_only_roped": 4155, "total_diff": 8310, "diff_percentage": 0.6613609231993633, "num_computed": 8410, "num_roped": 8410}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:25:14.457754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.027099609375, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.055908203125, "l2_diff_relative": 0.2981770833333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:26:33.704594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3359809372517871, "overlap_percentage": 0.5029726516052319, "num_intersection": 4230, "num_union": 12590, "num_only_computed": 4180, "num_only_roped": 4180, "total_diff": 8360, "diff_percentage": 0.6640190627482129, "num_computed": 8410, "num_roped": 8410}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:26:36.284793", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.025390625, "l2_diff_relative": 0.11818181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:22.019535", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:22.033275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.003156043046357616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:27.988955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7286140105340755, "overlap_percentage": 0.8430037082818295, "num_intersection": 1091184, "num_union": 1497616, "num_only_computed": 219536, "num_only_roped": 186896, "total_diff": 406432, "diff_percentage": 0.2713859894659245, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:28.371349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.2874603271484375e-05, "l2_diff": 0.205078125, "l2_diff_relative": 0.02327127659574468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:43.177942", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5909388839373961, "overlap_percentage": 0.7428806849888393, "num_intersection": 1363192, "num_union": 2306824, "num_only_computed": 471816, "num_only_roped": 471816, "total_diff": 943632, "diff_percentage": 0.4090611160626038, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:27:43.729340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.3172626495361328e-05, "l2_diff": 0.2216796875, "l2_diff_relative": 0.02627314814814815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:05.532322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5291506792491963, "overlap_percentage": 0.6920844184027778, "num_intersection": 1632832, "num_union": 3085760, "num_only_computed": 726464, "num_only_roped": 726464, "total_diff": 1452928, "diff_percentage": 0.4708493207508037, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:06.266960", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.2333984375, "l2_diff_relative": 0.027458639705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:35.429232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4966113781710265, "overlap_percentage": 0.6636477383700284, "num_intersection": 1913684, "num_union": 3853484, "num_only_computed": 969900, "num_only_roped": 969900, "total_diff": 1939800, "diff_percentage": 0.5033886218289735, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:28:37.949760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.16796875, "l2_diff_relative": 0.018158783783783782}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:29:10.402909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4565665709690421, "overlap_percentage": 0.6269079355093149, "num_intersection": 2136422, "num_union": 4679322, "num_only_computed": 1271450, "num_only_roped": 1271450, "total_diff": 2542900, "diff_percentage": 0.5434334290309579, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:29:11.514933", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.586313247680664e-06, "l2_diff": 0.208984375, "l2_diff_relative": 0.02388392857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:29:49.924789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44802565390501753, "overlap_percentage": 0.6188090006510417, "num_intersection": 2433256, "num_union": 5431064, "num_only_computed": 1498904, "num_only_roped": 1498904, "total_diff": 2997808, "diff_percentage": 0.5519743460949825, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:29:51.242843", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.602836608886719e-06, "l2_diff": 0.248046875, "l2_diff_relative": 0.02896897810218978}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:30:36.662120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4320088315471708, "overlap_percentage": 0.6033605687758502, "num_intersection": 2688845, "num_union": 6224051, "num_only_computed": 1767603, "num_only_roped": 1767603, "total_diff": 3535206, "diff_percentage": 0.5679911684528292, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:30:38.187533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.3942203521728516e-06, "l2_diff": 0.234375, "l2_diff_relative": 0.02717391304347826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:31:32.767202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41472359093546135, "overlap_percentage": 0.5862962823165091, "num_intersection": 2920187, "num_union": 7041285, "num_only_computed": 2060549, "num_only_roped": 2060549, "total_diff": 4121098, "diff_percentage": 0.5852764090645386, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:31:36.858724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10986328125, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.578125, "l2_diff_relative": 0.2167381974248927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:32:35.706291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39533688304137, "overlap_percentage": 0.5666543869745164, "num_intersection": 3119446, "num_union": 7890602, "num_only_computed": 2385578, "num_only_roped": 2385578, "total_diff": 4771156, "diff_percentage": 0.6046631169586301, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:32:37.739597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 6.008148193359375e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.4547738693467337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:33:44.280743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3847596358286694, "overlap_percentage": 0.5557060241699219, "num_intersection": 3350525, "num_union": 8708099, "num_only_computed": 2678787, "num_only_roped": 2678787, "total_diff": 5357574, "diff_percentage": 0.6152403641713307, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:33:46.552864", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1923828125, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.609375, "l2_diff_relative": 0.41959798994974873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:35:01.198184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37605682953449315, "overlap_percentage": 0.5465716552734375, "num_intersection": 3582012, "num_union": 9525188, "num_only_computed": 2971588, "num_only_roped": 2971588, "total_diff": 5943176, "diff_percentage": 0.6239431704655068, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:35:04.355058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.4292929292929293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:36:28.621841", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36486692481533367, "overlap_percentage": 0.5346556769476997, "num_intersection": 3784233, "num_union": 10371543, "num_only_computed": 3293655, "num_only_roped": 3293655, "total_diff": 6587310, "diff_percentage": 0.6351330751846663, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:36:31.581127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 5.221366882324219e-05, "l2_diff": 3.125, "l2_diff_relative": 0.4608294930875576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:38:05.083769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35894485255244496, "overlap_percentage": 0.5282699321878368, "num_intersection": 4016001, "num_union": 11188351, "num_only_computed": 3586175, "num_only_roped": 3586175, "total_diff": 7172350, "diff_percentage": 0.6410551474475551, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:38:08.260973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:39:51.375600", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35795833281113576, "overlap_percentage": 0.5272007603799144, "num_intersection": 4284278, "num_union": 11968650, "num_only_computed": 3842186, "num_only_roped": 3842186, "total_diff": 7684372, "diff_percentage": 0.6420416671888642, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:39:55.865574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.291534423828125e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.4350282485875706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:41:45.192740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34440270043938437, "overlap_percentage": 0.5123505037989361, "num_intersection": 4025438, "num_union": 11688172, "num_only_computed": 3831367, "num_only_roped": 3831367, "total_diff": 7662734, "diff_percentage": 0.6555972995606156, "num_computed": 7856805, "num_roped": 7856805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:41:49.910681", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.75, "l2_diff_relative": 0.5146198830409356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:43:34.984608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3161556622211104, "overlap_percentage": 0.48042290330244714, "num_intersection": 121326, "num_union": 383754, "num_only_computed": 131214, "num_only_roped": 131214, "total_diff": 262428, "diff_percentage": 0.6838443377788896, "num_computed": 252540, "num_roped": 252540}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:43:40.759355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.12158203125, "l2_diff_relative": 0.09666149068322981}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:45:11.050344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3113707165109034, "overlap_percentage": 0.47487825157382113, "num_intersection": 3998, "num_union": 12840, "num_only_computed": 4421, "num_only_roped": 4421, "total_diff": 8842, "diff_percentage": 0.6886292834890966, "num_computed": 8419, "num_roped": 8419}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:45:13.832462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 2.86102294921875e-05, "l2_diff": 0.0184326171875, "l2_diff_relative": 0.09207317073170732}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:46:35.253848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33117242469760455, "overlap_percentage": 0.4975650314764224, "num_intersection": 4189, "num_union": 12649, "num_only_computed": 4230, "num_only_roped": 4230, "total_diff": 8460, "diff_percentage": 0.6688275753023954, "num_computed": 8419, "num_roped": 8419}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "mask_shape": [1, 32, 1, 16327], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:46:38.295397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.18220338983050846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "attention_shape": [1, 32, 1, 16327]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:25.175106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:25.188831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.003043519938650307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:31.163357", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7395487978110499, "overlap_percentage": 0.8502765760197775, "num_intersection": 1100598, "num_union": 1488202, "num_only_computed": 210122, "num_only_roped": 177482, "total_diff": 387604, "diff_percentage": 0.2604512021889502, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:31.548127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.0132789611816406e-05, "l2_diff": 0.1796875, "l2_diff_relative": 0.019691780821917807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:48.906008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5902460710910558, "overlap_percentage": 0.742333003452846, "num_intersection": 1362187, "num_union": 2307829, "num_only_computed": 472821, "num_only_roped": 472821, "total_diff": 945642, "diff_percentage": 0.4097539289089443, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:47:49.456525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.4066696166992188e-05, "l2_diff": 0.2236328125, "l2_diff_relative": 0.030323093220338982}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:48:10.976171", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5273737193908103, "overlap_percentage": 0.6905627780490451, "num_intersection": 1629242, "num_union": 3089350, "num_only_computed": 730054, "num_only_roped": 730054, "total_diff": 1460108, "diff_percentage": 0.47262628060918965, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:48:11.710728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.3053417205810547e-05, "l2_diff": 0.2578125, "l2_diff_relative": 0.03571428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:48:38.179105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48731691151534534, "overlap_percentage": 0.6552966724742543, "num_intersection": 1889603, "num_union": 3877565, "num_only_computed": 993981, "num_only_roped": 993981, "total_diff": 1987962, "diff_percentage": 0.5126830884846547, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:48:39.117588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.2255859375, "l2_diff_relative": 0.029829545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:49:11.573750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46509856253299603, "overlap_percentage": 0.6349041278545673, "num_intersection": 2163672, "num_union": 4652072, "num_only_computed": 1244200, "num_only_roped": 1244200, "total_diff": 2488400, "diff_percentage": 0.5349014374670039, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:49:12.690979", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 9.47713851928711e-06, "l2_diff": 0.2470703125, "l2_diff_relative": 0.032806016597510375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:49:51.383357", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4500390244496059, "overlap_percentage": 0.6207267761230468, "num_intersection": 2440797, "num_union": 5423523, "num_only_computed": 1491363, "num_only_roped": 1491363, "total_diff": 2982726, "diff_percentage": 0.5499609755503941, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:49:54.734356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.0192394256591797e-05, "l2_diff": 0.328125, "l2_diff_relative": 0.04411764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:50:39.342521", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.446252348585121, "overlap_percentage": 0.6171154695398667, "num_intersection": 2750143, "num_union": 6162753, "num_only_computed": 1706305, "num_only_roped": 1706305, "total_diff": 3412610, "diff_percentage": 0.553747651414879, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:50:40.873814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.3909759521484375e-06, "l2_diff": 0.265625, "l2_diff_relative": 0.03571428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:51:32.634053", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42987588473056493, "overlap_percentage": 0.6012772007992393, "num_intersection": 2994803, "num_union": 6966669, "num_only_computed": 1985933, "num_only_roped": 1985933, "total_diff": 3971866, "diff_percentage": 0.5701241152694351, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:51:34.404566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07666015625, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.375, "l2_diff_relative": 0.18723404255319148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:52:35.196526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4167790691300242, "overlap_percentage": 0.5883472987583706, "num_intersection": 3238866, "num_union": 7771182, "num_only_computed": 2266158, "num_only_roped": 2266158, "total_diff": 4532316, "diff_percentage": 0.5832209308699757, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:52:39.388265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.44086021505376344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:53:48.369340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3947666685828583, "overlap_percentage": 0.5660684005073879, "num_intersection": 3413003, "num_union": 8645621, "num_only_computed": 2616309, "num_only_roped": 2616309, "total_diff": 5232618, "diff_percentage": 0.6052333314171416, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:53:50.726404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.245208740234375e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.43548387096774194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:55:06.195984", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3824441032069957, "overlap_percentage": 0.5532868957519531, "num_intersection": 3626021, "num_union": 9481179, "num_only_computed": 2927579, "num_only_roped": 2927579, "total_diff": 5855158, "diff_percentage": 0.6175558967930044, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:55:08.735056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.555152893066406e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.4289772727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:56:31.860964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36486416127789406, "overlap_percentage": 0.5346527099609375, "num_intersection": 3784212, "num_union": 10371564, "num_only_computed": 3293676, "num_only_roped": 3293676, "total_diff": 6587352, "diff_percentage": 0.635135838722106, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:56:34.944525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.375, "l2_diff_relative": 0.3671497584541063}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:58:05.452327", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3659363274951478, "overlap_percentage": 0.5358029069571659, "num_intersection": 4073268, "num_union": 11131084, "num_only_computed": 3528908, "num_only_roped": 3528908, "total_diff": 7057816, "diff_percentage": 0.6340636725048522, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:58:08.490369", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.57763671875e-05, "l2_diff": 2.25, "l2_diff_relative": 0.4161849710982659}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:59:47.615127", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35382479898490593, "overlap_percentage": 0.5227039706322455, "num_intersection": 4247735, "num_union": 12005193, "num_only_computed": 3878729, "num_only_roped": 3878729, "total_diff": 7757458, "diff_percentage": 0.6461752010150941, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T08:59:51.163434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.9375, "l2_diff_relative": 0.3315508021390374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:01:37.950857", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3562409891542697, "overlap_percentage": 0.5253358245372246, "num_intersection": 4263075, "num_union": 11966829, "num_only_computed": 3851877, "num_only_roped": 3851877, "total_diff": 7703754, "diff_percentage": 0.6437590108457303, "num_computed": 8114952, "num_roped": 8114952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:01:42.411467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 4.267692565917969e-05, "l2_diff": 2.25, "l2_diff_relative": 0.43636363636363634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:03:28.035351", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3269664176074068, "overlap_percentage": 0.49280285208264, "num_intersection": 128830, "num_union": 394016, "num_only_computed": 132593, "num_only_roped": 132593, "total_diff": 265186, "diff_percentage": 0.6730335823925931, "num_computed": 261423, "num_roped": 261423}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:03:33.151975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.1513671875, "l2_diff_relative": 0.11886503067484662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:03.164259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3341770149489836, "overlap_percentage": 0.5009485416172634, "num_intersection": 4225, "num_union": 12643, "num_only_computed": 4209, "num_only_roped": 4209, "total_diff": 8418, "diff_percentage": 0.6658229850510163, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:06.274447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0086669921875, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.0245361328125, "l2_diff_relative": 0.13729508196721313}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:52.705310", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:52.717950", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0030174026946107784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:58.675187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7602083312085454, "overlap_percentage": 0.8637708590852905, "num_intersection": 1118065, "num_union": 1470735, "num_only_computed": 192655, "num_only_roped": 160015, "total_diff": 352670, "diff_percentage": 0.2397916687914546, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:05:59.062582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 7.808208465576172e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.01609563253012048}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:06:13.838484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6041941407392287, "overlap_percentage": 0.7532681056431362, "num_intersection": 1382253, "num_union": 2287763, "num_only_computed": 452755, "num_only_roped": 452755, "total_diff": 905510, "diff_percentage": 0.39580585926077133, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:06:16.698488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.940696716308594e-06, "l2_diff": 0.19140625, "l2_diff_relative": 0.01975806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:06:37.126778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5311116072123896, "overlap_percentage": 0.6937594943576388, "num_intersection": 1636784, "num_union": 3081808, "num_only_computed": 722512, "num_only_roped": 722512, "total_diff": 1445024, "diff_percentage": 0.4688883927876104, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:06:37.868129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.2412109375, "l2_diff_relative": 0.023823302469135804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:07:04.404576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4913217789215423, "overlap_percentage": 0.6589078036221591, "num_intersection": 1900016, "num_union": 3867152, "num_only_computed": 983568, "num_only_roped": 983568, "total_diff": 1967136, "diff_percentage": 0.5086782210784577, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:07:05.323443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.185546875, "l2_diff_relative": 0.02019557823129252}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:07:37.660531", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46965752631564195, "overlap_percentage": 0.6391387352576623, "num_intersection": 2178103, "num_union": 4637641, "num_only_computed": 1229769, "num_only_roped": 1229769, "total_diff": 2459538, "diff_percentage": 0.530342473684358, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:07:39.980821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 7.18235969543457e-06, "l2_diff": 0.228515625, "l2_diff_relative": 0.02611607142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:08:18.301073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.451741973332526, "overlap_percentage": 0.6223447163899739, "num_intersection": 2447159, "num_union": 5417161, "num_only_computed": 1485001, "num_only_roped": 1485001, "total_diff": 2970002, "diff_percentage": 0.548258026667474, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:08:21.043676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 8.344650268554688e-06, "l2_diff": 0.322265625, "l2_diff_relative": 0.039663461538461536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:09:05.717875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4366374715143364, "overlap_percentage": 0.6078603407915901, "num_intersection": 2708898, "num_union": 6203998, "num_only_computed": 1747550, "num_only_roped": 1747550, "total_diff": 3495100, "diff_percentage": 0.5633625284856636, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:09:07.247300", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 7.808208465576172e-06, "l2_diff": 0.3046875, "l2_diff_relative": 0.03721374045801527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:09:58.928283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42185296301915837, "overlap_percentage": 0.5933847929302015, "num_intersection": 2955493, "num_union": 7005979, "num_only_computed": 2025243, "num_only_roped": 2025243, "total_diff": 4050486, "diff_percentage": 0.5781470369808417, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:10:00.677834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 3.528594970703125e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.1962719298245614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:10:59.675804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40466428159708995, "overlap_percentage": 0.5761722383045015, "num_intersection": 3171842, "num_union": 7838206, "num_only_computed": 2333182, "num_only_roped": 2333182, "total_diff": 4666364, "diff_percentage": 0.5953357184029101, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:11:01.681081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.875, "l2_diff_relative": 0.4919786096256685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:12:09.044580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3890481216106411, "overlap_percentage": 0.5601650735606318, "num_intersection": 3377410, "num_union": 8681214, "num_only_computed": 2651902, "num_only_roped": 2651902, "total_diff": 5303804, "diff_percentage": 0.6109518783893589, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:12:11.354203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.437301635742188e-05, "l2_diff": 3.0, "l2_diff_relative": 0.5363128491620112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:13:25.987726", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38149218694665266, "overlap_percentage": 0.5522900390625, "num_intersection": 3619488, "num_union": 9487712, "num_only_computed": 2934112, "num_only_roped": 2934112, "total_diff": 5868224, "diff_percentage": 0.6185078130533473, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:13:28.557411", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.793571472167969e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.5027472527472527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:14:51.152968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37257443129519224, "overlap_percentage": 0.5428841202347366, "num_intersection": 3842473, "num_union": 10313303, "num_only_computed": 3235415, "num_only_roped": 3235415, "total_diff": 6470830, "diff_percentage": 0.6274255687048078, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:14:53.953935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.245208740234375e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.44385026737967914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:24.449395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3659123987459123, "overlap_percentage": 0.5357772564065868, "num_intersection": 4073073, "num_union": 11131279, "num_only_computed": 3529103, "num_only_roped": 3529103, "total_diff": 7058206, "diff_percentage": 0.6340876012540877, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:16:28.071154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.875, "l2_diff_relative": 0.431924882629108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:17:59.625350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3373790749998689, "overlap_percentage": 0.5045376906318083, "num_intersection": 578957, "num_union": 1716043, "num_only_computed": 568543, "num_only_roped": 568543, "total_diff": 1137086, "diff_percentage": 0.6626209250001311, "num_computed": 1147500, "num_roped": 1147500}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:18:05.109888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.25686813186813184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:31.782790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32154637815015175, "overlap_percentage": 0.4866214057507987, "num_intersection": 87732, "num_union": 272844, "num_only_computed": 92556, "num_only_roped": 92556, "total_diff": 185112, "diff_percentage": 0.6784536218498483, "num_computed": 180288, "num_roped": 180288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:19:34.535977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.21484375, "l2_diff_relative": 0.17973856209150327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:20:52.970118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3088850174216028, "overlap_percentage": 0.47198189804339147, "num_intersection": 3546, "num_union": 11480, "num_only_computed": 3967, "num_only_roped": 3967, "total_diff": 7934, "diff_percentage": 0.6911149825783972, "num_computed": 7513, "num_roped": 7513}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:20:55.242680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.026611328125, "l2_diff_relative": 0.09527972027972027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:35.568764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:35.581388", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0030623070987654323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:41.553588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7403943181718868, "overlap_percentage": 0.8508351359703338, "num_intersection": 1101321, "num_union": 1487479, "num_only_computed": 209399, "num_only_roped": 176759, "total_diff": 386158, "diff_percentage": 0.2596056818281132, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:44.624298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.049041748046875e-05, "l2_diff": 0.1962890625, "l2_diff_relative": 0.02066200657894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:21:59.480440", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5966636401248959, "overlap_percentage": 0.7473880222865513, "num_intersection": 1371463, "num_union": 2298553, "num_only_computed": 463545, "num_only_roped": 463545, "total_diff": 927090, "diff_percentage": 0.403336359875104, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:00.031831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 8.58306884765625e-06, "l2_diff": 0.1787109375, "l2_diff_relative": 0.019856770833333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:21.415225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5218584081642395, "overlap_percentage": 0.6858172946506076, "num_intersection": 1618046, "num_union": 3100546, "num_only_computed": 741250, "num_only_roped": 741250, "total_diff": 1482500, "diff_percentage": 0.47814159183576055, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:22.165819", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.0132789611816406e-05, "l2_diff": 0.2216796875, "l2_diff_relative": 0.025701992753623188}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:48.522927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49625842512686175, "overlap_percentage": 0.6633325056596235, "num_intersection": 1912775, "num_union": 3854393, "num_only_computed": 970809, "num_only_roped": 970809, "total_diff": 1941618, "diff_percentage": 0.5037415748731383, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:22:49.445991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 8.285045623779297e-06, "l2_diff": 0.2001953125, "l2_diff_relative": 0.024266098484848484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:23:21.874235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.475912020559603, "overlap_percentage": 0.6449056772085336, "num_intersection": 2197756, "num_union": 4617988, "num_only_computed": 1210116, "num_only_roped": 1210116, "total_diff": 2420232, "diff_percentage": 0.524087979440397, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:23:22.986896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.22265625, "l2_diff_relative": 0.02526595744680851}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:01.324622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44614390495558126, "overlap_percentage": 0.6170117696126302, "num_intersection": 2426189, "num_union": 5438131, "num_only_computed": 1505971, "num_only_roped": 1505971, "total_diff": 3011942, "diff_percentage": 0.5538560950444188, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:04.247212", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.265625, "l2_diff_relative": 0.02992957746478873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:48.670316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4367629914679817, "overlap_percentage": 0.6079819623161765, "num_intersection": 2709440, "num_union": 6203456, "num_only_computed": 1747008, "num_only_roped": 1747008, "total_diff": 3494016, "diff_percentage": 0.5632370085320183, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:24:50.172498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.224609375, "l2_diff_relative": 0.02461472602739726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:25:41.833614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4217255227815689, "overlap_percentage": 0.5932587071468955, "num_intersection": 2954865, "num_union": 7006607, "num_only_computed": 2025871, "num_only_roped": 2025871, "total_diff": 4051742, "diff_percentage": 0.5782744772184312, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:25:43.599107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.7109375, "l2_diff_relative": 0.23004201680672268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:26:42.833948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40145307520233153, "overlap_percentage": 0.5729097638811383, "num_intersection": 3153882, "num_union": 7856166, "num_only_computed": 2351142, "num_only_roped": 2351142, "total_diff": 4702284, "diff_percentage": 0.5985469247976685, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:26:44.861829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.104873657226562e-05, "l2_diff": 3.25, "l2_diff_relative": 0.5714285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:27:53.903890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3831409599818313, "overlap_percentage": 0.5540157815684443, "num_intersection": 3340334, "num_union": 8718290, "num_only_computed": 2688978, "num_only_roped": 2688978, "total_diff": 5377956, "diff_percentage": 0.6168590400181687, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:27:58.686772", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 5.626678466796875e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.42824074074074076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:29:13.004833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3681591520486271, "overlap_percentage": 0.5381817626953125, "num_intersection": 3527028, "num_union": 9580172, "num_only_computed": 3026572, "num_only_roped": 3026572, "total_diff": 6053144, "diff_percentage": 0.6318408479513729, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:29:15.544479", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.42924528301886794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:30:38.163472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36636759769547783, "overlap_percentage": 0.5362650553385416, "num_intersection": 3795624, "num_union": 10360152, "num_only_computed": 3282264, "num_only_roped": 3282264, "total_diff": 6564528, "diff_percentage": 0.6336324023045222, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:30:40.961373", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.609375, "l2_diff_relative": 0.41959798994974873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:32:12.211401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35539063746635896, "overlap_percentage": 0.5244106424265894, "num_intersection": 3986662, "num_union": 11217690, "num_only_computed": 3615514, "num_only_roped": 3615514, "total_diff": 7231028, "diff_percentage": 0.6446093625336411, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:32:15.253647", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.4375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:33:47.975336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3377550170207635, "overlap_percentage": 0.5049579522758331, "num_intersection": 960733, "num_union": 2844467, "num_only_computed": 941867, "num_only_roped": 941867, "total_diff": 1883734, "diff_percentage": 0.6622449829792365, "num_computed": 1902600, "num_roped": 1902600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:33:50.946926", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 4.458427429199219e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.35784313725490197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:35:20.370687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32996783735755464, "overlap_percentage": 0.4962042360560402, "num_intersection": 120137, "num_union": 364087, "num_only_computed": 121975, "num_only_roped": 121975, "total_diff": 243950, "diff_percentage": 0.6700321626424454, "num_computed": 242112, "num_roped": 242112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:35:24.739538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.039836883544922e-05, "l2_diff": 0.1796875, "l2_diff_relative": 0.14285714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:36:43.736470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35482138060703733, "overlap_percentage": 0.5237906423473434, "num_intersection": 3963, "num_union": 11169, "num_only_computed": 3603, "num_only_roped": 3603, "total_diff": 7206, "diff_percentage": 0.6451786193929626, "num_computed": 7566, "num_roped": 7566}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:36:47.592004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.055419921875, "l2_diff_relative": 0.31353591160220995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:31.188217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:31.200948", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.0030137624172185433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:37.152854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7275147157054497, "overlap_percentage": 0.8422674598269468, "num_intersection": 1090231, "num_union": 1498569, "num_only_computed": 220489, "num_only_roped": 187849, "total_diff": 408338, "diff_percentage": 0.2724852842945503, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:37.542450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.0728836059570312e-05, "l2_diff": 0.177734375, "l2_diff_relative": 0.019748263888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:52.512953", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6034000671065877, "overlap_percentage": 0.7526506696428571, "num_intersection": 1381120, "num_union": 2288896, "num_only_computed": 453888, "num_only_roped": 453888, "total_diff": 907776, "diff_percentage": 0.3965999328934124, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:37:55.686145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.8247318267822266e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.016733156028368796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:38:16.112250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5424030815426149, "overlap_percentage": 0.7033220926920573, "num_intersection": 1659345, "num_union": 3059247, "num_only_computed": 699951, "num_only_roped": 699951, "total_diff": 1399902, "diff_percentage": 0.4575969184573851, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:38:16.848138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 1.0251998901367188e-05, "l2_diff": 0.2421875, "l2_diff_relative": 0.028703703703703703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:38:43.235350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4743730645742274, "overlap_percentage": 0.6434912248091265, "num_intersection": 1855561, "num_union": 3911607, "num_only_computed": 1028023, "num_only_roped": 1028023, "total_diff": 2056046, "diff_percentage": 0.5256269354257725, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:38:44.158703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.2099609375, "l2_diff_relative": 0.02365757042253521}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:39:16.577771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44724594634881554, "overlap_percentage": 0.6180648803710938, "num_intersection": 2106286, "num_union": 4709458, "num_only_computed": 1301586, "num_only_roped": 1301586, "total_diff": 2603172, "diff_percentage": 0.5527540536511845, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:39:19.316519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 8.165836334228516e-06, "l2_diff": 0.2470703125, "l2_diff_relative": 0.028036347517730497}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:39:57.670120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4569383308879107, "overlap_percentage": 0.62725830078125, "num_intersection": 2466480, "num_union": 5397840, "num_only_computed": 1465680, "num_only_roped": 1465680, "total_diff": 2931360, "diff_percentage": 0.5430616691120893, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:40:01.072633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.330078125, "l2_diff_relative": 0.0385492700729927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:40:45.901195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4486514284246833, "overlap_percentage": 0.6194056342629826, "num_intersection": 2760349, "num_union": 6152547, "num_only_computed": 1696099, "num_only_roped": 1696099, "total_diff": 3392198, "diff_percentage": 0.5513485715753167, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:40:47.493159", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.234375, "l2_diff_relative": 0.026785714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:41:39.958538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4180511738333626, "overlap_percentage": 0.5896136635228207, "num_intersection": 2936710, "num_union": 7024762, "num_only_computed": 2044026, "num_only_roped": 2044026, "total_diff": 4088052, "diff_percentage": 0.5819488261666373, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:41:41.721713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.25849514563106796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:42:40.826577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39677444195552136, "overlap_percentage": 0.5681295849028087, "num_intersection": 3127567, "num_union": 7882481, "num_only_computed": 2377457, "num_only_roped": 2377457, "total_diff": 4754914, "diff_percentage": 0.6032255580444786, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:42:42.866113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 6.0558319091796875e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.450261780104712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:43:51.664331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40487863073246566, "overlap_percentage": 0.5763894786005435, "num_intersection": 3475232, "num_union": 8583392, "num_only_computed": 2554080, "num_only_roped": 2554080, "total_diff": 5108160, "diff_percentage": 0.5951213692675343, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:43:55.803648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 5.364418029785156e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.4411764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:45:10.755123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3919741230787105, "overlap_percentage": 0.5631916809082032, "num_intersection": 3690933, "num_union": 9416267, "num_only_computed": 2862667, "num_only_roped": 2862667, "total_diff": 5725334, "diff_percentage": 0.6080258769212895, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:45:13.334998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10595703125, "mean_diff": 5.4836273193359375e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.4274611398963731}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:46:35.979640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36651717373210474, "overlap_percentage": 0.5364252726236979, "num_intersection": 3796758, "num_union": 10359018, "num_only_computed": 3281130, "num_only_roped": 3281130, "total_diff": 6562260, "diff_percentage": 0.6334828262678953, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:46:38.791487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10693359375, "mean_diff": 4.57763671875e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.3787878787878788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:48:09.363473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35334921698668514, "overlap_percentage": 0.5221848323427397, "num_intersection": 3969741, "num_union": 11234611, "num_only_computed": 3632435, "num_only_roped": 3632435, "total_diff": 7264870, "diff_percentage": 0.6466507830133148, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:48:12.402249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.41581632653061223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:49:50.277533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35760874032261997, "overlap_percentage": 0.5268215056388609, "num_intersection": 4281196, "num_union": 11971732, "num_only_computed": 3845268, "num_only_roped": 3845268, "total_diff": 7690536, "diff_percentage": 0.64239125967738, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:49:55.751758", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.75, "l2_diff_relative": 0.2731707317073171}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:51:37.840722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3431508027153574, "overlap_percentage": 0.5109639245595247, "num_intersection": 1837833, "num_union": 5355759, "num_only_computed": 1758963, "num_only_roped": 1758963, "total_diff": 3517926, "diff_percentage": 0.6568491972846425, "num_computed": 3596796, "num_roped": 3596796}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 441, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:51:41.154272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.3517857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 441, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:53:21.387427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33283020407330727, "overlap_percentage": 0.4994337659157689, "num_intersection": 97905, "num_union": 294159, "num_only_computed": 98127, "num_only_roped": 98127, "total_diff": 196254, "diff_percentage": 0.6671697959266927, "num_computed": 196032, "num_roped": 196032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:53:24.446108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.11181640625, "l2_diff_relative": 0.0888975155279503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:54:50.822139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3506944444444444, "overlap_percentage": 0.519280205655527, "num_intersection": 4242, "num_union": 12096, "num_only_computed": 3927, "num_only_roped": 3927, "total_diff": 7854, "diff_percentage": 0.6493055555555556, "num_computed": 8169, "num_roped": 8169}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:54:53.324349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.006103515625, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.0179443359375, "l2_diff_relative": 0.07989130434782608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:56:10.327509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.336441717791411, "overlap_percentage": 0.5034887991186192, "num_intersection": 4113, "num_union": 12225, "num_only_computed": 4056, "num_only_roped": 4056, "total_diff": 8112, "diff_percentage": 0.6635582822085889, "num_computed": 8169, "num_roped": 8169}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:56:13.186295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.0274658203125, "l2_diff_relative": 0.12335526315789473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:57:30.267908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.337918611315811, "overlap_percentage": 0.5051407588739291, "num_intersection": 4127, "num_union": 12213, "num_only_computed": 4043, "num_only_roped": 4043, "total_diff": 8086, "diff_percentage": 0.662081388684189, "num_computed": 8170, "num_roped": 8170}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:57:34.098040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.12138429752066116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:58:51.947237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3467402950630512, "overlap_percentage": 0.5149326805385557, "num_intersection": 4207, "num_union": 12133, "num_only_computed": 3963, "num_only_roped": 3963, "total_diff": 7926, "diff_percentage": 0.6532597049369488, "num_computed": 8170, "num_roped": 8170}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "mask_shape": [1, 32, 1, 15829], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T09:58:54.460178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.11696428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "attention_shape": [1, 32, 1, 15829]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:00:12.842091", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34801616761527676, "overlap_percentage": 0.5163382694896586, "num_intersection": 4219, "num_union": 12123, "num_only_computed": 3952, "num_only_roped": 3952, "total_diff": 7904, "diff_percentage": 0.6519838323847232, "num_computed": 8171, "num_roped": 8171}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "mask_shape": [1, 32, 1, 15830], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:00:15.362919", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.0274658203125, "l2_diff_relative": 0.11670124481327801}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "attention_shape": [1, 32, 1, 15830]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:00:56.023592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:00:56.031952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030967310855263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:02.035188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7345358769798118, "overlap_percentage": 0.8469538009888752, "num_intersection": 1096297, "num_union": 1492503, "num_only_computed": 214423, "num_only_roped": 181783, "total_diff": 396206, "diff_percentage": 0.26546412302018824, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:03.051616", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.0788440704345703e-05, "l2_diff": 0.1826171875, "l2_diff_relative": 0.020290798611111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:15.252137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5483768640213754, "overlap_percentage": 0.7083247971003073, "num_intersection": 179787, "num_union": 327853, "num_only_computed": 74033, "num_only_roped": 74033, "total_diff": 148066, "diff_percentage": 0.4516231359786246, "num_computed": 253820, "num_roped": 253820}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:16.815072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.11376953125, "l2_diff_relative": 0.03434551886792453}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:28.863339", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.525901769385012, "overlap_percentage": 0.6892996389891697, "num_intersection": 23867, "num_union": 45383, "num_only_computed": 10758, "num_only_roped": 10758, "total_diff": 21516, "diff_percentage": 0.474098230614988, "num_computed": 34625, "num_roped": 34625}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:30.599149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010009765625, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.028076171875, "l2_diff_relative": 0.0224609375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:42.064139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5103598691384951, "overlap_percentage": 0.675812274368231, "num_intersection": 936, "num_union": 1834, "num_only_computed": 449, "num_only_roped": 449, "total_diff": 898, "diff_percentage": 0.48964013086150493, "num_computed": 1385, "num_roped": 1385}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:44.399335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00146484375, "mean_diff": 1.0311603546142578e-05, "l2_diff": 0.0036468505859375, "l2_diff_relative": 0.014362980769230769}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:55.324835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5114503816793893, "overlap_percentage": 0.6767676767676768, "num_intersection": 938, "num_union": 1834, "num_only_computed": 448, "num_only_roped": 448, "total_diff": 896, "diff_percentage": 0.48854961832061067, "num_computed": 1386, "num_roped": 1386}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:01:57.764252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.01080322265625, "l2_diff_relative": 0.04983108108108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:08.682646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5205704882062534, "overlap_percentage": 0.6847041847041847, "num_intersection": 949, "num_union": 1823, "num_only_computed": 437, "num_only_roped": 437, "total_diff": 874, "diff_percentage": 0.4794295117937466, "num_computed": 1386, "num_roped": 1386}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "mask_shape": [1, 32, 1, 2261], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:11.580913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00244140625, "mean_diff": 1.2814998626708984e-05, "l2_diff": 0.004150390625, "l2_diff_relative": 0.018722466960352423}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "attention_shape": [1, 32, 1, 2261]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:22.539029", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5108932461873639, "overlap_percentage": 0.6762797404470079, "num_intersection": 938, "num_union": 1836, "num_only_computed": 449, "num_only_roped": 449, "total_diff": 898, "diff_percentage": 0.4891067538126362, "num_computed": 1387, "num_roped": 1387}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "mask_shape": [1, 32, 1, 2262], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:25.513033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 1.5735626220703125e-05, "l2_diff": 0.006011962890625, "l2_diff_relative": 0.023677884615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "attention_shape": [1, 32, 1, 2262]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:34.412204", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:34.424767", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031105324074074073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:40.364542", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7340060912590366, "overlap_percentage": 0.8466015142150803, "num_intersection": 1095841, "num_union": 1492959, "num_only_computed": 214879, "num_only_roped": 182239, "total_diff": 397118, "diff_percentage": 0.2659939087409634, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:40.748931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.0311603546142578e-05, "l2_diff": 0.1787109375, "l2_diff_relative": 0.020424107142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:55.610353", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5953858339049746, "overlap_percentage": 0.746384756905692, "num_intersection": 1369622, "num_union": 2300394, "num_only_computed": 465386, "num_only_roped": 465386, "total_diff": 930772, "diff_percentage": 0.4046141660950255, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:02:56.158837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 9.298324584960938e-06, "l2_diff": 0.177734375, "l2_diff_relative": 0.019748263888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:03:17.655004", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5233707014890873, "overlap_percentage": 0.6871219211154513, "num_intersection": 1621124, "num_union": 3097468, "num_only_computed": 738172, "num_only_roped": 738172, "total_diff": 1476344, "diff_percentage": 0.4766292985109128, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:03:20.827533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 8.046627044677734e-06, "l2_diff": 0.2373046875, "l2_diff_relative": 0.025829081632653062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:03:48.339572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49100253879285827, "overlap_percentage": 0.6586206609552557, "num_intersection": 1899188, "num_union": 3867980, "num_only_computed": 984396, "num_only_roped": 984396, "total_diff": 1968792, "diff_percentage": 0.5089974612071417, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:03:49.383297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.616115570068359e-06, "l2_diff": 0.1884765625, "l2_diff_relative": 0.0192078025477707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:04:21.811751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46922002094406967, "overlap_percentage": 0.6387334970327524, "num_intersection": 2176722, "num_union": 4639022, "num_only_computed": 1231150, "num_only_roped": 1231150, "total_diff": 2462300, "diff_percentage": 0.5307799790559303, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:04:22.931955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.01729559748427673}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:05:01.285647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45227546830931104, "overlap_percentage": 0.6228507995605469, "num_intersection": 2449149, "num_union": 5415171, "num_only_computed": 1483011, "num_only_roped": 1483011, "total_diff": 2966022, "diff_percentage": 0.547724531690689, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:05:02.589110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 5.7220458984375e-06, "l2_diff": 0.28125, "l2_diff_relative": 0.029605263157894735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:05:48.049611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4329870950875928, "overlap_percentage": 0.6043140186982996, "num_intersection": 2693094, "num_union": 6219802, "num_only_computed": 1763354, "num_only_roped": 1763354, "total_diff": 3526708, "diff_percentage": 0.5670129049124072, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:05:49.579544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 7.599592208862305e-06, "l2_diff": 0.3203125, "l2_diff_relative": 0.03713768115942029}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:06:43.260226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4182960779514744, "overlap_percentage": 0.5898572018271998, "num_intersection": 2937923, "num_union": 7023549, "num_only_computed": 2042813, "num_only_roped": 2042813, "total_diff": 4085626, "diff_percentage": 0.5817039220485256, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:06:45.018394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.20378151260504201}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:46.648279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4083894618645358, "overlap_percentage": 0.5799382527669271, "num_intersection": 3192574, "num_union": 7817474, "num_only_computed": 2312450, "num_only_roped": 2312450, "total_diff": 4624900, "diff_percentage": 0.5916105381354643, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:07:48.676646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.05718994140625e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.5542857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:55.626913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3923668804259143, "overlap_percentage": 0.5635969742484714, "num_intersection": 3398102, "num_union": 8660522, "num_only_computed": 2631210, "num_only_roped": 2631210, "total_diff": 5262420, "diff_percentage": 0.6076331195740857, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:08:57.913052", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 5.745887756347656e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.44883720930232557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:11.760326", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37199863189553617, "overlap_percentage": 0.542272598889676, "num_intersection": 2927906, "num_union": 7870744, "num_only_computed": 2471419, "num_only_roped": 2471419, "total_diff": 4942838, "diff_percentage": 0.6280013681044638, "num_computed": 5399325, "num_roped": 5399325}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 855, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:10:16.507657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.343292236328125e-05, "l2_diff": 3.1875, "l2_diff_relative": 0.6710526315789473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 855, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:11:29.816722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36708943317847503, "overlap_percentage": 0.5370379205184759, "num_intersection": 146338, "num_union": 398644, "num_only_computed": 126153, "num_only_roped": 126153, "total_diff": 252306, "diff_percentage": 0.632910566821525, "num_computed": 272491, "num_roped": 272491}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:11:32.120257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.396484375, "l2_diff_relative": 0.2916666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:12:36.003173", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.360601180891036, "overlap_percentage": 0.530061543317027, "num_intersection": 3359, "num_union": 9315, "num_only_computed": 2978, "num_only_roped": 2978, "total_diff": 5956, "diff_percentage": 0.639398819108964, "num_computed": 6337, "num_roped": 6337}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:12:37.879382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029052734375, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.068359375, "l2_diff_relative": 0.40229885057471265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:13:35.353251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37737694230142343, "overlap_percentage": 0.5479646576207006, "num_intersection": 3473, "num_union": 9203, "num_only_computed": 2865, "num_only_roped": 2865, "total_diff": 5730, "diff_percentage": 0.6226230576985765, "num_computed": 6338, "num_roped": 6338}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:13:37.205534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.0771484375, "l2_diff_relative": 0.4388888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:14:34.068905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3595023595023595, "overlap_percentage": 0.5288734616598296, "num_intersection": 3352, "num_union": 9324, "num_only_computed": 2986, "num_only_roped": 2986, "total_diff": 5972, "diff_percentage": 0.6404976404976405, "num_computed": 6338, "num_roped": 6338}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:14:35.917610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00994873046875, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.0234375, "l2_diff_relative": 0.08633093525179857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:10.160108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:10.169558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.002972146739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:16.102201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7342186637512929, "overlap_percentage": 0.8467428924598269, "num_intersection": 1096024, "num_union": 1492776, "num_only_computed": 214696, "num_only_roped": 182056, "total_diff": 396752, "diff_percentage": 0.2657813362487071, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:16.488612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0172119140625, "mean_diff": 1.2099742889404297e-05, "l2_diff": 0.21484375, "l2_diff_relative": 0.023871527777777776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:31.272669", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5927838094014631, "overlap_percentage": 0.7443368094308036, "num_intersection": 1365864, "num_union": 2304152, "num_only_computed": 469144, "num_only_roped": 469144, "total_diff": 938288, "diff_percentage": 0.4072161905985369, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:31.810051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.059906005859375e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.019239738805970148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:52.302738", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5219678723797488, "overlap_percentage": 0.6859118143717448, "num_intersection": 1618269, "num_union": 3100323, "num_only_computed": 741027, "num_only_roped": 741027, "total_diff": 1482054, "diff_percentage": 0.47803212762025116, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:15:53.055594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.0251998901367188e-05, "l2_diff": 0.2421875, "l2_diff_relative": 0.027288732394366196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:16:19.439410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5050500042015952, "overlap_percentage": 0.671140497381037, "num_intersection": 1935290, "num_union": 3831878, "num_only_computed": 948294, "num_only_roped": 948294, "total_diff": 1896588, "diff_percentage": 0.4949499957984049, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:16:20.373865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.1748046875, "l2_diff_relative": 0.019422743055555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:16:52.812725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4822522119900353, "overlap_percentage": 0.6507019629845252, "num_intersection": 2217509, "num_union": 4598235, "num_only_computed": 1190363, "num_only_roped": 1190363, "total_diff": 2380726, "diff_percentage": 0.5177477880099647, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:16:53.920420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.781650543212891e-06, "l2_diff": 0.185546875, "l2_diff_relative": 0.021205357142857144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:17:32.750204", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4655999630260426, "overlap_percentage": 0.6353711446126302, "num_intersection": 2498381, "num_union": 5365939, "num_only_computed": 1433779, "num_only_roped": 1433779, "total_diff": 2867558, "diff_percentage": 0.5344000369739574, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:17:34.067699", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 5.513429641723633e-06, "l2_diff": 0.248046875, "l2_diff_relative": 0.028552158273381294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:18:18.845457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4557967864948568, "overlap_percentage": 0.6261818829704734, "num_intersection": 2790547, "num_union": 6122349, "num_only_computed": 1665901, "num_only_roped": 1665901, "total_diff": 3331802, "diff_percentage": 0.5442032135051432, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:18:22.217714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.2734375, "l2_diff_relative": 0.036458333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:19:12.413170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4215624529661122, "overlap_percentage": 0.5930973374915968, "num_intersection": 1442475, "num_union": 3421735, "num_only_computed": 989630, "num_only_roped": 989630, "total_diff": 1979260, "diff_percentage": 0.5784375470338878, "num_computed": 2432105, "num_roped": 2432105}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 527, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:19:14.023567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 2.8371810913085938e-05, "l2_diff": 0.69140625, "l2_diff_relative": 0.13014705882352942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 527, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:20:04.893892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40685313526796807, "overlap_percentage": 0.5783875019626314, "num_intersection": 88410, "num_union": 217302, "num_only_computed": 64446, "num_only_roped": 64446, "total_diff": 128892, "diff_percentage": 0.5931468647320319, "num_computed": 152856, "num_roped": 152856}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:20:06.432268", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.9087066650390625e-05, "l2_diff": 0.1162109375, "l2_diff_relative": 0.09070121951219512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:20:50.359569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4057663125948407, "overlap_percentage": 0.5772884283246977, "num_intersection": 2674, "num_union": 6590, "num_only_computed": 1958, "num_only_roped": 1958, "total_diff": 3916, "diff_percentage": 0.5942336874051594, "num_computed": 4632, "num_roped": 4632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:20:51.631206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.09797297297297297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:21:31.748953", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41336180597925565, "overlap_percentage": 0.58493416792575, "num_intersection": 2710, "num_union": 6556, "num_only_computed": 1923, "num_only_roped": 1923, "total_diff": 3846, "diff_percentage": 0.5866381940207444, "num_computed": 4633, "num_roped": 4633}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:21:33.051342", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00634765625, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.014404296875, "l2_diff_relative": 0.07412060301507538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:13.214083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4235673682593332, "overlap_percentage": 0.5950787826462336, "num_intersection": 2757, "num_union": 6509, "num_only_computed": 1876, "num_only_roped": 1876, "total_diff": 3752, "diff_percentage": 0.5764326317406667, "num_computed": 4633, "num_roped": 4633}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:14.487356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.016357421875, "l2_diff_relative": 0.05267295597484277}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:40.168420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:40.182064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030565137987012985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:46.196196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.733199254981408, "overlap_percentage": 0.8460645859085291, "num_intersection": 1095146, "num_union": 1493654, "num_only_computed": 215574, "num_only_roped": 182934, "total_diff": 398508, "diff_percentage": 0.26680074501859197, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:22:46.580397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.0788440704345703e-05, "l2_diff": 0.1787109375, "l2_diff_relative": 0.02102481617647059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:01.528909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.589860287845766, "overlap_percentage": 0.742027827671596, "num_intersection": 1361627, "num_union": 2308389, "num_only_computed": 473381, "num_only_roped": 473381, "total_diff": 946762, "diff_percentage": 0.41013971215423395, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:02.089867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.245737075805664e-05, "l2_diff": 0.2109375, "l2_diff_relative": 0.025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:24.112074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5292676381710205, "overlap_percentage": 0.6921844482421875, "num_intersection": 1633068, "num_union": 3085524, "num_only_computed": 726228, "num_only_roped": 726228, "total_diff": 1452456, "diff_percentage": 0.47073236182897943, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:27.221251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.1205673217773438e-05, "l2_diff": 0.2294921875, "l2_diff_relative": 0.02740205223880597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:55.006614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48881203385625677, "overlap_percentage": 0.6566470753062855, "num_intersection": 1893497, "num_union": 3873671, "num_only_computed": 990087, "num_only_roped": 990087, "total_diff": 1980174, "diff_percentage": 0.5111879661437433, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:23:56.458873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 9.179115295410156e-06, "l2_diff": 0.208984375, "l2_diff_relative": 0.02729591836734694}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:24:29.766112", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4634840990431169, "overlap_percentage": 0.6333982027493991, "num_intersection": 2158540, "num_union": 4657204, "num_only_computed": 1249332, "num_only_roped": 1249332, "total_diff": 2498664, "diff_percentage": 0.5365159009568832, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:24:30.894027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 8.940696716308594e-06, "l2_diff": 0.255859375, "l2_diff_relative": 0.031490384615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:25:10.825687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44791848094050485, "overlap_percentage": 0.6187067667643229, "num_intersection": 2432854, "num_union": 5431466, "num_only_computed": 1499306, "num_only_roped": 1499306, "total_diff": 2998612, "diff_percentage": 0.5520815190594952, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:25:12.157481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 7.0035457611083984e-06, "l2_diff": 0.2890625, "l2_diff_relative": 0.037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:25:57.589990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4380525768999239, "overlap_percentage": 0.609230265897863, "num_intersection": 2715003, "num_union": 6197893, "num_only_computed": 1741445, "num_only_roped": 1741445, "total_diff": 3482890, "diff_percentage": 0.5619474231000761, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:26:01.323860", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.738569259643555e-06, "l2_diff": 0.2294921875, "l2_diff_relative": 0.02641636690647482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:26:54.491294", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41946765858924623, "overlap_percentage": 0.591021086040296, "num_intersection": 2943720, "num_union": 7017752, "num_only_computed": 2037016, "num_only_roped": 2037016, "total_diff": 4074032, "diff_percentage": 0.5805323414107537, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:26:56.713848", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 2.7418136596679688e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.1565040650406504}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:27:56.349591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39611025849990955, "overlap_percentage": 0.5674483889625186, "num_intersection": 3123817, "num_union": 7886231, "num_only_computed": 2381207, "num_only_roped": 2381207, "total_diff": 4762414, "diff_percentage": 0.6038897415000904, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:27:58.400749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.792213439941406e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.3419811320754717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:29:05.801916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3778467465337658, "overlap_percentage": 0.5484597579292629, "num_intersection": 3306835, "num_union": 8751789, "num_only_computed": 2722477, "num_only_roped": 2722477, "total_diff": 5444954, "diff_percentage": 0.6221532534662342, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:29:08.083867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.96875, "l2_diff_relative": 0.2703862660944206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:30:24.760881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.372382231570236, "overlap_percentage": 0.5426800537109375, "num_intersection": 3556508, "num_union": 9550692, "num_only_computed": 2997092, "num_only_roped": 2997092, "total_diff": 5994184, "diff_percentage": 0.627617768429764, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:30:27.315321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.5, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:31:49.279533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35907696514348303, "overlap_percentage": 0.5284129955150463, "num_intersection": 3740048, "num_union": 10415728, "num_only_computed": 3337840, "num_only_roped": 3337840, "total_diff": 6675680, "diff_percentage": 0.640923034856517, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:31:52.073931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.45054945054945056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:33:22.383927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3517214401669965, "overlap_percentage": 0.5204052102976832, "num_intersection": 3956212, "num_union": 11248140, "num_only_computed": 3645964, "num_only_roped": 3645964, "total_diff": 7291928, "diff_percentage": 0.6482785598330035, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:33:25.428975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.45263157894736844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:35:04.356531", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3442851746598351, "overlap_percentage": 0.512220444217805, "num_intersection": 4162541, "num_union": 12090387, "num_only_computed": 3963923, "num_only_roped": 3963923, "total_diff": 7927846, "diff_percentage": 0.6557148253401649, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:35:07.659814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 3.7670135498046875e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.3373205741626794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:36:56.248526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3372687634473979, "overlap_percentage": 0.5044143296639031, "num_intersection": 3677756, "num_union": 10904526, "num_only_computed": 3613385, "num_only_roped": 3613385, "total_diff": 7226770, "diff_percentage": 0.6627312365526021, "num_computed": 7291141, "num_roped": 7291141}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 871, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:36:59.776798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 4.220008850097656e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.4654255319148936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 871, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:38:45.415622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3095808259498975, "overlap_percentage": 0.4727937670060871, "num_intersection": 134837, "num_union": 435547, "num_only_computed": 150355, "num_only_roped": 150355, "total_diff": 300710, "diff_percentage": 0.6904191740501026, "num_computed": 285192, "num_roped": 285192}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:38:48.652436", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 2.9206275939941406e-05, "l2_diff": 0.259765625, "l2_diff_relative": 0.2015151515151515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:40:18.975782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3053761767680697, "overlap_percentage": 0.4678745976874478, "num_intersection": 3925, "num_union": 12853, "num_only_computed": 4464, "num_only_roped": 4464, "total_diff": 8928, "diff_percentage": 0.6946238232319303, "num_computed": 8389, "num_roped": 8389}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:40:21.592509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.0240478515625, "l2_diff_relative": 0.11507009345794393}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:41:42.045467", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30112446684761535, "overlap_percentage": 0.4628680414828943, "num_intersection": 3883, "num_union": 12895, "num_only_computed": 4506, "num_only_roped": 4506, "total_diff": 9012, "diff_percentage": 0.6988755331523846, "num_computed": 8389, "num_roped": 8389}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:41:44.647409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00531005859375, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.0167236328125, "l2_diff_relative": 0.09956395348837209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:43:05.235881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3154593916588272, "overlap_percentage": 0.4796185935637664, "num_intersection": 4024, "num_union": 12756, "num_only_computed": 4366, "num_only_roped": 4366, "total_diff": 8732, "diff_percentage": 0.6845406083411728, "num_computed": 8390, "num_roped": 8390}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:43:07.825241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.430511474609375e-05, "l2_diff": 0.0269775390625, "l2_diff_relative": 0.09727112676056338}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:44:28.403386", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.324388318863457, "overlap_percentage": 0.4898688915375447, "num_intersection": 4110, "num_union": 12670, "num_only_computed": 4280, "num_only_roped": 4280, "total_diff": 8560, "diff_percentage": 0.675611681136543, "num_computed": 8390, "num_roped": 8390}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:44:30.979539", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.14156626506024098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:45:53.253677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3088441740758072, "overlap_percentage": 0.4719342152306042, "num_intersection": 3960, "num_union": 12822, "num_only_computed": 4431, "num_only_roped": 4431, "total_diff": 8862, "diff_percentage": 0.6911558259241928, "num_computed": 8391, "num_roped": 8391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:45:55.927045", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.11833333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:47:18.399194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29301178827336466, "overlap_percentage": 0.45322369205100704, "num_intersection": 3803, "num_union": 12979, "num_only_computed": 4588, "num_only_roped": 4588, "total_diff": 9176, "diff_percentage": 0.7069882117266353, "num_computed": 8391, "num_roped": 8391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:47:21.097528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.0255126953125, "l2_diff_relative": 0.16534810126582278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:48:43.167932", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31856390918375366, "overlap_percentage": 0.48319828408007626, "num_intersection": 4055, "num_union": 12729, "num_only_computed": 4337, "num_only_roped": 4337, "total_diff": 8674, "diff_percentage": 0.6814360908162463, "num_computed": 8392, "num_roped": 8392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:48:45.778483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.3530254364013672e-05, "l2_diff": 0.0224609375, "l2_diff_relative": 0.08518518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:49:34.245293", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:49:34.257987", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0029829545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:49:40.236301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7345567962157074, "overlap_percentage": 0.8469677070457354, "num_intersection": 1096315, "num_union": 1492485, "num_only_computed": 214405, "num_only_roped": 181765, "total_diff": 396170, "diff_percentage": 0.26544320378429265, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:49:40.626073", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.1682510375976562e-05, "l2_diff": 0.2158203125, "l2_diff_relative": 0.022868377483443707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:49:56.324038", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5932941277599251, "overlap_percentage": 0.7447389875139508, "num_intersection": 1366602, "num_union": 2303414, "num_only_computed": 468406, "num_only_roped": 468406, "total_diff": 936812, "diff_percentage": 0.40670587224007493, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:49:56.885024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 9.47713851928711e-06, "l2_diff": 0.1865234375, "l2_diff_relative": 0.01937905844155844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:50:17.651815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5227807561184354, "overlap_percentage": 0.6866132948133681, "num_intersection": 1619924, "num_union": 3098668, "num_only_computed": 739372, "num_only_roped": 739372, "total_diff": 1478744, "diff_percentage": 0.4772192438815646, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:50:18.399298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.420778274536133e-06, "l2_diff": 0.216796875, "l2_diff_relative": 0.02442781690140845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:50:45.229909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4911895167285284, "overlap_percentage": 0.6587888544256036, "num_intersection": 1899673, "num_union": 3867495, "num_only_computed": 983911, "num_only_roped": 983911, "total_diff": 1967822, "diff_percentage": 0.5088104832714716, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:50:46.167848", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.4836273193359375e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.01819349315068493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:51:18.902733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4613923629946804, "overlap_percentage": 0.631442143366887, "num_intersection": 2151874, "num_union": 4663870, "num_only_computed": 1255998, "num_only_roped": 1255998, "total_diff": 2511996, "diff_percentage": 0.5386076370053197, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:51:20.023573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.018875838926174497}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:51:59.199108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4468100920096246, "overlap_percentage": 0.6176485697428385, "num_intersection": 2428693, "num_union": 5435627, "num_only_computed": 1503467, "num_only_roped": 1503467, "total_diff": 3006934, "diff_percentage": 0.5531899079903754, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:52:00.541177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.265625, "l2_diff_relative": 0.03373015873015873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:52:45.986577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43350543212096465, "overlap_percentage": 0.6048186807071462, "num_intersection": 2695343, "num_union": 6217553, "num_only_computed": 1761105, "num_only_roped": 1761105, "total_diff": 3522210, "diff_percentage": 0.5664945678790354, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:52:48.836115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.24609375, "l2_diff_relative": 0.032407407407407406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:53:43.651861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4181216280990312, "overlap_percentage": 0.5896837334883841, "num_intersection": 2937059, "num_union": 7024413, "num_only_computed": 2043677, "num_only_roped": 2043677, "total_diff": 4087354, "diff_percentage": 0.5818783719009688, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:53:46.454063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.6484375, "l2_diff_relative": 0.23549107142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:54:46.380271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4091074015443289, "overlap_percentage": 0.5806617736816406, "num_intersection": 3196557, "num_union": 7813491, "num_only_computed": 2308467, "num_only_roped": 2308467, "total_diff": 4616934, "diff_percentage": 0.5908925984556711, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:54:48.389097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.05718994140625e-05, "l2_diff": 3.1875, "l2_diff_relative": 0.5340314136125655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:55:55.327728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3996307849447077, "overlap_percentage": 0.571051721987517, "num_intersection": 3443049, "num_union": 8615575, "num_only_computed": 2586263, "num_only_roped": 2586263, "total_diff": 5172526, "diff_percentage": 0.6003692150552923, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:55:57.609615", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.96875, "l2_diff_relative": 0.45023696682464454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:57:11.819279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3876763683601488, "overlap_percentage": 0.5587417602539062, "num_intersection": 3661770, "num_union": 9445430, "num_only_computed": 2891830, "num_only_roped": 2891830, "total_diff": 5783660, "diff_percentage": 0.6123236316398513, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:57:14.355056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 5.0067901611328125e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.4261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:36.078070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37726310451652345, "overlap_percentage": 0.5478446395308884, "num_intersection": 3877583, "num_union": 10278193, "num_only_computed": 3200305, "num_only_roped": 3200305, "total_diff": 6400610, "diff_percentage": 0.6227368954834765, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T10:58:38.868498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 4.982948303222656e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.4305555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:08.831343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3680441147122162, "overlap_percentage": 0.5380588399952856, "num_intersection": 4090418, "num_union": 11113934, "num_only_computed": 3511758, "num_only_roped": 3511758, "total_diff": 7023516, "diff_percentage": 0.6319558852877838, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:00:12.512156", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 4.982948303222656e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.4661458333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:51.687188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35432094290419924, "overlap_percentage": 0.5232451654249622, "num_intersection": 4252133, "num_union": 12000795, "num_only_computed": 3874331, "num_only_roped": 3874331, "total_diff": 7748662, "diff_percentage": 0.6456790570958008, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:01:55.015525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.49444444444444446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:38.233226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3414824586851555, "overlap_percentage": 0.5091120744431605, "num_intersection": 2075207, "num_union": 6077053, "num_only_computed": 2000923, "num_only_roped": 2000923, "total_diff": 4001846, "diff_percentage": 0.6585175413148445, "num_computed": 4076130, "num_roped": 4076130}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 498, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:03:41.576869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.458427429199219e-05, "l2_diff": 1.7421875, "l2_diff_relative": 0.38986013986013984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 498, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:05:21.338395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31998575652954747, "overlap_percentage": 0.4848321354176441, "num_intersection": 103341, "num_union": 322955, "num_only_computed": 109807, "num_only_roped": 109807, "total_diff": 219614, "diff_percentage": 0.6800142434704526, "num_computed": 213148, "num_roped": 213148}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:05:24.439189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.8133392333984375e-05, "l2_diff": 0.1376953125, "l2_diff_relative": 0.12411971830985916}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:06:52.286940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32300492213346244, "overlap_percentage": 0.4882898267870212, "num_intersection": 4003, "num_union": 12393, "num_only_computed": 4195, "num_only_roped": 4195, "total_diff": 8390, "diff_percentage": 0.6769950778665376, "num_computed": 8198, "num_roped": 8198}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:06:55.117229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009033203125, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.020263671875, "l2_diff_relative": 0.10272277227722772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:08:12.886308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3146797081696464, "overlap_percentage": 0.4787169166971582, "num_intersection": 3925, "num_union": 12473, "num_only_computed": 4274, "num_only_roped": 4274, "total_diff": 8548, "diff_percentage": 0.6853202918303536, "num_computed": 8199, "num_roped": 8199}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 1, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:08:15.857722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01300048828125, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.02734375, "l2_diff_relative": 0.13023255813953488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 1, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:04.239881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:04.253628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.002877058383233533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:10.231198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7345323904895524, "overlap_percentage": 0.8469514833127317, "num_intersection": 1096294, "num_union": 1492506, "num_only_computed": 214426, "num_only_roped": 181786, "total_diff": 396212, "diff_percentage": 0.2654676095104475, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:10.622454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.2993812561035156e-05, "l2_diff": 0.216796875, "l2_diff_relative": 0.023922413793103448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:25.464526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.601451510921459, "overlap_percentage": 0.7511329650878906, "num_intersection": 1378335, "num_union": 2291681, "num_only_computed": 456673, "num_only_roped": 456673, "total_diff": 913346, "diff_percentage": 0.398548489078541, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:28.025488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.2159347534179688e-05, "l2_diff": 0.2060546875, "l2_diff_relative": 0.024603544776119403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:49.211903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5440499688480045, "overlap_percentage": 0.7047051323784722, "num_intersection": 1662608, "num_union": 3055984, "num_only_computed": 696688, "num_only_roped": 696688, "total_diff": 1393376, "diff_percentage": 0.45595003115199556, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:09:49.954205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.228515625, "l2_diff_relative": 0.02728544776119403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:10:16.445415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5068167952792834, "overlap_percentage": 0.6726986278187145, "num_intersection": 1939783, "num_union": 3827385, "num_only_computed": 943801, "num_only_roped": 943801, "total_diff": 1887602, "diff_percentage": 0.49318320472071664, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:10:17.370249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 7.808208465576172e-06, "l2_diff": 0.19140625, "l2_diff_relative": 0.022032374100719423}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:10:49.903942", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4780490840891018, "overlap_percentage": 0.6468649644118089, "num_intersection": 2204433, "num_union": 4611311, "num_only_computed": 1203439, "num_only_roped": 1203439, "total_diff": 2406878, "diff_percentage": 0.5219509159108983, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:10:52.021048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 8.881092071533203e-06, "l2_diff": 0.263671875, "l2_diff_relative": 0.032204198473282444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:11:30.483939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46526900398367776, "overlap_percentage": 0.6350629170735677, "num_intersection": 2497169, "num_union": 5367151, "num_only_computed": 1434991, "num_only_roped": 1434991, "total_diff": 2869982, "diff_percentage": 0.5347309960163222, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:11:33.643685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 7.361173629760742e-06, "l2_diff": 0.3125, "l2_diff_relative": 0.035211267605633804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:12:18.700049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4486066932488744, "overlap_percentage": 0.6193629994111902, "num_intersection": 2760159, "num_union": 6152737, "num_only_computed": 1696289, "num_only_roped": 1696289, "total_diff": 3392578, "diff_percentage": 0.5513933067511255, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:12:20.233734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.2353515625, "l2_diff_relative": 0.02527265100671141}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:13:12.122228", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.418522886535223, "overlap_percentage": 0.5900826705129523, "num_intersection": 2939046, "num_union": 7022426, "num_only_computed": 2041690, "num_only_roped": 2041690, "total_diff": 4083380, "diff_percentage": 0.581477113464777, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:13:13.894830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.1804245283018868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:14:13.403039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39404541352195366, "overlap_percentage": 0.5653265090215773, "num_intersection": 3112136, "num_union": 7897912, "num_only_computed": 2392888, "num_only_roped": 2392888, "total_diff": 4785776, "diff_percentage": 0.6059545864780463, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:14:17.468649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.6253204345703125e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.3175355450236967}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:15:25.359679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39269959656765474, "overlap_percentage": 0.5639401311459749, "num_intersection": 3400171, "num_union": 8658453, "num_only_computed": 2629141, "num_only_roped": 2629141, "total_diff": 5258282, "diff_percentage": 0.6073004034323453, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:15:29.311316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.510989010989011}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:16:45.278685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3908483005264599, "overlap_percentage": 0.5620286560058594, "num_intersection": 3683311, "num_union": 9423889, "num_only_computed": 2870289, "num_only_roped": 2870289, "total_diff": 5740578, "diff_percentage": 0.6091516994735401, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:16:50.073791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.44472361809045224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:18:14.177051", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37031685642247936, "overlap_percentage": 0.5404835453739872, "num_intersection": 3825482, "num_union": 10330294, "num_only_computed": 3252406, "num_only_roped": 3252406, "total_diff": 6504812, "diff_percentage": 0.6296831435775206, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:18:17.002414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.302734375, "mean_diff": 5.793571472167969e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.5359116022099447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:19:47.814466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3573245577660619, "overlap_percentage": 0.5265130667850889, "num_intersection": 4002645, "num_union": 11201707, "num_only_computed": 3599531, "num_only_roped": 3599531, "total_diff": 7199062, "diff_percentage": 0.6426754422339381, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:19:52.177242", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 4.649162292480469e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.43989071038251365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:21:31.230522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3509348239425644, "overlap_percentage": 0.5195436785298009, "num_intersection": 4222053, "num_union": 12030875, "num_only_computed": 3904411, "num_only_roped": 3904411, "total_diff": 7808822, "diff_percentage": 0.6490651760574355, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:21:34.549386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 4.267692565917969e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.42401960784313725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:23:13.447219", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3348187572242519, "overlap_percentage": 0.5016692422280694, "num_intersection": 360344, "num_union": 1076236, "num_only_computed": 357946, "num_only_roped": 357946, "total_diff": 715892, "diff_percentage": 0.6651812427757481, "num_computed": 718290, "num_roped": 718290}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:23:17.180418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.35}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:24:51.411342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33325975462250745, "overlap_percentage": 0.4999172193821525, "num_intersection": 147957, "num_union": 443969, "num_only_computed": 148006, "num_only_roped": 148006, "total_diff": 296012, "diff_percentage": 0.6667402453774925, "num_computed": 295963, "num_roped": 295963}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:24:54.423295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.234375, "l2_diff_relative": 0.18518518518518517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:26:19.855349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3207858675912168, "overlap_percentage": 0.48575, "num_intersection": 3886, "num_union": 12114, "num_only_computed": 4114, "num_only_roped": 4114, "total_diff": 8228, "diff_percentage": 0.6792141324087833, "num_computed": 8000, "num_roped": 8000}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:26:22.308859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.3184713375796178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:27:37.305308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3257104979700058, "overlap_percentage": 0.491375, "num_intersection": 3931, "num_union": 12069, "num_only_computed": 4069, "num_only_roped": 4069, "total_diff": 8138, "diff_percentage": 0.6742895020299942, "num_computed": 8000, "num_roped": 8000}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:27:41.031946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0196533203125, "mean_diff": 2.777576446533203e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.1384297520661157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:28:57.576235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32884902840059793, "overlap_percentage": 0.4949381327334083, "num_intersection": 3960, "num_union": 12042, "num_only_computed": 4041, "num_only_roped": 4041, "total_diff": 8082, "diff_percentage": 0.6711509715994021, "num_computed": 8001, "num_roped": 8001}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:29:00.005756", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.10320723684210527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:30:16.374865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3493549203136858, "overlap_percentage": 0.5178102737157855, "num_intersection": 4143, "num_union": 11859, "num_only_computed": 3858, "num_only_roped": 3858, "total_diff": 7716, "diff_percentage": 0.6506450796863142, "num_computed": 8001, "num_roped": 8001}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15491, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15491, 128], "mask_shape": [1, 32, 1, 15491], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:30:18.829471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0155029296875, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.17346938775510204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15491, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15491, 128], "attention_shape": [1, 32, 1, 15491]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:00.709210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:00.720819", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.029052734375, "l2_diff_relative": 0.0030784354304635763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:06.632212", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7427609917204042, "overlap_percentage": 0.8523957045735476, "num_intersection": 1103341, "num_union": 1485459, "num_only_computed": 207379, "num_only_roped": 174739, "total_diff": 382118, "diff_percentage": 0.2572390082795957, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:07.019558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.1980533599853516e-05, "l2_diff": 0.1982421875, "l2_diff_relative": 0.02143158783783784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:21.813202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6030596903443811, "overlap_percentage": 0.7523858206612724, "num_intersection": 1380634, "num_union": 2289382, "num_only_computed": 454374, "num_only_roped": 454374, "total_diff": 908748, "diff_percentage": 0.39694030965561883, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:24.871519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.043081283569336e-05, "l2_diff": 0.1875, "l2_diff_relative": 0.022222222222222223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:45.215593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5322302746043426, "overlap_percentage": 0.6947131686740451, "num_intersection": 1639034, "num_union": 3079558, "num_only_computed": 720262, "num_only_roped": 720262, "total_diff": 1440524, "diff_percentage": 0.4677697253956574, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:31:45.950737", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.987022399902344e-06, "l2_diff": 0.21875, "l2_diff_relative": 0.023178807947019868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:32:12.331012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4947711747465417, "overlap_percentage": 0.6620025634765625, "num_intersection": 1908940, "num_union": 3858228, "num_only_computed": 974644, "num_only_roped": 974644, "total_diff": 1949288, "diff_percentage": 0.5052288252534584, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:32:13.255144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.569789886474609e-06, "l2_diff": 0.1884765625, "l2_diff_relative": 0.02250466417910448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:32:45.699689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.477280539955914, "overlap_percentage": 0.6461610060471755, "num_intersection": 2202034, "num_union": 4613710, "num_only_computed": 1205838, "num_only_roped": 1205838, "total_diff": 2411676, "diff_percentage": 0.522719460044086, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:32:49.298980", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 6.854534149169922e-06, "l2_diff": 0.2099609375, "l2_diff_relative": 0.024168165467625898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:33:27.709758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.462131516576223, "overlap_percentage": 0.6321339925130208, "num_intersection": 2485652, "num_union": 5378668, "num_only_computed": 1446508, "num_only_roped": 1446508, "total_diff": 2893016, "diff_percentage": 0.537868483423777, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:33:31.105964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.470348358154297e-06, "l2_diff": 0.216796875, "l2_diff_relative": 0.023596938775510203}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:34:15.834935", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44409794834595956, "overlap_percentage": 0.615052391501034, "num_intersection": 2740949, "num_union": 6171947, "num_only_computed": 1715499, "num_only_roped": 1715499, "total_diff": 3430998, "diff_percentage": 0.5559020516540405, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:34:17.370340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.9604644775390625e-06, "l2_diff": 0.248046875, "l2_diff_relative": 0.029840225563909775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:35:09.135876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42377463777364843, "overlap_percentage": 0.5952833075272409, "num_intersection": 2964949, "num_union": 6996523, "num_only_computed": 2015787, "num_only_roped": 2015787, "total_diff": 4031574, "diff_percentage": 0.5762253622263516, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:35:10.946099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.13858695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:36:10.835685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4071035800086343, "overlap_percentage": 0.5786405290876117, "num_intersection": 3185430, "num_union": 7824618, "num_only_computed": 2319594, "num_only_roped": 2319594, "total_diff": 4639188, "diff_percentage": 0.5928964199913657, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:36:12.868119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 5.53131103515625e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.4178743961352657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:37:14.318171", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3830030358456056, "overlap_percentage": 0.5538715764444105, "num_intersection": 101559, "num_union": 265165, "num_only_computed": 81803, "num_only_roped": 81803, "total_diff": 163606, "diff_percentage": 0.6169969641543944, "num_computed": 183362, "num_roped": 183362}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "mask_shape": [1, 32, 34, 10274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:37:16.172275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 2.753734588623047e-05, "l2_diff": 0.2021484375, "l2_diff_relative": 0.13068181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "attention_shape": [1, 32, 34, 10274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:12.714808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3800587259032299, "overlap_percentage": 0.5507863089731729, "num_intersection": 74425, "num_union": 195825, "num_only_computed": 60700, "num_only_roped": 60700, "total_diff": 121400, "diff_percentage": 0.61994127409677, "num_computed": 135125, "num_roped": 135125}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 25, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:38:14.523081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.045166015625, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.203125, "l2_diff_relative": 0.1925925925925926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 25, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:07.603867", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3804902962206333, "overlap_percentage": 0.5512393636699963, "num_intersection": 2980, "num_union": 7832, "num_only_computed": 2426, "num_only_roped": 2426, "total_diff": 4852, "diff_percentage": 0.6195097037793666, "num_computed": 5406, "num_roped": 5406}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "mask_shape": [1, 32, 1, 10300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:09.147791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.2802013422818792}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "attention_shape": [1, 32, 1, 10300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:39:56.979508", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37714940771876193, "overlap_percentage": 0.5477247502774695, "num_intersection": 2961, "num_union": 7851, "num_only_computed": 2445, "num_only_roped": 2445, "total_diff": 4890, "diff_percentage": 0.6228505922812381, "num_computed": 5406, "num_roped": 5406}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "mask_shape": [1, 32, 1, 10301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:00.230831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.24166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "attention_shape": [1, 32, 1, 10301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:48.169043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3772287315333673, "overlap_percentage": 0.5478083965230257, "num_intersection": 2962, "num_union": 7852, "num_only_computed": 2445, "num_only_roped": 2445, "total_diff": 4890, "diff_percentage": 0.6227712684666327, "num_computed": 5407, "num_roped": 5407}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "mask_shape": [1, 32, 1, 10302], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:40:49.721767", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.17721518987341772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "attention_shape": [1, 32, 1, 10302]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:18.901641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:18.914312", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.032470703125, "l2_diff_relative": 0.00326749213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:24.825323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.731979399293239, "overlap_percentage": 0.8452518541409147, "num_intersection": 1094094, "num_union": 1494706, "num_only_computed": 216626, "num_only_roped": 183986, "total_diff": 400612, "diff_percentage": 0.26802060070676104, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:25.214816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.3172626495361328e-05, "l2_diff": 0.2021484375, "l2_diff_relative": 0.02536764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:40.050925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5877335786017709, "overlap_percentage": 0.7403428213936942, "num_intersection": 1358535, "num_union": 2311481, "num_only_computed": 476473, "num_only_roped": 476473, "total_diff": 952946, "diff_percentage": 0.4122664213982291, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:41:40.613085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.138448715209961e-05, "l2_diff": 0.205078125, "l2_diff_relative": 0.024305555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:01.423798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5171531257857308, "overlap_percentage": 0.6817415025499132, "num_intersection": 1608430, "num_union": 3110162, "num_only_computed": 750866, "num_only_roped": 750866, "total_diff": 1501732, "diff_percentage": 0.48284687421426925, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:04.718698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.1086463928222656e-05, "l2_diff": 0.2392578125, "l2_diff_relative": 0.026220034246575343}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:31.891553", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4718903171222537, "overlap_percentage": 0.6412031000310724, "num_intersection": 1848963, "num_union": 3918205, "num_only_computed": 1034621, "num_only_roped": 1034621, "total_diff": 2069242, "diff_percentage": 0.5281096828777463, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:42:33.239533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 9.417533874511719e-06, "l2_diff": 0.22265625, "l2_diff_relative": 0.026003649635036496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:06.123333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45781960515902725, "overlap_percentage": 0.6280881441556491, "num_intersection": 2140444, "num_union": 4675300, "num_only_computed": 1267428, "num_only_roped": 1267428, "total_diff": 2534856, "diff_percentage": 0.5421803948409728, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:07.241082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.867813110351562e-06, "l2_diff": 0.2451171875, "l2_diff_relative": 0.02821492805755396}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:46.308729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4496121744772466, "overlap_percentage": 0.6203206380208334, "num_intersection": 2439200, "num_union": 5425120, "num_only_computed": 1492960, "num_only_roped": 1492960, "total_diff": 2985920, "diff_percentage": 0.5503878255227534, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:43:47.632320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 6.884336471557617e-06, "l2_diff": 0.283203125, "l2_diff_relative": 0.035400390625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:44:32.508686", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.430820552171861, "overlap_percentage": 0.6022006764131433, "num_intersection": 2683676, "num_union": 6229220, "num_only_computed": 1772772, "num_only_roped": 1772772, "total_diff": 3545544, "diff_percentage": 0.569179447828139, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:44:36.623562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 6.735324859619141e-06, "l2_diff": 0.283203125, "l2_diff_relative": 0.036690283400809716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:45:29.171325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4158075718593828, "overlap_percentage": 0.5873786524722451, "num_intersection": 2925578, "num_union": 7035894, "num_only_computed": 2055158, "num_only_roped": 2055158, "total_diff": 4110316, "diff_percentage": 0.5841924281406172, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:45:31.987308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.1872093023255814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:46:31.839346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4007981588426939, "overlap_percentage": 0.5722425551641555, "num_intersection": 3150209, "num_union": 7859839, "num_only_computed": 2354815, "num_only_roped": 2354815, "total_diff": 4709630, "diff_percentage": 0.5992018411573061, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:46:33.907479", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.4659090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:47:41.597867", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38862503410062277, "overlap_percentage": 0.559726383375085, "num_intersection": 3374765, "num_union": 8683859, "num_only_computed": 2654547, "num_only_roped": 2654547, "total_diff": 5309094, "diff_percentage": 0.6113749658993772, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:47:43.916017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 5.745887756347656e-05, "l2_diff": 2.984375, "l2_diff_relative": 0.4872448979591837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:49:00.139761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3664867335418635, "overlap_percentage": 0.5363926696777344, "num_intersection": 3515303, "num_union": 9591897, "num_only_computed": 3038297, "num_only_roped": 3038297, "total_diff": 6076594, "diff_percentage": 0.6335132664581364, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:49:03.569070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.45789473684210524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:50:26.616898", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3685520971149835, "overlap_percentage": 0.538601486771195, "num_intersection": 3812161, "num_union": 10343615, "num_only_computed": 3265727, "num_only_roped": 3265727, "total_diff": 6531454, "diff_percentage": 0.6314479028850165, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:50:29.486766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.458427429199219e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.3888888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:52:00.291903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36012976217781756, "overlap_percentage": 0.5295520650929418, "num_intersection": 4025748, "num_union": 11178604, "num_only_computed": 3576428, "num_only_roped": 3576428, "total_diff": 7152856, "diff_percentage": 0.6398702378221824, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:52:03.986590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.84375, "l2_diff_relative": 0.27314814814814814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:53:43.241984", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3508601558902684, "overlap_percentage": 0.5194618471207157, "num_intersection": 4221388, "num_union": 12031540, "num_only_computed": 3905076, "num_only_roped": 3905076, "total_diff": 7810152, "diff_percentage": 0.6491398441097316, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:53:46.595411", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 3.838539123535156e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.37637362637362637}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:55:35.196061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.339163076972827, "overlap_percentage": 0.5065299108149006, "num_intersection": 3524038, "num_union": 10390394, "num_only_computed": 3433178, "num_only_roped": 3433178, "total_diff": 6866356, "diff_percentage": 0.660836923027173, "num_computed": 6957216, "num_roped": 6957216}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "mask_shape": [1, 32, 833, 16193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:55:38.817745", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 3.814697265625e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.36335403726708076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "attention_shape": [1, 32, 833, 16193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:57:23.811317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3292416210806145, "overlap_percentage": 0.4953826540775268, "num_intersection": 124346, "num_union": 377674, "num_only_computed": 126664, "num_only_roped": 126664, "total_diff": 253328, "diff_percentage": 0.6707583789193855, "num_computed": 251010, "num_roped": 251010}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "mask_shape": [1, 32, 30, 16223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:57:27.060754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.1630859375, "l2_diff_relative": 0.145979020979021}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "attention_shape": [1, 32, 30, 16223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:58:57.531730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32930897537728354, "overlap_percentage": 0.4954588910133843, "num_intersection": 4146, "num_union": 12590, "num_only_computed": 4222, "num_only_roped": 4222, "total_diff": 8444, "diff_percentage": 0.6706910246227165, "num_computed": 8368, "num_roped": 8368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "mask_shape": [1, 32, 1, 16224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T11:59:00.206201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0181884765625, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.12046370967741936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "attention_shape": [1, 32, 1, 16224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:00:20.173712", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32049865867129557, "overlap_percentage": 0.4854206500956023, "num_intersection": 4062, "num_union": 12674, "num_only_computed": 4306, "num_only_roped": 4306, "total_diff": 8612, "diff_percentage": 0.6795013413287044, "num_computed": 8368, "num_roped": 8368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "mask_shape": [1, 32, 1, 16225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:00:23.029753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.006591796875, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.0166015625, "l2_diff_relative": 0.07906976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "attention_shape": [1, 32, 1, 16225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:07.931949", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:07.945600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.00312234268707483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:13.924231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7334243970377513, "overlap_percentage": 0.8462144622991348, "num_intersection": 1095340, "num_union": 1493460, "num_only_computed": 215380, "num_only_roped": 182740, "total_diff": 398120, "diff_percentage": 0.26657560296224875, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:16.134685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 8.106231689453125e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.016964285714285713}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:30.896670", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5790461914174265, "overlap_percentage": 0.733412606375558, "num_intersection": 1345818, "num_union": 2324198, "num_only_computed": 489190, "num_only_roped": 489190, "total_diff": 978380, "diff_percentage": 0.4209538085825734, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:31.442594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.119510650634766e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.021375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:52.319073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5085316616031589, "overlap_percentage": 0.6742074754503038, "num_intersection": 1590655, "num_union": 3127937, "num_only_computed": 768641, "num_only_roped": 768641, "total_diff": 1537282, "diff_percentage": 0.4914683383968411, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:01:53.053531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.152557373046875e-06, "l2_diff": 0.244140625, "l2_diff_relative": 0.025699013157894735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:02:19.491502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47698712623095746, "overlap_percentage": 0.6458920565518466, "num_intersection": 1862484, "num_union": 3904684, "num_only_computed": 1021100, "num_only_roped": 1021100, "total_diff": 2042200, "diff_percentage": 0.5230128737690425, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:02:20.415239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 6.884336471557617e-06, "l2_diff": 0.19921875, "l2_diff_relative": 0.02125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:02:52.852968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4505681605355726, "overlap_percentage": 0.6212299053485577, "num_intersection": 2117072, "num_union": 4698672, "num_only_computed": 1290800, "num_only_roped": 1290800, "total_diff": 2581600, "diff_percentage": 0.5494318394644274, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:02:53.970185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 7.18235969543457e-06, "l2_diff": 0.2236328125, "l2_diff_relative": 0.025021853146853148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:03:32.448077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4422355355016846, "overlap_percentage": 0.6132639567057292, "num_intersection": 2411452, "num_union": 5452868, "num_only_computed": 1520708, "num_only_roped": 1520708, "total_diff": 3041416, "diff_percentage": 0.5577644644983154, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:03:35.914668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 6.4373016357421875e-06, "l2_diff": 0.294921875, "l2_diff_relative": 0.0332306338028169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:04:21.027179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42842677780949245, "overlap_percentage": 0.5998582278980928, "num_intersection": 2673237, "num_union": 6239659, "num_only_computed": 1783211, "num_only_roped": 1783211, "total_diff": 3566422, "diff_percentage": 0.5715732221905075, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:04:22.558313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.2255859375, "l2_diff_relative": 0.025240384615384616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:05:14.513267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43792821121603037, "overlap_percentage": 0.6091099789268092, "num_intersection": 3033816, "num_union": 6927656, "num_only_computed": 1946920, "num_only_roped": 1946920, "total_diff": 3893840, "diff_percentage": 0.5620717887839697, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:05:16.277810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 2.7179718017578125e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.16033755274261605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:06:16.260020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4153619190629908, "overlap_percentage": 0.5869338625953311, "num_intersection": 3231085, "num_union": 7778963, "num_only_computed": 2273939, "num_only_roped": 2273939, "total_diff": 4547878, "diff_percentage": 0.5846380809370092, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:06:18.281726", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 5.030632019042969e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.3456521739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:07:26.985569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38621348790189547, "overlap_percentage": 0.5572207906971807, "num_intersection": 3359658, "num_union": 8698966, "num_only_computed": 2669654, "num_only_roped": 2669654, "total_diff": 5339308, "diff_percentage": 0.6137865120981045, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:07:30.769454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.46875, "l2_diff_relative": 0.3853658536585366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:08:47.501879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3670448098873104, "overlap_percentage": 0.5369901662807484, "num_intersection": 3264135, "num_union": 8893015, "num_only_computed": 2814440, "num_only_roped": 2814440, "total_diff": 5628880, "diff_percentage": 0.6329551901126895, "num_computed": 6078575, "num_roped": 6078575}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "mask_shape": [1, 32, 955, 12219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:08:50.055872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.625, "l2_diff_relative": 0.46153846153846156}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "attention_shape": [1, 32, 955, 12219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:10:05.008309", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33856432508590295, "overlap_percentage": 0.5058618681835487, "num_intersection": 90353, "num_union": 266871, "num_only_computed": 88259, "num_only_roped": 88259, "total_diff": 176518, "diff_percentage": 0.661435674914097, "num_computed": 178612, "num_roped": 178612}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "mask_shape": [1, 32, 28, 12247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:10:07.323701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.361701965332031e-05, "l2_diff": 0.1513671875, "l2_diff_relative": 0.12831125827814568}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "attention_shape": [1, 32, 28, 12247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:11:11.516635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3451402066202825, "overlap_percentage": 0.513166144200627, "num_intersection": 3274, "num_union": 9486, "num_only_computed": 3106, "num_only_roped": 3106, "total_diff": 6212, "diff_percentage": 0.6548597933797174, "num_computed": 6380, "num_roped": 6380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "mask_shape": [1, 32, 1, 12248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:11:14.323733", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.2358490566037736}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "attention_shape": [1, 32, 1, 12248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:12:13.036792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32958216109200794, "overlap_percentage": 0.4957680250783699, "num_intersection": 3163, "num_union": 9597, "num_only_computed": 3217, "num_only_roped": 3217, "total_diff": 6434, "diff_percentage": 0.6704178389079921, "num_computed": 6380, "num_roped": 6380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "mask_shape": [1, 32, 1, 12249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:12:14.978851", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0157470703125, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.2046875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "attention_shape": [1, 32, 1, 12249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:13.795671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35982951518380396, "overlap_percentage": 0.5292273938254192, "num_intersection": 3377, "num_union": 9385, "num_only_computed": 3004, "num_only_roped": 3004, "total_diff": 6008, "diff_percentage": 0.6401704848161961, "num_computed": 6381, "num_roped": 6381}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "mask_shape": [1, 32, 1, 12250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:16.060711", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00732421875, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0172119140625, "l2_diff_relative": 0.0762987012987013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "attention_shape": [1, 32, 1, 12250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:49.490117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:49.498465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.0030423677884615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:55.478125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7356906758922166, "overlap_percentage": 0.8477209517923362, "num_intersection": 1097290, "num_union": 1491510, "num_only_computed": 213430, "num_only_roped": 180790, "total_diff": 394220, "diff_percentage": 0.2643093241077834, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:13:55.867585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 9.894371032714844e-06, "l2_diff": 0.1708984375, "l2_diff_relative": 0.019958941605839418}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:14:10.717622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5966018196830999, "overlap_percentage": 0.7473395211356026, "num_intersection": 1371374, "num_union": 2298642, "num_only_computed": 463634, "num_only_roped": 463634, "total_diff": 927268, "diff_percentage": 0.40339818031690017, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:14:13.613201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 7.271766662597656e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.01661392405063291}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:14:34.169833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5266211196642502, "overlap_percentage": 0.689917246500651, "num_intersection": 1627719, "num_union": 3090873, "num_only_computed": 731577, "num_only_roped": 731577, "total_diff": 1463154, "diff_percentage": 0.4733788803357498, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:14:34.910833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.1265277862548828e-05, "l2_diff": 0.255859375, "l2_diff_relative": 0.029664855072463768}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:15:01.431850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4838666684162764, "overlap_percentage": 0.6521700078790839, "num_intersection": 1880587, "num_union": 3886581, "num_only_computed": 1002997, "num_only_roped": 1002997, "total_diff": 2005994, "diff_percentage": 0.5161333315837235, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:15:02.359061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.68899917602539e-06, "l2_diff": 0.1962890625, "l2_diff_relative": 0.02326388888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:15:35.012825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46660739192724526, "overlap_percentage": 0.6363085233248197, "num_intersection": 2168458, "num_union": 4647286, "num_only_computed": 1239414, "num_only_roped": 1239414, "total_diff": 2478828, "diff_percentage": 0.5333926080727547, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:15:37.752016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 7.420778274536133e-06, "l2_diff": 0.2421875, "l2_diff_relative": 0.02787769784172662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:16:11.547828", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46388231963987325, "overlap_percentage": 0.6337699600798403, "num_intersection": 50803, "num_union": 109517, "num_only_computed": 29357, "num_only_roped": 29357, "total_diff": 58714, "diff_percentage": 0.5361176803601267, "num_computed": 80160, "num_roped": 80160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "mask_shape": [1, 32, 24, 6168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:16:12.541522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 2.6226043701171875e-06, "l2_diff": 0.01953125, "l2_diff_relative": 0.013513513513513514}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "attention_shape": [1, 32, 24, 6168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:16:43.934716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44121912478994496, "overlap_percentage": 0.6122859698441094, "num_intersection": 57501, "num_union": 130323, "num_only_computed": 36411, "num_only_roped": 36411, "total_diff": 72822, "diff_percentage": 0.558780875210055, "num_computed": 93912, "num_roped": 93912}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "mask_shape": [1, 32, 28, 6196], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:16:46.905353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0098876953125, "mean_diff": 1.0907649993896484e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.029545454545454545}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "attention_shape": [1, 32, 28, 6196]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:17:16.644526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45541332176177046, "overlap_percentage": 0.625819916517591, "num_intersection": 2099, "num_union": 4609, "num_only_computed": 1255, "num_only_roped": 1255, "total_diff": 2510, "diff_percentage": 0.5445866782382296, "num_computed": 3354, "num_roped": 3354}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "mask_shape": [1, 32, 1, 6197], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:17:17.531714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00153350830078125, "mean_diff": 7.241964340209961e-06, "l2_diff": 0.003814697265625, "l2_diff_relative": 0.021462912087912088}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "attention_shape": [1, 32, 1, 6197]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:17:44.983177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47732276530162926, "overlap_percentage": 0.6461997019374068, "num_intersection": 2168, "num_union": 4542, "num_only_computed": 1187, "num_only_roped": 1187, "total_diff": 2374, "diff_percentage": 0.5226772346983708, "num_computed": 3355, "num_roped": 3355}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "mask_shape": [1, 32, 1, 6198], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:17:45.870191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.5020370483398438e-05, "l2_diff": 0.00830078125, "l2_diff_relative": 0.04450261780104712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "attention_shape": [1, 32, 1, 6198]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:13.587806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4417705199828105, "overlap_percentage": 0.6128166915052161, "num_intersection": 2056, "num_union": 4654, "num_only_computed": 1299, "num_only_roped": 1299, "total_diff": 2598, "diff_percentage": 0.5582294800171895, "num_computed": 3355, "num_roped": 3355}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "mask_shape": [1, 32, 1, 6199], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:14.479276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 5.5730342864990234e-06, "l2_diff": 0.00445556640625, "l2_diff_relative": 0.017892156862745097}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "attention_shape": [1, 32, 1, 6199]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:33.285494", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:33.299130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031494140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:39.193042", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7362960180819456, "overlap_percentage": 0.8481226823238566, "num_intersection": 1097810, "num_union": 1490990, "num_only_computed": 212910, "num_only_roped": 180270, "total_diff": 393180, "diff_percentage": 0.26370398191805444, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:39.579725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 8.404254913330078e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.01778694968553459}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:54.313197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5955259387042473, "overlap_percentage": 0.7464948381696429, "num_intersection": 1369824, "num_union": 2300192, "num_only_computed": 465184, "num_only_roped": 465184, "total_diff": 930368, "diff_percentage": 0.4044740612957527, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:18:54.863441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.1943359375, "l2_diff_relative": 0.022369604316546762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:15.513104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5297227587575204, "overlap_percentage": 0.6925735473632812, "num_intersection": 1633986, "num_union": 3084606, "num_only_computed": 725310, "num_only_roped": 725310, "total_diff": 1450620, "diff_percentage": 0.4702772412424796, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:18.712059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.0609626770019531e-05, "l2_diff": 0.2265625, "l2_diff_relative": 0.025709219858156027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:46.069158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4970931228655298, "overlap_percentage": 0.6640777587890625, "num_intersection": 1914924, "num_union": 3852244, "num_only_computed": 968660, "num_only_roped": 968660, "total_diff": 1937320, "diff_percentage": 0.5029068771344702, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:19:47.231170", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.106231689453125e-06, "l2_diff": 0.1953125, "l2_diff_relative": 0.02281021897810219}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:19.648154", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47653870383801833, "overlap_percentage": 0.6454808161808894, "num_intersection": 2199716, "num_union": 4616028, "num_only_computed": 1208156, "num_only_roped": 1208156, "total_diff": 2416312, "diff_percentage": 0.5234612961619817, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:20.761610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 8.046627044677734e-06, "l2_diff": 0.2275390625, "l2_diff_relative": 0.029241967871485943}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:20:59.088829", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46179234025215266, "overlap_percentage": 0.6318166097005208, "num_intersection": 2484404, "num_union": 5379916, "num_only_computed": 1447756, "num_only_roped": 1447756, "total_diff": 2895512, "diff_percentage": 0.5382076597478473, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:00.401266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.67572021484375e-06, "l2_diff": 0.28125, "l2_diff_relative": 0.03333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:46.476744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43976252767936586, "overlap_percentage": 0.6108820298138786, "num_intersection": 2722364, "num_union": 6190532, "num_only_computed": 1734084, "num_only_roped": 1734084, "total_diff": 3468168, "diff_percentage": 0.5602374723206341, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:21:48.046406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.27734375, "l2_diff_relative": 0.03125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:42.771473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41390050563603065, "overlap_percentage": 0.5854733115748355, "num_intersection": 2916088, "num_union": 7045384, "num_only_computed": 2064648, "num_only_roped": 2064648, "total_diff": 4129296, "diff_percentage": 0.5860994943639694, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:22:44.547008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.19715447154471544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:23:45.465909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38676385643114286, "overlap_percentage": 0.5577933901832217, "num_intersection": 3070666, "num_union": 7939382, "num_only_computed": 2434358, "num_only_roped": 2434358, "total_diff": 4868716, "diff_percentage": 0.6132361435688571, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:23:47.511671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.43147208121827413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:24:54.105348", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37112849360709455, "overlap_percentage": 0.5413475036621094, "num_intersection": 3263953, "num_union": 8794671, "num_only_computed": 2765359, "num_only_roped": 2765359, "total_diff": 5530718, "diff_percentage": 0.6288715063929055, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:24:56.396374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.5026881720430108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:26:10.973580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36149957743985894, "overlap_percentage": 0.531031494140625, "num_intersection": 3480168, "num_union": 9627032, "num_only_computed": 3073432, "num_only_roped": 3073432, "total_diff": 6146864, "diff_percentage": 0.6385004225601411, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:26:15.335461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.054473876953125e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.4270833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:27:38.508315", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35667809868465505, "overlap_percentage": 0.5258109481246384, "num_intersection": 3721631, "num_union": 10434145, "num_only_computed": 3356257, "num_only_roped": 3356257, "total_diff": 6712514, "diff_percentage": 0.643321901315345, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:27:41.315812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.935264587402344e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.4358288770053476}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:29:11.822410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35974575024452765, "overlap_percentage": 0.5291367892561287, "num_intersection": 4022591, "num_union": 11181761, "num_only_computed": 3579585, "num_only_roped": 3579585, "total_diff": 7159170, "diff_percentage": 0.6402542497554723, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:29:16.631362", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 4.1961669921875e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.3930232558139535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:30:55.462876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35640469460145535, "overlap_percentage": 0.5255138028052545, "num_intersection": 4270569, "num_union": 11982359, "num_only_computed": 3855895, "num_only_roped": 3855895, "total_diff": 7711790, "diff_percentage": 0.6435953053985446, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:30:58.771403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5124223602484472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:32:45.896387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36214280068884647, "overlap_percentage": 0.5317251620104851, "num_intersection": 4041342, "num_union": 11159526, "num_only_computed": 3559092, "num_only_roped": 3559092, "total_diff": 7118184, "diff_percentage": 0.6378571993111536, "num_computed": 7600434, "num_roped": 7600434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 906, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:32:49.428415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 4.935264587402344e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.5737179487179487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 906, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:34:34.244318", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33730820712919574, "overlap_percentage": 0.5044584417129937, "num_intersection": 118691, "num_union": 351877, "num_only_computed": 116593, "num_only_roped": 116593, "total_diff": 233186, "diff_percentage": 0.6626917928708043, "num_computed": 235284, "num_roped": 235284}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 28, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:34:37.464904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.22265625, "l2_diff_relative": 0.19791666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 28, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:36:07.429778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33923021754721494, "overlap_percentage": 0.5066047840057123, "num_intersection": 4257, "num_union": 12549, "num_only_computed": 4146, "num_only_roped": 4146, "total_diff": 8292, "diff_percentage": 0.6607697824527851, "num_computed": 8403, "num_roped": 8403}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:36:10.655034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.020263671875, "l2_diff_relative": 0.09787735849056604}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:37:31.583763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3356643356643357, "overlap_percentage": 0.5026178010471204, "num_intersection": 4224, "num_union": 12584, "num_only_computed": 4180, "num_only_roped": 4180, "total_diff": 8360, "diff_percentage": 0.6643356643356644, "num_computed": 8404, "num_roped": 8404}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:37:34.785370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.026611328125, "l2_diff_relative": 0.11260330578512397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:20.942581", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:20.957381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003058667452830189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:26.905631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7314673865062188, "overlap_percentage": 0.8449103831891224, "num_intersection": 1093652, "num_union": 1495148, "num_only_computed": 217068, "num_only_roped": 184428, "total_diff": 401496, "diff_percentage": 0.2685326134937812, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:27.290693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.4126300811767578e-05, "l2_diff": 0.2314453125, "l2_diff_relative": 0.02589597902097902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:42.026360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5984369358402406, "overlap_percentage": 0.7487776620047433, "num_intersection": 1374013, "num_union": 2296003, "num_only_computed": 460995, "num_only_roped": 460995, "total_diff": 921990, "diff_percentage": 0.4015630641597594, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:38:44.856793", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.3046875, "l2_diff_relative": 0.035326086956521736}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:39:05.228247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5243854925654341, "overlap_percentage": 0.6879959106445312, "num_intersection": 1623186, "num_union": 3095406, "num_only_computed": 736110, "num_only_roped": 736110, "total_diff": 1472220, "diff_percentage": 0.47561450743456596, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:39:05.962269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.4960765838623047e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.03409090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:39:32.292746", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4866103281737832, "overlap_percentage": 0.6546575372869318, "num_intersection": 1887760, "num_union": 3879408, "num_only_computed": 995824, "num_only_roped": 995824, "total_diff": 1991648, "diff_percentage": 0.5133896718262168, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:39:33.213998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.0669231414794922e-05, "l2_diff": 0.248046875, "l2_diff_relative": 0.03307291666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:40:05.583300", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4530390250287698, "overlap_percentage": 0.623574476975661, "num_intersection": 2125062, "num_union": 4690682, "num_only_computed": 1282810, "num_only_roped": 1282810, "total_diff": 2565620, "diff_percentage": 0.5469609749712302, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:40:09.001839", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.232421875, "l2_diff_relative": 0.02882751937984496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:40:47.413431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44644446451269737, "overlap_percentage": 0.6172991434733073, "num_intersection": 2427319, "num_union": 5437001, "num_only_computed": 1504841, "num_only_roped": 1504841, "total_diff": 3009682, "diff_percentage": 0.5535555354873026, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:40:50.834343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 8.046627044677734e-06, "l2_diff": 0.3203125, "l2_diff_relative": 0.03853383458646616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:41:35.632621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4394418782828112, "overlap_percentage": 0.6105725905474495, "num_intersection": 2720985, "num_union": 6191911, "num_only_computed": 1735463, "num_only_roped": 1735463, "total_diff": 3470926, "diff_percentage": 0.5605581217171888, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:41:37.167145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.271484375, "l2_diff_relative": 0.031939338235294115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:42:30.218518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42820959520398943, "overlap_percentage": 0.599645313463713, "num_intersection": 2986675, "num_union": 6974797, "num_only_computed": 1994061, "num_only_roped": 1994061, "total_diff": 3988122, "diff_percentage": 0.5717904047960105, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:42:32.001575", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08837890625, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.6328125, "l2_diff_relative": 0.22234042553191488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:43:31.561522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4095605685279656, "overlap_percentage": 0.5811180841355097, "num_intersection": 3199069, "num_union": 7810979, "num_only_computed": 2305955, "num_only_roped": 2305955, "total_diff": 4611910, "diff_percentage": 0.5904394314720345, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:43:35.904204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.45287958115183247}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:44:42.977948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39853151351946287, "overlap_percentage": 0.5699285424273947, "num_intersection": 3436277, "num_union": 8622347, "num_only_computed": 2593035, "num_only_roped": 2593035, "total_diff": 5186070, "diff_percentage": 0.6014684864805372, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:44:45.855652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.875, "l2_diff_relative": 0.44878048780487806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:46:00.777980", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37967984800279997, "overlap_percentage": 0.5503883361816406, "num_intersection": 3607025, "num_union": 9500175, "num_only_computed": 2946575, "num_only_roped": 2946575, "total_diff": 5893150, "diff_percentage": 0.6203201519972, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:46:03.342251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.359375, "l2_diff_relative": 0.5598958333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:47:26.864677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.359339025823625, "overlap_percentage": 0.5286966959635416, "num_intersection": 3742056, "num_union": 10413720, "num_only_computed": 3335832, "num_only_roped": 3335832, "total_diff": 6671664, "diff_percentage": 0.640660974176375, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:47:32.231226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 5.4836273193359375e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.46195652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:49:00.266568", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33776930322696014, "overlap_percentage": 0.5049739180173963, "num_intersection": 2436585, "num_union": 7213755, "num_only_computed": 2388585, "num_only_roped": 2388585, "total_diff": 4777170, "diff_percentage": 0.6622306967730398, "num_computed": 4825170, "num_roped": 4825170}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "mask_shape": [1, 32, 666, 13978], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:49:03.174455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.6484375, "l2_diff_relative": 0.3031609195402299}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "attention_shape": [1, 32, 666, 13978]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:50:29.203231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3232920645168008, "overlap_percentage": 0.48861785419207615, "num_intersection": 124192, "num_union": 384148, "num_only_computed": 129978, "num_only_roped": 129978, "total_diff": 259956, "diff_percentage": 0.6767079354831992, "num_computed": 254170, "num_roped": 254170}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "mask_shape": [1, 32, 35, 14013], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:50:32.142573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.166015625, "l2_diff_relative": 0.12648809523809523}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "attention_shape": [1, 32, 35, 14013]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:51:48.540137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33278282411230387, "overlap_percentage": 0.4993804213135068, "num_intersection": 3627, "num_union": 10899, "num_only_computed": 3636, "num_only_roped": 3636, "total_diff": 7272, "diff_percentage": 0.6672171758876961, "num_computed": 7263, "num_roped": 7263}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "mask_shape": [1, 32, 1, 14014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:51:50.752768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.030517578125, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.24206349206349206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "attention_shape": [1, 32, 1, 14014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:52:59.415917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3445020362828582, "overlap_percentage": 0.5124604158061408, "num_intersection": 3722, "num_union": 10804, "num_only_computed": 3541, "num_only_roped": 3541, "total_diff": 7082, "diff_percentage": 0.6554979637171418, "num_computed": 7263, "num_roped": 7263}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "mask_shape": [1, 32, 1, 14015], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:53:01.610189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.22193877551020408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "attention_shape": [1, 32, 1, 14015]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:54:09.615381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34705609643022717, "overlap_percentage": 0.5152808370044053, "num_intersection": 3743, "num_union": 10785, "num_only_computed": 3521, "num_only_roped": 3521, "total_diff": 7042, "diff_percentage": 0.6529439035697728, "num_computed": 7264, "num_roped": 7264}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14016, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14016, 128], "mask_shape": [1, 32, 1, 14016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:54:12.656085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.039794921875, "l2_diff_relative": 0.2156084656084656}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14016, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14016, 128], "attention_shape": [1, 32, 1, 14016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:55:21.538117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3201272149023171, "overlap_percentage": 0.48499449339207046, "num_intersection": 3523, "num_union": 11005, "num_only_computed": 3741, "num_only_roped": 3741, "total_diff": 7482, "diff_percentage": 0.6798727850976829, "num_computed": 7264, "num_roped": 7264}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14017, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14017, 128], "mask_shape": [1, 32, 1, 14017], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:55:25.578159", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.12677725118483413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14017, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14017, 128], "attention_shape": [1, 32, 1, 14017]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:56:32.930162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3227127901684115, "overlap_percentage": 0.4879559532002753, "num_intersection": 3545, "num_union": 10985, "num_only_computed": 3720, "num_only_roped": 3720, "total_diff": 7440, "diff_percentage": 0.6772872098315885, "num_computed": 7265, "num_roped": 7265}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14018, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14018, 128], "mask_shape": [1, 32, 1, 14018], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:56:35.094228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.22527472527472528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14018, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14018, 128], "attention_shape": [1, 32, 1, 14018]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:57:42.639172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3315615835777126, "overlap_percentage": 0.4980041293874742, "num_intersection": 3618, "num_union": 10912, "num_only_computed": 3647, "num_only_roped": 3647, "total_diff": 7294, "diff_percentage": 0.6684384164222874, "num_computed": 7265, "num_roped": 7265}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14019, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14019, 128], "mask_shape": [1, 32, 1, 14019], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:57:44.813364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0113525390625, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.1351010101010101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14019, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14019, 128], "attention_shape": [1, 32, 1, 14019]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:58:52.442287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34232403473120265, "overlap_percentage": 0.5100467932837875, "num_intersection": 3706, "num_union": 10826, "num_only_computed": 3560, "num_only_roped": 3560, "total_diff": 7120, "diff_percentage": 0.6576759652687973, "num_computed": 7266, "num_roped": 7266}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14020, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14020, 128], "mask_shape": [1, 32, 1, 14020], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:58:54.614021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01507568359375, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.037841796875, "l2_diff_relative": 0.18192488262910797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14020, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14020, 128], "attention_shape": [1, 32, 1, 14020]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:59:34.069063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:59:34.082777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031005859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:59:40.085759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7338760179522608, "overlap_percentage": 0.8465149876390605, "num_intersection": 1095729, "num_union": 1493071, "num_only_computed": 214991, "num_only_roped": 182351, "total_diff": 397342, "diff_percentage": 0.2661239820477392, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:59:40.479386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.775161743164062e-06, "l2_diff": 0.1806640625, "l2_diff_relative": 0.01953125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:59:55.383992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5837616375765013, "overlap_percentage": 0.7371837071010044, "num_intersection": 1352738, "num_union": 2317278, "num_only_computed": 482270, "num_only_roped": 482270, "total_diff": 964540, "diff_percentage": 0.4162383624234986, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T12:59:55.938490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 9.119510650634766e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.019827586206896553}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:00:16.438122", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5218750967582129, "overlap_percentage": 0.6858317057291666, "num_intersection": 1618080, "num_union": 3100512, "num_only_computed": 741216, "num_only_roped": 741216, "total_diff": 1482432, "diff_percentage": 0.47812490324178714, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:00:17.180942", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 9.000301361083984e-06, "l2_diff": 0.224609375, "l2_diff_relative": 0.02585431654676259}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:00:44.231386", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4853533284003285, "overlap_percentage": 0.653519023548473, "num_intersection": 1884477, "num_union": 3882691, "num_only_computed": 999107, "num_only_roped": 999107, "total_diff": 1998214, "diff_percentage": 0.5146466715996715, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:00:45.160380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 9.000301361083984e-06, "l2_diff": 0.234375, "l2_diff_relative": 0.02717391304347826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:01:17.828255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4620647936118068, "overlap_percentage": 0.6320715684157151, "num_intersection": 2154019, "num_union": 4661725, "num_only_computed": 1253853, "num_only_roped": 1253853, "total_diff": 2507706, "diff_percentage": 0.5379352063881933, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:01:18.953870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.7220458984375e-06, "l2_diff": 0.1982421875, "l2_diff_relative": 0.021145833333333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:01:58.293340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4410478909040668, "overlap_percentage": 0.6121210734049479, "num_intersection": 2406958, "num_union": 5457362, "num_only_computed": 1525202, "num_only_roped": 1525202, "total_diff": 3050404, "diff_percentage": 0.5589521090959332, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:01:59.619370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 6.020069122314453e-06, "l2_diff": 0.267578125, "l2_diff_relative": 0.029938811188811188}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:02:45.167924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4309400035320372, "overlap_percentage": 0.6023173612706801, "num_intersection": 2684196, "num_union": 6228700, "num_only_computed": 1772252, "num_only_roped": 1772252, "total_diff": 3544504, "diff_percentage": 0.5690599964679628, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:02:49.260432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.692243576049805e-06, "l2_diff": 0.25, "l2_diff_relative": 0.029850746268656716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:03:42.436591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4146400138262048, "overlap_percentage": 0.5862127605237459, "num_intersection": 2919771, "num_union": 7041701, "num_only_computed": 2060965, "num_only_roped": 2060965, "total_diff": 4121930, "diff_percentage": 0.5853599861737953, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:03:44.791115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.17616033755274263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:04:44.334562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4016122162002242, "overlap_percentage": 0.5730717976888021, "num_intersection": 3154774, "num_union": 7855274, "num_only_computed": 2350250, "num_only_roped": 2350250, "total_diff": 4700500, "diff_percentage": 0.5983877837997758, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:04:46.353118", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 5.412101745605469e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.3922018348623853}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:05:54.219909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3857284253030708, "overlap_percentage": 0.5567157579504926, "num_intersection": 3356613, "num_union": 8702011, "num_only_computed": 2672699, "num_only_roped": 2672699, "total_diff": 5345398, "diff_percentage": 0.6142715746969293, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:05:56.521854", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 4.935264587402344e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.4170984455958549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:07:14.000767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3707466402735469, "overlap_percentage": 0.540941162109375, "num_intersection": 3545112, "num_union": 9562088, "num_only_computed": 3008488, "num_only_roped": 3008488, "total_diff": 6016976, "diff_percentage": 0.629253359726453, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:07:16.595891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.5274390243902439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:40.614529", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35942022249286426, "overlap_percentage": 0.528784575285735, "num_intersection": 3742678, "num_union": 10413098, "num_only_computed": 3335210, "num_only_roped": 3335210, "total_diff": 6670420, "diff_percentage": 0.6405797775071357, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:08:43.476855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11669921875, "mean_diff": 5.817413330078125e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.5359477124183006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:17.309527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3544706876220512, "overlap_percentage": 0.5234084293760103, "num_intersection": 3979043, "num_union": 11225309, "num_only_computed": 3623133, "num_only_roped": 3623133, "total_diff": 7246266, "diff_percentage": 0.6455293123779487, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:10:20.393663", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.5232558139534884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:02.700800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34961425008970204, "overlap_percentage": 0.5180950780068675, "num_intersection": 4210281, "num_union": 12042647, "num_only_computed": 3916183, "num_only_roped": 3916183, "total_diff": 7832366, "diff_percentage": 0.650385749910298, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:12:06.065619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 5.078315734863281e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5188679245283019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:13:45.823326", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3237795964128299, "overlap_percentage": 0.4891744778212414, "num_intersection": 265113, "num_union": 818807, "num_only_computed": 276847, "num_only_roped": 276847, "total_diff": 553694, "diff_percentage": 0.6762204035871701, "num_computed": 541960, "num_roped": 541960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "mask_shape": [1, 32, 68, 15428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:13:48.919382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.291015625, "l2_diff_relative": 0.15329218106995884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "attention_shape": [1, 32, 68, 15428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:15:24.320956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32557385047570425, "overlap_percentage": 0.4912194825793624, "num_intersection": 129455, "num_union": 397621, "num_only_computed": 134083, "num_only_roped": 134083, "total_diff": 268166, "diff_percentage": 0.6744261495242958, "num_computed": 263538, "num_roped": 263538}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "mask_shape": [1, 32, 33, 15461], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:15:27.370915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.8133392333984375e-05, "l2_diff": 0.11865234375, "l2_diff_relative": 0.09551886792452831}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "attention_shape": [1, 32, 33, 15461]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:16:53.207788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32773668024270636, "overlap_percentage": 0.49367722549142357, "num_intersection": 3943, "num_union": 12031, "num_only_computed": 4044, "num_only_roped": 4044, "total_diff": 8088, "diff_percentage": 0.6722633197572937, "num_computed": 7987, "num_roped": 7987}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "mask_shape": [1, 32, 1, 15462], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:16:56.599792", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00701904296875, "mean_diff": 3.528594970703125e-05, "l2_diff": 0.0208740234375, "l2_diff_relative": 0.13970588235294118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "attention_shape": [1, 32, 1, 15462]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:12.482266", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3267441860465116, "overlap_percentage": 0.4925503943908852, "num_intersection": 3934, "num_union": 12040, "num_only_computed": 4053, "num_only_roped": 4053, "total_diff": 8106, "diff_percentage": 0.6732558139534883, "num_computed": 7987, "num_roped": 7987}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "mask_shape": [1, 32, 1, 15463], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:14.964565", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.027587890625, "l2_diff_relative": 0.14947089947089948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "attention_shape": [1, 32, 1, 15463]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:59.552914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:18:59.564481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.0030048076923076925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:05.528778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7271654951189962, "overlap_percentage": 0.8420333745364648, "num_intersection": 1089928, "num_union": 1498872, "num_only_computed": 220792, "num_only_roped": 188152, "total_diff": 408944, "diff_percentage": 0.27283450488100386, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:05.920525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.1806640625, "l2_diff_relative": 0.020647321428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:21.265816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5946150042624264, "overlap_percentage": 0.7457787649972099, "num_intersection": 1368510, "num_union": 2301506, "num_only_computed": 466498, "num_only_roped": 466498, "total_diff": 932996, "diff_percentage": 0.4053849957375736, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:21.822951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.1875, "l2_diff_relative": 0.024193548387096774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:42.311311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5225173947891136, "overlap_percentage": 0.6863861083984375, "num_intersection": 1619388, "num_union": 3099204, "num_only_computed": 739908, "num_only_roped": 739908, "total_diff": 1479816, "diff_percentage": 0.4774826052108864, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:19:43.052767", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 9.298324584960938e-06, "l2_diff": 0.2392578125, "l2_diff_relative": 0.026400862068965518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:09.659817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48228353944707575, "overlap_percentage": 0.6507304798473011, "num_intersection": 1876436, "num_union": 3890732, "num_only_computed": 1007148, "num_only_roped": 1007148, "total_diff": 2014296, "diff_percentage": 0.5177164605529242, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:10.587253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.781650543212891e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.018581081081081082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:43.375537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4660805565808754, "overlap_percentage": 0.6358184814453125, "num_intersection": 2166788, "num_union": 4648956, "num_only_computed": 1241084, "num_only_roped": 1241084, "total_diff": 2482168, "diff_percentage": 0.5339194434191247, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:20:44.500183", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.2001953125, "l2_diff_relative": 0.024451335877862596}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:21:23.669589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4521411193292356, "overlap_percentage": 0.622723388671875, "num_intersection": 2448648, "num_union": 5415672, "num_only_computed": 1483512, "num_only_roped": 1483512, "total_diff": 2967024, "diff_percentage": 0.5478588806707644, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:21:24.998365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.2265625, "l2_diff_relative": 0.024166666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:22:10.305065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4388667415947279, "overlap_percentage": 0.6100172155043658, "num_intersection": 2718510, "num_union": 6194386, "num_only_computed": 1737938, "num_only_roped": 1737938, "total_diff": 3475876, "diff_percentage": 0.5611332584052722, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:22:13.501987", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 4.351139068603516e-06, "l2_diff": 0.220703125, "l2_diff_relative": 0.024694055944055944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:23:06.370409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41661817315114563, "overlap_percentage": 0.588186966745477, "num_intersection": 2929604, "num_union": 7031868, "num_only_computed": 2051132, "num_only_roped": 2051132, "total_diff": 4102264, "diff_percentage": 0.5833818268488544, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:23:09.215672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.16495901639344263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:24:08.929191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3956763125099589, "overlap_percentage": 0.5670029776436942, "num_intersection": 3121365, "num_union": 7888683, "num_only_computed": 2383659, "num_only_roped": 2383659, "total_diff": 4767318, "diff_percentage": 0.6043236874900411, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:24:10.974578", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 5.53131103515625e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.42894736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:25:16.610117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3777229572155094, "overlap_percentage": 0.5483293360791757, "num_intersection": 2445857, "num_union": 6475267, "num_only_computed": 2014705, "num_only_roped": 2014705, "total_diff": 4029410, "diff_percentage": 0.6222770427844906, "num_computed": 4460562, "num_roped": 4460562}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "mask_shape": [1, 32, 774, 11014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:25:18.771332", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.4866666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "attention_shape": [1, 32, 774, 11014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:26:23.333057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35888993414863596, "overlap_percentage": 0.5282104534440983, "num_intersection": 94612, "num_union": 263624, "num_only_computed": 84506, "num_only_roped": 84506, "total_diff": 169012, "diff_percentage": 0.6411100658513641, "num_computed": 179118, "num_roped": 179118}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "mask_shape": [1, 32, 31, 11045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:26:25.543730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.1572265625, "l2_diff_relative": 0.1427304964539007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "attention_shape": [1, 32, 31, 11045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:27:22.360109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3759523809523809, "overlap_percentage": 0.5464613254888389, "num_intersection": 3158, "num_union": 8400, "num_only_computed": 2621, "num_only_roped": 2621, "total_diff": 5242, "diff_percentage": 0.6240476190476191, "num_computed": 5779, "num_roped": 5779}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "mask_shape": [1, 32, 1, 11046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:27:24.023440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.028076171875, "l2_diff_relative": 0.1842948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "attention_shape": [1, 32, 1, 11046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:28:15.535826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3759523809523809, "overlap_percentage": 0.5464613254888389, "num_intersection": 3158, "num_union": 8400, "num_only_computed": 2621, "num_only_roped": 2621, "total_diff": 5242, "diff_percentage": 0.6240476190476191, "num_computed": 5779, "num_roped": 5779}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "mask_shape": [1, 32, 1, 11047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:28:17.193471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0089111328125, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.019287109375, "l2_diff_relative": 0.09777227722772278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "attention_shape": [1, 32, 1, 11047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:08.632403", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3553757767616368, "overlap_percentage": 0.52439446366782, "num_intersection": 3031, "num_union": 8529, "num_only_computed": 2749, "num_only_roped": 2749, "total_diff": 5498, "diff_percentage": 0.6446242232383632, "num_computed": 5780, "num_roped": 5780}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "mask_shape": [1, 32, 1, 11048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:11.987713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0067138671875, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.0157470703125, "l2_diff_relative": 0.07396788990825688}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "attention_shape": [1, 32, 1, 11048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:42.778329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:42.791973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.0030218160377358493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:48.738878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7313446411111423, "overlap_percentage": 0.8448284919653893, "num_intersection": 1093546, "num_union": 1495254, "num_only_computed": 217174, "num_only_roped": 184534, "total_diff": 401708, "diff_percentage": 0.26865535888885766, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:29:49.129697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.655952453613281e-06, "l2_diff": 0.185546875, "l2_diff_relative": 0.019030448717948716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:06.401342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5869948286680069, "overlap_percentage": 0.7397564479282924, "num_intersection": 1357459, "num_union": 2312557, "num_only_computed": 477549, "num_only_roped": 477549, "total_diff": 955098, "diff_percentage": 0.4130051713319931, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:06.953126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.0788440704345703e-05, "l2_diff": 0.1962890625, "l2_diff_relative": 0.021809895833333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:27.440050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5070294197962029, "overlap_percentage": 0.6728858947753906, "num_intersection": 1587537, "num_union": 3131055, "num_only_computed": 771759, "num_only_roped": 771759, "total_diff": 1543518, "diff_percentage": 0.49297058020379714, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:28.175996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 1.0192394256591797e-05, "l2_diff": 0.2392578125, "l2_diff_relative": 0.024857954545454544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:55.523248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4733090266991482, "overlap_percentage": 0.6425115411931818, "num_intersection": 1852736, "num_union": 3914432, "num_only_computed": 1030848, "num_only_roped": 1030848, "total_diff": 2061696, "diff_percentage": 0.5266909733008518, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:30:56.445339", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.599592208862305e-06, "l2_diff": 0.1953125, "l2_diff_relative": 0.01977848101265823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:31:28.939719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4720718093923696, "overlap_percentage": 0.6413706265963041, "num_intersection": 2185709, "num_union": 4630035, "num_only_computed": 1222163, "num_only_roped": 1222163, "total_diff": 2444326, "diff_percentage": 0.5279281906076304, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:31:30.727351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.450580596923828e-06, "l2_diff": 0.234375, "l2_diff_relative": 0.02533783783783784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:32:09.316845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4573954341866521, "overlap_percentage": 0.6276888529459635, "num_intersection": 2468173, "num_union": 5396147, "num_only_computed": 1463987, "num_only_roped": 1463987, "total_diff": 2927974, "diff_percentage": 0.5426045658133479, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:32:12.443236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.2578125, "l2_diff_relative": 0.0275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:32:57.355192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4411891590523517, "overlap_percentage": 0.6122571159811581, "num_intersection": 2728492, "num_union": 6184404, "num_only_computed": 1727956, "num_only_roped": 1727956, "total_diff": 3455912, "diff_percentage": 0.5588108409476483, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:32:58.904374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.27734375, "l2_diff_relative": 0.030603448275862068}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:33:50.944747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4276149941628347, "overlap_percentage": 0.5990620663291529, "num_intersection": 2983770, "num_union": 6977702, "num_only_computed": 1996966, "num_only_roped": 1996966, "total_diff": 3993932, "diff_percentage": 0.5723850058371653, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:33:52.919681", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.220008850097656e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.26859504132231404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:34:52.155831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.410962141269886, "overlap_percentage": 0.5825275239490327, "num_intersection": 3206828, "num_union": 7803220, "num_only_computed": 2298196, "num_only_roped": 2298196, "total_diff": 4596392, "diff_percentage": 0.5890378587301139, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:34:54.186574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.723403930664062e-05, "l2_diff": 3.21875, "l2_diff_relative": 0.5175879396984925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:36:02.713678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39305516261500517, "overlap_percentage": 0.5643066737962805, "num_intersection": 3402381, "num_union": 8656243, "num_only_computed": 2626931, "num_only_roped": 2626931, "total_diff": 5253862, "diff_percentage": 0.6069448373849948, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:36:06.857064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.532669067382812e-05, "l2_diff": 3.0625, "l2_diff_relative": 0.5297297297297298}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:37:21.829963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3739677185932303, "overlap_percentage": 0.5443617248535156, "num_intersection": 3567529, "num_union": 9539671, "num_only_computed": 2986071, "num_only_roped": 2986071, "total_diff": 5972142, "diff_percentage": 0.6260322814067697, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:37:24.388832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 6.580352783203125e-05, "l2_diff": 4.125, "l2_diff_relative": 0.6633165829145728}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:38:48.386392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36292140413550555, "overlap_percentage": 0.5325639512803819, "num_intersection": 3769428, "num_union": 10386348, "num_only_computed": 3308460, "num_only_roped": 3308460, "total_diff": 6616920, "diff_percentage": 0.6370785958644944, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:38:51.229104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 6.079673767089844e-05, "l2_diff": 3.640625, "l2_diff_relative": 0.6164021164021164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:22.902325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3627888733607295, "overlap_percentage": 0.5324212436018319, "num_intersection": 4047560, "num_union": 11156792, "num_only_computed": 3554616, "num_only_roped": 3554616, "total_diff": 7109232, "diff_percentage": 0.6372111266392705, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:40:25.985936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 5.936622619628906e-05, "l2_diff": 3.53125, "l2_diff_relative": 0.653179190751445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:03.178657", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35690656127062187, "overlap_percentage": 0.5260591575832764, "num_intersection": 3171779, "num_union": 8886861, "num_only_computed": 2857541, "num_only_roped": 2857541, "total_diff": 5715082, "diff_percentage": 0.6430934387293781, "num_computed": 6029320, "num_roped": 6029320}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "mask_shape": [1, 32, 772, 15108], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:42:06.372590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 4.863739013671875e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.45294117647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "attention_shape": [1, 32, 772, 15108]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:43:41.473979", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35198717646504174, "overlap_percentage": 0.5206960281758901, "num_intersection": 89592, "num_union": 254532, "num_only_computed": 82470, "num_only_roped": 82470, "total_diff": 164940, "diff_percentage": 0.6480128235349583, "num_computed": 172062, "num_roped": 172062}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "mask_shape": [1, 32, 22, 15130], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:43:44.396214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.099609375, "l2_diff_relative": 0.08732876712328767}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "attention_shape": [1, 32, 22, 15130]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:06.214923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3555767397521449, "overlap_percentage": 0.5246132208157525, "num_intersection": 4103, "num_union": 11539, "num_only_computed": 3718, "num_only_roped": 3718, "total_diff": 7436, "diff_percentage": 0.6444232602478551, "num_computed": 7821, "num_roped": 7821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "mask_shape": [1, 32, 1, 15131], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:09.921450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.0186767578125, "l2_diff_relative": 0.08895348837209302}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "attention_shape": [1, 32, 1, 15131]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:48.951965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:48.961835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0031948468543046356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:57.682620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.732992732783874, "overlap_percentage": 0.8459270704573547, "num_intersection": 1094968, "num_union": 1493832, "num_only_computed": 215752, "num_only_roped": 183112, "total_diff": 398864, "diff_percentage": 0.26700726721612605, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:45:58.072589", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.2159347534179688e-05, "l2_diff": 0.2138671875, "l2_diff_relative": 0.023763020833333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:14.046603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5878070792524274, "overlap_percentage": 0.740401131766183, "num_intersection": 1358642, "num_union": 2311374, "num_only_computed": 476366, "num_only_roped": 476366, "total_diff": 952732, "diff_percentage": 0.41219292074757263, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:14.598522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.055002212524414e-05, "l2_diff": 0.197265625, "l2_diff_relative": 0.022706834532374102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:34.933625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5224014660712903, "overlap_percentage": 0.6862860785590278, "num_intersection": 1619152, "num_union": 3099440, "num_only_computed": 740144, "num_only_roped": 740144, "total_diff": 1480288, "diff_percentage": 0.4775985339287097, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:46:35.668811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.228515625, "l2_diff_relative": 0.028676470588235293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:02.316095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48462529555848166, "overlap_percentage": 0.6528587341308594, "num_intersection": 1882573, "num_union": 3884595, "num_only_computed": 1001011, "num_only_roped": 1001011, "total_diff": 2002022, "diff_percentage": 0.5153747044415183, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:03.221444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.19921875, "l2_diff_relative": 0.02125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:31.203952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43625662818246774, "overlap_percentage": 0.6074911956849037, "num_intersection": 46402, "num_union": 106364, "num_only_computed": 29981, "num_only_roped": 29981, "total_diff": 59962, "diff_percentage": 0.5637433718175322, "num_computed": 76383, "num_roped": 76383}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "mask_shape": [1, 32, 27, 5147], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:32.026543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.02662037037037037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "attention_shape": [1, 32, 27, 5147]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:56.978180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4196137446701781, "overlap_percentage": 0.5911660777385159, "num_intersection": 1673, "num_union": 3987, "num_only_computed": 1157, "num_only_roped": 1157, "total_diff": 2314, "diff_percentage": 0.5803862553298219, "num_computed": 2830, "num_roped": 2830}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "mask_shape": [1, 32, 1, 5148], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:47:57.948674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 1.0967254638671875e-05, "l2_diff": 0.00885009765625, "l2_diff_relative": 0.03840042372881356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "attention_shape": [1, 32, 1, 5148]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:21.616269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4354552371290895, "overlap_percentage": 0.606713780918728, "num_intersection": 1717, "num_union": 3943, "num_only_computed": 1113, "num_only_roped": 1113, "total_diff": 2226, "diff_percentage": 0.5645447628709105, "num_computed": 2830, "num_roped": 2830}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "mask_shape": [1, 32, 1, 5149], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:22.898799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 9.298324584960938e-06, "l2_diff": 0.00665283203125, "l2_diff_relative": 0.028267634854771784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "attention_shape": [1, 32, 1, 5149]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:47.072150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41904761904761906, "overlap_percentage": 0.5906040268456376, "num_intersection": 1672, "num_union": 3990, "num_only_computed": 1159, "num_only_roped": 1159, "total_diff": 2318, "diff_percentage": 0.580952380952381, "num_computed": 2831, "num_roped": 2831}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "mask_shape": [1, 32, 1, 5150], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:48:47.818876", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00341796875, "mean_diff": 6.705522537231445e-06, "l2_diff": 0.006103515625, "l2_diff_relative": 0.02385496183206107}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "attention_shape": [1, 32, 1, 5150]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:10.954731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4081074359612037, "overlap_percentage": 0.5796538325679972, "num_intersection": 1641, "num_union": 4021, "num_only_computed": 1190, "num_only_roped": 1190, "total_diff": 2380, "diff_percentage": 0.5918925640387963, "num_computed": 2831, "num_roped": 2831}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5151, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5151, 128], "mask_shape": [1, 32, 1, 5151], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:11.698775", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00341796875, "mean_diff": 1.0848045349121094e-05, "l2_diff": 0.00732421875, "l2_diff_relative": 0.03205128205128205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5151, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5151, 128], "attention_shape": [1, 32, 1, 5151]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:34.817917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40336967294350845, "overlap_percentage": 0.5748587570621468, "num_intersection": 1628, "num_union": 4036, "num_only_computed": 1204, "num_only_roped": 1204, "total_diff": 2408, "diff_percentage": 0.5966303270564915, "num_computed": 2832, "num_roped": 2832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5152, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5152, 128], "mask_shape": [1, 32, 1, 5152], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:35.726191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.003692626953125, "l2_diff_relative": 0.016805555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5152, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5152, 128], "attention_shape": [1, 32, 1, 5152]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:58.841965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39473036197980793, "overlap_percentage": 0.5660310734463276, "num_intersection": 1603, "num_union": 4061, "num_only_computed": 1229, "num_only_roped": 1229, "total_diff": 2458, "diff_percentage": 0.6052696380201921, "num_computed": 2832, "num_roped": 2832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5153, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5153, 128], "mask_shape": [1, 32, 1, 5153], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:49:59.587024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00457763671875, "mean_diff": 8.940696716308594e-06, "l2_diff": 0.00714111328125, "l2_diff_relative": 0.026494565217391304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5153, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5153, 128], "attention_shape": [1, 32, 1, 5153]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:23.400478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4257674886763966, "overlap_percentage": 0.5972467349099894, "num_intersection": 1692, "num_union": 3974, "num_only_computed": 1141, "num_only_roped": 1141, "total_diff": 2282, "diff_percentage": 0.5742325113236034, "num_computed": 2833, "num_roped": 2833}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5154, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5154, 128], "mask_shape": [1, 32, 1, 5154], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:24.150611", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.002044677734375, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.003662109375, "l2_diff_relative": 0.017201834862385322}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5154, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5154, 128], "attention_shape": [1, 32, 1, 5154]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:39.073620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:39.085265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:45.053740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7389084802686818, "overlap_percentage": 0.8498532138442522, "num_intersection": 1100050, "num_union": 1488750, "num_only_computed": 210670, "num_only_roped": 178030, "total_diff": 388700, "diff_percentage": 0.2610915197313182, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:50:45.437276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.1086463928222656e-05, "l2_diff": 0.177734375, "l2_diff_relative": 0.021543560606060608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:00.326786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6187245476522641, "overlap_percentage": 0.7644593375069755, "num_intersection": 1402789, "num_union": 2267227, "num_only_computed": 432219, "num_only_roped": 432219, "total_diff": 864438, "diff_percentage": 0.3812754523477358, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:00.881495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.0609626770019531e-05, "l2_diff": 0.1728515625, "l2_diff_relative": 0.02295124481327801}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:22.180105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5354372062844153, "overlap_percentage": 0.6974394056532118, "num_intersection": 1645466, "num_union": 3073126, "num_only_computed": 713830, "num_only_roped": 713830, "total_diff": 1427660, "diff_percentage": 0.46456279371558473, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:22.916534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.25390625, "l2_diff_relative": 0.03316326530612245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:52.461399", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4916430848049527, "overlap_percentage": 0.6591966802423651, "num_intersection": 1900849, "num_union": 3866319, "num_only_computed": 982735, "num_only_roped": 982735, "total_diff": 1965470, "diff_percentage": 0.5083569151950473, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:51:54.521033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.212162017822266e-06, "l2_diff": 0.1748046875, "l2_diff_relative": 0.02012140287769784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:52:27.209682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4775223257109597, "overlap_percentage": 0.6463825519268329, "num_intersection": 2202789, "num_union": 4612955, "num_only_computed": 1205083, "num_only_roped": 1205083, "total_diff": 2410166, "diff_percentage": 0.5224776742890404, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:52:28.331139", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.016384548611111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:07.416789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4585206484292238, "overlap_percentage": 0.62874755859375, "num_intersection": 2472336, "num_union": 5391984, "num_only_computed": 1459824, "num_only_roped": 1459824, "total_diff": 2919648, "diff_percentage": 0.5414793515707762, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:08.719501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 3.546476364135742e-06, "l2_diff": 0.18359375, "l2_diff_relative": 0.019982993197278913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:54.205405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4311353035156595, "overlap_percentage": 0.6025080961339614, "num_intersection": 2685046, "num_union": 6227850, "num_only_computed": 1771402, "num_only_roped": 1771402, "total_diff": 3542804, "diff_percentage": 0.5688646964843405, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:53:58.400348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.22265625, "l2_diff_relative": 0.027403846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:54:51.544115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4017417303830186, "overlap_percentage": 0.5732036389802632, "num_intersection": 2854976, "num_union": 7106496, "num_only_computed": 2125760, "num_only_roped": 2125760, "total_diff": 4251520, "diff_percentage": 0.5982582696169815, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:54:55.048779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 2.8371810913085938e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:55:53.979973", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39737327967409486, "overlap_percentage": 0.5687432062058222, "num_intersection": 3130945, "num_union": 7879103, "num_only_computed": 2374079, "num_only_roped": 2374079, "total_diff": 4748158, "diff_percentage": 0.6026267203259051, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:55:55.989319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 4.649162292480469e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.3359375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:02.929927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38071299407198916, "overlap_percentage": 0.5514730370563009, "num_intersection": 3325003, "num_union": 8733621, "num_only_computed": 2704309, "num_only_roped": 2704309, "total_diff": 5408618, "diff_percentage": 0.6192870059280109, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:57:05.201144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.24245689655172414}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:12.791837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3401132824594314, "overlap_percentage": 0.5075888537351729, "num_intersection": 280119, "num_union": 823605, "num_only_computed": 271743, "num_only_roped": 271743, "total_diff": 543486, "diff_percentage": 0.6598867175405686, "num_computed": 551862, "num_roped": 551862}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 93, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:58:14.915412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.31640625, "l2_diff_relative": 0.12272727272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 93, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:19.174184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33604652167526416, "overlap_percentage": 0.5030461383244299, "num_intersection": 77782, "num_union": 231462, "num_only_computed": 76840, "num_only_roped": 76840, "total_diff": 153680, "diff_percentage": 0.6639534783247358, "num_computed": 154622, "num_roped": 154622}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 26, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T13:59:21.236861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.1103515625, "l2_diff_relative": 0.10782442748091603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 26, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:00:20.437821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35659710343254647, "overlap_percentage": 0.5257229320780095, "num_intersection": 3127, "num_union": 8769, "num_only_computed": 2821, "num_only_roped": 2821, "total_diff": 5642, "diff_percentage": 0.6434028965674535, "num_computed": 5948, "num_roped": 5948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:00:22.157414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.026611328125, "l2_diff_relative": 0.13903061224489796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:01:15.571853", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3542805100182149, "overlap_percentage": 0.5232010759919301, "num_intersection": 3112, "num_union": 8784, "num_only_computed": 2836, "num_only_roped": 2836, "total_diff": 5672, "diff_percentage": 0.6457194899817851, "num_computed": 5948, "num_roped": 5948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:01:17.293577", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0091552734375, "mean_diff": 3.838539123535156e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.11215415019762846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:10.725762", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3466893039049236, "overlap_percentage": 0.5148764498234998, "num_intersection": 3063, "num_union": 8835, "num_only_computed": 2886, "num_only_roped": 2886, "total_diff": 5772, "diff_percentage": 0.6533106960950764, "num_computed": 5949, "num_roped": 5949}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:12.463323", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.01544189453125, "l2_diff_relative": 0.04791666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:46.144607", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:46.157270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003117487980769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:52.145084", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7288506629108508, "overlap_percentage": 0.8431620828182942, "num_intersection": 1091389, "num_union": 1497411, "num_only_computed": 219331, "num_only_roped": 186691, "total_diff": 406022, "diff_percentage": 0.2711493370891492, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:02:52.536162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.208984375, "l2_diff_relative": 0.023220486111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:07.852540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5798680062626211, "overlap_percentage": 0.7340714590890067, "num_intersection": 1347027, "num_union": 2322989, "num_only_computed": 487981, "num_only_roped": 487981, "total_diff": 975962, "diff_percentage": 0.42013199373737886, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:08.417877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.224609375, "l2_diff_relative": 0.027020676691729324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:28.937046", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5272600159244946, "overlap_percentage": 0.6904652913411459, "num_intersection": 1629012, "num_union": 3089580, "num_only_computed": 730284, "num_only_roped": 730284, "total_diff": 1460568, "diff_percentage": 0.4727399840755054, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:29.684433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.2099742889404297e-05, "l2_diff": 0.255859375, "l2_diff_relative": 0.031013257575757576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:56.555788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49913387054847935, "overlap_percentage": 0.6658963290127841, "num_intersection": 1920168, "num_union": 3847000, "num_only_computed": 963416, "num_only_roped": 963416, "total_diff": 1926832, "diff_percentage": 0.5008661294515206, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:03:57.472355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.4373016357421875e-06, "l2_diff": 0.185546875, "l2_diff_relative": 0.0199244966442953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:04:30.263402", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4620553847209903, "overlap_percentage": 0.6320627652681791, "num_intersection": 2153989, "num_union": 4661755, "num_only_computed": 1253883, "num_only_roped": 1253883, "total_diff": 2507766, "diff_percentage": 0.5379446152790097, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:04:31.386120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.3942203521728516e-06, "l2_diff": 0.185546875, "l2_diff_relative": 0.022154850746268658}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:05:10.749456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45224891833648184, "overlap_percentage": 0.6228256225585938, "num_intersection": 2449050, "num_union": 5415270, "num_only_computed": 1483110, "num_only_roped": 1483110, "total_diff": 2966220, "diff_percentage": 0.5477510816635182, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:05:12.084449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 7.599592208862305e-06, "l2_diff": 0.310546875, "l2_diff_relative": 0.039278656126482216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:05:57.661435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45104076311340685, "overlap_percentage": 0.6216789694393382, "num_intersection": 2770480, "num_union": 6142416, "num_only_computed": 1685968, "num_only_roped": 1685968, "total_diff": 3371936, "diff_percentage": 0.5489592368865932, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:06:00.989162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 3.9637088775634766e-06, "l2_diff": 0.2060546875, "l2_diff_relative": 0.021979166666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:06:54.000233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41965356735723935, "overlap_percentage": 0.5912055969238281, "num_intersection": 2944639, "num_union": 7016833, "num_only_computed": 2036097, "num_only_roped": 2036097, "total_diff": 4072194, "diff_percentage": 0.5803464326427606, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:06:56.277471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10302734375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.578125, "l2_diff_relative": 0.19573643410852712}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:07:56.018792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3921475381666142, "overlap_percentage": 0.5633706592378163, "num_intersection": 3101369, "num_union": 7908679, "num_only_computed": 2403655, "num_only_roped": 2403655, "total_diff": 4807310, "diff_percentage": 0.6078524618333858, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:07:58.036777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 6.866455078125e-05, "l2_diff": 3.046875, "l2_diff_relative": 0.5539772727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:09:05.275651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3766547285894061, "overlap_percentage": 0.5472028981084409, "num_intersection": 3299257, "num_union": 8759367, "num_only_computed": 2730055, "num_only_roped": 2730055, "total_diff": 5460110, "diff_percentage": 0.6233452714105939, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:09:07.572800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.3854166666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:10:22.233130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3782763532838429, "overlap_percentage": 0.5489122009277344, "num_intersection": 3597351, "num_union": 9509849, "num_only_computed": 2956249, "num_only_roped": 2956249, "total_diff": 5912498, "diff_percentage": 0.6217236467161571, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:10:24.808450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11474609375, "mean_diff": 4.4345855712890625e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.3479381443298969}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:11:47.747620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37166537889318924, "overlap_percentage": 0.5419184366861979, "num_intersection": 3835638, "num_union": 10320138, "num_only_computed": 3242250, "num_only_roped": 3242250, "total_diff": 6484500, "diff_percentage": 0.6283346211068108, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:11:50.579364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 3.8623809814453125e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.31497797356828194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:13:20.545846", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3627596669874637, "overlap_percentage": 0.5323897907682952, "num_intersection": 3452732, "num_union": 9517960, "num_only_computed": 3032614, "num_only_roped": 3032614, "total_diff": 6065228, "diff_percentage": 0.6372403330125364, "num_computed": 6485346, "num_roped": 6485346}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:13:25.658554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 4.220008850097656e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.35384615384615387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:14:55.137271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3359541720233026, "overlap_percentage": 0.5029426593496092, "num_intersection": 103745, "num_union": 308807, "num_only_computed": 102531, "num_only_roped": 102531, "total_diff": 205062, "diff_percentage": 0.6640458279766974, "num_computed": 206276, "num_roped": 206276}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "mask_shape": [1, 32, 28, 14222], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:14:59.449255", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.103515625, "l2_diff_relative": 0.08229813664596274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "attention_shape": [1, 32, 28, 14222]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:16:17.609596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3509994498441225, "overlap_percentage": 0.51961449708158, "num_intersection": 3828, "num_union": 10906, "num_only_computed": 3539, "num_only_roped": 3539, "total_diff": 7078, "diff_percentage": 0.6490005501558775, "num_computed": 7367, "num_roped": 7367}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "mask_shape": [1, 32, 1, 14223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:16:21.285871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046142578125, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.06005859375, "l2_diff_relative": 0.3942307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "attention_shape": [1, 32, 1, 14223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:17:31.478307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3381765346894297, "overlap_percentage": 0.50542888165038, "num_intersection": 3724, "num_union": 11012, "num_only_computed": 3644, "num_only_roped": 3644, "total_diff": 7288, "diff_percentage": 0.6618234653105702, "num_computed": 7368, "num_roped": 7368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "mask_shape": [1, 32, 1, 14224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:17:34.465270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0179443359375, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.1286008230452675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "attention_shape": [1, 32, 1, 14224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:18:43.529718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34796926454445665, "overlap_percentage": 0.5162866449511401, "num_intersection": 3804, "num_union": 10932, "num_only_computed": 3564, "num_only_roped": 3564, "total_diff": 7128, "diff_percentage": 0.6520307354555434, "num_computed": 7368, "num_roped": 7368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 1, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:18:45.782451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 4.315376281738281e-05, "l2_diff": 0.02978515625, "l2_diff_relative": 0.22426470588235295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 1, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:19:54.919429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3501282521069989, "overlap_percentage": 0.518659248201927, "num_intersection": 3822, "num_union": 10916, "num_only_computed": 3547, "num_only_roped": 3547, "total_diff": 7094, "diff_percentage": 0.6498717478930011, "num_computed": 7369, "num_roped": 7369}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:19:57.167335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.1361111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:21:07.090484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3451989777290982, "overlap_percentage": 0.5132311032704573, "num_intersection": 3782, "num_union": 10956, "num_only_computed": 3587, "num_only_roped": 3587, "total_diff": 7174, "diff_percentage": 0.6548010222709018, "num_computed": 7369, "num_roped": 7369}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:21:09.310337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0101318359375, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.02001953125, "l2_diff_relative": 0.10789473684210527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:22:17.456799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34870527953152164, "overlap_percentage": 0.5170963364993216, "num_intersection": 3811, "num_union": 10929, "num_only_computed": 3559, "num_only_roped": 3559, "total_diff": 7118, "diff_percentage": 0.6512947204684784, "num_computed": 7370, "num_roped": 7370}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:22:19.687943", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.02734375, "l2_diff_relative": 0.0875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:23:29.652776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34439985406785845, "overlap_percentage": 0.5123473541383989, "num_intersection": 3776, "num_union": 10964, "num_only_computed": 3594, "num_only_roped": 3594, "total_diff": 7188, "diff_percentage": 0.6556001459321416, "num_computed": 7370, "num_roped": 7370}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "mask_shape": [1, 32, 1, 14229], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:23:33.496494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.633167266845703e-05, "l2_diff": 0.0274658203125, "l2_diff_relative": 0.12335526315789473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "attention_shape": [1, 32, 1, 14229]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:11.376925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:11.387410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003115110759493671}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:17.294730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7387438032737118, "overlap_percentage": 0.849744283065513, "num_intersection": 1099909, "num_union": 1488891, "num_only_computed": 210811, "num_only_roped": 178171, "total_diff": 388982, "diff_percentage": 0.26125619672628825, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:17.684186", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 9.834766387939453e-06, "l2_diff": 0.189453125, "l2_diff_relative": 0.018827639751552796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:32.478135", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.595163936065065, "overlap_percentage": 0.7462103707449776, "num_intersection": 1369302, "num_union": 2300714, "num_only_computed": 465706, "num_only_roped": 465706, "total_diff": 931412, "diff_percentage": 0.404836063934935, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:33.028597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.0371208190917969e-05, "l2_diff": 0.19921875, "l2_diff_relative": 0.021982758620689654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:54.002861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5267796820762116, "overlap_percentage": 0.6900533040364584, "num_intersection": 1628040, "num_union": 3090552, "num_only_computed": 731256, "num_only_roped": 731256, "total_diff": 1462512, "diff_percentage": 0.4732203179237884, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:24:57.407112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.248046875, "l2_diff_relative": 0.026283112582781456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:25:24.735926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48606599260106537, "overlap_percentage": 0.6541647477583452, "num_intersection": 1886339, "num_union": 3880829, "num_only_computed": 997245, "num_only_roped": 997245, "total_diff": 1994490, "diff_percentage": 0.5139340073989346, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:25:26.070730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.0788440704345703e-05, "l2_diff": 0.267578125, "l2_diff_relative": 0.030580357142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:25:58.549143", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4594125258527638, "overlap_percentage": 0.6295855595515325, "num_intersection": 2145547, "num_union": 4670197, "num_only_computed": 1262325, "num_only_roped": 1262325, "total_diff": 2524650, "diff_percentage": 0.5405874741472362, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:25:59.673752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 9.59634780883789e-06, "l2_diff": 0.298828125, "l2_diff_relative": 0.032748287671232876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:26:39.372785", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45297443024251344, "overlap_percentage": 0.6235132853190104, "num_intersection": 2451754, "num_union": 5412566, "num_only_computed": 1480406, "num_only_roped": 1480406, "total_diff": 2960812, "diff_percentage": 0.5470255697574865, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:26:40.669445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 5.513429641723633e-06, "l2_diff": 0.267578125, "l2_diff_relative": 0.02709651898734177}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:27:25.800864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4412502170875119, "overlap_percentage": 0.6123159071978401, "num_intersection": 2728754, "num_union": 6184142, "num_only_computed": 1727694, "num_only_roped": 1727694, "total_diff": 3455388, "diff_percentage": 0.5587497829124881, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:27:27.336716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 6.258487701416016e-06, "l2_diff": 0.28515625, "l2_diff_relative": 0.031684027777777776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:28:20.328445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4271151348410191, "overlap_percentage": 0.5985713757966694, "num_intersection": 2981326, "num_union": 6980146, "num_only_computed": 1999410, "num_only_roped": 1999410, "total_diff": 3998820, "diff_percentage": 0.572884865158981, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:28:22.104290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.671875, "l2_diff_relative": 0.24541284403669725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:29:16.012122", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4168328995865094, "overlap_percentage": 0.5884009324009324, "num_intersection": 63106, "num_union": 151394, "num_only_computed": 44144, "num_only_roped": 44144, "total_diff": 88288, "diff_percentage": 0.5831671004134906, "num_computed": 107250, "num_roped": 107250}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "mask_shape": [1, 32, 22, 9238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:29:17.564685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.1552734375, "l2_diff_relative": 0.11691176470588235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "attention_shape": [1, 32, 22, 9238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:30:07.005641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40157782957272453, "overlap_percentage": 0.5730367891095235, "num_intersection": 162990, "num_union": 405874, "num_only_computed": 121442, "num_only_roped": 121442, "total_diff": 242884, "diff_percentage": 0.5984221704272754, "num_computed": 284432, "num_roped": 284432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "mask_shape": [1, 32, 58, 9296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:30:08.640351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.36328125, "l2_diff_relative": 0.2152777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "attention_shape": [1, 32, 58, 9296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:30:55.667766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39298395114330353, "overlap_percentage": 0.5642332789559543, "num_intersection": 2767, "num_union": 7041, "num_only_computed": 2137, "num_only_roped": 2137, "total_diff": 4274, "diff_percentage": 0.6070160488566965, "num_computed": 4904, "num_roped": 4904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "mask_shape": [1, 32, 1, 9297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:30:59.273542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 9.012222290039062e-05, "l2_diff": 0.08203125, "l2_diff_relative": 0.7636363636363637}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "attention_shape": [1, 32, 1, 9297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:31:41.590773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40062821245002855, "overlap_percentage": 0.5720693170234454, "num_intersection": 2806, "num_union": 7004, "num_only_computed": 2099, "num_only_roped": 2099, "total_diff": 4198, "diff_percentage": 0.5993717875499714, "num_computed": 4905, "num_roped": 4905}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "mask_shape": [1, 32, 1, 9298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:31:42.969393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.039794921875, "l2_diff_relative": 0.31346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "attention_shape": [1, 32, 1, 9298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:32:25.387495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4104960460100647, "overlap_percentage": 0.582059123343527, "num_intersection": 2855, "num_union": 6955, "num_only_computed": 2050, "num_only_roped": 2050, "total_diff": 4100, "diff_percentage": 0.5895039539899353, "num_computed": 4905, "num_roped": 4905}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9299, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9299, 128], "mask_shape": [1, 32, 1, 9299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:32:26.765609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.21578947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9299, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9299, 128], "attention_shape": [1, 32, 1, 9299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:32:53.723014", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:32:53.736714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0031115301724137933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:32:59.716177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7326702853203579, "overlap_percentage": 0.8457122991347342, "num_intersection": 1094690, "num_union": 1494110, "num_only_computed": 216030, "num_only_roped": 183390, "total_diff": 399420, "diff_percentage": 0.26732971467964206, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:33:00.109818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.228515625, "l2_diff_relative": 0.02925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:33:17.432597", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5894877713919434, "overlap_percentage": 0.7417330060686383, "num_intersection": 1361086, "num_union": 2308930, "num_only_computed": 473922, "num_only_roped": 473922, "total_diff": 947844, "diff_percentage": 0.41051222860805653, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:33:17.982906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.4066696166992188e-05, "l2_diff": 0.21875, "l2_diff_relative": 0.029166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:33:38.455648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5217793877331848, "overlap_percentage": 0.6857490539550781, "num_intersection": 1617885, "num_union": 3100707, "num_only_computed": 741411, "num_only_roped": 741411, "total_diff": 1482822, "diff_percentage": 0.4782206122668153, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:33:39.195498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.2451171875, "l2_diff_relative": 0.03201530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:34:05.694623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48951917335256284, "overlap_percentage": 0.6572848233309659, "num_intersection": 1895336, "num_union": 3871832, "num_only_computed": 988248, "num_only_roped": 988248, "total_diff": 1976496, "diff_percentage": 0.5104808266474372, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:34:06.622989", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.1265277862548828e-05, "l2_diff": 0.244140625, "l2_diff_relative": 0.03125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:34:39.228932", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4599699169782286, "overlap_percentage": 0.6301087599534255, "num_intersection": 2147330, "num_union": 4668414, "num_only_computed": 1260542, "num_only_roped": 1260542, "total_diff": 2521084, "diff_percentage": 0.5400300830217715, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:34:42.056499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.827976226806641e-06, "l2_diff": 0.1708984375, "l2_diff_relative": 0.02119670542635659}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:35:20.711788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44654237282523945, "overlap_percentage": 0.6173927307128906, "num_intersection": 2427687, "num_union": 5436633, "num_only_computed": 1504473, "num_only_roped": 1504473, "total_diff": 3008946, "diff_percentage": 0.5534576271747605, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:35:23.861023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 6.496906280517578e-06, "l2_diff": 0.267578125, "l2_diff_relative": 0.033187984496124034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:36:08.890988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45043956333659996, "overlap_percentage": 0.6211076624253217, "num_intersection": 2767934, "num_union": 6144962, "num_only_computed": 1688514, "num_only_roped": 1688514, "total_diff": 3377028, "diff_percentage": 0.5495604366634, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:36:10.422004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.21875, "l2_diff_relative": 0.025735294117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:37:02.139332", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43194075631236595, "overlap_percentage": 0.6032941717850534, "num_intersection": 3004849, "num_union": 6956623, "num_only_computed": 1975887, "num_only_roped": 1975887, "total_diff": 3951774, "diff_percentage": 0.568059243687634, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:37:03.900628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 3.528594970703125e-05, "l2_diff": 1.375, "l2_diff_relative": 0.20754716981132076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:38:02.895787", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40633935676540806, "overlap_percentage": 0.5778681437174479, "num_intersection": 3181178, "num_union": 7828870, "num_only_computed": 2323846, "num_only_roped": 2323846, "total_diff": 4647692, "diff_percentage": 0.593660643234592, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:38:04.913462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.5192307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:39:13.380489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3945140772369095, "overlap_percentage": 0.5658086693805197, "num_intersection": 3411437, "num_union": 8647187, "num_only_computed": 2617875, "num_only_roped": 2617875, "total_diff": 5235750, "diff_percentage": 0.6054859227630904, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:39:18.118440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.34299516908212563}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:40:33.119235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3786290617766173, "overlap_percentage": 0.549283447265625, "num_intersection": 3599784, "num_union": 9507416, "num_only_computed": 2953816, "num_only_roped": 2953816, "total_diff": 5907632, "diff_percentage": 0.6213709382233826, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:40:35.697124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.2438507080078125e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.3380952380952381}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:41:59.271246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3590982342292521, "overlap_percentage": 0.528436024983724, "num_intersection": 3740211, "num_union": 10415565, "num_only_computed": 3337677, "num_only_roped": 3337677, "total_diff": 6675354, "diff_percentage": 0.6409017657707479, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:42:02.063067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.673004150390625e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.3872832369942196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:43:33.392590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3438152740461488, "overlap_percentage": 0.511700202678812, "num_intersection": 3890035, "num_union": 11314317, "num_only_computed": 3712141, "num_only_roped": 3712141, "total_diff": 7424282, "diff_percentage": 0.6561847259538512, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:43:36.461733", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.35714285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:45:15.916810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33901004266100115, "overlap_percentage": 0.5063592233965474, "num_intersection": 4114910, "num_union": 12138018, "num_only_computed": 4011554, "num_only_roped": 4011554, "total_diff": 8023108, "diff_percentage": 0.6609899573389988, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:45:19.665694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11669921875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.42073170731707316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:47:07.909786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3397526867658246, "overlap_percentage": 0.5071871698738529, "num_intersection": 3917676, "num_union": 11530964, "num_only_computed": 3806644, "num_only_roped": 3806644, "total_diff": 7613288, "diff_percentage": 0.6602473132341754, "num_computed": 7724320, "num_roped": 7724320}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "mask_shape": [1, 32, 920, 16280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:47:13.503705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.4872611464968153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "attention_shape": [1, 32, 920, 16280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:48:59.078299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3229437740049687, "overlap_percentage": 0.48821995363766046, "num_intersection": 131421, "num_union": 406947, "num_only_computed": 137763, "num_only_roped": 137763, "total_diff": 275526, "diff_percentage": 0.6770562259950313, "num_computed": 269184, "num_roped": 269184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "mask_shape": [1, 32, 32, 16312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:49:04.151475", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.1494140625, "l2_diff_relative": 0.1241883116883117}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "attention_shape": [1, 32, 32, 16312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:50:35.797160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3367233433974257, "overlap_percentage": 0.5038040893961008, "num_intersection": 4238, "num_union": 12586, "num_only_computed": 4174, "num_only_roped": 4174, "total_diff": 8348, "diff_percentage": 0.6632766566025743, "num_computed": 8412, "num_roped": 8412}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "mask_shape": [1, 32, 1, 16313], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:50:40.952100", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008544921875, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.0225830078125, "l2_diff_relative": 0.1133578431372549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "attention_shape": [1, 32, 1, 16313]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:02.150320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32436048799685163, "overlap_percentage": 0.489837156781172, "num_intersection": 4121, "num_union": 12705, "num_only_computed": 4292, "num_only_roped": 4292, "total_diff": 8584, "diff_percentage": 0.6756395120031483, "num_computed": 8413, "num_roped": 8413}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "mask_shape": [1, 32, 1, 16314], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:04.740714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.09423828125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "attention_shape": [1, 32, 1, 16314]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:49.469174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:49.480744", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031398338607594935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:55.468445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7462053018861688, "overlap_percentage": 0.8546593016069222, "num_intersection": 1106271, "num_union": 1482529, "num_only_computed": 204449, "num_only_roped": 171809, "total_diff": 376258, "diff_percentage": 0.25379469811383115, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:52:58.129139", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.463859558105469e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.01815580985915493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:12.972755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6133988009905434, "overlap_percentage": 0.7603808811732701, "num_intersection": 1395305, "num_union": 2274711, "num_only_computed": 439703, "num_only_roped": 439703, "total_diff": 879406, "diff_percentage": 0.3866011990094566, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:13.535534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.715557098388672e-06, "l2_diff": 0.18359375, "l2_diff_relative": 0.02054195804195804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:34.480342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5370912747624534, "overlap_percentage": 0.6988410949707031, "num_intersection": 1648773, "num_union": 3069819, "num_only_computed": 710523, "num_only_roped": 710523, "total_diff": 1421046, "diff_percentage": 0.46290872523754656, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:53:35.219786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.236328125, "l2_diff_relative": 0.026077586206896552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:01.792404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4905416553808873, "overlap_percentage": 0.6582058993252841, "num_intersection": 1897992, "num_union": 3869176, "num_only_computed": 985592, "num_only_roped": 985592, "total_diff": 1971184, "diff_percentage": 0.5094583446191127, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:02.726495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.150369644165039e-05, "l2_diff": 0.251953125, "l2_diff_relative": 0.03125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:35.370216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46695840491552837, "overlap_percentage": 0.6366348266601562, "num_intersection": 2169570, "num_union": 4646174, "num_only_computed": 1238302, "num_only_roped": 1238302, "total_diff": 2476604, "diff_percentage": 0.5330415950844717, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:54:36.492716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 8.344650268554688e-06, "l2_diff": 0.25390625, "l2_diff_relative": 0.02922661870503597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:15.391535", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45406647793908145, "overlap_percentage": 0.6245470682779948, "num_intersection": 2455819, "num_union": 5408501, "num_only_computed": 1476341, "num_only_roped": 1476341, "total_diff": 2952682, "diff_percentage": 0.5459335220609185, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:55:17.410498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 7.62939453125e-06, "l2_diff": 0.3125, "l2_diff_relative": 0.036231884057971016}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:02.463457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44256024818864564, "overlap_percentage": 0.6135761036592371, "num_intersection": 2734370, "num_union": 6178526, "num_only_computed": 1722078, "num_only_roped": 1722078, "total_diff": 3444156, "diff_percentage": 0.5574397518113544, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:03.995433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.155801773071289e-06, "l2_diff": 0.2353515625, "l2_diff_relative": 0.027486313868613138}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:55.904276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4284850601968724, "overlap_percentage": 0.5999153538754112, "num_intersection": 2988020, "num_union": 6973452, "num_only_computed": 1992716, "num_only_roped": 1992716, "total_diff": 3985432, "diff_percentage": 0.5715149398031276, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:56:57.700261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 2.7418136596679688e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.16371681415929204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:57:54.753855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4159895057579158, "overlap_percentage": 0.5875601536118098, "num_intersection": 1404834, "num_union": 3377090, "num_only_computed": 986128, "num_only_roped": 986128, "total_diff": 1972256, "diff_percentage": 0.5840104942420842, "num_computed": 2390962, "num_roped": 2390962}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "mask_shape": [1, 32, 469, 9685], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:57:56.630180", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.2676056338028169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "attention_shape": [1, 32, 469, 9685]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:58:52.439012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40303510447829494, "overlap_percentage": 0.5745189171559034, "num_intersection": 70459, "num_union": 174821, "num_only_computed": 52181, "num_only_roped": 52181, "total_diff": 104362, "diff_percentage": 0.5969648955217051, "num_computed": 122640, "num_roped": 122640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "mask_shape": [1, 32, 24, 9709], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:58:54.207922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.10302734375, "l2_diff_relative": 0.08791666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "attention_shape": [1, 32, 24, 9709]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:44.373567", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4197222222222222, "overlap_percentage": 0.5912737233418118, "num_intersection": 3022, "num_union": 7200, "num_only_computed": 2089, "num_only_roped": 2089, "total_diff": 4178, "diff_percentage": 0.5802777777777778, "num_computed": 5111, "num_roped": 5111}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 1, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T14:59:45.865832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.021484375, "l2_diff_relative": 0.08943089430894309}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 1, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:00:31.789550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.396829734900246, "overlap_percentage": 0.5681862649188025, "num_intersection": 2904, "num_union": 7318, "num_only_computed": 2207, "num_only_roped": 2207, "total_diff": 4414, "diff_percentage": 0.603170265099754, "num_computed": 5111, "num_roped": 5111}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "mask_shape": [1, 32, 1, 9711], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:00:33.269598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0040283203125, "mean_diff": 1.0728836059570312e-05, "l2_diff": 0.0086669921875, "l2_diff_relative": 0.03521825396825397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "attention_shape": [1, 32, 1, 9711]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:00:58.356243", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:00:58.364578", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.029541015625, "l2_diff_relative": 0.0030298477564102565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:04.416085", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7382651324346119, "overlap_percentage": 0.8494275339925834, "num_intersection": 1099499, "num_union": 1489301, "num_only_computed": 211221, "num_only_roped": 178581, "total_diff": 389802, "diff_percentage": 0.26173486756538805, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:04.806349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 7.987022399902344e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.016505281690140844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:19.955160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5917876260954877, "overlap_percentage": 0.7435509817940849, "num_intersection": 1364422, "num_union": 2305594, "num_only_computed": 470586, "num_only_roped": 470586, "total_diff": 941172, "diff_percentage": 0.40821237390451226, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:20.522703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.0073184967041016e-05, "l2_diff": 0.16015625, "l2_diff_relative": 0.021443514644351465}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:37.425418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49061061451153276, "overlap_percentage": 0.6582679738562092, "num_intersection": 20143, "num_union": 41057, "num_only_computed": 10457, "num_only_roped": 10457, "total_diff": 20914, "diff_percentage": 0.5093893854884672, "num_computed": 30600, "num_roped": 30600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "mask_shape": [1, 32, 17, 3089], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:37.941769", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.377696990966797e-06, "l2_diff": 0.0198974609375, "l2_diff_relative": 0.017444349315068493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "attention_shape": [1, 32, 17, 3089]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:54.109965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4930081558318157, "overlap_percentage": 0.6604225889940175, "num_intersection": 31131, "num_union": 63145, "num_only_computed": 16007, "num_only_roped": 16007, "total_diff": 32014, "diff_percentage": 0.5069918441681843, "num_computed": 47138, "num_roped": 47138}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "mask_shape": [1, 32, 26, 3115], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:01:54.629556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.028391768292682928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "attention_shape": [1, 32, 26, 3115]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:10.064949", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4796084828711256, "overlap_percentage": 0.6482910694597575, "num_intersection": 1176, "num_union": 2452, "num_only_computed": 638, "num_only_roped": 638, "total_diff": 1276, "diff_percentage": 0.5203915171288744, "num_computed": 1814, "num_roped": 1814}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "mask_shape": [1, 32, 1, 3116], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:10.529704", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.0174560546875, "l2_diff_relative": 0.053840361445783136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "attention_shape": [1, 32, 1, 3116]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:25.112817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47840260798696005, "overlap_percentage": 0.6471885336273429, "num_intersection": 1174, "num_union": 2454, "num_only_computed": 640, "num_only_roped": 640, "total_diff": 1280, "diff_percentage": 0.5215973920130399, "num_computed": 1814, "num_roped": 1814}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "mask_shape": [1, 32, 1, 3117], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:28.064257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.00823974609375, "l2_diff_relative": 0.04076086956521739}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "attention_shape": [1, 32, 1, 3117]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:42.583346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4870954526833265, "overlap_percentage": 0.6550964187327823, "num_intersection": 1189, "num_union": 2441, "num_only_computed": 626, "num_only_roped": 626, "total_diff": 1252, "diff_percentage": 0.5129045473166735, "num_computed": 1815, "num_roped": 1815}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3118, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3118, 128], "mask_shape": [1, 32, 1, 3118], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:43.039604", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.0081787109375, "l2_diff_relative": 0.033102766798418976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3118, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3118, 128], "attention_shape": [1, 32, 1, 3118]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:55.961390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:02:55.974972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.003087197580645161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:01.973300", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7327329096098139, "overlap_percentage": 0.8457540173053152, "num_intersection": 1094744, "num_union": 1494056, "num_only_computed": 215976, "num_only_roped": 183336, "total_diff": 399312, "diff_percentage": 0.2672670903901862, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:02.364156", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.4841556549072266e-05, "l2_diff": 0.216796875, "l2_diff_relative": 0.026682692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:17.686850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5941156106674103, "overlap_percentage": 0.7453858511788505, "num_intersection": 1367789, "num_union": 2302227, "num_only_computed": 467219, "num_only_roped": 467219, "total_diff": 934438, "diff_percentage": 0.4058843893325897, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:18.254138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.52587890625e-05, "l2_diff": 0.2294921875, "l2_diff_relative": 0.03009733606557377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:39.038238", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5193328396174776, "overlap_percentage": 0.6836327446831597, "num_intersection": 1612892, "num_union": 3105700, "num_only_computed": 746404, "num_only_roped": 746404, "total_diff": 1492808, "diff_percentage": 0.48066716038252244, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:03:39.788960", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.138448715209961e-05, "l2_diff": 0.234375, "l2_diff_relative": 0.029296875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:06.616905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48424168319993904, "overlap_percentage": 0.6525105563077059, "num_intersection": 1881569, "num_union": 3885599, "num_only_computed": 1002015, "num_only_roped": 1002015, "total_diff": 2004030, "diff_percentage": 0.5157583168000609, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:07.563736", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 9.953975677490234e-06, "l2_diff": 0.2373046875, "l2_diff_relative": 0.02977941176470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:40.582087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4667888749698443, "overlap_percentage": 0.6364772503192608, "num_intersection": 2169033, "num_union": 4646711, "num_only_computed": 1238839, "num_only_roped": 1238839, "total_diff": 2477678, "diff_percentage": 0.5332111250301558, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:04:41.713433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 6.735324859619141e-06, "l2_diff": 0.2060546875, "l2_diff_relative": 0.023549107142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:05:20.961465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45405169143113244, "overlap_percentage": 0.6245330810546875, "num_intersection": 2455764, "num_union": 5408556, "num_only_computed": 1476396, "num_only_roped": 1476396, "total_diff": 2952792, "diff_percentage": 0.5459483085688676, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:05:22.311842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 6.467103958129883e-06, "l2_diff": 0.2734375, "l2_diff_relative": 0.03147482014388489}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:06:08.125416", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4331580656883838, "overlap_percentage": 0.6044805190142464, "num_intersection": 2693836, "num_union": 6219060, "num_only_computed": 1762612, "num_only_roped": 1762612, "total_diff": 3525224, "diff_percentage": 0.5668419343116162, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:06:11.988334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 7.420778274536133e-06, "l2_diff": 0.28125, "l2_diff_relative": 0.03529411764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:07:05.566791", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4212502585979355, "overlap_percentage": 0.5927882947419819, "num_intersection": 2952522, "num_union": 7008950, "num_only_computed": 2028214, "num_only_roped": 2028214, "total_diff": 4056428, "diff_percentage": 0.5787497414020645, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:07:08.491337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.1834763948497854}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:08:07.686450", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39259813916307873, "overlap_percentage": 0.5638355073474702, "num_intersection": 3103928, "num_union": 7906120, "num_only_computed": 2401096, "num_only_roped": 2401096, "total_diff": 4802192, "diff_percentage": 0.6074018608369213, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:08:09.732762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.47419354838709676}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:09:16.873822", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37211857777221485, "overlap_percentage": 0.5424000283946162, "num_intersection": 3270299, "num_union": 8788325, "num_only_computed": 2759013, "num_only_roped": 2759013, "total_diff": 5518026, "diff_percentage": 0.6278814222277852, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:09:19.159051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.602836608886719e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.4588235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:10:33.828993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3509947754498918, "overlap_percentage": 0.519609375, "num_intersection": 3405312, "num_union": 9701888, "num_only_computed": 3148288, "num_only_roped": 3148288, "total_diff": 6296576, "diff_percentage": 0.6490052245501082, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:10:36.384604", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.078315734863281e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.3975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:11:58.720962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3500509853544426, "overlap_percentage": 0.5185744674117477, "num_intersection": 3670412, "num_union": 10485364, "num_only_computed": 3407476, "num_only_roped": 3407476, "total_diff": 6814952, "diff_percentage": 0.6499490146455573, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:12:01.551761", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.57763671875e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.3548387096774194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:13:33.217125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34608323106324124, "overlap_percentage": 0.5142077741951778, "num_intersection": 3909098, "num_union": 11295254, "num_only_computed": 3693078, "num_only_roped": 3693078, "total_diff": 7386156, "diff_percentage": 0.6539167689367588, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:13:36.920661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.4473684210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:15:17.767136", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3322755741401157, "overlap_percentage": 0.498809076124622, "num_intersection": 4053554, "num_union": 12199374, "num_only_computed": 4072910, "num_only_roped": 4072910, "total_diff": 8145820, "diff_percentage": 0.6677244258598843, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:15:21.121088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 5.364418029785156e-05, "l2_diff": 3.125, "l2_diff_relative": 0.6097560975609756}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:17:09.338150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32016711166325196, "overlap_percentage": 0.4850402783627595, "num_intersection": 3323528, "num_union": 10380604, "num_only_computed": 3528538, "num_only_roped": 3528538, "total_diff": 7057076, "diff_percentage": 0.679832888336748, "num_computed": 6852066, "num_roped": 6852066}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "mask_shape": [1, 32, 821, 16181], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:17:12.862722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 4.506111145019531e-05, "l2_diff": 2.609375, "l2_diff_relative": 0.48546511627906974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "attention_shape": [1, 32, 821, 16181]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:18:58.277018", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29387854058877844, "overlap_percentage": 0.4542598572738508, "num_intersection": 113942, "num_union": 387718, "num_only_computed": 136888, "num_only_roped": 136888, "total_diff": 273776, "diff_percentage": 0.7061214594112215, "num_computed": 250830, "num_roped": 250830}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "mask_shape": [1, 32, 30, 16211], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:19:01.544382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.86102294921875e-05, "l2_diff": 0.1611328125, "l2_diff_relative": 0.13658940397350994}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "attention_shape": [1, 32, 30, 16211]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:20:31.986909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30188385489646585, "overlap_percentage": 0.46376464960535757, "num_intersection": 3878, "num_union": 12846, "num_only_computed": 4484, "num_only_roped": 4484, "total_diff": 8968, "diff_percentage": 0.6981161451035341, "num_computed": 8362, "num_roped": 8362}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "mask_shape": [1, 32, 1, 16212], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:20:34.631079", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0118408203125, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.1610054347826087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "attention_shape": [1, 32, 1, 16212]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:21.282017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:21.295685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:27.251698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7341094669998057, "overlap_percentage": 0.8466702719406675, "num_intersection": 1095930, "num_union": 1492870, "num_only_computed": 214790, "num_only_roped": 182150, "total_diff": 396940, "diff_percentage": 0.2658905330001943, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:27.641619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.761882781982422e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.018120659722222224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:42.520066", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6018869884568614, "overlap_percentage": 0.7514724731445312, "num_intersection": 1378958, "num_union": 2291058, "num_only_computed": 456050, "num_only_roped": 456050, "total_diff": 912100, "diff_percentage": 0.3981130115431386, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:21:43.084217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 8.881092071533203e-06, "l2_diff": 0.1748046875, "l2_diff_relative": 0.019288793103448276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:22:04.142878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.533710916486949, "overlap_percentage": 0.6959732903374566, "num_intersection": 1642007, "num_union": 3076585, "num_only_computed": 717289, "num_only_roped": 717289, "total_diff": 1434578, "diff_percentage": 0.466289083513051, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:22:07.629920", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.063150405883789e-06, "l2_diff": 0.2431640625, "l2_diff_relative": 0.023579545454545454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:22:35.443345", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4857646918190774, "overlap_percentage": 0.6538918235085227, "num_intersection": 1885552, "num_union": 3881616, "num_only_computed": 998032, "num_only_roped": 998032, "total_diff": 1996064, "diff_percentage": 0.5142353081809226, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:22:36.370148", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.692243576049805e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.018581081081081082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:23:08.808681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4740424906111688, "overlap_percentage": 0.643187009371244, "num_intersection": 2191899, "num_union": 4623845, "num_only_computed": 1215973, "num_only_roped": 1215973, "total_diff": 2431946, "diff_percentage": 0.5259575093888311, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:23:09.926181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.01927463503649635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:23:48.405436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46020590219283775, "overlap_percentage": 0.6303301493326823, "num_intersection": 2478559, "num_union": 5385761, "num_only_computed": 1453601, "num_only_roped": 1453601, "total_diff": 2907202, "diff_percentage": 0.5397940978071623, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:23:49.728402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.781650543212891e-06, "l2_diff": 0.275390625, "l2_diff_relative": 0.03102992957746479}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:24:35.300287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4418482532855289, "overlap_percentage": 0.6128914776970359, "num_intersection": 2731319, "num_union": 6181577, "num_only_computed": 1725129, "num_only_roped": 1725129, "total_diff": 3450258, "diff_percentage": 0.5581517467144711, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:24:36.836815", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.7220458984375e-06, "l2_diff": 0.251953125, "l2_diff_relative": 0.029641544117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:25:31.411915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4082147860494244, "overlap_percentage": 0.5797621074475741, "num_intersection": 2887642, "num_union": 7073830, "num_only_computed": 2093094, "num_only_roped": 2093094, "total_diff": 4186188, "diff_percentage": 0.5917852139505756, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:25:35.601054", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 3.4332275390625e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.2076923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:26:34.737002", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3810560328742586, "overlap_percentage": 0.5518328348795573, "num_intersection": 3037853, "num_union": 7972195, "num_only_computed": 2467171, "num_only_roped": 2467171, "total_diff": 4934342, "diff_percentage": 0.6189439671257414, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:26:36.754957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.3558139534883721}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:27:43.901296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3724912044119587, "overlap_percentage": 0.5427957617718241, "num_intersection": 3272685, "num_union": 8785939, "num_only_computed": 2756627, "num_only_roped": 2756627, "total_diff": 5513254, "diff_percentage": 0.6275087955880413, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:27:46.245375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 6.008148193359375e-05, "l2_diff": 2.953125, "l2_diff_relative": 0.49476439790575916}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:29:02.383862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3620237574801313, "overlap_percentage": 0.5315968322753907, "num_intersection": 3483873, "num_union": 9623327, "num_only_computed": 3069727, "num_only_roped": 3069727, "total_diff": 6139454, "diff_percentage": 0.6379762425198686, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:29:05.851004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 5.745887756347656e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.5105820105820106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:30:29.769226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35680007115741114, "overlap_percentage": 0.5259434735333478, "num_intersection": 3722569, "num_union": 10433207, "num_only_computed": 3355319, "num_only_roped": 3355319, "total_diff": 6710638, "diff_percentage": 0.6431999288425888, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:30:32.653831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.46766169154228854}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:32:05.544500", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3494208071007499, "overlap_percentage": 0.5178826430748249, "num_intersection": 3937035, "num_union": 11267317, "num_only_computed": 3665141, "num_only_roped": 3665141, "total_diff": 7330282, "diff_percentage": 0.6505791928992501, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:32:08.672328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.4396984924623116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:33:49.800135", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3515120112804729, "overlap_percentage": 0.5201759338378906, "num_intersection": 4227191, "num_union": 12025737, "num_only_computed": 3899273, "num_only_roped": 3899273, "total_diff": 7798546, "diff_percentage": 0.6484879887195272, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:33:55.154425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.124641418457031e-05, "l2_diff": 2.625, "l2_diff_relative": 0.42857142857142855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:35:43.100498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34613510133977315, "overlap_percentage": 0.5142650258436525, "num_intersection": 4173236, "num_union": 12056668, "num_only_computed": 3941716, "num_only_roped": 3941716, "total_diff": 7883432, "diff_percentage": 0.6538648986602269, "num_computed": 8114952, "num_roped": 8114952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:35:46.672349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.9140625, "l2_diff_relative": 0.31572164948453607}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:37:32.259575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3144759408004527, "overlap_percentage": 0.4784810905081336, "num_intersection": 108920, "num_union": 346354, "num_only_computed": 118717, "num_only_roped": 118717, "total_diff": 237434, "diff_percentage": 0.6855240591995473, "num_computed": 227637, "num_roped": 227637}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 27, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:37:35.532496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.1376953125, "l2_diff_relative": 0.11084905660377359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 27, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:39:06.852684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31739707835325365, "overlap_percentage": 0.48185483870967744, "num_intersection": 4063, "num_union": 12801, "num_only_computed": 4369, "num_only_roped": 4369, "total_diff": 8738, "diff_percentage": 0.6826029216467463, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:39:09.462897", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.24671052631578946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:40:30.512670", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2965326362727762, "overlap_percentage": 0.45742409867172673, "num_intersection": 3857, "num_union": 13007, "num_only_computed": 4575, "num_only_roped": 4575, "total_diff": 9150, "diff_percentage": 0.7034673637272238, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:40:33.152413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.024658203125, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.2032967032967033}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:41:54.401377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30723918772283365, "overlap_percentage": 0.47005810506344126, "num_intersection": 3964, "num_union": 12902, "num_only_computed": 4469, "num_only_roped": 4469, "total_diff": 8938, "diff_percentage": 0.6927608122771663, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:41:57.042806", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.14767932489451477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:18.372929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3224086561078877, "overlap_percentage": 0.48760820585793907, "num_intersection": 4112, "num_union": 12754, "num_only_computed": 4321, "num_only_roped": 4321, "total_diff": 8642, "diff_percentage": 0.6775913438921123, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:43:21.047419", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037353515625, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.050048828125, "l2_diff_relative": 0.16015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:08.704918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:08.718553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.003022989649681529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:14.697589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7302464973001658, "overlap_percentage": 0.8440953337453646, "num_intersection": 1092597, "num_union": 1496203, "num_only_computed": 218123, "num_only_roped": 185483, "total_diff": 403606, "diff_percentage": 0.26975350269983417, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:15.087567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.1324882507324219e-05, "l2_diff": 0.1845703125, "l2_diff_relative": 0.021875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:30.425490", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5855728191664243, "overlap_percentage": 0.738626207624163, "num_intersection": 1355385, "num_union": 2314631, "num_only_computed": 479623, "num_only_roped": 479623, "total_diff": 959246, "diff_percentage": 0.41442718083357566, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:30.977087", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.043081283569336e-05, "l2_diff": 0.1923828125, "l2_diff_relative": 0.021375868055555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:51.530501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5199984537776146, "overlap_percentage": 0.6842091878255209, "num_intersection": 1614252, "num_union": 3104340, "num_only_computed": 745044, "num_only_roped": 745044, "total_diff": 1490088, "diff_percentage": 0.48000154622238544, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:44:52.272329", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 8.463859558105469e-06, "l2_diff": 0.236328125, "l2_diff_relative": 0.026442307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:18.958367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48951340277650435, "overlap_percentage": 0.6572796214710582, "num_intersection": 1895321, "num_union": 3871847, "num_only_computed": 988263, "num_only_roped": 988263, "total_diff": 1976526, "diff_percentage": 0.5104865972234957, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:19.884674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 7.68899917602539e-06, "l2_diff": 0.1884765625, "l2_diff_relative": 0.023197115384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:52.548816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4575240663027282, "overlap_percentage": 0.6278099646935096, "num_intersection": 2139496, "num_union": 4676248, "num_only_computed": 1268376, "num_only_roped": 1268376, "total_diff": 2536752, "diff_percentage": 0.5424759336972719, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:45:53.676193", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 8.165836334228516e-06, "l2_diff": 0.248046875, "l2_diff_relative": 0.029181985294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:46:32.788802", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.445955919260695, "overlap_percentage": 0.6168319702148437, "num_intersection": 2425482, "num_union": 5438838, "num_only_computed": 1506678, "num_only_roped": 1506678, "total_diff": 3013356, "diff_percentage": 0.554044080739305, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:46:34.116832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.275390625, "l2_diff_relative": 0.029974489795918366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:47:19.191189", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.445165909836031, "overlap_percentage": 0.6160758523380055, "num_intersection": 2745510, "num_union": 6167386, "num_only_computed": 1710938, "num_only_roped": 1710938, "total_diff": 3421876, "diff_percentage": 0.554834090163969, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:47:23.264185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.231929779052734e-06, "l2_diff": 0.208984375, "l2_diff_relative": 0.024230072463768116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:48:16.656348", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4204203737463541, "overlap_percentage": 0.5919661270944696, "num_intersection": 2948427, "num_union": 7013045, "num_only_computed": 2032309, "num_only_roped": 2032309, "total_diff": 4064618, "diff_percentage": 0.5795796262536459, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:48:20.409187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.19042553191489361}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:49:19.813769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4042368229337785, "overlap_percentage": 0.5757388160342262, "num_intersection": 3169456, "num_union": 7840592, "num_only_computed": 2335568, "num_only_roped": 2335568, "total_diff": 4671136, "diff_percentage": 0.5957631770662215, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:49:21.854527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 6.29425048828125e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.5081081081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:50:29.090278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3961923135126661, "overlap_percentage": 0.5675325808317765, "num_intersection": 3421831, "num_union": 8636793, "num_only_computed": 2607481, "num_only_roped": 2607481, "total_diff": 5214962, "diff_percentage": 0.6038076864873339, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:50:31.381499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.5108695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:51:46.715856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3853803644487249, "overlap_percentage": 0.5563531494140626, "num_intersection": 3646116, "num_union": 9461084, "num_only_computed": 2907484, "num_only_roped": 2907484, "total_diff": 5814968, "diff_percentage": 0.6146196355512751, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:51:49.283513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.47297297297297297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:53:13.182424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37457138640088866, "overlap_percentage": 0.5450009946469907, "num_intersection": 3857456, "num_union": 10298320, "num_only_computed": 3220432, "num_only_roped": 3220432, "total_diff": 6440864, "diff_percentage": 0.6254286135991113, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:53:16.092184", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 5.054473876953125e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.4851190476190476}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:54:49.428389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3521395307391187, "overlap_percentage": 0.5208627108869881, "num_intersection": 3959690, "num_union": 11244662, "num_only_computed": 3642486, "num_only_roped": 3642486, "total_diff": 7284972, "diff_percentage": 0.6478604692608813, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:54:52.533834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 4.792213439941406e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.4460227272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:56:25.684960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.318487585149487, "overlap_percentage": 0.48311048012390295, "num_intersection": 187157, "num_union": 587643, "num_only_computed": 200243, "num_only_roped": 200243, "total_diff": 400486, "diff_percentage": 0.681512414850513, "num_computed": 387400, "num_roped": 387400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "mask_shape": [1, 32, 52, 14388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:56:28.529800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.2255859375, "l2_diff_relative": 0.1155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "attention_shape": [1, 32, 52, 14388]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:57:55.198113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31577014708776796, "overlap_percentage": 0.4799776735878544, "num_intersection": 107491, "num_union": 340409, "num_only_computed": 116459, "num_only_roped": 116459, "total_diff": 232918, "diff_percentage": 0.684229852912232, "num_computed": 223950, "num_roped": 223950}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "mask_shape": [1, 32, 30, 14418], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:57:58.001227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.10546875, "l2_diff_relative": 0.07336956521739131}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "attention_shape": [1, 32, 30, 14418]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:59:16.228432", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3135667781101531, "overlap_percentage": 0.4774279973208305, "num_intersection": 3564, "num_union": 11366, "num_only_computed": 3901, "num_only_roped": 3901, "total_diff": 7802, "diff_percentage": 0.6864332218898469, "num_computed": 7465, "num_roped": 7465}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "mask_shape": [1, 32, 1, 14419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T15:59:18.497874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008056640625, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.01422119140625, "l2_diff_relative": 0.0742984693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "attention_shape": [1, 32, 1, 14419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:00:28.094057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31675485008818344, "overlap_percentage": 0.48111438521296546, "num_intersection": 3592, "num_union": 11340, "num_only_computed": 3874, "num_only_roped": 3874, "total_diff": 7748, "diff_percentage": 0.6832451499118166, "num_computed": 7466, "num_roped": 7466}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "mask_shape": [1, 32, 1, 14420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:00:30.393178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.029296875, "l2_diff_relative": 0.13274336283185842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "attention_shape": [1, 32, 1, 14420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:01:41.240763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3148996125396266, "overlap_percentage": 0.47897133672649345, "num_intersection": 3576, "num_union": 11356, "num_only_computed": 3890, "num_only_roped": 3890, "total_diff": 7780, "diff_percentage": 0.6851003874603734, "num_computed": 7466, "num_roped": 7466}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "mask_shape": [1, 32, 1, 14421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:01:46.117768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.4483928680419922e-05, "l2_diff": 0.022705078125, "l2_diff_relative": 0.09262948207171315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "attention_shape": [1, 32, 1, 14421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:26.068555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:26.081179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:31.975200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7322807247635579, "overlap_percentage": 0.8454527194066749, "num_intersection": 1094354, "num_union": 1494446, "num_only_computed": 216366, "num_only_roped": 183726, "total_diff": 400092, "diff_percentage": 0.2677192752364421, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:32.363143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 8.52346420288086e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.018575174825174824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:47.648487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.590285348812621, "overlap_percentage": 0.7423640659877232, "num_intersection": 1362244, "num_union": 2307772, "num_only_computed": 472764, "num_only_roped": 472764, "total_diff": 945528, "diff_percentage": 0.409714651187379, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:02:48.198397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.569789886474609e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.01639187116564417}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:03:08.524310", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5177040578211939, "overlap_percentage": 0.6822200351291232, "num_intersection": 1609559, "num_union": 3109033, "num_only_computed": 749737, "num_only_roped": 749737, "total_diff": 1499474, "diff_percentage": 0.48229594217880606, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:03:09.257227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 7.927417755126953e-06, "l2_diff": 0.21875, "l2_diff_relative": 0.02464788732394366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:03:35.797897", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47812581054910763, "overlap_percentage": 0.6469352028586648, "num_intersection": 1865492, "num_union": 3901676, "num_only_computed": 1018092, "num_only_roped": 1018092, "total_diff": 2036184, "diff_percentage": 0.5218741894508924, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:03:36.719396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.5730342864990234e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.018729304635761588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:04:09.186706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47194273720364865, "overlap_percentage": 0.6412514906663161, "num_intersection": 2185303, "num_union": 4630441, "num_only_computed": 1222569, "num_only_roped": 1222569, "total_diff": 2445138, "diff_percentage": 0.5280572627963513, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:04:10.306973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.4836273193359375e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.021634615384615384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:04:49.754084", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4541616564786423, "overlap_percentage": 0.6246370951334635, "num_intersection": 2456173, "num_union": 5408147, "num_only_computed": 1475987, "num_only_roped": 1475987, "total_diff": 2951974, "diff_percentage": 0.5458383435213577, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:04:51.075101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 6.943941116333008e-06, "l2_diff": 0.29296875, "l2_diff_relative": 0.033967391304347824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:05:35.951451", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43984323570297174, "overlap_percentage": 0.6109598945168888, "num_intersection": 2722711, "num_union": 6190185, "num_only_computed": 1733737, "num_only_roped": 1733737, "total_diff": 3467474, "diff_percentage": 0.5601567642970283, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:05:39.434688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.2734375, "l2_diff_relative": 0.03102836879432624}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:06:32.920866", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40814869662300635, "overlap_percentage": 0.5796954506321957, "num_intersection": 2887310, "num_union": 7074162, "num_only_computed": 2093426, "num_only_roped": 2093426, "total_diff": 4186852, "diff_percentage": 0.5918513033769937, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:06:36.425802", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.8984375, "l2_diff_relative": 0.23011363636363635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:07:36.360783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40710178170770545, "overlap_percentage": 0.5786387125651041, "num_intersection": 3185420, "num_union": 7824628, "num_only_computed": 2319604, "num_only_roped": 2319604, "total_diff": 4639208, "diff_percentage": 0.5928982182922945, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:07:38.419982", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 6.914138793945312e-05, "l2_diff": 3.40625, "l2_diff_relative": 0.545}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:08:46.541702", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3949041321983271, "overlap_percentage": 0.5662097101626189, "num_intersection": 3413855, "num_union": 8644769, "num_only_computed": 2615457, "num_only_roped": 2615457, "total_diff": 5230914, "diff_percentage": 0.6050958678016729, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:08:48.848794", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.2479248046875e-05, "l2_diff": 3.546875, "l2_diff_relative": 0.6522988505747126}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:10:08.016101", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3726906693437933, "overlap_percentage": 0.5430075073242188, "num_intersection": 3558654, "num_union": 9548546, "num_only_computed": 2994946, "num_only_roped": 2994946, "total_diff": 5989892, "diff_percentage": 0.6273093306562068, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:10:10.590506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 5.888938903808594e-05, "l2_diff": 3.109375, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:11:34.011323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36186876441644983, "overlap_percentage": 0.5314297146267362, "num_intersection": 3761400, "num_union": 10394376, "num_only_computed": 3316488, "num_only_roped": 3316488, "total_diff": 6632976, "diff_percentage": 0.6381312355835502, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:11:36.855050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 5.888938903808594e-05, "l2_diff": 3.109375, "l2_diff_relative": 0.5407608695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:13:09.066376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3526571882124666, "overlap_percentage": 0.5214287718804825, "num_intersection": 3381646, "num_union": 9589046, "num_only_computed": 3103700, "num_only_roped": 3103700, "total_diff": 6207400, "diff_percentage": 0.6473428117875334, "num_computed": 6485346, "num_roped": 6485346}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:13:12.084768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.817413330078125e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.5411392405063291}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:14:41.228438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33061859363667345, "overlap_percentage": 0.49693968687611645, "num_intersection": 113505, "num_union": 343311, "num_only_computed": 114903, "num_only_roped": 114903, "total_diff": 229806, "diff_percentage": 0.6693814063633265, "num_computed": 228408, "num_roped": 228408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 31, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:14:44.937729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.1865234375, "l2_diff_relative": 0.16023489932885907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 31, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:16:02.050300", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33762933381738974, "overlap_percentage": 0.5048174786266794, "num_intersection": 3720, "num_union": 11018, "num_only_computed": 3649, "num_only_roped": 3649, "total_diff": 7298, "diff_percentage": 0.6623706661826103, "num_computed": 7369, "num_roped": 7369}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:16:05.099179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.30594405594405594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:17:14.669480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3353266286128477, "overlap_percentage": 0.5022391097842313, "num_intersection": 3701, "num_union": 11037, "num_only_computed": 3668, "num_only_roped": 3668, "total_diff": 7336, "diff_percentage": 0.6646733713871523, "num_computed": 7369, "num_roped": 7369}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:17:18.210631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021728515625, "mean_diff": 3.528594970703125e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.2772727272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:18:27.058320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3373253493013972, "overlap_percentage": 0.5044776119402985, "num_intersection": 3718, "num_union": 11022, "num_only_computed": 3652, "num_only_roped": 3652, "total_diff": 7304, "diff_percentage": 0.6626746506986028, "num_computed": 7370, "num_roped": 7370}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:18:29.347144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.2633333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:19:38.389016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32816723734006126, "overlap_percentage": 0.49416553595658075, "num_intersection": 3642, "num_union": 11098, "num_only_computed": 3728, "num_only_roped": 3728, "total_diff": 7456, "diff_percentage": 0.6718327626599387, "num_computed": 7370, "num_roped": 7370}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "mask_shape": [1, 32, 1, 14229], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:19:40.613935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.18472906403940886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "attention_shape": [1, 32, 1, 14229]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:20:20.689923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:20:20.702533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.003142528044871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:20:26.731856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7379208859314874, "overlap_percentage": 0.849199629171817, "num_intersection": 1099204, "num_union": 1489596, "num_only_computed": 211516, "num_only_roped": 178876, "total_diff": 390392, "diff_percentage": 0.26207911406851253, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:20:27.129878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.4781951904296875e-05, "l2_diff": 0.2294921875, "l2_diff_relative": 0.026999080882352942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:20:44.378421", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6063602835935742, "overlap_percentage": 0.7549492972237724, "num_intersection": 1385338, "num_union": 2284678, "num_only_computed": 449670, "num_only_roped": 449670, "total_diff": 899340, "diff_percentage": 0.39363971640642575, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:20:44.935437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.2373046875, "l2_diff_relative": 0.0289837786259542}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:21:06.445531", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5317895731913971, "overlap_percentage": 0.6943376329210069, "num_intersection": 1638148, "num_union": 3080444, "num_only_computed": 721148, "num_only_roped": 721148, "total_diff": 1442296, "diff_percentage": 0.4682104268086029, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:21:07.201386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.33514404296875e-05, "l2_diff": 0.255859375, "l2_diff_relative": 0.03288152610441767}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:21:34.082689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49305337477965355, "overlap_percentage": 0.6604631597345526, "num_intersection": 1904501, "num_union": 3862667, "num_only_computed": 979083, "num_only_roped": 979083, "total_diff": 1958166, "diff_percentage": 0.5069466252203465, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:21:35.012304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.0073184967041016e-05, "l2_diff": 0.2353515625, "l2_diff_relative": 0.028966346153846155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:22:07.612104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46897904492516135, "overlap_percentage": 0.6385101905235877, "num_intersection": 2175961, "num_union": 4639783, "num_only_computed": 1231911, "num_only_roped": 1231911, "total_diff": 2463822, "diff_percentage": 0.5310209550748386, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:22:08.731961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 9.357929229736328e-06, "l2_diff": 0.265625, "l2_diff_relative": 0.03483606557377049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:22:47.305010", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45650767969098993, "overlap_percentage": 0.6268524169921875, "num_intersection": 2464884, "num_union": 5399436, "num_only_computed": 1467276, "num_only_roped": 1467276, "total_diff": 2934552, "diff_percentage": 0.5434923203090101, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:22:49.781289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 9.119510650634766e-06, "l2_diff": 0.318359375, "l2_diff_relative": 0.044293478260869566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:23:34.550313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4351345585174773, "overlap_percentage": 0.6064024532542509, "num_intersection": 2702401, "num_union": 6210495, "num_only_computed": 1754047, "num_only_roped": 1754047, "total_diff": 3508094, "diff_percentage": 0.5648654414825227, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:23:36.146127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 8.940696716308594e-06, "l2_diff": 0.3203125, "l2_diff_relative": 0.044372294372294376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:24:28.443614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4119049083658879, "overlap_percentage": 0.5834740086605674, "num_intersection": 2906130, "num_union": 7055342, "num_only_computed": 2074606, "num_only_roped": 2074606, "total_diff": 4149212, "diff_percentage": 0.5880950916341121, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:24:30.232080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.22247706422018348}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:25:29.758796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39302647156283604, "overlap_percentage": 0.564277103969029, "num_intersection": 3106359, "num_union": 7903689, "num_only_computed": 2398665, "num_only_roped": 2398665, "total_diff": 4797330, "diff_percentage": 0.606973528437164, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:25:31.783862", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.32547169811320753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:26:40.149514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.380296548086503, "overlap_percentage": 0.5510360054347826, "num_intersection": 3322368, "num_union": 8736256, "num_only_computed": 2706944, "num_only_roped": 2706944, "total_diff": 5413888, "diff_percentage": 0.6197034519134971, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:26:44.064396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.9591064453125e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.3941176470588235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:27:58.802788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37609699199257524, "overlap_percentage": 0.5466140747070313, "num_intersection": 3582290, "num_union": 9524910, "num_only_computed": 2971310, "num_only_roped": 2971310, "total_diff": 5942620, "diff_percentage": 0.6239030080074247, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:28:01.373209", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.246566772460938e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.5808383233532934}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:29:24.314434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37055779176757697, "overlap_percentage": 0.5407401190863715, "num_intersection": 3827298, "num_union": 10328478, "num_only_computed": 3250590, "num_only_roped": 3250590, "total_diff": 6501180, "diff_percentage": 0.629442208232423, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:29:27.176983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.673004150390625e-05, "l2_diff": 1.9765625, "l2_diff_relative": 0.36142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:30:59.706613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37654894385541393, "overlap_percentage": 0.5470912538725754, "num_intersection": 4159084, "num_union": 11045268, "num_only_computed": 3443092, "num_only_roped": 3443092, "total_diff": 6886184, "diff_percentage": 0.6234510561445861, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:31:02.812007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10693359375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.434640522875817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:44.918236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3534479140504721, "overlap_percentage": 0.5222925986013105, "num_intersection": 4244392, "num_union": 12008536, "num_only_computed": 3882072, "num_only_roped": 3882072, "total_diff": 7764144, "diff_percentage": 0.646552085949528, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:32:48.273108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.6253204345703125e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.40683229813664595}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:34:32.410596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33743336229071996, "overlap_percentage": 0.5045983924204989, "num_intersection": 1975919, "num_union": 5855731, "num_only_computed": 1939906, "num_only_roped": 1939906, "total_diff": 3879812, "diff_percentage": 0.66256663770928, "num_computed": 3915825, "num_roped": 3915825}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "mask_shape": [1, 32, 479, 15839], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:34:36.860203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.94921875, "l2_diff_relative": 0.2748868778280543}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "attention_shape": [1, 32, 479, 15839]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:36:19.149474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3348563312953565, "overlap_percentage": 0.501711417842861, "num_intersection": 193336, "num_union": 577370, "num_only_computed": 192017, "num_only_roped": 192017, "total_diff": 384034, "diff_percentage": 0.6651436687046435, "num_computed": 385353, "num_roped": 385353}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 47, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:36:22.331213", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.1962890625, "l2_diff_relative": 0.1350806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 47, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:37:51.145207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35958875715114835, "overlap_percentage": 0.5289669471886815, "num_intersection": 4337, "num_union": 12061, "num_only_computed": 3862, "num_only_roped": 3862, "total_diff": 7724, "diff_percentage": 0.6404112428488516, "num_computed": 8199, "num_roped": 8199}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "mask_shape": [1, 32, 1, 15887], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:37:53.663395", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.21385542168674698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "attention_shape": [1, 32, 1, 15887]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:39:12.221752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3449237329834345, "overlap_percentage": 0.5129268292682927, "num_intersection": 4206, "num_union": 12194, "num_only_computed": 3994, "num_only_roped": 3994, "total_diff": 7988, "diff_percentage": 0.6550762670165655, "num_computed": 8200, "num_roped": 8200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "mask_shape": [1, 32, 1, 15888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:39:16.733701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020751953125, "mean_diff": 4.4345855712890625e-05, "l2_diff": 0.037109375, "l2_diff_relative": 0.3206751054852321}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "attention_shape": [1, 32, 1, 15888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:40:36.472069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33746534007502854, "overlap_percentage": 0.5046341463414634, "num_intersection": 4138, "num_union": 12262, "num_only_computed": 4062, "num_only_roped": 4062, "total_diff": 8124, "diff_percentage": 0.6625346599249714, "num_computed": 8200, "num_roped": 8200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "mask_shape": [1, 32, 1, 15889], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:40:40.270411", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0189208984375, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.2610759493670886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "attention_shape": [1, 32, 1, 15889]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:24.554533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:24.567137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0031754032258064515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:30.510410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7357279155307688, "overlap_percentage": 0.847745673671199, "num_intersection": 1097322, "num_union": 1491478, "num_only_computed": 213398, "num_only_roped": 180758, "total_diff": 394156, "diff_percentage": 0.26427208446923117, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:33.364050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.1265277862548828e-05, "l2_diff": 0.197265625, "l2_diff_relative": 0.022384751773049646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:48.104635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5851982007430963, "overlap_percentage": 0.738328116280692, "num_intersection": 1354838, "num_union": 2315178, "num_only_computed": 480170, "num_only_roped": 480170, "total_diff": 960340, "diff_percentage": 0.4148017992569038, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:41:48.653683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.150369644165039e-05, "l2_diff": 0.19921875, "l2_diff_relative": 0.02139261744966443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:09.067611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5269684192131825, "overlap_percentage": 0.6902152167426215, "num_intersection": 1628422, "num_union": 3090170, "num_only_computed": 730874, "num_only_roped": 730874, "total_diff": 1461748, "diff_percentage": 0.47303158078681756, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:09.816814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 7.539987564086914e-06, "l2_diff": 0.228515625, "l2_diff_relative": 0.023140822784810125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:36.201785", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4862731838461475, "overlap_percentage": 0.6543523615056818, "num_intersection": 1886880, "num_union": 3880288, "num_only_computed": 996704, "num_only_roped": 996704, "total_diff": 1993408, "diff_percentage": 0.5137268161538525, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:42:37.138902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.1923828125, "l2_diff_relative": 0.020658557046979865}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:43:09.613584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4617010713324476, "overlap_percentage": 0.6317311800443209, "num_intersection": 2152859, "num_union": 4662885, "num_only_computed": 1255013, "num_only_roped": 1255013, "total_diff": 2510026, "diff_percentage": 0.5382989286675524, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:43:12.216133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.794929504394531e-06, "l2_diff": 0.208984375, "l2_diff_relative": 0.022902397260273974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:43:50.629177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4594490469985083, "overlap_percentage": 0.629619852701823, "num_intersection": 2475766, "num_union": 5388554, "num_only_computed": 1456394, "num_only_roped": 1456394, "total_diff": 2912788, "diff_percentage": 0.5405509530014917, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:43:53.996553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 6.407499313354492e-06, "l2_diff": 0.2890625, "l2_diff_relative": 0.03400735294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:44:38.993298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4490426257290413, "overlap_percentage": 0.6197783526252297, "num_intersection": 2762010, "num_union": 6150886, "num_only_computed": 1694438, "num_only_roped": 1694438, "total_diff": 3388876, "diff_percentage": 0.5509573742709587, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:44:40.539947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 6.079673767089844e-06, "l2_diff": 0.251953125, "l2_diff_relative": 0.03161764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:45:32.932763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4301478864504036, "overlap_percentage": 0.6015432257401315, "num_intersection": 2996128, "num_union": 6965344, "num_only_computed": 1984608, "num_only_roped": 1984608, "total_diff": 3969216, "diff_percentage": 0.5698521135495964, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:45:34.693531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 2.849102020263672e-05, "l2_diff": 1.4140625, "l2_diff_relative": 0.16276978417266186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:46:34.328851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.395890774115049, "overlap_percentage": 0.567223140171596, "num_intersection": 3122577, "num_union": 7887471, "num_only_computed": 2382447, "num_only_roped": 2382447, "total_diff": 4764894, "diff_percentage": 0.604109225884951, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:46:36.381012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 6.866455078125e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.5398009950248757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:47:44.842506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38643040239238274, "overlap_percentage": 0.557446521261464, "num_intersection": 3361019, "num_union": 8697605, "num_only_computed": 2668293, "num_only_roped": 2668293, "total_diff": 5336586, "diff_percentage": 0.6135695976076173, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:47:49.402986", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 6.866455078125e-05, "l2_diff": 3.546875, "l2_diff_relative": 0.6102150537634409}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:49:04.348533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3976645165830839, "overlap_percentage": 0.5690414428710937, "num_intersection": 3729270, "num_union": 9377930, "num_only_computed": 2824330, "num_only_roped": 2824330, "total_diff": 5648660, "diff_percentage": 0.6023354834169161, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:49:06.922613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.626678466796875e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.49516908212560384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:50:29.392902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37225482892347156, "overlap_percentage": 0.54254475346318, "num_intersection": 3840071, "num_union": 10315705, "num_only_computed": 3237817, "num_only_roped": 3237817, "total_diff": 6475634, "diff_percentage": 0.6277451710765285, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:50:32.188604", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 5.984306335449219e-05, "l2_diff": 3.328125, "l2_diff_relative": 0.6339285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:51:59.431061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3624947717383194, "overlap_percentage": 0.5321044590517373, "num_intersection": 1909277, "num_union": 5267047, "num_only_computed": 1678885, "num_only_roped": 1678885, "total_diff": 3357770, "diff_percentage": 0.6375052282616805, "num_computed": 3588162, "num_roped": 3588162}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "mask_shape": [1, 32, 501, 13813], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:52:02.250844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.745887756347656e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4963235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "attention_shape": [1, 32, 501, 13813]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:26.177529", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34962672299774966, "overlap_percentage": 0.5181087733964981, "num_intersection": 111554, "num_union": 319066, "num_only_computed": 103756, "num_only_roped": 103756, "total_diff": 207512, "diff_percentage": 0.6503732770022503, "num_computed": 215310, "num_roped": 215310}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "mask_shape": [1, 32, 30, 13843], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:53:28.775831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.491474151611328e-05, "l2_diff": 0.12158203125, "l2_diff_relative": 0.097265625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "attention_shape": [1, 32, 30, 13843]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:42.427186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34281171078477224, "overlap_percentage": 0.510587907495124, "num_intersection": 3665, "num_union": 10691, "num_only_computed": 3513, "num_only_roped": 3513, "total_diff": 7026, "diff_percentage": 0.6571882892152278, "num_computed": 7178, "num_roped": 7178}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "mask_shape": [1, 32, 1, 13844], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:54:46.906764", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009033203125, "mean_diff": 1.436471939086914e-05, "l2_diff": 0.02197265625, "l2_diff_relative": 0.08272058823529412}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "attention_shape": [1, 32, 1, 13844]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:55:53.300218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35831204465890815, "overlap_percentage": 0.5275842853162441, "num_intersection": 3787, "num_union": 10569, "num_only_computed": 3391, "num_only_roped": 3391, "total_diff": 6782, "diff_percentage": 0.6416879553410919, "num_computed": 7178, "num_roped": 7178}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "mask_shape": [1, 32, 1, 13845], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:55:55.875792", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015380859375, "mean_diff": 1.3232231140136719e-05, "l2_diff": 0.0224609375, "l2_diff_relative": 0.07718120805369127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "attention_shape": [1, 32, 1, 13845]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:57:01.916806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34703067830002815, "overlap_percentage": 0.5152528207271208, "num_intersection": 3699, "num_union": 10659, "num_only_computed": 3480, "num_only_roped": 3480, "total_diff": 6960, "diff_percentage": 0.6529693216999719, "num_computed": 7179, "num_roped": 7179}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "mask_shape": [1, 32, 1, 13846], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:57:05.465679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.2695789337158203e-05, "l2_diff": 0.027587890625, "l2_diff_relative": 0.1031021897810219}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "attention_shape": [1, 32, 1, 13846]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:58:11.408999", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34981667763467145, "overlap_percentage": 0.5183173143891907, "num_intersection": 3721, "num_union": 10637, "num_only_computed": 3458, "num_only_roped": 3458, "total_diff": 6916, "diff_percentage": 0.6501833223653286, "num_computed": 7179, "num_roped": 7179}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "mask_shape": [1, 32, 1, 13847], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:58:15.004439", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "attention_shape": [1, 32, 1, 13847]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:59:21.251048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.357021357021357, "overlap_percentage": 0.526183844011142, "num_intersection": 3778, "num_union": 10582, "num_only_computed": 3402, "num_only_roped": 3402, "total_diff": 6804, "diff_percentage": 0.6429786429786429, "num_computed": 7180, "num_roped": 7180}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "mask_shape": [1, 32, 1, 13848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T16:59:24.211519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.056884765625, "l2_diff_relative": 0.20225694444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "attention_shape": [1, 32, 1, 13848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:00:30.638362", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3481036425084491, "overlap_percentage": 0.5164345403899722, "num_intersection": 3708, "num_union": 10652, "num_only_computed": 3472, "num_only_roped": 3472, "total_diff": 6944, "diff_percentage": 0.6518963574915508, "num_computed": 7180, "num_roped": 7180}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "mask_shape": [1, 32, 1, 13849], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:00:33.206731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.1287313432835821}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "attention_shape": [1, 32, 1, 13849]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:01:39.542105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3550334937258232, "overlap_percentage": 0.5240217239938727, "num_intersection": 3763, "num_union": 10599, "num_only_computed": 3418, "num_only_roped": 3418, "total_diff": 6836, "diff_percentage": 0.6449665062741768, "num_computed": 7181, "num_roped": 7181}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "mask_shape": [1, 32, 1, 13850], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:01:42.189766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.14592760180995476}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "attention_shape": [1, 32, 1, 13850]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:22.661837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:22.676579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003045333059210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:28.717698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7278421662100335, "overlap_percentage": 0.8424868665018541, "num_intersection": 1090515, "num_union": 1498285, "num_only_computed": 220205, "num_only_roped": 187565, "total_diff": 407770, "diff_percentage": 0.27215783378996655, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:29.109004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.150369644165039e-05, "l2_diff": 0.177734375, "l2_diff_relative": 0.021875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:44.471571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5854344568269072, "overlap_percentage": 0.738516126360212, "num_intersection": 1355183, "num_union": 2314833, "num_only_computed": 479825, "num_only_roped": 479825, "total_diff": 959650, "diff_percentage": 0.41456554317309285, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:02:45.036026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.2993812561035156e-05, "l2_diff": 0.2197265625, "l2_diff_relative": 0.028582317073170733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:03:05.666790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5102017040926516, "overlap_percentage": 0.675673590766059, "num_intersection": 1594114, "num_union": 3124478, "num_only_computed": 765182, "num_only_roped": 765182, "total_diff": 1530364, "diff_percentage": 0.48979829590734836, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:03:06.408476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.2578125, "l2_diff_relative": 0.03409090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:03:33.001941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4789449457176085, "overlap_percentage": 0.6476846174760298, "num_intersection": 1867653, "num_union": 3899515, "num_only_computed": 1015931, "num_only_roped": 1015931, "total_diff": 2031862, "diff_percentage": 0.5210550542823915, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:03:33.933303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.2177734375, "l2_diff_relative": 0.03056469298245614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:06.778115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4578941322904664, "overlap_percentage": 0.6281582758976862, "num_intersection": 2140683, "num_union": 4675061, "num_only_computed": 1267189, "num_only_roped": 1267189, "total_diff": 2534378, "diff_percentage": 0.5421058677095336, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:07.909252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 9.834766387939453e-06, "l2_diff": 0.26171875, "l2_diff_relative": 0.03722222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:47.609307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44802752024145576, "overlap_percentage": 0.6188107808430989, "num_intersection": 2433263, "num_union": 5431057, "num_only_computed": 1498897, "num_only_roped": 1498897, "total_diff": 2997794, "diff_percentage": 0.5519724797585442, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:04:48.905249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 6.943941116333008e-06, "l2_diff": 0.2578125, "l2_diff_relative": 0.03381147540983607}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:05:33.722646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44465994742562903, "overlap_percentage": 0.6155911613913143, "num_intersection": 2743350, "num_union": 6169546, "num_only_computed": 1713098, "num_only_roped": 1713098, "total_diff": 3426196, "diff_percentage": 0.5553400525743709, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:05:37.069478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.255859375, "l2_diff_relative": 0.03275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:06:29.250022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4386058099244223, "overlap_percentage": 0.6097651029887953, "num_intersection": 3037079, "num_union": 6924393, "num_only_computed": 1943657, "num_only_roped": 1943657, "total_diff": 3887314, "diff_percentage": 0.5613941900755778, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:06:32.339636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.17458677685950413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:07:31.699077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42212155327546363, "overlap_percentage": 0.5936504545665923, "num_intersection": 3268060, "num_union": 7741988, "num_only_computed": 2236964, "num_only_roped": 2236964, "total_diff": 4473928, "diff_percentage": 0.5778784467245364, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:07:33.710799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.47790055248618785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:08:41.006704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4044188571384647, "overlap_percentage": 0.5759234221085258, "num_intersection": 3472422, "num_union": 8586202, "num_only_computed": 2556890, "num_only_roped": 2556890, "total_diff": 5113780, "diff_percentage": 0.5955811428615353, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:08:43.283026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.09375, "l2_diff_relative": 0.5892857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:09:58.610286", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.382466412390389, "overlap_percentage": 0.5533102416992187, "num_intersection": 3626174, "num_union": 9481026, "num_only_computed": 2927426, "num_only_roped": 2927426, "total_diff": 5854852, "diff_percentage": 0.6175335876096111, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:10:02.475715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.246566772460938e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5254777070063694}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:11:25.512788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3702931124257331, "overlap_percentage": 0.540458255343967, "num_intersection": 3825303, "num_union": 10330473, "num_only_computed": 3252585, "num_only_roped": 3252585, "total_diff": 6505170, "diff_percentage": 0.629706887574267, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:11:28.328287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.46296296296296297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:13:00.312062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35634934589595624, "overlap_percentage": 0.5254536332755253, "num_intersection": 3994591, "num_union": 11209761, "num_only_computed": 3607585, "num_only_roped": 3607585, "total_diff": 7215170, "diff_percentage": 0.6436506541040438, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:13:03.379731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.3772189349112426}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:14:43.662957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34984190177645397, "overlap_percentage": 0.5183450022051411, "num_intersection": 4212312, "num_union": 12040616, "num_only_computed": 3914152, "num_only_roped": 3914152, "total_diff": 7828304, "diff_percentage": 0.6501580982235461, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:14:47.025863", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.875, "l2_diff_relative": 0.36809815950920244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:16:38.293306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3518025389189056, "overlap_percentage": 0.5204939756959728, "num_intersection": 4469767, "num_union": 12705329, "num_only_computed": 4117781, "num_only_roped": 4117781, "total_diff": 8235562, "diff_percentage": 0.6481974610810944, "num_computed": 8587548, "num_roped": 8587548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1017, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:16:42.536361", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 4.792213439941406e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.5065359477124183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1017, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:18:28.817449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32747530114241047, "overlap_percentage": 0.49338063142958494, "num_intersection": 104313, "num_union": 318537, "num_only_computed": 107112, "num_only_roped": 107112, "total_diff": 214224, "diff_percentage": 0.6725246988575896, "num_computed": 211425, "num_roped": 211425}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "mask_shape": [1, 32, 25, 16402], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:18:32.558755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.8133392333984375e-05, "l2_diff": 0.15625, "l2_diff_relative": 0.12987012987012986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "attention_shape": [1, 32, 25, 16402]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:20:03.860696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3134027022829632, "overlap_percentage": 0.477237791178905, "num_intersection": 4036, "num_union": 12878, "num_only_computed": 4421, "num_only_roped": 4421, "total_diff": 8842, "diff_percentage": 0.6865972977170368, "num_computed": 8457, "num_roped": 8457}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "mask_shape": [1, 32, 1, 16403], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:20:06.528040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.14549180327868852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "attention_shape": [1, 32, 1, 16403]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:21:28.570751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32249237745289655, "overlap_percentage": 0.4877039489240955, "num_intersection": 4125, "num_union": 12791, "num_only_computed": 4333, "num_only_roped": 4333, "total_diff": 8666, "diff_percentage": 0.6775076225471034, "num_computed": 8458, "num_roped": 8458}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "mask_shape": [1, 32, 1, 16404], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:21:31.198478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00732421875, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0185546875, "l2_diff_relative": 0.08260869565217391}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "attention_shape": [1, 32, 1, 16404]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:22:52.194069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3187806969673345, "overlap_percentage": 0.48344762355166704, "num_intersection": 4089, "num_union": 12827, "num_only_computed": 4369, "num_only_roped": 4369, "total_diff": 8738, "diff_percentage": 0.6812193030326654, "num_computed": 8458, "num_roped": 8458}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "mask_shape": [1, 32, 1, 16405], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:22:54.839111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0213623046875, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.039794921875, "l2_diff_relative": 0.18692660550458715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "attention_shape": [1, 32, 1, 16405]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:24:15.813453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31801184169523217, "overlap_percentage": 0.48256295070339283, "num_intersection": 4082, "num_union": 12836, "num_only_computed": 4377, "num_only_roped": 4377, "total_diff": 8754, "diff_percentage": 0.6819881583047679, "num_computed": 8459, "num_roped": 8459}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "mask_shape": [1, 32, 1, 16406], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:24:18.625310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.15248691099476439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "attention_shape": [1, 32, 1, 16406]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:25:40.625030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3160637884091793, "overlap_percentage": 0.4803168223194231, "num_intersection": 4063, "num_union": 12855, "num_only_computed": 4396, "num_only_roped": 4396, "total_diff": 8792, "diff_percentage": 0.6839362115908207, "num_computed": 8459, "num_roped": 8459}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "mask_shape": [1, 32, 1, 16407], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:25:43.668707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0301513671875, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.27461139896373055}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "attention_shape": [1, 32, 1, 16407]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:27:04.782164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3262266812980091, "overlap_percentage": 0.49196217494089833, "num_intersection": 4162, "num_union": 12758, "num_only_computed": 4298, "num_only_roped": 4298, "total_diff": 8596, "diff_percentage": 0.6737733187019909, "num_computed": 8460, "num_roped": 8460}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "mask_shape": [1, 32, 1, 16408], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:27:08.955405", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029052734375, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.17553191489361702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "attention_shape": [1, 32, 1, 16408]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:27:54.993455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:27:55.007137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1739473342895508e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0029779128086419755}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:28:00.964361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7397779310029664, "overlap_percentage": 0.8504279975278121, "num_intersection": 1100794, "num_union": 1488006, "num_only_computed": 209926, "num_only_roped": 177286, "total_diff": 387212, "diff_percentage": 0.2602220689970336, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:28:02.662783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 8.881092071533203e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.016819267515923567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:28:17.602911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6098390124141295, "overlap_percentage": 0.7576397487095424, "num_intersection": 1390275, "num_union": 2279741, "num_only_computed": 444733, "num_only_roped": 444733, "total_diff": 889466, "diff_percentage": 0.3901609875858705, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:28:18.152872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.794929504394531e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.015925480769230768}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:28:39.220772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5504639307708433, "overlap_percentage": 0.7100635104709201, "num_intersection": 1675250, "num_union": 3043342, "num_only_computed": 684046, "num_only_roped": 684046, "total_diff": 1368092, "diff_percentage": 0.4495360692291566, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:28:39.956817", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.0251998901367188e-05, "l2_diff": 0.240234375, "l2_diff_relative": 0.030627490039840638}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:29:06.362054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49677606889069986, "overlap_percentage": 0.6637947776100852, "num_intersection": 1914108, "num_union": 3853060, "num_only_computed": 969476, "num_only_roped": 969476, "total_diff": 1938952, "diff_percentage": 0.5032239311093002, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:29:07.285938", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 9.775161743164062e-06, "l2_diff": 0.2275390625, "l2_diff_relative": 0.02657390510948905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:29:39.771623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4688150617815525, "overlap_percentage": 0.6383581895094651, "num_intersection": 2175443, "num_union": 4640301, "num_only_computed": 1232429, "num_only_roped": 1232429, "total_diff": 2464858, "diff_percentage": 0.5311849382184475, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:29:40.928039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.25, "l2_diff_relative": 0.027777777777777776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:30:19.454014", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45769177301415187, "overlap_percentage": 0.6279678344726562, "num_intersection": 2469270, "num_union": 5395050, "num_only_computed": 1462890, "num_only_roped": 1462890, "total_diff": 2925780, "diff_percentage": 0.5423082269858481, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:30:23.393026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.2353515625, "l2_diff_relative": 0.024773848684210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:31:08.281836", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4394167718154612, "overlap_percentage": 0.6105483560001149, "num_intersection": 2720877, "num_union": 6192019, "num_only_computed": 1735571, "num_only_roped": 1735571, "total_diff": 3471142, "diff_percentage": 0.5605832281845389, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:31:09.819012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 6.22868537902832e-06, "l2_diff": 0.248046875, "l2_diff_relative": 0.032935684647302906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:32:01.675471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4093047622510402, "overlap_percentage": 0.5808605394865337, "num_intersection": 2893113, "num_union": 7068359, "num_only_computed": 2087623, "num_only_roped": 2087623, "total_diff": 4175246, "diff_percentage": 0.5906952377489598, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:32:03.449348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 3.218650817871094e-05, "l2_diff": 1.34375, "l2_diff_relative": 0.18859649122807018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:33:03.210478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39727982151446195, "overlap_percentage": 0.5686474754696801, "num_intersection": 3130418, "num_union": 7879630, "num_only_computed": 2374606, "num_only_roped": 2374606, "total_diff": 4749212, "diff_percentage": 0.602720178485538, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:33:05.243621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 5.793571472167969e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.4576719576719577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:34:12.975902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39500886151511083, "overlap_percentage": 0.5663173509680707, "num_intersection": 3414504, "num_union": 8644120, "num_only_computed": 2614808, "num_only_roped": 2614808, "total_diff": 5229616, "diff_percentage": 0.6049911384848892, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:34:17.397449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.46}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:35:31.876895", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3955653491958506, "overlap_percentage": 0.5668890380859375, "num_intersection": 3715164, "num_union": 9392036, "num_only_computed": 2838436, "num_only_roped": 2838436, "total_diff": 5676872, "diff_percentage": 0.6044346508041494, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:35:34.437608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 5.6743621826171875e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:36:57.802770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.392595046902942, "overlap_percentage": 0.5638323183412906, "num_intersection": 3990742, "num_union": 10165034, "num_only_computed": 3087146, "num_only_roped": 3087146, "total_diff": 6174292, "diff_percentage": 0.607404953097058, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:37:00.637888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.6253204345703125e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.38317757009345793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:38:31.775278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38236361613003883, "overlap_percentage": 0.5532026619746767, "num_intersection": 4205544, "num_union": 10998808, "num_only_computed": 3396632, "num_only_roped": 3396632, "total_diff": 6793264, "diff_percentage": 0.6176363838699612, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:38:34.848137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 4.291534423828125e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.3871794871794872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:40:17.430935", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37805826126821773, "overlap_percentage": 0.5486825512301537, "num_intersection": 4458849, "num_union": 11794079, "num_only_computed": 3667615, "num_only_roped": 3667615, "total_diff": 7335230, "diff_percentage": 0.6219417387317823, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:40:21.619771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.9765625, "l2_diff_relative": 0.3382352941176471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:42:02.292147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3577091324538121, "overlap_percentage": 0.5269304358398443, "num_intersection": 658760, "num_union": 1841608, "num_only_computed": 591424, "num_only_roped": 591424, "total_diff": 1182848, "diff_percentage": 0.6422908675461879, "num_computed": 1250184, "num_roped": 1250184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "mask_shape": [1, 32, 156, 15516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:42:05.464822", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.2026315789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "attention_shape": [1, 32, 156, 15516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:42.275771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35100496664133335, "overlap_percentage": 0.5196205422011874, "num_intersection": 125161, "num_union": 356579, "num_only_computed": 115709, "num_only_roped": 115709, "total_diff": 231418, "diff_percentage": 0.6489950333586667, "num_computed": 240870, "num_roped": 240870}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "mask_shape": [1, 32, 30, 15546], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:43:45.332083", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.1728515625, "l2_diff_relative": 0.1409235668789809}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "attention_shape": [1, 32, 30, 15546]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:10.893222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34726067623122747, "overlap_percentage": 0.5155062896998381, "num_intersection": 4139, "num_union": 11919, "num_only_computed": 3890, "num_only_roped": 3890, "total_diff": 7780, "diff_percentage": 0.6527393237687725, "num_computed": 8029, "num_roped": 8029}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "mask_shape": [1, 32, 1, 15547], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:45:13.367420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008544921875, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.0218505859375, "l2_diff_relative": 0.10654761904761904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "attention_shape": [1, 32, 1, 15547]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:29.275270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35940409683426444, "overlap_percentage": 0.5287671232876713, "num_intersection": 4246, "num_union": 11814, "num_only_computed": 3784, "num_only_roped": 3784, "total_diff": 7568, "diff_percentage": 0.6405959031657356, "num_computed": 8030, "num_roped": 8030}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "mask_shape": [1, 32, 1, 15548], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:46:32.849768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.0184326171875, "l2_diff_relative": 0.07149621212121213}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "attention_shape": [1, 32, 1, 15548]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:17.970813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:17.982341", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.0030976313694267518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:23.940240", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7317754846201907, "overlap_percentage": 0.8451158838071694, "num_intersection": 1093918, "num_union": 1494882, "num_only_computed": 216802, "num_only_roped": 184162, "total_diff": 400964, "diff_percentage": 0.26822451537980924, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:24.325308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 9.059906005859375e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.01916058394160584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:39.089188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6097627518313713, "overlap_percentage": 0.7575808933803013, "num_intersection": 1390167, "num_union": 2279849, "num_only_computed": 444841, "num_only_roped": 444841, "total_diff": 889682, "diff_percentage": 0.3902372481686287, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:47:39.652024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 9.5367431640625e-06, "l2_diff": 0.1806640625, "l2_diff_relative": 0.021898674242424244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:02.606138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5485497049001281, "overlap_percentage": 0.7084689670138888, "num_intersection": 1671488, "num_union": 3047104, "num_only_computed": 687808, "num_only_roped": 687808, "total_diff": 1375616, "diff_percentage": 0.4514502950998719, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:03.349707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 9.298324584960938e-06, "l2_diff": 0.2236328125, "l2_diff_relative": 0.027313931297709922}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:29.765187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5014678392718601, "overlap_percentage": 0.6679701371626421, "num_intersection": 1926148, "num_union": 3841020, "num_only_computed": 957436, "num_only_roped": 957436, "total_diff": 1914872, "diff_percentage": 0.49853216072813994, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:48:30.689634", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.0013580322265625e-05, "l2_diff": 0.21875, "l2_diff_relative": 0.026515151515151516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:03.166168", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47954457143477364, "overlap_percentage": 0.648232680100661, "num_intersection": 2209094, "num_union": 4606650, "num_only_computed": 1198778, "num_only_roped": 1198778, "total_diff": 2397556, "diff_percentage": 0.5204554285652263, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:05.919929", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.708766937255859e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.01961936090225564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:44.527354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4743928407116843, "overlap_percentage": 0.6435094197591146, "num_intersection": 2530382, "num_union": 5333938, "num_only_computed": 1401778, "num_only_roped": 1401778, "total_diff": 2803556, "diff_percentage": 0.5256071592883157, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:49:47.491266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.990266799926758e-06, "l2_diff": 0.2734375, "l2_diff_relative": 0.029166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:50:32.253075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4509833607888701, "overlap_percentage": 0.6216244417078355, "num_intersection": 2770237, "num_union": 6142659, "num_only_computed": 1686211, "num_only_roped": 1686211, "total_diff": 3372422, "diff_percentage": 0.5490166392111299, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:50:33.788538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.1904296875, "l2_diff_relative": 0.02101293103448276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:51:25.529220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4088268059558545, "overlap_percentage": 0.5803790845369038, "num_intersection": 2890715, "num_union": 7070757, "num_only_computed": 2090021, "num_only_roped": 2090021, "total_diff": 4180042, "diff_percentage": 0.5911731940441455, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:51:27.300228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09423828125, "mean_diff": 3.528594970703125e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.2153846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:52:27.551476", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38210159871175137, "overlap_percentage": 0.5529283796037946, "num_intersection": 3043884, "num_union": 7966164, "num_only_computed": 2461140, "num_only_roped": 2461140, "total_diff": 4922280, "diff_percentage": 0.6178984012882487, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:52:29.573752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 5.435943603515625e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.37628865979381443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:53:39.102393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3784178461238091, "overlap_percentage": 0.5490611532460088, "num_intersection": 3310461, "num_union": 8748163, "num_only_computed": 2718851, "num_only_roped": 2718851, "total_diff": 5437702, "diff_percentage": 0.6215821538761909, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:53:42.789204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 5.173683166503906e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.419811320754717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:54:57.885224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3716105949467694, "overlap_percentage": 0.5418601989746094, "num_intersection": 3551135, "num_union": 9556065, "num_only_computed": 3002465, "num_only_roped": 3002465, "total_diff": 6004930, "diff_percentage": 0.6283894050532306, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:55:00.483932", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.437301635742188e-05, "l2_diff": 3.265625, "l2_diff_relative": 0.6005747126436781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:56:23.630957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3599933132924253, "overlap_percentage": 0.529404534233941, "num_intersection": 3747066, "num_union": 10408710, "num_only_computed": 3330822, "num_only_roped": 3330822, "total_diff": 6661644, "diff_percentage": 0.6400066867075748, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:56:26.458949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 5.0067901611328125e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.4449760765550239}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:57:50.229304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3345419192045435, "overlap_percentage": 0.5013584277726516, "num_intersection": 254291, "num_union": 760117, "num_only_computed": 252913, "num_only_roped": 252913, "total_diff": 505826, "diff_percentage": 0.6654580807954565, "num_computed": 507204, "num_roped": 507204}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "mask_shape": [1, 32, 73, 13385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:57:55.525624", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.3515625, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "attention_shape": [1, 32, 73, 13385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:59:14.468032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33174745105978554, "overlap_percentage": 0.49821375786495503, "num_intersection": 117982, "num_union": 355638, "num_only_computed": 118828, "num_only_roped": 118828, "total_diff": 237656, "diff_percentage": 0.6682525489402145, "num_computed": 236810, "num_roped": 236810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "mask_shape": [1, 32, 34, 13419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T17:59:18.367195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04150390625, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.1669921875, "l2_diff_relative": 0.12723214285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "attention_shape": [1, 32, 34, 13419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:00:30.110038", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31906835826548, "overlap_percentage": 0.48377835199540625, "num_intersection": 3370, "num_union": 10562, "num_only_computed": 3596, "num_only_roped": 3596, "total_diff": 7192, "diff_percentage": 0.68093164173452, "num_computed": 6966, "num_roped": 6966}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "mask_shape": [1, 32, 1, 13420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:00:32.192981", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.01806640625, "l2_diff_relative": 0.09438775510204081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "attention_shape": [1, 32, 1, 13420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:01:36.032691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33742920226552753, "overlap_percentage": 0.5045937410278496, "num_intersection": 3515, "num_union": 10417, "num_only_computed": 3451, "num_only_roped": 3451, "total_diff": 6902, "diff_percentage": 0.6625707977344725, "num_computed": 6966, "num_roped": 6966}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "mask_shape": [1, 32, 1, 13421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:01:38.119708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0186767578125, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.0242919921875, "l2_diff_relative": 0.1359289617486339}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "attention_shape": [1, 32, 1, 13421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:02:42.397674", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34563013037180107, "overlap_percentage": 0.5137074781110952, "num_intersection": 3579, "num_union": 10355, "num_only_computed": 3388, "num_only_roped": 3388, "total_diff": 6776, "diff_percentage": 0.654369869628199, "num_computed": 6967, "num_roped": 6967}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "mask_shape": [1, 32, 1, 13422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:02:46.730598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0118408203125, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.12658898305084745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "attention_shape": [1, 32, 1, 13422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:03:50.945376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34161371076449065, "overlap_percentage": 0.5092579302425722, "num_intersection": 3548, "num_union": 10386, "num_only_computed": 3419, "num_only_roped": 3419, "total_diff": 6838, "diff_percentage": 0.6583862892355093, "num_computed": 6967, "num_roped": 6967}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "mask_shape": [1, 32, 1, 13423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:03:54.105496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0177001953125, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.2265625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "attention_shape": [1, 32, 1, 13423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:04:58.842537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3440061722441894, "overlap_percentage": 0.5119115958668198, "num_intersection": 3567, "num_union": 10369, "num_only_computed": 3401, "num_only_roped": 3401, "total_diff": 6802, "diff_percentage": 0.6559938277558106, "num_computed": 6968, "num_roped": 6968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "mask_shape": [1, 32, 1, 13424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:05:02.252471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.019287109375, "l2_diff_relative": 0.07596153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "attention_shape": [1, 32, 1, 13424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:05:41.369662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:05:41.382233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.0032252261513157896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:05:47.267058", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7385616437896184, "overlap_percentage": 0.8496237639060569, "num_intersection": 1099753, "num_union": 1489047, "num_only_computed": 210967, "num_only_roped": 178327, "total_diff": 389294, "diff_percentage": 0.26143835621038153, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:05:47.672824", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.1920928955078125e-05, "l2_diff": 0.1943359375, "l2_diff_relative": 0.022531702898550724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:02.454941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6003837415674971, "overlap_percentage": 0.7502997262137276, "num_intersection": 1376806, "num_union": 2293210, "num_only_computed": 458202, "num_only_roped": 458202, "total_diff": 916404, "diff_percentage": 0.3996162584325029, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:03.008468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.2636184692382812e-05, "l2_diff": 0.220703125, "l2_diff_relative": 0.026352611940298507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:24.076562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5268177221948083, "overlap_percentage": 0.690085940890842, "num_intersection": 1628117, "num_union": 3090475, "num_only_computed": 731179, "num_only_roped": 731179, "total_diff": 1462358, "diff_percentage": 0.47318227780519173, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:27.319106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.1146068572998047e-05, "l2_diff": 0.24609375, "l2_diff_relative": 0.026785714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:54.684015", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4980762217264858, "overlap_percentage": 0.6649544455788352, "num_intersection": 1917452, "num_union": 3849716, "num_only_computed": 966132, "num_only_roped": 966132, "total_diff": 1932264, "diff_percentage": 0.5019237782735142, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:06:55.607426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.1845703125, "l2_diff_relative": 0.0196875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:07:28.212732", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46754653864770496, "overlap_percentage": 0.6371812086838943, "num_intersection": 2171432, "num_union": 4644312, "num_only_computed": 1236440, "num_only_roped": 1236440, "total_diff": 2472880, "diff_percentage": 0.532453461352295, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:07:29.341147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 6.735324859619141e-06, "l2_diff": 0.2177734375, "l2_diff_relative": 0.026198308270676693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:08:07.590101", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44832726296991143, "overlap_percentage": 0.6190966288248698, "num_intersection": 2434387, "num_union": 5429933, "num_only_computed": 1497773, "num_only_roped": 1497773, "total_diff": 2995546, "diff_percentage": 0.5516727370300886, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:08:08.908336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 7.510185241699219e-06, "l2_diff": 0.31640625, "l2_diff_relative": 0.03722426470588235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:08:54.322832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4391292722277264, "overlap_percentage": 0.6102707806755515, "num_intersection": 2719640, "num_union": 6193256, "num_only_computed": 1736808, "num_only_roped": 1736808, "total_diff": 3473616, "diff_percentage": 0.5608707277722735, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:08:55.856535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.602836608886719e-06, "l2_diff": 0.2490234375, "l2_diff_relative": 0.029296875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:09:49.553235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41706796767286386, "overlap_percentage": 0.5886350932874178, "num_intersection": 2931836, "num_union": 7029636, "num_only_computed": 2048900, "num_only_roped": 2048900, "total_diff": 4097800, "diff_percentage": 0.5829320323271362, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:09:51.302836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.2329268292682927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:10:53.352472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4044295591717652, "overlap_percentage": 0.5759342738560268, "num_intersection": 3170532, "num_union": 7839516, "num_only_computed": 2334492, "num_only_roped": 2334492, "total_diff": 4668984, "diff_percentage": 0.5955704408282348, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:10:55.377776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.140625, "l2_diff_relative": 0.6836734693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:12:01.948301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3886448630687141, "overlap_percentage": 0.5597469495690387, "num_intersection": 3374889, "num_union": 8683735, "num_only_computed": 2654423, "num_only_roped": 2654423, "total_diff": 5308846, "diff_percentage": 0.611355136931286, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:12:04.207274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.5955414012738853}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:19.256288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38004983981263535, "overlap_percentage": 0.5507769775390625, "num_intersection": 3609572, "num_union": 9497628, "num_only_computed": 2944028, "num_only_roped": 2944028, "total_diff": 5888056, "diff_percentage": 0.6199501601873647, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:13:23.188561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.05718994140625e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.702054794520548}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:46.513737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37333478339705495, "overlap_percentage": 0.5436908580638744, "num_intersection": 3848183, "num_union": 10307593, "num_only_computed": 3229705, "num_only_roped": 3229705, "total_diff": 6459410, "diff_percentage": 0.626665216602945, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:14:49.337143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.888938903808594e-05, "l2_diff": 2.96875, "l2_diff_relative": 0.5491329479768786}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:20.380949", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3651000551899222, "overlap_percentage": 0.534905926934604, "num_intersection": 4066449, "num_union": 11137903, "num_only_computed": 3535727, "num_only_roped": 3535727, "total_diff": 7071454, "diff_percentage": 0.6348999448100778, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:16:23.464268", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.5112359550561798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:02.916410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35631074499450854, "overlap_percentage": 0.5254116673623362, "num_intersection": 4269739, "num_union": 11983189, "num_only_computed": 3856725, "num_only_roped": 3856725, "total_diff": 7713450, "diff_percentage": 0.6436892550054915, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:18:06.236228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 3.981590270996094e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.3779342723004695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:19:51.606687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35241653614248564, "overlap_percentage": 0.521165671558095, "num_intersection": 2825335, "num_union": 8017033, "num_only_computed": 2595849, "num_only_roped": 2595849, "total_diff": 5191698, "diff_percentage": 0.6475834638575144, "num_computed": 5421184, "num_roped": 5421184}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "mask_shape": [1, 32, 656, 16016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:19:55.420542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.6484375, "l2_diff_relative": 0.34477124183006536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "attention_shape": [1, 32, 656, 16016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:21:37.308370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3131470732126565, "overlap_percentage": 0.47694135653294667, "num_intersection": 94732, "num_union": 302516, "num_only_computed": 103892, "num_only_roped": 103892, "total_diff": 207784, "diff_percentage": 0.6868529267873434, "num_computed": 198624, "num_roped": 198624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "mask_shape": [1, 32, 24, 16040], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:21:40.469952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.2099609375, "l2_diff_relative": 0.174512987012987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "attention_shape": [1, 32, 24, 16040]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:09.100896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32606954013779843, "overlap_percentage": 0.4917834702754954, "num_intersection": 4070, "num_union": 12482, "num_only_computed": 4206, "num_only_roped": 4206, "total_diff": 8412, "diff_percentage": 0.6739304598622016, "num_computed": 8276, "num_roped": 8276}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "mask_shape": [1, 32, 1, 16041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:23:11.658524", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.0537109375, "l2_diff_relative": 0.270935960591133}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "attention_shape": [1, 32, 1, 16041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:30.546112", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32326139088729017, "overlap_percentage": 0.4885828198622689, "num_intersection": 4044, "num_union": 12510, "num_only_computed": 4233, "num_only_roped": 4233, "total_diff": 8466, "diff_percentage": 0.6767386091127098, "num_computed": 8277, "num_roped": 8277}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "mask_shape": [1, 32, 1, 16042], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:24:33.086523", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.04931640625, "l2_diff_relative": 0.24047619047619048}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "attention_shape": [1, 32, 1, 16042]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:51.827485", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3189387299816748, "overlap_percentage": 0.4836293342998671, "num_intersection": 4003, "num_union": 12551, "num_only_computed": 4274, "num_only_roped": 4274, "total_diff": 8548, "diff_percentage": 0.6810612700183253, "num_computed": 8277, "num_roped": 8277}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "mask_shape": [1, 32, 1, 16043], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:25:55.186147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.14322916666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "attention_shape": [1, 32, 1, 16043]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:27:14.021077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31710421638822595, "overlap_percentage": 0.48151727470403477, "num_intersection": 3986, "num_union": 12570, "num_only_computed": 4292, "num_only_roped": 4292, "total_diff": 8584, "diff_percentage": 0.682895783611774, "num_computed": 8278, "num_roped": 8278}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16044, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16044, 128], "mask_shape": [1, 32, 1, 16044], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:27:18.819394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 1.1920928955078125e-05, "l2_diff": 0.0206298828125, "l2_diff_relative": 0.0749113475177305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16044, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16044, 128], "attention_shape": [1, 32, 1, 16044]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:04.120238", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:04.133902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:10.090719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7286232445339501, "overlap_percentage": 0.8430098887515451, "num_intersection": 1091192, "num_union": 1497608, "num_only_computed": 219528, "num_only_roped": 186888, "total_diff": 406416, "diff_percentage": 0.27137675546604983, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:12.076900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.0788440704345703e-05, "l2_diff": 0.189453125, "l2_diff_relative": 0.020905172413793104}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:26.889858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5671660082747713, "overlap_percentage": 0.7238110133579799, "num_intersection": 1328199, "num_union": 2341817, "num_only_computed": 506809, "num_only_roped": 506809, "total_diff": 1013618, "diff_percentage": 0.43283399172522874, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:27.441556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.138448715209961e-05, "l2_diff": 0.1953125, "l2_diff_relative": 0.023496240601503758}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:48.260830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5123435403180651, "overlap_percentage": 0.6775491502549913, "num_intersection": 1598539, "num_union": 3120053, "num_only_computed": 760757, "num_only_roped": 760757, "total_diff": 1521514, "diff_percentage": 0.4876564596819349, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:28:48.993417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.3768672943115234e-05, "l2_diff": 0.271484375, "l2_diff_relative": 0.0324160447761194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:15.420439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4725224389081846, "overlap_percentage": 0.6417864019220526, "num_intersection": 1850645, "num_union": 3916523, "num_only_computed": 1032939, "num_only_roped": 1032939, "total_diff": 2065878, "diff_percentage": 0.5274775610918153, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:16.344895", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.1801719665527344e-05, "l2_diff": 0.2578125, "l2_diff_relative": 0.030330882352941176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:48.860470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4512399347854369, "overlap_percentage": 0.6218681335449219, "num_intersection": 2119247, "num_union": 4696497, "num_only_computed": 1288625, "num_only_roped": 1288625, "total_diff": 2577250, "diff_percentage": 0.5487600652145631, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:29:49.980372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 9.059906005859375e-06, "l2_diff": 0.263671875, "l2_diff_relative": 0.02992021276595745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:30:28.737542", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43189064325579457, "overlap_percentage": 0.6032452901204427, "num_intersection": 2372057, "num_union": 5492263, "num_only_computed": 1560103, "num_only_roped": 1560103, "total_diff": 3120206, "diff_percentage": 0.5681093567442055, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:30:31.232441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 7.987022399902344e-06, "l2_diff": 0.29296875, "l2_diff_relative": 0.040584415584415584}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:31:16.041356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4183410038368696, "overlap_percentage": 0.5899018680348116, "num_intersection": 2628867, "num_union": 6284029, "num_only_computed": 1827581, "num_only_roped": 1827581, "total_diff": 3655162, "diff_percentage": 0.5816589961631303, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:31:17.573795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.947185516357422e-06, "l2_diff": 0.22265625, "l2_diff_relative": 0.025815217391304348}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:32:09.388055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4206827111634043, "overlap_percentage": 0.5922261288291529, "num_intersection": 2949722, "num_union": 7011750, "num_only_computed": 2031014, "num_only_roped": 2031014, "total_diff": 4062028, "diff_percentage": 0.5793172888365957, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:32:11.136720", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07373046875, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.17481203007518797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:33:10.770471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4113195280137373, "overlap_percentage": 0.582886468796503, "num_intersection": 3208804, "num_union": 7801244, "num_only_computed": 2296220, "num_only_roped": 2296220, "total_diff": 4592440, "diff_percentage": 0.5886804719862627, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:33:12.808652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 5.5789947509765625e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.43434343434343436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:34:21.251532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3987505157466126, "overlap_percentage": 0.5701524485712466, "num_intersection": 3437627, "num_union": 8620997, "num_only_computed": 2591685, "num_only_roped": 2591685, "total_diff": 5183370, "diff_percentage": 0.6012494842533874, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:34:26.205521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 6.031990051269531e-05, "l2_diff": 2.375, "l2_diff_relative": 0.49673202614379086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:35:40.687302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39056735067277626, "overlap_percentage": 0.5617381286621094, "num_intersection": 3681407, "num_union": 9425793, "num_only_computed": 2872193, "num_only_roped": 2872193, "total_diff": 5744386, "diff_percentage": 0.6094326493272237, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:35:43.246873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 5.888938903808594e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.47770700636942676}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:37:05.883290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4020629747798, "overlap_percentage": 0.5735305503562644, "num_intersection": 4059385, "num_union": 10096391, "num_only_computed": 3018503, "num_only_roped": 3018503, "total_diff": 6037006, "diff_percentage": 0.5979370252202, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:37:08.712269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 4.57763671875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.40463917525773196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:38:40.687212", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39656671519571596, "overlap_percentage": 0.5679166070346174, "num_intersection": 4317402, "num_union": 10886950, "num_only_computed": 3284774, "num_only_roped": 3284774, "total_diff": 6569548, "diff_percentage": 0.603433284804284, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:38:43.777280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.696846008300781e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.45209580838323354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:40:25.735322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37952281014106964, "overlap_percentage": 0.5502233197612147, "num_intersection": 4471370, "num_union": 11781558, "num_only_computed": 3655094, "num_only_roped": 3655094, "total_diff": 7310188, "diff_percentage": 0.6204771898589304, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:40:29.671746", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.8828125, "l2_diff_relative": 0.35441176470588237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:42:11.124985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36027294190903664, "overlap_percentage": 0.5297068416334472, "num_intersection": 1110880, "num_union": 3083440, "num_only_computed": 986280, "num_only_roped": 986280, "total_diff": 1972560, "diff_percentage": 0.6397270580909633, "num_computed": 2097160, "num_roped": 2097160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "mask_shape": [1, 32, 260, 15620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:42:14.356510", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.7578125, "l2_diff_relative": 0.20638297872340425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "attention_shape": [1, 32, 260, 15620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:43:51.632410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3484894381216733, "overlap_percentage": 0.5168589805302269, "num_intersection": 112744, "num_union": 323522, "num_only_computed": 105389, "num_only_roped": 105389, "total_diff": 210778, "diff_percentage": 0.6515105618783267, "num_computed": 218133, "num_roped": 218133}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "mask_shape": [1, 32, 27, 15647], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:43:54.846454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.11328125, "l2_diff_relative": 0.09539473684210527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "attention_shape": [1, 32, 27, 15647]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:45:20.485261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34745268073042607, "overlap_percentage": 0.5157178217821782, "num_intersection": 4167, "num_union": 11993, "num_only_computed": 3913, "num_only_roped": 3913, "total_diff": 7826, "diff_percentage": 0.6525473192695739, "num_computed": 8080, "num_roped": 8080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "mask_shape": [1, 32, 1, 15648], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:45:22.968520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 1.3947486877441406e-05, "l2_diff": 0.0185546875, "l2_diff_relative": 0.059748427672955975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "attention_shape": [1, 32, 1, 15648]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:46:39.248838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3482396128816953, "overlap_percentage": 0.5165841584158416, "num_intersection": 4174, "num_union": 11986, "num_only_computed": 3906, "num_only_roped": 3906, "total_diff": 7812, "diff_percentage": 0.6517603871183046, "num_computed": 8080, "num_roped": 8080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "mask_shape": [1, 32, 1, 15649], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:46:43.957562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "attention_shape": [1, 32, 1, 15649]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:48:00.569396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3471701258647995, "overlap_percentage": 0.515406509095409, "num_intersection": 4165, "num_union": 11997, "num_only_computed": 3916, "num_only_roped": 3916, "total_diff": 7832, "diff_percentage": 0.6528298741352004, "num_computed": 8081, "num_roped": 8081}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "mask_shape": [1, 32, 1, 15650], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:48:04.406228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.14397321428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "attention_shape": [1, 32, 1, 15650]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:49:21.709752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35723883103795767, "overlap_percentage": 0.5264199975250587, "num_intersection": 4254, "num_union": 11908, "num_only_computed": 3827, "num_only_roped": 3827, "total_diff": 7654, "diff_percentage": 0.6427611689620423, "num_computed": 8081, "num_roped": 8081}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "mask_shape": [1, 32, 1, 15651], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:49:24.159460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0113525390625, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.020263671875, "l2_diff_relative": 0.0969626168224299}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "attention_shape": [1, 32, 1, 15651]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:50:41.566503", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3600336558687421, "overlap_percentage": 0.5294481563969314, "num_intersection": 4279, "num_union": 11885, "num_only_computed": 3803, "num_only_roped": 3803, "total_diff": 7606, "diff_percentage": 0.6399663441312579, "num_computed": 8082, "num_roped": 8082}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "mask_shape": [1, 32, 1, 15652], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:50:44.028154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0135498046875, "mean_diff": 2.9087066650390625e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.16540404040404041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "attention_shape": [1, 32, 1, 15652]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:52:00.006820", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34936138241923365, "overlap_percentage": 0.5178173719376392, "num_intersection": 4185, "num_union": 11979, "num_only_computed": 3897, "num_only_roped": 3897, "total_diff": 7794, "diff_percentage": 0.6506386175807664, "num_computed": 8082, "num_roped": 8082}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "mask_shape": [1, 32, 1, 15653], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:52:04.588413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2157079646017699}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "attention_shape": [1, 32, 1, 15653]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:53:20.761214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3498663994655979, "overlap_percentage": 0.5183718916243969, "num_intersection": 4190, "num_union": 11976, "num_only_computed": 3893, "num_only_roped": 3893, "total_diff": 7786, "diff_percentage": 0.6501336005344022, "num_computed": 8083, "num_roped": 8083}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15654, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15654, 128], "mask_shape": [1, 32, 1, 15654], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:53:24.708496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.1643700787401575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15654, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15654, 128], "attention_shape": [1, 32, 1, 15654]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
