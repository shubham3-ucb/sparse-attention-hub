{"timestamp": "2025-11-13T18:14:12.246191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:14:12.290770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030764910130718953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:14:18.212800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5108912860089234, "overlap_percentage": 0.6762780230978261, "num_intersection": 318554, "num_union": 623526, "num_only_computed": 152486, "num_only_roped": 152486, "total_diff": 304972, "diff_percentage": 0.4891087139910766, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:14:18.599213", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.625, "l2_diff_relative": 0.07092198581560284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:14:33.288699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40281140426650186, "overlap_percentage": 0.5742916019094139, "num_intersection": 331086, "num_union": 821938, "num_only_computed": 245426, "num_only_roped": 245426, "total_diff": 490852, "diff_percentage": 0.5971885957334981, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:14:36.240701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 9.107589721679688e-05, "l2_diff": 1.25, "l2_diff_relative": 0.16194331983805668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:14:56.223453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3463082099968762, "overlap_percentage": 0.5144560620300752, "num_intersection": 350324, "num_union": 1011596, "num_only_computed": 330636, "num_only_roped": 330636, "total_diff": 661272, "diff_percentage": 0.6536917900031238, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:14:56.946151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.11481481481481481}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:15:22.313987", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29133703116225457, "overlap_percentage": 0.4512176513671875, "num_intersection": 354852, "num_union": 1218012, "num_only_computed": 431580, "num_only_roped": 431580, "total_diff": 863160, "diff_percentage": 0.7086629688377455, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:15:23.216180", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.18526785714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:15:54.298533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2582944212337184, "overlap_percentage": 0.410546875, "num_intersection": 365748, "num_union": 1416012, "num_only_computed": 525132, "num_only_roped": 525132, "total_diff": 1050264, "diff_percentage": 0.7417055787662816, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:15:55.385751", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:16:32.811400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2434077383183174, "overlap_percentage": 0.39151716820987653, "num_intersection": 389688, "num_union": 1600968, "num_only_computed": 605640, "num_only_roped": 605640, "total_diff": 1211280, "diff_percentage": 0.7565922616816826, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:16:34.065003", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.1154513888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:17:16.934420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22175631910392699, "overlap_percentage": 0.36301235465116277, "num_intersection": 399604, "num_union": 1801996, "num_only_computed": 701196, "num_only_roped": 701196, "total_diff": 1402392, "diff_percentage": 0.778243680896073, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:17:18.400088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.15497737556561086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:18:06.935863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19654374254485743, "overlap_percentage": 0.328519109759983, "num_intersection": 395947, "num_union": 2014549, "num_only_computed": 809301, "num_only_roped": 809301, "total_diff": 1618602, "diff_percentage": 0.8034562574551426, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:18:08.618628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12255859375, "mean_diff": 5.841255187988281e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.3855140186915888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:19:03.913311", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17254653056495986, "overlap_percentage": 0.2943107604980469, "num_intersection": 385759, "num_union": 2235681, "num_only_computed": 924961, "num_only_roped": 924961, "total_diff": 1849922, "diff_percentage": 0.8274534694350402, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:19:05.810618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 0.00010013580322265625, "l2_diff": 4.375, "l2_diff_relative": 1.044776119402985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:20:07.789592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15873098402246444, "overlap_percentage": 0.27397383208212733, "num_intersection": 387719, "num_union": 2442617, "num_only_computed": 1027449, "num_only_roped": 1027449, "total_diff": 2054898, "diff_percentage": 0.8412690159775356, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:20:11.842159", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 6.532669067382812e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.5841836734693877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:21:12.075664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15328075266205626, "overlap_percentage": 0.2658168920416759, "num_intersection": 23982, "num_union": 156458, "num_only_computed": 66238, "num_only_roped": 66238, "total_diff": 132476, "diff_percentage": 0.8467192473379437, "num_computed": 90220, "num_roped": 90220}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:21:13.814201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10986328125, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.61328125, "l2_diff_relative": 0.3458149779735683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:22:06.885321", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15275105809926895, "overlap_percentage": 0.2650200267022697, "num_intersection": 10322, "num_union": 67574, "num_only_computed": 28626, "num_only_roped": 28626, "total_diff": 57252, "diff_percentage": 0.8472489419007311, "num_computed": 38948, "num_roped": 38948}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:22:08.512993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.357421875, "l2_diff_relative": 0.305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:22:55.305458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13923013923013924, "overlap_percentage": 0.24442846872753415, "num_intersection": 340, "num_union": 2442, "num_only_computed": 1051, "num_only_roped": 1051, "total_diff": 2102, "diff_percentage": 0.8607698607698607, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:22:57.910764", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.11888111888111888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:23:40.531158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14203612479474548, "overlap_percentage": 0.24874191229331416, "num_intersection": 346, "num_union": 2436, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8579638752052545, "num_computed": 1391, "num_roped": 1391}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:23:41.890242", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.064453125, "l2_diff_relative": 0.2693877551020408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:24:23.714804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1513647642679901, "overlap_percentage": 0.2629310344827586, "num_intersection": 366, "num_union": 2418, "num_only_computed": 1026, "num_only_roped": 1026, "total_diff": 2052, "diff_percentage": 0.8486352357320099, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:24:25.106548", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 6.008148193359375e-05, "l2_diff": 0.111328125, "l2_diff_relative": 0.4851063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:25:06.881151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14615067929188966, "overlap_percentage": 0.2550287356321839, "num_intersection": 355, "num_union": 2429, "num_only_computed": 1037, "num_only_roped": 1037, "total_diff": 2074, "diff_percentage": 0.8538493207081104, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:25:08.214476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.5294117647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:25:48.934082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14615067929188966, "overlap_percentage": 0.2550287356321839, "num_intersection": 355, "num_union": 2429, "num_only_computed": 1037, "num_only_roped": 1037, "total_diff": 2074, "diff_percentage": 0.8538493207081104, "num_computed": 1392, "num_roped": 1392}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "mask_shape": [1, 32, 1, 11362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:25:50.259441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0264892578125, "l2_diff_relative": 0.1149364406779661}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11362, 128], "attention_shape": [1, 32, 1, 11362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:15.854599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:15.868295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003127639358108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:21.745757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5079191042888812, "overlap_percentage": 0.6736689028532609, "num_intersection": 317325, "num_union": 624755, "num_only_computed": 153715, "num_only_roped": 153715, "total_diff": 307430, "diff_percentage": 0.49208089571111874, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:22.131739", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 5.650520324707031e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.07291666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:37.331567", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3892541679769724, "overlap_percentage": 0.5603786217806395, "num_intersection": 323065, "num_union": 829959, "num_only_computed": 253447, "num_only_roped": 253447, "total_diff": 506894, "diff_percentage": 0.6107458320230277, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:37.879632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.81640625, "l2_diff_relative": 0.08826013513513513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:57.656350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3237934255507139, "overlap_percentage": 0.48919026080827066, "num_intersection": 333119, "num_union": 1028801, "num_only_computed": 347841, "num_only_roped": 347841, "total_diff": 695682, "diff_percentage": 0.6762065744492861, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:26:58.381338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 6.818771362304688e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.15744274809160305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:27:24.424451", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29392698428890385, "overlap_percentage": 0.45431772867838544, "num_intersection": 357290, "num_union": 1215574, "num_only_computed": 429142, "num_only_roped": 429142, "total_diff": 858284, "diff_percentage": 0.7060730157110962, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:27:25.672592", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 6.103515625e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.17604166666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:27:56.830069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26435093231831025, "overlap_percentage": 0.41816069504310344, "num_intersection": 372531, "num_union": 1409229, "num_only_computed": 518349, "num_only_roped": 518349, "total_diff": 1036698, "diff_percentage": 0.7356490676816898, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:27:57.898974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.125999450683594e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.18571428571428572}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:28:34.522965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23534120795173455, "overlap_percentage": 0.38101409786522633, "num_intersection": 379234, "num_union": 1611422, "num_only_computed": 616094, "num_only_roped": 616094, "total_diff": 1232188, "diff_percentage": 0.7646587920482655, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:28:35.781851", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.19004065040650406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:29:18.147126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2127281370444489, "overlap_percentage": 0.35082576308139535, "num_intersection": 386189, "num_union": 1815411, "num_only_computed": 714611, "num_only_roped": 714611, "total_diff": 1429222, "diff_percentage": 0.7872718629555511, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:29:19.638536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.1630859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:30:09.524143", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19445194608530794, "overlap_percentage": 0.3255919113742566, "num_intersection": 392419, "num_union": 2018077, "num_only_computed": 812829, "num_only_roped": 812829, "total_diff": 1625658, "diff_percentage": 0.8055480539146921, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:30:13.989207", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 5.626678466796875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.3442982456140351}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:31:09.927477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16876267043080914, "overlap_percentage": 0.2887886047363281, "num_intersection": 378521, "num_union": 2242919, "num_only_computed": 932199, "num_only_roped": 932199, "total_diff": 1864398, "diff_percentage": 0.8312373295691908, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:31:11.827712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 7.43865966796875e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.5989847715736041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:32:14.125205", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.166774054850009, "overlap_percentage": 0.2858720660727207, "num_intersection": 404557, "num_union": 2425779, "num_only_computed": 1010611, "num_only_roped": 1010611, "total_diff": 2021222, "diff_percentage": 0.833225945149991, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:32:17.386012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.677078247070312e-05, "l2_diff": 3.8125, "l2_diff_relative": 0.782051282051282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:33:27.239080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15146151328152468, "overlap_percentage": 0.26307698787061995, "num_intersection": 399776, "num_union": 2639456, "num_only_computed": 1119840, "num_only_roped": 1119840, "total_diff": 2239680, "diff_percentage": 0.8485384867184753, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:33:29.623192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.40625, "l2_diff_relative": 0.6488095238095238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:34:46.473784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14295761720659406, "overlap_percentage": 0.2501538378229364, "num_intersection": 406522, "num_union": 2843654, "num_only_computed": 1218566, "num_only_roped": 1218566, "total_diff": 2437132, "diff_percentage": 0.8570423827934059, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:34:51.043476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.640625, "l2_diff_relative": 0.6472222222222223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:36:14.428552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14312151931864897, "overlap_percentage": 0.25040473283007697, "num_intersection": 433084, "num_union": 3025988, "num_only_computed": 1296452, "num_only_roped": 1296452, "total_diff": 2592904, "diff_percentage": 0.856878480681351, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:36:17.302242", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.104873657226562e-05, "l2_diff": 3.75, "l2_diff_relative": 0.9230769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:37:47.460906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13833289857684195, "overlap_percentage": 0.24304471697126115, "num_intersection": 445989, "num_union": 3224027, "num_only_computed": 1389019, "num_only_roped": 1389019, "total_diff": 2778038, "diff_percentage": 0.861667101423158, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:37:51.852365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.05718994140625e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.9915966386554622}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:39:28.074710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13339525077913536, "overlap_percentage": 0.2353905236278956, "num_intersection": 395836, "num_union": 2967392, "num_only_computed": 1285778, "num_only_roped": 1285778, "total_diff": 2571556, "diff_percentage": 0.8666047492208646, "num_computed": 1681614, "num_roped": 1681614}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 894, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:39:32.774810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 6.246566772460938e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.8978102189781022}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 894, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:41:03.857335", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12792556556142107, "overlap_percentage": 0.226833346928787, "num_intersection": 22246, "num_union": 173898, "num_only_computed": 75826, "num_only_roped": 75826, "total_diff": 151652, "diff_percentage": 0.8720744344385789, "num_computed": 98072, "num_roped": 98072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:41:07.319257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09814453125, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.51171875, "l2_diff_relative": 0.4119496855345912}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:42:18.481988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1371721435031655, "overlap_percentage": 0.24125132555673381, "num_intersection": 455, "num_union": 3317, "num_only_computed": 1431, "num_only_roped": 1431, "total_diff": 2862, "diff_percentage": 0.8628278564968345, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:42:20.389608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037353515625, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.0771484375, "l2_diff_relative": 0.7214611872146118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:43:19.098466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14546006680838142, "overlap_percentage": 0.2539766702014846, "num_intersection": 479, "num_union": 3293, "num_only_computed": 1407, "num_only_roped": 1407, "total_diff": 2814, "diff_percentage": 0.8545399331916186, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:43:21.010366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0147705078125, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.4073275862068966}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:44:19.952773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13205282112845138, "overlap_percentage": 0.23329798515376457, "num_intersection": 440, "num_union": 3332, "num_only_computed": 1446, "num_only_roped": 1446, "total_diff": 2892, "diff_percentage": 0.8679471788715486, "num_computed": 1886, "num_roped": 1886}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:44:22.325448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.27717391304347827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:44:58.269583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:44:58.283228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.003156043046357616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:45:04.095954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.501040441797399, "overlap_percentage": 0.6675908627717392, "num_intersection": 314462, "num_union": 627618, "num_only_computed": 156578, "num_only_roped": 156578, "total_diff": 313156, "diff_percentage": 0.49895955820260096, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:45:05.177133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 9.632110595703125e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.12781954887218044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:45:19.912595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3985728304074699, "overlap_percentage": 0.5699707898534636, "num_intersection": 328595, "num_union": 824429, "num_only_computed": 247917, "num_only_roped": 247917, "total_diff": 495834, "diff_percentage": 0.6014271695925301, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:45:20.457265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 9.584426879882812e-05, "l2_diff": 1.390625, "l2_diff_relative": 0.17943548387096775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:45:41.268606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34388506246176315, "overlap_percentage": 0.5117774906015038, "num_intersection": 348500, "num_union": 1013420, "num_only_computed": 332460, "num_only_roped": 332460, "total_diff": 664920, "diff_percentage": 0.6561149375382369, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:45:41.992120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:46:07.523239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3034780929618528, "overlap_percentage": 0.46564356486002606, "num_intersection": 366197, "num_union": 1206667, "num_only_computed": 420235, "num_only_roped": 420235, "total_diff": 840470, "diff_percentage": 0.6965219070381472, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:46:08.423164", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.0743838028169014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:46:39.436193", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25467132267352816, "overlap_percentage": 0.40595703125, "num_intersection": 361659, "num_union": 1420101, "num_only_computed": 529221, "num_only_roped": 529221, "total_diff": 1058442, "diff_percentage": 0.7453286773264719, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:46:40.533915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.14050387596899225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:47:19.067994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23792010895081978, "overlap_percentage": 0.38438685538837447, "num_intersection": 382591, "num_union": 1608065, "num_only_computed": 612737, "num_only_roped": 612737, "total_diff": 1225474, "diff_percentage": 0.7620798910491803, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:47:20.337062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.14130434782608695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:48:02.685214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2166668324552067, "overlap_percentage": 0.35616460755813956, "num_intersection": 392066, "num_union": 1809534, "num_only_computed": 708734, "num_only_roped": 708734, "total_diff": 1417468, "diff_percentage": 0.7833331675447933, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:48:04.155356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.9206275939941406e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.1383399209486166}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:48:53.798064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1953955498779063, "overlap_percentage": 0.3269136310535259, "num_intersection": 394012, "num_union": 2016484, "num_only_computed": 811236, "num_only_roped": 811236, "total_diff": 1622472, "diff_percentage": 0.8046044501220937, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:48:55.479372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:49:50.360643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16497467794145618, "overlap_percentage": 0.2832244873046875, "num_intersection": 371228, "num_union": 2250212, "num_only_computed": 939492, "num_only_roped": 939492, "total_diff": 1878984, "diff_percentage": 0.8350253220585439, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:49:52.235745", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1669921875, "mean_diff": 8.535385131835938e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.7771084337349398}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:50:54.027566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15061792636919474, "overlap_percentage": 0.2618035455861071, "num_intersection": 370496, "num_union": 2459840, "num_only_computed": 1044672, "num_only_roped": 1044672, "total_diff": 2089344, "diff_percentage": 0.8493820736308052, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:50:56.171077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.534027099609375e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.7379518072289156}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:52:04.332755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14553388961047284, "overlap_percentage": 0.254089190953504, "num_intersection": 386118, "num_union": 2653114, "num_only_computed": 1133498, "num_only_roped": 1133498, "total_diff": 2266996, "diff_percentage": 0.8544661103895271, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:52:06.712245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 7.152557373046875e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.7914110429447853}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:53:23.430818", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13809889648903248, "overlap_percentage": 0.24268347314114683, "num_intersection": 394382, "num_union": 2855794, "num_only_computed": 1230706, "num_only_roped": 1230706, "total_diff": 2461412, "diff_percentage": 0.8619011035109675, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:53:27.933284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 7.390975952148438e-05, "l2_diff": 4.71875, "l2_diff_relative": 0.848314606741573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:54:51.412576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13849790522720606, "overlap_percentage": 0.24329935890319715, "num_intersection": 420795, "num_union": 3038277, "num_only_computed": 1308741, "num_only_roped": 1308741, "total_diff": 2617482, "diff_percentage": 0.8615020947727939, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:54:54.474671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.914138793945312e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.9}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:56:26.023009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13565968233849565, "overlap_percentage": 0.23890904017857142, "num_intersection": 438400, "num_union": 3231616, "num_only_computed": 1396608, "num_only_roped": 1396608, "total_diff": 2793216, "diff_percentage": 0.8643403176615043, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:56:29.119099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.8626760563380281}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:58:07.230316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12852099543046563, "overlap_percentage": 0.22776890452346843, "num_intersection": 401437, "num_union": 3123513, "num_only_computed": 1361038, "num_only_roped": 1361038, "total_diff": 2722076, "diff_percentage": 0.8714790045695344, "num_computed": 1762475, "num_roped": 1762475}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:58:10.705485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 6.67572021484375e-05, "l2_diff": 4.15625, "l2_diff_relative": 0.9851851851851852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:59:40.262705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12806213901613225, "overlap_percentage": 0.22704802259887005, "num_intersection": 12860, "num_union": 100420, "num_only_computed": 43780, "num_only_roped": 43780, "total_diff": 87560, "diff_percentage": 0.8719378609838677, "num_computed": 56640, "num_roped": 56640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T18:59:43.957226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06982421875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.400390625, "l2_diff_relative": 0.36347517730496454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:00:52.414791", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13223388305847075, "overlap_percentage": 0.23358050847457626, "num_intersection": 441, "num_union": 3335, "num_only_computed": 1447, "num_only_roped": 1447, "total_diff": 2894, "diff_percentage": 0.8677661169415293, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:00:54.334188", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04150390625, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.07763671875, "l2_diff_relative": 0.6309523809523809}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:01:53.835369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1291866028708134, "overlap_percentage": 0.2288135593220339, "num_intersection": 432, "num_union": 3344, "num_only_computed": 1456, "num_only_roped": 1456, "total_diff": 2912, "diff_percentage": 0.8708133971291866, "num_computed": 1888, "num_roped": 1888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "mask_shape": [1, 32, 1, 16327], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:01:55.765633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.042724609375, "mean_diff": 6.389617919921875e-05, "l2_diff": 0.0888671875, "l2_diff_relative": 0.8198198198198198}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16327, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16327, 128], "attention_shape": [1, 32, 1, 16327]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:02:33.989961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:02:34.003646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.003043519938650307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:02:40.193180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5191432888433077, "overlap_percentage": 0.6834684952445652, "num_intersection": 321941, "num_union": 620139, "num_only_computed": 149099, "num_only_roped": 149099, "total_diff": 298198, "diff_percentage": 0.48085671115669226, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:02:43.276452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.09973404255319149}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:02:58.036491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40569312151250897, "overlap_percentage": 0.5772143511323268, "num_intersection": 332771, "num_union": 820253, "num_only_computed": 243741, "num_only_roped": 243741, "total_diff": 487482, "diff_percentage": 0.5943068784874911, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:02:58.594082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 0.00010251998901367188, "l2_diff": 1.3671875, "l2_diff_relative": 0.20161290322580644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:03:18.984328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34759373104525787, "overlap_percentage": 0.5158731790413534, "num_intersection": 351289, "num_union": 1010631, "num_only_computed": 329671, "num_only_roped": 329671, "total_diff": 659342, "diff_percentage": 0.6524062689547422, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:03:19.731649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.390625, "l2_diff_relative": 0.2109004739336493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:03:45.612249", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.296415139283951, "overlap_percentage": 0.45728429158528644, "num_intersection": 359623, "num_union": 1213241, "num_only_computed": 426809, "num_only_roped": 426809, "total_diff": 853618, "diff_percentage": 0.703584860716049, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:03:46.556199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.104873657226562e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.22209302325581395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:04:18.589070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2670230263742687, "overlap_percentage": 0.421496722341954, "num_intersection": 375503, "num_union": 1406257, "num_only_computed": 515377, "num_only_roped": 515377, "total_diff": 1030754, "diff_percentage": 0.7329769736257313, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:04:21.539587", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.24178403755868544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:04:59.373776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23995191319459583, "overlap_percentage": 0.3870342238940329, "num_intersection": 385226, "num_union": 1605430, "num_only_computed": 610102, "num_only_roped": 610102, "total_diff": 1220204, "diff_percentage": 0.7600480868054041, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:05:03.416320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.27427184466019416}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:05:47.257608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2278547231917084, "overlap_percentage": 0.37114280523255816, "num_intersection": 408554, "num_union": 1793046, "num_only_computed": 692246, "num_only_roped": 692246, "total_diff": 1384492, "diff_percentage": 0.7721452768082916, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:05:48.737262", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.9114227294921875e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.24879807692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:06:38.141602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19738239504693667, "overlap_percentage": 0.329689823173322, "num_intersection": 397358, "num_union": 2013138, "num_only_computed": 807890, "num_only_roped": 807890, "total_diff": 1615780, "diff_percentage": 0.8026176049530633, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:06:42.089682", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.555152893066406e-05, "l2_diff": 2.375, "l2_diff_relative": 0.36538461538461536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:07:37.065524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16485043893404525, "overlap_percentage": 0.2830413818359375, "num_intersection": 370988, "num_union": 2250452, "num_only_computed": 939732, "num_only_roped": 939732, "total_diff": 1879464, "diff_percentage": 0.8351495610659547, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:07:38.973511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 8.440017700195312e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.7745098039215687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:08:41.028126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15144458628991642, "overlap_percentage": 0.2630514539616498, "num_intersection": 372262, "num_union": 2458074, "num_only_computed": 1042906, "num_only_roped": 1042906, "total_diff": 2085812, "diff_percentage": 0.8485554137100836, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:08:46.136903", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 7.867813110351562e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.7838709677419354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:09:55.567835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1589368795594622, "overlap_percentage": 0.274280476120283, "num_intersection": 416801, "num_union": 2622431, "num_only_computed": 1102815, "num_only_roped": 1102815, "total_diff": 2205630, "diff_percentage": 0.8410631204405378, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:09:58.667663", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.772445678710938e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.7789115646258503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:11:14.989026", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15060578769392852, "overlap_percentage": 0.2617852079395085, "num_intersection": 425424, "num_union": 2824752, "num_only_computed": 1199664, "num_only_roped": 1199664, "total_diff": 2399328, "diff_percentage": 0.8493942123060715, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:11:19.598281", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 6.580352783203125e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.6970588235294117}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:12:42.668591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1443199212390818, "overlap_percentage": 0.2522370161708111, "num_intersection": 436253, "num_union": 3022819, "num_only_computed": 1293283, "num_only_roped": 1293283, "total_diff": 2586566, "diff_percentage": 0.8556800787609182, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:12:46.225741", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 7.009506225585938e-05, "l2_diff": 3.78125, "l2_diff_relative": 0.9029850746268657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:14:16.346355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1343507415747007, "overlap_percentage": 0.23687689644949778, "num_intersection": 434671, "num_union": 3235345, "num_only_computed": 1400337, "num_only_roped": 1400337, "total_diff": 2800674, "diff_percentage": 0.8656492584252993, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:14:20.776469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 5.626678466796875e-05, "l2_diff": 3.25, "l2_diff_relative": 0.6842105263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:15:58.244709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13118325281563342, "overlap_percentage": 0.23193987798016738, "num_intersection": 422138, "num_union": 3217926, "num_only_computed": 1397894, "num_only_roped": 1397894, "total_diff": 2795788, "diff_percentage": 0.8688167471843665, "num_computed": 1820032, "num_roped": 1820032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:16:01.941390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 6.341934204101562e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.9147286821705426}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:17:32.300473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13292619291498367, "overlap_percentage": 0.23465993415328978, "num_intersection": 13756, "num_union": 103486, "num_only_computed": 44865, "num_only_roped": 44865, "total_diff": 89730, "diff_percentage": 0.8670738070850164, "num_computed": 58621, "num_roped": 58621}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:17:35.971284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.33984375, "l2_diff_relative": 0.29591836734693877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:18:44.852520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13812819741197713, "overlap_percentage": 0.24272871496562665, "num_intersection": 459, "num_union": 3323, "num_only_computed": 1432, "num_only_roped": 1432, "total_diff": 2864, "diff_percentage": 0.8618718025880229, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:18:47.531294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.387987012987013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:19:22.239863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:19:22.251633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0030174026946107784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:19:28.123761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5428632258170175, "overlap_percentage": 0.7037088145380435, "num_intersection": 331475, "num_union": 610605, "num_only_computed": 139565, "num_only_roped": 139565, "total_diff": 279130, "diff_percentage": 0.45713677418298243, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:19:28.512550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.68359375, "l2_diff_relative": 0.06793478260869565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:19:43.101197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40344317208070424, "overlap_percentage": 0.5749333925399644, "num_intersection": 331456, "num_union": 821568, "num_only_computed": 245056, "num_only_roped": 245056, "total_diff": 490112, "diff_percentage": 0.5965568279192958, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:19:43.659680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.90234375, "l2_diff_relative": 0.09689597315436242}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:20:04.004848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33788621208608555, "overlap_percentage": 0.5051045582706767, "num_intersection": 343956, "num_union": 1017964, "num_only_computed": 337004, "num_only_roped": 337004, "total_diff": 674008, "diff_percentage": 0.6621137879139144, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:20:04.747484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 5.054473876953125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.11201298701298701}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:20:30.276328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2925382946551838, "overlap_percentage": 0.4526570638020833, "num_intersection": 355984, "num_union": 1216880, "num_only_computed": 430448, "num_only_roped": 430448, "total_diff": 860896, "diff_percentage": 0.7074617053448162, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:20:31.161625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.10669642857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:21:02.334657", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25616445985760145, "overlap_percentage": 0.40785178699712643, "num_intersection": 363347, "num_union": 1418413, "num_only_computed": 527533, "num_only_roped": 527533, "total_diff": 1055066, "diff_percentage": 0.7438355401423986, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:21:05.416303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.1701923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:21:42.571086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23192467808781655, "overlap_percentage": 0.3765241206918724, "num_intersection": 374765, "num_union": 1615891, "num_only_computed": 620563, "num_only_roped": 620563, "total_diff": 1241126, "diff_percentage": 0.7680753219121834, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:21:43.855799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 5.221366882324219e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.23076923076923078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:29.416864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21474489308909692, "overlap_percentage": 0.35356377180232557, "num_intersection": 389203, "num_union": 1812397, "num_only_computed": 711597, "num_only_roped": 711597, "total_diff": 1423194, "diff_percentage": 0.7852551069109031, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:22:31.230203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.7265625, "l2_diff_relative": 0.23917748917748918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:23:20.532140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19647425429326748, "overlap_percentage": 0.3284220343033135, "num_intersection": 395830, "num_union": 2014666, "num_only_computed": 809418, "num_only_roped": 809418, "total_diff": 1618836, "diff_percentage": 0.8035257457067325, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:23:22.212703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.580352783203125e-05, "l2_diff": 2.703125, "l2_diff_relative": 0.44358974358974357}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:24:19.442007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1645363360089629, "overlap_percentage": 0.2825782775878906, "num_intersection": 370381, "num_union": 2251059, "num_only_computed": 940339, "num_only_roped": 940339, "total_diff": 1880678, "diff_percentage": 0.8354636639910371, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:24:21.906472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 9.34600830078125e-05, "l2_diff": 4.34375, "l2_diff_relative": 0.9205298013245033}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:25:24.246022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15214344477674885, "overlap_percentage": 0.2641050391190304, "num_intersection": 373753, "num_union": 2456583, "num_only_computed": 1041415, "num_only_roped": 1041415, "total_diff": 2082830, "diff_percentage": 0.8478565552232512, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:25:28.816066", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 9.107589721679688e-05, "l2_diff": 4.4375, "l2_diff_relative": 0.9861111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:26:37.958218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15515527081553285, "overlap_percentage": 0.26863102257412397, "num_intersection": 408216, "num_union": 2631016, "num_only_computed": 1111400, "num_only_roped": 1111400, "total_diff": 2222800, "diff_percentage": 0.8448447291844672, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:26:40.489904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.9862068965517241}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:27:56.831123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1516519463989971, "overlap_percentage": 0.2633641993541273, "num_intersection": 427990, "num_union": 2822186, "num_only_computed": 1197098, "num_only_roped": 1197098, "total_diff": 2394196, "diff_percentage": 0.848348053601003, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:28:00.627388", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 7.724761962890625e-05, "l2_diff": 4.15625, "l2_diff_relative": 0.8986486486486487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:29:24.143589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15010962221730137, "overlap_percentage": 0.26103532970692717, "num_intersection": 451470, "num_union": 3007602, "num_only_computed": 1278066, "num_only_roped": 1278066, "total_diff": 2556132, "diff_percentage": 0.8498903777826986, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:29:27.016009", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 6.532669067382812e-05, "l2_diff": 4.28125, "l2_diff_relative": 0.7828571428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:30:48.812608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14405323749531013, "overlap_percentage": 0.25182960508146923, "num_intersection": 65655, "num_union": 455769, "num_only_computed": 195057, "num_only_roped": 195057, "total_diff": 390114, "diff_percentage": 0.8559467625046899, "num_computed": 260712, "num_roped": 260712}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:30:51.381977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.6743621826171875e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.5328947368421053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:32:03.981642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14021708878374617, "overlap_percentage": 0.24594805702011327, "num_intersection": 10076, "num_union": 71860, "num_only_computed": 30892, "num_only_roped": 30892, "total_diff": 61784, "diff_percentage": 0.8597829112162538, "num_computed": 40968, "num_roped": 40968}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:32:06.205992", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11767578125, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.48616600790513836}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:33:07.034854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1410427807486631, "overlap_percentage": 0.2472173403632103, "num_intersection": 422, "num_union": 2992, "num_only_computed": 1285, "num_only_roped": 1285, "total_diff": 2570, "diff_percentage": 0.858957219251337, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:33:08.736580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 8.344650268554688e-05, "l2_diff": 0.09423828125, "l2_diff_relative": 0.9278846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:34:01.365902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14794889038332212, "overlap_percentage": 0.2577621558289397, "num_intersection": 440, "num_union": 2974, "num_only_computed": 1267, "num_only_roped": 1267, "total_diff": 2534, "diff_percentage": 0.8520511096166778, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14515, 128], "mask_shape": [1, 32, 1, 14515], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:34:03.069119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.06396484375, "l2_diff_relative": 0.30324074074074076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14515, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14515, 128], "attention_shape": [1, 32, 1, 14515]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:34:55.728782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1522105973675329, "overlap_percentage": 0.26420620972466313, "num_intersection": 451, "num_union": 2963, "num_only_computed": 1256, "num_only_roped": 1256, "total_diff": 2512, "diff_percentage": 0.847789402632467, "num_computed": 1707, "num_roped": 1707}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14516, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14516, 128], "mask_shape": [1, 32, 1, 14516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:34:57.443219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.053955078125, "l2_diff_relative": 0.29864864864864865}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14516, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14516, 128], "attention_shape": [1, 32, 1, 14516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:28.696225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:28.708813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0030623070987654323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:34.571354", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5196235782967144, "overlap_percentage": 0.6838845957880435, "num_intersection": 322137, "num_union": 619943, "num_only_computed": 148903, "num_only_roped": 148903, "total_diff": 297806, "diff_percentage": 0.48037642170328565, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:35.876315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 7.62939453125e-05, "l2_diff": 0.953125, "l2_diff_relative": 0.10374149659863946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:50.754341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40526481926330554, "overlap_percentage": 0.5767807088143873, "num_intersection": 332521, "num_union": 820503, "num_only_computed": 243991, "num_only_roped": 243991, "total_diff": 487982, "diff_percentage": 0.5947351807366944, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:35:51.313145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 5.626678466796875e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.10355839416058395}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:12.346416", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3372293964244195, "overlap_percentage": 0.5043703007518797, "num_intersection": 343456, "num_union": 1018464, "num_only_computed": 337504, "num_only_roped": 337504, "total_diff": 675008, "diff_percentage": 0.6627706035755805, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:13.091342", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 6.580352783203125e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.14960629921259844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:40.017959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2977479280030033, "overlap_percentage": 0.45886866251627606, "num_intersection": 360869, "num_union": 1211995, "num_only_computed": 425563, "num_only_roped": 425563, "total_diff": 851126, "diff_percentage": 0.7022520719969967, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:36:40.944089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 5.698204040527344e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.1725206611570248}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:13.184691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26717170711447047, "overlap_percentage": 0.42168193247126434, "num_intersection": 375668, "num_union": 1406092, "num_only_computed": 515212, "num_only_roped": 515212, "total_diff": 1030424, "diff_percentage": 0.7328282928855295, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:14.275810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06982421875, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.25, "l2_diff_relative": 0.15384615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:51.384475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23970635491995007, "overlap_percentage": 0.38671473122427985, "num_intersection": 384908, "num_union": 1605748, "num_only_computed": 610420, "num_only_roped": 610420, "total_diff": 1220840, "diff_percentage": 0.7602936450800499, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:37:54.045139", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.17211538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:38:36.916076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22138895268782127, "overlap_percentage": 0.36251998546511627, "num_intersection": 399062, "num_union": 1802538, "num_only_computed": 701738, "num_only_roped": 701738, "total_diff": 1403476, "diff_percentage": 0.7786110473121787, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:38:38.393700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:39:27.265121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1896058723840225, "overlap_percentage": 0.31877090855989804, "num_intersection": 384198, "num_union": 2026298, "num_only_computed": 821050, "num_only_roped": 821050, "total_diff": 1642100, "diff_percentage": 0.8103941276159775, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:39:30.427351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 6.246566772460938e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.4354066985645933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:40:25.694774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15884368491992235, "overlap_percentage": 0.2741416931152344, "num_intersection": 359323, "num_union": 2262117, "num_only_computed": 951397, "num_only_roped": 951397, "total_diff": 1902794, "diff_percentage": 0.8411563150800776, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:40:27.622143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 0.00010061264038085938, "l2_diff": 4.6875, "l2_diff_relative": 1.0067114093959733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:41:29.999337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1498942872883105, "overlap_percentage": 0.2607096825253256, "num_intersection": 368948, "num_union": 2461388, "num_only_computed": 1046220, "num_only_roped": 1046220, "total_diff": 2092440, "diff_percentage": 0.8501057127116896, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:41:34.198657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.53125, "l2_diff_relative": 0.8055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:42:43.326217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14787757058303877, "overlap_percentage": 0.25765390730289756, "num_intersection": 391535, "num_union": 2647697, "num_only_computed": 1128081, "num_only_roped": 1128081, "total_diff": 2256162, "diff_percentage": 0.8521224294169613, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:42:45.766407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.390975952148438e-05, "l2_diff": 4.1875, "l2_diff_relative": 0.7486033519553073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:44:01.946514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1511645080844562, "overlap_percentage": 0.2626288545604915, "num_intersection": 426795, "num_union": 2823381, "num_only_computed": 1198293, "num_only_roped": 1198293, "total_diff": 2396586, "diff_percentage": 0.8488354919155439, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:44:06.650989", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 6.866455078125e-05, "l2_diff": 3.890625, "l2_diff_relative": 0.7638036809815951}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:45:30.095525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13945574085646154, "overlap_percentage": 0.24477605554322085, "num_intersection": 423349, "num_union": 3035723, "num_only_computed": 1306187, "num_only_roped": 1306187, "total_diff": 2612374, "diff_percentage": 0.8605442591435385, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:45:32.977788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 6.29425048828125e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.804635761589404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:46:56.435471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13868128217904002, "overlap_percentage": 0.24358226371061845, "num_intersection": 105210, "num_union": 758646, "num_only_computed": 326718, "num_only_roped": 326718, "total_diff": 653436, "diff_percentage": 0.8613187178209599, "num_computed": 431928, "num_roped": 431928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:46:59.095178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.6416184971098265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:48:14.126321", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13035611481207335, "overlap_percentage": 0.23064610011641443, "num_intersection": 12680, "num_union": 97272, "num_only_computed": 42296, "num_only_roped": 42296, "total_diff": 84592, "diff_percentage": 0.8696438851879267, "num_computed": 54976, "num_roped": 54976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:48:17.602175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10400390625, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.451171875, "l2_diff_relative": 0.41847826086956524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:18.986068", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14190761050182785, "overlap_percentage": 0.24854481955762514, "num_intersection": 427, "num_union": 3009, "num_only_computed": 1291, "num_only_roped": 1291, "total_diff": 2582, "diff_percentage": 0.8580923894981721, "num_computed": 1718, "num_roped": 1718}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:20.707781", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.047119140625, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.10400390625, "l2_diff_relative": 0.841897233201581}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:53.276125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:53.288701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.0030137624172185433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:59.226998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49394464628075846, "overlap_percentage": 0.6612623131793478, "num_intersection": 311481, "num_union": 630599, "num_only_computed": 159559, "num_only_roped": 159559, "total_diff": 319118, "diff_percentage": 0.5060553537192416, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:49:59.617951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 0.00011301040649414062, "l2_diff": 1.1953125, "l2_diff_relative": 0.14166666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:50:14.720861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41838723010608775, "overlap_percentage": 0.5899478241563055, "num_intersection": 340112, "num_union": 812912, "num_only_computed": 236400, "num_only_roped": 236400, "total_diff": 472800, "diff_percentage": 0.5816127698939123, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:50:15.263217", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.07996323529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:50:35.005772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3498871063341375, "overlap_percentage": 0.5183946193609023, "num_intersection": 353006, "num_union": 1008914, "num_only_computed": 327954, "num_only_roped": 327954, "total_diff": 655908, "diff_percentage": 0.6501128936658626, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:50:35.723237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 5.245208740234375e-05, "l2_diff": 1.0, "l2_diff_relative": 0.12648221343873517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:51:02.112507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27828874919236535, "overlap_percentage": 0.4354082743326823, "num_intersection": 342419, "num_union": 1230445, "num_only_computed": 444013, "num_only_roped": 444013, "total_diff": 888026, "diff_percentage": 0.7217112508076347, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:51:03.657736", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.1259328358208955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:51:34.512770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2456776434365199, "overlap_percentage": 0.3944481860632184, "num_intersection": 351406, "num_union": 1430354, "num_only_computed": 539474, "num_only_roped": 539474, "total_diff": 1078948, "diff_percentage": 0.7543223565634801, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:51:35.586279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:52:12.150217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2379932461426519, "overlap_percentage": 0.3844823013117284, "num_intersection": 382686, "num_union": 1607970, "num_only_computed": 612642, "num_only_roped": 612642, "total_diff": 1225284, "diff_percentage": 0.7620067538573481, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:52:13.405460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 4.9114227294921875e-05, "l2_diff": 1.6953125, "l2_diff_relative": 0.22142857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:52:55.763401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22851041438232142, "overlap_percentage": 0.3720121729651163, "num_intersection": 409511, "num_union": 1792089, "num_only_computed": 691289, "num_only_roped": 691289, "total_diff": 1382578, "diff_percentage": 0.7714895856176786, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:52:57.229371", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.1728515625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:53:46.856685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19571575400903993, "overlap_percentage": 0.32736167162276975, "num_intersection": 394552, "num_union": 2015944, "num_only_computed": 810696, "num_only_roped": 810696, "total_diff": 1621392, "diff_percentage": 0.80428424599096, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:53:50.082712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 7.009506225585938e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.5082417582417582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:54:45.735713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15950541970058732, "overlap_percentage": 0.27512664794921876, "num_intersection": 360614, "num_union": 2260826, "num_only_computed": 950106, "num_only_roped": 950106, "total_diff": 1900212, "diff_percentage": 0.8404945802994127, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:54:47.646625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.0, "l2_diff_relative": 0.8050314465408805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:55:48.759010", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1501209109014049, "overlap_percentage": 0.2610523980191751, "num_intersection": 369433, "num_union": 2460903, "num_only_computed": 1045735, "num_only_roped": 1045735, "total_diff": 2091470, "diff_percentage": 0.8498790890985951, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:55:50.871855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 8.106231689453125e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.8333333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:57:01.721596", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1484796371096497, "overlap_percentage": 0.2585672959484501, "num_intersection": 392923, "num_union": 2646309, "num_only_computed": 1126693, "num_only_roped": 1126693, "total_diff": 2253386, "diff_percentage": 0.8515203628903503, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:57:05.187182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 7.915496826171875e-05, "l2_diff": 4.0, "l2_diff_relative": 0.8366013071895425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:20.911602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15185683442936912, "overlap_percentage": 0.2636731057025835, "num_intersection": 428492, "num_union": 2821684, "num_only_computed": 1196596, "num_only_roped": 1196596, "total_diff": 2393192, "diff_percentage": 0.8481431655706309, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:58:23.575663", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.152557373046875e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.8346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:59:46.927386", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14390441272032267, "overlap_percentage": 0.25160216381734757, "num_intersection": 435155, "num_union": 3023917, "num_only_computed": 1294381, "num_only_roped": 1294381, "total_diff": 2588762, "diff_percentage": 0.8560955872796773, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T19:59:49.762146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.580352783203125e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.7919254658385093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:01:19.590691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1290925581126331, "overlap_percentage": 0.22866603306361608, "num_intersection": 419604, "num_union": 3250412, "num_only_computed": 1415404, "num_only_roped": 1415404, "total_diff": 2830808, "diff_percentage": 0.8709074418873669, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:01:22.718692", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.5255681818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:02:54.650734", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13171991722558962, "overlap_percentage": 0.2327782965037867, "num_intersection": 188475, "num_union": 1430877, "num_only_computed": 621201, "num_only_roped": 621201, "total_diff": 1242402, "diff_percentage": 0.8682800827744104, "num_computed": 809676, "num_roped": 809676}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 441, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:02:57.655027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.4836273193359375e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.6351931330472103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 441, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:04:19.291622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1346554518095532, "overlap_percentage": 0.23735038084874863, "num_intersection": 10470, "num_union": 77754, "num_only_computed": 33642, "num_only_roped": 33642, "total_diff": 67284, "diff_percentage": 0.8653445481904468, "num_computed": 44112, "num_roped": 44112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:04:21.567903", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 3.0517578125e-05, "l2_diff": 0.177734375, "l2_diff_relative": 0.15689655172413794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:05:27.570108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13949163050216987, "overlap_percentage": 0.24483133841131666, "num_intersection": 450, "num_union": 3226, "num_only_computed": 1388, "num_only_roped": 1388, "total_diff": 2776, "diff_percentage": 0.8605083694978302, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:05:29.450630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 5.841255187988281e-05, "l2_diff": 0.095703125, "l2_diff_relative": 0.6125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:06:27.402841", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13808049535603714, "overlap_percentage": 0.2426550598476605, "num_intersection": 446, "num_union": 3230, "num_only_computed": 1392, "num_only_roped": 1392, "total_diff": 2784, "diff_percentage": 0.8619195046439628, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:06:29.289909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.0634765625, "l2_diff_relative": 0.35911602209944754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:07:27.233071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1276073619631902, "overlap_percentage": 0.22633297062023938, "num_intersection": 416, "num_union": 3260, "num_only_computed": 1422, "num_only_roped": 1422, "total_diff": 2844, "diff_percentage": 0.8723926380368098, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:07:29.116202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.0751953125, "l2_diff_relative": 0.37745098039215685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:08:28.223831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13597033374536466, "overlap_percentage": 0.23939064200217627, "num_intersection": 440, "num_union": 3236, "num_only_computed": 1398, "num_only_roped": 1398, "total_diff": 2796, "diff_percentage": 0.8640296662546354, "num_computed": 1838, "num_roped": 1838}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "mask_shape": [1, 32, 1, 15829], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:08:30.824210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 6.29425048828125e-05, "l2_diff": 0.1279296875, "l2_diff_relative": 0.7043010752688172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "attention_shape": [1, 32, 1, 15829]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:09:28.215131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1355356591540599, "overlap_percentage": 0.23871669385535618, "num_intersection": 439, "num_union": 3239, "num_only_computed": 1400, "num_only_roped": 1400, "total_diff": 2800, "diff_percentage": 0.8644643408459401, "num_computed": 1839, "num_roped": 1839}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "mask_shape": [1, 32, 1, 15830], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:09:30.081962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.0810546875, "l2_diff_relative": 0.46111111111111114}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "attention_shape": [1, 32, 1, 15830]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:00.867780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:00.878239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030967310855263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:06.787391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5130922763359294, "overlap_percentage": 0.6782035495923913, "num_intersection": 319461, "num_union": 622619, "num_only_computed": 151579, "num_only_roped": 151579, "total_diff": 303158, "diff_percentage": 0.48690772366407065, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:07.179527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 7.677078247070312e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.10009057971014493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:19.104638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45994480827052187, "overlap_percentage": 0.6300852000225695, "num_intersection": 55835, "num_union": 121395, "num_only_computed": 32780, "num_only_roped": 32780, "total_diff": 65560, "diff_percentage": 0.5400551917294781, "num_computed": 88615, "num_roped": 88615}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:20.457481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 0.00013065338134765625, "l2_diff": 0.58203125, "l2_diff_relative": 0.19005102040816327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:31.793819", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4720284000489656, "overlap_percentage": 0.6413305613305613, "num_intersection": 7712, "num_union": 16338, "num_only_computed": 4313, "num_only_roped": 4313, "total_diff": 8626, "diff_percentage": 0.5279715999510344, "num_computed": 12025, "num_roped": 12025}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:34.606937", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 0.000125885009765625, "l2_diff": 0.1787109375, "l2_diff_relative": 0.1525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:45.092696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45317220543806647, "overlap_percentage": 0.6237006237006237, "num_intersection": 300, "num_union": 662, "num_only_computed": 181, "num_only_roped": 181, "total_diff": 362, "diff_percentage": 0.5468277945619335, "num_computed": 481, "num_roped": 481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:45.415450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 4.57763671875e-05, "l2_diff": 0.01470947265625, "l2_diff_relative": 0.054972627737226276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:58.053132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4672754946727549, "overlap_percentage": 0.6369294605809128, "num_intersection": 307, "num_union": 657, "num_only_computed": 175, "num_only_roped": 175, "total_diff": 350, "diff_percentage": 0.532724505327245, "num_computed": 482, "num_roped": 482}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:10:58.372550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.0084228515625, "l2_diff_relative": 0.036702127659574466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:06.636065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:06.648652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031105324074074073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:12.608112", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5113469738729228, "overlap_percentage": 0.6766771399456522, "num_intersection": 318742, "num_union": 623338, "num_only_computed": 152298, "num_only_roped": 152298, "total_diff": 304596, "diff_percentage": 0.4886530261270771, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:12.996689", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 8.296966552734375e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.10541044776119403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:27.680216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39746425511130395, "overlap_percentage": 0.5688363815497336, "num_intersection": 327941, "num_union": 825083, "num_only_computed": 248571, "num_only_roped": 248571, "total_diff": 497142, "diff_percentage": 0.6025357448886961, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:30.628265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 6.914138793945312e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1259259259259259}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:50.719957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3393888015798242, "overlap_percentage": 0.506781602443609, "num_intersection": 345098, "num_union": 1016822, "num_only_computed": 335862, "num_only_roped": 335862, "total_diff": 671724, "diff_percentage": 0.6606111984201758, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:11:51.449959", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.09419642857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:12:17.146277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3034554085231642, "overlap_percentage": 0.4656168619791667, "num_intersection": 366176, "num_union": 1206688, "num_only_computed": 420256, "num_only_roped": 420256, "total_diff": 840512, "diff_percentage": 0.6965445914768358, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:12:18.076902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.11824324324324324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:12:49.609121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2725775451943728, "overlap_percentage": 0.42838653915229885, "num_intersection": 381641, "num_union": 1400119, "num_only_computed": 509239, "num_only_roped": 509239, "total_diff": 1018478, "diff_percentage": 0.7274224548056273, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:12:50.714231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.09685430463576158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:13:30.512861", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24538358937656246, "overlap_percentage": 0.39406909079218105, "num_intersection": 392228, "num_union": 1598428, "num_only_computed": 603100, "num_only_roped": 603100, "total_diff": 1206200, "diff_percentage": 0.7546164106234375, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:13:31.800860", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.14248251748251747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:14:14.317123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.220790930126687, "overlap_percentage": 0.36171784156976744, "num_intersection": 398179, "num_union": 1803421, "num_only_computed": 702621, "num_only_roped": 702621, "total_diff": 1405242, "diff_percentage": 0.779209069873313, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:14:17.833945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.19146825396825398}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:15:06.134489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19602841496325574, "overlap_percentage": 0.3277989260301614, "num_intersection": 395079, "num_union": 2015417, "num_only_computed": 810169, "num_only_roped": 810169, "total_diff": 1620338, "diff_percentage": 0.8039715850367443, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:15:07.770994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.4268867924528302}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:16:02.224190", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15780059227393883, "overlap_percentage": 0.2725868225097656, "num_intersection": 357285, "num_union": 2264155, "num_only_computed": 953435, "num_only_roped": 953435, "total_diff": 1906870, "diff_percentage": 0.8421994077260612, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:16:04.113171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2001953125, "mean_diff": 0.00010061264038085938, "l2_diff": 4.4375, "l2_diff_relative": 1.0070921985815602}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:17:05.507076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14941003279287693, "overlap_percentage": 0.2599769073353835, "num_intersection": 367911, "num_union": 2462425, "num_only_computed": 1047257, "num_only_roped": 1047257, "total_diff": 2094514, "diff_percentage": 0.8505899672071231, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:17:07.654906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 8.249282836914062e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.807909604519774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:18:15.932727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14240057270993445, "overlap_percentage": 0.24930059755159314, "num_intersection": 312694, "num_union": 2195876, "num_only_computed": 941591, "num_only_roped": 941591, "total_diff": 1883182, "diff_percentage": 0.8575994272900656, "num_computed": 1254285, "num_roped": 1254285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 855, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:18:18.212678", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2021484375, "mean_diff": 9.870529174804688e-05, "l2_diff": 4.625, "l2_diff_relative": 1.2542372881355932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 855, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:19:21.941234", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14676015254866792, "overlap_percentage": 0.2559561425682508, "num_intersection": 16201, "num_union": 110391, "num_only_computed": 47095, "num_only_roped": 47095, "total_diff": 94190, "diff_percentage": 0.8532398474513321, "num_computed": 63296, "num_roped": 63296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:19:26.443542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.6015625, "l2_diff_relative": 0.48427672955974843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:17.105532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1604256996452503, "overlap_percentage": 0.2764945652173913, "num_intersection": 407, "num_union": 2537, "num_only_computed": 1065, "num_only_roped": 1065, "total_diff": 2130, "diff_percentage": 0.8395743003547497, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:20:19.118161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 8.106231689453125e-05, "l2_diff": 0.10986328125, "l2_diff_relative": 0.9574468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:04.884258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16363636363636364, "overlap_percentage": 0.28125, "num_intersection": 414, "num_union": 2530, "num_only_computed": 1058, "num_only_roped": 1058, "total_diff": 2116, "diff_percentage": 0.8363636363636363, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:06.310996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.059814453125, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.11865234375, "l2_diff_relative": 0.9274809160305344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:50.307569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14775828460038987, "overlap_percentage": 0.25747282608695654, "num_intersection": 379, "num_union": 2565, "num_only_computed": 1093, "num_only_roped": 1093, "total_diff": 2186, "diff_percentage": 0.8522417153996101, "num_computed": 1472, "num_roped": 1472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:21:51.739907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014892578125, "mean_diff": 3.0159950256347656e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.18025751072961374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:16.702360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:16.711749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.002972146739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:22.669372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5111433346914289, "overlap_percentage": 0.6764988111413044, "num_intersection": 318658, "num_union": 623422, "num_only_computed": 152382, "num_only_roped": 152382, "total_diff": 304764, "diff_percentage": 0.4888566653085711, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:23.059655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 9.489059448242188e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.12226277372262774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:37.712781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3994826998166024, "overlap_percentage": 0.5709005189831261, "num_intersection": 329131, "num_union": 823893, "num_only_computed": 247381, "num_only_roped": 247381, "total_diff": 494762, "diff_percentage": 0.6005173001833976, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:22:40.544065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.11764705882352941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:23:00.521599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3354814732736025, "overlap_percentage": 0.5024127702067669, "num_intersection": 342123, "num_union": 1019797, "num_only_computed": 338837, "num_only_roped": 338837, "total_diff": 677674, "diff_percentage": 0.6645185267263976, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:23:01.276162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 6.008148193359375e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.14204545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:23:26.957982", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31031926069277144, "overlap_percentage": 0.47365442911783856, "num_intersection": 372497, "num_union": 1200367, "num_only_computed": 413935, "num_only_roped": 413935, "total_diff": 827870, "diff_percentage": 0.6896807393072285, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:23:27.855024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.10431985294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:23:59.098727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27256936508662066, "overlap_percentage": 0.4283764367816092, "num_intersection": 381632, "num_union": 1400128, "num_only_computed": 509248, "num_only_roped": 509248, "total_diff": 1018496, "diff_percentage": 0.7274306349133793, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:24:00.193474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.13468992248062014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:24:38.450755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25041520204824635, "overlap_percentage": 0.4005312821502058, "num_intersection": 398660, "num_union": 1591996, "num_only_computed": 596668, "num_only_roped": 596668, "total_diff": 1193336, "diff_percentage": 0.7495847979517537, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:24:39.712051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.1437007874015748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:25:22.676599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22212051453849352, "overlap_percentage": 0.36350018168604653, "num_intersection": 400141, "num_union": 1801459, "num_only_computed": 700659, "num_only_roped": 700659, "total_diff": 1401318, "diff_percentage": 0.7778794854615064, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:25:24.181693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.173683166503906e-05, "l2_diff": 1.6328125, "l2_diff_relative": 0.2524154589371981}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:26:12.802117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2028442363405671, "overlap_percentage": 0.33727432066795865, "num_intersection": 200317, "num_union": 987541, "num_only_computed": 393612, "num_only_roped": 393612, "total_diff": 787224, "diff_percentage": 0.7971557636594329, "num_computed": 593929, "num_roped": 593929}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 527, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:26:14.253901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 6.246566772460938e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.3520408163265306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 527, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:26:57.607221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1869861815637572, "overlap_percentage": 0.3150604185086944, "num_intersection": 11759, "num_union": 62887, "num_only_computed": 25564, "num_only_roped": 25564, "total_diff": 51128, "diff_percentage": 0.8130138184362428, "num_computed": 37323, "num_roped": 37323}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:26:58.896846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08642578125, "mean_diff": 6.67572021484375e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.3536184210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:27:35.493555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2, "overlap_percentage": 0.3333333333333333, "num_intersection": 377, "num_union": 1885, "num_only_computed": 754, "num_only_roped": 754, "total_diff": 1508, "diff_percentage": 0.8, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:27:36.561662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.042724609375, "mean_diff": 9.679794311523438e-05, "l2_diff": 0.0791015625, "l2_diff_relative": 0.7232142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:28:09.239777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20447284345047922, "overlap_percentage": 0.3395225464190981, "num_intersection": 384, "num_union": 1878, "num_only_computed": 747, "num_only_roped": 747, "total_diff": 1494, "diff_percentage": 0.7955271565495208, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:28:10.314539", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 6.628036499023438e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.3581081081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:28:42.721004", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1911532385466035, "overlap_percentage": 0.3209549071618037, "num_intersection": 363, "num_union": 1899, "num_only_computed": 768, "num_only_roped": 768, "total_diff": 1536, "diff_percentage": 0.8088467614533965, "num_computed": 1131, "num_roped": 1131}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:28:43.759494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.25870646766169153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:04.859367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:04.873118", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030565137987012985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:10.734213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5087136025726027, "overlap_percentage": 0.6743673573369565, "num_intersection": 317654, "num_union": 624426, "num_only_computed": 153386, "num_only_roped": 153386, "total_diff": 306772, "diff_percentage": 0.4912863974273973, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:11.121597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 9.632110595703125e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:25.713715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4096768080593201, "overlap_percentage": 0.5812350827042628, "num_intersection": 335089, "num_union": 817935, "num_only_computed": 241423, "num_only_roped": 241423, "total_diff": 482846, "diff_percentage": 0.5903231919406798, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:26.265791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 9.250640869140625e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.167}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:46.380904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3501319975295693, "overlap_percentage": 0.5186633576127819, "num_intersection": 353189, "num_union": 1008731, "num_only_computed": 327771, "num_only_roped": 327771, "total_diff": 655542, "diff_percentage": 0.6498680024704306, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:29:47.119128", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 7.295608520507812e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.1680327868852459}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:30:12.646432", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2981035155814777, "overlap_percentage": 0.4592908223470052, "num_intersection": 361201, "num_union": 1211663, "num_only_computed": 425231, "num_only_roped": 425231, "total_diff": 850462, "diff_percentage": 0.7018964844185223, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:30:13.550640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:30:44.795159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26187683782910953, "overlap_percentage": 0.4150592672413793, "num_intersection": 369768, "num_union": 1411992, "num_only_computed": 521112, "num_only_roped": 521112, "total_diff": 1042224, "diff_percentage": 0.7381231621708905, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:30:48.391013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 5.745887756347656e-05, "l2_diff": 1.5703125, "l2_diff_relative": 0.21474358974358973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:31:25.332663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23489213453034974, "overlap_percentage": 0.3804253472222222, "num_intersection": 378648, "num_union": 1612008, "num_only_computed": 616680, "num_only_roped": 616680, "total_diff": 1233360, "diff_percentage": 0.7651078654696503, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:31:26.610750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.4765625, "l2_diff_relative": 0.20723684210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:32:11.539132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22198010064018525, "overlap_percentage": 0.36331213662790696, "num_intersection": 399934, "num_union": 1801666, "num_only_computed": 700866, "num_only_roped": 700866, "total_diff": 1401732, "diff_percentage": 0.7780198993598147, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:32:13.033632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 2.6941299438476562e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.13365384615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:33:02.767679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19669581336975306, "overlap_percentage": 0.3287315141779949, "num_intersection": 396203, "num_union": 2014293, "num_only_computed": 809045, "num_only_roped": 809045, "total_diff": 1618090, "diff_percentage": 0.8033041866302469, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:33:04.461825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.32207207207207206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:34:01.006953", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15680531732229294, "overlap_percentage": 0.2711006164550781, "num_intersection": 355337, "num_union": 2266103, "num_only_computed": 955383, "num_only_roped": 955383, "total_diff": 1910766, "diff_percentage": 0.843194682677707, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:34:03.654483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.104873657226562e-05, "l2_diff": 3.3125, "l2_diff_relative": 0.5792349726775956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:35:05.470690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14532395061528564, "overlap_percentage": 0.25376916380246023, "num_intersection": 359126, "num_union": 2471210, "num_only_computed": 1056042, "num_only_roped": 1056042, "total_diff": 2112084, "diff_percentage": 0.8546760493847144, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:35:07.589642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 6.008148193359375e-05, "l2_diff": 3.15625, "l2_diff_relative": 0.51010101010101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:36:17.642049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1433326486651604, "overlap_percentage": 0.25072781544811323, "num_intersection": 381010, "num_union": 2658222, "num_only_computed": 1138606, "num_only_roped": 1138606, "total_diff": 2277212, "diff_percentage": 0.8566673513348396, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:36:21.772478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.62939453125e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.8012820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:37:38.908226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14067318534865333, "overlap_percentage": 0.24664941221644612, "num_intersection": 400827, "num_union": 2849349, "num_only_computed": 1224261, "num_only_roped": 1224261, "total_diff": 2448522, "diff_percentage": 0.8593268146513466, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:37:42.305710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 7.43865966796875e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.897887323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:39:05.714009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13743395112128134, "overlap_percentage": 0.24165614361308466, "num_intersection": 417953, "num_union": 3041119, "num_only_computed": 1311583, "num_only_roped": 1311583, "total_diff": 2623166, "diff_percentage": 0.8625660488787187, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:39:08.617951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2421875, "mean_diff": 6.961822509765625e-05, "l2_diff": 4.125, "l2_diff_relative": 0.8741721854304636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:40:39.770540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12546037875409932, "overlap_percentage": 0.2229494367327009, "num_intersection": 409114, "num_union": 3260902, "num_only_computed": 1425894, "num_only_roped": 1425894, "total_diff": 2851788, "diff_percentage": 0.8745396212459007, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:40:44.907669", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 5.602836608886719e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.6656976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:42:22.672335", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1267981785159063, "overlap_percentage": 0.2250592536152496, "num_intersection": 368334, "num_union": 2904884, "num_only_computed": 1268275, "num_only_roped": 1268275, "total_diff": 2536550, "diff_percentage": 0.8732018214840936, "num_computed": 1636609, "num_roped": 1636609}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 871, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:42:25.993628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 5.7697296142578125e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.7961783439490446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 871, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:43:57.769660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11640728592365134, "overlap_percentage": 0.20853910108145277, "num_intersection": 13344, "num_union": 114632, "num_only_computed": 50644, "num_only_roped": 50644, "total_diff": 101288, "diff_percentage": 0.8835927140763487, "num_computed": 63988, "num_roped": 63988}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:44:00.287697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.46484375, "l2_diff_relative": 0.4160839160839161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:45:09.729938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12257679689830003, "overlap_percentage": 0.218384697130712, "num_intersection": 411, "num_union": 3353, "num_only_computed": 1471, "num_only_roped": 1471, "total_diff": 2942, "diff_percentage": 0.8774232031017, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:45:11.648776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.05615234375, "l2_diff_relative": 0.2860696517412935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:46:12.061233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10771041789287816, "overlap_percentage": 0.1944739638682253, "num_intersection": 366, "num_union": 3398, "num_only_computed": 1516, "num_only_roped": 1516, "total_diff": 3032, "diff_percentage": 0.8922895821071218, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:46:13.994703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.3104575163398693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:47:13.587587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11163614884819846, "overlap_percentage": 0.20085015940488843, "num_intersection": 378, "num_union": 3386, "num_only_computed": 1504, "num_only_roped": 1504, "total_diff": 3008, "diff_percentage": 0.8883638511518015, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:47:15.517917", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.11702127659574468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:48:15.559892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12458918434418882, "overlap_percentage": 0.22157279489904358, "num_intersection": 417, "num_union": 3347, "num_only_computed": 1465, "num_only_roped": 1465, "total_diff": 2930, "diff_percentage": 0.8754108156558111, "num_computed": 1882, "num_roped": 1882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:48:17.480378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.04931640625, "l2_diff_relative": 0.20781893004115226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:49:16.955772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11651348947524459, "overlap_percentage": 0.20870950610727562, "num_intersection": 393, "num_union": 3373, "num_only_computed": 1490, "num_only_roped": 1490, "total_diff": 2980, "diff_percentage": 0.8834865105247555, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:49:18.894155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.07958984375, "l2_diff_relative": 0.4453551912568306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:50:18.287834", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11486086441681469, "overlap_percentage": 0.2060541688794477, "num_intersection": 388, "num_union": 3378, "num_only_computed": 1495, "num_only_roped": 1495, "total_diff": 2990, "diff_percentage": 0.8851391355831854, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:50:20.401983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012939453125, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:51:19.885124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12350835322195704, "overlap_percentage": 0.21986192246415295, "num_intersection": 414, "num_union": 3352, "num_only_computed": 1469, "num_only_roped": 1469, "total_diff": 2938, "diff_percentage": 0.8764916467780429, "num_computed": 1883, "num_roped": 1883}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:51:21.809259", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.1096311475409836}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:51:58.205134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:51:58.217757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0029829545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:04.116220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5049249358624149, "overlap_percentage": 0.6710300611413044, "num_intersection": 316082, "num_union": 625998, "num_only_computed": 154958, "num_only_roped": 154958, "total_diff": 309916, "diff_percentage": 0.4950750641375851, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:04.505158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 9.965896606445312e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.12237762237762238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:19.094995", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40068295539166676, "overlap_percentage": 0.5721251248889876, "num_intersection": 329837, "num_union": 823187, "num_only_computed": 246675, "num_only_roped": 246675, "total_diff": 493350, "diff_percentage": 0.5993170446083332, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:19.652239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 6.4849853515625e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.11472602739726027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:39.877730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34960084350052717, "overlap_percentage": 0.5180803571428572, "num_intersection": 352792, "num_union": 1009128, "num_only_computed": 328168, "num_only_roped": 328168, "total_diff": 656336, "diff_percentage": 0.6503991564994728, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:52:40.604525", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.07628676470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:53:06.146724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3006669285315582, "overlap_percentage": 0.4623273213704427, "num_intersection": 363589, "num_union": 1209275, "num_only_computed": 422843, "num_only_roped": 422843, "total_diff": 845686, "diff_percentage": 0.6993330714684418, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:53:07.051679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.08902877697841727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:53:38.448739", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2605261389241637, "overlap_percentage": 0.4133609464798851, "num_intersection": 368255, "num_union": 1413505, "num_only_computed": 522625, "num_only_roped": 522625, "total_diff": 1045250, "diff_percentage": 0.7394738610758363, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:53:39.537176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.09639084507042253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:16.763488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23638698954510362, "overlap_percentage": 0.3823834956918724, "num_intersection": 380597, "num_union": 1610059, "num_only_computed": 614731, "num_only_roped": 614731, "total_diff": 1229462, "diff_percentage": 0.7636130104548964, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:54:18.051639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.16702586206896552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:00.793479", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20999011277156215, "overlap_percentage": 0.3470939316860465, "num_intersection": 382081, "num_union": 1819519, "num_only_computed": 718719, "num_only_roped": 718719, "total_diff": 1437438, "diff_percentage": 0.7900098872284378, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:02.270806", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.19292237442922375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:51.188896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1905406560060295, "overlap_percentage": 0.32009096882965166, "num_intersection": 385789, "num_union": 2024707, "num_only_computed": 819459, "num_only_roped": 819459, "total_diff": 1638918, "diff_percentage": 0.8094593439939705, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:55:52.870418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 7.009506225585938e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.4869791666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:56:47.681619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16251966771975074, "overlap_percentage": 0.2795989990234375, "num_intersection": 366476, "num_union": 2254964, "num_only_computed": 944244, "num_only_roped": 944244, "total_diff": 1888488, "diff_percentage": 0.8374803322802493, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:56:49.626359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 9.679794311523438e-05, "l2_diff": 4.53125, "l2_diff_relative": 0.9119496855345912}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:57:51.653134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15313013219495283, "overlap_percentage": 0.26559037513567296, "num_intersection": 375855, "num_union": 2454481, "num_only_computed": 1039313, "num_only_roped": 1039313, "total_diff": 2078626, "diff_percentage": 0.8468698678050471, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:57:55.290349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.62939453125e-05, "l2_diff": 4.25, "l2_diff_relative": 0.7771428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:59:04.180838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14411254286800607, "overlap_percentage": 0.2519202219508086, "num_intersection": 382822, "num_union": 2656410, "num_only_computed": 1136794, "num_only_roped": 1136794, "total_diff": 2273588, "diff_percentage": 0.8558874571319939, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T20:59:06.924113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 7.534027099609375e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.7988165680473372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:00:23.568609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14552488808827888, "overlap_percentage": 0.25407547160523, "num_intersection": 412895, "num_union": 2837281, "num_only_computed": 1212193, "num_only_roped": 1212193, "total_diff": 2424386, "diff_percentage": 0.8544751119117211, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:00:27.835722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.486343383789062e-05, "l2_diff": 3.96875, "l2_diff_relative": 0.8943661971830986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:01:51.415929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14244835557246568, "overlap_percentage": 0.2493738204928952, "num_intersection": 431301, "num_union": 3027771, "num_only_computed": 1298235, "num_only_roped": 1298235, "total_diff": 2596470, "diff_percentage": 0.8575516444275343, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:01:54.293067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 7.295608520507812e-05, "l2_diff": 4.40625, "l2_diff_relative": 0.9463087248322147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:03:26.660062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13064221121844805, "overlap_percentage": 0.23109381539481028, "num_intersection": 424059, "num_union": 3245957, "num_only_computed": 1410949, "num_only_roped": 1410949, "total_diff": 2821898, "diff_percentage": 0.8693577887815519, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:03:29.799794", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.20703125, "mean_diff": 6.914138793945312e-05, "l2_diff": 4.34375, "l2_diff_relative": 0.9858156028368794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:05:04.546319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13056206377783808, "overlap_percentage": 0.23096841466899645, "num_intersection": 211756, "num_union": 1621880, "num_only_computed": 705062, "num_only_roped": 705062, "total_diff": 1410124, "diff_percentage": 0.8694379362221619, "num_computed": 916818, "num_roped": 916818}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 498, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:05:07.639662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.875, "l2_diff_relative": 0.8177777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 498, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:06:31.817603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1222321052385188, "overlap_percentage": 0.217837477056566, "num_intersection": 10444, "num_union": 85444, "num_only_computed": 37500, "num_only_roped": 37500, "total_diff": 75000, "diff_percentage": 0.8777678947614812, "num_computed": 47944, "num_roped": 47944}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:06:34.148716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.40234375, "l2_diff_relative": 0.40551181102362205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:07:40.120204", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1233627779469997, "overlap_percentage": 0.21963123644251628, "num_intersection": 405, "num_union": 3283, "num_only_computed": 1439, "num_only_roped": 1439, "total_diff": 2878, "diff_percentage": 0.8766372220530003, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:07:41.985660", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.06103515625, "l2_diff_relative": 0.3980891719745223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:08:39.233880", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11656070239176507, "overlap_percentage": 0.20878524945770066, "num_intersection": 385, "num_union": 3303, "num_only_computed": 1459, "num_only_roped": 1459, "total_diff": 2918, "diff_percentage": 0.8834392976082349, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 1, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:08:41.096752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 4.315376281738281e-05, "l2_diff": 0.064453125, "l2_diff_relative": 0.37714285714285717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 1, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:17.675370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:17.687972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.002877058383233533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:23.567555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.51009449311138, "overlap_percentage": 0.6755795686141305, "num_intersection": 318225, "num_union": 623855, "num_only_computed": 152815, "num_only_roped": 152815, "total_diff": 305630, "diff_percentage": 0.48990550688861995, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:23.953255", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 9.72747802734375e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.12410071942446044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:38.523793", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40549607005636495, "overlap_percentage": 0.5770148756660746, "num_intersection": 332656, "num_union": 820368, "num_only_computed": 243856, "num_only_roped": 243856, "total_diff": 487712, "diff_percentage": 0.5945039299436351, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:09:41.261488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 9.34600830078125e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.16265060240963855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:01.560284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3497934555949351, "overlap_percentage": 0.5182918233082707, "num_intersection": 352936, "num_union": 1008984, "num_only_computed": 328024, "num_only_roped": 328024, "total_diff": 656048, "diff_percentage": 0.6502065444050649, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:02.293791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.1676829268292683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:27.822117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3047193781267653, "overlap_percentage": 0.4671033223470052, "num_intersection": 367345, "num_union": 1205519, "num_only_computed": 419087, "num_only_roped": 419087, "total_diff": 838174, "diff_percentage": 0.6952806218732347, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:28.724872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.555152893066406e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.15588235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:10:59.979299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2590244002399676, "overlap_percentage": 0.411468435704023, "num_intersection": 366569, "num_union": 1415191, "num_only_computed": 524311, "num_only_roped": 524311, "total_diff": 1048622, "diff_percentage": 0.7409755997600324, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:11:01.051222", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 5.626678466796875e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.2053191489361702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:11:39.833437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23747531304335392, "overlap_percentage": 0.3838061422968107, "num_intersection": 382013, "num_union": 1608643, "num_only_computed": 613315, "num_only_roped": 613315, "total_diff": 1226630, "diff_percentage": 0.7625246869566461, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:11:41.121287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.19767441860465115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:12:26.868921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22946745786829018, "overlap_percentage": 0.3732794331395349, "num_intersection": 410906, "num_union": 1790694, "num_only_computed": 689894, "num_only_roped": 689894, "total_diff": 1379788, "diff_percentage": 0.7705325421317099, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:12:28.357998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 3.0159950256347656e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.14298561151079137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:13:18.515710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1910842219743915, "overlap_percentage": 0.32085761602591334, "num_intersection": 386713, "num_union": 2023783, "num_only_computed": 818535, "num_only_roped": 818535, "total_diff": 1637070, "diff_percentage": 0.8089157780256084, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:13:22.906973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.375, "l2_diff_relative": 0.41304347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:14:18.720492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15702027027623472, "overlap_percentage": 0.27142181396484377, "num_intersection": 355758, "num_union": 2265682, "num_only_computed": 954962, "num_only_roped": 954962, "total_diff": 1909924, "diff_percentage": 0.8429797297237653, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:14:20.666561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.609375, "l2_diff_relative": 0.6637931034482759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:15:23.678100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15032892250142046, "overlap_percentage": 0.26136684831765555, "num_intersection": 369878, "num_union": 2460458, "num_only_computed": 1045290, "num_only_roped": 1045290, "total_diff": 2090580, "diff_percentage": 0.8496710774985795, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:15:27.819088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 8.7738037109375e-05, "l2_diff": 4.3125, "l2_diff_relative": 0.9517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:16:38.214721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14589064234351623, "overlap_percentage": 0.25463274932614555, "num_intersection": 386944, "num_union": 2652288, "num_only_computed": 1132672, "num_only_roped": 1132672, "total_diff": 2265344, "diff_percentage": 0.8541093576564838, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:16:40.644104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.20703125, "mean_diff": 7.963180541992188e-05, "l2_diff": 4.3125, "l2_diff_relative": 0.8789808917197452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:17:57.753783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.142540964906206, "overlap_percentage": 0.24951571853339635, "num_intersection": 405485, "num_union": 2844691, "num_only_computed": 1219603, "num_only_roped": 1219603, "total_diff": 2439206, "diff_percentage": 0.8574590350937941, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:18:01.060394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.310546875, "mean_diff": 8.58306884765625e-05, "l2_diff": 4.8125, "l2_diff_relative": 1.1407407407407408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:19:25.386522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13684517733298188, "overlap_percentage": 0.2407454947454115, "num_intersection": 416378, "num_union": 3042694, "num_only_computed": 1313158, "num_only_roped": 1313158, "total_diff": 2626316, "diff_percentage": 0.8631548226670182, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:19:28.270502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 7.05718994140625e-05, "l2_diff": 4.0625, "l2_diff_relative": 0.9154929577464789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:21:00.870808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12633079853743362, "overlap_percentage": 0.2243227277483259, "num_intersection": 411634, "num_union": 3258382, "num_only_computed": 1423374, "num_only_roped": 1423374, "total_diff": 2846748, "diff_percentage": 0.8736692014625664, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:21:04.005471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.389617919921875e-05, "l2_diff": 4.1875, "l2_diff_relative": 0.8271604938271605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:22:32.840993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12374428907176184, "overlap_percentage": 0.2202356715405022, "num_intersection": 35698, "num_union": 288482, "num_only_computed": 126392, "num_only_roped": 126392, "total_diff": 252784, "diff_percentage": 0.8762557109282382, "num_computed": 162090, "num_roped": 162090}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:22:37.125488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 6.341934204101562e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.6772727272727272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:23:55.703832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11467744359646632, "overlap_percentage": 0.20575897405165697, "num_intersection": 13734, "num_union": 119762, "num_only_computed": 53014, "num_only_roped": 53014, "total_diff": 106028, "diff_percentage": 0.8853225564035336, "num_computed": 66748, "num_roped": 66748}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:23:59.228029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.6640625, "l2_diff_relative": 0.7142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:25:05.636635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11668214175177964, "overlap_percentage": 0.208980044345898, "num_intersection": 377, "num_union": 3231, "num_only_computed": 1427, "num_only_roped": 1427, "total_diff": 2854, "diff_percentage": 0.8833178582482204, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:25:08.247635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 7.62939453125e-05, "l2_diff": 0.11962890625, "l2_diff_relative": 1.3687150837988826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:26:04.688613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1275, "overlap_percentage": 0.2261640798226164, "num_intersection": 408, "num_union": 3200, "num_only_computed": 1396, "num_only_roped": 1396, "total_diff": 2792, "diff_percentage": 0.8725, "num_computed": 1804, "num_roped": 1804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:26:06.517151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.09423828125, "l2_diff_relative": 0.5676470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:02.814450", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1260137242669994, "overlap_percentage": 0.22382271468144044, "num_intersection": 404, "num_union": 3206, "num_only_computed": 1401, "num_only_roped": 1401, "total_diff": 2802, "diff_percentage": 0.8739862757330006, "num_computed": 1805, "num_roped": 1805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:04.643712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.059326171875, "l2_diff_relative": 0.23011363636363635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:36.546964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:36.556394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.029052734375, "l2_diff_relative": 0.0030784354304635763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:45.136946", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5214421142050575, "overlap_percentage": 0.6854577105978261, "num_intersection": 322878, "num_union": 619202, "num_only_computed": 148162, "num_only_roped": 148162, "total_diff": 296324, "diff_percentage": 0.4785578857949425, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:27:45.536478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 0.00011110305786132812, "l2_diff": 1.1953125, "l2_diff_relative": 0.13660714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:01.268474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4251614242912658, "overlap_percentage": 0.5966501998223801, "num_intersection": 343976, "num_union": 809048, "num_only_computed": 232536, "num_only_roped": 232536, "total_diff": 465072, "diff_percentage": 0.5748385757087342, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:01.821690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1392156862745098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:21.745089", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34592635709859737, "overlap_percentage": 0.5140345982142858, "num_intersection": 350037, "num_union": 1011883, "num_only_computed": 330923, "num_only_roped": 330923, "total_diff": 661846, "diff_percentage": 0.6540736429014027, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:22.479445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.83984375, "l2_diff_relative": 0.09331597222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:48.577340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29853112120891895, "overlap_percentage": 0.4597981770833333, "num_intersection": 361600, "num_union": 1211264, "num_only_computed": 424832, "num_only_roped": 424832, "total_diff": 849664, "diff_percentage": 0.7014688787910811, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:28:49.640766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.13516260162601626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:29:21.045815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2722840360400502, "overlap_percentage": 0.42802397629310346, "num_intersection": 381318, "num_union": 1400442, "num_only_computed": 509562, "num_only_roped": 509562, "total_diff": 1019124, "diff_percentage": 0.7277159639599498, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:29:22.136446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.153921568627451}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:29:59.379723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24433420678895046, "overlap_percentage": 0.3927147633744856, "num_intersection": 390880, "num_union": 1599776, "num_only_computed": 604448, "num_only_roped": 604448, "total_diff": 1208896, "diff_percentage": 0.7556657932110495, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:30:00.665568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.875, "l2_diff_relative": 0.10071942446043165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:30:43.631634", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22175970912174367, "overlap_percentage": 0.3630168968023256, "num_intersection": 399609, "num_union": 1801991, "num_only_computed": 701191, "num_only_roped": 701191, "total_diff": 1402382, "diff_percentage": 0.7782402908782563, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:30:45.136383", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.16495901639344263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:31:34.480898", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18882908155464875, "overlap_percentage": 0.31767237946049276, "num_intersection": 382874, "num_union": 2027622, "num_only_computed": 822374, "num_only_roped": 822374, "total_diff": 1644748, "diff_percentage": 0.8111709184453513, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:31:36.197045", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 5.412101745605469e-05, "l2_diff": 2.125, "l2_diff_relative": 0.3417085427135678}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:32:32.048294", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15857838316829714, "overlap_percentage": 0.2737464904785156, "num_intersection": 358805, "num_union": 2262635, "num_only_computed": 951915, "num_only_roped": 951915, "total_diff": 1903830, "diff_percentage": 0.8414216168317029, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:32:34.005190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1875, "mean_diff": 8.106231689453125e-05, "l2_diff": 3.859375, "l2_diff_relative": 0.7180232558139535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:26.744873", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14794736842105263, "overlap_percentage": 0.25775984594929163, "num_intersection": 11244, "num_union": 76000, "num_only_computed": 32378, "num_only_roped": 32378, "total_diff": 64756, "diff_percentage": 0.8520526315789474, "num_computed": 43622, "num_roped": 43622}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "mask_shape": [1, 32, 34, 10274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:33:28.189452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.32421875, "l2_diff_relative": 0.23184357541899442}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "attention_shape": [1, 32, 34, 10274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:13.945074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15316964606217245, "overlap_percentage": 0.2656498054474708, "num_intersection": 8534, "num_union": 55716, "num_only_computed": 23591, "num_only_roped": 23591, "total_diff": 47182, "diff_percentage": 0.8468303539378276, "num_computed": 32125, "num_roped": 32125}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 25, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:15.413747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 7.2479248046875e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.46356275303643724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 25, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:57.563191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15960324616771868, "overlap_percentage": 0.27527216174183516, "num_intersection": 354, "num_union": 2218, "num_only_computed": 932, "num_only_roped": 932, "total_diff": 1864, "diff_percentage": 0.8403967538322813, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "mask_shape": [1, 32, 1, 10300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:34:58.779983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 9.72747802734375e-05, "l2_diff": 0.09228515625, "l2_diff_relative": 1.0738636363636365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "attention_shape": [1, 32, 1, 10300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:36.329872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15699505173189385, "overlap_percentage": 0.2713841368584759, "num_intersection": 349, "num_union": 2223, "num_only_computed": 937, "num_only_roped": 937, "total_diff": 1874, "diff_percentage": 0.8430049482681061, "num_computed": 1286, "num_roped": 1286}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "mask_shape": [1, 32, 1, 10301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:35:37.546099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 6.008148193359375e-05, "l2_diff": 0.05859375, "l2_diff_relative": 0.40816326530612246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "attention_shape": [1, 32, 1, 10301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:02.343175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:02.356870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.032470703125, "l2_diff_relative": 0.00326749213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:08.465892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5015261031374768, "overlap_percentage": 0.6680218240489131, "num_intersection": 314665, "num_union": 627415, "num_only_computed": 156375, "num_only_roped": 156375, "total_diff": 312750, "diff_percentage": 0.4984738968625232, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:08.869394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 0.00011587142944335938, "l2_diff": 1.1171875, "l2_diff_relative": 0.15084388185654007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:23.574708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39398724038585925, "overlap_percentage": 0.5652666379884547, "num_intersection": 325883, "num_union": 827141, "num_only_computed": 250629, "num_only_roped": 250629, "total_diff": 501258, "diff_percentage": 0.6060127596141408, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:26.861753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 8.0108642578125e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.1551383399209486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:46.806744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33556398041057767, "overlap_percentage": 0.5025052866541353, "num_intersection": 342186, "num_union": 1019734, "num_only_computed": 338774, "num_only_roped": 338774, "total_diff": 677548, "diff_percentage": 0.6644360195894223, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:36:47.530161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 6.103515625e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.13777372262773724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:37:13.031551", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29072452588647535, "overlap_percentage": 0.45048268636067706, "num_intersection": 354274, "num_union": 1218590, "num_only_computed": 432158, "num_only_roped": 432158, "total_diff": 864316, "diff_percentage": 0.7092754741135247, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:37:13.936560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.16765873015873015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:37:45.072810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2704696522209118, "overlap_percentage": 0.4257790050287356, "num_intersection": 379318, "num_union": 1402442, "num_only_computed": 511562, "num_only_roped": 511562, "total_diff": 1023124, "diff_percentage": 0.7295303477790882, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:37:46.160369", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.18}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:38:24.920326", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2539036147765732, "overlap_percentage": 0.40498107156635804, "num_intersection": 403089, "num_union": 1587567, "num_only_computed": 592239, "num_only_roped": 592239, "total_diff": 1184478, "diff_percentage": 0.7460963852234268, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:38:26.211262", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.19978165938864628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:39:09.204074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21440986443245258, "overlap_percentage": 0.3531095566860465, "num_intersection": 388703, "num_union": 1812897, "num_only_computed": 712097, "num_only_roped": 712097, "total_diff": 1424194, "diff_percentage": 0.7855901355675474, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:39:13.154256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.2002262443438914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:40:03.039620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18963053039694885, "overlap_percentage": 0.3188057561597281, "num_intersection": 384240, "num_union": 2026256, "num_only_computed": 821008, "num_only_roped": 821008, "total_diff": 1642016, "diff_percentage": 0.8103694696030511, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:40:06.720832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12158203125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.39037433155080214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:41:02.659412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1655491100229736, "overlap_percentage": 0.2840705871582031, "num_intersection": 372337, "num_union": 2249103, "num_only_computed": 938383, "num_only_roped": 938383, "total_diff": 1876766, "diff_percentage": 0.8344508899770264, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:41:04.624619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 8.535385131835938e-05, "l2_diff": 3.6875, "l2_diff_relative": 0.8027210884353742}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:42:07.671832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1556217180462594, "overlap_percentage": 0.2693298604829957, "num_intersection": 381147, "num_union": 2449189, "num_only_computed": 1034021, "num_only_roped": 1034021, "total_diff": 2068042, "diff_percentage": 0.8443782819537407, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:42:10.998871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 8.392333984375e-05, "l2_diff": 4.375, "l2_diff_relative": 0.8860759493670886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:43:20.465426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14453866260754886, "overlap_percentage": 0.252571044263814, "num_intersection": 383811, "num_union": 2655421, "num_only_computed": 1135805, "num_only_roped": 1135805, "total_diff": 2271610, "diff_percentage": 0.8554613373924511, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:43:22.845668", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 8.0108642578125e-05, "l2_diff": 4.28125, "l2_diff_relative": 0.9319727891156463}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:44:39.375540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14361676486577304, "overlap_percentage": 0.25116239859010714, "num_intersection": 408161, "num_union": 2842015, "num_only_computed": 1216927, "num_only_roped": 1216927, "total_diff": 2433854, "diff_percentage": 0.856383235134227, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:44:43.217792", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.166015625, "mean_diff": 7.05718994140625e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.808641975308642}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:46:07.183203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13839449237844462, "overlap_percentage": 0.2431397785301954, "num_intersection": 420519, "num_union": 3038553, "num_only_computed": 1309017, "num_only_roped": 1309017, "total_diff": 2618034, "diff_percentage": 0.8616055076215554, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:46:10.048303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 5.412101745605469e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.5790960451977402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:40.473323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13102514809584886, "overlap_percentage": 0.2316927228655134, "num_intersection": 425158, "num_union": 3244858, "num_only_computed": 1409850, "num_only_roped": 1409850, "total_diff": 2819700, "diff_percentage": 0.8689748519041511, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:47:43.555551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 5.7697296142578125e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.7380952380952381}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:49:19.908449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12985512173861147, "overlap_percentage": 0.22986154461784714, "num_intersection": 359015, "num_union": 2764735, "num_only_computed": 1202860, "num_only_roped": 1202860, "total_diff": 2405720, "diff_percentage": 0.8701448782613885, "num_computed": 1561875, "num_roped": 1561875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "mask_shape": [1, 32, 833, 16193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:49:23.149145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 5.745887756347656e-05, "l2_diff": 3.046875, "l2_diff_relative": 0.75}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "attention_shape": [1, 32, 833, 16193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:50:51.242660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13174572883500899, "overlap_percentage": 0.2328186013489528, "num_intersection": 13117, "num_union": 99563, "num_only_computed": 43223, "num_only_roped": 43223, "total_diff": 86446, "diff_percentage": 0.868254271164991, "num_computed": 56340, "num_roped": 56340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "mask_shape": [1, 32, 30, 16223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:50:55.861042", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.5, "l2_diff_relative": 0.5079365079365079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "attention_shape": [1, 32, 30, 16223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:52:05.108846", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14233576642335766, "overlap_percentage": 0.24920127795527156, "num_intersection": 468, "num_union": 3288, "num_only_computed": 1410, "num_only_roped": 1410, "total_diff": 2820, "diff_percentage": 0.8576642335766423, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "mask_shape": [1, 32, 1, 16224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:52:07.085302", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.36813186813186816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "attention_shape": [1, 32, 1, 16224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:09.414768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1323485076876696, "overlap_percentage": 0.23375931842385517, "num_intersection": 439, "num_union": 3317, "num_only_computed": 1439, "num_only_roped": 1439, "total_diff": 2878, "diff_percentage": 0.8676514923123304, "num_computed": 1878, "num_roped": 1878}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "mask_shape": [1, 32, 1, 16225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:11.438957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.06103515625, "l2_diff_relative": 0.3531073446327684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "attention_shape": [1, 32, 1, 16225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:47.728271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:47.740818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.00312234268707483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:53.865424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5084623636975005, "overlap_percentage": 0.6741465692934783, "num_intersection": 317550, "num_union": 624530, "num_only_computed": 153490, "num_only_roped": 153490, "total_diff": 306980, "diff_percentage": 0.49153763630249947, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:53:56.542514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.75, "l2_diff_relative": 0.08888888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:11.386276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40223477275270103, "overlap_percentage": 0.5737053174955595, "num_intersection": 330748, "num_union": 822276, "num_only_computed": 245764, "num_only_roped": 245764, "total_diff": 491528, "diff_percentage": 0.597765227247299, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:11.944612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 5.984306335449219e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.10495780590717299}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:32.950650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3240662694234529, "overlap_percentage": 0.4895015859962406, "num_intersection": 333331, "num_union": 1028589, "num_only_computed": 347629, "num_only_roped": 347629, "total_diff": 695258, "diff_percentage": 0.675933730576547, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:33.673591", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.06590136054421769}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:59.070155", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28692265523363797, "overlap_percentage": 0.44590504964192706, "num_intersection": 350674, "num_union": 1222190, "num_only_computed": 435758, "num_only_roped": 435758, "total_diff": 871516, "diff_percentage": 0.713077344766362, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:54:59.972508", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.814697265625e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.1125886524822695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:55:31.017096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25776325170653885, "overlap_percentage": 0.40987562859195403, "num_intersection": 365150, "num_union": 1416610, "num_only_computed": 525730, "num_only_roped": 525730, "total_diff": 1051460, "diff_percentage": 0.7422367482934612, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:55:34.422710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.315376281738281e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.1581439393939394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:11.428595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24343336862520965, "overlap_percentage": 0.3915503231095679, "num_intersection": 389721, "num_union": 1600935, "num_only_computed": 605607, "num_only_roped": 605607, "total_diff": 1211214, "diff_percentage": 0.7565666313747904, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:14.605256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.16316793893129772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:57.926286", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22392298002119185, "overlap_percentage": 0.3659102470930233, "num_intersection": 402794, "num_union": 1798806, "num_only_computed": 698006, "num_only_roped": 698006, "total_diff": 1396012, "diff_percentage": 0.7760770199788082, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:56:59.408613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.1450381679389313}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:57:48.811248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2089279767612613, "overlap_percentage": 0.34564172684791844, "num_intersection": 416584, "num_union": 1993912, "num_only_computed": 788664, "num_only_roped": 788664, "total_diff": 1577328, "diff_percentage": 0.7910720232387387, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:57:53.003845", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11474609375, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.3380952380952381}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:58:48.393646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16999791569127415, "overlap_percentage": 0.29059524536132814, "num_intersection": 380889, "num_union": 2240551, "num_only_computed": 929831, "num_only_roped": 929831, "total_diff": 1859662, "diff_percentage": 0.8300020843087258, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:58:50.302289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 7.677078247070312e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:59:52.842059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1620826647703291, "overlap_percentage": 0.27895203961649784, "num_intersection": 394764, "num_union": 2435572, "num_only_computed": 1020404, "num_only_roped": 1020404, "total_diff": 2040808, "diff_percentage": 0.8379173352296709, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T21:59:55.776388", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.152557373046875e-05, "l2_diff": 3.59375, "l2_diff_relative": 0.672514619883041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:01:04.561480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1621110927569032, "overlap_percentage": 0.2789941405211498, "num_intersection": 393531, "num_union": 2427539, "num_only_computed": 1017004, "num_only_roped": 1017004, "total_diff": 2034008, "diff_percentage": 0.8378889072430968, "num_computed": 1410535, "num_roped": 1410535}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "mask_shape": [1, 32, 955, 12219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:01:06.964782", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.295608520507812e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.7953020134228188}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "attention_shape": [1, 32, 955, 12219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:02:11.661750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16725818263759787, "overlap_percentage": 0.2865830115830116, "num_intersection": 11876, "num_union": 71004, "num_only_computed": 29564, "num_only_roped": 29564, "total_diff": 59128, "diff_percentage": 0.8327418173624022, "num_computed": 41440, "num_roped": 41440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "mask_shape": [1, 32, 28, 12247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:02:15.836291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 5.340576171875e-05, "l2_diff": 0.326171875, "l2_diff_relative": 0.29401408450704225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "attention_shape": [1, 32, 28, 12247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:03:06.145586", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17740652346857597, "overlap_percentage": 0.3013513513513513, "num_intersection": 446, "num_union": 2514, "num_only_computed": 1034, "num_only_roped": 1034, "total_diff": 2068, "diff_percentage": 0.822593476531424, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "mask_shape": [1, 32, 1, 12248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:03:08.218179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 7.295608520507812e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.5461538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "attention_shape": [1, 32, 1, 12248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:03:53.961615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17042309213127718, "overlap_percentage": 0.29121621621621624, "num_intersection": 431, "num_union": 2529, "num_only_computed": 1049, "num_only_roped": 1049, "total_diff": 2098, "diff_percentage": 0.8295769078687228, "num_computed": 1480, "num_roped": 1480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "mask_shape": [1, 32, 1, 12249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:03:55.386607", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 7.009506225585938e-05, "l2_diff": 0.06689453125, "l2_diff_relative": 0.5150375939849624}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "attention_shape": [1, 32, 1, 12249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:04:39.324822", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1726049089469517, "overlap_percentage": 0.29439567859554355, "num_intersection": 436, "num_union": 2526, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.8273950910530483, "num_computed": 1481, "num_roped": 1481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "mask_shape": [1, 32, 1, 12250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:04:40.753839", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.16046511627906976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "attention_shape": [1, 32, 1, 12250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:05.003777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:05.014210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.0030423677884615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:10.912788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5096976213865283, "overlap_percentage": 0.6752314028532609, "num_intersection": 318061, "num_union": 624019, "num_only_computed": 152979, "num_only_roped": 152979, "total_diff": 305958, "diff_percentage": 0.4903023786134717, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:13.824308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 7.62939453125e-05, "l2_diff": 0.8203125, "l2_diff_relative": 0.10096153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:28.351891", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4061182553764916, "overlap_percentage": 0.5776445243117229, "num_intersection": 333019, "num_union": 820005, "num_only_computed": 243493, "num_only_roped": 243493, "total_diff": 486986, "diff_percentage": 0.5938817446235084, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:28.906752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.06825657894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:48.730601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3351175158689312, "overlap_percentage": 0.5020045230263158, "num_intersection": 341845, "num_union": 1020075, "num_only_computed": 339115, "num_only_roped": 339115, "total_diff": 678230, "diff_percentage": 0.6648824841310688, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:05:49.439427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.16043307086614172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:06:15.295714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29010942681543445, "overlap_percentage": 0.44974390665690106, "num_intersection": 353693, "num_union": 1219171, "num_only_computed": 432739, "num_only_roped": 432739, "total_diff": 865478, "diff_percentage": 0.7098905731845656, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:06:16.198270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 4.696846008300781e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.13911290322580644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:06:47.355631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25846417025881097, "overlap_percentage": 0.4107612697557471, "num_intersection": 365939, "num_union": 1415821, "num_only_computed": 524941, "num_only_roped": 524941, "total_diff": 1049882, "diff_percentage": 0.741535829741189, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:06:51.099603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.16830708661417323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:07:21.560428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30437221477764964, "overlap_percentage": 0.4666953363914373, "num_intersection": 9767, "num_union": 32089, "num_only_computed": 11161, "num_only_roped": 11161, "total_diff": 22322, "diff_percentage": 0.6956277852223504, "num_computed": 20928, "num_roped": 20928}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "mask_shape": [1, 32, 24, 6168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:07:22.386539", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.07373046875, "l2_diff_relative": 0.05185439560439561}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "attention_shape": [1, 32, 24, 6168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:07:48.771183", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2790728027356496, "overlap_percentage": 0.4363673469387755, "num_intersection": 10691, "num_union": 38309, "num_only_computed": 13809, "num_only_roped": 13809, "total_diff": 27618, "diff_percentage": 0.7209271972643504, "num_computed": 24500, "num_roped": 24500}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "mask_shape": [1, 32, 28, 6196], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:07:49.645120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.24609375, "l2_diff_relative": 0.21428571428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "attention_shape": [1, 32, 28, 6196]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:08:14.877334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26811594202898553, "overlap_percentage": 0.4228571428571429, "num_intersection": 370, "num_union": 1380, "num_only_computed": 505, "num_only_roped": 505, "total_diff": 1010, "diff_percentage": 0.7318840579710145, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "mask_shape": [1, 32, 1, 6197], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:08:15.623159", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.841255187988281e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.22096774193548388}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "attention_shape": [1, 32, 1, 6197]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:08:38.787408", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28771155261221487, "overlap_percentage": 0.44685714285714284, "num_intersection": 391, "num_union": 1359, "num_only_computed": 484, "num_only_roped": 484, "total_diff": 968, "diff_percentage": 0.7122884473877852, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "mask_shape": [1, 32, 1, 6198], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:08:40.675334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.05615234375, "l2_diff_relative": 0.38333333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "attention_shape": [1, 32, 1, 6198]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:03.819156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26262626262626265, "overlap_percentage": 0.416, "num_intersection": 364, "num_union": 1386, "num_only_computed": 511, "num_only_roped": 511, "total_diff": 1022, "diff_percentage": 0.7373737373737373, "num_computed": 875, "num_roped": 875}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "mask_shape": [1, 32, 1, 6199], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:04.566810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 3.6716461181640625e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.11972573839662447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "attention_shape": [1, 32, 1, 6199]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:22.827451", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:22.841051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031494140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:28.781918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5199913519513774, "overlap_percentage": 0.6842030400815218, "num_intersection": 322287, "num_union": 619793, "num_only_computed": 148753, "num_only_roped": 148753, "total_diff": 297506, "diff_percentage": 0.4800086480486227, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:29.177173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.60546875, "l2_diff_relative": 0.0625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:44.260745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4028079908509137, "overlap_percentage": 0.5742881327708703, "num_intersection": 331084, "num_union": 821940, "num_only_computed": 245428, "num_only_roped": 245428, "total_diff": 490856, "diff_percentage": 0.5971920091490863, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:09:44.808703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 7.200241088867188e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1297709923664122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:10:04.751095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34360001381167776, "overlap_percentage": 0.511461759868421, "num_intersection": 348285, "num_union": 1013635, "num_only_computed": 332675, "num_only_roped": 332675, "total_diff": 665350, "diff_percentage": 0.6563999861883222, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:10:05.479064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.67572021484375e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.14807692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:10:31.980162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3035385886586481, "overlap_percentage": 0.4657147725423177, "num_intersection": 366253, "num_union": 1206611, "num_only_computed": 420179, "num_only_roped": 420179, "total_diff": 840358, "diff_percentage": 0.696461411341352, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:10:32.882113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 5.14984130859375e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.1432806324110672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:11:04.190916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2725493697103882, "overlap_percentage": 0.42835174209770116, "num_intersection": 381610, "num_union": 1400150, "num_only_computed": 509270, "num_only_roped": 509270, "total_diff": 1018540, "diff_percentage": 0.7274506302896119, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:11:05.281058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 5.221366882324219e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.19707207207207209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:11:42.321041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2479443913668199, "overlap_percentage": 0.39736448688271603, "num_intersection": 395508, "num_union": 1595148, "num_only_computed": 599820, "num_only_roped": 599820, "total_diff": 1199640, "diff_percentage": 0.7520556086331801, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:11:43.602048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.17725409836065573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:12:26.912807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2219882396953022, "overlap_percentage": 0.3633230377906977, "num_intersection": 399946, "num_union": 1801654, "num_only_computed": 700854, "num_only_roped": 700854, "total_diff": 1401708, "diff_percentage": 0.7780117603046978, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:12:28.391979", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.814697265625e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.181640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:13:18.031453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1843408313049733, "overlap_percentage": 0.3112969281011045, "num_intersection": 375190, "num_union": 2035306, "num_only_computed": 830058, "num_only_roped": 830058, "total_diff": 1660116, "diff_percentage": 0.8156591686950267, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:13:20.030725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 6.29425048828125e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.41627906976744183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:14:16.447748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14798256550525746, "overlap_percentage": 0.2578132629394531, "num_intersection": 337921, "num_union": 2283519, "num_only_computed": 972799, "num_only_roped": 972799, "total_diff": 1945598, "diff_percentage": 0.8520174344947425, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:14:18.400495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 8.916854858398438e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.8136645962732919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:15:21.371591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1378262620934965, "overlap_percentage": 0.24226240276772792, "num_intersection": 342842, "num_union": 2487494, "num_only_computed": 1072326, "num_only_roped": 1072326, "total_diff": 2144652, "diff_percentage": 0.8621737379065035, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:15:24.551206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 8.726119995117188e-05, "l2_diff": 4.34375, "l2_diff_relative": 0.9455782312925171}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:16:34.024936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13589737264830384, "overlap_percentage": 0.23927755432951484, "num_intersection": 363610, "num_union": 2675622, "num_only_computed": 1156006, "num_only_roped": 1156006, "total_diff": 2312012, "diff_percentage": 0.8641026273516962, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:16:36.415485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.534027099609375e-05, "l2_diff": 4.0, "l2_diff_relative": 0.8258064516129032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:17:52.916448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13035839115238146, "overlap_percentage": 0.23064966327977315, "num_intersection": 374826, "num_union": 2875350, "num_only_computed": 1250262, "num_only_roped": 1250262, "total_diff": 2500524, "diff_percentage": 0.8696416088476185, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:17:57.427586", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.197265625, "mean_diff": 7.43865966796875e-05, "l2_diff": 4.0625, "l2_diff_relative": 0.8843537414965986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:19:22.915365", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1344422146710924, "overlap_percentage": 0.2370190617599171, "num_intersection": 409933, "num_union": 3049139, "num_only_computed": 1319603, "num_only_roped": 1319603, "total_diff": 2639206, "diff_percentage": 0.8655577853289076, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:19:25.842036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 6.246566772460938e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.7329545454545454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:20:59.323900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12500980930707054, "overlap_percentage": 0.22223772321428573, "num_intersection": 407808, "num_union": 3262208, "num_only_computed": 1427200, "num_only_roped": 1427200, "total_diff": 2854400, "diff_percentage": 0.8749901906929295, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:21:02.490832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 6.628036499023438e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.9461538461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:22:42.587381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12776228979612084, "overlap_percentage": 0.22657663046920634, "num_intersection": 386334, "num_union": 3023850, "num_only_computed": 1318758, "num_only_roped": 1318758, "total_diff": 2637516, "diff_percentage": 0.8722377102038792, "num_computed": 1705092, "num_roped": 1705092}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 906, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:22:45.944811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1953125, "mean_diff": 6.580352783203125e-05, "l2_diff": 4.0, "l2_diff_relative": 1.0199203187250996}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 906, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:24:16.813465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12627367297946118, "overlap_percentage": 0.2242326638878363, "num_intersection": 11835, "num_union": 93725, "num_only_computed": 40945, "num_only_roped": 40945, "total_diff": 81890, "diff_percentage": 0.8737263270205388, "num_computed": 52780, "num_roped": 52780}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 28, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:24:19.333029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.53515625, "l2_diff_relative": 0.53515625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 28, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:25:30.913308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14173228346456693, "overlap_percentage": 0.2482758620689655, "num_intersection": 468, "num_union": 3302, "num_only_computed": 1417, "num_only_roped": 1417, "total_diff": 2834, "diff_percentage": 0.8582677165354331, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:25:34.043145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.06591796875, "l2_diff_relative": 0.3276699029126214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:26:33.393287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13247221387804145, "overlap_percentage": 0.2339522546419098, "num_intersection": 441, "num_union": 3329, "num_only_computed": 1444, "num_only_roped": 1444, "total_diff": 2888, "diff_percentage": 0.8675277861219586, "num_computed": 1885, "num_roped": 1885}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:26:35.321243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.2608108108108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:09.852825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:09.865521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003058667452830189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:15.825385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4994134958037495, "overlap_percentage": 0.6661451256793478, "num_intersection": 313781, "num_union": 628299, "num_only_computed": 157259, "num_only_roped": 157259, "total_diff": 314518, "diff_percentage": 0.5005865041962505, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:16.216896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 0.00011730194091796875, "l2_diff": 1.3125, "l2_diff_relative": 0.15671641791044777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:31.346314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40224671001825435, "overlap_percentage": 0.5737174594804618, "num_intersection": 330755, "num_union": 822269, "num_only_computed": 245757, "num_only_roped": 245757, "total_diff": 491514, "diff_percentage": 0.5977532899817456, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:31.903818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 0.00011444091796875, "l2_diff": 1.671875, "l2_diff_relative": 0.2123015873015873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:51.888950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33741455314276514, "overlap_percentage": 0.5045773613721805, "num_intersection": 343597, "num_union": 1018323, "num_only_computed": 337363, "num_only_roped": 337363, "total_diff": 674726, "diff_percentage": 0.6625854468572349, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:27:52.618380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 8.96453857421875e-05, "l2_diff": 1.6484375, "l2_diff_relative": 0.22351694915254236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:28:18.832174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.289164101912603, "overlap_percentage": 0.4486071268717448, "num_intersection": 352799, "num_union": 1220065, "num_only_computed": 433633, "num_only_roped": 433633, "total_diff": 867266, "diff_percentage": 0.710835898087397, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:28:19.735417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.2025462962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:28:51.155893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25147060579476627, "overlap_percentage": 0.40188016343390803, "num_intersection": 358027, "num_union": 1423733, "num_only_computed": 532853, "num_only_roped": 532853, "total_diff": 1065706, "diff_percentage": 0.7485293942052337, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:28:52.250275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 4.744529724121094e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.17796610169491525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:29:29.283782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.244024712312536, "overlap_percentage": 0.3923148951903292, "num_intersection": 390482, "num_union": 1600174, "num_only_computed": 604846, "num_only_roped": 604846, "total_diff": 1209692, "diff_percentage": 0.755975287687464, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:29:30.571519", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.20520833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:30:13.500526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2280588236606595, "overlap_percentage": 0.37141351744186046, "num_intersection": 408852, "num_union": 1792748, "num_only_computed": 691948, "num_only_roped": 691948, "total_diff": 1383896, "diff_percentage": 0.7719411763393405, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:30:14.996437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.16834677419354838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:31:04.233601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21118340427263807, "overlap_percentage": 0.3487224206138488, "num_intersection": 420297, "num_union": 1990199, "num_only_computed": 784951, "num_only_roped": 784951, "total_diff": 1569902, "diff_percentage": 0.788816595727362, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:31:05.966752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 6.532669067382812e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.43478260869565216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:32:01.606850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18176465868016203, "overlap_percentage": 0.30761566162109377, "num_intersection": 403198, "num_union": 2218242, "num_only_computed": 907522, "num_only_roped": 907522, "total_diff": 1815044, "diff_percentage": 0.818235341319838, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:32:03.496770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 8.344650268554688e-05, "l2_diff": 3.75, "l2_diff_relative": 0.7317073170731707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:33:06.029532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16131547061953955, "overlap_percentage": 0.27781507213277856, "num_intersection": 393155, "num_union": 2437181, "num_only_computed": 1022013, "num_only_roped": 1022013, "total_diff": 2044026, "diff_percentage": 0.8386845293804605, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:33:08.863082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1787109375, "mean_diff": 8.106231689453125e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.8181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:34:19.594241", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1527175355953546, "overlap_percentage": 0.26496957126010784, "num_intersection": 402652, "num_union": 2636580, "num_only_computed": 1116964, "num_only_roped": 1116964, "total_diff": 2233928, "diff_percentage": 0.8472824644046454, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:34:22.012747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2109375, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.96875, "l2_diff_relative": 1.06}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:35:38.885738", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15039442234037018, "overlap_percentage": 0.2614658406190926, "num_intersection": 424905, "num_union": 2825271, "num_only_computed": 1200183, "num_only_roped": 1200183, "total_diff": 2400366, "diff_percentage": 0.8496055776596299, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:35:41.863536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.963180541992188e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.9375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:37:02.433453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14463924407300585, "overlap_percentage": 0.2527245939224161, "num_intersection": 278224, "num_union": 1923572, "num_only_computed": 822674, "num_only_roped": 822674, "total_diff": 1645348, "diff_percentage": 0.8553607559269941, "num_computed": 1100898, "num_roped": 1100898}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "mask_shape": [1, 32, 666, 13978], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:37:07.144644", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 5.7220458984375e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5612244897959183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "attention_shape": [1, 32, 666, 13978]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:38:21.782067", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1461122693991285, "overlap_percentage": 0.2549702560565566, "num_intersection": 14787, "num_union": 101203, "num_only_computed": 43208, "num_only_roped": 43208, "total_diff": 86416, "diff_percentage": 0.8538877306008715, "num_computed": 57995, "num_roped": 57995}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "mask_shape": [1, 32, 35, 14013], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:38:23.957858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.466796875, "l2_diff_relative": 0.4149305555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "attention_shape": [1, 32, 35, 14013]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:39:24.102203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1660802251935257, "overlap_percentage": 0.2848521424260712, "num_intersection": 472, "num_union": 2842, "num_only_computed": 1185, "num_only_roped": 1185, "total_diff": 2370, "diff_percentage": 0.8339197748064743, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "mask_shape": [1, 32, 1, 14014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:39:25.746983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 6.4849853515625e-05, "l2_diff": 0.06689453125, "l2_diff_relative": 0.48928571428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "attention_shape": [1, 32, 1, 14014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:40:16.429082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16158429723098494, "overlap_percentage": 0.27821363910681957, "num_intersection": 461, "num_union": 2853, "num_only_computed": 1196, "num_only_roped": 1196, "total_diff": 2392, "diff_percentage": 0.8384157027690151, "num_computed": 1657, "num_roped": 1657}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "mask_shape": [1, 32, 1, 14015], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:40:20.048934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 6.818771362304688e-05, "l2_diff": 0.0947265625, "l2_diff_relative": 0.6689655172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "attention_shape": [1, 32, 1, 14015]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:40:51.008890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:40:51.022518", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031005859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:40:56.916945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5109930647779254, "overlap_percentage": 0.6763671875, "num_intersection": 318596, "num_union": 623484, "num_only_computed": 152444, "num_only_roped": 152444, "total_diff": 304888, "diff_percentage": 0.48900693522207467, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:40:59.821389", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 8.916854858398438e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.1099290780141844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:41:14.333319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3967684804492825, "overlap_percentage": 0.5681234735790408, "num_intersection": 327530, "num_union": 825494, "num_only_computed": 248982, "num_only_roped": 248982, "total_diff": 497964, "diff_percentage": 0.6032315195507175, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:41:14.886550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.11322463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:41:35.244059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3377639955326666, "overlap_percentage": 0.5049679863721804, "num_intersection": 343863, "num_union": 1018057, "num_only_computed": 337097, "num_only_roped": 337097, "total_diff": 674194, "diff_percentage": 0.6622360044673333, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:41:35.977556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1375968992248062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:42:01.389454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29313657541578386, "overlap_percentage": 0.4533729553222656, "num_intersection": 356547, "num_union": 1216317, "num_only_computed": 429885, "num_only_roped": 429885, "total_diff": 859770, "diff_percentage": 0.7068634245842161, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:42:02.295423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 5.2928924560546875e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.158203125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:42:33.551129", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2650044266919228, "overlap_percentage": 0.41897786458333336, "num_intersection": 373259, "num_union": 1408501, "num_only_computed": 517621, "num_only_roped": 517621, "total_diff": 1035242, "diff_percentage": 0.7349955733080772, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:42:37.195642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.13392857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:43:14.449170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23356139469198084, "overlap_percentage": 0.37867818447788065, "num_intersection": 376909, "num_union": 1613747, "num_only_computed": 618419, "num_only_roped": 618419, "total_diff": 1236838, "diff_percentage": 0.7664386053080192, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:43:15.728022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.34375, "l2_diff_relative": 0.16165413533834586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:44:00.984248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21349550754218105, "overlap_percentage": 0.3518686409883721, "num_intersection": 387337, "num_union": 1814263, "num_only_computed": 713463, "num_only_roped": 713463, "total_diff": 1426926, "diff_percentage": 0.786504492457819, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:44:02.475655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:44:52.163278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1940466483914399, "overlap_percentage": 0.3250235636151232, "num_intersection": 391734, "num_union": 2018762, "num_only_computed": 813514, "num_only_roped": 813514, "total_diff": 1627028, "diff_percentage": 0.8059533516085601, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:44:55.667698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.39371980676328505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:45:51.417777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1659213168563213, "overlap_percentage": 0.2846183776855469, "num_intersection": 373055, "num_union": 2248385, "num_only_computed": 937665, "num_only_roped": 937665, "total_diff": 1875330, "diff_percentage": 0.8340786831436787, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:45:53.328405", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.963180541992188e-05, "l2_diff": 3.9375, "l2_diff_relative": 0.6847826086956522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:46:55.714776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1551071714253065, "overlap_percentage": 0.26855892727930536, "num_intersection": 380056, "num_union": 2450280, "num_only_computed": 1035112, "num_only_roped": 1035112, "total_diff": 2070224, "diff_percentage": 0.8448928285746935, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:46:59.460813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 7.62939453125e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.7704402515723271}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:48:09.033329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15179708696029504, "overlap_percentage": 0.2635830367671833, "num_intersection": 400545, "num_union": 2638687, "num_only_computed": 1119071, "num_only_roped": 1119071, "total_diff": 2238142, "diff_percentage": 0.848202913039705, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:48:11.437140", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 8.678436279296875e-05, "l2_diff": 4.28125, "l2_diff_relative": 1.096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:49:28.787301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14558545234604958, "overlap_percentage": 0.2541677742989918, "num_intersection": 413045, "num_union": 2837131, "num_only_computed": 1212043, "num_only_roped": 1212043, "total_diff": 2424086, "diff_percentage": 0.8544145476539504, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:49:32.149819", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2158203125, "mean_diff": 8.487701416015625e-05, "l2_diff": 4.21875, "l2_diff_relative": 1.173913043478261}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:50:55.963757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1398473644667642, "overlap_percentage": 0.24537910746003552, "num_intersection": 424392, "num_union": 3034680, "num_only_computed": 1305144, "num_only_roped": 1305144, "total_diff": 2610288, "diff_percentage": 0.8601526355332358, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:50:58.853192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1943359375, "mean_diff": 7.772445678710938e-05, "l2_diff": 4.53125, "l2_diff_relative": 1.0820895522388059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:52:30.797287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13520055998859237, "overlap_percentage": 0.23819678170340403, "num_intersection": 437093, "num_union": 3232923, "num_only_computed": 1397915, "num_only_roped": 1397915, "total_diff": 2795830, "diff_percentage": 0.8647994400114076, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:52:35.526777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 7.2479248046875e-05, "l2_diff": 4.1875, "l2_diff_relative": 1.0850202429149798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:54:02.341142", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.131340797631165, "overlap_percentage": 0.23218608911862854, "num_intersection": 28388, "num_union": 216140, "num_only_computed": 93876, "num_only_roped": 93876, "total_diff": 187752, "diff_percentage": 0.868659202368835, "num_computed": 122264, "num_roped": 122264}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "mask_shape": [1, 32, 68, 15428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:54:04.916353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.40487804878048783}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "attention_shape": [1, 32, 68, 15428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:55:21.481338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13016705627458805, "overlap_percentage": 0.23035011603269095, "num_intersection": 13698, "num_union": 105234, "num_only_computed": 45768, "num_only_roped": 45768, "total_diff": 91536, "diff_percentage": 0.869832943725412, "num_computed": 59466, "num_roped": 59466}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "mask_shape": [1, 32, 33, 15461], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:55:23.832189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.412109375, "l2_diff_relative": 0.3822463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "attention_shape": [1, 32, 33, 15461]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:56:29.623095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13834491471888818, "overlap_percentage": 0.24306326304106549, "num_intersection": 438, "num_union": 3166, "num_only_computed": 1364, "num_only_roped": 1364, "total_diff": 2728, "diff_percentage": 0.8616550852811118, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "mask_shape": [1, 32, 1, 15462], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:56:31.406627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 5.5789947509765625e-05, "l2_diff": 0.06494140625, "l2_diff_relative": 0.5215686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "attention_shape": [1, 32, 1, 15462]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:57:27.630095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13333333333333333, "overlap_percentage": 0.23529411764705882, "num_intersection": 424, "num_union": 3180, "num_only_computed": 1378, "num_only_roped": 1378, "total_diff": 2756, "diff_percentage": 0.8666666666666667, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "mask_shape": [1, 32, 1, 15463], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:57:29.450040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0189208984375, "mean_diff": 4.57763671875e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.3611111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "attention_shape": [1, 32, 1, 15463]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:58:25.903343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1315541601255887, "overlap_percentage": 0.232519422863485, "num_intersection": 419, "num_union": 3185, "num_only_computed": 1383, "num_only_roped": 1383, "total_diff": 2766, "diff_percentage": 0.8684458398744113, "num_computed": 1802, "num_roped": 1802}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15464, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15464, 128], "mask_shape": [1, 32, 1, 15464], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:58:27.727190", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.45222929936305734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15464, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15464, 128], "attention_shape": [1, 32, 1, 15464]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:02.750245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:02.761838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.0030048076923076925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:08.712019", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.497713875093003, "overlap_percentage": 0.6646314538043478, "num_intersection": 313068, "num_union": 629012, "num_only_computed": 157972, "num_only_roped": 157972, "total_diff": 315944, "diff_percentage": 0.502286124906997, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:09.101266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.08796296296296297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:23.711278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3924065307699739, "overlap_percentage": 0.5636378774422736, "num_intersection": 324944, "num_union": 828080, "num_only_computed": 251568, "num_only_roped": 251568, "total_diff": 503136, "diff_percentage": 0.6075934692300261, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:24.260062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.16266375545851527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:44.188484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33139119978884185, "overlap_percentage": 0.49781191259398494, "num_intersection": 338990, "num_union": 1022930, "num_only_computed": 341970, "num_only_roped": 341970, "total_diff": 683940, "diff_percentage": 0.6686088002111581, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T22:59:44.915360", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.11534926470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:00:10.528926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2922409543527556, "overlap_percentage": 0.452301025390625, "num_intersection": 355704, "num_union": 1217160, "num_only_computed": 430728, "num_only_roped": 430728, "total_diff": 861456, "diff_percentage": 0.7077590456472445, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:00:11.435834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.361701965332031e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.09866071428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:00:42.751794", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2673069017071828, "overlap_percentage": 0.42185030531609197, "num_intersection": 375818, "num_union": 1405942, "num_only_computed": 515062, "num_only_roped": 515062, "total_diff": 1030124, "diff_percentage": 0.7326930982928171, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:00:43.846477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.15495867768595042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:01:21.278328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24112544827895796, "overlap_percentage": 0.3885593492798354, "num_intersection": 386744, "num_union": 1603912, "num_only_computed": 608584, "num_only_roped": 608584, "total_diff": 1217168, "diff_percentage": 0.758874551721042, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:01:22.570642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.12322695035460993}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:02:06.496722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2252048500660017, "overlap_percentage": 0.36761991279069767, "num_intersection": 404676, "num_union": 1796924, "num_only_computed": 696124, "num_only_roped": 696124, "total_diff": 1392248, "diff_percentage": 0.7747951499339983, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:02:07.991501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.1087962962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:02:57.434439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19762095097372384, "overlap_percentage": 0.33002253478122345, "num_intersection": 397759, "num_union": 2012737, "num_only_computed": 807489, "num_only_roped": 807489, "total_diff": 1614978, "diff_percentage": 0.8023790490262762, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:02:59.110166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 5.245208740234375e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.3341121495327103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:03:54.753564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16690949088819357, "overlap_percentage": 0.2860710144042969, "num_intersection": 374959, "num_union": 2246481, "num_only_computed": 935761, "num_only_roped": 935761, "total_diff": 1871522, "diff_percentage": 0.8330905091118064, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:03:56.697850", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1796875, "mean_diff": 8.344650268554688e-05, "l2_diff": 3.78125, "l2_diff_relative": 0.7658227848101266}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:04:57.781655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1579908877171609, "overlap_percentage": 0.2728706924950348, "num_intersection": 286601, "num_union": 1814035, "num_only_computed": 763717, "num_only_roped": 763717, "total_diff": 1527434, "diff_percentage": 0.842009112282839, "num_computed": 1050318, "num_roped": 1050318}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "mask_shape": [1, 32, 774, 11014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:05:02.001142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 8.96453857421875e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.9041666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "attention_shape": [1, 32, 774, 11014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:05:59.253727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16007429318291258, "overlap_percentage": 0.275972485768501, "num_intersection": 11635, "num_union": 72685, "num_only_computed": 30525, "num_only_roped": 30525, "total_diff": 61050, "diff_percentage": 0.8399257068170874, "num_computed": 42160, "num_roped": 42160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "mask_shape": [1, 32, 31, 11045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:06:00.833195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 7.05718994140625e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.4041353383458647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "attention_shape": [1, 32, 31, 11045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:06:46.661195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16738197424892703, "overlap_percentage": 0.2867647058823529, "num_intersection": 390, "num_union": 2330, "num_only_computed": 970, "num_only_roped": 970, "total_diff": 1940, "diff_percentage": 0.8326180257510729, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "mask_shape": [1, 32, 1, 11046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:06:48.325995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 7.82012939453125e-05, "l2_diff": 0.07861328125, "l2_diff_relative": 0.6851063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "attention_shape": [1, 32, 1, 11046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:07:30.618044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16040955631399317, "overlap_percentage": 0.27647058823529413, "num_intersection": 376, "num_union": 2344, "num_only_computed": 984, "num_only_roped": 984, "total_diff": 1968, "diff_percentage": 0.8395904436860068, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "mask_shape": [1, 32, 1, 11047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:07:34.205816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 7.390975952148438e-05, "l2_diff": 0.08203125, "l2_diff_relative": 0.5753424657534246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "attention_shape": [1, 32, 1, 11047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:14.124349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15942028985507245, "overlap_percentage": 0.275, "num_intersection": 374, "num_union": 2346, "num_only_computed": 986, "num_only_roped": 986, "total_diff": 1972, "diff_percentage": 0.8405797101449275, "num_computed": 1360, "num_roped": 1360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "mask_shape": [1, 32, 1, 11048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:15.873099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.23115577889447236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "attention_shape": [1, 32, 1, 11048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:42.647348", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:42.660996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.0030218160377358493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:48.556191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5112160566706021, "overlap_percentage": 0.6765625, "num_intersection": 318688, "num_union": 623392, "num_only_computed": 152352, "num_only_roped": 152352, "total_diff": 304704, "diff_percentage": 0.4887839433293979, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:08:48.945539", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 6.151199340820312e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.07791666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:04.462964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3989919702201698, "overlap_percentage": 0.5703992284635879, "num_intersection": 328842, "num_union": 824182, "num_only_computed": 247670, "num_only_roped": 247670, "total_diff": 495340, "diff_percentage": 0.6010080297798301, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:05.011534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05712890625, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.125, "l2_diff_relative": 0.13333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:24.777156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3295754187871646, "overlap_percentage": 0.4957603970864662, "num_intersection": 337593, "num_union": 1024327, "num_only_computed": 343367, "num_only_roped": 343367, "total_diff": 686734, "diff_percentage": 0.6704245812128353, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:25.496633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 5.555152893066406e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.12413194444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:51.776394", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2850479544891922, "overlap_percentage": 0.4436378479003906, "num_intersection": 348891, "num_union": 1223973, "num_only_computed": 437541, "num_only_roped": 437541, "total_diff": 875082, "diff_percentage": 0.7149520455108078, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:09:53.178958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.11833333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:10:24.250587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.269651247803464, "overlap_percentage": 0.42476427801724137, "num_intersection": 378414, "num_union": 1403346, "num_only_computed": 512466, "num_only_roped": 512466, "total_diff": 1024932, "diff_percentage": 0.7303487521965359, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:10:25.331096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08935546875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.15784671532846714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:11:01.993572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24750252708350437, "overlap_percentage": 0.3967968348122428, "num_intersection": 394943, "num_union": 1595713, "num_only_computed": 600385, "num_only_roped": 600385, "total_diff": 1200770, "diff_percentage": 0.7524974729164956, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:11:03.256570", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 2.8133392333984375e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.12764084507042253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:11:45.616017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22104754076721453, "overlap_percentage": 0.362062136627907, "num_intersection": 398558, "num_union": 1803042, "num_only_computed": 702242, "num_only_roped": 702242, "total_diff": 1404484, "diff_percentage": 0.7789524592327854, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:11:47.100355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.18225190839694658}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:12:35.726781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1944306389186334, "overlap_percentage": 0.3255620420029737, "num_intersection": 392383, "num_union": 2018113, "num_only_computed": 812865, "num_only_roped": 812865, "total_diff": 1625730, "diff_percentage": 0.8055693610813666, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:12:39.283327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 6.67572021484375e-05, "l2_diff": 3.171875, "l2_diff_relative": 0.47877358490566035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:13:34.277266", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16619154895491897, "overlap_percentage": 0.285015869140625, "num_intersection": 373576, "num_union": 2247864, "num_only_computed": 937144, "num_only_roped": 937144, "total_diff": 1874288, "diff_percentage": 0.8338084510450811, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:13:36.188325", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 9.1552734375e-05, "l2_diff": 4.375, "l2_diff_relative": 0.8484848484848485}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:14:37.829263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15680961174230812, "overlap_percentage": 0.27110703464182345, "num_intersection": 383662, "num_union": 2446674, "num_only_computed": 1031506, "num_only_roped": 1031506, "total_diff": 2063012, "diff_percentage": 0.8431903882576919, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:14:42.120108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1962890625, "mean_diff": 8.96453857421875e-05, "l2_diff": 4.3125, "l2_diff_relative": 0.9261744966442953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:15:51.220288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15501522991181282, "overlap_percentage": 0.268421101120283, "num_intersection": 407897, "num_union": 2631335, "num_only_computed": 1111719, "num_only_roped": 1111719, "total_diff": 2223438, "diff_percentage": 0.8449847700881872, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:15:53.912754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2060546875, "mean_diff": 8.726119995117188e-05, "l2_diff": 5.4375, "l2_diff_relative": 1.10828025477707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:10.158200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15072148100102392, "overlap_percentage": 0.2619599677063642, "num_intersection": 425708, "num_union": 2824468, "num_only_computed": 1199380, "num_only_roped": 1199380, "total_diff": 2398760, "diff_percentage": 0.8492785189989761, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:17:15.137225", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2314453125, "mean_diff": 7.963180541992188e-05, "l2_diff": 4.875, "l2_diff_relative": 1.0263157894736843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:39.451041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14263780324774575, "overlap_percentage": 0.2496640717510361, "num_intersection": 431803, "num_union": 3027269, "num_only_computed": 1297733, "num_only_roped": 1297733, "total_diff": 2595466, "diff_percentage": 0.8573621967522542, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:18:42.361623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.772445678710938e-05, "l2_diff": 4.8125, "l2_diff_relative": 1.1240875912408759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:20:11.158768", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13833646232415342, "overlap_percentage": 0.24305021740533625, "num_intersection": 331363, "num_union": 2395341, "num_only_computed": 1031989, "num_only_roped": 1031989, "total_diff": 2063978, "diff_percentage": 0.8616635376758466, "num_computed": 1363352, "num_roped": 1363352}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "mask_shape": [1, 32, 772, 15108], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:20:14.378994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.609375, "l2_diff_relative": 0.8492647058823529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "attention_shape": [1, 32, 772, 15108]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:21:33.989149", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14124012140228437, "overlap_percentage": 0.24752042756565085, "num_intersection": 9633, "num_union": 68203, "num_only_computed": 29285, "num_only_roped": 29285, "total_diff": 58570, "diff_percentage": 0.8587598785977156, "num_computed": 38918, "num_roped": 38918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "mask_shape": [1, 32, 22, 15130], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:21:36.578808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.3359375, "l2_diff_relative": 0.3359375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "attention_shape": [1, 32, 22, 15130]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:22:39.857754", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1394524959742351, "overlap_percentage": 0.2447710570944036, "num_intersection": 433, "num_union": 3105, "num_only_computed": 1336, "num_only_roped": 1336, "total_diff": 2672, "diff_percentage": 0.8605475040257649, "num_computed": 1769, "num_roped": 1769}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "mask_shape": [1, 32, 1, 15131], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:22:41.627659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 4.220008850097656e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.3087557603686636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "attention_shape": [1, 32, 1, 15131]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:11.123359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:11.132743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0031948468543046356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:17.015373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5040071522079249, "overlap_percentage": 0.6702190896739131, "num_intersection": 315700, "num_union": 626380, "num_only_computed": 155340, "num_only_roped": 155340, "total_diff": 310680, "diff_percentage": 0.4959928477920751, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:17.404253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 8.678436279296875e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.11488970588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:32.015173", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3862410326018349, "overlap_percentage": 0.5572494588143873, "num_intersection": 321261, "num_union": 831763, "num_only_computed": 255251, "num_only_roped": 255251, "total_diff": 510502, "diff_percentage": 0.6137589673981652, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:32.581483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 7.62939453125e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.14147286821705427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:53.053119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32767268313844383, "overlap_percentage": 0.49360461701127817, "num_intersection": 336125, "num_union": 1025795, "num_only_computed": 344835, "num_only_roped": 344835, "total_diff": 689670, "diff_percentage": 0.6723273168615561, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:23:53.775651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 7.486343383789062e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.1829004329004329}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:24:22.363146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.285055303823799, "overlap_percentage": 0.44364674886067706, "num_intersection": 348898, "num_union": 1223966, "num_only_computed": 437534, "num_only_roped": 437534, "total_diff": 875068, "diff_percentage": 0.7149446961762009, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:24:25.210389", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 4.887580871582031e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.13489208633093525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:24:51.155168", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28603241370778176, "overlap_percentage": 0.44482924482924485, "num_intersection": 9248, "num_union": 32332, "num_only_computed": 11542, "num_only_roped": 11542, "total_diff": 23084, "diff_percentage": 0.7139675862922182, "num_computed": 20790, "num_roped": 20790}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "mask_shape": [1, 32, 27, 5147], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:24:53.502070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 7.963180541992188e-05, "l2_diff": 0.26953125, "l2_diff_relative": 0.24125874125874125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "attention_shape": [1, 32, 27, 5147]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:14.587916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2530512611879577, "overlap_percentage": 0.4038961038961039, "num_intersection": 311, "num_union": 1229, "num_only_computed": 459, "num_only_roped": 459, "total_diff": 918, "diff_percentage": 0.7469487388120423, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "mask_shape": [1, 32, 1, 5148], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:15.215279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 4.7206878662109375e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.13168724279835392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "attention_shape": [1, 32, 1, 5148]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:34.529333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2706270627062706, "overlap_percentage": 0.42597402597402595, "num_intersection": 328, "num_union": 1212, "num_only_computed": 442, "num_only_roped": 442, "total_diff": 884, "diff_percentage": 0.7293729372937293, "num_computed": 770, "num_roped": 770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "mask_shape": [1, 32, 1, 5149], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:35.155780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.17752100840336135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "attention_shape": [1, 32, 1, 5149]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:54.568431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26705012325390304, "overlap_percentage": 0.42153047989623865, "num_intersection": 325, "num_union": 1217, "num_only_computed": 446, "num_only_roped": 446, "total_diff": 892, "diff_percentage": 0.7329498767460969, "num_computed": 771, "num_roped": 771}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "mask_shape": [1, 32, 1, 5150], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:25:55.195355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.10792951541850221}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "attention_shape": [1, 32, 1, 5150]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:08.250588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:08.262106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:14.168260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.515711704580375, "overlap_percentage": 0.6804878566576087, "num_intersection": 320537, "num_union": 621543, "num_only_computed": 150503, "num_only_roped": 150503, "total_diff": 301006, "diff_percentage": 0.48428829541962504, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:16.316188", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 8.96453857421875e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.1145418326693227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:30.862341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4174369388916685, "overlap_percentage": 0.5890024839031972, "num_intersection": 339567, "num_union": 813457, "num_only_computed": 236945, "num_only_roped": 236945, "total_diff": 473890, "diff_percentage": 0.5825630611083314, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:31.406717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 8.296966552734375e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.14955357142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:51.899990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34200465097946475, "overlap_percentage": 0.5096921992481203, "num_intersection": 347080, "num_union": 1014840, "num_only_computed": 333880, "num_only_roped": 333880, "total_diff": 667760, "diff_percentage": 0.6579953490205352, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:26:52.622173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 8.058547973632812e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:27:18.108546", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29752203833341856, "overlap_percentage": 0.45860036214192706, "num_intersection": 360658, "num_union": 1212206, "num_only_computed": 425774, "num_only_roped": 425774, "total_diff": 851548, "diff_percentage": 0.7024779616665814, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:27:19.008591", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.12878787878787878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:27:50.377469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.281314451894616, "overlap_percentage": 0.4391029094827586, "num_intersection": 391188, "num_union": 1390572, "num_only_computed": 499692, "num_only_roped": 499692, "total_diff": 999384, "diff_percentage": 0.718685548105384, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:27:53.698825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.09124087591240876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:28:30.706688", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24903905882352942, "overlap_percentage": 0.39876904899691357, "num_intersection": 396906, "num_union": 1593750, "num_only_computed": 598422, "num_only_roped": 598422, "total_diff": 1196844, "diff_percentage": 0.7509609411764706, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:28:33.771231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.625, "l2_diff_relative": 0.07042253521126761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:29:16.543332", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21024752464362123, "overlap_percentage": 0.34744549418604653, "num_intersection": 382468, "num_union": 1819132, "num_only_computed": 718332, "num_only_roped": 718332, "total_diff": 1436664, "diff_percentage": 0.7897524753563787, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:29:18.024181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 2.944469451904297e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.1421161825726141}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:30:07.588016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1792571719306485, "overlap_percentage": 0.30401709855564996, "num_intersection": 366416, "num_union": 2044080, "num_only_computed": 838832, "num_only_roped": 838832, "total_diff": 1677664, "diff_percentage": 0.8207428280693515, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:30:10.605070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.36910994764397903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:31:06.169847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15244899367776146, "overlap_percentage": 0.26456527709960936, "num_intersection": 346771, "num_union": 2274669, "num_only_computed": 963949, "num_only_roped": 963949, "total_diff": 1927898, "diff_percentage": 0.8475510063222386, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:31:08.282204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.62939453125e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.6528662420382165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:32:10.976614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14202709551216458, "overlap_percentage": 0.24872806620839363, "num_intersection": 351992, "num_union": 2478344, "num_only_computed": 1063176, "num_only_roped": 1063176, "total_diff": 2126352, "diff_percentage": 0.8579729044878355, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:32:15.376790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.793571472167969e-05, "l2_diff": 2.984375, "l2_diff_relative": 0.4872448979591837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:33:16.704749", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13941075439291847, "overlap_percentage": 0.24470675540919737, "num_intersection": 31656, "num_union": 227070, "num_only_computed": 97707, "num_only_roped": 97707, "total_diff": 195414, "diff_percentage": 0.8605892456070815, "num_computed": 129363, "num_roped": 129363}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 93, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:33:18.455998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.3107638888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 93, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:34:11.919852", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13976634852749256, "overlap_percentage": 0.2452543869330096, "num_intersection": 8889, "num_union": 63599, "num_only_computed": 27355, "num_only_roped": 27355, "total_diff": 54710, "diff_percentage": 0.8602336514725074, "num_computed": 36244, "num_roped": 36244}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 26, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:34:13.592005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.3046875, "l2_diff_relative": 0.3058823529411765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 26, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:35:00.500915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13982011447260834, "overlap_percentage": 0.24533715925394547, "num_intersection": 342, "num_union": 2446, "num_only_computed": 1052, "num_only_roped": 1052, "total_diff": 2104, "diff_percentage": 0.8601798855273917, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:35:03.535238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 7.915496826171875e-05, "l2_diff": 0.08349609375, "l2_diff_relative": 0.6240875912408759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:35:44.833325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1305758313057583, "overlap_percentage": 0.2309899569583931, "num_intersection": 322, "num_union": 2466, "num_only_computed": 1072, "num_only_roped": 1072, "total_diff": 2144, "diff_percentage": 0.8694241686942417, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:35:46.170937", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 6.0558319091796875e-05, "l2_diff": 0.05712890625, "l2_diff_relative": 0.26}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:36:29.076821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13749490004079967, "overlap_percentage": 0.2417503586800574, "num_intersection": 337, "num_union": 2451, "num_only_computed": 1057, "num_only_roped": 1057, "total_diff": 2114, "diff_percentage": 0.8625050999592003, "num_computed": 1394, "num_roped": 1394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:36:30.410939", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.15083333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:36:56.407689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:36:56.420299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003117487980769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:37:02.291968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5088078387282247, "overlap_percentage": 0.6744501528532608, "num_intersection": 317693, "num_union": 624387, "num_only_computed": 153347, "num_only_roped": 153347, "total_diff": 306694, "diff_percentage": 0.49119216127177534, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:37:02.678723", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 7.43865966796875e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.10431654676258993}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:37:17.170258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3962678162729023, "overlap_percentage": 0.5676100410746003, "num_intersection": 327234, "num_union": 825790, "num_only_computed": 249278, "num_only_roped": 249278, "total_diff": 498556, "diff_percentage": 0.6037321837270977, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:37:20.105993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 9.489059448242188e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.17653061224489797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:37:39.903904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35438016561800456, "overlap_percentage": 0.5233097391917293, "num_intersection": 356353, "num_union": 1005567, "num_only_computed": 324607, "num_only_roped": 324607, "total_diff": 649214, "diff_percentage": 0.6456198343819954, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:37:40.618490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 6.866455078125e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.16086065573770492}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:38:06.191160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31070798517680254, "overlap_percentage": 0.4741071065266927, "num_intersection": 372853, "num_union": 1200011, "num_only_computed": 413579, "num_only_roped": 413579, "total_diff": 827158, "diff_percentage": 0.6892920148231975, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:38:07.092713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.10839160839160839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:38:38.151237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2643724653261946, "overlap_percentage": 0.41818763469827586, "num_intersection": 372555, "num_union": 1409205, "num_only_computed": 518325, "num_only_roped": 518325, "total_diff": 1036650, "diff_percentage": 0.7356275346738055, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:38:39.197272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.79296875, "l2_diff_relative": 0.09835271317829457}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:39:16.870601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2377800176216713, "overlap_percentage": 0.384204001093107, "num_intersection": 382409, "num_union": 1608247, "num_only_computed": 612919, "num_only_roped": 612919, "total_diff": 1225838, "diff_percentage": 0.7622199823783287, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:39:18.124171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.1891025641025641}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:40:01.120067", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22506645328905525, "overlap_percentage": 0.36743550145348836, "num_intersection": 404473, "num_union": 1797127, "num_only_computed": 696327, "num_only_roped": 696327, "total_diff": 1392654, "diff_percentage": 0.7749335467109447, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:40:02.591497", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.10328014184397163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:40:54.153471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19287195348261785, "overlap_percentage": 0.32337411055649956, "num_intersection": 389746, "num_union": 2020750, "num_only_computed": 815502, "num_only_roped": 815502, "total_diff": 1631004, "diff_percentage": 0.8071280465173821, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:40:55.835062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 5.269050598144531e-05, "l2_diff": 2.625, "l2_diff_relative": 0.3574468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:41:51.403434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16786864329004791, "overlap_percentage": 0.2874786376953125, "num_intersection": 376804, "num_union": 2244636, "num_only_computed": 933916, "num_only_roped": 933916, "total_diff": 1867832, "diff_percentage": 0.8321313567099521, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:41:53.348094", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 9.72747802734375e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.9862068965517241}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:42:56.629030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15407427523157238, "overlap_percentage": 0.2670092879431983, "num_intersection": 377863, "num_union": 2452473, "num_only_computed": 1037305, "num_only_roped": 1037305, "total_diff": 2074610, "diff_percentage": 0.8459257247684276, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:42:58.814367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 7.867813110351562e-05, "l2_diff": 3.875, "l2_diff_relative": 0.7948717948717948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:10.318573", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15250159836242744, "overlap_percentage": 0.26464448913409705, "num_intersection": 402158, "num_union": 2637074, "num_only_computed": 1117458, "num_only_roped": 1117458, "total_diff": 2234916, "diff_percentage": 0.8474984016375725, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:44:12.703689", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.295608520507812e-05, "l2_diff": 3.78125, "l2_diff_relative": 0.7707006369426752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:45:30.553164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14913761008584123, "overlap_percentage": 0.25956440512759926, "num_intersection": 421815, "num_union": 2828361, "num_only_computed": 1203273, "num_only_roped": 1203273, "total_diff": 2406546, "diff_percentage": 0.8508623899141587, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:45:33.173192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.205078125, "mean_diff": 6.103515625e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.6394736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:46:55.801663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14581257023904348, "overlap_percentage": 0.2545138254306698, "num_intersection": 376006, "num_union": 2578694, "num_only_computed": 1101344, "num_only_roped": 1101344, "total_diff": 2202688, "diff_percentage": 0.8541874297609565, "num_computed": 1477350, "num_roped": 1477350}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:46:58.559462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1806640625, "mean_diff": 6.246566772460938e-05, "l2_diff": 3.53125, "l2_diff_relative": 0.6975308641975309}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:48:15.645242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14572766289504488, "overlap_percentage": 0.2543844713093819, "num_intersection": 11952, "num_union": 82016, "num_only_computed": 35032, "num_only_roped": 35032, "total_diff": 70064, "diff_percentage": 0.8542723371049551, "num_computed": 46984, "num_roped": 46984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "mask_shape": [1, 32, 28, 14222], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:48:17.714913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08935546875, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.32194244604316546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "attention_shape": [1, 32, 28, 14222]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:49:19.123818", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1568424681144433, "overlap_percentage": 0.27115613825983315, "num_intersection": 455, "num_union": 2901, "num_only_computed": 1223, "num_only_roped": 1223, "total_diff": 2446, "diff_percentage": 0.8431575318855568, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "mask_shape": [1, 32, 1, 14223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:49:22.888642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029541015625, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.0439453125, "l2_diff_relative": 0.2727272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "attention_shape": [1, 32, 1, 14223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:50:14.933453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1501028101439342, "overlap_percentage": 0.26102502979737785, "num_intersection": 438, "num_union": 2918, "num_only_computed": 1240, "num_only_roped": 1240, "total_diff": 2480, "diff_percentage": 0.8498971898560658, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "mask_shape": [1, 32, 1, 14224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:50:18.059006", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.2921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "attention_shape": [1, 32, 1, 14224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:51:09.484238", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14227365554799182, "overlap_percentage": 0.24910607866507747, "num_intersection": 418, "num_union": 2938, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.8577263444520081, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 1, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:51:13.075031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.19736842105263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 1, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:52:04.578637", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14500170590242237, "overlap_percentage": 0.2532777115613826, "num_intersection": 425, "num_union": 2931, "num_only_computed": 1253, "num_only_roped": 1253, "total_diff": 2506, "diff_percentage": 0.8549982940975777, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:52:08.156552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0111083984375, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.19785276073619631}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:52:59.180159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14892160219103046, "overlap_percentage": 0.2592371871275328, "num_intersection": 435, "num_union": 2921, "num_only_computed": 1243, "num_only_roped": 1243, "total_diff": 2486, "diff_percentage": 0.8510783978089695, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:53:03.246648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.2422360248447205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:53:54.701544", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1568424681144433, "overlap_percentage": 0.27115613825983315, "num_intersection": 455, "num_union": 2901, "num_only_computed": 1223, "num_only_roped": 1223, "total_diff": 2446, "diff_percentage": 0.8431575318855568, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:53:57.467561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013916015625, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.21893491124260356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:27.555890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:27.566390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003115110759493671}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:33.549115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5172789220825864, "overlap_percentage": 0.6818507982336957, "num_intersection": 321179, "num_union": 620901, "num_only_computed": 149861, "num_only_roped": 149861, "total_diff": 299722, "diff_percentage": 0.4827210779174136, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:33.942566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 7.152557373046875e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.08928571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:48.616046", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4020301655163692, "overlap_percentage": 0.5734971691829485, "num_intersection": 330628, "num_union": 822396, "num_only_computed": 245884, "num_only_roped": 245884, "total_diff": 491768, "diff_percentage": 0.5979698344836307, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:54:49.162936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 6.771087646484375e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.12777777777777777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:55:08.950050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.328664847531143, "overlap_percentage": 0.49472949953007517, "num_intersection": 336891, "num_union": 1025029, "num_only_computed": 344069, "num_only_roped": 344069, "total_diff": 688138, "diff_percentage": 0.671335152468857, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:55:09.699435", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.1322463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:55:35.116351", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28451692515755683, "overlap_percentage": 0.4429944356282552, "num_intersection": 348385, "num_union": 1224479, "num_only_computed": 438047, "num_only_roped": 438047, "total_diff": 876094, "diff_percentage": 0.7154830748424432, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:55:36.016661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 6.008148193359375e-05, "l2_diff": 1.5, "l2_diff_relative": 0.18823529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:07.124180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25133701106479805, "overlap_percentage": 0.4017095456178161, "num_intersection": 357875, "num_union": 1423885, "num_only_computed": 533005, "num_only_roped": 533005, "total_diff": 1066010, "diff_percentage": 0.7486629889352019, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:08.211925", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 5.316734313964844e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.19602272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:44.889272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23971561950407788, "overlap_percentage": 0.38672678755144035, "num_intersection": 384920, "num_union": 1605736, "num_only_computed": 610408, "num_only_roped": 610408, "total_diff": 1220816, "diff_percentage": 0.7602843804959222, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:56:46.165824", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.4140625, "l2_diff_relative": 0.15391156462585034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:57:29.239104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21056827866824293, "overlap_percentage": 0.34788335755813954, "num_intersection": 382950, "num_union": 1818650, "num_only_computed": 717850, "num_only_roped": 717850, "total_diff": 1435700, "diff_percentage": 0.7894317213317571, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:57:30.754022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.1821705426356589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:58:20.731862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19608954237404197, "overlap_percentage": 0.3278843856202209, "num_intersection": 395182, "num_union": 2015314, "num_only_computed": 810066, "num_only_roped": 810066, "total_diff": 1620132, "diff_percentage": 0.803910457625958, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:58:23.112115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.875, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:09.383540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1870938215102975, "overlap_percentage": 0.3152132007093839, "num_intersection": 8176, "num_union": 43700, "num_only_computed": 17762, "num_only_roped": 17762, "total_diff": 35524, "diff_percentage": 0.8129061784897025, "num_computed": 25938, "num_roped": 25938}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "mask_shape": [1, 32, 22, 9238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:10.607025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.23046875, "l2_diff_relative": 0.18789808917197454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "attention_shape": [1, 32, 22, 9238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:51.901101", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18624760523999379, "overlap_percentage": 0.31401134875600173, "num_intersection": 21582, "num_union": 115878, "num_only_computed": 47148, "num_only_roped": 47148, "total_diff": 94296, "diff_percentage": 0.8137523947600062, "num_computed": 68730, "num_roped": 68730}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "mask_shape": [1, 32, 58, 9296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T23:59:53.304901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10888671875, "mean_diff": 8.0108642578125e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.5579268292682927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "attention_shape": [1, 32, 58, 9296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:00:32.145625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19939271255060728, "overlap_percentage": 0.33248945147679326, "num_intersection": 394, "num_union": 1976, "num_only_computed": 791, "num_only_roped": 791, "total_diff": 1582, "diff_percentage": 0.8006072874493927, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "mask_shape": [1, 32, 1, 9297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:00:33.240187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06884765625, "mean_diff": 0.0001392364501953125, "l2_diff": 0.126953125, "l2_diff_relative": 1.9548872180451127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "attention_shape": [1, 32, 1, 9297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:07.007430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21041879468845762, "overlap_percentage": 0.34767932489451475, "num_intersection": 412, "num_union": 1958, "num_only_computed": 773, "num_only_roped": 773, "total_diff": 1546, "diff_percentage": 0.7895812053115424, "num_computed": 1185, "num_roped": 1185}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "mask_shape": [1, 32, 1, 9298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:08.104484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 0.00011301040649414062, "l2_diff": 0.0888671875, "l2_diff_relative": 1.089820359281437}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "attention_shape": [1, 32, 1, 9298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:30.202957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:30.225797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0031115301724137933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:36.099900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5152387585104312, "overlap_percentage": 0.6800760020380435, "num_intersection": 320343, "num_union": 621737, "num_only_computed": 150697, "num_only_roped": 150697, "total_diff": 301394, "diff_percentage": 0.48476124148956873, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:36.489906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 0.0001430511474609375, "l2_diff": 1.359375, "l2_diff_relative": 0.1891304347826087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:51.123557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39923474495745953, "overlap_percentage": 0.5706472718694494, "num_intersection": 328985, "num_union": 824039, "num_only_computed": 247527, "num_only_roped": 247527, "total_diff": 495054, "diff_percentage": 0.6007652550425404, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:01:51.671481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 0.00011205673217773438, "l2_diff": 1.46875, "l2_diff_relative": 0.22065727699530516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:11.966021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3366571793110217, "overlap_percentage": 0.5037300281954887, "num_intersection": 343020, "num_union": 1018900, "num_only_computed": 337940, "num_only_roped": 337940, "total_diff": 675880, "diff_percentage": 0.6633428206889783, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:12.694289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 8.440017700195312e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.20527522935779816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:40.683694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29111230775292557, "overlap_percentage": 0.4509480794270833, "num_intersection": 354640, "num_union": 1218224, "num_only_computed": 431792, "num_only_roped": 431792, "total_diff": 863584, "diff_percentage": 0.7088876922470744, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:02:41.591957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 6.961822509765625e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.20666666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:14.669708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25865974946330217, "overlap_percentage": 0.4110082165948276, "num_intersection": 366159, "num_union": 1415601, "num_only_computed": 524721, "num_only_roped": 524721, "total_diff": 1049442, "diff_percentage": 0.7413402505366978, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:15.754021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.1019467213114754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:52.432214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23531974308852277, "overlap_percentage": 0.3809859664351852, "num_intersection": 379206, "num_union": 1611450, "num_only_computed": 616122, "num_only_roped": 616122, "total_diff": 1232244, "diff_percentage": 0.7646802569114772, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:03:54.635360", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.1788793103448276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:04:38.354128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.232724996388501, "overlap_percentage": 0.377578125, "num_intersection": 415638, "num_union": 1785962, "num_only_computed": 685162, "num_only_roped": 685162, "total_diff": 1370324, "diff_percentage": 0.767275003611499, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:04:39.833540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 2.7060508728027344e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1274703557312253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:05:28.349970", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2011670349985923, "overlap_percentage": 0.3349526404524214, "num_intersection": 403701, "num_union": 2006795, "num_only_computed": 801547, "num_only_roped": 801547, "total_diff": 1603094, "diff_percentage": 0.7988329650014078, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:05:32.007583", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.4777777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:06:27.302752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1680991786357056, "overlap_percentage": 0.28781661987304685, "num_intersection": 377247, "num_union": 2244193, "num_only_computed": 933473, "num_only_roped": 933473, "total_diff": 1866946, "diff_percentage": 0.8319008213642944, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:06:29.219152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 9.441375732421875e-05, "l2_diff": 3.75, "l2_diff_relative": 0.967741935483871}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:07:31.029720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15494973912660256, "overlap_percentage": 0.26832291289797394, "num_intersection": 379722, "num_union": 2450614, "num_only_computed": 1035446, "num_only_roped": 1035446, "total_diff": 2070892, "diff_percentage": 0.8450502608733974, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:07:34.358917", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.62939453125e-05, "l2_diff": 3.703125, "l2_diff_relative": 0.7181818181818181}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:08:43.678410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15098140278736646, "overlap_percentage": 0.26235246272742585, "num_intersection": 398675, "num_union": 2640557, "num_only_computed": 1120941, "num_only_roped": 1120941, "total_diff": 2241882, "diff_percentage": 0.8490185972126335, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:08:46.066579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.515625, "l2_diff_relative": 0.6617647058823529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:10:02.366135", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14499461881670334, "overlap_percentage": 0.2532669000078765, "num_intersection": 411581, "num_union": 2838595, "num_only_computed": 1213507, "num_only_roped": 1213507, "total_diff": 2427014, "diff_percentage": 0.8550053811832967, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:10:05.870487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.295608520507812e-05, "l2_diff": 3.484375, "l2_diff_relative": 0.832089552238806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:11:28.903139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13903137918385278, "overlap_percentage": 0.24412212292776792, "num_intersection": 422218, "num_union": 3036854, "num_only_computed": 1307318, "num_only_roped": 1307318, "total_diff": 2614636, "diff_percentage": 0.8609686208161472, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:11:31.788732", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.375, "l2_diff_relative": 0.7941176470588235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:13:02.073849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1333303276020626, "overlap_percentage": 0.23528943743024552, "num_intersection": 431758, "num_union": 3238258, "num_only_computed": 1403250, "num_only_roped": 1403250, "total_diff": 2806500, "diff_percentage": 0.8666696723979375, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:13:05.478084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.640625, "l2_diff_relative": 0.9471544715447154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:14:43.521833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1298881115598933, "overlap_percentage": 0.22991322809932613, "num_intersection": 398504, "num_union": 3068056, "num_only_computed": 1334776, "num_only_roped": 1334776, "total_diff": 2669552, "diff_percentage": 0.8701118884401067, "num_computed": 1733280, "num_roped": 1733280}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "mask_shape": [1, 32, 920, 16280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:14:46.861149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.67572021484375e-05, "l2_diff": 3.734375, "l2_diff_relative": 0.991701244813278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "attention_shape": [1, 32, 920, 16280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:16:18.545237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13168720423558075, "overlap_percentage": 0.23272721250662426, "num_intersection": 14053, "num_union": 106715, "num_only_computed": 46331, "num_only_roped": 46331, "total_diff": 92662, "diff_percentage": 0.8683127957644192, "num_computed": 60384, "num_roped": 60384}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "mask_shape": [1, 32, 32, 16312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:16:21.288716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.42723880597014924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "attention_shape": [1, 32, 32, 16312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:17:32.664541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14467697907188354, "overlap_percentage": 0.2527821939586645, "num_intersection": 477, "num_union": 3297, "num_only_computed": 1410, "num_only_roped": 1410, "total_diff": 2820, "diff_percentage": 0.8553230209281165, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "mask_shape": [1, 32, 1, 16313], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:17:34.631494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0172119140625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.052001953125, "l2_diff_relative": 0.3597972972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "attention_shape": [1, 32, 1, 16313]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:18:35.867992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13640469738030714, "overlap_percentage": 0.24006359300476948, "num_intersection": 453, "num_union": 3321, "num_only_computed": 1434, "num_only_roped": 1434, "total_diff": 2868, "diff_percentage": 0.8635953026196929, "num_computed": 1887, "num_roped": 1887}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "mask_shape": [1, 32, 1, 16314], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:18:39.212121", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.6716461181640625e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2366504854368932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "attention_shape": [1, 32, 1, 16314]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:13.371281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:13.379652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031398338607594935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:19.363869", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5240708325379286, "overlap_percentage": 0.6877250339673913, "num_intersection": 323946, "num_union": 618134, "num_only_computed": 147094, "num_only_roped": 147094, "total_diff": 294188, "diff_percentage": 0.4759291674620713, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:19.760161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.08895985401459854}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:34.626380", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4129590029839406, "overlap_percentage": 0.5845307643206039, "num_intersection": 336989, "num_union": 816035, "num_only_computed": 239523, "num_only_roped": 239523, "total_diff": 479046, "diff_percentage": 0.5870409970160594, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:35.180797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 7.05718994140625e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.13157894736842105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:56.154246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3436715960539907, "overlap_percentage": 0.5115410596804512, "num_intersection": 348339, "num_union": 1013581, "num_only_computed": 332621, "num_only_roped": 332621, "total_diff": 665242, "diff_percentage": 0.6563284039460092, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:19:56.877951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.0558319091796875e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:20:25.572940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28700795100927984, "overlap_percentage": 0.44600804646809894, "num_intersection": 350755, "num_union": 1222109, "num_only_computed": 435677, "num_only_roped": 435677, "total_diff": 871354, "diff_percentage": 0.7129920489907201, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:20:28.664705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.5234375, "l2_diff_relative": 0.21195652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:21:00.103862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2530151661980706, "overlap_percentage": 0.4038501257183908, "num_intersection": 359782, "num_union": 1421978, "num_only_computed": 531098, "num_only_roped": 531098, "total_diff": 1062196, "diff_percentage": 0.7469848338019294, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:21:01.167917", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.1826171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:21:38.161737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23201922059306818, "overlap_percentage": 0.37664870273919754, "num_intersection": 374889, "num_union": 1615767, "num_only_computed": 620439, "num_only_roped": 620439, "total_diff": 1240878, "diff_percentage": 0.7679807794069318, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:21:39.453007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.601478576660156e-05, "l2_diff": 1.59375, "l2_diff_relative": 0.20816326530612245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:22:22.342786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2254128449047906, "overlap_percentage": 0.3678969840116279, "num_intersection": 404981, "num_union": 1796619, "num_only_computed": 695819, "num_only_roped": 695819, "total_diff": 1391638, "diff_percentage": 0.7745871550952094, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:22:23.835099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:11.992320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2081433154554891, "overlap_percentage": 0.34456725918649106, "num_intersection": 415289, "num_union": 1995207, "num_only_computed": 789959, "num_only_roped": 789959, "total_diff": 1579918, "diff_percentage": 0.791856684544511, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:23:15.369181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.3482587064676617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:06.314194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1701840108119347, "overlap_percentage": 0.2908670931058991, "num_intersection": 166974, "num_union": 981138, "num_only_computed": 407082, "num_only_roped": 407082, "total_diff": 814164, "diff_percentage": 0.8298159891880653, "num_computed": 574056, "num_roped": 574056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "mask_shape": [1, 32, 469, 9685], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:09.082590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 7.43865966796875e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.5352697095435685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "attention_shape": [1, 32, 469, 9685]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:56.760522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15778704650979775, "overlap_percentage": 0.27256661228928764, "num_intersection": 8020, "num_union": 50828, "num_only_computed": 21404, "num_only_roped": 21404, "total_diff": 42808, "diff_percentage": 0.8422129534902022, "num_computed": 29424, "num_roped": 29424}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "mask_shape": [1, 32, 24, 9709], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:24:58.085416", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.2353515625, "l2_diff_relative": 0.20633561643835616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "attention_shape": [1, 32, 24, 9709]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:25:36.901305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15809344030202926, "overlap_percentage": 0.27302363488182557, "num_intersection": 335, "num_union": 2119, "num_only_computed": 892, "num_only_roped": 892, "total_diff": 1784, "diff_percentage": 0.8419065596979708, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 1, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:25:38.035719", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.18488372093023256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 1, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:13.201086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.162482235907153, "overlap_percentage": 0.2795436022819886, "num_intersection": 343, "num_union": 2111, "num_only_computed": 884, "num_only_roped": 884, "total_diff": 1768, "diff_percentage": 0.837517764092847, "num_computed": 1227, "num_roped": 1227}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "mask_shape": [1, 32, 1, 9711], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:16.183224", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0216064453125, "l2_diff_relative": 0.09335443037974683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "attention_shape": [1, 32, 1, 9711]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:35.191322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:35.199657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.029541015625, "l2_diff_relative": 0.0030298477564102565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:41.103974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.520921386988347, "overlap_percentage": 0.6850076426630435, "num_intersection": 322666, "num_union": 619414, "num_only_computed": 148374, "num_only_roped": 148374, "total_diff": 296748, "diff_percentage": 0.47907861301165294, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:43.008463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 6.198883056640625e-05, "l2_diff": 0.70703125, "l2_diff_relative": 0.08197463768115942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:57.594213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4028370054129158, "overlap_percentage": 0.5743176204484902, "num_intersection": 331101, "num_union": 821923, "num_only_computed": 245411, "num_only_roped": 245411, "total_diff": 490822, "diff_percentage": 0.5971629945870842, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:26:58.154713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 8.153915405273438e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.14977477477477477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:13.547222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4041151058065461, "overlap_percentage": 0.5756153525239883, "num_intersection": 5519, "num_union": 13657, "num_only_computed": 4069, "num_only_roped": 4069, "total_diff": 8138, "diff_percentage": 0.5958848941934539, "num_computed": 9588, "num_roped": 9588}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "mask_shape": [1, 32, 17, 3089], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:13.976590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.125, "l2_diff_relative": 0.11267605633802817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "attention_shape": [1, 32, 17, 3089]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:27.716544", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3912140801207946, "overlap_percentage": 0.5624067290733957, "num_intersection": 8291, "num_union": 21193, "num_only_computed": 6451, "num_only_roped": 6451, "total_diff": 12902, "diff_percentage": 0.6087859198792054, "num_computed": 14742, "num_roped": 14742}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "mask_shape": [1, 32, 26, 3115], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:28.174005", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 9.393692016601562e-05, "l2_diff": 0.18359375, "l2_diff_relative": 0.15878378378378377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "attention_shape": [1, 32, 26, 3115]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:41.518288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3695652173913043, "overlap_percentage": 0.5396825396825397, "num_intersection": 306, "num_union": 828, "num_only_computed": 261, "num_only_roped": 261, "total_diff": 522, "diff_percentage": 0.6304347826086957, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "mask_shape": [1, 32, 1, 3116], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:41.928195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 9.250640869140625e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.17181069958847736}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "attention_shape": [1, 32, 1, 3116]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:54.523762", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34679334916864607, "overlap_percentage": 0.5149911816578483, "num_intersection": 292, "num_union": 842, "num_only_computed": 275, "num_only_roped": 275, "total_diff": 550, "diff_percentage": 0.6532066508313539, "num_computed": 567, "num_roped": 567}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "mask_shape": [1, 32, 1, 3117], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:27:54.933721", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 8.726119995117188e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.15649606299212598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "attention_shape": [1, 32, 1, 3117]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:06.056414", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:06.070087", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.003087197580645161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:11.993777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5058655034230755, "overlap_percentage": 0.6718601392663044, "num_intersection": 316473, "num_union": 625607, "num_only_computed": 154567, "num_only_roped": 154567, "total_diff": 309134, "diff_percentage": 0.4941344965769245, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:12.382467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 0.000125885009765625, "l2_diff": 1.25, "l2_diff_relative": 0.1652892561983471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:27.412916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39722209431113414, "overlap_percentage": 0.5685883381438721, "num_intersection": 327798, "num_union": 825226, "num_only_computed": 248714, "num_only_roped": 248714, "total_diff": 497428, "diff_percentage": 0.6027779056888658, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:27.962177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 0.00011205673217773438, "l2_diff": 1.453125, "l2_diff_relative": 0.21232876712328766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:47.797591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.339867126957408, "overlap_percentage": 0.5073146734022557, "num_intersection": 345461, "num_union": 1016459, "num_only_computed": 335499, "num_only_roped": 335499, "total_diff": 670998, "diff_percentage": 0.6601328730425919, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:28:48.538302", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 7.152557373046875e-05, "l2_diff": 1.25, "l2_diff_relative": 0.1724137931034483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:29:14.447632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2965027667436832, "overlap_percentage": 0.45738855997721356, "num_intersection": 359705, "num_union": 1213159, "num_only_computed": 426727, "num_only_roped": 426727, "total_diff": 853454, "diff_percentage": 0.7034972332563167, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:29:15.665399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.17266949152542374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:29:46.735443", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2664592578060862, "overlap_percentage": 0.4207940463362069, "num_intersection": 374877, "num_union": 1406883, "num_only_computed": 516003, "num_only_roped": 516003, "total_diff": 1032006, "diff_percentage": 0.7335407421939137, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:29:47.818043", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.095703125, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.15406976744186046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:30:24.692945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24065282953251527, "overlap_percentage": 0.38794548128858025, "num_intersection": 386133, "num_union": 1604523, "num_only_computed": 609195, "num_only_roped": 609195, "total_diff": 1218390, "diff_percentage": 0.7593471704674847, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:30:25.975286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.16015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:31:09.364963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21375173660881647, "overlap_percentage": 0.35221656976744187, "num_intersection": 387720, "num_union": 1813880, "num_only_computed": 713080, "num_only_roped": 713080, "total_diff": 1426160, "diff_percentage": 0.7862482633911836, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:31:10.860339", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08447265625, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.546875, "l2_diff_relative": 0.21710526315789475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:31:59.752794", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19397094442985996, "overlap_percentage": 0.32491736140611727, "num_intersection": 391606, "num_union": 2018890, "num_only_computed": 813642, "num_only_roped": 813642, "total_diff": 1627284, "diff_percentage": 0.80602905557014, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:32:02.760793", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.888938903808594e-05, "l2_diff": 2.375, "l2_diff_relative": 0.36893203883495146}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:32:57.782743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1559294829395631, "overlap_percentage": 0.2697906494140625, "num_intersection": 353620, "num_union": 2267820, "num_only_computed": 957100, "num_only_roped": 957100, "total_diff": 1914200, "diff_percentage": 0.8440705170604369, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:32:59.673412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 9.1552734375e-05, "l2_diff": 3.46875, "l2_diff_relative": 0.8844621513944223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:34:01.965096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14737242368446868, "overlap_percentage": 0.25688681485166426, "num_intersection": 363538, "num_union": 2466798, "num_only_computed": 1051630, "num_only_roped": 1051630, "total_diff": 2103260, "diff_percentage": 0.8526275763155313, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:34:05.675130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 8.535385131835938e-05, "l2_diff": 3.734375, "l2_diff_relative": 0.8984962406015038}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:35:15.226273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1375456864333984, "overlap_percentage": 0.24182885676381402, "num_intersection": 367487, "num_union": 2671745, "num_only_computed": 1152129, "num_only_roped": 1152129, "total_diff": 2304258, "diff_percentage": 0.8624543135666016, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:35:17.637902", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2109375, "mean_diff": 7.62939453125e-05, "l2_diff": 3.96875, "l2_diff_relative": 0.7888198757763976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:36:34.377819", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13658771481655943, "overlap_percentage": 0.24034698428638943, "num_intersection": 390585, "num_union": 2859591, "num_only_computed": 1234503, "num_only_roped": 1234503, "total_diff": 2469006, "diff_percentage": 0.8634122851834406, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:36:38.122478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 6.961822509765625e-05, "l2_diff": 3.953125, "l2_diff_relative": 0.7146892655367232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:38:01.694504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13642089078562206, "overlap_percentage": 0.2400886711811723, "num_intersection": 415242, "num_union": 3043830, "num_only_computed": 1314294, "num_only_roped": 1314294, "total_diff": 2628588, "diff_percentage": 0.863579109214378, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:38:04.571708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1767578125, "mean_diff": 6.389617919921875e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.7861635220125787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:39:34.412792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12409942263809975, "overlap_percentage": 0.2207979474748884, "num_intersection": 405166, "num_union": 3264850, "num_only_computed": 1429842, "num_only_roped": 1429842, "total_diff": 2859684, "diff_percentage": 0.8759005773619002, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:39:39.965030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2021484375, "mean_diff": 7.104873657226562e-05, "l2_diff": 4.375, "l2_diff_relative": 1.0526315789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:41:16.654320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11865954608083004, "overlap_percentage": 0.21214595002840328, "num_intersection": 326398, "num_union": 2750710, "num_only_computed": 1212156, "num_only_roped": 1212156, "total_diff": 2424312, "diff_percentage": 0.8813404539191699, "num_computed": 1538554, "num_roped": 1538554}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "mask_shape": [1, 32, 821, 16181], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:41:19.955447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 6.246566772460938e-05, "l2_diff": 3.890625, "l2_diff_relative": 0.8892857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "attention_shape": [1, 32, 821, 16181]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:42:48.660728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1132858837485172, "overlap_percentage": 0.2035162493340437, "num_intersection": 11460, "num_union": 101160, "num_only_computed": 44850, "num_only_roped": 44850, "total_diff": 89700, "diff_percentage": 0.8867141162514828, "num_computed": 56310, "num_roped": 56310}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "mask_shape": [1, 32, 30, 16211], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:42:52.879028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 5.91278076171875e-05, "l2_diff": 0.578125, "l2_diff_relative": 0.6244725738396625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "attention_shape": [1, 32, 30, 16211]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:01.581777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12665066026410565, "overlap_percentage": 0.22482685135855088, "num_intersection": 422, "num_union": 3332, "num_only_computed": 1455, "num_only_roped": 1455, "total_diff": 2910, "diff_percentage": 0.8733493397358943, "num_computed": 1877, "num_roped": 1877}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "mask_shape": [1, 32, 1, 16212], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:03.492374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.08251953125, "l2_diff_relative": 0.7316017316017316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "attention_shape": [1, 32, 1, 16212]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:38.560738", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:38.586738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:46.833101", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5109930647779254, "overlap_percentage": 0.6763671875, "num_intersection": 318596, "num_union": 623484, "num_only_computed": 152444, "num_only_roped": 152444, "total_diff": 304888, "diff_percentage": 0.48900693522207467, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:44:47.222570", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 6.532669067382812e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.08678057553956835}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:02.972836", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40724747878493484, "overlap_percentage": 0.57878587089254, "num_intersection": 333677, "num_union": 819347, "num_only_computed": 242835, "num_only_roped": 242835, "total_diff": 485670, "diff_percentage": 0.5927525212150652, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:03.517669", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.10994525547445255}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:23.332252", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34337471209946685, "overlap_percentage": 0.5112121123120301, "num_intersection": 348115, "num_union": 1013805, "num_only_computed": 332845, "num_only_roped": 332845, "total_diff": 665690, "diff_percentage": 0.6566252879005331, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:24.286258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.9802322387695312e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.06525157232704402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:50.674664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2895202864901027, "overlap_percentage": 0.44903564453125, "num_intersection": 353136, "num_union": 1219728, "num_only_computed": 433296, "num_only_roped": 433296, "total_diff": 866592, "diff_percentage": 0.7104797135098972, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:45:52.037634", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.10492700729927007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:46:23.291912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.27551188418911043, "overlap_percentage": 0.4320020653735632, "num_intersection": 384862, "num_union": 1396898, "num_only_computed": 506018, "num_only_roped": 506018, "total_diff": 1012036, "diff_percentage": 0.7244881158108896, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:46:24.371491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.719329833984375e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.1309055118110236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:47:01.124655", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24360271053534135, "overlap_percentage": 0.3917693463863169, "num_intersection": 389939, "num_union": 1600717, "num_only_computed": 605389, "num_only_roped": 605389, "total_diff": 1210778, "diff_percentage": 0.7563972894646587, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:47:02.377653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07470703125, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.15935114503816794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:47:45.141548", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2205378105605127, "overlap_percentage": 0.3613780886627907, "num_intersection": 397805, "num_union": 1803795, "num_only_computed": 702995, "num_only_roped": 702995, "total_diff": 1405990, "diff_percentage": 0.7794621894394873, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:47:46.632357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.4765625, "l2_diff_relative": 0.19207317073170732}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:48:35.558925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1841220780062898, "overlap_percentage": 0.3109849591121495, "num_intersection": 374814, "num_union": 2035682, "num_only_computed": 830434, "num_only_roped": 830434, "total_diff": 1660868, "diff_percentage": 0.8158779219937102, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:48:38.147466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.91278076171875e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.3978260869565217}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:49:33.416844", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1469202855750308, "overlap_percentage": 0.25619964599609374, "num_intersection": 335806, "num_union": 2285634, "num_only_computed": 974914, "num_only_roped": 974914, "total_diff": 1949828, "diff_percentage": 0.8530797144249692, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:49:35.312330", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 8.0108642578125e-05, "l2_diff": 3.84375, "l2_diff_relative": 0.6910112359550562}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:50:37.059826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13561437669594706, "overlap_percentage": 0.23883878097865413, "num_intersection": 337997, "num_union": 2492339, "num_only_computed": 1077171, "num_only_roped": 1077171, "total_diff": 2154342, "diff_percentage": 0.8643856233040529, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:50:41.087554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 9.059906005859375e-05, "l2_diff": 4.5625, "l2_diff_relative": 0.9864864864864865}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:51:50.711530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13912833911724481, "overlap_percentage": 0.24427157913578168, "num_intersection": 371199, "num_union": 2668033, "num_only_computed": 1148417, "num_only_roped": 1148417, "total_diff": 2296834, "diff_percentage": 0.8608716608827552, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:51:53.099874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.65625, "l2_diff_relative": 1.0205479452054795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:53:09.759698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13979674140990483, "overlap_percentage": 0.24530117753623187, "num_intersection": 398636, "num_union": 2851540, "num_only_computed": 1226452, "num_only_roped": 1226452, "total_diff": 2452904, "diff_percentage": 0.8602032585900952, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:53:13.195552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2041015625, "mean_diff": 7.581710815429688e-05, "l2_diff": 4.5625, "l2_diff_relative": 0.9125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:54:36.649435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13141917373775303, "overlap_percentage": 0.23230854980757845, "num_intersection": 401786, "num_union": 3057286, "num_only_computed": 1327750, "num_only_roped": 1327750, "total_diff": 2655500, "diff_percentage": 0.868580826262247, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:54:39.513696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 7.05718994140625e-05, "l2_diff": 4.4375, "l2_diff_relative": 0.9161290322580645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:56:10.489446", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1302191568540256, "overlap_percentage": 0.23043169294084823, "num_intersection": 422844, "num_union": 3247172, "num_only_computed": 1412164, "num_only_roped": 1412164, "total_diff": 2824328, "diff_percentage": 0.8697808431459744, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:56:15.070206", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1904296875, "mean_diff": 5.888938903808594e-05, "l2_diff": 3.875, "l2_diff_relative": 0.779874213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:57:54.550664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13470734417063704, "overlap_percentage": 0.23743099022434772, "num_intersection": 432132, "num_union": 3207932, "num_only_computed": 1387900, "num_only_roped": 1387900, "total_diff": 2775800, "diff_percentage": 0.865292655829363, "num_computed": 1820032, "num_roped": 1820032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:57:57.906840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 4.982948303222656e-05, "l2_diff": 3.140625, "l2_diff_relative": 0.6165644171779141}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:59:30.526280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13408336202396687, "overlap_percentage": 0.23646121002017353, "num_intersection": 12073, "num_union": 90041, "num_only_computed": 38984, "num_only_roped": 38984, "total_diff": 77968, "diff_percentage": 0.8659166379760331, "num_computed": 51057, "num_roped": 51057}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 27, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T00:59:33.033736", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.39453125, "l2_diff_relative": 0.37969924812030076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 27, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:00:41.916435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15269734836939958, "overlap_percentage": 0.26493918561607616, "num_intersection": 501, "num_union": 3281, "num_only_computed": 1390, "num_only_roped": 1390, "total_diff": 2780, "diff_percentage": 0.8473026516306005, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:00:43.851081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 8.058547973632812e-05, "l2_diff": 0.1015625, "l2_diff_relative": 1.7854077253218885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:01:43.381486", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13267445342917042, "overlap_percentage": 0.23426758328926495, "num_intersection": 443, "num_union": 3339, "num_only_computed": 1448, "num_only_roped": 1448, "total_diff": 2896, "diff_percentage": 0.8673255465708296, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:01:47.667447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.07763671875, "l2_diff_relative": 0.8238341968911918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:02:47.312777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13267445342917042, "overlap_percentage": 0.23426758328926495, "num_intersection": 443, "num_union": 3339, "num_only_computed": 1448, "num_only_roped": 1448, "total_diff": 2896, "diff_percentage": 0.8673255465708296, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:02:49.255547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.045166015625, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.09228515625, "l2_diff_relative": 1.0558659217877095}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:48.440559", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1371016235718581, "overlap_percentage": 0.24114225277630882, "num_intersection": 456, "num_union": 3326, "num_only_computed": 1435, "num_only_roped": 1435, "total_diff": 2870, "diff_percentage": 0.8628983764281419, "num_computed": 1891, "num_roped": 1891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:03:52.391956", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.0537109375, "l2_diff_relative": 0.3005464480874317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:27.061912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:27.075511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.003022989649681529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:32.908646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5087136025726027, "overlap_percentage": 0.6743673573369565, "num_intersection": 317654, "num_union": 624426, "num_only_computed": 153386, "num_only_roped": 153386, "total_diff": 306772, "diff_percentage": 0.4912863974273973, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:33.289930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 0.00011110305786132812, "l2_diff": 1.0859375, "l2_diff_relative": 0.1373517786561265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:47.813985", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4042755830423551, "overlap_percentage": 0.5757781277753108, "num_intersection": 331943, "num_union": 821081, "num_only_computed": 244569, "num_only_roped": 244569, "total_diff": 489138, "diff_percentage": 0.5957244169576449, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:04:48.370530", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 7.43865966796875e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.13796296296296295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:05:09.327835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3428025205154219, "overlap_percentage": 0.5105777138157894, "num_intersection": 347683, "num_union": 1014237, "num_only_computed": 333277, "num_only_roped": 333277, "total_diff": 666554, "diff_percentage": 0.6571974794845781, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:05:10.064581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.10264598540145986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:05:36.164805", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31113082099057704, "overlap_percentage": 0.4745992024739583, "num_intersection": 373240, "num_union": 1199624, "num_only_computed": 413192, "num_only_roped": 413192, "total_diff": 826384, "diff_percentage": 0.6888691790094229, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:05:37.067241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.9591064453125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.14556962025316456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:06:08.158461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2589060879346355, "overlap_percentage": 0.41131914511494255, "num_intersection": 366436, "num_union": 1415324, "num_only_computed": 524444, "num_only_roped": 524444, "total_diff": 1048888, "diff_percentage": 0.7410939120653646, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:06:11.167031", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:06:48.068298", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23118332772577038, "overlap_percentage": 0.37554655349794236, "num_intersection": 373792, "num_union": 1616864, "num_only_computed": 621536, "num_only_roped": 621536, "total_diff": 1243072, "diff_percentage": 0.7688166722742297, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:06:51.237365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.15716911764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:07:34.561599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22984725784170074, "overlap_percentage": 0.3737817950581395, "num_intersection": 411459, "num_union": 1790141, "num_only_computed": 689341, "num_only_roped": 689341, "total_diff": 1378682, "diff_percentage": 0.7701527421582992, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:07:36.051661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.11676356589147287}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:08:25.462895", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19893977835617896, "overlap_percentage": 0.3318595011151232, "num_intersection": 399973, "num_union": 2010523, "num_only_computed": 805275, "num_only_roped": 805275, "total_diff": 1610550, "diff_percentage": 0.8010602216438211, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:08:29.394085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.3419811320754717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:09:24.769344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16939561628314162, "overlap_percentage": 0.2897148132324219, "num_intersection": 379735, "num_union": 2241705, "num_only_computed": 930985, "num_only_roped": 930985, "total_diff": 1861970, "diff_percentage": 0.8306043837168584, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:09:26.698797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.8618421052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:10:28.915177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15894544389916324, "overlap_percentage": 0.2742932287897974, "num_intersection": 388171, "num_union": 2442165, "num_only_computed": 1026997, "num_only_roped": 1026997, "total_diff": 2053994, "diff_percentage": 0.8410545561008368, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:10:33.555555", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 8.296966552734375e-05, "l2_diff": 4.09375, "l2_diff_relative": 0.8618421052631579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:11:42.776198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15720665013676766, "overlap_percentage": 0.2717002190026954, "num_intersection": 412880, "num_union": 2626352, "num_only_computed": 1106736, "num_only_roped": 1106736, "total_diff": 2213472, "diff_percentage": 0.8427933498632324, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:11:45.200806", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.189453125, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.96875, "l2_diff_relative": 0.8581081081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:02.303162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15435398745551537, "overlap_percentage": 0.2674292099873976, "num_intersection": 434596, "num_union": 2815580, "num_only_computed": 1190492, "num_only_roped": 1190492, "total_diff": 2380984, "diff_percentage": 0.8456460125444846, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:13:06.400506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.193359375, "mean_diff": 7.534027099609375e-05, "l2_diff": 3.953125, "l2_diff_relative": 0.9730769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:14:30.214326", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14906966824833473, "overlap_percentage": 0.259461497187685, "num_intersection": 448748, "num_union": 3010324, "num_only_computed": 1280788, "num_only_roped": 1280788, "total_diff": 2561576, "diff_percentage": 0.8509303317516652, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:14:33.162356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.343292236328125e-05, "l2_diff": 4.03125, "l2_diff_relative": 0.9626865671641791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:15:51.626262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14681490932288344, "overlap_percentage": 0.25603941513032424, "num_intersection": 22554, "num_union": 153622, "num_only_computed": 65534, "num_only_roped": 65534, "total_diff": 131068, "diff_percentage": 0.8531850906771166, "num_computed": 88088, "num_roped": 88088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "mask_shape": [1, 32, 52, 14388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:15:53.772922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.349609375, "l2_diff_relative": 0.19977678571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "attention_shape": [1, 32, 52, 14388]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:17:01.399685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1436594406379872, "overlap_percentage": 0.2512276566489884, "num_intersection": 12790, "num_union": 89030, "num_only_computed": 38120, "num_only_roped": 38120, "total_diff": 76240, "diff_percentage": 0.8563405593620128, "num_computed": 50910, "num_roped": 50910}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "mask_shape": [1, 32, 30, 14418], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:17:03.534422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.330078125, "l2_diff_relative": 0.2725806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "attention_shape": [1, 32, 30, 14418]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:18:05.014554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14778491714575584, "overlap_percentage": 0.2575132586918091, "num_intersection": 437, "num_union": 2957, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.8522150828542442, "num_computed": 1697, "num_roped": 1697}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "mask_shape": [1, 32, 1, 14419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:18:08.276397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.0277099609375, "l2_diff_relative": 0.09651360544217687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "attention_shape": [1, 32, 1, 14419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:19:00.563206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13768844221105528, "overlap_percentage": 0.2420494699646643, "num_intersection": 411, "num_union": 2985, "num_only_computed": 1287, "num_only_roped": 1287, "total_diff": 2574, "diff_percentage": 0.8623115577889447, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "mask_shape": [1, 32, 1, 14420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:19:02.768093", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.06201171875, "l2_diff_relative": 0.2809734513274336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "attention_shape": [1, 32, 1, 14420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:19:55.718377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1380697050938338, "overlap_percentage": 0.24263839811542992, "num_intersection": 412, "num_union": 2984, "num_only_computed": 1286, "num_only_roped": 1286, "total_diff": 2572, "diff_percentage": 0.8619302949061662, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "mask_shape": [1, 32, 1, 14421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:19:58.469442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0108642578125, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.15186915887850466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "attention_shape": [1, 32, 1, 14421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:20:50.758773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1469098277608916, "overlap_percentage": 0.25618374558303886, "num_intersection": 435, "num_union": 2961, "num_only_computed": 1263, "num_only_roped": 1263, "total_diff": 2526, "diff_percentage": 0.8530901722391084, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14422, 128], "mask_shape": [1, 32, 1, 14422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:20:53.390621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023681640625, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.12121212121212122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14422, 128], "attention_shape": [1, 32, 1, 14422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:21:46.546356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1523583305055989, "overlap_percentage": 0.26442873969375735, "num_intersection": 449, "num_union": 2947, "num_only_computed": 1249, "num_only_roped": 1249, "total_diff": 2498, "diff_percentage": 0.8476416694944011, "num_computed": 1698, "num_roped": 1698}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14423, 128], "mask_shape": [1, 32, 1, 14423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:21:50.928841", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0272216796875, "l2_diff_relative": 0.12279735682819383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14423, 128], "attention_shape": [1, 32, 1, 14423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:22.974709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:22.987324", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:29.068108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5123417152544114, "overlap_percentage": 0.6775475543478261, "num_intersection": 319152, "num_union": 622928, "num_only_computed": 151888, "num_only_roped": 151888, "total_diff": 303776, "diff_percentage": 0.4876582847455886, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:30.924798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 5.9604644775390625e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.08106884057971014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:46.050406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41167021719434854, "overlap_percentage": 0.5832385102131439, "num_intersection": 336244, "num_union": 816780, "num_only_computed": 240268, "num_only_roped": 240268, "total_diff": 480536, "diff_percentage": 0.5883297828056515, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:22:46.613952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.7265625, "l2_diff_relative": 0.07404458598726114}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:23:07.556008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3417190775681342, "overlap_percentage": 0.509375, "num_intersection": 346864, "num_union": 1015056, "num_only_computed": 334096, "num_only_roped": 334096, "total_diff": 668192, "diff_percentage": 0.6582809224318659, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:23:08.296003", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.73046875, "l2_diff_relative": 0.0859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:23:34.141369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2805721306149965, "overlap_percentage": 0.4381980895996094, "num_intersection": 344613, "num_union": 1228251, "num_only_computed": 441819, "num_only_roped": 441819, "total_diff": 883638, "diff_percentage": 0.7194278693850036, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:23:35.052538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 2.872943878173828e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.08232758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:24:06.151441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26778121211086253, "overlap_percentage": 0.4224407327586207, "num_intersection": 376344, "num_union": 1405416, "num_only_computed": 514536, "num_only_roped": 514536, "total_diff": 1029072, "diff_percentage": 0.7322187878891374, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:24:08.692513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.0, "l2_diff_relative": 0.1322314049586777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:24:45.048419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23884226955792262, "overlap_percentage": 0.38558947402263377, "num_intersection": 383788, "num_union": 1606868, "num_only_computed": 611540, "num_only_roped": 611540, "total_diff": 1223080, "diff_percentage": 0.7611577304420774, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:24:46.319686", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07373046875, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.17786561264822134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:25:30.813430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21169559230317928, "overlap_percentage": 0.3494204215116279, "num_intersection": 384642, "num_union": 1816958, "num_only_computed": 716158, "num_only_roped": 716158, "total_diff": 1432316, "diff_percentage": 0.7883044076968208, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:25:32.431878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.1812015503875969}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:26:21.138515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18100839323308748, "overlap_percentage": 0.3065319336767205, "num_intersection": 369447, "num_union": 2041049, "num_only_computed": 835801, "num_only_roped": 835801, "total_diff": 1671602, "diff_percentage": 0.8189916067669125, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:26:22.786104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.09375, "l2_diff_relative": 0.4230769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:27:18.869721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15800414973868662, "overlap_percentage": 0.2728904724121094, "num_intersection": 357683, "num_union": 2263757, "num_only_computed": 953037, "num_only_roped": 953037, "total_diff": 1906074, "diff_percentage": 0.8419958502613134, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:27:22.858096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1953125, "mean_diff": 9.298324584960938e-05, "l2_diff": 4.625, "l2_diff_relative": 0.8757396449704142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:28:24.429796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15078494138808848, "overlap_percentage": 0.26205581245477566, "num_intersection": 370853, "num_union": 2459483, "num_only_computed": 1044315, "num_only_roped": 1044315, "total_diff": 2088630, "diff_percentage": 0.8492150586119115, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:28:26.608748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1982421875, "mean_diff": 9.870529174804688e-05, "l2_diff": 4.96875, "l2_diff_relative": 1.1521739130434783}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:29:36.087988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14718432852186825, "overlap_percentage": 0.2566010097287736, "num_intersection": 389935, "num_union": 2649297, "num_only_computed": 1129681, "num_only_roped": 1129681, "total_diff": 2259362, "diff_percentage": 0.8528156714781318, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:29:40.820835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.21875, "mean_diff": 8.440017700195312e-05, "l2_diff": 4.6875, "l2_diff_relative": 0.9433962264150944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:30:57.234821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14150286694871383, "overlap_percentage": 0.2479238047416509, "num_intersection": 402898, "num_union": 2847278, "num_only_computed": 1222190, "num_only_roped": 1222190, "total_diff": 2444380, "diff_percentage": 0.8584971330512862, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:31:01.446349", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2119140625, "mean_diff": 8.249282836914062e-05, "l2_diff": 4.6875, "l2_diff_relative": 1.048951048951049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:32:23.424432", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13650438069800377, "overlap_percentage": 0.24021795782989813, "num_intersection": 354886, "num_union": 2599814, "num_only_computed": 1122464, "num_only_roped": 1122464, "total_diff": 2244928, "diff_percentage": 0.8634956193019963, "num_computed": 1477350, "num_roped": 1477350}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:32:26.192696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 7.915496826171875e-05, "l2_diff": 4.0, "l2_diff_relative": 1.024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:33:42.361909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1371670291954048, "overlap_percentage": 0.24124341574070515, "num_intersection": 12549, "num_union": 91487, "num_only_computed": 39469, "num_only_roped": 39469, "total_diff": 78938, "diff_percentage": 0.8628329708045952, "num_computed": 52018, "num_roped": 52018}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 31, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:33:44.915809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.40625, "l2_diff_relative": 0.3939393939393939}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 31, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:34:44.331281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14227365554799182, "overlap_percentage": 0.24910607866507747, "num_intersection": 418, "num_union": 2938, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.8577263444520081, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:34:45.982119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052978515625, "mean_diff": 8.344650268554688e-05, "l2_diff": 0.099609375, "l2_diff_relative": 1.2289156626506024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:35:36.866211", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14110846650799047, "overlap_percentage": 0.24731823599523242, "num_intersection": 415, "num_union": 2941, "num_only_computed": 1263, "num_only_roped": 1263, "total_diff": 2526, "diff_percentage": 0.8588915334920095, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:35:39.451820", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 8.869171142578125e-05, "l2_diff": 0.0830078125, "l2_diff_relative": 1.328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:36:31.014285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12882610158089472, "overlap_percentage": 0.22824791418355184, "num_intersection": 383, "num_union": 2973, "num_only_computed": 1295, "num_only_roped": 1295, "total_diff": 2590, "diff_percentage": 0.8711738984191053, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:36:34.707291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 9.012222290039062e-05, "l2_diff": 0.126953125, "l2_diff_relative": 1.5204678362573099}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:26.196800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14072059823249491, "overlap_percentage": 0.2467222884386174, "num_intersection": 414, "num_union": 2942, "num_only_computed": 1264, "num_only_roped": 1264, "total_diff": 2528, "diff_percentage": 0.8592794017675051, "num_computed": 1678, "num_roped": 1678}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "mask_shape": [1, 32, 1, 14229], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:37:29.935825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.051025390625, "mean_diff": 7.724761962890625e-05, "l2_diff": 0.10986328125, "l2_diff_relative": 1.076555023923445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "attention_shape": [1, 32, 1, 14229]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:01.056571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:01.069115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.003142528044871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:07.034206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.511344549274151, "overlap_percentage": 0.6766750169836957, "num_intersection": 318741, "num_union": 623339, "num_only_computed": 152299, "num_only_roped": 152299, "total_diff": 304598, "diff_percentage": 0.48865545072584904, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:09.833419", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 0.00012493133544921875, "l2_diff": 1.2421875, "l2_diff_relative": 0.15711462450592886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:24.490155", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40393873937935754, "overlap_percentage": 0.5754364176287744, "num_intersection": 331746, "num_union": 821278, "num_only_computed": 244766, "num_only_roped": 244766, "total_diff": 489532, "diff_percentage": 0.5960612606206425, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:25.041728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 8.058547973632812e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.15816326530612246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:45.397186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3387515654090313, "overlap_percentage": 0.5060708411654136, "num_intersection": 344614, "num_union": 1017306, "num_only_computed": 336346, "num_only_roped": 336346, "total_diff": 672692, "diff_percentage": 0.6612484345909687, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:38:46.107791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 7.915496826171875e-05, "l2_diff": 1.359375, "l2_diff_relative": 0.19247787610619468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:11.664087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2939823384521218, "overlap_percentage": 0.45438385009765625, "num_intersection": 357342, "num_union": 1215522, "num_only_computed": 429090, "num_only_roped": 429090, "total_diff": 858180, "diff_percentage": 0.7060176615478782, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:12.571078", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 6.198883056640625e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.18482905982905984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:43.887302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2618652200240084, "overlap_percentage": 0.41504467492816094, "num_intersection": 369755, "num_union": 1412005, "num_only_computed": 521125, "num_only_roped": 521125, "total_diff": 1042250, "diff_percentage": 0.7381347799759916, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:39:47.610315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 5.650520324707031e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.2152777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:24.758422", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24254934541101097, "overlap_percentage": 0.390405976723251, "num_intersection": 388582, "num_union": 1602074, "num_only_computed": 606746, "num_only_roped": 606746, "total_diff": 1213492, "diff_percentage": 0.757450654588989, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:40:27.844171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.7220458984375e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.2638190954773869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:11.028891", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21678047270727577, "overlap_percentage": 0.35631813226744186, "num_intersection": 392235, "num_union": 1809365, "num_only_computed": 708565, "num_only_roped": 708565, "total_diff": 1417130, "diff_percentage": 0.7832195272927243, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:41:12.522159", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 5.173683166503906e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.26732673267326734}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:42:02.055224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.188885370643829, "overlap_percentage": 0.31775203111724726, "num_intersection": 382970, "num_union": 2027526, "num_only_computed": 822278, "num_only_roped": 822278, "total_diff": 1644556, "diff_percentage": 0.8111146293561711, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:42:06.081898", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.4557291666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:43:01.771435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1566368827139386, "overlap_percentage": 0.27084884643554685, "num_intersection": 355007, "num_union": 2266433, "num_only_computed": 955713, "num_only_roped": 955713, "total_diff": 1911426, "diff_percentage": 0.8433631172860614, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:43:03.668815", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.486343383789062e-05, "l2_diff": 3.4375, "l2_diff_relative": 0.6111111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:44:06.078229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14656181665128648, "overlap_percentage": 0.25565445233357453, "num_intersection": 361794, "num_union": 2468542, "num_only_computed": 1053374, "num_only_roped": 1053374, "total_diff": 2106748, "diff_percentage": 0.8534381833487136, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:44:10.255354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 7.62939453125e-05, "l2_diff": 3.25, "l2_diff_relative": 0.7482014388489209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:45:18.941250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14802369152665296, "overlap_percentage": 0.25787567385444743, "num_intersection": 391872, "num_union": 2647360, "num_only_computed": 1127744, "num_only_roped": 1127744, "total_diff": 2255488, "diff_percentage": 0.851976308473347, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:45:21.332745", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.234375, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.4375, "l2_diff_relative": 1.0757575757575757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:46:37.997245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1442210811141927, "overlap_percentage": 0.25208604087901704, "num_intersection": 409662, "num_union": 2840514, "num_only_computed": 1215426, "num_only_roped": 1215426, "total_diff": 2430852, "diff_percentage": 0.8557789188858073, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:46:42.495182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 7.152557373046875e-05, "l2_diff": 3.390625, "l2_diff_relative": 0.775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:48:06.949798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13783017440445255, "overlap_percentage": 0.2422684465660154, "num_intersection": 419012, "num_union": 3040060, "num_only_computed": 1310524, "num_only_roped": 1310524, "total_diff": 2621048, "diff_percentage": 0.8621698255955474, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:48:09.982016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 7.390975952148438e-05, "l2_diff": 3.640625, "l2_diff_relative": 0.9789915966386554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:49:43.717442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12700422394428262, "overlap_percentage": 0.22538375854492188, "num_intersection": 413581, "num_union": 3256435, "num_only_computed": 1421427, "num_only_roped": 1421427, "total_diff": 2842854, "diff_percentage": 0.8729957760557173, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:49:46.874897", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 6.914138793945312e-05, "l2_diff": 3.546875, "l2_diff_relative": 0.908}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:51:21.155614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12491787054034639, "overlap_percentage": 0.22209242792159214, "num_intersection": 195637, "num_union": 1566125, "num_only_computed": 685244, "num_only_roped": 685244, "total_diff": 1370488, "diff_percentage": 0.8750821294596536, "num_computed": 880881, "num_roped": 880881}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "mask_shape": [1, 32, 479, 15839], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:51:24.216533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 5.793571472167969e-05, "l2_diff": 1.65625, "l2_diff_relative": 0.572972972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "attention_shape": [1, 32, 479, 15839]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:52:51.120639", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1276526536294677, "overlap_percentage": 0.22640420916601284, "num_intersection": 19622, "num_union": 153714, "num_only_computed": 67046, "num_only_roped": 67046, "total_diff": 134092, "diff_percentage": 0.8723473463705322, "num_computed": 86668, "num_roped": 86668}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 47, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:52:56.330352", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.43167701863354035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 47, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:54:06.036023", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1354679802955665, "overlap_percentage": 0.2386117136659436, "num_intersection": 440, "num_union": 3248, "num_only_computed": 1404, "num_only_roped": 1404, "total_diff": 2808, "diff_percentage": 0.8645320197044335, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "mask_shape": [1, 32, 1, 15887], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:54:07.906529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.4836273193359375e-05, "l2_diff": 0.07275390625, "l2_diff_relative": 0.5518518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "attention_shape": [1, 32, 1, 15887]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:55:05.920248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1372186247301881, "overlap_percentage": 0.2413232104121475, "num_intersection": 445, "num_union": 3243, "num_only_computed": 1399, "num_only_roped": 1399, "total_diff": 2798, "diff_percentage": 0.8627813752698119, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "mask_shape": [1, 32, 1, 15888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:55:07.799429", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.032958984375, "mean_diff": 6.914138793945312e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.8055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "attention_shape": [1, 32, 1, 15888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:06.520713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13651771956856704, "overlap_percentage": 0.24023861171366595, "num_intersection": 443, "num_union": 3245, "num_only_computed": 1401, "num_only_roped": 1401, "total_diff": 2802, "diff_percentage": 0.8634822804314329, "num_computed": 1844, "num_roped": 1844}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "mask_shape": [1, 32, 1, 15889], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:09.687791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.0869140625, "l2_diff_relative": 0.726530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "attention_shape": [1, 32, 1, 15889]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:43.528273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:43.540825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0031754032258064515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:49.438287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5119800602493753, "overlap_percentage": 0.6772312330163044, "num_intersection": 319003, "num_union": 623077, "num_only_computed": 152037, "num_only_roped": 152037, "total_diff": 304074, "diff_percentage": 0.48801993975062474, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:56:49.828656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 0.00010013580322265625, "l2_diff": 1.0390625, "l2_diff_relative": 0.1259469696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:04.451826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3968953949448704, "overlap_percentage": 0.5682535662744227, "num_intersection": 327605, "num_union": 825419, "num_only_computed": 248907, "num_only_roped": 248907, "total_diff": 497814, "diff_percentage": 0.6031046050551295, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:05.008037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.1455357142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:25.470896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34353374075773047, "overlap_percentage": 0.5113883341165414, "num_intersection": 348235, "num_union": 1013685, "num_only_computed": 332725, "num_only_roped": 332725, "total_diff": 665450, "diff_percentage": 0.6564662592422695, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:26.194088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.80078125, "l2_diff_relative": 0.08429276315789473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:51.695280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2906059069403349, "overlap_percentage": 0.45034027099609375, "num_intersection": 354162, "num_union": 1218702, "num_only_computed": 432270, "num_only_roped": 432270, "total_diff": 864540, "diff_percentage": 0.7093940930596652, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:57:52.620950", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.11517857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:58:23.845814", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.25392696686146676, "overlap_percentage": 0.40501077586206896, "num_intersection": 360816, "num_union": 1420944, "num_only_computed": 530064, "num_only_roped": 530064, "total_diff": 1060128, "diff_percentage": 0.7460730331385332, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:58:27.534141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.15391791044776118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:59:04.334533", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24168129371741662, "overlap_percentage": 0.3892807195216049, "num_intersection": 387462, "num_union": 1603194, "num_only_computed": 607866, "num_only_roped": 607866, "total_diff": 1215732, "diff_percentage": 0.7583187062825834, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:59:05.619649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0751953125, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.17782426778242677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:59:50.255206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22391073278986715, "overlap_percentage": 0.3658938953488372, "num_intersection": 402776, "num_union": 1798824, "num_only_computed": 698024, "num_only_roped": 698024, "total_diff": 1396048, "diff_percentage": 0.7760892672101328, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T01:59:51.746145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.375, "l2_diff_relative": 0.19047619047619047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:00:41.367097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19258277097227444, "overlap_percentage": 0.3229675552251487, "num_intersection": 389256, "num_union": 2021240, "num_only_computed": 815992, "num_only_roped": 815992, "total_diff": 1631984, "diff_percentage": 0.8074172290277255, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:00:44.906283", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.297244094488189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:01:40.596833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16547915338439062, "overlap_percentage": 0.28396759033203123, "num_intersection": 372202, "num_union": 2249238, "num_only_computed": 938518, "num_only_roped": 938518, "total_diff": 1877036, "diff_percentage": 0.8345208466156093, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:01:42.544664", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19140625, "mean_diff": 9.489059448242188e-05, "l2_diff": 4.78125, "l2_diff_relative": 0.9161676646706587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:02:44.875437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15862236096749446, "overlap_percentage": 0.2738120138386397, "num_intersection": 387490, "num_union": 2442846, "num_only_computed": 1027678, "num_only_roped": 1027678, "total_diff": 2055356, "diff_percentage": 0.8413776390325055, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:02:48.545223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2099609375, "mean_diff": 9.250640869140625e-05, "l2_diff": 4.96875, "l2_diff_relative": 1.0324675324675325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:03:58.241127", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.157475046110758, "overlap_percentage": 0.27210097814184636, "num_intersection": 413489, "num_union": 2625743, "num_only_computed": 1106127, "num_only_roped": 1106127, "total_diff": 2212254, "diff_percentage": 0.842524953889242, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:04:00.875675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1806640625, "mean_diff": 7.772445678710938e-05, "l2_diff": 4.46875, "l2_diff_relative": 0.8411764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:05:16.634535", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15649521930765625, "overlap_percentage": 0.27063703627126656, "num_intersection": 439809, "num_union": 2810367, "num_only_computed": 1185279, "num_only_roped": 1185279, "total_diff": 2370558, "diff_percentage": 0.8435047806923437, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:05:20.817489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2265625, "mean_diff": 8.249282836914062e-05, "l2_diff": 4.75, "l2_diff_relative": 1.178294573643411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:06:39.056483", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15347761115310912, "overlap_percentage": 0.2661128567544203, "num_intersection": 218249, "num_union": 1422025, "num_only_computed": 601888, "num_only_roped": 601888, "total_diff": 1203776, "diff_percentage": 0.8465223888468909, "num_computed": 820137, "num_roped": 820137}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "mask_shape": [1, 32, 501, 13813], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:06:44.207745", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.185546875, "mean_diff": 7.82012939453125e-05, "l2_diff": 3.203125, "l2_diff_relative": 0.9490740740740741}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "attention_shape": [1, 32, 501, 13813]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:07:55.262166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14728103721667754, "overlap_percentage": 0.2567479674796748, "num_intersection": 12632, "num_union": 85768, "num_only_computed": 36568, "num_only_roped": 36568, "total_diff": 73136, "diff_percentage": 0.8527189627833225, "num_computed": 49200, "num_roped": 49200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "mask_shape": [1, 32, 30, 13843], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:07:57.228968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08154296875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.2962328767123288}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "attention_shape": [1, 32, 30, 13843]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:08:53.661840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1586012009890498, "overlap_percentage": 0.27378048780487807, "num_intersection": 449, "num_union": 2831, "num_only_computed": 1191, "num_only_roped": 1191, "total_diff": 2382, "diff_percentage": 0.8413987990109502, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "mask_shape": [1, 32, 1, 13844], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:08:55.275237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.6702880859375e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.13846153846153847}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "attention_shape": [1, 32, 1, 13844]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:09:45.166055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15128115128115127, "overlap_percentage": 0.2628048780487805, "num_intersection": 431, "num_union": 2849, "num_only_computed": 1209, "num_only_roped": 1209, "total_diff": 2418, "diff_percentage": 0.8487188487188487, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "mask_shape": [1, 32, 1, 13845], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:09:46.788354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.022216796875, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.1480392156862745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "attention_shape": [1, 32, 1, 13845]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:10:36.992823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14605171208944795, "overlap_percentage": 0.2548780487804878, "num_intersection": 418, "num_union": 2862, "num_only_computed": 1222, "num_only_roped": 1222, "total_diff": 2444, "diff_percentage": 0.8539482879105521, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "mask_shape": [1, 32, 1, 13846], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:10:40.944522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.13060538116591927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "attention_shape": [1, 32, 1, 13846]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:11:31.255966", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1484593837535014, "overlap_percentage": 0.25853658536585367, "num_intersection": 424, "num_union": 2856, "num_only_computed": 1216, "num_only_roped": 1216, "total_diff": 2432, "diff_percentage": 0.8515406162464986, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "mask_shape": [1, 32, 1, 13847], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:11:34.166359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.1447841726618705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "attention_shape": [1, 32, 1, 13847]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:12:25.113612", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15533638605142655, "overlap_percentage": 0.26890243902439026, "num_intersection": 441, "num_union": 2839, "num_only_computed": 1199, "num_only_roped": 1199, "total_diff": 2398, "diff_percentage": 0.8446636139485735, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "mask_shape": [1, 32, 1, 13848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:12:26.733581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.18275862068965518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "attention_shape": [1, 32, 1, 13848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:18.091603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14126652748782184, "overlap_percentage": 0.2475609756097561, "num_intersection": 406, "num_union": 2874, "num_only_computed": 1234, "num_only_roped": 1234, "total_diff": 2468, "diff_percentage": 0.8587334725121781, "num_computed": 1640, "num_roped": 1640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "mask_shape": [1, 32, 1, 13849], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:13:19.717341", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.02685546875, "l2_diff_relative": 0.09963768115942029}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "attention_shape": [1, 32, 1, 13849]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:09.771603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13642659279778394, "overlap_percentage": 0.2400975015234613, "num_intersection": 394, "num_union": 2888, "num_only_computed": 1247, "num_only_roped": 1247, "total_diff": 2494, "diff_percentage": 0.8635734072022161, "num_computed": 1641, "num_roped": 1641}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "mask_shape": [1, 32, 1, 13850], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:11.393605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0174560546875, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.19154228855721392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "attention_shape": [1, 32, 1, 13850]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:41.846345", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:41.858988", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003045333059210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:47.758113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5046052663100853, "overlap_percentage": 0.670747707201087, "num_intersection": 315949, "num_union": 626131, "num_only_computed": 155091, "num_only_roped": 155091, "total_diff": 310182, "diff_percentage": 0.4953947336899147, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:14:49.032367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 0.00010061264038085938, "l2_diff": 0.9765625, "l2_diff_relative": 0.12703252032520326}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:03.750144", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3982217608738886, "overlap_percentage": 0.5696117340142096, "num_intersection": 328388, "num_union": 824636, "num_only_computed": 248124, "num_only_roped": 248124, "total_diff": 496248, "diff_percentage": 0.6017782391261114, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:04.299953", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 9.012222290039062e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.1711111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:25.194410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.32797432042138847, "overlap_percentage": 0.4939467810150376, "num_intersection": 336358, "num_union": 1025562, "num_only_computed": 344602, "num_only_roped": 344602, "total_diff": 689204, "diff_percentage": 0.6720256795786115, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:25.920869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 7.772445678710938e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.18835616438356165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:51.454044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.28884296470985416, "overlap_percentage": 0.44822057088216144, "num_intersection": 352495, "num_union": 1220369, "num_only_computed": 433937, "num_only_roped": 433937, "total_diff": 867874, "diff_percentage": 0.7111570352901458, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:15:52.360063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.2079207920792079}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:16:23.671541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.26259487566867373, "overlap_percentage": 0.415960623204023, "num_intersection": 370571, "num_union": 1411189, "num_only_computed": 520309, "num_only_roped": 520309, "total_diff": 1040618, "diff_percentage": 0.7374051243313263, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:16:26.455759", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 6.079673767089844e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.23241206030150754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:17:03.704489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.24287207381351075, "overlap_percentage": 0.39082392939814814, "num_intersection": 388998, "num_union": 1601658, "num_only_computed": 606330, "num_only_roped": 606330, "total_diff": 1212660, "diff_percentage": 0.7571279261864893, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:17:04.996259", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.17410714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:17:49.781889", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22124193248666624, "overlap_percentage": 0.36232285610465115, "num_intersection": 398845, "num_union": 1802755, "num_only_computed": 701955, "num_only_roped": 701955, "total_diff": 1403910, "diff_percentage": 0.7787580675133338, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:17:51.257790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.1782608695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:18:40.897003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20422320605165004, "overlap_percentage": 0.3391783267841971, "num_intersection": 408794, "num_union": 2001702, "num_only_computed": 796454, "num_only_roped": 796454, "total_diff": 1592908, "diff_percentage": 0.79577679394835, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:18:44.193963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.5, "l2_diff_relative": 0.37037037037037035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:19:40.221889", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1698538084376884, "overlap_percentage": 0.29038467407226565, "num_intersection": 380613, "num_union": 2240827, "num_only_computed": 930107, "num_only_roped": 930107, "total_diff": 1860214, "diff_percentage": 0.8301461915623116, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:19:42.143173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 9.298324584960938e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.85}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:20:44.997037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1589122258914478, "overlap_percentage": 0.27424376469790157, "num_intersection": 388101, "num_union": 2442235, "num_only_computed": 1027067, "num_only_roped": 1027067, "total_diff": 2054134, "diff_percentage": 0.8410877741085522, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:20:48.901024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 9.393692016601562e-05, "l2_diff": 4.4375, "l2_diff_relative": 1.0441176470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:21:58.484484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15497484824773783, "overlap_percentage": 0.2683605595097709, "num_intersection": 407805, "num_union": 2631427, "num_only_computed": 1111811, "num_only_roped": 1111811, "total_diff": 2223622, "diff_percentage": 0.8450251517522622, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:22:00.909750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 9.107589721679688e-05, "l2_diff": 4.125, "l2_diff_relative": 1.11864406779661}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:17.349139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14897552284393162, "overlap_percentage": 0.2593188799621928, "num_intersection": 421416, "num_union": 2828760, "num_only_computed": 1203672, "num_only_roped": 1203672, "total_diff": 2407344, "diff_percentage": 0.8510244771560684, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:23:21.122866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 8.058547973632812e-05, "l2_diff": 3.828125, "l2_diff_relative": 0.98}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:24:44.807279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14156610104382314, "overlap_percentage": 0.24802085646092362, "num_intersection": 428961, "num_union": 3030111, "num_only_computed": 1300575, "num_only_roped": 1300575, "total_diff": 2601150, "diff_percentage": 0.8584338989561768, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:24:47.709136", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1591796875, "mean_diff": 7.200241088867188e-05, "l2_diff": 3.578125, "l2_diff_relative": 0.89453125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:26:19.113973", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13380545157235268, "overlap_percentage": 0.23602894374302455, "num_intersection": 433115, "num_union": 3236901, "num_only_computed": 1401893, "num_only_roped": 1401893, "total_diff": 2803786, "diff_percentage": 0.8661945484276473, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:26:24.354061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 6.67572021484375e-05, "l2_diff": 3.421875, "l2_diff_relative": 0.8795180722891566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:28:05.803471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13506839986616295, "overlap_percentage": 0.23799164857745844, "num_intersection": 458177, "num_union": 3392185, "num_only_computed": 1467004, "num_only_roped": 1467004, "total_diff": 2934008, "diff_percentage": 0.8649316001338371, "num_computed": 1925181, "num_roped": 1925181}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1017, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:28:11.457015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.84375, "l2_diff_relative": 1.0423728813559323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1017, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:29:42.236456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11772681719035548, "overlap_percentage": 0.21065400843881857, "num_intersection": 9985, "num_union": 84815, "num_only_computed": 37415, "num_only_roped": 37415, "total_diff": 74830, "diff_percentage": 0.8822731828096445, "num_computed": 47400, "num_roped": 47400}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "mask_shape": [1, 32, 25, 16402], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:29:44.765470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.744529724121094e-05, "l2_diff": 0.419921875, "l2_diff_relative": 0.4215686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "attention_shape": [1, 32, 25, 16402]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:30:53.868410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11990549320732427, "overlap_percentage": 0.2141350210970464, "num_intersection": 406, "num_union": 3386, "num_only_computed": 1490, "num_only_roped": 1490, "total_diff": 2980, "diff_percentage": 0.8800945067926758, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "mask_shape": [1, 32, 1, 16403], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:30:56.835432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 0.11328125, "l2_diff_relative": 0.8226950354609929}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "attention_shape": [1, 32, 1, 16403]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:31:56.713962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1192443919716647, "overlap_percentage": 0.21308016877637131, "num_intersection": 404, "num_union": 3388, "num_only_computed": 1492, "num_only_roped": 1492, "total_diff": 2984, "diff_percentage": 0.8807556080283353, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "mask_shape": [1, 32, 1, 16404], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:31:58.651015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.051513671875, "l2_diff_relative": 0.31398809523809523}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "attention_shape": [1, 32, 1, 16404]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:32:58.248871", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.10974539069359086, "overlap_percentage": 0.19778481012658228, "num_intersection": 375, "num_union": 3417, "num_only_computed": 1521, "num_only_roped": 1521, "total_diff": 3042, "diff_percentage": 0.8902546093064091, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "mask_shape": [1, 32, 1, 16405], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:33:00.953720", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.3734375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "attention_shape": [1, 32, 1, 16405]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:34:02.552647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12189349112426036, "overlap_percentage": 0.21729957805907174, "num_intersection": 412, "num_union": 3380, "num_only_computed": 1484, "num_only_roped": 1484, "total_diff": 2968, "diff_percentage": 0.8781065088757396, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "mask_shape": [1, 32, 1, 16406], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:34:04.538630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.673004150390625e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.3424657534246575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "attention_shape": [1, 32, 1, 16406]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:35:04.149269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.11858407079646018, "overlap_percentage": 0.2120253164556962, "num_intersection": 402, "num_union": 3390, "num_only_computed": 1494, "num_only_roped": 1494, "total_diff": 2988, "diff_percentage": 0.8814159292035398, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "mask_shape": [1, 32, 1, 16407], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:35:07.798152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 5.7220458984375e-05, "l2_diff": 0.0869140625, "l2_diff_relative": 0.6223776223776224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "attention_shape": [1, 32, 1, 16407]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:07.412076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14010823812387252, "overlap_percentage": 0.24578059071729957, "num_intersection": 466, "num_union": 3326, "num_only_computed": 1430, "num_only_roped": 1430, "total_diff": 2860, "diff_percentage": 0.8598917618761275, "num_computed": 1896, "num_roped": 1896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "mask_shape": [1, 32, 1, 16408], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:09.349804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.059326171875, "l2_diff_relative": 0.25961538461538464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "attention_shape": [1, 32, 1, 16408]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:47.049515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:47.062090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1739473342895508e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0029779128086419755}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:53.003191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5332834217636144, "overlap_percentage": 0.6956097146739131, "num_intersection": 327660, "num_union": 614420, "num_only_computed": 143380, "num_only_roped": 143380, "total_diff": 286760, "diff_percentage": 0.4667165782363855, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:36:53.390516", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.75, "l2_diff_relative": 0.07947019867549669}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:07.951330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41787269416028144, "overlap_percentage": 0.5894361262211367, "num_intersection": 339817, "num_union": 813207, "num_only_computed": 236695, "num_only_roped": 236695, "total_diff": 473390, "diff_percentage": 0.5821273058397185, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:10.824498", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.06875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:30.688012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3603256982816139, "overlap_percentage": 0.5297638627819549, "num_intersection": 360748, "num_union": 1001172, "num_only_computed": 320212, "num_only_roped": 320212, "total_diff": 640424, "diff_percentage": 0.639674301718386, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:31.408702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 5.9604644775390625e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1485042735042735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:56.833644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.29336519469583966, "overlap_percentage": 0.45364634195963544, "num_intersection": 356762, "num_union": 1216102, "num_only_computed": 429670, "num_only_roped": 429670, "total_diff": 859340, "diff_percentage": 0.7066348053041603, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:37:57.742516", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 6.29425048828125e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.1892430278884462}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:38:29.080118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2558448350477243, "overlap_percentage": 0.407446569683908, "num_intersection": 362986, "num_union": 1418774, "num_only_computed": 527894, "num_only_roped": 527894, "total_diff": 1055788, "diff_percentage": 0.7441551649522757, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:38:30.172490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.16018518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:39:07.204555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.23821733069847897, "overlap_percentage": 0.38477466724537035, "num_intersection": 382977, "num_union": 1607679, "num_only_computed": 612351, "num_only_roped": 612351, "total_diff": 1224702, "diff_percentage": 0.761782669301521, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:39:08.505074", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 2.7060508728027344e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.12325174825174826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:39:51.680213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21708316863976473, "overlap_percentage": 0.35672692587209304, "num_intersection": 392685, "num_union": 1808915, "num_only_computed": 708115, "num_only_roped": 708115, "total_diff": 1416230, "diff_percentage": 0.7829168313602353, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:39:53.169124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.19796380090497737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:40:44.189681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18748266558156695, "overlap_percentage": 0.315764888222175, "num_intersection": 380575, "num_union": 2029921, "num_only_computed": 824673, "num_only_roped": 824673, "total_diff": 1649346, "diff_percentage": 0.812517334418433, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:40:45.927769", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.75, "l2_diff_relative": 0.4512820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:41:41.657588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16001543477568245, "overlap_percentage": 0.275885009765625, "num_intersection": 361608, "num_union": 2259832, "num_only_computed": 949112, "num_only_roped": 949112, "total_diff": 1898224, "diff_percentage": 0.8399845652243175, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:41:43.614154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.208984375, "mean_diff": 8.96453857421875e-05, "l2_diff": 4.21875, "l2_diff_relative": 0.8709677419354839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:42:48.107696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14803235201064338, "overlap_percentage": 0.25788881602749636, "num_intersection": 364956, "num_union": 2465380, "num_only_computed": 1050212, "num_only_roped": 1050212, "total_diff": 2100424, "diff_percentage": 0.8519676479893566, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:42:50.248111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1923828125, "mean_diff": 8.0108642578125e-05, "l2_diff": 3.71875, "l2_diff_relative": 0.8263888888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:43:59.372262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15033404074044215, "overlap_percentage": 0.2613745841054582, "num_intersection": 397189, "num_union": 2642043, "num_only_computed": 1122427, "num_only_roped": 1122427, "total_diff": 2244854, "diff_percentage": 0.8496659592595579, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:44:01.777167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19921875, "mean_diff": 8.153915405273438e-05, "l2_diff": 4.15625, "l2_diff_relative": 0.9300699300699301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:45:20.251006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15878899202938956, "overlap_percentage": 0.2740602355072464, "num_intersection": 445372, "num_union": 2804804, "num_only_computed": 1179716, "num_only_roped": 1179716, "total_diff": 2359432, "diff_percentage": 0.8412110079706104, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:45:22.878228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1845703125, "mean_diff": 6.961822509765625e-05, "l2_diff": 3.984375, "l2_diff_relative": 0.75}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:46:47.022398", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14647077306118228, "overlap_percentage": 0.25551593028419184, "num_intersection": 441924, "num_union": 3017148, "num_only_computed": 1287612, "num_only_roped": 1287612, "total_diff": 2575224, "diff_percentage": 0.8535292269388177, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:46:51.874514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.18359375, "mean_diff": 6.437301635742188e-05, "l2_diff": 3.765625, "l2_diff_relative": 0.7724358974358975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:48:22.915387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1402317363323472, "overlap_percentage": 0.24597058977399552, "num_intersection": 451358, "num_union": 3218658, "num_only_computed": 1383650, "num_only_roped": 1383650, "total_diff": 2767300, "diff_percentage": 0.8597682636676528, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:48:26.037972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 5.984306335449219e-05, "l2_diff": 3.53125, "l2_diff_relative": 0.7635135135135135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:49:55.067693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1406997353533882, "overlap_percentage": 0.2466902217870674, "num_intersection": 69540, "num_union": 494244, "num_only_computed": 212352, "num_only_roped": 212352, "total_diff": 424704, "diff_percentage": 0.8593002646466118, "num_computed": 281892, "num_roped": 281892}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "mask_shape": [1, 32, 156, 15516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:49:57.777757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.5032258064516129}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "attention_shape": [1, 32, 156, 15516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:16.720006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14181175876860963, "overlap_percentage": 0.24839779005524862, "num_intersection": 13488, "num_union": 95112, "num_only_computed": 40812, "num_only_roped": 40812, "total_diff": 81624, "diff_percentage": 0.8581882412313904, "num_computed": 54300, "num_roped": 54300}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "mask_shape": [1, 32, 30, 15546], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:51:19.041966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.484375, "l2_diff_relative": 0.4626865671641791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "attention_shape": [1, 32, 30, 15546]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:24.332075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13231154207069126, "overlap_percentage": 0.23370165745856353, "num_intersection": 423, "num_union": 3197, "num_only_computed": 1387, "num_only_roped": 1387, "total_diff": 2774, "diff_percentage": 0.8676884579293087, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "mask_shape": [1, 32, 1, 15547], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:52:26.199876", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 4.00543212890625e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.2676470588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "attention_shape": [1, 32, 1, 15547]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:22.079360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15691914349632471, "overlap_percentage": 0.2712707182320442, "num_intersection": 491, "num_union": 3129, "num_only_computed": 1319, "num_only_roped": 1319, "total_diff": 2638, "diff_percentage": 0.8430808565036753, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "mask_shape": [1, 32, 1, 15548], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:53:23.895089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.05615234375, "l2_diff_relative": 0.3362573099415205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "attention_shape": [1, 32, 1, 15548]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:54:19.768056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15433673469387754, "overlap_percentage": 0.2674033149171271, "num_intersection": 484, "num_union": 3136, "num_only_computed": 1326, "num_only_roped": 1326, "total_diff": 2652, "diff_percentage": 0.8456632653061225, "num_computed": 1810, "num_roped": 1810}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15549, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15549, 128], "mask_shape": [1, 32, 1, 15549], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:54:21.585176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.06494140625, "l2_diff_relative": 0.41823899371069184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15549, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15549, 128], "attention_shape": [1, 32, 1, 15549]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:55:17.720568", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15313594396688954, "overlap_percentage": 0.26559911651021534, "num_intersection": 481, "num_union": 3141, "num_only_computed": 1330, "num_only_roped": 1330, "total_diff": 2660, "diff_percentage": 0.8468640560331104, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15550, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15550, 128], "mask_shape": [1, 32, 1, 15550], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:55:19.537220", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 4.410743713378906e-05, "l2_diff": 0.0537109375, "l2_diff_relative": 0.3055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15550, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15550, 128], "attention_shape": [1, 32, 1, 15550]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:56:17.444716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1642558662809386, "overlap_percentage": 0.28216454997239093, "num_intersection": 511, "num_union": 3111, "num_only_computed": 1300, "num_only_roped": 1300, "total_diff": 2600, "diff_percentage": 0.8357441337190614, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15551, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15551, 128], "mask_shape": [1, 32, 1, 15551], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:56:20.899728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 6.246566772460938e-05, "l2_diff": 0.08642578125, "l2_diff_relative": 0.6807692307692308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15551, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15551, 128], "attention_shape": [1, 32, 1, 15551]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:57:17.547564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15829868883914294, "overlap_percentage": 0.27332965212589727, "num_intersection": 495, "num_union": 3127, "num_only_computed": 1316, "num_only_roped": 1316, "total_diff": 2632, "diff_percentage": 0.841701311160857, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15552, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15552, 128], "mask_shape": [1, 32, 1, 15552], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:57:19.381781", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.076171875, "l2_diff_relative": 0.7761194029850746}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15552, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15552, 128], "attention_shape": [1, 32, 1, 15552]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:58:15.832100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1535031847133758, "overlap_percentage": 0.26615129762562123, "num_intersection": 482, "num_union": 3140, "num_only_computed": 1329, "num_only_roped": 1329, "total_diff": 2658, "diff_percentage": 0.8464968152866242, "num_computed": 1811, "num_roped": 1811}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15553, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15553, 128], "mask_shape": [1, 32, 1, 15553], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:58:17.656347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.18121693121693122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15553, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15553, 128], "attention_shape": [1, 32, 1, 15553]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:58:51.825518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:58:51.837064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.0030976313694267518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:58:57.766063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.518110226069637, "overlap_percentage": 0.6825726052989131, "num_intersection": 321519, "num_union": 620561, "num_only_computed": 149521, "num_only_roped": 149521, "total_diff": 299042, "diff_percentage": 0.48188977393036303, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:58:58.154348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 8.487701416015625e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.10558712121212122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:59:13.418860", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41910122178010417, "overlap_percentage": 0.5906572629884547, "num_intersection": 340521, "num_union": 812503, "num_only_computed": 235991, "num_only_roped": 235991, "total_diff": 471982, "diff_percentage": 0.5808987782198958, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:59:13.971505", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 6.437301635742188e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.11743951612903226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:59:33.739932", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35581746558739114, "overlap_percentage": 0.5248751762218045, "num_intersection": 357419, "num_union": 1004501, "num_only_computed": 323541, "num_only_roped": 323541, "total_diff": 647082, "diff_percentage": 0.6441825344126089, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T02:59:34.475674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 6.628036499023438e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.14958158995815898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:00:00.741548", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.30871112841787857, "overlap_percentage": 0.47177886962890625, "num_intersection": 371022, "num_union": 1201842, "num_only_computed": 415410, "num_only_roped": 415410, "total_diff": 830820, "diff_percentage": 0.6912888715821215, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:00:01.842740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 6.723403930664062e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.19361702127659575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:00:33.319409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2729139295688013, "overlap_percentage": 0.4288018588362069, "num_intersection": 382011, "num_union": 1399749, "num_only_computed": 508869, "num_only_roped": 508869, "total_diff": 1017738, "diff_percentage": 0.7270860704311988, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:00:34.413410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.80078125, "l2_diff_relative": 0.10168650793650794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:01:11.677048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.245701555675148, "overlap_percentage": 0.39447900591563784, "num_intersection": 392636, "num_union": 1598020, "num_only_computed": 602692, "num_only_roped": 602692, "total_diff": 1205384, "diff_percentage": 0.754298444324852, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:01:12.970727", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.13204225352112675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:01:56.083120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2264245013054714, "overlap_percentage": 0.36924327761627906, "num_intersection": 406463, "num_union": 1795137, "num_only_computed": 694337, "num_only_roped": 694337, "total_diff": 1388674, "diff_percentage": 0.7735754986945286, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:01:57.576300", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.8515625, "l2_diff_relative": 0.09945255474452555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:02:46.493458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18987011858737673, "overlap_percentage": 0.31914427570093457, "num_intersection": 384648, "num_union": 2025848, "num_only_computed": 820600, "num_only_roped": 820600, "total_diff": 1641200, "diff_percentage": 0.8101298814126232, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:02:48.196327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.771087646484375e-05, "l2_diff": 2.5, "l2_diff_relative": 0.47904191616766467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:03:43.699281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15585557978187495, "overlap_percentage": 0.2696800231933594, "num_intersection": 353475, "num_union": 2267965, "num_only_computed": 957245, "num_only_roped": 957245, "total_diff": 1914490, "diff_percentage": 0.8441444202181251, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:03:45.635032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2421875, "mean_diff": 8.344650268554688e-05, "l2_diff": 3.609375, "l2_diff_relative": 0.721875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:04:48.034065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1427865419144934, "overlap_percentage": 0.24989188562771347, "num_intersection": 353639, "num_union": 2476697, "num_only_computed": 1061529, "num_only_roped": 1061529, "total_diff": 2123058, "diff_percentage": 0.8572134580855066, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:04:51.160469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1982421875, "mean_diff": 7.677078247070312e-05, "l2_diff": 4.125, "l2_diff_relative": 0.7586206896551724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:06:00.855383", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14083486671756676, "overlap_percentage": 0.2468979005222372, "num_intersection": 375190, "num_union": 2664042, "num_only_computed": 1144426, "num_only_roped": 1144426, "total_diff": 2288852, "diff_percentage": 0.8591651332824333, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:06:03.270625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1884765625, "mean_diff": 8.869171142578125e-05, "l2_diff": 4.6875, "l2_diff_relative": 1.0869565217391304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:07:20.619087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1392410121380433, "overlap_percentage": 0.24444522388941398, "num_intersection": 397245, "num_union": 2852931, "num_only_computed": 1227843, "num_only_roped": 1227843, "total_diff": 2455686, "diff_percentage": 0.8607589878619567, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:07:23.477421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 7.295608520507812e-05, "l2_diff": 4.4375, "l2_diff_relative": 0.8554216867469879}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:08:37.111727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13871070336391436, "overlap_percentage": 0.24362764476375448, "num_intersection": 28349, "num_union": 204375, "num_only_computed": 88013, "num_only_roped": 88013, "total_diff": 176026, "diff_percentage": 0.8612892966360857, "num_computed": 116362, "num_roped": 116362}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "mask_shape": [1, 32, 73, 13385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:08:39.316017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.3487394957983193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "attention_shape": [1, 32, 73, 13385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:09:44.828908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1332150683502035, "overlap_percentage": 0.23510994880106081, "num_intersection": 12766, "num_union": 95830, "num_only_computed": 41532, "num_only_roped": 41532, "total_diff": 83064, "diff_percentage": 0.8667849316497965, "num_computed": 54298, "num_roped": 54298}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "mask_shape": [1, 32, 34, 13419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:09:46.859842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 6.031990051269531e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.41836734693877553}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "attention_shape": [1, 32, 34, 13419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:10:43.684650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13898788310762653, "overlap_percentage": 0.24405506883604505, "num_intersection": 390, "num_union": 2806, "num_only_computed": 1208, "num_only_roped": 1208, "total_diff": 2416, "diff_percentage": 0.8610121168923734, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "mask_shape": [1, 32, 1, 13420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:10:45.272292", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.38285714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "attention_shape": [1, 32, 1, 13420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:11:33.740600", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14469914040114612, "overlap_percentage": 0.2528160200250313, "num_intersection": 404, "num_union": 2792, "num_only_computed": 1194, "num_only_roped": 1194, "total_diff": 2388, "diff_percentage": 0.8553008595988538, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "mask_shape": [1, 32, 1, 13421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:11:35.314563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 5.7697296142578125e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.4447852760736196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "attention_shape": [1, 32, 1, 13421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:12:23.944136", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14798850574712644, "overlap_percentage": 0.25782227784730916, "num_intersection": 412, "num_union": 2784, "num_only_computed": 1186, "num_only_roped": 1186, "total_diff": 2372, "diff_percentage": 0.8520114942528736, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "mask_shape": [1, 32, 1, 13422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:12:27.657527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.07080078125, "l2_diff_relative": 0.3717948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "attention_shape": [1, 32, 1, 13422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:13:16.225164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1393939393939394, "overlap_percentage": 0.24468085106382978, "num_intersection": 391, "num_union": 2805, "num_only_computed": 1207, "num_only_roped": 1207, "total_diff": 2414, "diff_percentage": 0.8606060606060606, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "mask_shape": [1, 32, 1, 13423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:13:17.802474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.30025125628140703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "attention_shape": [1, 32, 1, 13423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:06.831302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13655761024182078, "overlap_percentage": 0.24030037546933666, "num_intersection": 384, "num_union": 2812, "num_only_computed": 1214, "num_only_roped": 1214, "total_diff": 2428, "diff_percentage": 0.8634423897581792, "num_computed": 1598, "num_roped": 1598}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "mask_shape": [1, 32, 1, 13424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:08.406901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.22596153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "attention_shape": [1, 32, 1, 13424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:38.013759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:38.026419", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.0032252261513157896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:43.924461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5155044496065171, "overlap_percentage": 0.6803074048913044, "num_intersection": 320452, "num_union": 621628, "num_only_computed": 150588, "num_only_roped": 150588, "total_diff": 301176, "diff_percentage": 0.4844955503934829, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:14:46.486671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 0.00011396408081054688, "l2_diff": 1.1640625, "l2_diff_relative": 0.14437984496124032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:01.095899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39385074381484053, "overlap_percentage": 0.5651261378774423, "num_intersection": 325802, "num_union": 827222, "num_only_computed": 250710, "num_only_roped": 250710, "total_diff": 501420, "diff_percentage": 0.6061492561851595, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:01.652416", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 7.963180541992188e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.1495983935742972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:22.049600", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33935587163063863, "overlap_percentage": 0.5067448895676692, "num_intersection": 345073, "num_union": 1016847, "num_only_computed": 335887, "num_only_roped": 335887, "total_diff": 671774, "diff_percentage": 0.6606441283693614, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:22.785863", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.151199340820312e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.14522058823529413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:48.348131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31095815739859406, "overlap_percentage": 0.47439829508463544, "num_intersection": 373082, "num_union": 1199782, "num_only_computed": 413350, "num_only_roped": 413350, "total_diff": 826700, "diff_percentage": 0.6890418426014059, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:15:49.255465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.10299295774647887}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:16:20.681632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2556580936373535, "overlap_percentage": 0.40720972521551724, "num_intersection": 362775, "num_union": 1418985, "num_only_computed": 528105, "num_only_roped": 528105, "total_diff": 1056210, "diff_percentage": 0.7443419063626465, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:16:23.441000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.13617886178861788}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:00.381616", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22925831606351998, "overlap_percentage": 0.3730026684670782, "num_intersection": 371260, "num_union": 1619396, "num_only_computed": 624068, "num_only_roped": 624068, "total_diff": 1248136, "diff_percentage": 0.77074168393648, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:01.673779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.20242914979757085}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:47.033795", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.21432814548551338, "overlap_percentage": 0.3529987281976744, "num_intersection": 388581, "num_union": 1813019, "num_only_computed": 712219, "num_only_roped": 712219, "total_diff": 1424438, "diff_percentage": 0.7856718545144866, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:17:48.583774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:39.394924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19170428084816066, "overlap_percentage": 0.32173129513593884, "num_intersection": 387766, "num_union": 2022730, "num_only_computed": 817482, "num_only_roped": 817482, "total_diff": 1634964, "diff_percentage": 0.8082957191518394, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:18:43.393805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1806640625, "mean_diff": 7.534027099609375e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.5344827586206896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:19:40.448940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17944643260466786, "overlap_percentage": 0.30428924560546877, "num_intersection": 398838, "num_union": 2222602, "num_only_computed": 911882, "num_only_roped": 911882, "total_diff": 1823764, "diff_percentage": 0.8205535673953321, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:19:42.431629", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.17578125, "mean_diff": 0.00010585784912109375, "l2_diff": 4.375, "l2_diff_relative": 1.1764705882352942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:20:46.206511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16225732032526202, "overlap_percentage": 0.27921066615412443, "num_intersection": 395130, "num_union": 2435206, "num_only_computed": 1020038, "num_only_roped": 1020038, "total_diff": 2040076, "diff_percentage": 0.837742679674738, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:20:48.463282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.208984375, "mean_diff": 9.489059448242188e-05, "l2_diff": 4.28125, "l2_diff_relative": 1.113821138211382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:21:58.950009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15217216588799573, "overlap_percentage": 0.2641483111522911, "num_intersection": 401404, "num_union": 2637828, "num_only_computed": 1118212, "num_only_roped": 1118212, "total_diff": 2236424, "diff_percentage": 0.8478278341120042, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:22:01.354844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.265625, "mean_diff": 9.870529174804688e-05, "l2_diff": 4.75, "l2_diff_relative": 1.4074074074074074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:23:17.704227", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14707897158115743, "overlap_percentage": 0.2564408819706994, "num_intersection": 416739, "num_union": 2833437, "num_only_computed": 1208349, "num_only_roped": 1208349, "total_diff": 2416698, "diff_percentage": 0.8529210284188425, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:23:21.089037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 8.487701416015625e-05, "l2_diff": 4.53125, "l2_diff_relative": 1.1068702290076335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:24:44.617616", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1453023714119407, "overlap_percentage": 0.2537362622113677, "num_intersection": 438846, "num_union": 3020226, "num_only_computed": 1290690, "num_only_roped": 1290690, "total_diff": 2581380, "diff_percentage": 0.8546976285880593, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:24:47.511324", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.181640625, "mean_diff": 7.486343383789062e-05, "l2_diff": 4.3125, "l2_diff_relative": 1.0072992700729928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:26:19.423550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14027850015814694, "overlap_percentage": 0.24604252406529017, "num_intersection": 451490, "num_union": 3218526, "num_only_computed": 1383518, "num_only_roped": 1383518, "total_diff": 2767036, "diff_percentage": 0.8597214998418531, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:26:22.685771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.177734375, "mean_diff": 5.936622619628906e-05, "l2_diff": 3.90625, "l2_diff_relative": 0.7062146892655368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:27:58.511173", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13557706514509651, "overlap_percentage": 0.2387809146669819, "num_intersection": 290881, "num_union": 2145503, "num_only_computed": 927311, "num_only_roped": 927311, "total_diff": 1854622, "diff_percentage": 0.8644229348549035, "num_computed": 1218192, "num_roped": 1218192}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "mask_shape": [1, 32, 656, 16016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:28:01.679771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1689453125, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.6346153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "attention_shape": [1, 32, 656, 16016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:29:27.672952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13150157152996045, "overlap_percentage": 0.23243727598566308, "num_intersection": 10376, "num_union": 78904, "num_only_computed": 34264, "num_only_roped": 34264, "total_diff": 68528, "diff_percentage": 0.8684984284700396, "num_computed": 44640, "num_roped": 44640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "mask_shape": [1, 32, 24, 16040], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:29:30.673061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.3515625, "l2_diff_relative": 0.30201342281879195}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "attention_shape": [1, 32, 24, 16040]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:30:37.950677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.13657195233730524, "overlap_percentage": 0.2403225806451613, "num_intersection": 447, "num_union": 3273, "num_only_computed": 1413, "num_only_roped": 1413, "total_diff": 2826, "diff_percentage": 0.8634280476626948, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "mask_shape": [1, 32, 1, 16041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:30:41.083247", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 5.364418029785156e-05, "l2_diff": 0.10009765625, "l2_diff_relative": 0.6487341772151899}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "attention_shape": [1, 32, 1, 16041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:31:39.581344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12386706948640483, "overlap_percentage": 0.22043010752688172, "num_intersection": 410, "num_union": 3310, "num_only_computed": 1450, "num_only_roped": 1450, "total_diff": 2900, "diff_percentage": 0.8761329305135952, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "mask_shape": [1, 32, 1, 16042], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:31:41.479552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 6.771087646484375e-05, "l2_diff": 0.1259765625, "l2_diff_relative": 0.9626865671641791}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "attention_shape": [1, 32, 1, 16042]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:32:39.765729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.12590799031476999, "overlap_percentage": 0.22365591397849463, "num_intersection": 416, "num_union": 3304, "num_only_computed": 1444, "num_only_roped": 1444, "total_diff": 2888, "diff_percentage": 0.87409200968523, "num_computed": 1860, "num_roped": 1860}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "mask_shape": [1, 32, 1, 16043], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:32:41.655976", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.09619140625, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "attention_shape": [1, 32, 1, 16043]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:18.178897", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:18.192546", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:24.108310", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5070820442103848, "overlap_percentage": 0.6729322350543478, "num_intersection": 316978, "num_union": 625102, "num_only_computed": 154062, "num_only_roped": 154062, "total_diff": 308124, "diff_percentage": 0.4929179557896151, "num_computed": 471040, "num_roped": 471040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:24.498633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 9.34600830078125e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.11870503597122302}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:39.840119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37824757018696203, "overlap_percentage": 0.5488818966474245, "num_intersection": 316437, "num_union": 836587, "num_only_computed": 260075, "num_only_roped": 260075, "total_diff": 520150, "diff_percentage": 0.621752429813038, "num_computed": 576512, "num_roped": 576512}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:33:41.945476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 8.106231689453125e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.14717741935483872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:34:01.946605", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.31953137413721605, "overlap_percentage": 0.48431038533834586, "num_intersection": 329796, "num_union": 1032124, "num_only_computed": 351164, "num_only_roped": 351164, "total_diff": 702328, "diff_percentage": 0.6804686258627839, "num_computed": 680960, "num_roped": 680960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:34:02.684086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 8.344650268554688e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.20164609053497942}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:34:28.267333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2779948128262297, "overlap_percentage": 0.4350484212239583, "num_intersection": 342136, "num_union": 1230728, "num_only_computed": 444296, "num_only_roped": 444296, "total_diff": 888592, "diff_percentage": 0.7220051871737703, "num_computed": 786432, "num_roped": 786432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:34:29.185680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 7.534027099609375e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.22745901639344263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:35:00.921777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2494907043462467, "overlap_percentage": 0.39934783584770117, "num_intersection": 355771, "num_union": 1425989, "num_only_computed": 535109, "num_only_roped": 535109, "total_diff": 1070218, "diff_percentage": 0.7505092956537532, "num_computed": 890880, "num_roped": 890880}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:35:02.014662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 5.5789947509765625e-05, "l2_diff": 1.6171875, "l2_diff_relative": 0.20535714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:35:41.866629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.22351396651135003, "overlap_percentage": 0.36536398051697533, "num_intersection": 363657, "num_union": 1626999, "num_only_computed": 631671, "num_only_roped": 631671, "total_diff": 1263342, "diff_percentage": 0.77648603348865, "num_computed": 995328, "num_roped": 995328}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:35:43.170021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09716796875, "mean_diff": 5.054473876953125e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.24507389162561577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:36:28.687231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.2047889485130028, "overlap_percentage": 0.33995821220930234, "num_intersection": 374226, "num_union": 1827374, "num_only_computed": 726574, "num_only_roped": 726574, "total_diff": 1453148, "diff_percentage": 0.7952110514869972, "num_computed": 1100800, "num_roped": 1100800}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:36:30.192240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.14271653543307086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:37:20.103862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20590159866647723, "overlap_percentage": 0.3414898842395922, "num_intersection": 411580, "num_union": 1998916, "num_only_computed": 793668, "num_only_roped": 793668, "total_diff": 1587336, "diff_percentage": 0.7940984013335227, "num_computed": 1205248, "num_roped": 1205248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:37:23.366457", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 5.030632019042969e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.3263598326359833}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:38:19.216689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.20039747047591136, "overlap_percentage": 0.33388519287109375, "num_intersection": 437630, "num_union": 2183810, "num_only_computed": 873090, "num_only_roped": 873090, "total_diff": 1746180, "diff_percentage": 0.7996025295240886, "num_computed": 1310720, "num_roped": 1310720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:38:21.117736", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 7.963180541992188e-05, "l2_diff": 3.75, "l2_diff_relative": 0.7142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:39:23.427667", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.19059800045346723, "overlap_percentage": 0.3201718806530391, "num_intersection": 453097, "num_union": 2377239, "num_only_computed": 962071, "num_only_roped": 962071, "total_diff": 1924142, "diff_percentage": 0.8094019995465328, "num_computed": 1415168, "num_roped": 1415168}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:39:27.505335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 8.821487426757812e-05, "l2_diff": 3.671875, "l2_diff_relative": 0.9251968503937008}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:36.918470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.18042729837557017, "overlap_percentage": 0.30569828167115903, "num_intersection": 464544, "num_union": 2574688, "num_only_computed": 1055072, "num_only_roped": 1055072, "total_diff": 2110144, "diff_percentage": 0.8195727016244299, "num_computed": 1519616, "num_roped": 1519616}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:40:39.606549", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 8.440017700195312e-05, "l2_diff": 3.75, "l2_diff_relative": 0.9486166007905138}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:41:56.407890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1751666386449797, "overlap_percentage": 0.29811370215028354, "num_intersection": 484461, "num_union": 2765715, "num_only_computed": 1140627, "num_only_roped": 1140627, "total_diff": 2281254, "diff_percentage": 0.8248333613550203, "num_computed": 1625088, "num_roped": 1625088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:42:00.002744", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.765625, "l2_diff_relative": 0.7626582278481012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:43:23.134260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.17332566283548817, "overlap_percentage": 0.29544340216104203, "num_intersection": 510980, "num_union": 2948092, "num_only_computed": 1218556, "num_only_roped": 1218556, "total_diff": 2437112, "diff_percentage": 0.8266743371645118, "num_computed": 1729536, "num_roped": 1729536}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:43:25.984404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 7.05718994140625e-05, "l2_diff": 3.796875, "l2_diff_relative": 0.94921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:44:56.638989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16401059847645316, "overlap_percentage": 0.2818025861467634, "num_intersection": 517110, "num_union": 3152906, "num_only_computed": 1317898, "num_only_roped": 1317898, "total_diff": 2635796, "diff_percentage": 0.8359894015235468, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:45:00.412017", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 6.341934204101562e-05, "l2_diff": 3.375, "l2_diff_relative": 0.8181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:46:31.462093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15076877382066772, "overlap_percentage": 0.262031395447237, "num_intersection": 123857, "num_union": 821503, "num_only_computed": 348823, "num_only_roped": 348823, "total_diff": 697646, "diff_percentage": 0.8492312261793322, "num_computed": 472680, "num_roped": 472680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "mask_shape": [1, 32, 260, 15620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:46:35.475379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 5.0067901611328125e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.46938775510204084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "attention_shape": [1, 32, 260, 15620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:47:57.615362", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1492048643592142, "overlap_percentage": 0.25966625966625967, "num_intersection": 12760, "num_union": 85520, "num_only_computed": 36380, "num_only_roped": 36380, "total_diff": 72760, "diff_percentage": 0.8507951356407858, "num_computed": 49140, "num_roped": 49140}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "mask_shape": [1, 32, 27, 15647], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:48:01.677296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044189453125, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.2490234375, "l2_diff_relative": 0.2244718309859155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "attention_shape": [1, 32, 27, 15647]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:49:07.182964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16442738323736406, "overlap_percentage": 0.2824175824175824, "num_intersection": 514, "num_union": 3126, "num_only_computed": 1306, "num_only_roped": 1306, "total_diff": 2612, "diff_percentage": 0.835572616762636, "num_computed": 1820, "num_roped": 1820}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "mask_shape": [1, 32, 1, 15648], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:49:10.940397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.024169921875, "l2_diff_relative": 0.08839285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "attention_shape": [1, 32, 1, 15648]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:50:07.144963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.14573497009757633, "overlap_percentage": 0.2543956043956044, "num_intersection": 463, "num_union": 3177, "num_only_computed": 1357, "num_only_roped": 1357, "total_diff": 2714, "diff_percentage": 0.8542650299024237, "num_computed": 1820, "num_roped": 1820}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "mask_shape": [1, 32, 1, 15649], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:50:08.973447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 6.914138793945312e-05, "l2_diff": 0.095703125, "l2_diff_relative": 0.8099173553719008}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "attention_shape": [1, 32, 1, 15649]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:51:05.143313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15619047619047619, "overlap_percentage": 0.2701812191103789, "num_intersection": 492, "num_union": 3150, "num_only_computed": 1329, "num_only_roped": 1329, "total_diff": 2658, "diff_percentage": 0.8438095238095238, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "mask_shape": [1, 32, 1, 15650], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:51:06.959516", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.026611328125, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.22705314009661837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "attention_shape": [1, 32, 1, 15650]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:52:03.047338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15399239543726237, "overlap_percentage": 0.26688632619439867, "num_intersection": 486, "num_union": 3156, "num_only_computed": 1335, "num_only_roped": 1335, "total_diff": 2670, "diff_percentage": 0.8460076045627376, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "mask_shape": [1, 32, 1, 15651], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:52:04.876683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.1662621359223301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "attention_shape": [1, 32, 1, 15651]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:53:03.539844", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.15253164556962026, "overlap_percentage": 0.26468973091707854, "num_intersection": 482, "num_union": 3160, "num_only_computed": 1339, "num_only_roped": 1339, "total_diff": 2678, "diff_percentage": 0.8474683544303797, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "mask_shape": [1, 32, 1, 15652], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:53:07.002074", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.24743589743589745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "attention_shape": [1, 32, 1, 15652]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:54:03.762092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.1532615579480684, "overlap_percentage": 0.26578802855573863, "num_intersection": 484, "num_union": 3158, "num_only_computed": 1337, "num_only_roped": 1337, "total_diff": 2674, "diff_percentage": 0.8467384420519316, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "mask_shape": [1, 32, 1, 15653], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:54:05.600714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029541015625, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.05126953125, "l2_diff_relative": 0.24193548387096775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "attention_shape": [1, 32, 1, 15653]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:55:02.366804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.16098182977366912, "overlap_percentage": 0.2773201537616694, "num_intersection": 505, "num_union": 3137, "num_only_computed": 1316, "num_only_roped": 1316, "total_diff": 2632, "diff_percentage": 0.8390181702263309, "num_computed": 1821, "num_roped": 1821}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15654, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15654, 128], "mask_shape": [1, 32, 1, 15654], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:55:04.203301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.14895833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15654, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15654, 128], "attention_shape": [1, 32, 1, 15654]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
