{"timestamp": "2025-11-14T03:55:51.645014", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:55:51.689417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030764910130718953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:55:52.149200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:55:52.158731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7508864402770996e-06, "l2_diff": 0.028564453125, "l2_diff_relative": 0.00313035102739726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:01.027898", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293266163257417, "overlap_percentage": 0.9633688857675895, "num_intersection": 2875186, "num_union": 3093838, "num_only_computed": 217294, "num_only_roped": 1358, "total_diff": 218652, "diff_percentage": 0.07067338367425832, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:01.573499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.015046296296296295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:24.934607", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474445847033277, "overlap_percentage": 0.9730131395216678, "num_intersection": 3835322, "num_union": 4048070, "num_only_computed": 201286, "num_only_roped": 11462, "total_diff": 212748, "diff_percentage": 0.052555415296672243, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:25.676480", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.2314453125, "l2_diff_relative": 0.025716145833333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:52.428922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548076817563773, "overlap_percentage": 0.9768814504539813, "num_intersection": 4785625, "num_union": 5012135, "num_only_computed": 195111, "num_only_roped": 31399, "total_diff": 226510, "diff_percentage": 0.04519231824362273, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:56:53.361226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.020035282258064516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:57:26.412054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9564432381263926, "overlap_percentage": 0.9777367617803623, "num_intersection": 5724813, "num_union": 5985523, "num_only_computed": 199027, "num_only_roped": 61683, "total_diff": 260710, "diff_percentage": 0.043556761873607366, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:57:29.364690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.473592758178711e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.01677389705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:08.883017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9551691850032037, "overlap_percentage": 0.9770706211305581, "num_intersection": 6656149, "num_union": 6968555, "num_only_computed": 211819, "num_only_roped": 100587, "total_diff": 312406, "diff_percentage": 0.04483081499679632, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:11.004526", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.1591796875, "l2_diff_relative": 0.01675575657894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:57.356717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9518183290238835, "overlap_percentage": 0.9753144694566874, "num_intersection": 7576867, "num_union": 7960413, "num_only_computed": 234205, "num_only_roped": 149341, "total_diff": 383546, "diff_percentage": 0.04818167097611644, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:58:58.914028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.0712614059448242e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.01872417355371901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:59:52.048911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9471274827436084, "overlap_percentage": 0.972845888250783, "num_intersection": 8488882, "num_union": 8962766, "num_only_computed": 266318, "num_only_roped": 207566, "total_diff": 473884, "diff_percentage": 0.05287251725639161, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T03:59:54.024013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 3.4332275390625e-05, "l2_diff": 1.5234375, "l2_diff_relative": 0.20397489539748953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:00:54.233687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9412865067266835, "overlap_percentage": 0.9697553694058706, "num_intersection": 9390149, "num_union": 9975867, "num_only_computed": 309179, "num_only_roped": 276539, "total_diff": 585718, "diff_percentage": 0.05871349327331649, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:00:58.392683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 6.818771362304688e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.5512048192771084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:02:06.256174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9347823773685087, "overlap_percentage": 0.9662920112389107, "num_intersection": 10278079, "num_union": 10995157, "num_only_computed": 364353, "num_only_roped": 352725, "total_diff": 717078, "diff_percentage": 0.0652176226314913, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:02:08.573628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.2957446808510638}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:03:16.966453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8673057947552284, "overlap_percentage": 0.9289381494892401, "num_intersection": 631102, "num_union": 727658, "num_only_computed": 48278, "num_only_roped": 48278, "total_diff": 96556, "diff_percentage": 0.13269420524477157, "num_computed": 679380, "num_roped": 679380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:03:19.202048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:04:24.603666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8650171017330603, "overlap_percentage": 0.9276237745265139, "num_intersection": 272124, "num_union": 314588, "num_only_computed": 21232, "num_only_roped": 21232, "total_diff": 42464, "diff_percentage": 0.13498289826693963, "num_computed": 293356, "num_roped": 293356}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:04:26.720112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.1083984375, "l2_diff_relative": 0.08512269938650306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:05:30.911952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8622589531680441, "overlap_percentage": 0.9260355029585798, "num_intersection": 9703, "num_union": 11253, "num_only_computed": 775, "num_only_roped": 775, "total_diff": 1550, "diff_percentage": 0.13774104683195593, "num_computed": 10478, "num_roped": 10478}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:05:34.179122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.02197265625, "l2_diff_relative": 0.10180995475113122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:06:37.500564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8622711924649014, "overlap_percentage": 0.9260425613131024, "num_intersection": 9704, "num_union": 11254, "num_only_computed": 775, "num_only_roped": 775, "total_diff": 1550, "diff_percentage": 0.13772880753509864, "num_computed": 10479, "num_roped": 10479}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:06:41.130723", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0045166015625, "mean_diff": 1.4066696166992188e-05, "l2_diff": 0.0125732421875, "l2_diff_relative": 0.04951923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:07:45.327389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8652665302126902, "overlap_percentage": 0.9277671755725191, "num_intersection": 9723, "num_union": 11237, "num_only_computed": 757, "num_only_roped": 757, "total_diff": 1514, "diff_percentage": 0.13473346978730977, "num_computed": 10480, "num_roped": 10480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:07:47.360878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.060546875, "l2_diff_relative": 0.2421875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:08:51.300598", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8594748048261178, "overlap_percentage": 0.9244274809160306, "num_intersection": 9688, "num_union": 11272, "num_only_computed": 792, "num_only_roped": 792, "total_diff": 1584, "diff_percentage": 0.14052519517388218, "num_computed": 10480, "num_roped": 10480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:08:53.346874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00634765625, "mean_diff": 1.2040138244628906e-05, "l2_diff": 0.01348876953125, "l2_diff_relative": 0.055471887550200806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:09:32.495585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:09:32.509246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003127639358108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:09:32.933960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:09:32.943425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7583370208740234e-06, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.0031880040322580646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:09:41.874995", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293284871365151, "overlap_percentage": 0.9633698909570476, "num_intersection": 2875189, "num_union": 3093835, "num_only_computed": 217291, "num_only_roped": 1355, "total_diff": 218646, "diff_percentage": 0.07067151286348496, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:09:42.443417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.708766937255859e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.01471185064935065}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:10:03.343986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475052026411432, "overlap_percentage": 0.9730451054571433, "num_intersection": 3835448, "num_union": 4047944, "num_only_computed": 201160, "num_only_roped": 11336, "total_diff": 212496, "diff_percentage": 0.052494797358856746, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:10:04.081407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.453824996948242e-06, "l2_diff": 0.2421875, "l2_diff_relative": 0.027288732394366196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:10:30.792714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549578490547214, "overlap_percentage": 0.9769600398458423, "num_intersection": 4786010, "num_union": 5011750, "num_only_computed": 194726, "num_only_roped": 31014, "total_diff": 225740, "diff_percentage": 0.045042150945278595, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:10:31.720677", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.017788461538461538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:11:04.699747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9565050170967903, "overlap_percentage": 0.9777690409566386, "num_intersection": 5725002, "num_union": 5985334, "num_only_computed": 198838, "num_only_roped": 61494, "total_diff": 260332, "diff_percentage": 0.043494982903209745, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:11:05.827904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.3245811462402344e-06, "l2_diff": 0.1201171875, "l2_diff_relative": 0.01423611111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:11:45.248837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9553005006969632, "overlap_percentage": 0.9771393198707289, "num_intersection": 6656617, "num_union": 6968087, "num_only_computed": 211351, "num_only_roped": 100119, "total_diff": 311470, "diff_percentage": 0.04469949930303683, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:11:47.685818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2202730178833008e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.016898148148148148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:12:33.890163", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9522551111799114, "overlap_percentage": 0.9755437245129135, "num_intersection": 7578648, "num_union": 7958632, "num_only_computed": 232424, "num_only_roped": 147560, "total_diff": 379984, "diff_percentage": 0.04774488882008868, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:12:35.441354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.8477439880371094e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.015066964285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:28.283715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9476848789441219, "overlap_percentage": 0.9731398432973207, "num_intersection": 8491447, "num_union": 8960201, "num_only_computed": 263753, "num_only_roped": 205001, "total_diff": 468754, "diff_percentage": 0.0523151210558781, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:13:30.057216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.12166030534351145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:14:30.029938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.941315307698623, "overlap_percentage": 0.9697706539125033, "num_intersection": 9390297, "num_union": 9975719, "num_only_computed": 309031, "num_only_roped": 276391, "total_diff": 585422, "diff_percentage": 0.058684692301376976, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:14:33.027540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 2.03125, "l2_diff_relative": 0.27896995708154504}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:15:41.110774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9341751306915266, "overlap_percentage": 0.9659674719915673, "num_intersection": 10274627, "num_union": 10998609, "num_only_computed": 367805, "num_only_roped": 356177, "total_diff": 723982, "diff_percentage": 0.06582486930847346, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:15:44.950063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11767578125, "mean_diff": 5.054473876953125e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.42857142857142855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:17:01.152051", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9254987700058932, "overlap_percentage": 0.9613080874656291, "num_intersection": 11137641, "num_union": 12034204, "num_only_computed": 448919, "num_only_roped": 447644, "total_diff": 896563, "diff_percentage": 0.0745012299941068, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:17:05.629313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10595703125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.7421875, "l2_diff_relative": 0.2693236714975845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:18:29.578979", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9166021663539039, "overlap_percentage": 0.9564866224664923, "num_intersection": 11984456, "num_union": 13074872, "num_only_computed": 545208, "num_only_roped": 545208, "total_diff": 1090416, "diff_percentage": 0.08339783364609611, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:18:32.441324", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 3.981590270996094e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.32175925925925924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:20:04.693425", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9090696945880566, "overlap_percentage": 0.9523693107330141, "num_intersection": 12832026, "num_union": 14115558, "num_only_computed": 641766, "num_only_roped": 641766, "total_diff": 1283532, "diff_percentage": 0.09093030541194333, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:20:08.119749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.25, "l2_diff_relative": 0.4472049689440994}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:21:49.261874", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9029420269942627, "overlap_percentage": 0.9489958329634233, "num_intersection": 13682546, "num_union": 15153294, "num_only_computed": 735374, "num_only_roped": 735374, "total_diff": 1470748, "diff_percentage": 0.09705797300573724, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:21:52.625547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 4.863739013671875e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.4597315436241611}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:23:40.769840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8937595492650815, "overlap_percentage": 0.9438997148417562, "num_intersection": 12559809, "num_union": 14052783, "num_only_computed": 746487, "num_only_roped": 746487, "total_diff": 1492974, "diff_percentage": 0.10624045073491849, "num_computed": 13306296, "num_roped": 13306296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 894, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:23:44.322458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.291534423828125e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.45375722543352603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 894, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:25:32.624436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8604448320976886, "overlap_percentage": 0.9249882794186591, "num_intersection": 718172, "num_union": 834652, "num_only_computed": 58240, "num_only_roped": 58240, "total_diff": 116480, "diff_percentage": 0.13955516790231137, "num_computed": 776412, "num_roped": 776412}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:25:36.526542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.288818359375e-05, "l2_diff": 0.1865234375, "l2_diff_relative": 0.11478365384615384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:27:20.016362", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8564057934978554, "overlap_percentage": 0.9226493436914011, "num_intersection": 13777, "num_union": 16087, "num_only_computed": 1155, "num_only_roped": 1155, "total_diff": 2310, "diff_percentage": 0.14359420650214458, "num_computed": 14932, "num_roped": 14932}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:27:23.237397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0223388671875, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.02978515625, "l2_diff_relative": 0.16486486486486487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:29:02.825482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.848830011142751, "overlap_percentage": 0.9182347820263845, "num_intersection": 13712, "num_union": 16154, "num_only_computed": 1221, "num_only_roped": 1221, "total_diff": 2442, "diff_percentage": 0.15116998885724897, "num_computed": 14933, "num_roped": 14933}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:29:06.058682", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.032958984375, "mean_diff": 3.0517578125e-05, "l2_diff": 0.057861328125, "l2_diff_relative": 0.30076142131979694}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:30:45.897892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8552705136965029, "overlap_percentage": 0.9219900897281371, "num_intersection": 13769, "num_union": 16099, "num_only_computed": 1165, "num_only_roped": 1165, "total_diff": 2330, "diff_percentage": 0.1447294863034971, "num_computed": 14934, "num_roped": 14934}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:30:49.130938", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008056640625, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.0228271484375, "l2_diff_relative": 0.09904661016949153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:45.232092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:45.247901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.003156043046357616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:45.672872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:45.684316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8253922462463379e-06, "l2_diff": 0.0274658203125, "l2_diff_relative": 0.003116688829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:54.723046", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293322287689462, "overlap_percentage": 0.9633719013359638, "num_intersection": 2875195, "num_union": 3093829, "num_only_computed": 217285, "num_only_roped": 1349, "total_diff": 218634, "diff_percentage": 0.07066777123105382, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:31:55.290175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.015395220588235295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:32:17.348895", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474349631554635, "overlap_percentage": 0.9730080655636558, "num_intersection": 3835302, "num_union": 4048090, "num_only_computed": 201306, "num_only_roped": 11482, "total_diff": 212788, "diff_percentage": 0.05256503684453656, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:32:20.183707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.036592483520508e-06, "l2_diff": 0.2275390625, "l2_diff_relative": 0.02657390510948905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:32:48.881589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548404435629246, "overlap_percentage": 0.9768985972303873, "num_intersection": 4785709, "num_union": 5012051, "num_only_computed": 195027, "num_only_roped": 31315, "total_diff": 226342, "diff_percentage": 0.04515955643707536, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:32:49.825540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.11434268951416e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.01784206081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:33:23.422854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9567044361611329, "overlap_percentage": 0.977873222425044, "num_intersection": 5725612, "num_union": 5984724, "num_only_computed": 198228, "num_only_roped": 60884, "total_diff": 259112, "diff_percentage": 0.04329556383886709, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:33:24.573542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.016517857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:04.913587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9557523838806904, "overlap_percentage": 0.9773756552802909, "num_intersection": 6658227, "num_union": 6966477, "num_only_computed": 209741, "num_only_roped": 98509, "total_diff": 308250, "diff_percentage": 0.04424761611930966, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:06.281840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.017663043478260868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:53.027371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.951952947939814, "overlap_percentage": 0.9753851381966471, "num_intersection": 7577416, "num_union": 7959864, "num_only_computed": 233656, "num_only_roped": 148792, "total_diff": 382448, "diff_percentage": 0.04804705206018595, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:34:54.606723", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.9371509552001953e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.016417572463768116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:48.424359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9470590525735514, "overlap_percentage": 0.9728097885082257, "num_intersection": 8488567, "num_union": 8963081, "num_only_computed": 266633, "num_only_roped": 207881, "total_diff": 474514, "diff_percentage": 0.05294094742644856, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:35:50.243491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.18670886075949367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:36:50.755472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9412129513659698, "overlap_percentage": 0.9697163319497413, "num_intersection": 9389771, "num_union": 9976245, "num_only_computed": 309557, "num_only_roped": 276917, "total_diff": 586474, "diff_percentage": 0.058787048634030135, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:36:52.847560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 5.650520324707031e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.4207920792079208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:38:03.554285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9340847447564683, "overlap_percentage": 0.9659191483608793, "num_intersection": 10274113, "num_union": 10999123, "num_only_computed": 368319, "num_only_roped": 356691, "total_diff": 725010, "diff_percentage": 0.06591525524353169, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:38:06.354804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 4.792213439941406e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.3793103448275862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:39:22.365175", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.926764578758983, "overlap_percentage": 0.9619904673106522, "num_intersection": 11145547, "num_union": 12026298, "num_only_computed": 441013, "num_only_roped": 439738, "total_diff": 880751, "diff_percentage": 0.07323542124101698, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:39:24.958972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.3886138613861386}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:40:51.342488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9177429962622141, "overlap_percentage": 0.9571073893122752, "num_intersection": 11992234, "num_union": 13067094, "num_only_computed": 537430, "num_only_roped": 537430, "total_diff": 1074860, "diff_percentage": 0.08225700373778592, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:40:56.511868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:42:28.931142", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9098539011501399, "overlap_percentage": 0.9527994791666666, "num_intersection": 12837822, "num_union": 14109762, "num_only_computed": 635970, "num_only_roped": 635970, "total_diff": 1271940, "diff_percentage": 0.09014609884986012, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:42:34.257708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 4.649162292480469e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.46296296296296297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:44:15.669301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9023240002435643, "overlap_percentage": 0.9486543828790838, "num_intersection": 13677623, "num_union": 15158217, "num_only_computed": 740297, "num_only_roped": 740297, "total_diff": 1480594, "diff_percentage": 0.09767599975643573, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:44:21.077417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10693359375, "mean_diff": 4.029273986816406e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.3861111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:46:10.738380", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8913217019507295, "overlap_percentage": 0.9425384386288284, "num_intersection": 13149481, "num_union": 14752789, "num_only_computed": 801654, "num_only_roped": 801654, "total_diff": 1603308, "diff_percentage": 0.10867829804927055, "num_computed": 13951135, "num_roped": 13951135}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:46:16.526396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.5, "l2_diff_relative": 0.45714285714285713}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:48:04.488651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8448057758168523, "overlap_percentage": 0.9158750334492909, "num_intersection": 410715, "num_union": 486165, "num_only_computed": 37725, "num_only_roped": 37725, "total_diff": 75450, "diff_percentage": 0.15519422418314768, "num_computed": 448440, "num_roped": 448440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:48:08.021984", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.1328125, "l2_diff_relative": 0.10119047619047619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:49:49.225894", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8391978346456693, "overlap_percentage": 0.9125694026356278, "num_intersection": 13642, "num_union": 16256, "num_only_computed": 1307, "num_only_roped": 1307, "total_diff": 2614, "diff_percentage": 0.1608021653543307, "num_computed": 14949, "num_roped": 14949}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:49:52.448383", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.11780973451327434}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:50:48.794543", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:50:48.808237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.003043519938650307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:50:49.675179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:50:51.689569", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.780688762664795e-06, "l2_diff": 0.028564453125, "l2_diff_relative": 0.0031090561224489796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:00.699855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293316051625332, "overlap_percentage": 0.9633715662728111, "num_intersection": 2875194, "num_union": 3093830, "num_only_computed": 217286, "num_only_roped": 1350, "total_diff": 218636, "diff_percentage": 0.07066839483746683, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:01.278479", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.827976226806641e-06, "l2_diff": 0.12060546875, "l2_diff_relative": 0.016215861344537816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:22.011645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475340696521936, "overlap_percentage": 0.9730603273311793, "num_intersection": 3835508, "num_union": 4047884, "num_only_computed": 201100, "num_only_roped": 11276, "total_diff": 212376, "diff_percentage": 0.05246593034780641, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:22.735016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.2060546875, "l2_diff_relative": 0.028299356223175965}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:49.975033", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549067505792735, "overlap_percentage": 0.9769332990397805, "num_intersection": 4785879, "num_union": 5011881, "num_only_computed": 194857, "num_only_roped": 31145, "total_diff": 226002, "diff_percentage": 0.04509324942072647, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:51:50.943715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.2186508178710938e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.019339139344262294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:52:24.810775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9569235170671923, "overlap_percentage": 0.9779876512509974, "num_intersection": 5726282, "num_union": 5984054, "num_only_computed": 197558, "num_only_roped": 60214, "total_diff": 257772, "diff_percentage": 0.04307648293280776, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:52:25.958477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.3692846298217773e-06, "l2_diff": 0.11376953125, "l2_diff_relative": 0.014920594262295082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:53:08.478808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9556361654000328, "overlap_percentage": 0.9773148833178321, "num_intersection": 6657813, "num_union": 6966891, "num_only_computed": 210155, "num_only_roped": 98923, "total_diff": 309078, "diff_percentage": 0.044363834599967185, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:53:12.214760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.018078512396694214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:53:59.136735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9527100039739703, "overlap_percentage": 0.9757823763232689, "num_intersection": 7580502, "num_union": 7956778, "num_only_computed": 230570, "num_only_roped": 145706, "total_diff": 376276, "diff_percentage": 0.04728999602602963, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:54:00.690197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.9818544387817383e-06, "l2_diff": 0.1279296875, "l2_diff_relative": 0.016916322314049586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:54:54.184958", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9483520005787566, "overlap_percentage": 0.9734914433295927, "num_intersection": 8494515, "num_union": 8957133, "num_only_computed": 260685, "num_only_roped": 201933, "total_diff": 462618, "diff_percentage": 0.05164799942124338, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:54:56.007509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 2.7298927307128906e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.16422594142259414}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:55:57.424642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9427650220323978, "overlap_percentage": 0.9705394232866481, "num_intersection": 9397741, "num_union": 9968275, "num_only_computed": 301587, "num_only_roped": 268947, "total_diff": 570534, "diff_percentage": 0.05723497796760222, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:56:00.049204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1474609375, "mean_diff": 5.435943603515625e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.41005291005291006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:57:09.052840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9348371045851848, "overlap_percentage": 0.9663212498559223, "num_intersection": 10278390, "num_union": 10994846, "num_only_computed": 364042, "num_only_roped": 352414, "total_diff": 716456, "diff_percentage": 0.06516289541481526, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:57:11.400561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.3915343915343915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:58:27.685468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9252200865640308, "overlap_percentage": 0.9611577325845223, "num_intersection": 11135899, "num_union": 12035946, "num_only_computed": 450661, "num_only_roped": 449386, "total_diff": 900047, "diff_percentage": 0.07477991343596922, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:58:32.822820", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:59:56.819314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9162863241010362, "overlap_percentage": 0.9563146306237741, "num_intersection": 11982301, "num_union": 13077027, "num_only_computed": 547363, "num_only_roped": 547363, "total_diff": 1094726, "diff_percentage": 0.08371367589896389, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T04:59:59.697325", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.00543212890625e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.3333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:01:32.619562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9109331699876746, "overlap_percentage": 0.9533909236538608, "num_intersection": 12845791, "num_union": 14101793, "num_only_computed": 628001, "num_only_roped": 628001, "total_diff": 1256002, "diff_percentage": 0.08906683001232538, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:01:35.737077", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 4.267692565917969e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.3721590909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:03:17.274706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9032138196952967, "overlap_percentage": 0.9491459239612926, "num_intersection": 13684710, "num_union": 15151130, "num_only_computed": 733210, "num_only_roped": 733210, "total_diff": 1466420, "diff_percentage": 0.09678618030470335, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:03:21.665213", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.3}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:05:11.633562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8966823445507582, "overlap_percentage": 0.9455271697202869, "num_intersection": 13624014, "num_union": 15193802, "num_only_computed": 784894, "num_only_roped": 784894, "total_diff": 1569788, "diff_percentage": 0.10331765544924174, "num_computed": 14408908, "num_roped": 14408908}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:05:15.353096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 3.981590270996094e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.3816568047337278}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:07:04.462666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8502354519022481, "overlap_percentage": 0.9190564920028004, "num_intersection": 426649, "num_union": 501801, "num_only_computed": 37576, "num_only_roped": 37576, "total_diff": 75152, "diff_percentage": 0.1497645480977519, "num_computed": 464225, "num_roped": 464225}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:07:07.862112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.142578125, "l2_diff_relative": 0.10488505747126436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:08:49.853373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8449029873729597, "overlap_percentage": 0.9159321581196581, "num_intersection": 13717, "num_union": 16235, "num_only_computed": 1259, "num_only_roped": 1259, "total_diff": 2518, "diff_percentage": 0.15509701262704034, "num_computed": 14976, "num_roped": 14976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:08:53.495332", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.11039719626168225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:09:50.006224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:09:50.017780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0030174026946107784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:09:50.441239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:09:50.450865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.6987323760986328e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0030355798192771084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:09:59.489106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293528080067335, "overlap_percentage": 0.963382958420003, "num_intersection": 2875228, "num_union": 3093796, "num_only_computed": 217252, "num_only_roped": 1316, "total_diff": 218568, "diff_percentage": 0.07064719199326652, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:10:00.054791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.708766937255859e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.015423387096774193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:10:23.496913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474720066363423, "overlap_percentage": 0.973027600302002, "num_intersection": 3835379, "num_union": 4048013, "num_only_computed": 201229, "num_only_roped": 11405, "total_diff": 212634, "diff_percentage": 0.052527993363657675, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:10:24.241952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.2490234375, "l2_diff_relative": 0.024444018404907977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:10:51.128821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549699414512266, "overlap_percentage": 0.9769663678228493, "num_intersection": 4786041, "num_union": 5011719, "num_only_computed": 194695, "num_only_roped": 30983, "total_diff": 225678, "diff_percentage": 0.045030058548773386, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:10:52.066544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.0195578231292517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:11:25.412752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9568466696712007, "overlap_percentage": 0.9779475157672675, "num_intersection": 5726047, "num_union": 5984289, "num_only_computed": 197793, "num_only_roped": 60449, "total_diff": 258242, "diff_percentage": 0.0431533303287993, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:11:27.972917", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.3990869522094727e-06, "l2_diff": 0.12451171875, "l2_diff_relative": 0.014229910714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:12:07.736244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9558012334519472, "overlap_percentage": 0.9774011971195852, "num_intersection": 6658401, "num_union": 6966303, "num_only_computed": 209567, "num_only_roped": 98335, "total_diff": 307902, "diff_percentage": 0.04419876654805282, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:12:09.556422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.017294847328244274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:12:56.208775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9516253831080742, "overlap_percentage": 0.9752131647238127, "num_intersection": 7576080, "num_union": 7961200, "num_only_computed": 234992, "num_only_roped": 150128, "total_diff": 385120, "diff_percentage": 0.04837461689192584, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:12:57.733619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.9371509552001953e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.015977443609022556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:13:50.653795", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9469289398996841, "overlap_percentage": 0.9727411416961882, "num_intersection": 8487968, "num_union": 8963680, "num_only_computed": 267232, "num_only_roped": 208480, "total_diff": 475712, "diff_percentage": 0.05307106010031594, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:13:52.451550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.1584051724137931}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:14:52.703575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9408923306754242, "overlap_percentage": 0.9695461369029128, "num_intersection": 9388123, "num_union": 9977893, "num_only_computed": 311205, "num_only_roped": 278565, "total_diff": 589770, "diff_percentage": 0.05910766932457584, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:14:56.399078", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.4270833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:16:04.318201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9338190871544313, "overlap_percentage": 0.9657770919290324, "num_intersection": 10272602, "num_union": 11000634, "num_only_computed": 369830, "num_only_roped": 358202, "total_diff": 728032, "diff_percentage": 0.06618091284556872, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:16:06.641723", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11181640625, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.46467391304347827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:17:23.353035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9258338728618671, "overlap_percentage": 0.96148882404487, "num_intersection": 11139735, "num_union": 12032110, "num_only_computed": 446825, "num_only_roped": 445550, "total_diff": 892375, "diff_percentage": 0.07416612713813288, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:17:28.209507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.42819148936170215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:18:52.538669", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9171521708046311, "overlap_percentage": 0.9567859920266019, "num_intersection": 11988207, "num_union": 13071121, "num_only_computed": 541457, "num_only_roped": 541457, "total_diff": 1082914, "diff_percentage": 0.08284782919536894, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:18:55.395499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11083984375, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.3788659793814433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:20:27.693614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9095503438384552, "overlap_percentage": 0.9526330078421873, "num_intersection": 12835579, "num_union": 14112005, "num_only_computed": 638213, "num_only_roped": 638213, "total_diff": 1276426, "diff_percentage": 0.09044965616154473, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:20:31.876189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 4.291534423828125e-05, "l2_diff": 2.625, "l2_diff_relative": 0.3835616438356164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:05.625879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8569323876550647, "overlap_percentage": 0.9229548618484699, "num_intersection": 1877556, "num_union": 2191020, "num_only_computed": 156732, "num_only_roped": 156732, "total_diff": 313464, "diff_percentage": 0.14306761234493523, "num_computed": 2034288, "num_roped": 2034288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:22:08.696248", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.65234375, "l2_diff_relative": 0.22567567567567567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:23:38.417994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8496475572068475, "overlap_percentage": 0.9187129233310806, "num_intersection": 293628, "num_union": 345588, "num_only_computed": 25980, "num_only_roped": 25980, "total_diff": 51960, "diff_percentage": 0.15035244279315255, "num_computed": 319608, "num_roped": 319608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:23:41.740660", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.1591796875, "l2_diff_relative": 0.13404605263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:25:09.662140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.846900568575787, "overlap_percentage": 0.9171046703709266, "num_intersection": 12214, "num_union": 14422, "num_only_computed": 1104, "num_only_roped": 1104, "total_diff": 2208, "diff_percentage": 0.153099431424213, "num_computed": 13318, "num_roped": 13318}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:25:12.434485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013916015625, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.017578125, "l2_diff_relative": 0.05806451612903226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:02.527041", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:02.544179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0030623070987654323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:02.969165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:02.978603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8030405044555664e-06, "l2_diff": 0.0302734375, "l2_diff_relative": 0.0031658496732026144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:11.928569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.92931975671728, "overlap_percentage": 0.9633652000729097, "num_intersection": 2875175, "num_union": 3093849, "num_only_computed": 217305, "num_only_roped": 1369, "total_diff": 218674, "diff_percentage": 0.07068024328272, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:12.483898", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.678964614868164e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015301724137931034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:33.169860", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474546874309081, "overlap_percentage": 0.9730184671775804, "num_intersection": 3835343, "num_union": 4048049, "num_only_computed": 201265, "num_only_roped": 11441, "total_diff": 212706, "diff_percentage": 0.05254531256909192, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:26:33.910341", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.125999450683594e-06, "l2_diff": 0.224609375, "l2_diff_relative": 0.026041666666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:27:00.718611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9550424989718714, "overlap_percentage": 0.9770043356848912, "num_intersection": 4786227, "num_union": 5011533, "num_only_computed": 194509, "num_only_roped": 30797, "total_diff": 225306, "diff_percentage": 0.04495750102812852, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:27:01.653197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.15625, "l2_diff_relative": 0.018796992481203006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:27:34.671392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9569683202490944, "overlap_percentage": 0.9780110493840655, "num_intersection": 5726419, "num_union": 5983917, "num_only_computed": 197421, "num_only_roped": 60077, "total_diff": 257498, "diff_percentage": 0.04303167975090563, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:27:35.777362", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.4139881134033203e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.015404929577464789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:28:17.852492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9555140666591458, "overlap_percentage": 0.9772510287195963, "num_intersection": 6657378, "num_union": 6967326, "num_only_computed": 210590, "num_only_roped": 99358, "total_diff": 309948, "diff_percentage": 0.044485933340854156, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:28:20.575824", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.205371856689453e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.016927083333333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:29:06.944530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9519899775280842, "overlap_percentage": 0.9754045753182025, "num_intersection": 7577567, "num_union": 7959713, "num_only_computed": 233505, "num_only_roped": 148641, "total_diff": 382146, "diff_percentage": 0.048010022471915756, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:29:08.504499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.015412414965986394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:30:01.605276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9471963522470254, "overlap_percentage": 0.9728822171980549, "num_intersection": 8489199, "num_union": 8962449, "num_only_computed": 266001, "num_only_roped": 207249, "total_diff": 473250, "diff_percentage": 0.052803647752974664, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:30:03.397459", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.1993801652892562}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:31:04.029756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9412094488687798, "overlap_percentage": 0.9697144730232589, "num_intersection": 9389753, "num_union": 9976263, "num_only_computed": 309575, "num_only_roped": 276935, "total_diff": 586510, "diff_percentage": 0.05879055113122018, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:31:07.705446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 6.580352783203125e-05, "l2_diff": 2.96875, "l2_diff_relative": 0.5080213903743316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:32:15.881241", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9342252510473414, "overlap_percentage": 0.9659942662225907, "num_intersection": 10274912, "num_union": 10998324, "num_only_computed": 367520, "num_only_roped": 355892, "total_diff": 723412, "diff_percentage": 0.0657747489526586, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:32:18.206637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.3738738738738739}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:33:35.232280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9256330211873404, "overlap_percentage": 0.9613805029336249, "num_intersection": 11138480, "num_union": 12033365, "num_only_computed": 448080, "num_only_roped": 446805, "total_diff": 894885, "diff_percentage": 0.07436697881265963, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:33:38.570001", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 4.863739013671875e-05, "l2_diff": 2.625, "l2_diff_relative": 0.3870967741935484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:35:03.143478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9171529041590634, "overlap_percentage": 0.9567863910796012, "num_intersection": 11988212, "num_union": 13071116, "num_only_computed": 541452, "num_only_roped": 541452, "total_diff": 1082904, "diff_percentage": 0.08284709584093661, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:35:06.013494", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 4.458427429199219e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.3811881188118812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:36:38.002243", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.908923775542291, "overlap_percentage": 0.9522892293424152, "num_intersection": 12830947, "num_union": 14116637, "num_only_computed": 642845, "num_only_roped": 642845, "total_diff": 1285690, "diff_percentage": 0.09107622445770902, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:36:42.337858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.39095744680851063}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:38:16.251471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8619843346937018, "overlap_percentage": 0.9258771071621277, "num_intersection": 3123002, "num_union": 3623038, "num_only_computed": 250018, "num_only_roped": 250018, "total_diff": 500036, "diff_percentage": 0.1380156653062982, "num_computed": 3373020, "num_roped": 3373020}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:38:19.276755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.32367149758454106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:39:50.214705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8482431382173682, "overlap_percentage": 0.9178912889518414, "num_intersection": 394003, "num_union": 464493, "num_only_computed": 35245, "num_only_roped": 35245, "total_diff": 70490, "diff_percentage": 0.1517568617826318, "num_computed": 429248, "num_roped": 429248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:39:53.496050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.1650390625, "l2_diff_relative": 0.12574404761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:41:21.956707", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8569945317366927, "overlap_percentage": 0.9229909050246011, "num_intersection": 12381, "num_union": 14447, "num_only_computed": 1033, "num_only_roped": 1033, "total_diff": 2066, "diff_percentage": 0.14300546826330726, "num_computed": 13414, "num_roped": 13414}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:41:24.760038", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.23267326732673269}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:13.976160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:13.988768", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.0030137624172185433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:14.412900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:14.422522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.862645149230957e-06, "l2_diff": 0.026611328125, "l2_diff_relative": 0.002956814236111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:23.397224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293365940251249, "overlap_percentage": 0.9633742467780327, "num_intersection": 2875202, "num_union": 3093822, "num_only_computed": 217278, "num_only_roped": 1342, "total_diff": 218620, "diff_percentage": 0.0706634059748751, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:23.950825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 4.5299530029296875e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.014964788732394365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:46.893753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.947388299997011, "overlap_percentage": 0.9729834568672977, "num_intersection": 3835205, "num_union": 4048187, "num_only_computed": 201403, "num_only_roped": 11579, "total_diff": 212982, "diff_percentage": 0.052611700002988995, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:42:47.634622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.23046875, "l2_diff_relative": 0.027314814814814816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:43:14.319573", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9545873481357352, "overlap_percentage": 0.9767661179698217, "num_intersection": 4785060, "num_union": 5012700, "num_only_computed": 195676, "num_only_roped": 31964, "total_diff": 227640, "diff_percentage": 0.04541265186426477, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:43:15.255657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.019667832167832168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:43:49.008379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9571213860099752, "overlap_percentage": 0.9780909787729404, "num_intersection": 5726887, "num_union": 5983449, "num_only_computed": 196953, "num_only_roped": 59609, "total_diff": 256562, "diff_percentage": 0.042878613990024815, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:43:51.691105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.014018173758865249}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:44:31.283798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9554761770464162, "overlap_percentage": 0.9772312117753164, "num_intersection": 6657243, "num_union": 6967461, "num_only_computed": 210725, "num_only_roped": 99493, "total_diff": 310218, "diff_percentage": 0.04452382295358381, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:44:33.372082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.017563868613138685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:45:19.385077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9516425432068061, "overlap_percentage": 0.9752221753099641, "num_intersection": 7576150, "num_union": 7961130, "num_only_computed": 234922, "num_only_roped": 150058, "total_diff": 384980, "diff_percentage": 0.048357456793193934, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:45:20.943754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.8551945686340332e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.01551418439716312}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:46:14.005551", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9460982797223665, "overlap_percentage": 0.9723026730770641, "num_intersection": 8484142, "num_union": 8967506, "num_only_computed": 271058, "num_only_roped": 212306, "total_diff": 483364, "diff_percentage": 0.05390172027763349, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:46:15.806791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.719329833984375e-05, "l2_diff": 1.4375, "l2_diff_relative": 0.21904761904761905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:47:16.374760", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9406988033135556, "overlap_percentage": 0.9694433795779163, "num_intersection": 9387128, "num_union": 9978888, "num_only_computed": 312200, "num_only_roped": 279560, "total_diff": 591760, "diff_percentage": 0.05930119668644442, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:47:20.585773", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 5.53131103515625e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.3903061224489796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:28.766255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9342547968950431, "overlap_percentage": 0.9660100607166676, "num_intersection": 10275080, "num_union": 10998156, "num_only_computed": 367352, "num_only_roped": 355724, "total_diff": 723076, "diff_percentage": 0.06574520310495686, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:48:31.072377", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11767578125, "mean_diff": 4.982948303222656e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.3994708994708995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:49:48.162587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9251477892306319, "overlap_percentage": 0.9611187197221456, "num_intersection": 11135447, "num_union": 12036398, "num_only_computed": 451113, "num_only_roped": 449838, "total_diff": 900951, "diff_percentage": 0.07485221076936804, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:49:51.574850", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.38071065989847713}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:51:16.410372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9151276135104642, "overlap_percentage": 0.9556831691576086, "num_intersection": 11974389, "num_union": 13084939, "num_only_computed": 555275, "num_only_roped": 555275, "total_diff": 1110550, "diff_percentage": 0.0848723864895358, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:51:19.276916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.32840236686390534}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:52:51.826619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9084630396007944, "overlap_percentage": 0.952036293865899, "num_intersection": 12827539, "num_union": 14120045, "num_only_computed": 646253, "num_only_roped": 646253, "total_diff": 1292506, "diff_percentage": 0.09153696039920553, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:52:54.948765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.3693467336683417}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:54:36.351348", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9045803641800315, "overlap_percentage": 0.9498999162153764, "num_intersection": 13695581, "num_union": 15140259, "num_only_computed": 722339, "num_only_roped": 722339, "total_diff": 1444678, "diff_percentage": 0.09541963581996847, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:54:42.412345", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.24516908212560387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:56:26.240969", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8701787664245177, "overlap_percentage": 0.9305835164497779, "num_intersection": 5940767, "num_union": 6827065, "num_only_computed": 443149, "num_only_roped": 443149, "total_diff": 886298, "diff_percentage": 0.12982123357548228, "num_computed": 6383916, "num_roped": 6383916}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 441, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:56:29.604626", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10595703125, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.3197278911564626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 441, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:58:11.177691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8538506005866009, "overlap_percentage": 0.9211644134823194, "num_intersection": 320521, "num_union": 375383, "num_only_computed": 27431, "num_only_roped": 27431, "total_diff": 54862, "diff_percentage": 0.1461493994133991, "num_computed": 347952, "num_roped": 347952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:58:14.373568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.1298828125, "l2_diff_relative": 0.1013719512195122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:59:52.181948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8527889591719379, "overlap_percentage": 0.9205462445685909, "num_intersection": 13347, "num_union": 15651, "num_only_computed": 1152, "num_only_roped": 1152, "total_diff": 2304, "diff_percentage": 0.1472110408280621, "num_computed": 14499, "num_roped": 14499}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T05:59:55.281735", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.01458740234375, "l2_diff_relative": 0.06609513274336283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:01:31.987856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8575454778375609, "overlap_percentage": 0.9233103448275862, "num_intersection": 13388, "num_union": 15612, "num_only_computed": 1112, "num_only_roped": 1112, "total_diff": 2224, "diff_percentage": 0.14245452216243915, "num_computed": 14500, "num_roped": 14500}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:01:35.152608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0093994140625, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.023681640625, "l2_diff_relative": 0.09817813765182186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:03:12.237971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8549408378637672, "overlap_percentage": 0.921798496655403, "num_intersection": 13367, "num_union": 15635, "num_only_computed": 1134, "num_only_roped": 1134, "total_diff": 2268, "diff_percentage": 0.14505916213623282, "num_computed": 14501, "num_roped": 14501}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:03:16.267425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.017578125, "l2_diff_relative": 0.0625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:04:53.054209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8513979318268863, "overlap_percentage": 0.9197352089366984, "num_intersection": 13338, "num_union": 15666, "num_only_computed": 1164, "num_only_roped": 1164, "total_diff": 2328, "diff_percentage": 0.14860206817311375, "num_computed": 14502, "num_roped": 14502}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "mask_shape": [1, 32, 1, 15829], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:04:56.172411", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.043212890625, "l2_diff_relative": 0.18991416309012876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "attention_shape": [1, 32, 1, 15829]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:31.893218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8499904330633331, "overlap_percentage": 0.9189133282769082, "num_intersection": 13327, "num_union": 15679, "num_only_computed": 1176, "num_only_roped": 1176, "total_diff": 2352, "diff_percentage": 0.15000956693666687, "num_computed": 14503, "num_roped": 14503}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "mask_shape": [1, 32, 1, 15830], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:06:35.034636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 1.3113021850585938e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.10080645161290322}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "attention_shape": [1, 32, 1, 15830]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:26.967977", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:26.976283", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030967310855263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:27.396043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:27.405482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.817941665649414e-06, "l2_diff": 0.02783203125, "l2_diff_relative": 0.0030924479166666665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:33.595200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9587998208687863, "overlap_percentage": 0.9789666209419295, "num_intersection": 396085, "num_union": 413105, "num_only_computed": 17020, "num_only_roped": 0, "total_diff": 17020, "diff_percentage": 0.04120017913121361, "num_computed": 413105, "num_roped": 396085}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:33.990934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 7.3015689849853516e-06, "l2_diff": 0.06689453125, "l2_diff_relative": 0.020005841121495328}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:40.784301", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9946855624446412, "overlap_percentage": 0.9973357015985791, "num_intersection": 56150, "num_union": 56450, "num_only_computed": 300, "num_only_roped": 0, "total_diff": 300, "diff_percentage": 0.005314437555358724, "num_computed": 56450, "num_roped": 56150}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:40.787370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 1.7210841178894043e-06, "l2_diff": 0.00390625, "l2_diff_relative": 0.0030303030303030303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:40.927877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 2259, "num_union": 2259, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 2259, "num_roped": 2259}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:40.929845", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00048828125, "mean_diff": 1.691281795501709e-06, "l2_diff": 0.000858306884765625, "l2_diff_relative": 0.003380408653846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:41.057681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 2260, "num_union": 2260, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 2260, "num_roped": 2260}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:41.059413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.000244140625, "mean_diff": 1.2367963790893555e-06, "l2_diff": 0.0004062652587890625, "l2_diff_relative": 0.0018326679515418502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:41.187019", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 2261, "num_union": 2261, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 2261, "num_roped": 2261}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "mask_shape": [1, 32, 1, 2261], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:41.188765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00048828125, "mean_diff": 1.2367963790893555e-06, "l2_diff": 0.00077056884765625, "l2_diff_relative": 0.003603025114155251}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "attention_shape": [1, 32, 1, 2261]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:41.315683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 2262, "num_union": 2262, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 2262, "num_roped": 2262}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "mask_shape": [1, 32, 1, 2262], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:41.317413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.000244140625, "mean_diff": 1.3634562492370605e-06, "l2_diff": 0.000560760498046875, "l2_diff_relative": 0.0021750710227272725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "attention_shape": [1, 32, 1, 2262]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:44.571320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:44.583824", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031105324074074073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:45.007101", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:45.016536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7955899238586426e-06, "l2_diff": 0.027587890625, "l2_diff_relative": 0.003152901785714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:53.883610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293334759829815, "overlap_percentage": 0.9633725714622692, "num_intersection": 2875197, "num_union": 3093827, "num_only_computed": 217283, "num_only_roped": 1347, "total_diff": 218630, "diff_percentage": 0.07066652401701841, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:07:54.434634", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.014973958333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:15.062484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474224552853723, "overlap_percentage": 0.9730014694182403, "num_intersection": 3835276, "num_union": 4048116, "num_only_computed": 201332, "num_only_roped": 11508, "total_diff": 212840, "diff_percentage": 0.05257754471462774, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:15.799940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.3942203521728516e-06, "l2_diff": 0.25390625, "l2_diff_relative": 0.027636054421768707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:42.449910", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549285938754845, "overlap_percentage": 0.9769447302240513, "num_intersection": 4785935, "num_union": 5011825, "num_only_computed": 194801, "num_only_roped": 31089, "total_diff": 225890, "diff_percentage": 0.045071406124515524, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:08:43.380973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.01819620253164557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:09:16.285031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9568087387133725, "overlap_percentage": 0.9779277042093412, "num_intersection": 5725931, "num_union": 5984405, "num_only_computed": 197909, "num_only_roped": 60565, "total_diff": 258474, "diff_percentage": 0.043191261286627494, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:09:17.459105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.3096799850463867e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.01396484375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:09:57.192858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9558486816360409, "overlap_percentage": 0.9774260049979802, "num_intersection": 6658570, "num_union": 6966134, "num_only_computed": 209398, "num_only_roped": 98166, "total_diff": 307564, "diff_percentage": 0.04415131836395912, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:09:59.232123", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.3096799850463867e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.017463235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:10:45.812715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.951929161461972, "overlap_percentage": 0.9753726520986943, "num_intersection": 7577319, "num_union": 7959961, "num_only_computed": 233753, "num_only_roped": 148889, "total_diff": 382642, "diff_percentage": 0.048070838538028016, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:10:47.355667", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.0563602447509766e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.015290178571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:11:41.464894", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9470427603848466, "overlap_percentage": 0.9728011933314263, "num_intersection": 8488492, "num_union": 8963156, "num_only_computed": 266708, "num_only_roped": 207956, "total_diff": 474664, "diff_percentage": 0.05295723961515341, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:11:43.271751", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 3.0159950256347656e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.16322314049586778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:12:44.825973", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9415644328467997, "overlap_percentage": 0.969902844240137, "num_intersection": 9391577, "num_union": 9974439, "num_only_computed": 307751, "num_only_roped": 275111, "total_diff": 582862, "diff_percentage": 0.058435567153200293, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:12:46.958013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.4860335195530726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:13:56.356765", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.934833409080801, "overlap_percentage": 0.9663192755441626, "num_intersection": 10278369, "num_union": 10994867, "num_only_computed": 364063, "num_only_roped": 352435, "total_diff": 716498, "diff_percentage": 0.06516659091919894, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:13:58.689280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 5.435943603515625e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.41284403669724773}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:15:14.166151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9152982510427732, "overlap_percentage": 0.9557762093130344, "num_intersection": 9122277, "num_union": 9966453, "num_only_computed": 422088, "num_only_roped": 422088, "total_diff": 844176, "diff_percentage": 0.0847017489572268, "num_computed": 9544365, "num_roped": 9544365}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 855, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:15:18.787807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.96875, "l2_diff_relative": 0.6089743589743589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 855, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:16:33.317248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8645857125712804, "overlap_percentage": 0.9273756703616579, "num_intersection": 446664, "num_union": 516622, "num_only_computed": 34979, "num_only_roped": 34979, "total_diff": 69958, "diff_percentage": 0.13541428742871964, "num_computed": 481643, "num_roped": 481643}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:16:35.731680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.375, "l2_diff_relative": 0.26666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:17:45.794952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.853715042197584, "overlap_percentage": 0.921085520442778, "num_intersection": 10318, "num_union": 12086, "num_only_computed": 884, "num_only_roped": 884, "total_diff": 1768, "diff_percentage": 0.14628495780241602, "num_computed": 11202, "num_roped": 11202}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:17:50.105007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.072265625, "l2_diff_relative": 0.44047619047619047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:18:58.939634", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8592647913036262, "overlap_percentage": 0.9243059894671071, "num_intersection": 10355, "num_union": 12051, "num_only_computed": 848, "num_only_roped": 848, "total_diff": 1696, "diff_percentage": 0.14073520869637374, "num_computed": 11203, "num_roped": 11203}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:19:01.149158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.06591796875, "l2_diff_relative": 0.3409090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:10.729251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8569652772022872, "overlap_percentage": 0.9229739378793288, "num_intersection": 10341, "num_union": 12067, "num_only_computed": 863, "num_only_roped": 863, "total_diff": 1726, "diff_percentage": 0.14303472279771276, "num_computed": 11204, "num_roped": 11204}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:13.029298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010009765625, "mean_diff": 1.2636184692382812e-05, "l2_diff": 0.01953125, "l2_diff_relative": 0.06289308176100629}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:51.144539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:51.154000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.002972146739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:51.574133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:20:51.584517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8402934074401855e-06, "l2_diff": 0.0283203125, "l2_diff_relative": 0.003125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:21:00.420955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.929334099590604, "overlap_percentage": 0.963372906525422, "num_intersection": 2875198, "num_union": 3093826, "num_only_computed": 217282, "num_only_roped": 1346, "total_diff": 218628, "diff_percentage": 0.070665900409396, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:21:03.363340", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.738569259643555e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.01574160447761194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:21:24.139623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474373685335165, "overlap_percentage": 0.9730093340531588, "num_intersection": 3835307, "num_union": 4048085, "num_only_computed": 201301, "num_only_roped": 11477, "total_diff": 212778, "diff_percentage": 0.05256263146648354, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:21:24.876355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.947185516357422e-06, "l2_diff": 0.220703125, "l2_diff_relative": 0.024694055944055944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:21:51.521098", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9550971157121383, "overlap_percentage": 0.977032913645568, "num_intersection": 4786367, "num_union": 5011393, "num_only_computed": 194369, "num_only_roped": 30657, "total_diff": 225026, "diff_percentage": 0.044902884287861676, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:21:52.457178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.1739473342895508e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.01767241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:22:25.266330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9572535389588412, "overlap_percentage": 0.9781599776470974, "num_intersection": 5727291, "num_union": 5983045, "num_only_computed": 196549, "num_only_roped": 59205, "total_diff": 255754, "diff_percentage": 0.042746461041158805, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:22:27.937587", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.014018173758865249}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:23:07.473179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9564317241470418, "overlap_percentage": 0.9777307455633532, "num_intersection": 6660646, "num_union": 6964058, "num_only_computed": 207322, "num_only_roped": 96090, "total_diff": 303412, "diff_percentage": 0.043568275852958145, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:23:10.344033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.175569534301758e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.016629464285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:23:56.775522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9530651835856987, "overlap_percentage": 0.9759686380112864, "num_intersection": 7581949, "num_union": 7955331, "num_only_computed": 229123, "num_only_roped": 144259, "total_diff": 373382, "diff_percentage": 0.046934816414301306, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:23:58.316872", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9371509552001953e-06, "l2_diff": 0.1220703125, "l2_diff_relative": 0.01600922131147541}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:24:48.325685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9232355250019929, "overlap_percentage": 0.9600857648477934, "num_intersection": 4099836, "num_union": 4440726, "num_only_computed": 170445, "num_only_roped": 170445, "total_diff": 340890, "diff_percentage": 0.07676447499800708, "num_computed": 4270281, "num_roped": 4270281}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 527, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:24:49.933318", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.515625, "l2_diff_relative": 0.09428571428571429}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 527, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:25:39.673305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8770682437371254, "overlap_percentage": 0.9345086377796659, "num_intersection": 250781, "num_union": 285931, "num_only_computed": 17575, "num_only_roped": 17575, "total_diff": 35150, "diff_percentage": 0.12293175626287461, "num_computed": 268356, "num_roped": 268356}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:25:43.043347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.0849609375, "l2_diff_relative": 0.06397058823529411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:26:31.190120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.873963133640553, "overlap_percentage": 0.9327431452108693, "num_intersection": 7586, "num_union": 8680, "num_only_computed": 547, "num_only_roped": 547, "total_diff": 1094, "diff_percentage": 0.126036866359447, "num_computed": 8133, "num_roped": 8133}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:26:32.734115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 1.6927719116210938e-05, "l2_diff": 0.00872802734375, "l2_diff_relative": 0.03919956140350877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:27:20.376727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8776546629732225, "overlap_percentage": 0.9348414064420949, "num_intersection": 7604, "num_union": 8664, "num_only_computed": 530, "num_only_roped": 530, "total_diff": 1060, "diff_percentage": 0.12234533702677747, "num_computed": 8134, "num_roped": 8134}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:27:21.937972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.0086669921875, "l2_diff_relative": 0.040340909090909094}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:09.386557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8735605711653616, "overlap_percentage": 0.9325138291333743, "num_intersection": 7586, "num_union": 8684, "num_only_computed": 549, "num_only_roped": 549, "total_diff": 1098, "diff_percentage": 0.1264394288346384, "num_computed": 8135, "num_roped": 8135}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:10.915834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 1.1742115020751953e-05, "l2_diff": 0.00750732421875, "l2_diff_relative": 0.024798387096774194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:39.733082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:39.748965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030565137987012985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:40.171671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:42.888790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8700957298278809e-06, "l2_diff": 0.0272216796875, "l2_diff_relative": 0.003202550551470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:51.894583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293253691205751, "overlap_percentage": 0.963368215641284, "num_intersection": 2875184, "num_union": 3093840, "num_only_computed": 217296, "num_only_roped": 1360, "total_diff": 218656, "diff_percentage": 0.07067463087942492, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:28:52.462226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.470348358154297e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.015165441176470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:29:13.173831", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474287092003341, "overlap_percentage": 0.9730047674909481, "num_intersection": 3835289, "num_union": 4048103, "num_only_computed": 201319, "num_only_roped": 11495, "total_diff": 212814, "diff_percentage": 0.052571290799665917, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:29:13.917290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.208984375, "l2_diff_relative": 0.02476851851851852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:29:40.874247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547234421531932, "overlap_percentage": 0.976837358743223, "num_intersection": 4785409, "num_union": 5012351, "num_only_computed": 195327, "num_only_roped": 31615, "total_diff": 226942, "diff_percentage": 0.04527655784680682, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:29:41.822371", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.069639205932617e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.018218623481781375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:15.460007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9564661187716285, "overlap_percentage": 0.977748717030835, "num_intersection": 5724883, "num_union": 5985453, "num_only_computed": 198957, "num_only_roped": 61613, "total_diff": 260570, "diff_percentage": 0.04353388122837152, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:16.613403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.250075340270996e-06, "l2_diff": 0.1103515625, "l2_diff_relative": 0.01337594696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:56.484706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9555755351539742, "overlap_percentage": 0.977283176206984, "num_intersection": 6657597, "num_union": 6967107, "num_only_computed": 210371, "num_only_roped": 99139, "total_diff": 309510, "diff_percentage": 0.04442446484602576, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:30:57.810912", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.339482307434082e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.018033596837944664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:31:44.389325", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9517271223880559, "overlap_percentage": 0.9752665846274251, "num_intersection": 7576495, "num_union": 7960785, "num_only_computed": 234577, "num_only_roped": 149713, "total_diff": 384290, "diff_percentage": 0.04827287761194405, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:31:45.929021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.9818544387817383e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.016629464285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:32:39.326675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9468579174469631, "overlap_percentage": 0.972703666725343, "num_intersection": 8487641, "num_union": 8964007, "num_only_computed": 267559, "num_only_roped": 208807, "total_diff": 476366, "diff_percentage": 0.053142082553036825, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:32:41.129823", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.13353413654618473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:33:41.911277", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9407165011974891, "overlap_percentage": 0.9694527774840215, "num_intersection": 9387219, "num_union": 9978797, "num_only_computed": 312109, "num_only_roped": 279469, "total_diff": 591578, "diff_percentage": 0.059283498802510964, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:33:44.004386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.482269287109375e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.3130841121495327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:34:54.780320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9336310084328755, "overlap_percentage": 0.9656764960441373, "num_intersection": 10271532, "num_union": 11001704, "num_only_computed": 370900, "num_only_roped": 359272, "total_diff": 730172, "diff_percentage": 0.06636899156712452, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:34:59.375448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.24361702127659574}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:36:16.779329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9257500061914956, "overlap_percentage": 0.9614435967442385, "num_intersection": 11139211, "num_union": 12032634, "num_only_computed": 447349, "num_only_roped": 446074, "total_diff": 893423, "diff_percentage": 0.07424999380850444, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:36:19.397156", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 4.7206878662109375e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.37371134020618557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:37:43.836304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9166449706223833, "overlap_percentage": 0.9565099271616542, "num_intersection": 11984748, "num_union": 13074580, "num_only_computed": 544916, "num_only_roped": 544916, "total_diff": 1089832, "diff_percentage": 0.08335502937761671, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:37:49.416651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.696846008300781e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.3918918918918919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:39:21.979770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9082001899165769, "overlap_percentage": 0.9518919395519836, "num_intersection": 12825594, "num_union": 14121990, "num_only_computed": 648198, "num_only_roped": 648198, "total_diff": 1296396, "diff_percentage": 0.09179981008342308, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:39:26.079208", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11669921875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.39896373056994816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:41:07.381165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9021303767341963, "overlap_percentage": 0.94854736328125, "num_intersection": 13676080, "num_union": 15159760, "num_only_computed": 741840, "num_only_roped": 741840, "total_diff": 1483680, "diff_percentage": 0.09786962326580367, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:41:10.740382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1103515625, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.30213270142180093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:42:59.308729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8894026441213078, "overlap_percentage": 0.9414643796425262, "num_intersection": 12187890, "num_union": 13703456, "num_only_computed": 757783, "num_only_roped": 757783, "total_diff": 1515566, "diff_percentage": 0.11059735587869221, "num_computed": 12945673, "num_roped": 12945673}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 871, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:43:02.879440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.00543212890625e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.42894736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 871, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:44:52.313948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8462570524915005, "overlap_percentage": 0.9167272253335335, "num_intersection": 464227, "num_union": 548565, "num_only_computed": 42169, "num_only_roped": 42169, "total_diff": 84338, "diff_percentage": 0.15374294750849946, "num_computed": 506396, "num_roped": 506396}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:44:55.733487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.255859375, "l2_diff_relative": 0.19040697674418605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:46:38.714088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8445820433436533, "overlap_percentage": 0.9157435381000336, "num_intersection": 13640, "num_union": 16150, "num_only_computed": 1255, "num_only_roped": 1255, "total_diff": 2510, "diff_percentage": 0.15541795665634675, "num_computed": 14895, "num_roped": 14895}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:46:41.954302", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.024169921875, "l2_diff_relative": 0.09304511278195489}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:48:21.895433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8408304498269896, "overlap_percentage": 0.9135338345864662, "num_intersection": 13608, "num_union": 16184, "num_only_computed": 1288, "num_only_roped": 1288, "total_diff": 2576, "diff_percentage": 0.15916955017301038, "num_computed": 14896, "num_roped": 14896}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:48:26.398898", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.01904296875, "l2_diff_relative": 0.09948979591836735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:50:08.206198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.847231694463389, "overlap_percentage": 0.9172987849902665, "num_intersection": 13665, "num_union": 16129, "num_only_computed": 1232, "num_only_roped": 1232, "total_diff": 2464, "diff_percentage": 0.15276830553661108, "num_computed": 14897, "num_roped": 14897}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:50:11.503580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 1.4841556549072266e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.12045454545454545}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:51:53.437863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8439259855189059, "overlap_percentage": 0.9153577661431065, "num_intersection": 13637, "num_union": 16159, "num_only_computed": 1261, "num_only_roped": 1261, "total_diff": 2522, "diff_percentage": 0.15607401448109412, "num_computed": 14898, "num_roped": 14898}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:51:59.187953", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.5735626220703125e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.16260162601626016}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:53:40.316492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8416563658838072, "overlap_percentage": 0.914021075239949, "num_intersection": 13618, "num_union": 16180, "num_only_computed": 1281, "num_only_roped": 1281, "total_diff": 2562, "diff_percentage": 0.15834363411619284, "num_computed": 14899, "num_roped": 14899}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:53:43.607068", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.753734588623047e-05, "l2_diff": 0.0247802734375, "l2_diff_relative": 0.12880710659898478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:55:25.624718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8426813431451363, "overlap_percentage": 0.914625142627022, "num_intersection": 13627, "num_union": 16171, "num_only_computed": 1272, "num_only_roped": 1272, "total_diff": 2544, "diff_percentage": 0.15731865685486365, "num_computed": 14899, "num_roped": 14899}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:55:28.980834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00750732421875, "mean_diff": 2.9206275939941406e-05, "l2_diff": 0.0244140625, "l2_diff_relative": 0.1366120218579235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:57:11.119347", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.845429774585088, "overlap_percentage": 0.916241610738255, "num_intersection": 13652, "num_union": 16148, "num_only_computed": 1248, "num_only_roped": 1248, "total_diff": 2496, "diff_percentage": 0.15457022541491205, "num_computed": 14900, "num_roped": 14900}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:57:15.679905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.3768672943115234e-05, "l2_diff": 0.0244140625, "l2_diff_relative": 0.0946969696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:12.832574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:12.845239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0029829545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:13.269787", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:13.279233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.817941665649414e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.003104304635761589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:22.323070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293334759829815, "overlap_percentage": 0.9633725714622692, "num_intersection": 2875197, "num_union": 3093827, "num_only_computed": 217283, "num_only_roped": 1347, "total_diff": 218630, "diff_percentage": 0.07066652401701841, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:22.887151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.4405460357666016e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.013709677419354839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:46.316117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474253417026711, "overlap_percentage": 0.9730029916056439, "num_intersection": 3835282, "num_union": 4048110, "num_only_computed": 201326, "num_only_roped": 11502, "total_diff": 212828, "diff_percentage": 0.05257465829732888, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:58:47.062891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.2197265625, "l2_diff_relative": 0.02475792253521127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:59:14.066894", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549192324030512, "overlap_percentage": 0.9769398311450781, "num_intersection": 4785911, "num_union": 5011849, "num_only_computed": 194825, "num_only_roped": 31113, "total_diff": 225938, "diff_percentage": 0.04508076759694875, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:59:15.005741", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.017872431506849314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:59:48.463071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9569274413515145, "overlap_percentage": 0.977989700722507, "num_intersection": 5726294, "num_union": 5984042, "num_only_computed": 197546, "num_only_roped": 60202, "total_diff": 257748, "diff_percentage": 0.04307255864848542, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T06:59:51.283832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.4437904357910156e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.016254194630872482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:00:31.471052", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9554843161727306, "overlap_percentage": 0.9772354687485321, "num_intersection": 6657272, "num_union": 6967432, "num_only_computed": 210696, "num_only_roped": 99464, "total_diff": 310160, "diff_percentage": 0.0445156838272695, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:00:33.216999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.3245811462402344e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01840415019762846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:01:21.395999", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9517033414136775, "overlap_percentage": 0.9752540985294723, "num_intersection": 7576398, "num_union": 7960882, "num_only_computed": 234674, "num_only_roped": 149810, "total_diff": 384484, "diff_percentage": 0.04829665858632247, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:01:23.016670", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.952052116394043e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.016581632653061226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:02:17.903077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9467612744203439, "overlap_percentage": 0.9726526686763336, "num_intersection": 8487196, "num_union": 8964452, "num_only_computed": 268004, "num_only_roped": 209252, "total_diff": 477256, "diff_percentage": 0.05323872557965618, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:02:19.716976", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.4140625, "l2_diff_relative": 0.19846491228070176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:03:22.885032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9414098898742516, "overlap_percentage": 0.9698208449275266, "num_intersection": 9390783, "num_union": 9975233, "num_only_computed": 308545, "num_only_roped": 275905, "total_diff": 584450, "diff_percentage": 0.05859011012574844, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:03:24.973269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 6.580352783203125e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.4793814432989691}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:04:33.487036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9349367125450689, "overlap_percentage": 0.9663744622585864, "num_intersection": 10278956, "num_union": 10994280, "num_only_computed": 363476, "num_only_roped": 351848, "total_diff": 715324, "diff_percentage": 0.0650632874549311, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:04:35.874555", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.42018779342723006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:05:53.577465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9272371616260994, "overlap_percentage": 0.9622450003441677, "num_intersection": 11148496, "num_union": 12023349, "num_only_computed": 438064, "num_only_roped": 436789, "total_diff": 874853, "diff_percentage": 0.07276283837390064, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:05:56.188458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.39858490566037735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:07:21.413543", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.918952043367335, "overlap_percentage": 0.9577644699809987, "num_intersection": 12000467, "num_union": 13058861, "num_only_computed": 529197, "num_only_roped": 529197, "total_diff": 1058394, "diff_percentage": 0.08104795663266498, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:07:24.292089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 4.7206878662109375e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.38950276243093923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:08:57.964840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9103650102612458, "overlap_percentage": 0.9530796527065284, "num_intersection": 12841597, "num_union": 14105987, "num_only_computed": 632195, "num_only_roped": 632195, "total_diff": 1264390, "diff_percentage": 0.0896349897387542, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:09:01.180990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.696846008300781e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.4205128205128205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:10:42.774070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9021360230057095, "overlap_percentage": 0.9485504843971946, "num_intersection": 13676125, "num_union": 15159715, "num_only_computed": 741795, "num_only_roped": 741795, "total_diff": 1483590, "diff_percentage": 0.09786397699429046, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:10:46.441909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12451171875, "mean_diff": 4.57763671875e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.44054054054054054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:12:31.412309", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8692547584011509, "overlap_percentage": 0.9300548836314421, "num_intersection": 6728895, "num_union": 7740993, "num_only_computed": 506049, "num_only_roped": 506049, "total_diff": 1012098, "diff_percentage": 0.13074524159884915, "num_computed": 7234944, "num_roped": 7234944}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 498, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:12:34.818704", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 4.172325134277344e-05, "l2_diff": 1.5625, "l2_diff_relative": 0.3424657534246575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 498, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:14:17.387198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8448717261019462, "overlap_percentage": 0.9159137886373128, "num_intersection": 346514, "num_union": 410138, "num_only_computed": 31812, "num_only_roped": 31812, "total_diff": 63624, "diff_percentage": 0.15512827389805384, "num_computed": 378326, "num_roped": 378326}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:14:20.645969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.1337890625, "l2_diff_relative": 0.11570945945945946}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:15:59.045506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8424917700683717, "overlap_percentage": 0.9145134689389774, "num_intersection": 13308, "num_union": 15796, "num_only_computed": 1244, "num_only_roped": 1244, "total_diff": 2488, "diff_percentage": 0.15750822993162827, "num_computed": 14552, "num_roped": 14552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:16:02.177682", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.026611328125, "l2_diff_relative": 0.12733644859813084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:17:40.053362", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8426183844011143, "overlap_percentage": 0.9145880574452003, "num_intersection": 13310, "num_union": 15796, "num_only_computed": 1243, "num_only_roped": 1243, "total_diff": 2486, "diff_percentage": 0.1573816155988858, "num_computed": 14553, "num_roped": 14553}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 1, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:17:45.021244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.1597222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 1, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:18:41.532585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:18:41.545268", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.002877058383233533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:18:41.969421", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:18:41.978873", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8477439880371094e-06, "l2_diff": 0.02783203125, "l2_diff_relative": 0.0030711206896551725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:18:50.928952", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293297343457129, "overlap_percentage": 0.963370561083353, "num_intersection": 2875191, "num_union": 3093833, "num_only_computed": 217289, "num_only_roped": 1353, "total_diff": 218642, "diff_percentage": 0.07067026565428709, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:18:51.481294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.014930555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:19:12.064547", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475456166962296, "overlap_percentage": 0.9730664160807937, "num_intersection": 3835532, "num_union": 4047860, "num_only_computed": 201076, "num_only_roped": 11252, "total_diff": 212328, "diff_percentage": 0.052454383303770384, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:19:12.808651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.2080078125, "l2_diff_relative": 0.024652777777777777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:19:39.769262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9551318379407835, "overlap_percentage": 0.9770510810634268, "num_intersection": 4786456, "num_union": 5011304, "num_only_computed": 194280, "num_only_roped": 30568, "total_diff": 224848, "diff_percentage": 0.044868162059216524, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:19:40.699443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.11434268951416e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.017423561151079136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:20:13.743868", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9573320541117419, "overlap_percentage": 0.9782009670772897, "num_intersection": 5727531, "num_union": 5982805, "num_only_computed": 196309, "num_only_roped": 58965, "total_diff": 255274, "diff_percentage": 0.0426679458882581, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:20:14.873155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.384185791015625e-06, "l2_diff": 0.12255859375, "l2_diff_relative": 0.01474389097744361}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:20:56.594926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9564651557114443, "overlap_percentage": 0.9777482138327556, "num_intersection": 6660765, "num_union": 6963939, "num_only_computed": 207203, "num_only_roped": 95971, "total_diff": 303174, "diff_percentage": 0.043534844288555655, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:21:00.146724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.250075340270996e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.017045454545454544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:21:46.145575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9525266964288519, "overlap_percentage": 0.9756862204967665, "num_intersection": 7579755, "num_union": 7957525, "num_only_computed": 231317, "num_only_roped": 146453, "total_diff": 377770, "diff_percentage": 0.04747330357114806, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:21:47.697296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.8775463104248047e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.014895833333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:22:40.620192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9472061290698344, "overlap_percentage": 0.9728873743041345, "num_intersection": 8489244, "num_union": 8962404, "num_only_computed": 265956, "num_only_roped": 207204, "total_diff": 473160, "diff_percentage": 0.05279387093016561, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:22:42.433452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.14418604651162792}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:23:43.075894", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9407262254469424, "overlap_percentage": 0.9694579411686947, "num_intersection": 9387269, "num_union": 9978747, "num_only_computed": 312059, "num_only_roped": 279419, "total_diff": 591478, "diff_percentage": 0.059273774553057615, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:23:45.166092", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.2650462962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:24:54.633197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9346586806307101, "overlap_percentage": 0.9662259188023863, "num_intersection": 10277376, "num_union": 10995860, "num_only_computed": 365056, "num_only_roped": 353428, "total_diff": 718484, "diff_percentage": 0.0653413193692899, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:24:58.124627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.45675675675675675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:26:14.199545", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9272640909256876, "overlap_percentage": 0.9622595007000954, "num_intersection": 11148664, "num_union": 12023181, "num_only_computed": 437896, "num_only_roped": 436621, "total_diff": 874517, "diff_percentage": 0.07273590907431236, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:26:16.797181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 5.030632019042969e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.4034653465346535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:27:43.148246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9168779355849017, "overlap_percentage": 0.9566367462048464, "num_intersection": 11986337, "num_union": 13072991, "num_only_computed": 543327, "num_only_roped": 543327, "total_diff": 1086654, "diff_percentage": 0.08312206441509827, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:27:48.201035", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.29296875, "mean_diff": 5.412101745605469e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.47043010752688175}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:29:20.361864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909484854160028, "overlap_percentage": 0.95259708625456, "num_intersection": 12835095, "num_union": 14112489, "num_only_computed": 638697, "num_only_roped": 638697, "total_diff": 1277394, "diff_percentage": 0.09051514583997196, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:29:23.539284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 4.291534423828125e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.38563829787234044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:31:04.329534", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9027335879739391, "overlap_percentage": 0.9488806984641335, "num_intersection": 13680886, "num_union": 15154954, "num_only_computed": 737034, "num_only_roped": 737034, "total_diff": 1474068, "diff_percentage": 0.09726641202606091, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:31:07.688787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 4.0531158447265625e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.3894230769230769}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:32:49.739030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8519812867774473, "overlap_percentage": 0.9200754811728613, "num_intersection": 1172627, "num_union": 1376353, "num_only_computed": 101863, "num_only_roped": 101863, "total_diff": 203726, "diff_percentage": 0.14801871322255264, "num_computed": 1274490, "num_roped": 1274490}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:32:52.938134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 4.57763671875e-05, "l2_diff": 0.64453125, "l2_diff_relative": 0.3101503759398496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:34:29.425239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8484990875029258, "overlap_percentage": 0.9180411212960178, "num_intersection": 482135, "num_union": 568221, "num_only_computed": 43043, "num_only_roped": 43043, "total_diff": 86086, "diff_percentage": 0.1515009124970742, "num_computed": 525178, "num_roped": 525178}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:34:33.032777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.2197265625, "l2_diff_relative": 0.17468944099378883}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:36:08.574576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8463839750260146, "overlap_percentage": 0.9168016907361747, "num_intersection": 13014, "num_union": 15376, "num_only_computed": 1181, "num_only_roped": 1181, "total_diff": 2362, "diff_percentage": 0.15361602497398544, "num_computed": 14195, "num_roped": 14195}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:36:11.751654", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.24519230769230768}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:37:44.707165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8473550653913723, "overlap_percentage": 0.9173710904480136, "num_intersection": 13023, "num_union": 15369, "num_only_computed": 1173, "num_only_roped": 1173, "total_diff": 2346, "diff_percentage": 0.15264493460862777, "num_computed": 14196, "num_roped": 14196}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:37:48.852233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.0302734375, "l2_diff_relative": 0.13304721030042918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:39:22.469744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.845923807047198, "overlap_percentage": 0.9165316616186518, "num_intersection": 13012, "num_union": 15382, "num_only_computed": 1185, "num_only_roped": 1185, "total_diff": 2370, "diff_percentage": 0.15407619295280198, "num_computed": 14197, "num_roped": 14197}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:39:27.487478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.0279541015625, "l2_diff_relative": 0.0993923611111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:18.448191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:18.458673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.029052734375, "l2_diff_relative": 0.0030784354304635763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:18.880998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:18.890442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8924474716186523e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.0031012457770270272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:27.865600", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293253691205751, "overlap_percentage": 0.963368215641284, "num_intersection": 2875184, "num_union": 3093840, "num_only_computed": 217296, "num_only_roped": 1360, "total_diff": 218656, "diff_percentage": 0.07067463087942492, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:28.431114", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.410743713378906e-06, "l2_diff": 0.1220703125, "l2_diff_relative": 0.014361213235294117}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:49.196855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.947469601172722, "overlap_percentage": 0.973026331812499, "num_intersection": 3835374, "num_union": 4048018, "num_only_computed": 201234, "num_only_roped": 11410, "total_diff": 212644, "diff_percentage": 0.05253039882727794, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:40:51.766844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.2275390625, "l2_diff_relative": 0.023951480263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:41:19.574028", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547214922483559, "overlap_percentage": 0.9768363381017702, "num_intersection": 4785404, "num_union": 5012356, "num_only_computed": 195332, "num_only_roped": 31620, "total_diff": 226952, "diff_percentage": 0.04527850775164414, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:41:20.506661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.084540367126465e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.01840277777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:41:53.620027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9568519016428562, "overlap_percentage": 0.977950248395947, "num_intersection": 5726063, "num_union": 5984273, "num_only_computed": 197777, "num_only_roped": 60433, "total_diff": 258210, "diff_percentage": 0.0431480983571438, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:41:54.752803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.1220703125, "l2_diff_relative": 0.013950892857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:42:35.639923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9557551912612232, "overlap_percentage": 0.9773771232020894, "num_intersection": 6658237, "num_union": 6966467, "num_only_computed": 209731, "num_only_roped": 98499, "total_diff": 308230, "diff_percentage": 0.04424480873877677, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:42:36.978566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.2202730178833008e-06, "l2_diff": 0.1572265625, "l2_diff_relative": 0.016997466216216218}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:43:23.570766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9523824303575483, "overlap_percentage": 0.9756105315730939, "num_intersection": 7579167, "num_union": 7958113, "num_only_computed": 231905, "num_only_roped": 147041, "total_diff": 378946, "diff_percentage": 0.047617569642451674, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:43:26.841935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.0265579223632812e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.016898148148148148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:44:20.553409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9481982263581399, "overlap_percentage": 0.9734104194629641, "num_intersection": 8493808, "num_union": 8957840, "num_only_computed": 261392, "num_only_roped": 202640, "total_diff": 464032, "diff_percentage": 0.05180177364186009, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:44:22.745132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.8046875, "l2_diff_relative": 0.11051502145922747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:45:23.128459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9415698831740541, "overlap_percentage": 0.9699057359035539, "num_intersection": 9391605, "num_union": 9974411, "num_only_computed": 307723, "num_only_roped": 275083, "total_diff": 582806, "diff_percentage": 0.05843011682594591, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:45:25.228122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 5.078315734863281e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.3767772511848341}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:46:26.514622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8692549144402818, "overlap_percentage": 0.9300549729468719, "num_intersection": 300471, "num_union": 345665, "num_only_computed": 22597, "num_only_roped": 22597, "total_diff": 45194, "diff_percentage": 0.13074508555971823, "num_computed": 323068, "num_roped": 323068}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "mask_shape": [1, 32, 34, 10274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:46:28.714117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.189453125, "l2_diff_relative": 0.12004950495049505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "attention_shape": [1, 32, 34, 10274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:47:27.180976", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8658178256611165, "overlap_percentage": 0.9280839895013123, "num_intersection": 221000, "num_union": 255250, "num_only_computed": 17125, "num_only_roped": 17125, "total_diff": 34250, "diff_percentage": 0.13418217433888344, "num_computed": 238125, "num_roped": 238125}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 25, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:47:29.055787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.16015625, "l2_diff_relative": 0.14855072463768115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 25, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:48:26.822043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8660137120470127, "overlap_percentage": 0.9281965148015956, "num_intersection": 8842, "num_union": 10210, "num_only_computed": 684, "num_only_roped": 684, "total_diff": 1368, "diff_percentage": 0.13398628795298725, "num_computed": 9526, "num_roped": 9526}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "mask_shape": [1, 32, 1, 10300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:48:28.644200", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.2064516129032258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "attention_shape": [1, 32, 1, 10300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:49:26.319658", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8629118998728855, "overlap_percentage": 0.9264119252571908, "num_intersection": 8825, "num_union": 10227, "num_only_computed": 701, "num_only_roped": 701, "total_diff": 1402, "diff_percentage": 0.1370881001271145, "num_computed": 9526, "num_roped": 9526}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "mask_shape": [1, 32, 1, 10301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:49:29.815220", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010986328125, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.0267333984375, "l2_diff_relative": 0.15642857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "attention_shape": [1, 32, 1, 10301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:50:26.785577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8660268338066791, "overlap_percentage": 0.9282040516426997, "num_intersection": 8843, "num_union": 10211, "num_only_computed": 684, "num_only_roped": 684, "total_diff": 1368, "diff_percentage": 0.13397316619332092, "num_computed": 9527, "num_roped": 9527}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "mask_shape": [1, 32, 1, 10302], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:50:28.629468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.12046370967741936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "attention_shape": [1, 32, 1, 10302]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:02.508805", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:02.522432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.032470703125, "l2_diff_relative": 0.00326749213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:02.945513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:02.956878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8998980522155762e-06, "l2_diff": 0.025146484375, "l2_diff_relative": 0.003155637254901961}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:14.695039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293291107409124, "overlap_percentage": 0.9633702260202003, "num_intersection": 2875190, "num_union": 3093834, "num_only_computed": 217290, "num_only_roped": 1354, "total_diff": 218644, "diff_percentage": 0.07067088925908759, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:15.252361", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.014935661764705883}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:35.998877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9473887810490921, "overlap_percentage": 0.9729837105651983, "num_intersection": 3835206, "num_union": 4048186, "num_only_computed": 201402, "num_only_roped": 11578, "total_diff": 212980, "diff_percentage": 0.05261121895090789, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:51:36.753458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.2333984375, "l2_diff_relative": 0.02540391156462585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:52:04.098984", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547433314047443, "overlap_percentage": 0.9768477692860409, "num_intersection": 4785460, "num_union": 5012300, "num_only_computed": 195276, "num_only_roped": 31564, "total_diff": 226840, "diff_percentage": 0.04525666859525567, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:52:05.060154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.169921875, "l2_diff_relative": 0.01970108695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:52:38.137187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9564000932228803, "overlap_percentage": 0.9777142175937565, "num_intersection": 5724681, "num_union": 5985655, "num_only_computed": 199159, "num_only_roped": 61815, "total_diff": 260974, "diff_percentage": 0.04359990677711963, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:52:39.242766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.3245811462402344e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.014732142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:53:19.222675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9552208112914768, "overlap_percentage": 0.9770976308916509, "num_intersection": 6656333, "num_union": 6968371, "num_only_computed": 211635, "num_only_roped": 100403, "total_diff": 312038, "diff_percentage": 0.04477918870852313, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:53:20.556808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.018531976744186048}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:54:06.436220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9514511026310141, "overlap_percentage": 0.9751216429130453, "num_intersection": 7575369, "num_union": 7961911, "num_only_computed": 235703, "num_only_roped": 150839, "total_diff": 386542, "diff_percentage": 0.04854889736898591, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:54:09.292162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9818544387817383e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.01780378486055777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:55:02.932318", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.946740209685953, "overlap_percentage": 0.9726415522476731, "num_intersection": 8487099, "num_union": 8964549, "num_only_computed": 268101, "num_only_roped": 209349, "total_diff": 477450, "diff_percentage": 0.05325979031404703, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:55:05.438624", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06396484375, "mean_diff": 2.658367156982422e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.15252293577981652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:56:05.548736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9406212087096002, "overlap_percentage": 0.9694021733742242, "num_intersection": 9386729, "num_union": 9979287, "num_only_computed": 312599, "num_only_roped": 279959, "total_diff": 592558, "diff_percentage": 0.05937879129039981, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:56:07.635322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11767578125, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:57:15.963264", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9328056525647528, "overlap_percentage": 0.9652348142990563, "num_intersection": 10266834, "num_union": 11006402, "num_only_computed": 375598, "num_only_roped": 363970, "total_diff": 739568, "diff_percentage": 0.06719434743524723, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:57:18.285193", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:58:34.261760", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9244784970562889, "overlap_percentage": 0.9607574191869487, "num_intersection": 11131261, "num_union": 12040584, "num_only_computed": 455299, "num_only_roped": 454024, "total_diff": 909323, "diff_percentage": 0.07552150294371103, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T07:58:36.876231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.46875, "l2_diff_relative": 0.4072164948453608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:00:00.970027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9169063820083797, "overlap_percentage": 0.956652229461221, "num_intersection": 11986531, "num_union": 13072797, "num_only_computed": 543133, "num_only_roped": 543133, "total_diff": 1086266, "diff_percentage": 0.08309361799162031, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:00:03.845922", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.1961669921875e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.35308056872037913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:01:36.191048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9087740930845608, "overlap_percentage": 0.9522070698434413, "num_intersection": 12829840, "num_union": 14117744, "num_only_computed": 643952, "num_only_roped": 643952, "total_diff": 1287904, "diff_percentage": 0.09122590691543918, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:01:39.318018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.2511520737327189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:03:21.031070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9019942490012924, "overlap_percentage": 0.9484721097079191, "num_intersection": 13674995, "num_union": 15160845, "num_only_computed": 742925, "num_only_roped": 742925, "total_diff": 1485850, "diff_percentage": 0.09800575099870752, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:03:27.128470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11376953125, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.96875, "l2_diff_relative": 0.3442622950819672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:05:15.163742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8865395091705786, "overlap_percentage": 0.9398578771990285, "num_intersection": 11609648, "num_union": 13095466, "num_only_computed": 742909, "num_only_roped": 742909, "total_diff": 1485818, "diff_percentage": 0.11346049082942142, "num_computed": 12352557, "num_roped": 12352557}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "mask_shape": [1, 32, 833, 16193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:05:18.729171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.640625, "l2_diff_relative": 0.3220858895705521}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "attention_shape": [1, 32, 833, 16193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:07:05.646426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8468423669816012, "overlap_percentage": 0.9170705438879914, "num_intersection": 408720, "num_union": 482640, "num_only_computed": 36960, "num_only_roped": 36960, "total_diff": 73920, "diff_percentage": 0.1531576330183988, "num_computed": 445680, "num_roped": 445680}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "mask_shape": [1, 32, 30, 16223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:07:09.637293", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.1484375, "l2_diff_relative": 0.12582781456953643}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "attention_shape": [1, 32, 30, 16223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:08:51.130036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8429572660174905, "overlap_percentage": 0.9147876421888672, "num_intersection": 13591, "num_union": 16123, "num_only_computed": 1266, "num_only_roped": 1266, "total_diff": 2532, "diff_percentage": 0.15704273398250945, "num_computed": 14857, "num_roped": 14857}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "mask_shape": [1, 32, 1, 16224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:08:54.376812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.0302734375, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "attention_shape": [1, 32, 1, 16224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:10:34.368889", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8457142857142858, "overlap_percentage": 0.9164086687306502, "num_intersection": 13616, "num_union": 16100, "num_only_computed": 1242, "num_only_roped": 1242, "total_diff": 2484, "diff_percentage": 0.15428571428571428, "num_computed": 14858, "num_roped": 14858}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "mask_shape": [1, 32, 1, 16225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:10:38.173566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00634765625, "mean_diff": 1.52587890625e-05, "l2_diff": 0.016845703125, "l2_diff_relative": 0.07840909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "attention_shape": [1, 32, 1, 16225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:11:36.266713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:11:36.279344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.00312234268707483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:11:36.702428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:11:36.711856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7881393432617188e-06, "l2_diff": 0.02685546875, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:11:45.804847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293228747150794, "overlap_percentage": 0.9633668753886733, "num_intersection": 2875180, "num_union": 3093844, "num_only_computed": 217300, "num_only_roped": 1364, "total_diff": 218664, "diff_percentage": 0.07067712528492064, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:11:46.383401", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.017305776892430277}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:12:10.036498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9476105713703377, "overlap_percentage": 0.9731006652973745, "num_intersection": 3835667, "num_union": 4047725, "num_only_computed": 200941, "num_only_roped": 11117, "total_diff": 212058, "diff_percentage": 0.05238942862966234, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:12:10.773574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.245208740234375e-06, "l2_diff": 0.251953125, "l2_diff_relative": 0.02652138157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:12:38.162630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549750125007332, "overlap_percentage": 0.9769690214906265, "num_intersection": 4786054, "num_union": 5011706, "num_only_computed": 194682, "num_only_roped": 30970, "total_diff": 225652, "diff_percentage": 0.045024987499266714, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:12:39.095254", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.1826171875, "l2_diff_relative": 0.019479166666666665}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:13:12.925034", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9563932294364078, "overlap_percentage": 0.9777106310186147, "num_intersection": 5724660, "num_union": 5985676, "num_only_computed": 199180, "num_only_roped": 61836, "total_diff": 261016, "diff_percentage": 0.04360677056359215, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:13:15.196398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.1279296875, "l2_diff_relative": 0.014214409722222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:13:55.083671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9553852479661757, "overlap_percentage": 0.9771836511090443, "num_intersection": 6656919, "num_union": 6967785, "num_only_computed": 211049, "num_only_roped": 99817, "total_diff": 310866, "diff_percentage": 0.044614752033824236, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:13:57.343716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.250075340270996e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.017373251748251748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:14:43.727039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9523706544765808, "overlap_percentage": 0.9756043528854471, "num_intersection": 7579119, "num_union": 7958161, "num_only_computed": 231953, "num_only_roped": 147089, "total_diff": 379042, "diff_percentage": 0.04762934552341929, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:14:45.287436", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.862645149230957e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:15:38.238552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9506017904498166, "overlap_percentage": 0.9746754002831136, "num_intersection": 8504846, "num_union": 8946802, "num_only_computed": 250354, "num_only_roped": 191602, "total_diff": 441956, "diff_percentage": 0.049398209550183404, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:15:40.039966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 2.372264862060547e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.13485477178423236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:16:40.439416", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9418504216898276, "overlap_percentage": 0.9700545532958353, "num_intersection": 9393046, "num_union": 9972970, "num_only_computed": 306282, "num_only_roped": 273642, "total_diff": 579924, "diff_percentage": 0.058149578310172395, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:16:43.602133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11181640625, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.3029661016949153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:17:51.748770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9337181880389863, "overlap_percentage": 0.9657231274076027, "num_intersection": 10272028, "num_union": 11001208, "num_only_computed": 370404, "num_only_roped": 358776, "total_diff": 729180, "diff_percentage": 0.06628181196101374, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:17:55.452247", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.35}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:19:11.798638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9206479644459187, "overlap_percentage": 0.958684757944711, "num_intersection": 10302616, "num_union": 11190614, "num_only_computed": 443999, "num_only_roped": 443999, "total_diff": 887998, "diff_percentage": 0.07935203555408131, "num_computed": 10746615, "num_roped": 10746615}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "mask_shape": [1, 32, 955, 12219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:19:14.400710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 4.887580871582031e-05, "l2_diff": 2.46875, "l2_diff_relative": 0.42934782608695654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "attention_shape": [1, 32, 955, 12219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:20:30.821708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8539813007294771, "overlap_percentage": 0.9212404681681149, "num_intersection": 290913, "num_union": 340655, "num_only_computed": 24871, "num_only_roped": 24871, "total_diff": 49742, "diff_percentage": 0.14601869927052297, "num_computed": 315784, "num_roped": 315784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "mask_shape": [1, 32, 28, 12247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:20:33.272334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.9206275939941406e-05, "l2_diff": 0.140625, "l2_diff_relative": 0.11464968152866242}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "attention_shape": [1, 32, 28, 12247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:21:44.501366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8505332239540607, "overlap_percentage": 0.919230428229453, "num_intersection": 10368, "num_union": 12190, "num_only_computed": 911, "num_only_roped": 911, "total_diff": 1822, "diff_percentage": 0.1494667760459393, "num_computed": 11279, "num_roped": 11279}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "mask_shape": [1, 32, 1, 12248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:21:46.759880", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 4.57763671875e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.24342105263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "attention_shape": [1, 32, 1, 12248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:22:57.020472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8499384993849939, "overlap_percentage": 0.9188829787234043, "num_intersection": 10365, "num_union": 12195, "num_only_computed": 915, "num_only_roped": 915, "total_diff": 1830, "diff_percentage": 0.15006150061500614, "num_computed": 11280, "num_roped": 11280}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "mask_shape": [1, 32, 1, 12249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:22:59.734409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.03076171875, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "attention_shape": [1, 32, 1, 12249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:24:11.908656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8542077580539119, "overlap_percentage": 0.9213722187749313, "num_intersection": 10394, "num_union": 12168, "num_only_computed": 887, "num_only_roped": 887, "total_diff": 1774, "diff_percentage": 0.1457922419460881, "num_computed": 11281, "num_roped": 11281}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "mask_shape": [1, 32, 1, 12250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:24:14.188566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.017333984375, "l2_diff_relative": 0.07888888888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "attention_shape": [1, 32, 1, 12250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:24:54.368036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:24:54.378653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.0030423677884615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:24:54.799852", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:24:54.809296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8030405044555664e-06, "l2_diff": 0.026611328125, "l2_diff_relative": 0.0031078923357664235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:25:03.779620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293422065263802, "overlap_percentage": 0.9633772623464071, "num_intersection": 2875211, "num_union": 3093813, "num_only_computed": 217269, "num_only_roped": 1333, "total_diff": 218602, "diff_percentage": 0.07065779347361976, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:25:06.727923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.01483386075949367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:25:27.674927", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474840340435792, "overlap_percentage": 0.9730339427495169, "num_intersection": 3835404, "num_union": 4047988, "num_only_computed": 201204, "num_only_roped": 11380, "total_diff": 212584, "diff_percentage": 0.05251596595642082, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:25:28.419830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.2265625, "l2_diff_relative": 0.026268115942028984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:25:55.274664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547948113471056, "overlap_percentage": 0.9768747142203932, "num_intersection": 4785592, "num_union": 5012168, "num_only_computed": 195144, "num_only_roped": 31432, "total_diff": 226576, "diff_percentage": 0.045205188652894315, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:25:56.211603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.0994415283203125e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.018152573529411766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:26:29.549548", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9566393753102588, "overlap_percentage": 0.9778392353558429, "num_intersection": 5725413, "num_union": 5984923, "num_only_computed": 198427, "num_only_roped": 61083, "total_diff": 259510, "diff_percentage": 0.0433606246897412, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:26:31.350942", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.339482307434082e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.015178571428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:27:06.823306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9007664820926871, "overlap_percentage": 0.9477928936341198, "num_intersection": 132092, "num_union": 146644, "num_only_computed": 7276, "num_only_roped": 7276, "total_diff": 14552, "diff_percentage": 0.09923351790731295, "num_computed": 139368, "num_roped": 139368}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "mask_shape": [1, 32, 24, 6168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:27:07.869797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.9669532775878906e-06, "l2_diff": 0.02001953125, "l2_diff_relative": 0.013926630434782608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "attention_shape": [1, 32, 24, 6168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:27:42.385621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8975220056357668, "overlap_percentage": 0.9459937781697041, "num_intersection": 154477, "num_union": 172115, "num_only_computed": 8819, "num_only_roped": 8819, "total_diff": 17638, "diff_percentage": 0.10247799436423322, "num_computed": 163296, "num_roped": 163296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "mask_shape": [1, 32, 28, 6196], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:27:43.510538", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 2.339482307434082e-06, "l2_diff": 0.0181884765625, "l2_diff_relative": 0.01402484939759036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "attention_shape": [1, 32, 28, 6196]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:28:17.208123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8922952149229522, "overlap_percentage": 0.9430824618549631, "num_intersection": 5501, "num_union": 6165, "num_only_computed": 332, "num_only_roped": 332, "total_diff": 664, "diff_percentage": 0.10770478507704785, "num_computed": 5833, "num_roped": 5833}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "mask_shape": [1, 32, 1, 6197], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:28:18.251998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.000732421875, "mean_diff": 2.130866050720215e-06, "l2_diff": 0.0015716552734375, "l2_diff_relative": 0.00919642857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "attention_shape": [1, 32, 1, 6197]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:28:50.625334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9000162839928351, "overlap_percentage": 0.9473774425779911, "num_intersection": 5527, "num_union": 6141, "num_only_computed": 307, "num_only_roped": 307, "total_diff": 614, "diff_percentage": 0.09998371600716496, "num_computed": 5834, "num_roped": 5834}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "mask_shape": [1, 32, 1, 6198], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:28:51.665158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.0016937255859375, "l2_diff_relative": 0.008715452261306532}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "attention_shape": [1, 32, 1, 6198]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:24.086109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8938656280428432, "overlap_percentage": 0.9439588688946016, "num_intersection": 5508, "num_union": 6162, "num_only_computed": 327, "num_only_roped": 327, "total_diff": 654, "diff_percentage": 0.10613437195715676, "num_computed": 5835, "num_roped": 5835}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "mask_shape": [1, 32, 1, 6199], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:25.130797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.996755599975586e-06, "l2_diff": 0.00262451171875, "l2_diff_relative": 0.010416666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "attention_shape": [1, 32, 1, 6199]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:46.829825", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:46.843424", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031494140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:47.266858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:47.278254", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7583370208740234e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031692216981132077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:56.337087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293503135302864, "overlap_percentage": 0.9633816181673922, "num_intersection": 2875224, "num_union": 3093800, "num_only_computed": 217256, "num_only_roped": 1320, "total_diff": 218576, "diff_percentage": 0.07064968646971362, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:29:56.896407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.738569259643555e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.015959821428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:30:20.502734", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475013537709933, "overlap_percentage": 0.9730430758739386, "num_intersection": 3835440, "num_union": 4047952, "num_only_computed": 201168, "num_only_roped": 11344, "total_diff": 212512, "diff_percentage": 0.05249864622900667, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:30:21.248631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.2197265625, "l2_diff_relative": 0.02475792253521127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:30:48.258591", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.955017532335501, "overlap_percentage": 0.9769912714742962, "num_intersection": 4786163, "num_union": 5011597, "num_only_computed": 194573, "num_only_roped": 30861, "total_diff": 225434, "diff_percentage": 0.04498246766449896, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:30:49.202140", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.018682065217391304}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:31:22.606771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9570572786320044, "overlap_percentage": 0.9780575040716167, "num_intersection": 5726691, "num_union": 5983645, "num_only_computed": 197149, "num_only_roped": 59805, "total_diff": 256954, "diff_percentage": 0.042942721367995595, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:31:25.345097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.384185791015625e-06, "l2_diff": 0.12060546875, "l2_diff_relative": 0.015314980158730158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:32:05.263376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9558972552387244, "overlap_percentage": 0.9774514000450946, "num_intersection": 6658743, "num_union": 6965961, "num_only_computed": 209225, "num_only_roped": 97993, "total_diff": 307218, "diff_percentage": 0.04410274476127558, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:32:07.539960", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01711856617647059}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:32:53.960580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.952310550630365, "overlap_percentage": 0.9755728158339169, "num_intersection": 7578874, "num_union": 7958406, "num_only_computed": 232198, "num_only_roped": 147334, "total_diff": 379532, "diff_percentage": 0.047689449369635074, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:32:55.502687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.9073486328125e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.014865451388888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:33:48.849855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474195055204409, "overlap_percentage": 0.9729999138190273, "num_intersection": 8490226, "num_union": 8961422, "num_only_computed": 264974, "num_only_roped": 206222, "total_diff": 471196, "diff_percentage": 0.05258049447955916, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:33:50.765375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 2.9325485229492188e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.15836653386454183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:34:52.839174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.940579594109966, "overlap_percentage": 0.969380072803823, "num_intersection": 9386515, "num_union": 9979501, "num_only_computed": 312813, "num_only_roped": 280173, "total_diff": 592986, "diff_percentage": 0.05942040589003398, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:34:56.458317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.245208740234375e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.37192118226600984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:36:05.885389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9335201118671628, "overlap_percentage": 0.965617172676503, "num_intersection": 10270901, "num_union": 11002335, "num_only_computed": 371531, "num_only_roped": 359903, "total_diff": 731434, "diff_percentage": 0.06647988813283726, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:36:08.271552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.4378238341968912}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:37:25.697121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9249867392515247, "overlap_percentage": 0.9610318038982222, "num_intersection": 11134440, "num_union": 12037405, "num_only_computed": 452120, "num_only_roped": 450845, "total_diff": 902965, "diff_percentage": 0.07501326074847528, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:37:29.948228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.649162292480469e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.37817258883248733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:38:54.404561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9158791804710253, "overlap_percentage": 0.9560928369667375, "num_intersection": 11979522, "num_union": 13079806, "num_only_computed": 550142, "num_only_roped": 550142, "total_diff": 1100284, "diff_percentage": 0.08412081952897467, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:38:57.354277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.3828125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:40:29.908359", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9089067373306473, "overlap_percentage": 0.9522798778547271, "num_intersection": 12830821, "num_union": 14116763, "num_only_computed": 642971, "num_only_roped": 642971, "total_diff": 1285942, "diff_percentage": 0.09109326266935273, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:40:33.044122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 3.981590270996094e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.3584474885844749}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:42:14.078721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9018967759518078, "overlap_percentage": 0.9484182184392755, "num_intersection": 13674218, "num_union": 15161622, "num_only_computed": 743702, "num_only_roped": 743702, "total_diff": 1487404, "diff_percentage": 0.0981032240481922, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:42:17.431124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.46932515337423314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:44:07.402847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8911772891733927, "overlap_percentage": 0.942457689477557, "num_intersection": 12718344, "num_union": 14271396, "num_only_computed": 776526, "num_only_roped": 776526, "total_diff": 1553052, "diff_percentage": 0.10882271082660729, "num_computed": 13494870, "num_roped": 13494870}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 906, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:44:13.465153", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12353515625, "mean_diff": 4.673004150390625e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.5125786163522013}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 906, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:46:01.576452", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.846848937783348, "overlap_percentage": 0.9170743967828419, "num_intersection": 383117, "num_union": 452403, "num_only_computed": 34643, "num_only_roped": 34643, "total_diff": 69286, "diff_percentage": 0.15315106221665198, "num_computed": 417760, "num_roped": 417760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 28, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:46:04.957551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.2001953125, "l2_diff_relative": 0.1642628205128205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 28, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:47:46.214736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8454022633108651, "overlap_percentage": 0.916225454058039, "num_intersection": 13671, "num_union": 16171, "num_only_computed": 1250, "num_only_roped": 1250, "total_diff": 2500, "diff_percentage": 0.15459773668913487, "num_computed": 14921, "num_roped": 14921}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:47:49.418214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00634765625, "mean_diff": 1.7642974853515625e-05, "l2_diff": 0.01483154296875, "l2_diff_relative": 0.06841216216216216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:49:29.210347", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8418811331234957, "overlap_percentage": 0.9141535987133093, "num_intersection": 13641, "num_union": 16203, "num_only_computed": 1281, "num_only_roped": 1281, "total_diff": 2562, "diff_percentage": 0.15811886687650434, "num_computed": 14922, "num_roped": 14922}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:49:33.739315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.11116412213740458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:50:31.646975", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:50:31.659588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003058667452830189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:50:32.083997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:50:32.093465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8700957298278809e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.003277972027972028}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:50:41.070182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293365940251249, "overlap_percentage": 0.9633742467780327, "num_intersection": 2875202, "num_union": 3093822, "num_only_computed": 217278, "num_only_roped": 1342, "total_diff": 218620, "diff_percentage": 0.0706634059748751, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:50:41.635991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.014613309352517985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:51:02.370151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474869206434219, "overlap_percentage": 0.9730354649369205, "num_intersection": 3835410, "num_union": 4047982, "num_only_computed": 201198, "num_only_roped": 11374, "total_diff": 212572, "diff_percentage": 0.05251307935657817, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:51:03.114689", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.20703125, "l2_diff_relative": 0.024720149253731342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:51:29.991580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548895883318286, "overlap_percentage": 0.9769243173949964, "num_intersection": 4785835, "num_union": 5011925, "num_only_computed": 194901, "num_only_roped": 31189, "total_diff": 226090, "diff_percentage": 0.04511041166817141, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:51:30.921380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.01941872427983539}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:52:04.244980", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9568290119734113, "overlap_percentage": 0.9779382931454742, "num_intersection": 5725993, "num_union": 5984343, "num_only_computed": 197847, "num_only_roped": 60503, "total_diff": 258350, "diff_percentage": 0.04317098802658872, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:52:05.355562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.016466346153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:52:47.479266", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9552990976582972, "overlap_percentage": 0.9771385859098297, "num_intersection": 6656612, "num_union": 6968092, "num_only_computed": 211356, "num_only_roped": 100124, "total_diff": 311480, "diff_percentage": 0.04470090234170272, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:52:51.362655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.3096799850463867e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.017607276119402986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:53:37.922778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9519772254582893, "overlap_percentage": 0.9753978817399185, "num_intersection": 7577515, "num_union": 7959765, "num_only_computed": 233557, "num_only_roped": 148693, "total_diff": 382250, "diff_percentage": 0.048022774541710715, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:53:39.477108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.01551177536231884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:54:32.803233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475570733782482, "overlap_percentage": 0.9730724571112138, "num_intersection": 8490859, "num_union": 8960789, "num_only_computed": 264341, "num_only_roped": 205589, "total_diff": 469930, "diff_percentage": 0.05244292662175172, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:54:34.611104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.087890625, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.19222689075630253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:55:35.090048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9420248987321995, "overlap_percentage": 0.970147086525179, "num_intersection": 9393942, "num_union": 9972074, "num_only_computed": 305386, "num_only_roped": 272746, "total_diff": 578132, "diff_percentage": 0.057975101267800457, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:55:38.989758", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1494140625, "mean_diff": 5.6743621826171875e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.41494845360824745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:56:48.044305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.935125045368914, "overlap_percentage": 0.9664750581434813, "num_intersection": 10280026, "num_union": 10993210, "num_only_computed": 362406, "num_only_roped": 350778, "total_diff": 713184, "diff_percentage": 0.06487495463108592, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:56:50.854025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 5.078315734863281e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.4023809523809524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:58:07.023628", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9259206281342548, "overlap_percentage": 0.9615356049550651, "num_intersection": 11140277, "num_union": 12031568, "num_only_computed": 446283, "num_only_roped": 445008, "total_diff": 891291, "diff_percentage": 0.07407937186574517, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:58:09.639548", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 5.841255187988281e-05, "l2_diff": 3.125, "l2_diff_relative": 0.5128205128205128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:59:34.895695", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9165845761129338, "overlap_percentage": 0.956477045194508, "num_intersection": 11984336, "num_union": 13074992, "num_only_computed": 545328, "num_only_roped": 545328, "total_diff": 1090656, "diff_percentage": 0.08341542388706624, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T08:59:40.091967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 5.078315734863281e-05, "l2_diff": 2.375, "l2_diff_relative": 0.40425531914893614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:01:09.652474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8880358137688438, "overlap_percentage": 0.940698060166742, "num_intersection": 8041817, "num_union": 9055735, "num_only_computed": 506959, "num_only_roped": 506959, "total_diff": 1013918, "diff_percentage": 0.11196418623115628, "num_computed": 8548776, "num_roped": 8548776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "mask_shape": [1, 32, 666, 13978], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:01:14.665577", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.5234375, "l2_diff_relative": 0.2785714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "attention_shape": [1, 32, 666, 13978]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:02:42.709243", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8497130007085134, "overlap_percentage": 0.9187511796511564, "num_intersection": 413755, "num_union": 486935, "num_only_computed": 36590, "num_only_roped": 36590, "total_diff": 73180, "diff_percentage": 0.15028699929148653, "num_computed": 450345, "num_roped": 450345}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "mask_shape": [1, 32, 35, 14013], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:02:45.500295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.1337890625, "l2_diff_relative": 0.10073529411764706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "attention_shape": [1, 32, 35, 14013]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:04:09.419632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8463304397732979, "overlap_percentage": 0.9167702828722413, "num_intersection": 11797, "num_union": 13939, "num_only_computed": 1071, "num_only_roped": 1071, "total_diff": 2142, "diff_percentage": 0.15366956022670206, "num_computed": 12868, "num_roped": 12868}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "mask_shape": [1, 32, 1, 14014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:04:12.083505", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0296630859375, "mean_diff": 3.0517578125e-05, "l2_diff": 0.045166015625, "l2_diff_relative": 0.23596938775510204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "attention_shape": [1, 32, 1, 14014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:05:35.998667", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8456794550017928, "overlap_percentage": 0.9163882197528945, "num_intersection": 11793, "num_union": 13945, "num_only_computed": 1076, "num_only_roped": 1076, "total_diff": 2152, "diff_percentage": 0.15432054499820724, "num_computed": 12869, "num_roped": 12869}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "mask_shape": [1, 32, 1, 14015], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:05:39.631641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0201416015625, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.17101648351648352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "attention_shape": [1, 32, 1, 14015]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:07:03.495028", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8495365380469929, "overlap_percentage": 0.9186480186480186, "num_intersection": 11823, "num_union": 13917, "num_only_computed": 1047, "num_only_roped": 1047, "total_diff": 2094, "diff_percentage": 0.1504634619530071, "num_computed": 12870, "num_roped": 12870}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14016, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14016, 128], "mask_shape": [1, 32, 1, 14016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:07:06.977338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029541015625, "mean_diff": 3.361701965332031e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.20489690721649484}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14016, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14016, 128], "attention_shape": [1, 32, 1, 14016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:08:29.372891", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8499461013295005, "overlap_percentage": 0.9188874213347836, "num_intersection": 11827, "num_union": 13915, "num_only_computed": 1044, "num_only_roped": 1044, "total_diff": 2088, "diff_percentage": 0.15005389867049945, "num_computed": 12871, "num_roped": 12871}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14017, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14017, 128], "mask_shape": [1, 32, 1, 14017], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:08:32.035337", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.288818359375e-05, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.16131284916201116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14017, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14017, 128], "attention_shape": [1, 32, 1, 14017]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:09:54.661803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8480976310122039, "overlap_percentage": 0.9178060907395899, "num_intersection": 11814, "num_union": 13930, "num_only_computed": 1058, "num_only_roped": 1058, "total_diff": 2116, "diff_percentage": 0.15190236898779613, "num_computed": 12872, "num_roped": 12872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14018, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14018, 128], "mask_shape": [1, 32, 1, 14018], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:09:57.341008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.20949720670391062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14018, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14018, 128], "attention_shape": [1, 32, 1, 14018]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:11:19.882507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8466504088366088, "overlap_percentage": 0.916957974054222, "num_intersection": 11804, "num_union": 13942, "num_only_computed": 1069, "num_only_roped": 1069, "total_diff": 2138, "diff_percentage": 0.1533495911633912, "num_computed": 12873, "num_roped": 12873}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14019, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14019, 128], "mask_shape": [1, 32, 1, 14019], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:11:22.564371", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.15064102564102563}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14019, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14019, 128], "attention_shape": [1, 32, 1, 14019]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:12:45.282773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8485174815133893, "overlap_percentage": 0.9180518875252447, "num_intersection": 11819, "num_union": 13929, "num_only_computed": 1055, "num_only_roped": 1055, "total_diff": 2110, "diff_percentage": 0.15148251848661068, "num_computed": 12874, "num_roped": 12874}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14020, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14020, 128], "mask_shape": [1, 32, 1, 14020], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:12:47.964546", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01165771484375, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.17994505494505494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14020, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14020, 128], "attention_shape": [1, 32, 1, 14020]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:13:38.563430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:13:38.576026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031005859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:13:39.001742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:13:39.011224", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8253922462463379e-06, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.0031540329391891893}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:13:47.914802", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293428301396465, "overlap_percentage": 0.9633775974095597, "num_intersection": 2875212, "num_union": 3093812, "num_only_computed": 217268, "num_only_roped": 1332, "total_diff": 218600, "diff_percentage": 0.0706571698603535, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:13:48.728563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.016374143835616438}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:14:09.512137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474984671283645, "overlap_percentage": 0.9730415536865349, "num_intersection": 3835434, "num_union": 4047958, "num_only_computed": 201174, "num_only_roped": 11350, "total_diff": 212524, "diff_percentage": 0.052501532871635524, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:14:10.252838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.2216796875, "l2_diff_relative": 0.025517086330935253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:14:37.356104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547441113836408, "overlap_percentage": 0.976848177542622, "num_intersection": 4785462, "num_union": 5012298, "num_only_computed": 195274, "num_only_roped": 31562, "total_diff": 226836, "diff_percentage": 0.0452558886163592, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:14:38.292947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.16796875, "l2_diff_relative": 0.01933453237410072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:15:11.549169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9565654923544927, "overlap_percentage": 0.9778006369757452, "num_intersection": 5725187, "num_union": 5985149, "num_only_computed": 198653, "num_only_roped": 61309, "total_diff": 259962, "diff_percentage": 0.043434507645507235, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:15:12.687146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.4586915969848633e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.01625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:15:51.992330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9554733704668451, "overlap_percentage": 0.9772297438535178, "num_intersection": 6657233, "num_union": 6967471, "num_only_computed": 210735, "num_only_roped": 99503, "total_diff": 310238, "diff_percentage": 0.04452662953315486, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:15:53.943197", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.250075340270996e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.0166015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:16:40.012588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9520343658395997, "overlap_percentage": 0.975427874119537, "num_intersection": 7577748, "num_union": 7959532, "num_only_computed": 233324, "num_only_roped": 148460, "total_diff": 381784, "diff_percentage": 0.04796563416040039, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:16:41.565508", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.9818544387817383e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.016666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:17:34.364971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9470586181116475, "overlap_percentage": 0.9728095593035111, "num_intersection": 8488565, "num_union": 8963083, "num_only_computed": 266635, "num_only_roped": 207883, "total_diff": 474518, "diff_percentage": 0.05294138188835248, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:17:36.138020", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 2.6464462280273438e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.14479166666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:18:35.969901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9410940681112366, "overlap_percentage": 0.9696532317230349, "num_intersection": 9389160, "num_union": 9976856, "num_only_computed": 310168, "num_only_roped": 277528, "total_diff": 587696, "diff_percentage": 0.058905931888763356, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:18:38.983758", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 5.0067901611328125e-05, "l2_diff": 2.46875, "l2_diff_relative": 0.3542600896860987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:19:46.812339", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9341767133998873, "overlap_percentage": 0.9659683181251785, "num_intersection": 10274636, "num_union": 10998600, "num_only_computed": 367796, "num_only_roped": 356168, "total_diff": 723964, "diff_percentage": 0.06582328660011275, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:19:50.976181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:21:06.671384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9255789344310724, "overlap_percentage": 0.9613513295984847, "num_intersection": 11138142, "num_union": 12033703, "num_only_computed": 448418, "num_only_roped": 447143, "total_diff": 895561, "diff_percentage": 0.07442106556892754, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:21:09.263276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.375, "l2_diff_relative": 0.44970414201183434}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:22:35.524172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9167363025593552, "overlap_percentage": 0.9565596491653726, "num_intersection": 11985371, "num_union": 13073957, "num_only_computed": 544293, "num_only_roped": 544293, "total_diff": 1088586, "diff_percentage": 0.08326369744064478, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:22:38.374088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.103515625, "mean_diff": 5.2928924560546875e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.44904458598726116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:24:10.606147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9087899120723334, "overlap_percentage": 0.952215753367723, "num_intersection": 12829957, "num_union": 14117627, "num_only_computed": 643835, "num_only_roped": 643835, "total_diff": 1287670, "diff_percentage": 0.09121008792766659, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:24:14.825101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.46}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:25:55.888683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.901206847125401, "overlap_percentage": 0.9480366099964489, "num_intersection": 13668716, "num_union": 15167124, "num_only_computed": 749204, "num_only_roped": 749204, "total_diff": 1498408, "diff_percentage": 0.09879315287459903, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:25:59.235617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.7206878662109375e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.4567901234567901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:27:40.290096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8464805825242718, "overlap_percentage": 0.9168583634571147, "num_intersection": 881640, "num_union": 1041536, "num_only_computed": 79948, "num_only_roped": 79948, "total_diff": 159896, "diff_percentage": 0.15351941747572814, "num_computed": 961588, "num_roped": 961588}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "mask_shape": [1, 32, 68, 15428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:27:44.259112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.263671875, "l2_diff_relative": 0.13608870967741934}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "attention_shape": [1, 32, 68, 15428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:29:20.626214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8434409636464343, "overlap_percentage": 0.915072389384316, "num_intersection": 427897, "num_union": 507323, "num_only_computed": 39713, "num_only_roped": 39713, "total_diff": 79426, "diff_percentage": 0.1565590363535657, "num_computed": 467610, "num_roped": 467610}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "mask_shape": [1, 32, 33, 15461], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:29:23.723157", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.126953125, "l2_diff_relative": 0.10093167701863354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "attention_shape": [1, 32, 33, 15461]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:30:58.772092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8439817826935588, "overlap_percentage": 0.9153905864088632, "num_intersection": 12972, "num_union": 15370, "num_only_computed": 1199, "num_only_roped": 1199, "total_diff": 2398, "diff_percentage": 0.1560182173064411, "num_computed": 14171, "num_roped": 14171}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "mask_shape": [1, 32, 1, 15462], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:31:01.757566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00726318359375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.0185546875, "l2_diff_relative": 0.11875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "attention_shape": [1, 32, 1, 15462]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:32:34.803366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8420744784558394, "overlap_percentage": 0.9142675698560542, "num_intersection": 12957, "num_union": 15387, "num_only_computed": 1215, "num_only_roped": 1215, "total_diff": 2430, "diff_percentage": 0.15792552154416065, "num_computed": 14172, "num_roped": 14172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "mask_shape": [1, 32, 1, 15463], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:32:37.812738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.025634765625, "l2_diff_relative": 0.13962765957446807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "attention_shape": [1, 32, 1, 15463]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:33:29.803991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:33:29.817640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.0030048076923076925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:33:30.240418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:33:30.249870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7881393432617188e-06, "l2_diff": 0.0274658203125, "l2_diff_relative": 0.003138950892857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:33:39.172896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293328523757624, "overlap_percentage": 0.9633722363991165, "num_intersection": 2875196, "num_union": 3093828, "num_only_computed": 217284, "num_only_roped": 1348, "total_diff": 218632, "diff_percentage": 0.07066714762423768, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:33:39.744016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.119140625, "l2_diff_relative": 0.015311244979919678}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:34:02.876816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475335885283303, "overlap_percentage": 0.9730600736332786, "num_intersection": 3835507, "num_union": 4047885, "num_only_computed": 201101, "num_only_roped": 11277, "total_diff": 212378, "diff_percentage": 0.05246641147166977, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:34:03.606704", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.232421875, "l2_diff_relative": 0.025470890410958905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:34:30.461139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548295228387262, "overlap_percentage": 0.976892881638252, "num_intersection": 4785681, "num_union": 5012079, "num_only_computed": 195055, "num_only_roped": 31343, "total_diff": 226398, "diff_percentage": 0.045170477161273793, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:34:31.378673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.1441450119018555e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.017932046979865772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:35:04.469330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9569192657769373, "overlap_percentage": 0.9779854309901953, "num_intersection": 5726269, "num_union": 5984067, "num_only_computed": 197571, "num_only_roped": 60227, "total_diff": 257798, "diff_percentage": 0.043080734223062675, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:35:07.569138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.3990869522094727e-06, "l2_diff": 0.125, "l2_diff_relative": 0.015151515151515152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:35:46.912256", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9554337985525027, "overlap_percentage": 0.9772090461561587, "num_intersection": 6657092, "num_union": 6967612, "num_only_computed": 210876, "num_only_roped": 99644, "total_diff": 310520, "diff_percentage": 0.044566201447497365, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:35:48.996448", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.1457672119140625e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.016452814569536425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:36:34.599181", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9523304212883993, "overlap_percentage": 0.9755832423693207, "num_intersection": 7578955, "num_union": 7958325, "num_only_computed": 232117, "num_only_roped": 147253, "total_diff": 379370, "diff_percentage": 0.04766957871160075, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:36:36.141379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.041459083557129e-06, "l2_diff": 0.1591796875, "l2_diff_relative": 0.017686631944444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:37:28.905469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9467380380897711, "overlap_percentage": 0.9726404062240999, "num_intersection": 8487089, "num_union": 8964559, "num_only_computed": 268111, "num_only_roped": 209359, "total_diff": 477470, "diff_percentage": 0.05326196191022894, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:37:30.689762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0966796875, "mean_diff": 2.5272369384765625e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.142570281124498}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:38:30.778511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9411429038234951, "overlap_percentage": 0.9696791534200943, "num_intersection": 9389411, "num_union": 9976605, "num_only_computed": 309917, "num_only_roped": 277277, "total_diff": 587194, "diff_percentage": 0.05885709617650493, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:38:35.246181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.38402061855670105}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:39:41.331111", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9181134614337072, "overlap_percentage": 0.9573088139921159, "num_intersection": 7534051, "num_union": 8206013, "num_only_computed": 335981, "num_only_roped": 335981, "total_diff": 671962, "diff_percentage": 0.08188653856629279, "num_computed": 7870032, "num_roped": 7870032}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "mask_shape": [1, 32, 774, 11014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:39:45.368553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 5.745887756347656e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.434640522875817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "attention_shape": [1, 32, 774, 11014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:40:52.559345", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8596315755411345, "overlap_percentage": 0.9245181538617294, "num_intersection": 292218, "num_union": 339934, "num_only_computed": 23858, "num_only_roped": 23858, "total_diff": 47716, "diff_percentage": 0.14036842445886555, "num_computed": 316076, "num_roped": 316076}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "mask_shape": [1, 32, 31, 11045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:40:54.692398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.125, "l2_diff_relative": 0.10884353741496598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "attention_shape": [1, 32, 31, 11045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:41:57.373201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8612758966870494, "overlap_percentage": 0.9254682749828381, "num_intersection": 9437, "num_union": 10957, "num_only_computed": 760, "num_only_roped": 760, "total_diff": 1520, "diff_percentage": 0.13872410331295063, "num_computed": 10197, "num_roped": 10197}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "mask_shape": [1, 32, 1, 11046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:41:59.368107", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01116943359375, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.021240234375, "l2_diff_relative": 0.14403973509933773}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "attention_shape": [1, 32, 1, 11046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:43:01.382222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8609489051094891, "overlap_percentage": 0.9252794665620709, "num_intersection": 9436, "num_union": 10960, "num_only_computed": 762, "num_only_roped": 762, "total_diff": 1524, "diff_percentage": 0.13905109489051096, "num_computed": 10198, "num_roped": 10198}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "mask_shape": [1, 32, 1, 11047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:43:03.363427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.007598876953125, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.07712765957446809}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "attention_shape": [1, 32, 1, 11047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:04.654756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.85503819570753, "overlap_percentage": 0.9218550838317482, "num_intersection": 9402, "num_union": 10996, "num_only_computed": 797, "num_only_roped": 797, "total_diff": 1594, "diff_percentage": 0.14496180429247, "num_computed": 10199, "num_roped": 10199}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "mask_shape": [1, 32, 1, 11048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:07.010819", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00518798828125, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.0142822265625, "l2_diff_relative": 0.06587837837837837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "attention_shape": [1, 32, 1, 11048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:44.187361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:44.201037", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.0030218160377358493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:44.624901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:44.634379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7210841178894043e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.003072750796178344}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:53.541371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293328523757624, "overlap_percentage": 0.9633722363991165, "num_intersection": 2875196, "num_union": 3093828, "num_only_computed": 217284, "num_only_roped": 1348, "total_diff": 218632, "diff_percentage": 0.07066714762423768, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:44:54.090486", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.678964614868164e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.015082465277777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:45:14.764909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9473108537111928, "overlap_percentage": 0.9729426115053013, "num_intersection": 3835044, "num_union": 4048348, "num_only_computed": 201564, "num_only_roped": 11740, "total_diff": 213304, "diff_percentage": 0.052689146288807186, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:45:17.729277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.244140625, "l2_diff_relative": 0.02536525974025974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:45:45.640166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549044102550596, "overlap_percentage": 0.9769320742700373, "num_intersection": 4785873, "num_union": 5011887, "num_only_computed": 194863, "num_only_roped": 31151, "total_diff": 226014, "diff_percentage": 0.04509558974494038, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:45:46.582981", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.01729559748427673}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:46:20.023236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9566321829189742, "overlap_percentage": 0.9778354779914086, "num_intersection": 5725391, "num_union": 5984945, "num_only_computed": 198449, "num_only_roped": 61105, "total_diff": 259554, "diff_percentage": 0.04336781708102581, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:46:21.137098", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.01363255033557047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:47:00.720495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9553465214813653, "overlap_percentage": 0.9771633937882247, "num_intersection": 6656781, "num_union": 6967923, "num_only_computed": 211187, "num_only_roped": 99955, "total_diff": 311142, "diff_percentage": 0.044653478518634604, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:47:02.075292", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.205371856689453e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.01697019867549669}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:47:48.573618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9525289047486678, "overlap_percentage": 0.9756873790007002, "num_intersection": 7579764, "num_union": 7957516, "num_only_computed": 231308, "num_only_roped": 146444, "total_diff": 377752, "diff_percentage": 0.0474710952513322, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:47:50.986320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.015732020547945206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:48:44.708042", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9477966138772481, "overlap_percentage": 0.9731987489089856, "num_intersection": 8491961, "num_union": 8959687, "num_only_computed": 263239, "num_only_roped": 204487, "total_diff": 467726, "diff_percentage": 0.052203386122751834, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:48:46.521590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.095703125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.8046875, "l2_diff_relative": 0.2357142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:49:47.479043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9422962182823821, "overlap_percentage": 0.9702909467801741, "num_intersection": 9395335, "num_union": 9970681, "num_only_computed": 303993, "num_only_roped": 271353, "total_diff": 575346, "diff_percentage": 0.057703781717617884, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:49:49.592907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 6.29425048828125e-05, "l2_diff": 3.0, "l2_diff_relative": 0.4729064039408867}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:51:00.925366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9344125658948289, "overlap_percentage": 0.9660943920332572, "num_intersection": 10275977, "num_union": 10997259, "num_only_computed": 366455, "num_only_roped": 354827, "total_diff": 721282, "diff_percentage": 0.06558743410517112, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:51:04.047473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.828125, "l2_diff_relative": 0.47883597883597884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:52:21.994020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9257493660159974, "overlap_percentage": 0.9614432514976688, "num_intersection": 11139207, "num_union": 12032638, "num_only_computed": 447353, "num_only_roped": 446078, "total_diff": 893431, "diff_percentage": 0.07425063398400251, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:52:26.710764", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1728515625, "mean_diff": 6.198883056640625e-05, "l2_diff": 3.875, "l2_diff_relative": 0.6078431372549019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:53:53.229466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9166001141424865, "overlap_percentage": 0.9564855051180942, "num_intersection": 11984442, "num_union": 13074886, "num_only_computed": 545222, "num_only_roped": 545222, "total_diff": 1090444, "diff_percentage": 0.0833998858575134, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:53:56.231626", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 5.745887756347656e-05, "l2_diff": 3.40625, "l2_diff_relative": 0.558974358974359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:55:32.309100", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9093859516113261, "overlap_percentage": 0.9525428327823378, "num_intersection": 12834364, "num_union": 14113220, "num_only_computed": 639428, "num_only_roped": 639428, "total_diff": 1278856, "diff_percentage": 0.09061404838867389, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:55:35.526276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 5.602836608886719e-05, "l2_diff": 3.265625, "l2_diff_relative": 0.5870786516853933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:57:16.042315", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8902151531594269, "overlap_percentage": 0.941919391209476, "num_intersection": 10073372, "num_union": 11315660, "num_only_computed": 621144, "num_only_roped": 621144, "total_diff": 1242288, "diff_percentage": 0.10978484684057316, "num_computed": 10694516, "num_roped": 10694516}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "mask_shape": [1, 32, 772, 15108], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:57:19.802557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.3977272727272727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "attention_shape": [1, 32, 772, 15108]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:58:57.845601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8524390169884498, "overlap_percentage": 0.9203423261665892, "num_intersection": 280894, "num_union": 329518, "num_only_computed": 24312, "num_only_roped": 24312, "total_diff": 48624, "diff_percentage": 0.1475609830115502, "num_computed": 305206, "num_roped": 305206}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "mask_shape": [1, 32, 22, 15130], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T09:59:00.922980", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.1103515625, "l2_diff_relative": 0.09292763157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "attention_shape": [1, 32, 22, 15130]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:00:33.727578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8482547295496936, "overlap_percentage": 0.9178980753982556, "num_intersection": 12734, "num_union": 15012, "num_only_computed": 1139, "num_only_roped": 1139, "total_diff": 2278, "diff_percentage": 0.15174527045030642, "num_computed": 13873, "num_roped": 13873}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "mask_shape": [1, 32, 1, 15131], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:00:36.675409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.10837155963302753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "attention_shape": [1, 32, 1, 15131]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:27.042516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:27.062067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0031948468543046356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:27.491065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:27.500503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8030405044555664e-06, "l2_diff": 0.028564453125, "l2_diff_relative": 0.0031519396551724136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:36.385948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293440773673884, "overlap_percentage": 0.9633782675358652, "num_intersection": 2875214, "num_union": 3093810, "num_only_computed": 217266, "num_only_roped": 1330, "total_diff": 218596, "diff_percentage": 0.07065592263261157, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:36.937085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.678964614868164e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:57.534618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474426603861491, "overlap_percentage": 0.9730121247300655, "num_intersection": 3835318, "num_union": 4048074, "num_only_computed": 201290, "num_only_roped": 11466, "total_diff": 212756, "diff_percentage": 0.05255733961385093, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:01:58.254888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.738569259643555e-06, "l2_diff": 0.197265625, "l2_diff_relative": 0.02446705426356589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:02:25.209730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.955068636602543, "overlap_percentage": 0.977018012280358, "num_intersection": 4786294, "num_union": 5011466, "num_only_computed": 194442, "num_only_roped": 30730, "total_diff": 225172, "diff_percentage": 0.04493136339745695, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:02:26.141958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.995133399963379e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.015728476821192054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:02:54.812350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9114213712597399, "overlap_percentage": 0.9536582408922835, "num_intersection": 125860, "num_union": 138092, "num_only_computed": 6116, "num_only_roped": 6116, "total_diff": 12232, "diff_percentage": 0.08857862874026011, "num_computed": 131976, "num_roped": 131976}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "mask_shape": [1, 32, 27, 5147], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:02:55.681997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 2.5779008865356445e-06, "l2_diff": 0.0179443359375, "l2_diff_relative": 0.01375374251497006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "attention_shape": [1, 32, 27, 5147]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:03:22.590766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9056714090820502, "overlap_percentage": 0.9505011249744324, "num_intersection": 4647, "num_union": 5131, "num_only_computed": 242, "num_only_roped": 242, "total_diff": 484, "diff_percentage": 0.09432859091794972, "num_computed": 4889, "num_roped": 4889}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "mask_shape": [1, 32, 1, 5148], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:03:23.444676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 3.0100345611572266e-06, "l2_diff": 0.0037994384765625, "l2_diff_relative": 0.01462640977443609}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "attention_shape": [1, 32, 1, 5148]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:03:49.892324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9079204057744831, "overlap_percentage": 0.9517382413087935, "num_intersection": 4654, "num_union": 5126, "num_only_computed": 236, "num_only_roped": 236, "total_diff": 472, "diff_percentage": 0.09207959422551697, "num_computed": 4890, "num_roped": 4890}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "mask_shape": [1, 32, 1, 5149], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:03:50.743945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.003265380859375, "l2_diff_relative": 0.013592479674796747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "attention_shape": [1, 32, 1, 5149]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:04:17.232064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.90682261208577, "overlap_percentage": 0.9511347372725414, "num_intersection": 4652, "num_union": 5130, "num_only_computed": 239, "num_only_roped": 239, "total_diff": 478, "diff_percentage": 0.09317738791423003, "num_computed": 4891, "num_roped": 4891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "mask_shape": [1, 32, 1, 5150], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:04:18.079964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.005218505859375, "l2_diff_relative": 0.020241477272727272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "attention_shape": [1, 32, 1, 5150]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:04:44.443960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9045950155763239, "overlap_percentage": 0.9499079942751993, "num_intersection": 4646, "num_union": 5136, "num_only_computed": 245, "num_only_roped": 245, "total_diff": 490, "diff_percentage": 0.09540498442367601, "num_computed": 4891, "num_roped": 4891}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5151, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5151, 128], "mask_shape": [1, 32, 1, 5151], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:04:45.299359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 2.1904706954956055e-06, "l2_diff": 0.0032806396484375, "l2_diff_relative": 0.014480064655172414}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5151, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5151, 128], "attention_shape": [1, 32, 1, 5151]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:02.032984", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:02.045530", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:02.468534", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:02.477983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.9073486328125e-06, "l2_diff": 0.0264892578125, "l2_diff_relative": 0.003210819128787879}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:11.406465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293210039151903, "overlap_percentage": 0.9633658701992152, "num_intersection": 2875177, "num_union": 3093847, "num_only_computed": 217303, "num_only_roped": 1367, "total_diff": 218670, "diff_percentage": 0.07067899608480963, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:11.958228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.1240234375, "l2_diff_relative": 0.01633230452674897}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:34.004849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474368874574305, "overlap_percentage": 0.9730090803552582, "num_intersection": 3835306, "num_union": 4048086, "num_only_computed": 201302, "num_only_roped": 11478, "total_diff": 212780, "diff_percentage": 0.0525631125425695, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:05:37.008789", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.125999450683594e-06, "l2_diff": 0.2158203125, "l2_diff_relative": 0.027847782258064516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:06:06.076272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548751566751703, "overlap_percentage": 0.9769167646482462, "num_intersection": 4785798, "num_union": 5011962, "num_only_computed": 194938, "num_only_roped": 31226, "total_diff": 226164, "diff_percentage": 0.045124843324829675, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:06:07.006601", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.0547380447387695e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.016294642857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:06:40.892137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9571383947947963, "overlap_percentage": 0.9780998598161488, "num_intersection": 5726939, "num_union": 5983397, "num_only_computed": 196901, "num_only_roped": 59557, "total_diff": 256458, "diff_percentage": 0.042861605205203664, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:06:42.050535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.3096799850463867e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.015193965517241378}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:07:22.732785", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9558034794679238, "overlap_percentage": 0.9774023714570239, "num_intersection": 6658409, "num_union": 6966295, "num_only_computed": 209559, "num_only_roped": 98327, "total_diff": 307886, "diff_percentage": 0.04419652053207623, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:07:24.078496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.130866050720215e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.016469594594594593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:08:11.165404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9515469407851767, "overlap_percentage": 0.9751719734728344, "num_intersection": 7575760, "num_union": 7961520, "num_only_computed": 235312, "num_only_roped": 150448, "total_diff": 385760, "diff_percentage": 0.0484530592148233, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:08:12.745536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.0712614059448242e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.018368320610687022}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:09:05.747666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9465380548503817, "overlap_percentage": 0.9725348574530038, "num_intersection": 8486168, "num_union": 8965480, "num_only_computed": 269032, "num_only_roped": 210280, "total_diff": 479312, "diff_percentage": 0.053461945149618315, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:09:07.533708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.81640625, "l2_diff_relative": 0.11715246636771301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:10:07.975764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9409028347721385, "overlap_percentage": 0.9695517136823598, "num_intersection": 9388177, "num_union": 9977839, "num_only_computed": 311151, "num_only_roped": 278511, "total_diff": 589662, "diff_percentage": 0.059097165227861466, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:10:10.054166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.8046875, "l2_diff_relative": 0.2916666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:11:20.963355", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.933586367081205, "overlap_percentage": 0.9656526162733305, "num_intersection": 10271278, "num_union": 11001958, "num_only_computed": 371154, "num_only_roped": 359526, "total_diff": 730680, "diff_percentage": 0.066413632918795, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:11:23.826520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10302734375, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.21781115879828325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:12:33.445169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8619709131838512, "overlap_percentage": 0.9258693646400051, "num_intersection": 902131, "num_union": 1046591, "num_only_computed": 72230, "num_only_roped": 72230, "total_diff": 144460, "diff_percentage": 0.1380290868161488, "num_computed": 974361, "num_roped": 974361}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 93, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:12:35.697717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.27734375, "l2_diff_relative": 0.1062874251497006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 93, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:13:41.973415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8566818443039653, "overlap_percentage": 0.9228095238095239, "num_intersection": 251927, "num_union": 294073, "num_only_computed": 21073, "num_only_roped": 21073, "total_diff": 42146, "diff_percentage": 0.14331815569603465, "num_computed": 273000, "num_roped": 273000}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 26, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:13:44.463676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.10009765625, "l2_diff_relative": 0.09284420289855072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 26, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:14:49.657671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8595714538693111, "overlap_percentage": 0.9244833825349966, "num_intersection": 9708, "num_union": 11294, "num_only_computed": 793, "num_only_roped": 793, "total_diff": 1586, "diff_percentage": 0.14042854613068886, "num_computed": 10501, "num_roped": 10501}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:14:52.120993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.0274658203125, "l2_diff_relative": 0.15040106951871657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:15:56.143943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8609019225657837, "overlap_percentage": 0.9252523328889736, "num_intersection": 9717, "num_union": 11287, "num_only_computed": 785, "num_only_roped": 785, "total_diff": 1570, "diff_percentage": 0.13909807743421634, "num_computed": 10502, "num_roped": 10502}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:15:58.207731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0108642578125, "mean_diff": 3.6716461181640625e-05, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.10682624113475177}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:03.995494", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8599256242252523, "overlap_percentage": 0.9246881843282871, "num_intersection": 9712, "num_union": 11294, "num_only_computed": 791, "num_only_roped": 791, "total_diff": 1582, "diff_percentage": 0.14007437577474766, "num_computed": 10503, "num_roped": 10503}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:06.102656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.728534698486328e-05, "l2_diff": 0.0196533203125, "l2_diff_relative": 0.051078680203045686}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:43.328496", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:43.341119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003117487980769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:43.765333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:43.774760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7955899238586426e-06, "l2_diff": 0.0283203125, "l2_diff_relative": 0.003146701388888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:52.678093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293322287689462, "overlap_percentage": 0.9633719013359638, "num_intersection": 2875195, "num_union": 3093829, "num_only_computed": 217285, "num_only_roped": 1349, "total_diff": 218634, "diff_percentage": 0.07066777123105382, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:17:54.059934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.016791044776119403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:18:14.748155", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.947446990105149, "overlap_percentage": 0.9730144080111708, "num_intersection": 3835327, "num_union": 4048065, "num_only_computed": 201281, "num_only_roped": 11457, "total_diff": 212738, "diff_percentage": 0.052553009894851, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:18:15.487997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.2177734375, "l2_diff_relative": 0.026198308270676693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:18:42.408356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548275727222448, "overlap_percentage": 0.9768918609967993, "num_intersection": 4785676, "num_union": 5012084, "num_only_computed": 195060, "num_only_roped": 31348, "total_diff": 226408, "diff_percentage": 0.04517242727775512, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:18:43.344269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.0178125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:19:16.021329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.956631855993354, "overlap_percentage": 0.9778353072021162, "num_intersection": 5725390, "num_union": 5984946, "num_only_computed": 198450, "num_only_roped": 61106, "total_diff": 259556, "diff_percentage": 0.04336814400664601, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:19:17.520807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.5033950805664062e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.016087962962962964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:19:56.775184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9555960255109994, "overlap_percentage": 0.9772938920361133, "num_intersection": 6657670, "num_union": 6967034, "num_only_computed": 210298, "num_only_roped": 99066, "total_diff": 309364, "diff_percentage": 0.04440397448900063, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:19:59.923186", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.4139881134033203e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.019240196078431374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:20:45.806646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9527870672198102, "overlap_percentage": 0.9758227952382914, "num_intersection": 7580816, "num_union": 7956464, "num_only_computed": 230256, "num_only_roped": 145392, "total_diff": 375648, "diff_percentage": 0.047212932780189794, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:20:47.369090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.8477439880371094e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.015208333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:21:40.366905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9471557251683544, "overlap_percentage": 0.9728607865572352, "num_intersection": 8489012, "num_union": 8962636, "num_only_computed": 266188, "num_only_roped": 207436, "total_diff": 473624, "diff_percentage": 0.05284427483164551, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:21:42.195408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 2.7298927307128906e-05, "l2_diff": 1.40625, "l2_diff_relative": 0.1717557251908397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:22:43.164582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9411281166552283, "overlap_percentage": 0.969671304619391, "num_intersection": 9389335, "num_union": 9976681, "num_only_computed": 309993, "num_only_roped": 277353, "total_diff": 587346, "diff_percentage": 0.058871883344771676, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:22:46.875138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 6.389617919921875e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.49171270718232046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:23:55.654466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9342354512975045, "overlap_percentage": 0.965999719083641, "num_intersection": 10274970, "num_union": 10998266, "num_only_computed": 367462, "num_only_roped": 355834, "total_diff": 723296, "diff_percentage": 0.06576454870249547, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:23:58.038477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.458427429199219e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.33589743589743587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:25:15.080751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9263338633585687, "overlap_percentage": 0.9617583753041676, "num_intersection": 11142858, "num_union": 12028987, "num_only_computed": 443702, "num_only_roped": 442427, "total_diff": 886129, "diff_percentage": 0.07366613664143123, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:25:19.173235", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10693359375, "mean_diff": 4.0531158447265625e-05, "l2_diff": 1.84375, "l2_diff_relative": 0.3010204081632653}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:26:45.293890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9166937874127665, "overlap_percentage": 0.9565365040914106, "num_intersection": 11985081, "num_union": 13074247, "num_only_computed": 544583, "num_only_roped": 544583, "total_diff": 1089166, "diff_percentage": 0.08330621258723352, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:26:48.219263", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.27717391304347827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:28:23.314194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.901593969018099, "overlap_percentage": 0.9482507661545048, "num_intersection": 10897734, "num_union": 12087186, "num_only_computed": 594726, "num_only_roped": 594726, "total_diff": 1189452, "diff_percentage": 0.098406030981901, "num_computed": 11492460, "num_roped": 11492460}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:28:26.392705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11865234375, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.31725888324873097}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:29:59.648284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8525003484143977, "overlap_percentage": 0.9203780707993653, "num_intersection": 336435, "num_union": 394645, "num_only_computed": 29105, "num_only_roped": 29105, "total_diff": 58210, "diff_percentage": 0.14749965158560224, "num_computed": 365540, "num_roped": 365540}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "mask_shape": [1, 32, 28, 14222], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:30:02.590127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.11376953125, "l2_diff_relative": 0.08934049079754601}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "attention_shape": [1, 32, 28, 14222]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:31:31.001227", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8478522397565635, "overlap_percentage": 0.9176623774509803, "num_intersection": 11981, "num_union": 14131, "num_only_computed": 1075, "num_only_roped": 1075, "total_diff": 2150, "diff_percentage": 0.1521477602434364, "num_computed": 13056, "num_roped": 13056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "mask_shape": [1, 32, 1, 14223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:31:34.715815", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 3.039836883544922e-05, "l2_diff": 0.060546875, "l2_diff_relative": 0.36904761904761907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "attention_shape": [1, 32, 1, 14223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:33:01.278213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8538974868663921, "overlap_percentage": 0.9211916979398024, "num_intersection": 12028, "num_union": 14086, "num_only_computed": 1029, "num_only_roped": 1029, "total_diff": 2058, "diff_percentage": 0.14610251313360784, "num_computed": 13057, "num_roped": 13057}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "mask_shape": [1, 32, 1, 14224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:33:04.123303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0118408203125, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.02734375, "l2_diff_relative": 0.11522633744855967}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "attention_shape": [1, 32, 1, 14224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:34:31.367197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8510170812956269, "overlap_percentage": 0.9195129422576198, "num_intersection": 12007, "num_union": 14109, "num_only_computed": 1051, "num_only_roped": 1051, "total_diff": 2102, "diff_percentage": 0.1489829187043731, "num_computed": 13058, "num_roped": 13058}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 1, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:34:34.326794", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.22844827586206898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 1, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:35:59.814988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8498477229265529, "overlap_percentage": 0.9188299257217245, "num_intersection": 11999, "num_union": 14119, "num_only_computed": 1060, "num_only_roped": 1060, "total_diff": 2120, "diff_percentage": 0.15015227707344714, "num_computed": 13059, "num_roped": 13059}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:36:02.583620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.2901763916015625e-05, "l2_diff": 0.0242919921875, "l2_diff_relative": 0.12822164948453607}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:37:27.700008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.849727356419517, "overlap_percentage": 0.9187595712098009, "num_intersection": 11999, "num_union": 14121, "num_only_computed": 1061, "num_only_roped": 1061, "total_diff": 2122, "diff_percentage": 0.15027264358048298, "num_computed": 13060, "num_roped": 13060}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:37:31.549930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.0201416015625, "l2_diff_relative": 0.10160098522167488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:38:58.056516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8518360981142776, "overlap_percentage": 0.9199908123420871, "num_intersection": 12016, "num_union": 14106, "num_only_computed": 1045, "num_only_roped": 1045, "total_diff": 2090, "diff_percentage": 0.1481639018857224, "num_computed": 13061, "num_roped": 13061}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:39:00.812060", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.11288759689922481}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:39:47.144961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:39:47.155501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003115110759493671}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:39:47.577778", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:39:47.587216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7136335372924805e-06, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.0028993594720496895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:39:56.514751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293259927229568, "overlap_percentage": 0.9633685507044367, "num_intersection": 2875185, "num_union": 3093839, "num_only_computed": 217295, "num_only_roped": 1359, "total_diff": 218654, "diff_percentage": 0.07067400727704318, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:39:57.070353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:40:18.031621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474585361166056, "overlap_percentage": 0.9730204967607852, "num_intersection": 3835351, "num_union": 4048041, "num_only_computed": 201257, "num_only_roped": 11433, "total_diff": 212690, "diff_percentage": 0.05254146388339446, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:40:20.600641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.27501106262207e-06, "l2_diff": 0.2421875, "l2_diff_relative": 0.02549342105263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:40:48.277221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.954726172026501, "overlap_percentage": 0.9768387876412568, "num_intersection": 4785416, "num_union": 5012344, "num_only_computed": 195320, "num_only_roped": 31608, "total_diff": 226928, "diff_percentage": 0.04527382797349903, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:40:49.213285", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.018816021126760563}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:41:22.358808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9567583843688399, "overlap_percentage": 0.9779014026583012, "num_intersection": 5725777, "num_union": 5984559, "num_only_computed": 198063, "num_only_roped": 60719, "total_diff": 258782, "diff_percentage": 0.04324161563116012, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:41:23.501396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.014774659863945579}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:42:04.081338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9557521031430803, "overlap_percentage": 0.9773755084881111, "num_intersection": 6658226, "num_union": 6966478, "num_only_computed": 209742, "num_only_roped": 98510, "total_diff": 308252, "diff_percentage": 0.04424789685691967, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:42:05.431696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.1904706954956055e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.016312893081761006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:42:51.906642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9524040198416064, "overlap_percentage": 0.9756218591671129, "num_intersection": 7579255, "num_union": 7958025, "num_only_computed": 231817, "num_only_roped": 146953, "total_diff": 378770, "diff_percentage": 0.04759598015839357, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:42:54.238963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9371509552001953e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.016160102739726026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:43:47.843184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.947884663079028, "overlap_percentage": 0.973245162863702, "num_intersection": 8492366, "num_union": 8959282, "num_only_computed": 262834, "num_only_roped": 204082, "total_diff": 466916, "diff_percentage": 0.05211533692097201, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:43:50.649671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.20424107142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:44:44.599755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8752921751758024, "overlap_percentage": 0.933499522647714, "num_intersection": 176002, "num_union": 201078, "num_only_computed": 12538, "num_only_roped": 12538, "total_diff": 25076, "diff_percentage": 0.12470782482419758, "num_computed": 188540, "num_roped": 188540}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "mask_shape": [1, 32, 22, 9238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:44:46.329474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.1494140625, "l2_diff_relative": 0.10991379310344827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "attention_shape": [1, 32, 22, 9238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:45:38.067640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8746288798920377, "overlap_percentage": 0.9331221654308545, "num_intersection": 466632, "num_union": 533520, "num_only_computed": 33444, "num_only_roped": 33444, "total_diff": 66888, "diff_percentage": 0.12537112010796223, "num_computed": 500076, "num_roped": 500076}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "mask_shape": [1, 32, 58, 9296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:45:41.875657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.35546875, "l2_diff_relative": 0.20495495495495494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "attention_shape": [1, 32, 58, 9296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:46:32.609415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8628213437027435, "overlap_percentage": 0.9263597355908616, "num_intersection": 7988, "num_union": 9258, "num_only_computed": 635, "num_only_roped": 635, "total_diff": 1270, "diff_percentage": 0.13717865629725642, "num_computed": 8623, "num_roped": 8623}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "mask_shape": [1, 32, 1, 9297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:46:34.505129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 8.249282836914062e-05, "l2_diff": 0.055908203125, "l2_diff_relative": 0.6505681818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "attention_shape": [1, 32, 1, 9297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:47:25.969504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8664646683259387, "overlap_percentage": 0.9284554730983302, "num_intersection": 8007, "num_union": 9241, "num_only_computed": 617, "num_only_roped": 617, "total_diff": 1234, "diff_percentage": 0.13353533167406126, "num_computed": 8624, "num_roped": 8624}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "mask_shape": [1, 32, 1, 9298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:47:27.680965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 5.602836608886719e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.32386363636363635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "attention_shape": [1, 32, 1, 9298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:48:18.767145", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8691082457471015, "overlap_percentage": 0.9299710144927537, "num_intersection": 8021, "num_union": 9229, "num_only_computed": 604, "num_only_roped": 604, "total_diff": 1208, "diff_percentage": 0.13089175425289848, "num_computed": 8625, "num_roped": 8625}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9299, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9299, 128], "mask_shape": [1, 32, 1, 9299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:48:20.368907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 6.079673767089844e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.4011299435028249}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9299, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9299, 128], "attention_shape": [1, 32, 1, 9299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:48:50.696742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:48:50.710392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0031115301724137933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:48:51.133109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:48:51.144487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.952052116394043e-06, "l2_diff": 0.0250244140625, "l2_diff_relative": 0.003177703373015873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:49:00.057862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293278635325208, "overlap_percentage": 0.9633695558938948, "num_intersection": 2875188, "num_union": 3093836, "num_only_computed": 217292, "num_only_roped": 1356, "total_diff": 218648, "diff_percentage": 0.0706721364674792, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:49:00.612280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.1162109375, "l2_diff_relative": 0.015303497942386831}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:49:21.541030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.947452282010072, "overlap_percentage": 0.9730171986880775, "num_intersection": 3835338, "num_union": 4048054, "num_only_computed": 201270, "num_only_roped": 11446, "total_diff": 212716, "diff_percentage": 0.052547717989928, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:49:23.237220", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.2001953125, "l2_diff_relative": 0.025727911646586346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:49:50.826040", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547792110782314, "overlap_percentage": 0.9768665490887714, "num_intersection": 4785552, "num_union": 5012208, "num_only_computed": 195184, "num_only_roped": 31472, "total_diff": 226656, "diff_percentage": 0.04522078892176861, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:49:51.763454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.1591796875, "l2_diff_relative": 0.020133399209486168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:50:25.177823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9564831161688248, "overlap_percentage": 0.9777575980740433, "num_intersection": 5724935, "num_union": 5985401, "num_only_computed": 198905, "num_only_roped": 61561, "total_diff": 260466, "diff_percentage": 0.04351688383117522, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:50:26.317446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.0171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:51:07.106427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9552898376536012, "overlap_percentage": 0.9771337417678946, "num_intersection": 6656579, "num_union": 6968125, "num_only_computed": 211389, "num_only_roped": 100157, "total_diff": 311546, "diff_percentage": 0.04471016234639878, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:51:08.451160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.018606870229007633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:51:55.027108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9525936843523367, "overlap_percentage": 0.9757213617827574, "num_intersection": 7580028, "num_union": 7957252, "num_only_computed": 231044, "num_only_roped": 146180, "total_diff": 377224, "diff_percentage": 0.04740631564766329, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:51:57.296805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.9669532775878906e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.017221715328467155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:52:50.884486", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.947631624586544, "overlap_percentage": 0.9731117657197762, "num_intersection": 8491202, "num_union": 8960446, "num_only_computed": 263998, "num_only_roped": 205246, "total_diff": 469244, "diff_percentage": 0.05236837541345598, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:52:52.700798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11572265625, "mean_diff": 2.9325485229492188e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.16820276497695852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:53:53.700380", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9426270463095383, "overlap_percentage": 0.9704663055116757, "num_intersection": 9397033, "num_union": 9968983, "num_only_computed": 302295, "num_only_roped": 269655, "total_diff": 571950, "diff_percentage": 0.057372953690461706, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:53:55.788725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10498046875, "mean_diff": 5.6743621826171875e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.44135802469135804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:55:06.412028", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.936856960243568, "overlap_percentage": 0.9673992240766754, "num_intersection": 10289856, "num_union": 10983380, "num_only_computed": 352576, "num_only_roped": 340948, "total_diff": 693524, "diff_percentage": 0.06314303975643198, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:55:11.215481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.953125, "l2_diff_relative": 0.294811320754717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:56:29.552971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9278222418196793, "overlap_percentage": 0.9625599515273816, "num_intersection": 11152145, "num_union": 12019700, "num_only_computed": 434415, "num_only_roped": 433140, "total_diff": 867555, "diff_percentage": 0.07217775818032064, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:56:32.699204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.886222839355469e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.3014018691588785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:57:57.763572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9175040987175334, "overlap_percentage": 0.9569774576556881, "num_intersection": 11990606, "num_union": 13068722, "num_only_computed": 539058, "num_only_roped": 539058, "total_diff": 1078116, "diff_percentage": 0.08249590128246664, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:58:00.657219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09619140625, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.32865168539325845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:59:33.641659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9079393038236336, "overlap_percentage": 0.9517486242922557, "num_intersection": 12823663, "num_union": 14123921, "num_only_computed": 650129, "num_only_roped": 650129, "total_diff": 1300258, "diff_percentage": 0.09206069617636632, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T10:59:36.788989", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11083984375, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.3100558659217877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:01:19.539750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9018048317692073, "overlap_percentage": 0.9483673789284446, "num_intersection": 13673485, "num_union": 15162355, "num_only_computed": 744435, "num_only_roped": 744435, "total_diff": 1488870, "diff_percentage": 0.09819516823079265, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:01:24.011869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10107421875, "mean_diff": 4.0531158447265625e-05, "l2_diff": 1.8828125, "l2_diff_relative": 0.35441176470588237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:03:14.924356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8913017502735007, "overlap_percentage": 0.9425272832794764, "num_intersection": 12927101, "num_union": 14503619, "num_only_computed": 788259, "num_only_roped": 788259, "total_diff": 1576518, "diff_percentage": 0.1086982497264993, "num_computed": 13715360, "num_roped": 13715360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "mask_shape": [1, 32, 920, 16280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:03:18.983973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10986328125, "mean_diff": 4.2438507080078125e-05, "l2_diff": 2.109375, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "attention_shape": [1, 32, 920, 16280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:05:08.116774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8461051188211551, "overlap_percentage": 0.916638072442421, "num_intersection": 438109, "num_union": 517795, "num_only_computed": 39843, "num_only_roped": 39843, "total_diff": 79686, "diff_percentage": 0.15389488117884492, "num_computed": 477952, "num_roped": 477952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "mask_shape": [1, 32, 32, 16312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:05:11.538786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.1474609375, "l2_diff_relative": 0.11651234567901235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "attention_shape": [1, 32, 32, 16312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:06:54.377960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8443017656500803, "overlap_percentage": 0.9155787641427328, "num_intersection": 13676, "num_union": 16198, "num_only_computed": 1261, "num_only_roped": 1261, "total_diff": 2522, "diff_percentage": 0.15569823434991975, "num_computed": 14937, "num_roped": 14937}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "mask_shape": [1, 32, 1, 16313], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:06:58.315988", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.025634765625, "l2_diff_relative": 0.12681159420289856}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "attention_shape": [1, 32, 1, 16313]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:08:38.974694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8412424503882657, "overlap_percentage": 0.9137769447047798, "num_intersection": 13650, "num_union": 16226, "num_only_computed": 1288, "num_only_roped": 1288, "total_diff": 2576, "diff_percentage": 0.15875754961173424, "num_computed": 14938, "num_roped": 14938}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "mask_shape": [1, 32, 1, 16314], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:08:42.232433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.022216796875, "l2_diff_relative": 0.07338709677419354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "attention_shape": [1, 32, 1, 16314]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:09:36.739914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:09:36.748318", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031398338607594935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:09:37.170210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:09:37.179640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8551945686340332e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.003246038732394366}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:09:46.066870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.92933597041589, "overlap_percentage": 0.9633739117148801, "num_intersection": 2875201, "num_union": 3093823, "num_only_computed": 217279, "num_only_roped": 1343, "total_diff": 218622, "diff_percentage": 0.07066402958411001, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:09:46.608623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.015190972222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:10:08.585833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475282961815225, "overlap_percentage": 0.9730572829563721, "num_intersection": 3835496, "num_union": 4047896, "num_only_computed": 201112, "num_only_roped": 11288, "total_diff": 212400, "diff_percentage": 0.05247170381847755, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:10:09.351308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.234375, "l2_diff_relative": 0.025684931506849314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:10:41.644264", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.955036257252997, "overlap_percentage": 0.9770010696322424, "num_intersection": 4786211, "num_union": 5011549, "num_only_computed": 194525, "num_only_roped": 30813, "total_diff": 225338, "diff_percentage": 0.044963742747002974, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:10:42.581599", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.019110576923076925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:11:16.036647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9572996658478893, "overlap_percentage": 0.9781840589373354, "num_intersection": 5727432, "num_union": 5982904, "num_only_computed": 196408, "num_only_roped": 59064, "total_diff": 255472, "diff_percentage": 0.04270033415211075, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:11:17.168705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.5033950805664062e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:11:57.015686", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9559250527788233, "overlap_percentage": 0.9774659324709, "num_intersection": 6658842, "num_union": 6965862, "num_only_computed": 209126, "num_only_roped": 97894, "total_diff": 307020, "diff_percentage": 0.04407494722117665, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:11:58.328392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.3990869522094727e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.018547661870503596}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:12:44.455351", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9523144756665607, "overlap_percentage": 0.9755748753964658, "num_intersection": 7578890, "num_union": 7958390, "num_only_computed": 232182, "num_only_roped": 147318, "total_diff": 379500, "diff_percentage": 0.047685524333439304, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:12:46.937119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.952052116394043e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.016983695652173912}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:13:40.414030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475529438863103, "overlap_percentage": 0.9730702796664247, "num_intersection": 8490840, "num_union": 8960808, "num_only_computed": 264360, "num_only_roped": 205608, "total_diff": 469968, "diff_percentage": 0.05244705611368975, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:13:42.963721", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.13755458515283842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:14:39.659627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9073440488817572, "overlap_percentage": 0.9514214799513673, "num_intersection": 4003456, "num_union": 4412280, "num_only_computed": 204412, "num_only_roped": 204412, "total_diff": 408824, "diff_percentage": 0.09265595111824272, "num_computed": 4207868, "num_roped": 4207868}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "mask_shape": [1, 32, 469, 9685], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:14:41.552744", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "attention_shape": [1, 32, 469, 9685]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:15:37.330853", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8727745965642895, "overlap_percentage": 0.9320658216588837, "num_intersection": 201192, "num_union": 230520, "num_only_computed": 14664, "num_only_roped": 14664, "total_diff": 29328, "diff_percentage": 0.12722540343571057, "num_computed": 215856, "num_roped": 215856}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "mask_shape": [1, 32, 24, 9709], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:15:39.102683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.09033203125, "l2_diff_relative": 0.07606907894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "attention_shape": [1, 32, 24, 9709]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:16:33.606716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8739583333333333, "overlap_percentage": 0.9327404113396331, "num_intersection": 8390, "num_union": 9600, "num_only_computed": 605, "num_only_roped": 605, "total_diff": 1210, "diff_percentage": 0.12604166666666666, "num_computed": 8995, "num_roped": 8995}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 1, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:16:35.387783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0037841796875, "mean_diff": 9.59634780883789e-06, "l2_diff": 0.0096435546875, "l2_diff_relative": 0.04131799163179916}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 1, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:17:28.447058", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8710348413936557, "overlap_percentage": 0.9310728182323513, "num_intersection": 8375, "num_union": 9615, "num_only_computed": 620, "num_only_roped": 620, "total_diff": 1240, "diff_percentage": 0.12896515860634425, "num_computed": 8995, "num_roped": 8995}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "mask_shape": [1, 32, 1, 9711], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:17:30.184977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.2218952178955078e-05, "l2_diff": 0.0140380859375, "l2_diff_relative": 0.054450757575757576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "attention_shape": [1, 32, 1, 9711]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:17:58.627659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:17:58.635996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.029541015625, "l2_diff_relative": 0.0030298477564102565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:17:59.057240", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:17:59.065997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7955899238586426e-06, "l2_diff": 0.027587890625, "l2_diff_relative": 0.0031084947183098594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:18:08.063495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293515607677036, "overlap_percentage": 0.9633822882936975, "num_intersection": 2875226, "num_union": 3093798, "num_only_computed": 217254, "num_only_roped": 1318, "total_diff": 218572, "diff_percentage": 0.07064843923229636, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:18:08.625562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.1181640625, "l2_diff_relative": 0.015821129707112972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:18:25.954420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.973011200733973, "overlap_percentage": 0.9863210106176858, "num_intersection": 50906, "num_union": 52318, "num_only_computed": 706, "num_only_roped": 706, "total_diff": 1412, "diff_percentage": 0.02698879926602699, "num_computed": 51612, "num_roped": 51612}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "mask_shape": [1, 32, 17, 3089], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:18:26.480201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 3.844499588012695e-06, "l2_diff": 0.01495361328125, "l2_diff_relative": 0.013200431034482759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "attention_shape": [1, 32, 17, 3089]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:18:42.970375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9731322177704455, "overlap_percentage": 0.9863831820353559, "num_intersection": 78451, "num_union": 80617, "num_only_computed": 1083, "num_only_roped": 1083, "total_diff": 2166, "diff_percentage": 0.02686778222955456, "num_computed": 79534, "num_roped": 79534}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "mask_shape": [1, 32, 26, 3115], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:18:43.511558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 3.9637088775634766e-06, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.013814786585365854}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "attention_shape": [1, 32, 26, 3115]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:00.111046", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9672131147540983, "overlap_percentage": 0.9833333333333333, "num_intersection": 3009, "num_union": 3111, "num_only_computed": 51, "num_only_roped": 51, "total_diff": 102, "diff_percentage": 0.03278688524590164, "num_computed": 3060, "num_roped": 3060}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "mask_shape": [1, 32, 1, 3116], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:02.242322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00048828125, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.00135040283203125, "l2_diff_relative": 0.004267939814814815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "attention_shape": [1, 32, 1, 3116]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:18.539225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9659601798330122, "overlap_percentage": 0.9826853969291082, "num_intersection": 3008, "num_union": 3114, "num_only_computed": 53, "num_only_roped": 53, "total_diff": 106, "diff_percentage": 0.0340398201669878, "num_computed": 3061, "num_roped": 3061}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "mask_shape": [1, 32, 1, 3117], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:19.055389", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.00170135498046875, "l2_diff_relative": 0.008416364734299516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "attention_shape": [1, 32, 1, 3117]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:35.512428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9653401797175867, "overlap_percentage": 0.9823644676681907, "num_intersection": 3008, "num_union": 3116, "num_only_computed": 54, "num_only_roped": 54, "total_diff": 108, "diff_percentage": 0.03465982028241335, "num_computed": 3062, "num_roped": 3062}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3118, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3118, 128], "mask_shape": [1, 32, 1, 3118], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:36.042322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 4.0531158447265625e-06, "l2_diff": 0.0034332275390625, "l2_diff_relative": 0.013950892857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3118, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3118, 128], "attention_shape": [1, 32, 1, 3118]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:48.993155", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:49.006840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.003087197580645161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:49.431935", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:49.443358", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8998980522155762e-06, "l2_diff": 0.0250244140625, "l2_diff_relative": 0.0030564169847328245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:58.528854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293322287689462, "overlap_percentage": 0.9633719013359638, "num_intersection": 2875195, "num_union": 3093829, "num_only_computed": 217285, "num_only_roped": 1349, "total_diff": 218634, "diff_percentage": 0.07066777123105382, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:19:59.082520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.11865234375, "l2_diff_relative": 0.015434451219512195}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:20:19.821960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9473887810490921, "overlap_percentage": 0.9729837105651983, "num_intersection": 3835206, "num_union": 4048186, "num_only_computed": 201402, "num_only_roped": 11578, "total_diff": 212980, "diff_percentage": 0.05261121895090789, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:20:20.554295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.212890625, "l2_diff_relative": 0.02640503875968992}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:20:47.338433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547097929010255, "overlap_percentage": 0.9768302142530537, "num_intersection": 4785374, "num_union": 5012386, "num_only_computed": 195362, "num_only_roped": 31650, "total_diff": 227012, "diff_percentage": 0.04529020709897442, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:20:48.270596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.0208740234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:21:21.222424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9567109751793906, "overlap_percentage": 0.9778766382108933, "num_intersection": 5725632, "num_union": 5984704, "num_only_computed": 198208, "num_only_roped": 60864, "total_diff": 259072, "diff_percentage": 0.04328902482060934, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:21:22.358585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.12451171875, "l2_diff_relative": 0.014229910714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:22:01.979732", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9552693537123945, "overlap_percentage": 0.9771230259387653, "num_intersection": 6656506, "num_union": 6968198, "num_only_computed": 211462, "num_only_roped": 100230, "total_diff": 311692, "diff_percentage": 0.04473064628760549, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:22:04.235463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.01764838129496403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:22:50.485849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9514381125059094, "overlap_percentage": 0.975114820612102, "num_intersection": 7575316, "num_union": 7961964, "num_only_computed": 235756, "num_only_roped": 150892, "total_diff": 386648, "diff_percentage": 0.048561887494090655, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:22:52.026394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.9371509552001953e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.015746124031007752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:23:45.297027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.94733388857794, "overlap_percentage": 0.9729547604902414, "num_intersection": 8489832, "num_union": 8961816, "num_only_computed": 265368, "num_only_roped": 206616, "total_diff": 471984, "diff_percentage": 0.05266611142205999, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:23:47.101803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 3.0159950256347656e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.15638297872340426}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:24:47.923401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9414517347236867, "overlap_percentage": 0.9698430487716214, "num_intersection": 9390998, "num_union": 9975018, "num_only_computed": 308330, "num_only_roped": 275690, "total_diff": 584020, "diff_percentage": 0.05854826527631329, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:24:51.101515", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 5.626678466796875e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.41509433962264153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:26:00.052400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9343872366957908, "overlap_percentage": 0.9660808538954769, "num_intersection": 10275833, "num_union": 10997403, "num_only_computed": 366599, "num_only_roped": 354971, "total_diff": 721570, "diff_percentage": 0.06561276330420919, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:26:02.409925", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.4051724137931034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:27:19.477559", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9254915699351077, "overlap_percentage": 0.9613042034417199, "num_intersection": 11137596, "num_union": 12034249, "num_only_computed": 448964, "num_only_roped": 447689, "total_diff": 896653, "diff_percentage": 0.07450843006489229, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:27:24.464147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 4.649162292480469e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.35049019607843135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:28:48.712462", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9181111441265724, "overlap_percentage": 0.9573075542967473, "num_intersection": 11994742, "num_union": 13064586, "num_only_computed": 534922, "num_only_roped": 534922, "total_diff": 1069844, "diff_percentage": 0.0818888558734276, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:28:51.596489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 4.1961669921875e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.3094170403587444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:30:24.207857", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9095882324804374, "overlap_percentage": 0.9526537889259385, "num_intersection": 12835859, "num_union": 14111725, "num_only_computed": 637933, "num_only_roped": 637933, "total_diff": 1275866, "diff_percentage": 0.09041176751956263, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:30:27.314219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.5, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:32:08.998366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9013352147223083, "overlap_percentage": 0.9481076327237216, "num_intersection": 13669740, "num_union": 15166100, "num_only_computed": 748180, "num_only_roped": 748180, "total_diff": 1496360, "diff_percentage": 0.0986647852776917, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:32:13.463626", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.5568862275449101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:34:02.606577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8862893667640596, "overlap_percentage": 0.9397172908677253, "num_intersection": 11432204, "num_union": 12898952, "num_only_computed": 733374, "num_only_roped": 733374, "total_diff": 1466748, "diff_percentage": 0.11371063323594041, "num_computed": 12165578, "num_roped": 12165578}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "mask_shape": [1, 32, 821, 16181], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:34:07.975219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 4.267692565917969e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.44}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "attention_shape": [1, 32, 821, 16181]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:35:56.553393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8444468833672597, "overlap_percentage": 0.915664084427978, "num_intersection": 407791, "num_union": 482909, "num_only_computed": 37559, "num_only_roped": 37559, "total_diff": 75118, "diff_percentage": 0.15555311663274032, "num_computed": 445350, "num_roped": 445350}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "mask_shape": [1, 32, 30, 16211], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:35:59.901357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.16796875, "l2_diff_relative": 0.14527027027027026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "attention_shape": [1, 32, 30, 16211]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:37:41.249976", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8435365702222775, "overlap_percentage": 0.9151286541829449, "num_intersection": 13586, "num_union": 16106, "num_only_computed": 1260, "num_only_roped": 1260, "total_diff": 2520, "diff_percentage": 0.1564634297777226, "num_computed": 14846, "num_roped": 14846}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "mask_shape": [1, 32, 1, 16212], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:37:45.767936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014404296875, "mean_diff": 3.0279159545898438e-05, "l2_diff": 0.029541015625, "l2_diff_relative": 0.16530054644808742}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "attention_shape": [1, 32, 1, 16212]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:38:43.380193", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:38:43.393830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:38:43.818960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:38:43.829437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.773238182067871e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.003200954861111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:38:52.803163", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293515607677036, "overlap_percentage": 0.9633822882936975, "num_intersection": 2875226, "num_union": 3093798, "num_only_computed": 217254, "num_only_roped": 1318, "total_diff": 218572, "diff_percentage": 0.07064843923229636, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:38:53.345835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.016487068965517243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:39:16.614391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474518009266178, "overlap_percentage": 0.9730169449901768, "num_intersection": 3835337, "num_union": 4048055, "num_only_computed": 201271, "num_only_roped": 11447, "total_diff": 212718, "diff_percentage": 0.05254819907338216, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:39:17.360020", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.27501106262207e-06, "l2_diff": 0.255859375, "l2_diff_relative": 0.02481060606060606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:39:44.287539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548681359462727, "overlap_percentage": 0.9769130903390163, "num_intersection": 4785780, "num_union": 5011980, "num_only_computed": 194956, "num_only_roped": 31244, "total_diff": 226200, "diff_percentage": 0.045131864053727266, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:39:45.225300", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.018581081081081082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:40:18.453578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9573814564572847, "overlap_percentage": 0.9782267562604523, "num_intersection": 5727682, "num_union": 5982654, "num_only_computed": 196158, "num_only_roped": 58814, "total_diff": 254972, "diff_percentage": 0.042618543542715326, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:40:21.006477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.4139881134033203e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.015282846715328468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:41:01.077783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9561241511851929, "overlap_percentage": 0.977570008126415, "num_intersection": 6659551, "num_union": 6965153, "num_only_computed": 208417, "num_only_roped": 97185, "total_diff": 305602, "diff_percentage": 0.043875848814807085, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:41:02.639473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.3245811462402344e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.017701048951048952}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:41:48.840309", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9520633051629178, "overlap_percentage": 0.9754430633933353, "num_intersection": 7577866, "num_union": 7959414, "num_only_computed": 233206, "num_only_roped": 148342, "total_diff": 381548, "diff_percentage": 0.047936694837082225, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:41:50.374926", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.016077898550724636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:42:43.324491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.946489205254913, "overlap_percentage": 0.9725090719226058, "num_intersection": 8485943, "num_union": 8965705, "num_only_computed": 269257, "num_only_roped": 210505, "total_diff": 479762, "diff_percentage": 0.05351079474508697, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:42:45.127976", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 2.956390380859375e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.17669172932330826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:43:45.896411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9399946506439764, "overlap_percentage": 0.9690693222601903, "num_intersection": 9383506, "num_union": 9982510, "num_only_computed": 315822, "num_only_roped": 283182, "total_diff": 599004, "diff_percentage": 0.06000534935602368, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:43:49.455545", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 4.57763671875e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.30855855855855857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:44:57.896316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9327947649672047, "overlap_percentage": 0.9652289853786231, "num_intersection": 10266772, "num_union": 11006464, "num_only_computed": 375660, "num_only_roped": 364032, "total_diff": 739692, "diff_percentage": 0.06720523503279527, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:45:00.246579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 5.53131103515625e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.43434343434343436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:46:17.385345", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9242191236207782, "overlap_percentage": 0.9606173353912906, "num_intersection": 11129638, "num_union": 12042207, "num_only_computed": 456922, "num_only_roped": 455647, "total_diff": 912569, "diff_percentage": 0.07578087637922185, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:46:20.519134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.75, "l2_diff_relative": 0.4536082474226804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:47:45.206926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9158082886541506, "overlap_percentage": 0.9560542086364008, "num_intersection": 11979038, "num_union": 13080290, "num_only_computed": 550626, "num_only_roped": 550626, "total_diff": 1101252, "diff_percentage": 0.08419171134584937, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:47:48.103766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.4195121951219512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:49:21.255588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9084922345730958, "overlap_percentage": 0.9520523249876501, "num_intersection": 12827755, "num_union": 14119829, "num_only_computed": 646037, "num_only_roped": 646037, "total_diff": 1292074, "diff_percentage": 0.09150776542690425, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:49:24.407611", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 4.482269287109375e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.3916256157635468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:51:06.994189", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9020290004965513, "overlap_percentage": 0.9484913219105113, "num_intersection": 13675272, "num_union": 15160568, "num_only_computed": 742648, "num_only_roped": 742648, "total_diff": 1485296, "diff_percentage": 0.09797099950344869, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:51:11.129002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 3.933906555175781e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.3944723618090452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:53:02.253901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.892699452080436, "overlap_percentage": 0.9433081951803703, "num_intersection": 13592041, "num_union": 15225775, "num_only_computed": 816867, "num_only_roped": 816867, "total_diff": 1633734, "diff_percentage": 0.10730054791956403, "num_computed": 14408908, "num_roped": 14408908}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:53:05.880631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.2923076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:54:54.651329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8429542563522712, "overlap_percentage": 0.9147858699658846, "num_intersection": 369772, "num_union": 438662, "num_only_computed": 34445, "num_only_roped": 34445, "total_diff": 68890, "diff_percentage": 0.15704574364772877, "num_computed": 404217, "num_roped": 404217}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 27, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:54:58.060270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.126953125, "l2_diff_relative": 0.09969325153374232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 27, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:56:40.887888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.838973162193699, "overlap_percentage": 0.9124365482233503, "num_intersection": 13661, "num_union": 16283, "num_only_computed": 1311, "num_only_roped": 1311, "total_diff": 2622, "diff_percentage": 0.16102683780630106, "num_computed": 14972, "num_roped": 14972}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:56:44.654423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0147705078125, "mean_diff": 2.777576446533203e-05, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.21982758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:58:25.644347", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8377416385394293, "overlap_percentage": 0.9117077405997462, "num_intersection": 13651, "num_union": 16295, "num_only_computed": 1322, "num_only_roped": 1322, "total_diff": 2644, "diff_percentage": 0.16225836146057074, "num_computed": 14973, "num_roped": 14973}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T11:58:28.915304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.024169921875, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.19398907103825136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:00:10.416221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8387671148768957, "overlap_percentage": 0.912314678776546, "num_intersection": 13661, "num_union": 16287, "num_only_computed": 1313, "num_only_roped": 1313, "total_diff": 2626, "diff_percentage": 0.16123288512310432, "num_computed": 14974, "num_roped": 14974}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:00:16.108095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.12447916666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:01:56.864365", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8397935991154247, "overlap_percentage": 0.9129215358931553, "num_intersection": 13671, "num_union": 16279, "num_only_computed": 1304, "num_only_roped": 1304, "total_diff": 2608, "diff_percentage": 0.16020640088457522, "num_computed": 14975, "num_roped": 14975}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:02:00.137167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.037841796875, "l2_diff_relative": 0.1374113475177305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:02:58.607742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:02:59.356451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.003022989649681529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:02:59.819178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:02:59.828639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.0279541015625, "l2_diff_relative": 0.003288717830882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:03:08.779306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293440773673884, "overlap_percentage": 0.9633782675358652, "num_intersection": 2875214, "num_union": 3093810, "num_only_computed": 217266, "num_only_roped": 1330, "total_diff": 218596, "diff_percentage": 0.07065592263261157, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:03:09.335563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.470348358154297e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.014331896551724137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:03:30.041997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474556496009063, "overlap_percentage": 0.9730189745733816, "num_intersection": 3835345, "num_union": 4048047, "num_only_computed": 201263, "num_only_roped": 11439, "total_diff": 212702, "diff_percentage": 0.052544350399093685, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:03:30.767377", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.23828125, "l2_diff_relative": 0.026475694444444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:03:57.554225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548189922559499, "overlap_percentage": 0.9768873701744072, "num_intersection": 4785654, "num_union": 5012106, "num_only_computed": 195082, "num_only_roped": 31370, "total_diff": 226452, "diff_percentage": 0.04518100774405011, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:03:58.469063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.020552884615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:04:31.235213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.95691141728961, "overlap_percentage": 0.9779813320471761, "num_intersection": 5726245, "num_union": 5984091, "num_only_computed": 197595, "num_only_roped": 60251, "total_diff": 257846, "diff_percentage": 0.043088582710389935, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:04:32.373619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.473592758178711e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.016199448529411766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:05:11.819045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.955284225572229, "overlap_percentage": 0.9771308059242975, "num_intersection": 6656559, "num_union": 6968145, "num_only_computed": 211409, "num_only_roped": 100177, "total_diff": 311586, "diff_percentage": 0.04471577442777095, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:05:13.142422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.205371856689453e-06, "l2_diff": 0.15625, "l2_diff_relative": 0.016891891891891893}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:05:59.299388", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9523848836839633, "overlap_percentage": 0.975611818799687, "num_intersection": 7579177, "num_union": 7958103, "num_only_computed": 231895, "num_only_roped": 147031, "total_diff": 378926, "diff_percentage": 0.047615116316036626, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:06:00.855185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01674910071942446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:06:54.395335", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9471611564978107, "overlap_percentage": 0.9728636516161683, "num_intersection": 8489037, "num_union": 8962611, "num_only_computed": 266163, "num_only_roped": 207411, "total_diff": 473574, "diff_percentage": 0.05283884350218926, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:06:56.643645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 2.8252601623535156e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.1719409282700422}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:07:57.394048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9415474980966514, "overlap_percentage": 0.9698938594288056, "num_intersection": 9391490, "num_union": 9974526, "num_only_computed": 307838, "num_only_roped": 275198, "total_diff": 583036, "diff_percentage": 0.05845250190334859, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:07:59.499572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 5.888938903808594e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.4603174603174603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:09:07.606877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9347424337340106, "overlap_percentage": 0.9662706698689376, "num_intersection": 10277852, "num_union": 10995384, "num_only_computed": 364580, "num_only_roped": 352952, "total_diff": 717532, "diff_percentage": 0.06525756626598944, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:09:09.924596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.6743621826171875e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.4679144385026738}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:10:27.179266", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.926683033992314, "overlap_percentage": 0.9619465346846572, "num_intersection": 11145038, "num_union": 12026807, "num_only_computed": 441522, "num_only_roped": 440247, "total_diff": 881769, "diff_percentage": 0.073316966007686, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:10:29.788299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.43351063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:11:54.783213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.91648226594543, "overlap_percentage": 0.9564213373957993, "num_intersection": 11983638, "num_union": 13075690, "num_only_computed": 546026, "num_only_roped": 546026, "total_diff": 1092052, "diff_percentage": 0.08351773405456997, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:12:00.263645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 4.696846008300781e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.43023255813953487}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:13:31.764147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9076765983763403, "overlap_percentage": 0.9516042699783401, "num_intersection": 12821718, "num_union": 14125866, "num_only_computed": 652074, "num_only_roped": 652074, "total_diff": 1304148, "diff_percentage": 0.09232340162365975, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:13:34.879232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 4.38690185546875e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.3812154696132597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:15:09.593074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8490363823880267, "overlap_percentage": 0.918355518014738, "num_intersection": 630598, "num_union": 742722, "num_only_computed": 56062, "num_only_roped": 56062, "total_diff": 112124, "diff_percentage": 0.15096361761197324, "num_computed": 686660, "num_roped": 686660}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "mask_shape": [1, 32, 52, 14388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:15:13.004350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.2333984375, "l2_diff_relative": 0.1185515873015873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "attention_shape": [1, 32, 52, 14388]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:16:41.445302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8458791362089169, "overlap_percentage": 0.9165054413542926, "num_intersection": 363816, "num_union": 430104, "num_only_computed": 33144, "num_only_roped": 33144, "total_diff": 66288, "diff_percentage": 0.15412086379108308, "num_computed": 396960, "num_roped": 396960}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "mask_shape": [1, 32, 30, 14418], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:16:44.286656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.1123046875, "l2_diff_relative": 0.0764627659574468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "attention_shape": [1, 32, 30, 14418]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:18:11.678989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8423947093630352, "overlap_percentage": 0.9144562835335903, "num_intersection": 12101, "num_union": 14365, "num_only_computed": 1132, "num_only_roped": 1132, "total_diff": 2264, "diff_percentage": 0.15760529063696485, "num_computed": 13233, "num_roped": 13233}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "mask_shape": [1, 32, 1, 14419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:18:14.865936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.0159912109375, "l2_diff_relative": 0.08397435897435897}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "attention_shape": [1, 32, 1, 14419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:19:40.656754", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8475499092558983, "overlap_percentage": 0.9174852652259332, "num_intersection": 12142, "num_union": 14326, "num_only_computed": 1092, "num_only_roped": 1092, "total_diff": 2184, "diff_percentage": 0.15245009074410162, "num_computed": 13234, "num_roped": 13234}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "mask_shape": [1, 32, 1, 14420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:19:43.424329", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.11875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "attention_shape": [1, 32, 1, 14420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:21:10.281415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8438174851967956, "overlap_percentage": 0.9152939398518967, "num_intersection": 12113, "num_union": 14355, "num_only_computed": 1121, "num_only_roped": 1121, "total_diff": 2242, "diff_percentage": 0.15618251480320447, "num_computed": 13234, "num_roped": 13234}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "mask_shape": [1, 32, 1, 14421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:21:13.054309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.341104507446289e-05, "l2_diff": 0.023193359375, "l2_diff_relative": 0.09134615384615384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "attention_shape": [1, 32, 1, 14421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:01.856876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:01.869592", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:02.297858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:02.307374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.735985279083252e-06, "l2_diff": 0.0269775390625, "l2_diff_relative": 0.002997504340277778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:11.210413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.929334099590604, "overlap_percentage": 0.963372906525422, "num_intersection": 2875198, "num_union": 3093826, "num_only_computed": 217282, "num_only_roped": 1346, "total_diff": 218628, "diff_percentage": 0.070665900409396, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:12.380866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.5299530029296875e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.0142829754601227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:33.167472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474123528922069, "overlap_percentage": 0.9729961417623277, "num_intersection": 3835255, "num_union": 4048137, "num_only_computed": 201353, "num_only_roped": 11529, "total_diff": 212882, "diff_percentage": 0.05258764710779304, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:22:33.904861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.2236328125, "l2_diff_relative": 0.025021853146853148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:23:00.769694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548537046063491, "overlap_percentage": 0.976905537592266, "num_intersection": 4785743, "num_union": 5012017, "num_only_computed": 194993, "num_only_roped": 31281, "total_diff": 226274, "diff_percentage": 0.0451462953936509, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:23:01.705630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.01903973509933775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:23:35.040646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.956629894441927, "overlap_percentage": 0.9778342824663614, "num_intersection": 5725384, "num_union": 5984952, "num_only_computed": 198456, "num_only_roped": 61112, "total_diff": 259568, "diff_percentage": 0.04337010555807298, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:23:36.180484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.637505531311035e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.017652671755725192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:24:15.845824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9555758158408958, "overlap_percentage": 0.9772833229991639, "num_intersection": 6657598, "num_union": 6967106, "num_only_computed": 210370, "num_only_roped": 99138, "total_diff": 309508, "diff_percentage": 0.04442418415910423, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:24:18.199418", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.017760791366906475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:25:04.685773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.952196240874335, "overlap_percentage": 0.9755128310746798, "num_intersection": 7578408, "num_union": 7958872, "num_only_computed": 232664, "num_only_roped": 147800, "total_diff": 380464, "diff_percentage": 0.04780375912566504, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:25:06.223055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.8775463104248047e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015515734265734266}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:25:59.435031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9471639808011025, "overlap_percentage": 0.9728651414468135, "num_intersection": 8489050, "num_union": 8962598, "num_only_computed": 266150, "num_only_roped": 207398, "total_diff": 473548, "diff_percentage": 0.052836019198897466, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:26:01.223940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.6484375, "l2_diff_relative": 0.19682835820895522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:27:02.087151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9421922002484151, "overlap_percentage": 0.9702357986278644, "num_intersection": 9394801, "num_union": 9971215, "num_only_computed": 304527, "num_only_roped": 271887, "total_diff": 576414, "diff_percentage": 0.05780779975158494, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:27:04.878299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1533203125, "mean_diff": 6.437301635742188e-05, "l2_diff": 3.125, "l2_diff_relative": 0.49019607843137253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:28:13.392929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9344122140958553, "overlap_percentage": 0.9660942040035658, "num_intersection": 10275975, "num_union": 10997261, "num_only_computed": 366457, "num_only_roped": 354829, "total_diff": 721286, "diff_percentage": 0.06558778590414467, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:28:15.749720", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 6.771087646484375e-05, "l2_diff": 3.28125, "l2_diff_relative": 0.5833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:29:32.412358", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.926047413732913, "overlap_percentage": 0.9616039637758668, "num_intersection": 11141069, "num_union": 12030776, "num_only_computed": 445491, "num_only_roped": 444216, "total_diff": 889707, "diff_percentage": 0.073952586267087, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:29:37.404425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1630859375, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.4482758620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:31:02.381248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9174002232691096, "overlap_percentage": 0.9569209517509807, "num_intersection": 11989898, "num_union": 13069430, "num_only_computed": 539766, "num_only_roped": 539766, "total_diff": 1079532, "diff_percentage": 0.08259977673089033, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:31:05.315223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 5.53131103515625e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.48404255319148937}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:32:38.156231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9035854033706125, "overlap_percentage": 0.9493510527772122, "num_intersection": 10910379, "num_union": 12074541, "num_only_computed": 582081, "num_only_roped": 582081, "total_diff": 1164162, "diff_percentage": 0.09641459662938741, "num_computed": 11492460, "num_roped": 11492460}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:32:41.221332", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 5.459785461425781e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.4815950920245399}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:34:12.713246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8539588032563519, "overlap_percentage": 0.9212273776056206, "num_intersection": 372911, "num_union": 436685, "num_only_computed": 31887, "num_only_roped": 31887, "total_diff": 63774, "diff_percentage": 0.14604119674364816, "num_computed": 404798, "num_roped": 404798}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 31, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:34:15.629432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 2.753734588623047e-05, "l2_diff": 0.1630859375, "l2_diff_relative": 0.13296178343949044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 31, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:35:41.316283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8474923958407017, "overlap_percentage": 0.9174515659698292, "num_intersection": 11981, "num_union": 14137, "num_only_computed": 1078, "num_only_roped": 1078, "total_diff": 2156, "diff_percentage": 0.1525076041592983, "num_computed": 13059, "num_roped": 13059}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:35:44.031531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.018798828125, "mean_diff": 4.076957702636719e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.25735294117647056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:37:09.105164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8467194570135747, "overlap_percentage": 0.9169984686064319, "num_intersection": 11976, "num_union": 14144, "num_only_computed": 1084, "num_only_roped": 1084, "total_diff": 2168, "diff_percentage": 0.15328054298642535, "num_computed": 13060, "num_roped": 13060}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:37:13.107219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.1701388888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:38:38.450124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8509175937079289, "overlap_percentage": 0.919454865630503, "num_intersection": 12009, "num_union": 14113, "num_only_computed": 1052, "num_only_roped": 1052, "total_diff": 2104, "diff_percentage": 0.14908240629207115, "num_computed": 13061, "num_roped": 13061}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:38:41.206054", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.0242919921875, "l2_diff_relative": 0.12888601036269431}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:40:05.567585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8449152542372881, "overlap_percentage": 0.9159393661001378, "num_intersection": 11964, "num_union": 14160, "num_only_computed": 1098, "num_only_roped": 1098, "total_diff": 2196, "diff_percentage": 0.15508474576271186, "num_computed": 13062, "num_roped": 13062}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "mask_shape": [1, 32, 1, 14229], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:40:08.300471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.1673913043478261}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "attention_shape": [1, 32, 1, 14229]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:40:56.441480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:40:56.454099", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.003142528044871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:40:56.878412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:40:56.887865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8924474716186523e-06, "l2_diff": 0.0264892578125, "l2_diff_relative": 0.0031163832720588237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:41:05.907265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293328523757624, "overlap_percentage": 0.9633722363991165, "num_intersection": 2875196, "num_union": 3093828, "num_only_computed": 217284, "num_only_roped": 1348, "total_diff": 218632, "diff_percentage": 0.07066714762423768, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:41:06.466550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.738569259643555e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.01621685606060606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:41:29.700904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9476047974460792, "overlap_percentage": 0.9730976209225674, "num_intersection": 3835655, "num_union": 4047737, "num_only_computed": 200953, "num_only_roped": 11129, "total_diff": 212082, "diff_percentage": 0.05239520255392087, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:41:30.443579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.197265625, "l2_diff_relative": 0.025049603174603176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:41:57.472470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9552590332665599, "overlap_percentage": 0.9771176268861455, "num_intersection": 4786782, "num_union": 5010978, "num_only_computed": 193954, "num_only_roped": 30242, "total_diff": 224196, "diff_percentage": 0.04474096673344006, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:41:58.416402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.01968034351145038}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:42:32.156130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9575872718686398, "overlap_percentage": 0.9783341827254145, "num_intersection": 5728311, "num_union": 5982025, "num_only_computed": 195529, "num_only_roped": 58185, "total_diff": 253714, "diff_percentage": 0.0424127281313602, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:42:34.155228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.3692846298217773e-06, "l2_diff": 0.11328125, "l2_diff_relative": 0.014676113360323886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:43:14.471697", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9560483261389868, "overlap_percentage": 0.977530374237855, "num_intersection": 6659281, "num_union": 6965423, "num_only_computed": 208687, "num_only_roped": 97455, "total_diff": 306142, "diff_percentage": 0.04395167386101318, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:43:16.364230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.017703862660944206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:44:03.819125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9519590785693027, "overlap_percentage": 0.9753883562631297, "num_intersection": 7577441, "num_union": 7959839, "num_only_computed": 233631, "num_only_roped": 148767, "total_diff": 382398, "diff_percentage": 0.04804092143069728, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:44:05.385022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.0116567611694336e-06, "l2_diff": 0.1220703125, "l2_diff_relative": 0.016551906779661018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:44:58.843179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9466229504246974, "overlap_percentage": 0.9725796669747178, "num_intersection": 8486559, "num_union": 8965089, "num_only_computed": 268641, "num_only_roped": 209889, "total_diff": 478530, "diff_percentage": 0.0533770495753026, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:45:00.662196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.1858108108108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:46:01.715609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9408108305292519, "overlap_percentage": 0.9695028652253515, "num_intersection": 9387704, "num_union": 9978312, "num_only_computed": 311624, "num_only_roped": 278984, "total_diff": 590608, "diff_percentage": 0.059189169470748156, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:46:03.800269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.921875, "l2_diff_relative": 0.2834101382488479}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:47:12.756226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9339676424702328, "overlap_percentage": 0.9658565344736456, "num_intersection": 10273447, "num_union": 10999789, "num_only_computed": 368985, "num_only_roped": 357357, "total_diff": 726342, "diff_percentage": 0.06603235752976716, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:47:15.123445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 4.553794860839844e-05, "l2_diff": 1.90625, "l2_diff_relative": 0.3505747126436782}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:48:31.467456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9255147703559816, "overlap_percentage": 0.9613167186298718, "num_intersection": 11137741, "num_union": 12034104, "num_only_computed": 448819, "num_only_roped": 447544, "total_diff": 896363, "diff_percentage": 0.07448522964401837, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:48:36.468372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 5.793571472167969e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.5175438596491229}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:50:00.749350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9182258155261809, "overlap_percentage": 0.9573698863752452, "num_intersection": 11995523, "num_union": 13063805, "num_only_computed": 534141, "num_only_roped": 534141, "total_diff": 1068282, "diff_percentage": 0.08177418447381908, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:50:03.633048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08447265625, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.78125, "l2_diff_relative": 0.31843575418994413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:51:36.688582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9117191798095842, "overlap_percentage": 0.9538212405238258, "num_intersection": 12851589, "num_union": 14095995, "num_only_computed": 622203, "num_only_roped": 622203, "total_diff": 1244406, "diff_percentage": 0.08828082019041579, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:51:39.812991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.84375, "l2_diff_relative": 0.37579617834394907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:53:21.682350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9039268279542062, "overlap_percentage": 0.9495394620028409, "num_intersection": 13690384, "num_union": 15145456, "num_only_computed": 727536, "num_only_roped": 727536, "total_diff": 1455072, "diff_percentage": 0.0960731720457938, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:53:25.265991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 4.315376281738281e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.346969696969697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:55:10.833879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8715731282064814, "overlap_percentage": 0.9313802544725627, "num_intersection": 6473809, "num_union": 7427729, "num_only_computed": 476960, "num_only_roped": 476960, "total_diff": 953920, "diff_percentage": 0.12842687179351858, "num_computed": 6950769, "num_roped": 6950769}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "mask_shape": [1, 32, 479, 15839], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:55:16.233008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.2522421524663677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "attention_shape": [1, 32, 479, 15839]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:56:59.434045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.850384690299961, "overlap_percentage": 0.9191436729430651, "num_intersection": 628686, "num_union": 739296, "num_only_computed": 55305, "num_only_roped": 55305, "total_diff": 110610, "diff_percentage": 0.14961530970003895, "num_computed": 683991, "num_roped": 683991}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 47, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:57:02.709634", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.8133392333984375e-05, "l2_diff": 0.169921875, "l2_diff_relative": 0.11387434554973822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 47, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:58:42.823051", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8490661923516707, "overlap_percentage": 0.9183729558884156, "num_intersection": 13366, "num_union": 15742, "num_only_computed": 1188, "num_only_roped": 1188, "total_diff": 2376, "diff_percentage": 0.1509338076483293, "num_computed": 14554, "num_roped": 14554}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "mask_shape": [1, 32, 1, 15887], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T12:58:47.837792", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01287841796875, "mean_diff": 3.4332275390625e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.2059748427672956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "attention_shape": [1, 32, 1, 15887]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:00:25.132548", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8513100992113966, "overlap_percentage": 0.9196839574029543, "num_intersection": 13386, "num_union": 15724, "num_only_computed": 1169, "num_only_roped": 1169, "total_diff": 2338, "diff_percentage": 0.14868990078860342, "num_computed": 14555, "num_roped": 14555}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "mask_shape": [1, 32, 1, 15888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:00:28.281877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.30851063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "attention_shape": [1, 32, 1, 15888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:02:05.616748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8490853658536586, "overlap_percentage": 0.9183841714756801, "num_intersection": 13368, "num_union": 15744, "num_only_computed": 1188, "num_only_roped": 1188, "total_diff": 2376, "diff_percentage": 0.15091463414634146, "num_computed": 14556, "num_roped": 14556}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "mask_shape": [1, 32, 1, 15889], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:02:08.747960", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01373291015625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.18601190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "attention_shape": [1, 32, 1, 15889]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:02.951244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:02.963859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0031754032258064515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:03.389506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:03.398985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8700957298278809e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0031772667253521128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:12.345524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293234983158486, "overlap_percentage": 0.9633672104518259, "num_intersection": 2875181, "num_union": 3093843, "num_only_computed": 217299, "num_only_roped": 1363, "total_diff": 218662, "diff_percentage": 0.07067650168415139, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:12.905577", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.32133674621582e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.01375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:33.684747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474397739175116, "overlap_percentage": 0.9730106025426618, "num_intersection": 3835312, "num_union": 4048080, "num_only_computed": 201296, "num_only_roped": 11472, "total_diff": 212768, "diff_percentage": 0.05256022608248849, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:03:36.309604", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.2392578125, "l2_diff_relative": 0.02407625786163522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:04:04.142346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9548451239106479, "overlap_percentage": 0.9769010467698739, "num_intersection": 4785721, "num_union": 5012039, "num_only_computed": 195015, "num_only_roped": 31303, "total_diff": 226318, "diff_percentage": 0.04515487608935206, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:04:05.085636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.203749656677246e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.0175}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:04:38.527349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9566674915290091, "overlap_percentage": 0.9778539232349951, "num_intersection": 5725499, "num_union": 5984837, "num_only_computed": 198341, "num_only_roped": 60997, "total_diff": 259338, "diff_percentage": 0.04333250847099094, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:04:39.663549", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.3543834686279297e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014340753424657534}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:05:20.170306", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9555878854547462, "overlap_percentage": 0.9772896350628976, "num_intersection": 6657641, "num_union": 6967063, "num_only_computed": 210327, "num_only_roped": 99095, "total_diff": 309422, "diff_percentage": 0.04441211454525386, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:05:21.517534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.4139881134033203e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.019134963768115944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:06:08.066767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9524229110318388, "overlap_percentage": 0.9756317708118796, "num_intersection": 7579332, "num_union": 7957948, "num_only_computed": 231740, "num_only_roped": 146876, "total_diff": 378616, "diff_percentage": 0.04757708896816114, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:06:10.335080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9222497940063477e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.016351744186046513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:07:04.003992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9478131360836983, "overlap_percentage": 0.9732074586881422, "num_intersection": 8492037, "num_union": 8959611, "num_only_computed": 263163, "num_only_roped": 204411, "total_diff": 467574, "diff_percentage": 0.05218686391630172, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:07:05.822656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 2.5391578674316406e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.1427304964539007}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:08:06.910099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.941517911655895, "overlap_percentage": 0.969878161827399, "num_intersection": 9391338, "num_union": 9974678, "num_only_computed": 307990, "num_only_roped": 275350, "total_diff": 583340, "diff_percentage": 0.05848208834410494, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:08:09.030209", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 6.341934204101562e-05, "l2_diff": 3.125, "l2_diff_relative": 0.4784688995215311}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:09:20.111281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9347181516257255, "overlap_percentage": 0.9662576958202316, "num_intersection": 10277714, "num_union": 10995522, "num_only_computed": 364718, "num_only_roped": 353090, "total_diff": 717808, "diff_percentage": 0.06528184837427455, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:09:24.618967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1650390625, "mean_diff": 6.389617919921875e-05, "l2_diff": 3.25, "l2_diff_relative": 0.5416666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:10:42.078743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.926785086191198, "overlap_percentage": 0.9620015152008828, "num_intersection": 11145675, "num_union": 12026170, "num_only_computed": 440885, "num_only_roped": 439610, "total_diff": 880495, "diff_percentage": 0.07321491380880198, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:10:45.753283", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.984375, "l2_diff_relative": 0.45476190476190476}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:12:10.776419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9171643445608528, "overlap_percentage": 0.956792616306391, "num_intersection": 11988290, "num_union": 13071038, "num_only_computed": 541374, "num_only_roped": 541374, "total_diff": 1082748, "diff_percentage": 0.08283565543914723, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:12:13.673030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1611328125, "mean_diff": 5.5789947509765625e-05, "l2_diff": 3.078125, "l2_diff_relative": 0.5628571428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:13:42.913471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8801329246816831, "overlap_percentage": 0.9362454251267308, "num_intersection": 5950951, "num_union": 6761423, "num_only_computed": 405236, "num_only_roped": 405236, "total_diff": 810472, "diff_percentage": 0.11986707531831686, "num_computed": 6356187, "num_roped": 6356187}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "mask_shape": [1, 32, 501, 13813], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:13:46.598332", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 5.3882598876953125e-05, "l2_diff": 1.890625, "l2_diff_relative": 0.43214285714285716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "attention_shape": [1, 32, 501, 13813]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:15:14.249191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8541456016177957, "overlap_percentage": 0.9213360599863667, "num_intersection": 351416, "num_union": 411424, "num_only_computed": 30004, "num_only_roped": 30004, "total_diff": 60008, "diff_percentage": 0.14585439838220424, "num_computed": 381420, "num_roped": 381420}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "mask_shape": [1, 32, 30, 13843], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:15:17.001155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.12060546875, "l2_diff_relative": 0.09470858895705521}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "attention_shape": [1, 32, 30, 13843]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:16:40.718979", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8466342313557476, "overlap_percentage": 0.9169484860401101, "num_intersection": 11659, "num_union": 13771, "num_only_computed": 1056, "num_only_roped": 1056, "total_diff": 2112, "diff_percentage": 0.15336576864425241, "num_computed": 12715, "num_roped": 12715}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "mask_shape": [1, 32, 1, 13844], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:16:44.209710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 1.436471939086914e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.0928030303030303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "attention_shape": [1, 32, 1, 13844]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:18:07.700250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8539145648053652, "overlap_percentage": 0.9212016357345078, "num_intersection": 11714, "num_union": 13718, "num_only_computed": 1002, "num_only_roped": 1002, "total_diff": 2004, "diff_percentage": 0.1460854351946348, "num_computed": 12716, "num_roped": 12716}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "mask_shape": [1, 32, 1, 13845], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:18:10.429891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009521484375, "mean_diff": 1.2695789337158203e-05, "l2_diff": 0.0174560546875, "l2_diff_relative": 0.0692829457364341}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "attention_shape": [1, 32, 1, 13845]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:19:32.256644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8527097902097902, "overlap_percentage": 0.9205001179523472, "num_intersection": 11706, "num_union": 13728, "num_only_computed": 1011, "num_only_roped": 1011, "total_diff": 2022, "diff_percentage": 0.1472902097902098, "num_computed": 12717, "num_roped": 12717}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "mask_shape": [1, 32, 1, 13846], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:19:34.883533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00775146484375, "mean_diff": 1.1444091796875e-05, "l2_diff": 0.01519775390625, "l2_diff_relative": 0.049879807692307696}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "attention_shape": [1, 32, 1, 13846]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:20:56.049714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8607168983174835, "overlap_percentage": 0.9251454631231326, "num_intersection": 11766, "num_union": 13670, "num_only_computed": 952, "num_only_roped": 952, "total_diff": 1904, "diff_percentage": 0.13928310168251645, "num_computed": 12718, "num_roped": 12718}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "mask_shape": [1, 32, 1, 13847], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:20:58.675420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046630859375, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.07177734375, "l2_diff_relative": 0.34834123222748814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "attention_shape": [1, 32, 1, 13847]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:22:19.726878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8544871327549756, "overlap_percentage": 0.9215347118484157, "num_intersection": 11721, "num_union": 13717, "num_only_computed": 998, "num_only_roped": 998, "total_diff": 1996, "diff_percentage": 0.14551286724502444, "num_computed": 12719, "num_roped": 12719}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "mask_shape": [1, 32, 1, 13848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:22:22.337202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.021728515625, "l2_diff_relative": 0.09232365145228216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "attention_shape": [1, 32, 1, 13848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:23:43.652288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8500472692895062, "overlap_percentage": 0.9189465408805031, "num_intersection": 11689, "num_union": 13751, "num_only_computed": 1031, "num_only_roped": 1031, "total_diff": 2062, "diff_percentage": 0.14995273071049378, "num_computed": 12720, "num_roped": 12720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "mask_shape": [1, 32, 1, 13849], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:23:46.250146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009033203125, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.020263671875, "l2_diff_relative": 0.07518115942028986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "attention_shape": [1, 32, 1, 13849]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:25:07.852258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8505964503927844, "overlap_percentage": 0.9192673531955035, "num_intersection": 11694, "num_union": 13748, "num_only_computed": 1027, "num_only_roped": 1027, "total_diff": 2054, "diff_percentage": 0.1494035496072156, "num_computed": 12721, "num_roped": 12721}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "mask_shape": [1, 32, 1, 13850], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:25:10.453222", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.04150390625, "l2_diff_relative": 0.1673228346456693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "attention_shape": [1, 32, 1, 13850]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:25:57.807914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:25:57.820537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003045333059210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:25:58.244588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:25:58.255997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8775463104248047e-06, "l2_diff": 0.02587890625, "l2_diff_relative": 0.003185096153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:26:07.129590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293378412448041, "overlap_percentage": 0.9633749169043381, "num_intersection": 2875204, "num_union": 3093820, "num_only_computed": 217276, "num_only_roped": 1340, "total_diff": 218616, "diff_percentage": 0.07066215875519584, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:26:07.679517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 4.738569259643555e-06, "l2_diff": 0.12255859375, "l2_diff_relative": 0.015814012096774195}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:26:28.214531", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474845151429587, "overlap_percentage": 0.9730341964474175, "num_intersection": 3835405, "num_union": 4047987, "num_only_computed": 201203, "num_only_roped": 11379, "total_diff": 212582, "diff_percentage": 0.05251548485704129, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:26:28.947169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.1953125, "l2_diff_relative": 0.025614754098360656}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:26:55.728109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.954844733880815, "overlap_percentage": 0.9769008426415834, "num_intersection": 4785720, "num_union": 5012040, "num_only_computed": 195016, "num_only_roped": 31304, "total_diff": 226320, "diff_percentage": 0.045155266119185, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:26:56.653286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.11434268951416e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.018206521739130434}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:27:29.865046", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9567472675251266, "overlap_percentage": 0.9778955958223573, "num_intersection": 5725743, "num_union": 5984593, "num_only_computed": 198097, "num_only_roped": 60753, "total_diff": 258850, "diff_percentage": 0.04325273247487339, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:27:33.586912", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.473592758178711e-06, "l2_diff": 0.109375, "l2_diff_relative": 0.015350877192982455}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:28:12.937299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9554023666838698, "overlap_percentage": 0.9771926054320152, "num_intersection": 6656980, "num_union": 6967724, "num_only_computed": 210988, "num_only_roped": 99756, "total_diff": 310744, "diff_percentage": 0.0445976333161302, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:28:16.439489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.017784552845528455}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:29:02.551775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9525603125045555, "overlap_percentage": 0.9757038555010916, "num_intersection": 7579892, "num_union": 7957388, "num_only_computed": 231180, "num_only_roped": 146316, "total_diff": 377496, "diff_percentage": 0.047439687495444485, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:29:04.079071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.9073486328125e-06, "l2_diff": 0.12451171875, "l2_diff_relative": 0.015748517786561264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:29:56.721352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9481401595225419, "overlap_percentage": 0.9733798206335585, "num_intersection": 8493541, "num_union": 8958107, "num_only_computed": 261659, "num_only_roped": 202907, "total_diff": 464566, "diff_percentage": 0.051859840477458015, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:29:58.506051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 2.8014183044433594e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.14591836734693878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:30:58.730506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9422114836493728, "overlap_percentage": 0.9702460227235173, "num_intersection": 9394900, "num_union": 9971116, "num_only_computed": 304428, "num_only_roped": 271788, "total_diff": 576216, "diff_percentage": 0.05778851635062715, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:31:03.123062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11376953125, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.5, "l2_diff_relative": 0.43243243243243246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:32:11.286872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.934529546148562, "overlap_percentage": 0.9661569119056452, "num_intersection": 10276642, "num_union": 10996594, "num_only_computed": 365790, "num_only_roped": 354162, "total_diff": 719952, "diff_percentage": 0.065470453851438, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:32:13.626385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 6.341934204101562e-05, "l2_diff": 2.875, "l2_diff_relative": 0.5380116959064327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:33:30.070957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9264917753166133, "overlap_percentage": 0.9618434785836001, "num_intersection": 11143844, "num_union": 12028001, "num_only_computed": 442716, "num_only_roped": 441441, "total_diff": 884157, "diff_percentage": 0.0735082246833867, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:33:33.639713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 5.6743621826171875e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.4447852760736196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:34:58.292788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9177394739987808, "overlap_percentage": 0.9571054738578784, "num_intersection": 11992210, "num_union": 13067118, "num_only_computed": 537454, "num_only_roped": 537454, "total_diff": 1074908, "diff_percentage": 0.08226052600121925, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:35:01.175129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 4.9591064453125e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.4036144578313253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:36:35.077557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9095115095407607, "overlap_percentage": 0.9526117072313421, "num_intersection": 12835292, "num_union": 14112292, "num_only_computed": 638500, "num_only_roped": 638500, "total_diff": 1277000, "diff_percentage": 0.09048849045923936, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:36:38.213318", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.75, "l2_diff_relative": 0.3218390804597701}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:38:21.437654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9020213475311611, "overlap_percentage": 0.9484870910644532, "num_intersection": 13675211, "num_union": 15160629, "num_only_computed": 742709, "num_only_roped": 742709, "total_diff": 1485418, "diff_percentage": 0.09797865246883886, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:38:27.098471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07666015625, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.625, "l2_diff_relative": 0.30952380952380953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:40:17.581475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8968526809550016, "overlap_percentage": 0.9456218608431588, "num_intersection": 14420653, "num_union": 16079177, "num_only_computed": 829262, "num_only_roped": 829262, "total_diff": 1658524, "diff_percentage": 0.10314731904499838, "num_computed": 15249915, "num_roped": 15249915}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1017, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:40:21.234744", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.410743713378906e-05, "l2_diff": 2.125, "l2_diff_relative": 0.43312101910828027}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1017, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:42:11.095184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8474094194875429, "overlap_percentage": 0.9174029433308917, "num_intersection": 344416, "num_union": 406434, "num_only_computed": 31009, "num_only_roped": 31009, "total_diff": 62018, "diff_percentage": 0.15259058051245714, "num_computed": 375425, "num_roped": 375425}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "mask_shape": [1, 32, 25, 16402], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:42:14.528936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.1396484375, "l2_diff_relative": 0.11242138364779874}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "attention_shape": [1, 32, 25, 16402]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:43:57.189390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8448498249493275, "overlap_percentage": 0.9159009188973232, "num_intersection": 13755, "num_union": 16281, "num_only_computed": 1263, "num_only_roped": 1263, "total_diff": 2526, "diff_percentage": 0.15515017505067255, "num_computed": 15018, "num_roped": 15018}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "mask_shape": [1, 32, 1, 16403], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:44:00.446089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0184326171875, "l2_diff_relative": 0.08903301886792453}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "attention_shape": [1, 32, 1, 16403]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:45:41.142461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.843500675095127, "overlap_percentage": 0.9151075304614156, "num_intersection": 13744, "num_union": 16294, "num_only_computed": 1275, "num_only_roped": 1275, "total_diff": 2550, "diff_percentage": 0.15649932490487295, "num_computed": 15019, "num_roped": 15019}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "mask_shape": [1, 32, 1, 16404], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:45:45.149703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.01904296875, "l2_diff_relative": 0.07991803278688525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "attention_shape": [1, 32, 1, 16404]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:47:26.577629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8446423088731962, "overlap_percentage": 0.9157789613848203, "num_intersection": 13755, "num_union": 16285, "num_only_computed": 1265, "num_only_roped": 1265, "total_diff": 2530, "diff_percentage": 0.1553576911268038, "num_computed": 15020, "num_roped": 15020}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "mask_shape": [1, 32, 1, 16405], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:47:29.850691", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.16393442622950818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "attention_shape": [1, 32, 1, 16405]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:49:10.918001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8426153091265947, "overlap_percentage": 0.9145862459223754, "num_intersection": 13738, "num_union": 16304, "num_only_computed": 1283, "num_only_roped": 1283, "total_diff": 2566, "diff_percentage": 0.1573846908734053, "num_computed": 15021, "num_roped": 15021}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "mask_shape": [1, 32, 1, 16406], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:49:14.846663", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012451171875, "mean_diff": 2.9802322387695312e-05, "l2_diff": 0.029296875, "l2_diff_relative": 0.14218009478672985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "attention_shape": [1, 32, 1, 16406]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:50:56.565433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8451145366332985, "overlap_percentage": 0.9160564505392091, "num_intersection": 13761, "num_union": 16283, "num_only_computed": 1261, "num_only_roped": 1261, "total_diff": 2522, "diff_percentage": 0.15488546336670148, "num_computed": 15022, "num_roped": 15022}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "mask_shape": [1, 32, 1, 16407], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:50:59.841809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.018310546875, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.042236328125, "l2_diff_relative": 0.25441176470588234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "attention_shape": [1, 32, 1, 16407]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:52:40.829666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8447841837047952, "overlap_percentage": 0.9158623444052453, "num_intersection": 13759, "num_union": 16287, "num_only_computed": 1264, "num_only_roped": 1264, "total_diff": 2528, "diff_percentage": 0.15521581629520476, "num_computed": 15023, "num_roped": 15023}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "mask_shape": [1, 32, 1, 16408], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:52:45.194133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.018310546875, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.1383587786259542}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "attention_shape": [1, 32, 1, 16408]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:53:43.702028", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:53:43.714608", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1739473342895508e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0029779128086419755}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:53:44.139373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:53:44.149026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.7583370208740234e-06, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.003147392515923567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:53:53.184832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.929337217634763, "overlap_percentage": 0.9633745818411854, "num_intersection": 2875203, "num_union": 3093821, "num_only_computed": 217277, "num_only_roped": 1341, "total_diff": 218618, "diff_percentage": 0.07066278236523703, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:53:53.919649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.589557647705078e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.014723557692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:54:14.772315", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475638997959891, "overlap_percentage": 0.9730760566010164, "num_intersection": 3835570, "num_union": 4047822, "num_only_computed": 201038, "num_only_roped": 11214, "total_diff": 212252, "diff_percentage": 0.052436100204010946, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:54:15.513509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.2265625, "l2_diff_relative": 0.028769841269841268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:54:42.231262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9551802170347103, "overlap_percentage": 0.9770763929714547, "num_intersection": 4786580, "num_union": 5011180, "num_only_computed": 194156, "num_only_roped": 30444, "total_diff": 224600, "diff_percentage": 0.044819782965289615, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:54:43.163264", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.018568840579710144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:55:16.040650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9572738214365644, "overlap_percentage": 0.9781705665832304, "num_intersection": 5727353, "num_union": 5982983, "num_only_computed": 196487, "num_only_roped": 59143, "total_diff": 255630, "diff_percentage": 0.04272617856343566, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:55:17.396363", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.014008620689655173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:55:56.719477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9563173912138262, "overlap_percentage": 0.9776710011461534, "num_intersection": 6660239, "num_union": 6964465, "num_only_computed": 207729, "num_only_roped": 96497, "total_diff": 304226, "diff_percentage": 0.04368260878617381, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:55:59.593108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.130866050720215e-06, "l2_diff": 0.15625, "l2_diff_relative": 0.016339869281045753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:56:46.147793", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9522928881627869, "overlap_percentage": 0.9755635478024468, "num_intersection": 7578802, "num_union": 7958478, "num_only_computed": 232270, "num_only_roped": 147406, "total_diff": 379676, "diff_percentage": 0.047707111837213094, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:56:47.688477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.0265579223632812e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.017346938775510204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:57:40.819033", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.946679406824157, "overlap_percentage": 0.9726094635876222, "num_intersection": 8486819, "num_union": 8964829, "num_only_computed": 268381, "num_only_roped": 209629, "total_diff": 478010, "diff_percentage": 0.05332059317584306, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:57:42.630331", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 2.586841583251953e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.14655172413793102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:58:43.355846", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9408540111384043, "overlap_percentage": 0.9695257919853004, "num_intersection": 9387926, "num_union": 9978090, "num_only_computed": 311402, "num_only_roped": 278762, "total_diff": 590164, "diff_percentage": 0.05914598886159576, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:58:46.293475", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.39896373056994816}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:59:55.017439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9343981422418383, "overlap_percentage": 0.9660866828159101, "num_intersection": 10275895, "num_union": 10997341, "num_only_computed": 366537, "num_only_roped": 354909, "total_diff": 721446, "diff_percentage": 0.06560185775816173, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T13:59:57.355244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.054473876953125e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.4134078212290503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:01:13.911438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9264390817345384, "overlap_percentage": 0.9618150820532417, "num_intersection": 11143515, "num_union": 12028330, "num_only_computed": 443045, "num_only_roped": 441770, "total_diff": 884815, "diff_percentage": 0.07356091826546163, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:01:18.829351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.5, "l2_diff_relative": 0.43956043956043955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:02:43.729512", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9180829555618932, "overlap_percentage": 0.9572922306615724, "num_intersection": 11994550, "num_union": 13064778, "num_only_computed": 535114, "num_only_roped": 535114, "total_diff": 1070228, "diff_percentage": 0.0819170444381068, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:02:46.614439", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.3440366972477064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:04:19.491290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9105669568058299, "overlap_percentage": 0.9531903119775041, "num_intersection": 12843088, "num_union": 14104496, "num_only_computed": 630704, "num_only_roped": 630704, "total_diff": 1261408, "diff_percentage": 0.08943304319417014, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:04:22.794252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 3.981590270996094e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.3442211055276382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:06:04.532592", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9048394128760354, "overlap_percentage": 0.950042724609375, "num_intersection": 13697640, "num_union": 15138200, "num_only_computed": 720280, "num_only_roped": 720280, "total_diff": 1440560, "diff_percentage": 0.09516058712396454, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:06:10.477771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.29605263157894735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:07:52.742705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8577851996579756, "overlap_percentage": 0.9234492769302896, "num_intersection": 2048506, "num_union": 2388134, "num_only_computed": 169814, "num_only_roped": 169814, "total_diff": 339628, "diff_percentage": 0.14221480034202436, "num_computed": 2218320, "num_roped": 2218320}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "mask_shape": [1, 32, 156, 15516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:07:56.370367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 2.9206275939941406e-05, "l2_diff": 0.52734375, "l2_diff_relative": 0.17396907216494845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "attention_shape": [1, 32, 156, 15516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:09:36.446973", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8518911681936251, "overlap_percentage": 0.9200229288037247, "num_intersection": 393227, "num_union": 461593, "num_only_computed": 34183, "num_only_roped": 34183, "total_diff": 68366, "diff_percentage": 0.14810883180637488, "num_computed": 427410, "num_roped": 427410}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "mask_shape": [1, 32, 30, 15546], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:09:39.594490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.1513671875, "l2_diff_relative": 0.11742424242424243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "attention_shape": [1, 32, 30, 15546]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:11:15.945434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8508703559366069, "overlap_percentage": 0.9194272880404267, "num_intersection": 13100, "num_union": 15396, "num_only_computed": 1148, "num_only_roped": 1148, "total_diff": 2296, "diff_percentage": 0.1491296440633931, "num_computed": 14248, "num_roped": 14248}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "mask_shape": [1, 32, 1, 15547], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:11:19.001535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.0213623046875, "l2_diff_relative": 0.09552401746724891}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "attention_shape": [1, 32, 1, 15547]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:12:53.581404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8511204936667749, "overlap_percentage": 0.9195733033897115, "num_intersection": 13103, "num_union": 15395, "num_only_computed": 1146, "num_only_roped": 1146, "total_diff": 2292, "diff_percentage": 0.14887950633322508, "num_computed": 14249, "num_roped": 14249}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "mask_shape": [1, 32, 1, 15548], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:12:56.662437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.537799835205078e-05, "l2_diff": 0.0213623046875, "l2_diff_relative": 0.07291666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "attention_shape": [1, 32, 1, 15548]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:13:49.338725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:13:49.350322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.0030976313694267518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:13:49.775178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:13:49.784659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8328428268432617e-06, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.0030651231751824817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:13:58.772852", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293459482120249, "overlap_percentage": 0.9633792727253233, "num_intersection": 2875217, "num_union": 3093807, "num_only_computed": 217263, "num_only_roped": 1327, "total_diff": 218590, "diff_percentage": 0.07065405178797514, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:13:59.575760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01740056818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:14:20.547981", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9475282961815225, "overlap_percentage": 0.9730572829563721, "num_intersection": 3835496, "num_union": 4047896, "num_only_computed": 201112, "num_only_roped": 11288, "total_diff": 212400, "diff_percentage": 0.05247170381847755, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:14:21.296119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.543231964111328e-06, "l2_diff": 0.228515625, "l2_diff_relative": 0.027910305343511452}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:14:48.214305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9549426362522444, "overlap_percentage": 0.9769520788425109, "num_intersection": 4785971, "num_union": 5011789, "num_only_computed": 194765, "num_only_roped": 31053, "total_diff": 225818, "diff_percentage": 0.04505736374775554, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:14:49.144703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.2186508178710938e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017974624060150376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:15:22.037086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9574940115106038, "overlap_percentage": 0.9782855077770612, "num_intersection": 5728026, "num_union": 5982310, "num_only_computed": 195814, "num_only_roped": 58470, "total_diff": 254284, "diff_percentage": 0.04250598848939623, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:15:23.167198", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.01597481343283582}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:16:02.410712", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9575012574973927, "overlap_percentage": 0.9782892898076905, "num_intersection": 6664451, "num_union": 6960253, "num_only_computed": 203517, "num_only_roped": 92285, "total_diff": 295802, "diff_percentage": 0.0424987425026073, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:16:04.656694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.250075340270996e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.0173841059602649}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:16:50.870945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9536933846848137, "overlap_percentage": 0.9762979105737941, "num_intersection": 7584507, "num_union": 7952773, "num_only_computed": 226565, "num_only_roped": 141701, "total_diff": 368266, "diff_percentage": 0.04630661531518629, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:16:52.425755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.8849968910217285e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.01691810344827586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:17:45.266283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9463394151161085, "overlap_percentage": 0.9724299962960518, "num_intersection": 8485253, "num_union": 8966395, "num_only_computed": 269947, "num_only_roped": 211195, "total_diff": 481142, "diff_percentage": 0.053660584883891464, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:17:47.048656", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09716796875, "mean_diff": 3.0279159545898438e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.18467336683417085}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:18:47.549290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9399186669285812, "overlap_percentage": 0.9690289422460459, "num_intersection": 9383115, "num_union": 9982901, "num_only_computed": 316213, "num_only_roped": 283573, "total_diff": 599786, "diff_percentage": 0.060081333071418816, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:18:51.898101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 4.935264587402344e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.3316582914572864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:20:00.634718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9335375100116012, "overlap_percentage": 0.965626480146227, "num_intersection": 10271000, "num_union": 11002236, "num_only_computed": 371432, "num_only_roped": 359804, "total_diff": 731236, "diff_percentage": 0.06646248998839872, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:20:03.016365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.3819444444444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:21:20.343855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9252306437086445, "overlap_percentage": 0.9611634291529224, "num_intersection": 11135965, "num_union": 12035880, "num_only_computed": 450595, "num_only_roped": 449320, "total_diff": 899915, "diff_percentage": 0.07476935629135552, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:21:25.109106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 6.079673767089844e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.5480225988700564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:22:50.772349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9158450521439577, "overlap_percentage": 0.9560742410969679, "num_intersection": 11979289, "num_union": 13080039, "num_only_computed": 550375, "num_only_roped": 550375, "total_diff": 1100750, "diff_percentage": 0.08415494785604233, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:22:53.711766", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.4166666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:24:22.562030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8541433749255438, "overlap_percentage": 0.9213347645888963, "num_intersection": 827401, "num_union": 968691, "num_only_computed": 70645, "num_only_roped": 70645, "total_diff": 141290, "diff_percentage": 0.14585662507445615, "num_computed": 898046, "num_roped": 898046}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "mask_shape": [1, 32, 73, 13385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:24:25.445179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.337890625, "l2_diff_relative": 0.15900735294117646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "attention_shape": [1, 32, 73, 13385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:25:47.324699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8503554455314474, "overlap_percentage": 0.9191265900668222, "num_intersection": 385410, "num_union": 453234, "num_only_computed": 33912, "num_only_roped": 33912, "total_diff": 67824, "diff_percentage": 0.14964455446855268, "num_computed": 419322, "num_roped": 419322}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "mask_shape": [1, 32, 34, 13419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:25:49.966910", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.154296875, "l2_diff_relative": 0.11416184971098266}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "attention_shape": [1, 32, 34, 13419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:27:10.503988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8513959771840288, "overlap_percentage": 0.9197340684287336, "num_intersection": 11344, "num_union": 13324, "num_only_computed": 990, "num_only_roped": 990, "total_diff": 1980, "diff_percentage": 0.14860402281597118, "num_computed": 12334, "num_roped": 12334}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "mask_shape": [1, 32, 1, 13420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:27:13.054927", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.01611328125, "l2_diff_relative": 0.08048780487804878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "attention_shape": [1, 32, 1, 13420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:28:31.613566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8543185747575734, "overlap_percentage": 0.9214366790984271, "num_intersection": 11365, "num_union": 13303, "num_only_computed": 969, "num_only_roped": 969, "total_diff": 1938, "diff_percentage": 0.14568142524242653, "num_computed": 12334, "num_roped": 12334}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "mask_shape": [1, 32, 1, 13421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:28:35.389592", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012451171875, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.019775390625, "l2_diff_relative": 0.11065573770491803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "attention_shape": [1, 32, 1, 13421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:29:54.165787", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8502962574064351, "overlap_percentage": 0.9190920145926226, "num_intersection": 11337, "num_union": 13333, "num_only_computed": 998, "num_only_roped": 998, "total_diff": 1996, "diff_percentage": 0.14970374259356484, "num_computed": 12335, "num_roped": 12335}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "mask_shape": [1, 32, 1, 13422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:29:58.164629", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017822265625, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.20609756097560974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "attention_shape": [1, 32, 1, 13422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:31:16.760826", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8510015755120414, "overlap_percentage": 0.9195038910505836, "num_intersection": 11343, "num_union": 13329, "num_only_computed": 993, "num_only_roped": 993, "total_diff": 1986, "diff_percentage": 0.14899842448795858, "num_computed": 12336, "num_roped": 12336}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "mask_shape": [1, 32, 1, 13423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:31:21.081777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.0255126953125, "l2_diff_relative": 0.16126543209876543}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "attention_shape": [1, 32, 1, 13423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:32:39.736230", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8479628520071899, "overlap_percentage": 0.9177271621950231, "num_intersection": 11322, "num_union": 13352, "num_only_computed": 1015, "num_only_roped": 1015, "total_diff": 2030, "diff_percentage": 0.15203714799281007, "num_computed": 12337, "num_roped": 12337}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "mask_shape": [1, 32, 1, 13424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:32:44.638511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.0179443359375, "l2_diff_relative": 0.07379518072289157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "attention_shape": [1, 32, 1, 13424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:33:29.798815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:33:29.811427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.0032252261513157896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:33:30.237553", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:33:30.248837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8700957298278809e-06, "l2_diff": 0.02734375, "l2_diff_relative": 0.003170289855072464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:33:39.064227", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.929334099590604, "overlap_percentage": 0.963372906525422, "num_intersection": 2875198, "num_union": 3093826, "num_only_computed": 217282, "num_only_roped": 1346, "total_diff": 218628, "diff_percentage": 0.070665900409396, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:33:39.599488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.01597222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:34:01.422430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474902883540536, "overlap_percentage": 0.9730372408222248, "num_intersection": 3835417, "num_union": 4047975, "num_only_computed": 201191, "num_only_roped": 11367, "total_diff": 212558, "diff_percentage": 0.05250971164594643, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:34:02.157941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.2314453125, "l2_diff_relative": 0.025021114864864864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:34:33.863737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9550592737888333, "overlap_percentage": 0.9770131132013848, "num_intersection": 4786270, "num_union": 5011490, "num_only_computed": 194466, "num_only_roped": 30754, "total_diff": 225220, "diff_percentage": 0.04494072621116674, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:34:34.811415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.1441450119018555e-06, "l2_diff": 0.169921875, "l2_diff_relative": 0.018004966887417217}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:35:08.272200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9568895072623417, "overlap_percentage": 0.9779698891645807, "num_intersection": 5726178, "num_union": 5984158, "num_only_computed": 197662, "num_only_roped": 60318, "total_diff": 257980, "diff_percentage": 0.04311049273765833, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:35:09.408401", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.016091417910447763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:35:50.154727", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9554975073144372, "overlap_percentage": 0.9772423679809852, "num_intersection": 6657319, "num_union": 6967385, "num_only_computed": 210649, "num_only_roped": 99417, "total_diff": 310066, "diff_percentage": 0.044502492685562806, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:35:51.497316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.01927463503649635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:36:38.102959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9523677105285346, "overlap_percentage": 0.9756028082135354, "num_intersection": 7579107, "num_union": 7958173, "num_only_computed": 231965, "num_only_roped": 147101, "total_diff": 379066, "diff_percentage": 0.047632289471465375, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:36:39.769444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.952052116394043e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.016870471014492752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:37:33.084651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9472806534122006, "overlap_percentage": 0.9729266829126968, "num_intersection": 8489587, "num_union": 8962061, "num_only_computed": 265613, "num_only_roped": 206861, "total_diff": 472474, "diff_percentage": 0.05271934658779939, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:37:34.870191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.25, "l2_diff_relative": 0.19138755980861244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:38:35.388163", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9413565646337575, "overlap_percentage": 0.9697925479355176, "num_intersection": 9390509, "num_union": 9975507, "num_only_computed": 308819, "num_only_roped": 276179, "total_diff": 584998, "diff_percentage": 0.05864343536624254, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:38:37.487145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 7.2479248046875e-05, "l2_diff": 2.875, "l2_diff_relative": 0.6133333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:39:48.239673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9341826925437371, "overlap_percentage": 0.9659715146299321, "num_intersection": 10274670, "num_union": 10998566, "num_only_computed": 367762, "num_only_roped": 356134, "total_diff": 723896, "diff_percentage": 0.06581730745626294, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:39:53.157555", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 6.151199340820312e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.5277777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:41:10.743057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9266714997298967, "overlap_percentage": 0.9619403202464025, "num_intersection": 11144966, "num_union": 12026879, "num_only_computed": 441594, "num_only_roped": 440319, "total_diff": 881913, "diff_percentage": 0.07332850027010332, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:41:13.924879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 6.532669067382812e-05, "l2_diff": 2.875, "l2_diff_relative": 0.6133333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:42:38.350803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.917165371270254, "overlap_percentage": 0.95679317498059, "num_intersection": 11988297, "num_union": 13071031, "num_only_computed": 541367, "num_only_roped": 541367, "total_diff": 1082734, "diff_percentage": 0.08283462872974595, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:42:41.232634", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 5.555152893066406e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.49714285714285716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:44:14.765905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9091858777859875, "overlap_percentage": 0.952433064129237, "num_intersection": 12832885, "num_union": 14114699, "num_only_computed": 640907, "num_only_roped": 640907, "total_diff": 1281814, "diff_percentage": 0.0908141222140125, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:44:17.889072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 4.792213439941406e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.46703296703296704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:46:00.529857", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9028571390863253, "overlap_percentage": 0.9489489468661222, "num_intersection": 13681870, "num_union": 15153970, "num_only_computed": 736050, "num_only_roped": 736050, "total_diff": 1472100, "diff_percentage": 0.09714286091367477, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:46:04.451994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 3.743171691894531e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.34101382488479265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:47:51.532770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8808102154352371, "overlap_percentage": 0.9366284893677158, "num_intersection": 9013663, "num_union": 10233377, "num_only_computed": 609857, "num_only_roped": 609857, "total_diff": 1219714, "diff_percentage": 0.11918978456476294, "num_computed": 9623520, "num_roped": 9623520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "mask_shape": [1, 32, 656, 16016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:47:55.155810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11474609375, "mean_diff": 3.4332275390625e-05, "l2_diff": 1.5, "l2_diff_relative": 0.3076923076923077}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "attention_shape": [1, 32, 656, 16016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:49:40.117281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8470048400276573, "overlap_percentage": 0.9171658045194664, "num_intersection": 323400, "num_union": 381816, "num_only_computed": 29208, "num_only_roped": 29208, "total_diff": 58416, "diff_percentage": 0.1529951599723427, "num_computed": 352608, "num_roped": 352608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "mask_shape": [1, 32, 24, 16040], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:49:43.408462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.1953125, "l2_diff_relative": 0.15527950310559005}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "attention_shape": [1, 32, 24, 16040]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:51:25.033370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8454967968848135, "overlap_percentage": 0.9162809692349578, "num_intersection": 13462, "num_union": 15922, "num_only_computed": 1230, "num_only_roped": 1230, "total_diff": 2460, "diff_percentage": 0.15450320311518653, "num_computed": 14692, "num_roped": 14692}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "mask_shape": [1, 32, 1, 16041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:51:28.231889", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.0263671875, "l2_diff_relative": 0.13917525773195877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "attention_shape": [1, 32, 1, 16041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:53:06.977352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8441167241920301, "overlap_percentage": 0.9154699516776696, "num_intersection": 13451, "num_union": 15935, "num_only_computed": 1242, "num_only_roped": 1242, "total_diff": 2484, "diff_percentage": 0.15588327580796987, "num_computed": 14693, "num_roped": 14693}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "mask_shape": [1, 32, 1, 16042], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:53:10.208181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.04052734375, "l2_diff_relative": 0.18778280542986425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "attention_shape": [1, 32, 1, 16042]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:54:49.664314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.845863953269267, "overlap_percentage": 0.91649652919559, "num_intersection": 13467, "num_union": 15921, "num_only_computed": 1227, "num_only_roped": 1227, "total_diff": 2454, "diff_percentage": 0.154136046730733, "num_computed": 14694, "num_roped": 14694}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "mask_shape": [1, 32, 1, 16043], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:54:53.490414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.02734375, "l2_diff_relative": 0.09333333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "attention_shape": [1, 32, 1, 16043]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:55:49.852550", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:55:49.866213", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:55:50.291462", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909970760345459, "overlap_percentage": 0.9528635508334916, "num_intersection": 1908347, "num_union": 2097152, "num_only_computed": 188805, "num_only_roped": 0, "total_diff": 188805, "diff_percentage": 0.09002923965454102, "num_computed": 2097152, "num_roped": 1908347}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:55:50.300991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 1.8402934074401855e-06, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.003138469827586207}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:55:59.356722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9293390884660959, "overlap_percentage": 0.9633755870306435, "num_intersection": 2875206, "num_union": 3093818, "num_only_computed": 217274, "num_only_roped": 1338, "total_diff": 218612, "diff_percentage": 0.07066091153390407, "num_computed": 3092480, "num_roped": 2876544}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:55:59.936755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.0162080223880597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:56:21.053316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9474614226408615, "overlap_percentage": 0.9730220189481888, "num_intersection": 3835357, "num_union": 4048035, "num_only_computed": 201251, "num_only_roped": 11427, "total_diff": 212678, "diff_percentage": 0.052538577359138444, "num_computed": 4036608, "num_roped": 3846784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:56:21.816700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.2109375, "l2_diff_relative": 0.025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:56:49.083295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9547246120979629, "overlap_percentage": 0.9768379711280946, "num_intersection": 4785412, "num_union": 5012348, "num_only_computed": 195324, "num_only_roped": 31612, "total_diff": 226936, "diff_percentage": 0.045275387902037126, "num_computed": 4980736, "num_roped": 4817024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:56:50.031082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.2186508178710938e-06, "l2_diff": 0.1572265625, "l2_diff_relative": 0.018362226277372263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:57:25.025811", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9563860388546165, "overlap_percentage": 0.9777068736541804, "num_intersection": 5724638, "num_union": 5985698, "num_only_computed": 199202, "num_only_roped": 61858, "total_diff": 261060, "diff_percentage": 0.043613961145383545, "num_computed": 5923840, "num_roped": 5786496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:57:26.183482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.339482307434082e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014744718309859154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:58:06.362633", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9551214892250735, "overlap_percentage": 0.9770456664599833, "num_intersection": 6655979, "num_union": 6968725, "num_only_computed": 211989, "num_only_roped": 100757, "total_diff": 312746, "diff_percentage": 0.04487851077492655, "num_computed": 6867968, "num_roped": 6756736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:58:07.709679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.205371856689453e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.017972103004291844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:58:55.335122", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9521400721011078, "overlap_percentage": 0.9754833535856984, "num_intersection": 7578179, "num_union": 7959101, "num_only_computed": 232893, "num_only_roped": 148029, "total_diff": 380922, "diff_percentage": 0.047859927898892096, "num_computed": 7811072, "num_roped": 7726208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:58:59.516424", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.9371509552001953e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01652428057553957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:59:55.274222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9473884304806136, "overlap_percentage": 0.9729835256819299, "num_intersection": 8490083, "num_union": 8961565, "num_only_computed": 265117, "num_only_roped": 206365, "total_diff": 471482, "diff_percentage": 0.0526115695193864, "num_computed": 8755200, "num_roped": 8696448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T14:59:57.117366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 2.6702880859375e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.15485074626865672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:00:58.730915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9415874022903413, "overlap_percentage": 0.9699150305359657, "num_intersection": 9391695, "num_union": 9974321, "num_only_computed": 307633, "num_only_roped": 274993, "total_diff": 582626, "diff_percentage": 0.058412597709658634, "num_computed": 9699328, "num_roped": 9666688}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:01:00.854765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 5.269050598144531e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.4025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:02:11.103412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9336916466411105, "overlap_percentage": 0.9657089311659025, "num_intersection": 10271877, "num_union": 11001359, "num_only_computed": 370555, "num_only_roped": 358927, "total_diff": 729482, "diff_percentage": 0.06630835335888957, "num_computed": 10642432, "num_roped": 10630804}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:02:15.840609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 5.555152893066406e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.43630573248407645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:03:34.587097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9257685714660888, "overlap_percentage": 0.96145360889476, "num_intersection": 11139327, "num_union": 12032518, "num_only_computed": 447233, "num_only_roped": 445958, "total_diff": 893191, "diff_percentage": 0.0742314285339112, "num_computed": 11586560, "num_roped": 11585285}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:03:39.890611", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.39814814814814814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:05:06.065010", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9202428061185511, "overlap_percentage": 0.9584650474266508, "num_intersection": 12009245, "num_union": 13050083, "num_only_computed": 520419, "num_only_roped": 520419, "total_diff": 1040838, "diff_percentage": 0.07975719388144888, "num_computed": 12529664, "num_roped": 12529664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:05:09.073149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.3680203045685279}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:06:46.657685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9124961995045091, "overlap_percentage": 0.9542462879046968, "num_intersection": 12857316, "num_union": 14090268, "num_only_computed": 616476, "num_only_roped": 616476, "total_diff": 1232952, "diff_percentage": 0.08750380049549093, "num_computed": 13473792, "num_roped": 13473792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:06:50.748750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.4345855712890625e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.4088235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:08:34.538599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9062754597867255, "overlap_percentage": 0.9508336847478693, "num_intersection": 13709044, "num_union": 15126796, "num_only_computed": 708876, "num_only_roped": 708876, "total_diff": 1417752, "diff_percentage": 0.0937245402132745, "num_computed": 14417920, "num_roped": 14417920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:08:37.967246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10791015625, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.6640625, "l2_diff_relative": 0.30603448275862066}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:10:22.277147", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8694244935878616, "overlap_percentage": 0.9301520297503251, "num_intersection": 3461691, "num_union": 3981589, "num_only_computed": 259949, "num_only_roped": 259949, "total_diff": 519898, "diff_percentage": 0.13057550641213847, "num_computed": 3721640, "num_roped": 3721640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "mask_shape": [1, 32, 260, 15620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:10:25.724360", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.109375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.18487394957983194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "attention_shape": [1, 32, 260, 15620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:12:06.487251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8634851715821953, "overlap_percentage": 0.9267421976307455, "num_intersection": 358766, "num_union": 415486, "num_only_computed": 28360, "num_only_roped": 28360, "total_diff": 56720, "diff_percentage": 0.13651482841780468, "num_computed": 387126, "num_roped": 387126}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "mask_shape": [1, 32, 27, 15647], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:12:09.690202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.11669921875, "l2_diff_relative": 0.09892384105960265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "attention_shape": [1, 32, 27, 15647]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:13:47.070183", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8551005886538586, "overlap_percentage": 0.9218913452820978, "num_intersection": 13219, "num_union": 15459, "num_only_computed": 1120, "num_only_roped": 1120, "total_diff": 2240, "diff_percentage": 0.1448994113461414, "num_computed": 14339, "num_roped": 14339}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "mask_shape": [1, 32, 1, 15648], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:13:50.163527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.0247802734375, "l2_diff_relative": 0.0926094890510949}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "attention_shape": [1, 32, 1, 15648]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:15:25.379488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8516366453612241, "overlap_percentage": 0.9198744769874477, "num_intersection": 13191, "num_union": 15489, "num_only_computed": 1149, "num_only_roped": 1149, "total_diff": 2298, "diff_percentage": 0.1483633546387759, "num_computed": 14340, "num_roped": 14340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "mask_shape": [1, 32, 1, 15649], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:15:28.482473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.011474609375, "mean_diff": 1.5020370483398438e-05, "l2_diff": 0.0203857421875, "l2_diff_relative": 0.07789179104477612}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "attention_shape": [1, 32, 1, 15649]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:17:05.489221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8484243088225817, "overlap_percentage": 0.917997350254515, "num_intersection": 13165, "num_union": 15517, "num_only_computed": 1176, "num_only_roped": 1176, "total_diff": 2352, "diff_percentage": 0.15157569117741831, "num_computed": 14341, "num_roped": 14341}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "mask_shape": [1, 32, 1, 15650], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:17:09.954731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04150390625, "mean_diff": 2.872943878173828e-05, "l2_diff": 0.05029296875, "l2_diff_relative": 0.1996124031007752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "attention_shape": [1, 32, 1, 15650]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:18:46.652875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8551193325140677, "overlap_percentage": 0.9219022383376334, "num_intersection": 13221, "num_union": 15461, "num_only_computed": 1120, "num_only_roped": 1120, "total_diff": 2240, "diff_percentage": 0.14488066748593234, "num_computed": 14341, "num_roped": 14341}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "mask_shape": [1, 32, 1, 15651], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:18:51.150280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 3.814697265625e-05, "l2_diff": 0.045166015625, "l2_diff_relative": 0.19764957264957264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "attention_shape": [1, 32, 1, 15651]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:20:27.224731", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8484340765562572, "overlap_percentage": 0.918003067912425, "num_intersection": 13166, "num_union": 15518, "num_only_computed": 1176, "num_only_roped": 1176, "total_diff": 2352, "diff_percentage": 0.15156592344374276, "num_computed": 14342, "num_roped": 14342}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "mask_shape": [1, 32, 1, 15652], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:20:30.332800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0223388671875, "mean_diff": 2.682209014892578e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.16}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "attention_shape": [1, 32, 1, 15652]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:22:07.302630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8449961409827631, "overlap_percentage": 0.9159868925608311, "num_intersection": 13138, "num_union": 15548, "num_only_computed": 1205, "num_only_roped": 1205, "total_diff": 2410, "diff_percentage": 0.15500385901723696, "num_computed": 14343, "num_roped": 14343}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "mask_shape": [1, 32, 1, 15653], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-14T15:22:10.439949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.129149377593361}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "attention_shape": [1, 32, 1, 15653]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
