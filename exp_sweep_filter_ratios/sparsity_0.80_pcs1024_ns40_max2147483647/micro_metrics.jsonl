{"timestamp": "2025-11-12T18:54:21.366316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:54:21.410777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030764910130718953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:54:27.281647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891268739852424, "overlap_percentage": 0.9425088260296312, "num_intersection": 1738499, "num_union": 1950589, "num_only_computed": 200957, "num_only_roped": 11133, "total_diff": 212090, "diff_percentage": 0.10873126014757593, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:54:27.694951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.67572021484375e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.016053082191780824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:54:42.814165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9110305475423017, "overlap_percentage": 0.9534442541632219, "num_intersection": 2583300, "num_union": 2835580, "num_only_computed": 194812, "num_only_roped": 57468, "total_diff": 252280, "diff_percentage": 0.08896945245769824, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:54:43.379896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.015393518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:55:03.956736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9041839096135733, "overlap_percentage": 0.9496812834607603, "num_intersection": 3394480, "num_union": 3754192, "num_only_computed": 222288, "num_only_roped": 137424, "total_diff": 359712, "diff_percentage": 0.09581609038642669, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:55:04.702677", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.155801773071289e-06, "l2_diff": 0.2294921875, "l2_diff_relative": 0.025499131944444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:55:31.232148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8853446280904005, "overlap_percentage": 0.939185987430993, "num_intersection": 4170106, "num_union": 4710150, "num_only_computed": 286342, "num_only_roped": 253702, "total_diff": 540044, "diff_percentage": 0.11465537190959948, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:55:32.143477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.01965725806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:56:04.830404", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8562049947638877, "overlap_percentage": 0.9225327991026102, "num_intersection": 4884319, "num_union": 5704614, "num_only_computed": 410785, "num_only_roped": 409510, "total_diff": 820295, "diff_percentage": 0.14379500523611238, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:56:05.952162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.637505531311035e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01688878676470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:56:46.145157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8262820426933206, "overlap_percentage": 0.9048788997287145, "num_intersection": 5550310, "num_union": 6717210, "num_only_computed": 583450, "num_only_roped": 583450, "total_diff": 1166900, "diff_percentage": 0.1737179573066794, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:56:47.477363", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.017269736842105265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:57:33.050518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8059319200143181, "overlap_percentage": 0.8925385404427963, "num_intersection": 6223150, "num_union": 7721682, "num_only_computed": 749266, "num_only_roped": 749266, "total_diff": 1498532, "diff_percentage": 0.19406807998568187, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:57:36.088065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.019369834710743803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:58:29.448225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7891991867018212, "overlap_percentage": 0.8821814726582984, "num_intersection": 6890783, "num_union": 8731361, "num_only_computed": 920289, "num_only_roped": 920289, "total_diff": 1840578, "diff_percentage": 0.21080081329817882, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:58:32.431657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.20815899581589958}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:59:32.881580", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7753736041312328, "overlap_percentage": 0.8734765486283735, "num_intersection": 7556229, "num_union": 9745275, "num_only_computed": 1094523, "num_only_roped": 1094523, "total_diff": 2189046, "diff_percentage": 0.22462639586876718, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T18:59:34.975059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.5636363636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:00:45.321703", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7673283480017701, "overlap_percentage": 0.8683483732599547, "num_intersection": 8240112, "num_union": 10738704, "num_only_computed": 1249296, "num_only_roped": 1249296, "total_diff": 2498592, "diff_percentage": 0.23267165199822995, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:00:49.108691", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 3.933906555175781e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.30128205128205127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:01:57.941442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7213319730945527, "overlap_percentage": 0.8381090741000603, "num_intersection": 507672, "num_union": 703798, "num_only_computed": 98063, "num_only_roped": 98063, "total_diff": 196126, "diff_percentage": 0.2786680269054473, "num_computed": 605735, "num_roped": 605735}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:02:00.299590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08740234375, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:03:05.993471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7204445365354698, "overlap_percentage": 0.8375097496444247, "num_intersection": 219049, "num_union": 304047, "num_only_computed": 42499, "num_only_roped": 42499, "total_diff": 84998, "diff_percentage": 0.27955546346453014, "num_computed": 261548, "num_roped": 261548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:03:09.333714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.11767578125, "l2_diff_relative": 0.09297839506172839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:04:12.537613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7190173889042231, "overlap_percentage": 0.8365446371226718, "num_intersection": 7815, "num_union": 10869, "num_only_computed": 1527, "num_only_roped": 1527, "total_diff": 3054, "diff_percentage": 0.280982611095777, "num_computed": 9342, "num_roped": 9342}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:04:14.529993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.017578125, "l2_diff_relative": 0.08035714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:05:16.967962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7171475831648594, "overlap_percentage": 0.835277748046666, "num_intersection": 7804, "num_union": 10882, "num_only_computed": 1539, "num_only_roped": 1539, "total_diff": 3078, "diff_percentage": 0.2828524168351406, "num_computed": 9343, "num_roped": 9343}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:05:18.951257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00506591796875, "mean_diff": 1.430511474609375e-05, "l2_diff": 0.0126953125, "l2_diff_relative": 0.051181102362204724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:06:19.762532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7219202063945452, "overlap_percentage": 0.838505993150685, "num_intersection": 7835, "num_union": 10853, "num_only_computed": 1509, "num_only_roped": 1509, "total_diff": 3018, "diff_percentage": 0.2780797936054547, "num_computed": 9344, "num_roped": 9344}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:06:23.341757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.3034188034188034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:07:24.066742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7069784435513335, "overlap_percentage": 0.8283390410958904, "num_intersection": 7740, "num_union": 10948, "num_only_computed": 1604, "num_only_roped": 1604, "total_diff": 3208, "diff_percentage": 0.2930215564486664, "num_computed": 9344, "num_roped": 9344}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:07:26.020384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008056640625, "mean_diff": 1.3470649719238281e-05, "l2_diff": 0.0152587890625, "l2_diff_relative": 0.07038288288288289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:04.224261", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:04.237908", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003127639358108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:10.283369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8913996433650833, "overlap_percentage": 0.9425820148502828, "num_intersection": 1738634, "num_union": 1950454, "num_only_computed": 200822, "num_only_roped": 10998, "total_diff": 211820, "diff_percentage": 0.1086003566349168, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:10.687522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.014818548387096774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:28.090036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909931298753847, "overlap_percentage": 0.9528419156726113, "num_intersection": 2581668, "num_union": 2837212, "num_only_computed": 196444, "num_only_roped": 59100, "total_diff": 255544, "diff_percentage": 0.09006870124615292, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:28.643693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.015219155844155844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:50.403747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9042630385004299, "overlap_percentage": 0.9497249279306702, "num_intersection": 3394636, "num_union": 3754036, "num_only_computed": 222132, "num_only_roped": 137268, "total_diff": 359400, "diff_percentage": 0.09573696149957006, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:08:51.144306", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.692243576049805e-06, "l2_diff": 0.232421875, "l2_diff_relative": 0.02618838028169014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:09:18.230779", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8868496532270042, "overlap_percentage": 0.9400321342087435, "num_intersection": 4173863, "num_union": 4706393, "num_only_computed": 282585, "num_only_roped": 249945, "total_diff": 532530, "diff_percentage": 0.11315034677299579, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:09:19.158091", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.01730769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:09:54.922759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8570451977391221, "overlap_percentage": 0.9230202892019432, "num_intersection": 4886900, "num_union": 5702033, "num_only_computed": 408204, "num_only_roped": 406929, "total_diff": 815133, "diff_percentage": 0.14295480226087784, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:09:56.044219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.7120113372802734e-06, "l2_diff": 0.11767578125, "l2_diff_relative": 0.01394675925925926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:10:35.715980", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8273906304580497, "overlap_percentage": 0.9055432556865609, "num_intersection": 5554385, "num_union": 6713135, "num_only_computed": 579375, "num_only_roped": 579375, "total_diff": 1158750, "diff_percentage": 0.17260936954195022, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:10:37.052097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.5779008865356445e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.018287037037037036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:11:23.239496", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8071158847594343, "overlap_percentage": 0.8932641139025554, "num_intersection": 6228209, "num_union": 7716623, "num_only_computed": 744207, "num_only_roped": 744207, "total_diff": 1488414, "diff_percentage": 0.19288411524056573, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:11:26.948322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.175569534301758e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.015513392857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:12:20.566094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7927086933750488, "overlap_percentage": 0.8843697766452543, "num_intersection": 6907876, "num_union": 8714268, "num_only_computed": 903196, "num_only_roped": 903196, "total_diff": 1806392, "diff_percentage": 0.20729130662495118, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:12:24.636415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07763671875, "mean_diff": 2.5987625122070312e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.12692307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:13:24.931815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7742133432215765, "overlap_percentage": 0.8727398496685606, "num_intersection": 7549856, "num_union": 9751648, "num_only_computed": 1100896, "num_only_roped": 1100896, "total_diff": 2201792, "diff_percentage": 0.2257866567784235, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:13:27.000191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 4.410743713378906e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.2832618025751073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:14:34.101574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7602303541446411, "overlap_percentage": 0.8637850748961369, "num_intersection": 8196809, "num_union": 10782007, "num_only_computed": 1292599, "num_only_roped": 1292599, "total_diff": 2585198, "diff_percentage": 0.23976964585535884, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:14:36.387799", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.43386243386243384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:50.274912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7503703922140862, "overlap_percentage": 0.8573846947501487, "num_intersection": 8855124, "num_union": 11801004, "num_only_computed": 1472940, "num_only_roped": 1472940, "total_diff": 2945880, "diff_percentage": 0.2496296077859138, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:15:53.611837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10205078125, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.27427184466019416}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:15.363059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.742061696770389, "overlap_percentage": 0.8519350355341586, "num_intersection": 9513320, "num_union": 12820120, "num_only_computed": 1653400, "num_only_roped": 1653400, "total_diff": 3306800, "diff_percentage": 0.257938303229611, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:17:18.161900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 4.00543212890625e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.32790697674418606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:48.247961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7366665292421326, "overlap_percentage": 0.8483684309429376, "num_intersection": 10184982, "num_union": 13825770, "num_only_computed": 1820394, "num_only_roped": 1820394, "total_diff": 3640788, "diff_percentage": 0.2633334707578674, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:18:53.606466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.453416149068323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:20:32.701018", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7324369657682334, "overlap_percentage": 0.845556843037508, "num_intersection": 10861225, "num_union": 14828887, "num_only_computed": 1983831, "num_only_roped": 1983831, "total_diff": 3967662, "diff_percentage": 0.2675630342317667, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:20:36.056419", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.4664429530201342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:22:27.154103", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7309801382354629, "overlap_percentage": 0.8445852405685185, "num_intersection": 10011330, "num_union": 13695762, "num_only_computed": 1842216, "num_only_roped": 1842216, "total_diff": 3684432, "diff_percentage": 0.26901986176453707, "num_computed": 11853546, "num_roped": 11853546}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 894, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:22:31.802697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.5, "l2_diff_relative": 0.4624277456647399}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 894, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:24:19.021020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7103169254852307, "overlap_percentage": 0.8306260844418739, "num_intersection": 574461, "num_union": 808739, "num_only_computed": 117139, "num_only_roped": 117139, "total_diff": 234278, "diff_percentage": 0.28968307451476927, "num_computed": 691600, "num_roped": 691600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:24:22.405847", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.193359375, "l2_diff_relative": 0.11785714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:26:00.991719", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7074454428754814, "overlap_percentage": 0.828659499285768, "num_intersection": 11022, "num_union": 15580, "num_only_computed": 2279, "num_only_roped": 2279, "total_diff": 4558, "diff_percentage": 0.2925545571245186, "num_computed": 13301, "num_roped": 13301}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:26:04.041420", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0174560546875, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.1400523560209424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:27:37.656149", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6983083306734759, "overlap_percentage": 0.8223575402195159, "num_intersection": 10939, "num_union": 15665, "num_only_computed": 2363, "num_only_roped": 2363, "total_diff": 4726, "diff_percentage": 0.3016916693265241, "num_computed": 13302, "num_roped": 13302}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:27:40.702404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.031005859375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.056396484375, "l2_diff_relative": 0.29922279792746115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:29:14.760062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7084697874526424, "overlap_percentage": 0.8293617980906562, "num_intersection": 11033, "num_union": 15573, "num_only_computed": 2270, "num_only_roped": 2270, "total_diff": 4540, "diff_percentage": 0.2915302125473576, "num_computed": 13303, "num_roped": 13303}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:29:17.825319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.0224609375, "l2_diff_relative": 0.09787234042553192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:12.563581", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:12.577271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.003156043046357616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:18.655397", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891420007762379, "overlap_percentage": 0.9425933997779397, "num_intersection": 1738655, "num_union": 1950433, "num_only_computed": 200801, "num_only_roped": 10977, "total_diff": 211778, "diff_percentage": 0.10857999223762108, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:19.054518", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.556510925292969e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015735815602836878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:36.240396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9108580326930048, "overlap_percentage": 0.9533497696941066, "num_intersection": 2583044, "num_union": 2835836, "num_only_computed": 195068, "num_only_roped": 57724, "total_diff": 252792, "diff_percentage": 0.08914196730699518, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:36.796807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.827976226806641e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.015510110294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:58.541576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9035881180188248, "overlap_percentage": 0.9493525510752207, "num_intersection": 3393305, "num_union": 3755367, "num_only_computed": 223463, "num_only_roped": 138599, "total_diff": 362062, "diff_percentage": 0.09641188198117522, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:30:59.284869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.2275390625, "l2_diff_relative": 0.02657390510948905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:31:26.005992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8855199638534161, "overlap_percentage": 0.9392846332357986, "num_intersection": 4170544, "num_union": 4709712, "num_only_computed": 285904, "num_only_roped": 253264, "total_diff": 539168, "diff_percentage": 0.1144800361465839, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:31:26.933697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.01784206081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:32:02.428506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8573491080668643, "overlap_percentage": 0.9231965109232441, "num_intersection": 4887833, "num_union": 5701100, "num_only_computed": 407271, "num_only_roped": 405996, "total_diff": 813267, "diff_percentage": 0.1426508919331357, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:32:03.586200", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.682209014892578e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.016183035714285716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:32:43.129564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8288254926900768, "overlap_percentage": 0.906401945951586, "num_intersection": 5559652, "num_union": 6707868, "num_only_computed": 574108, "num_only_roped": 574108, "total_diff": 1148216, "diff_percentage": 0.1711745073099232, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:32:44.467989", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.5779008865356445e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.018342391304347828}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:33:31.511253", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.80628678273068, "overlap_percentage": 0.892756112085108, "num_intersection": 6224667, "num_union": 7720165, "num_only_computed": 747749, "num_only_roped": 747749, "total_diff": 1495498, "diff_percentage": 0.19371321726932003, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:33:33.063905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.017210144927536232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:34:28.297444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7875582879143774, "overlap_percentage": 0.8811553651022549, "num_intersection": 6882768, "num_union": 8739376, "num_only_computed": 928304, "num_only_roped": 928304, "total_diff": 1856608, "diff_percentage": 0.2124417120856226, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:34:32.022414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.19279661016949154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:35:31.918506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7730169862807059, "overlap_percentage": 0.8719792221531724, "num_intersection": 7543276, "num_union": 9758228, "num_only_computed": 1107476, "num_only_roped": 1107476, "total_diff": 2214952, "diff_percentage": 0.2269830137192941, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:35:33.961134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.7220458984375e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.42786069651741293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:36:41.440685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7610251178860887, "overlap_percentage": 0.8642978571476746, "num_intersection": 8201675, "num_union": 10777141, "num_only_computed": 1287733, "num_only_roped": 1287733, "total_diff": 2575466, "diff_percentage": 0.2389748821139113, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:36:43.700728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 4.863739013671875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.3886138613861386}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:37:57.516370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7537174785101746, "overlap_percentage": 0.8595654519569205, "num_intersection": 8877647, "num_union": 11778481, "num_only_computed": 1450417, "num_only_roped": 1450417, "total_diff": 2900834, "diff_percentage": 0.24628252148982538, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:38:02.463170", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.39552238805970147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:39:23.692935", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7430905456547184, "overlap_percentage": 0.8526126740887208, "num_intersection": 9520887, "num_union": 12812553, "num_only_computed": 1645833, "num_only_roped": 1645833, "total_diff": 3291666, "diff_percentage": 0.25690945434528156, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:39:26.437724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.982948303222656e-05, "l2_diff": 2.953125, "l2_diff_relative": 0.4276018099547511}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:40:56.232915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7381849834207973, "overlap_percentage": 0.8493744802328557, "num_intersection": 10197060, "num_union": 13813692, "num_only_computed": 1808316, "num_only_roped": 1808316, "total_diff": 3616632, "diff_percentage": 0.2618150165792027, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:41:01.204785", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 4.7206878662109375e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.4708994708994709}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:42:39.082441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7308501367897903, "overlap_percentage": 0.8444984591737086, "num_intersection": 10847630, "num_union": 14842482, "num_only_computed": 1997426, "num_only_roped": 1997426, "total_diff": 3994852, "diff_percentage": 0.2691498632102097, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:42:42.373603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10791015625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.39166666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:44:28.066077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7200586850748265, "overlap_percentage": 0.8372489744947305, "num_intersection": 10405347, "num_union": 14450693, "num_only_computed": 2022673, "num_only_roped": 2022673, "total_diff": 4045346, "diff_percentage": 0.2799413149251735, "num_computed": 12428020, "num_roped": 12428020}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:44:32.097798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.46}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:46:17.298251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6868685802358356, "overlap_percentage": 0.8143711825372985, "num_intersection": 325325, "num_union": 473635, "num_only_computed": 74155, "num_only_roped": 74155, "total_diff": 148310, "diff_percentage": 0.31313141976416436, "num_computed": 399480, "num_roped": 399480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:46:20.609008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.1318359375, "l2_diff_relative": 0.10044642857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:47:59.218684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6754954388172382, "overlap_percentage": 0.8063232201862421, "num_intersection": 10737, "num_union": 15895, "num_only_computed": 2579, "num_only_roped": 2579, "total_diff": 5158, "diff_percentage": 0.3245045611827619, "num_computed": 13316, "num_roped": 13316}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:48:02.276808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.02685546875, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:48:58.377216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:48:58.390842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.003043519938650307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:04.378529", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8914878922539035, "overlap_percentage": 0.9426313495367961, "num_intersection": 1738725, "num_union": 1950363, "num_only_computed": 200731, "num_only_roped": 10907, "total_diff": 211638, "diff_percentage": 0.1085121077460965, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:04.767762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:22.356786", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9113608386329888, "overlap_percentage": 0.9536251033423881, "num_intersection": 2583790, "num_union": 2835090, "num_only_computed": 194322, "num_only_roped": 56978, "total_diff": 251300, "diff_percentage": 0.08863916136701128, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:22.909016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.036592483520508e-06, "l2_diff": 0.1201171875, "l2_diff_relative": 0.016150210084033615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:44.139668", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9054299381859656, "overlap_percentage": 0.9503681243173557, "num_intersection": 3396935, "num_union": 3751737, "num_only_computed": 219833, "num_only_roped": 134969, "total_diff": 354802, "diff_percentage": 0.0945700618140344, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:49:44.899452", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.201171875, "l2_diff_relative": 0.02774784482758621}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:50:12.420001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8856717076494697, "overlap_percentage": 0.9393699911353907, "num_intersection": 4170923, "num_union": 4709333, "num_only_computed": 285525, "num_only_roped": 252885, "total_diff": 538410, "diff_percentage": 0.11432829235053033, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:50:15.551762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.5315752029418945e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.018954918032786885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:50:48.578405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8593297274973412, "overlap_percentage": 0.9243435575614654, "num_intersection": 4893906, "num_union": 5695027, "num_only_computed": 401198, "num_only_roped": 399923, "total_diff": 801121, "diff_percentage": 0.1406702725026589, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:50:49.705890", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.8312206268310547e-06, "l2_diff": 0.11572265625, "l2_diff_relative": 0.015176741803278689}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:51:30.553379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8295013414581404, "overlap_percentage": 0.9068059395868113, "num_intersection": 5562130, "num_union": 6705390, "num_only_computed": 571630, "num_only_roped": 571630, "total_diff": 1143260, "diff_percentage": 0.1704986585418596, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:51:31.892652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.018982438016528925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:52:17.810080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8103426139013918, "overlap_percentage": 0.8952367443365399, "num_intersection": 6241963, "num_union": 7702869, "num_only_computed": 730453, "num_only_roped": 730453, "total_diff": 1460906, "diff_percentage": 0.1896573860986082, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:52:20.877515", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.3692846298217773e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.017634854771784232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:13.957141", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7936413005352515, "overlap_percentage": 0.8849498506735055, "num_intersection": 6912407, "num_union": 8709737, "num_only_computed": 898665, "num_only_roped": 898665, "total_diff": 1797330, "diff_percentage": 0.20635869946474847, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:53:16.256041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 2.7894973754882812e-05, "l2_diff": 1.25, "l2_diff_relative": 0.16806722689075632}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:15.981180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7805966620934354, "overlap_percentage": 0.8767810012354995, "num_intersection": 7584815, "num_union": 9716689, "num_only_computed": 1065937, "num_only_roped": 1065937, "total_diff": 2131874, "diff_percentage": 0.2194033379065647, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:54:18.035858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.4175531914893617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:25.731168", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.765428392854834, "overlap_percentage": 0.8671304890673897, "num_intersection": 8228555, "num_union": 10750261, "num_only_computed": 1260853, "num_only_roped": 1260853, "total_diff": 2521706, "diff_percentage": 0.23457160714516606, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:55:28.076975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.3994708994708995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:46.850479", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7510930275970076, "overlap_percentage": 0.8578562255230022, "num_intersection": 8859994, "num_union": 11796134, "num_only_computed": 1468070, "num_only_roped": 1468070, "total_diff": 2936140, "diff_percentage": 0.24890697240299237, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:56:49.499167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.38333333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:58:14.516456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7399713077504756, "overlap_percentage": 0.8505557585396607, "num_intersection": 9497918, "num_union": 12835522, "num_only_computed": 1668802, "num_only_roped": 1668802, "total_diff": 3337604, "diff_percentage": 0.2600286922495244, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:58:20.022046", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.3380952380952381}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T19:59:54.309329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7423215442595315, "overlap_percentage": 0.8521062563971341, "num_intersection": 10229856, "num_union": 13780896, "num_only_computed": 1775520, "num_only_roped": 1775520, "total_diff": 3551040, "diff_percentage": 0.25767845574046855, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:00:00.113825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.3778409090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:01:44.501086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7336170361513249, "overlap_percentage": 0.8463426706742267, "num_intersection": 10871319, "num_union": 14818793, "num_only_computed": 1973737, "num_only_roped": 1973737, "total_diff": 3947474, "diff_percentage": 0.2663829638486751, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:01:47.940171", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.8046875, "l2_diff_relative": 0.3055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:03:36.533585", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7322777261862523, "overlap_percentage": 0.845450720882292, "num_intersection": 10851918, "num_union": 14819402, "num_only_computed": 1983742, "num_only_roped": 1983742, "total_diff": 3967484, "diff_percentage": 0.2677222738137477, "num_computed": 12835660, "num_roped": 12835660}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:03:42.651290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.00543212890625e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.3898809523809524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:05:28.407403", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.69796407726529, "overlap_percentage": 0.8221187793200174, "num_intersection": 339979, "num_union": 487101, "num_only_computed": 73561, "num_only_roped": 73561, "total_diff": 147122, "diff_percentage": 0.30203592273471, "num_computed": 413540, "num_roped": 413540}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:05:34.117499", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.1474609375, "l2_diff_relative": 0.11038011695906433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:07:11.236433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6917126371187623, "overlap_percentage": 0.8177661169415292, "num_intersection": 10909, "num_union": 15771, "num_only_computed": 2431, "num_only_roped": 2431, "total_diff": 4862, "diff_percentage": 0.3082873628812377, "num_computed": 13340, "num_roped": 13340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:07:14.320062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00885009765625, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.0216064453125, "l2_diff_relative": 0.10586124401913875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:07.242705", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:07.255341", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0030174026946107784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:13.279710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.892480531872326, "overlap_percentage": 0.9431859581555117, "num_intersection": 1739748, "num_union": 1949340, "num_only_computed": 199708, "num_only_roped": 9884, "total_diff": 209592, "diff_percentage": 0.10751946812767398, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:13.669807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.014401355421686747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:28.615197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9123051568802516, "overlap_percentage": 0.9541418152828629, "num_intersection": 2585190, "num_union": 2833690, "num_only_computed": 192922, "num_only_roped": 55578, "total_diff": 248500, "diff_percentage": 0.08769484311974846, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:31.505257", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.015524193548387097}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:52.180749", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9054852986490132, "overlap_percentage": 0.9503986194918441, "num_intersection": 3397044, "num_union": 3751628, "num_only_computed": 219724, "num_only_roped": 134860, "total_diff": 354584, "diff_percentage": 0.09451470135098683, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:08:52.928684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.244140625, "l2_diff_relative": 0.02396472392638037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:09:19.553931", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8858703327382111, "overlap_percentage": 0.9394816996266774, "num_intersection": 4171419, "num_union": 4708837, "num_only_computed": 285029, "num_only_roped": 252389, "total_diff": 537418, "diff_percentage": 0.11412966726178884, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:09:20.490343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.680586814880371e-06, "l2_diff": 0.1806640625, "l2_diff_relative": 0.019664115646258504}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:09:53.408050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8601750497458119, "overlap_percentage": 0.9248323697958992, "num_intersection": 4896494, "num_union": 5692439, "num_only_computed": 398610, "num_only_roped": 397335, "total_diff": 795945, "diff_percentage": 0.13982495025418806, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:09:56.053278", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.1240234375, "l2_diff_relative": 0.014174107142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:10:35.606001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8304510459777815, "overlap_percentage": 0.9073731283910684, "num_intersection": 5565609, "num_union": 6701911, "num_only_computed": 568151, "num_only_roped": 568151, "total_diff": 1136302, "diff_percentage": 0.16954895402221845, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:10:38.463605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.018606870229007633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:11:24.104324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8052920226103737, "overlap_percentage": 0.8921459935838596, "num_intersection": 6220413, "num_union": 7724419, "num_only_computed": 752003, "num_only_roped": 752003, "total_diff": 1504006, "diff_percentage": 0.19470797738962634, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:11:25.654909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.384185791015625e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.01680871212121212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:12:18.407150", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7870665028098965, "overlap_percentage": 0.8808474688237414, "num_intersection": 6880363, "num_union": 8741781, "num_only_computed": 930709, "num_only_roped": 930709, "total_diff": 1861418, "diff_percentage": 0.2129334971901035, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:12:20.219443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.039836883544922e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.1627155172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:13:19.999993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7725398031217552, "overlap_percentage": 0.8716755491314512, "num_intersection": 7540649, "num_union": 9760855, "num_only_computed": 1110103, "num_only_roped": 1110103, "total_diff": 2220206, "diff_percentage": 0.22746019687824479, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:13:23.796442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.43455497382198954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:14:30.928832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7612272715124411, "overlap_percentage": 0.8644282130139204, "num_intersection": 8202912, "num_union": 10775904, "num_only_computed": 1286496, "num_only_roped": 1286496, "total_diff": 2572992, "diff_percentage": 0.2387727284875589, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:14:34.906021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 5.9604644775390625e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.47554347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:15:50.922788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.753040134321964, "overlap_percentage": 0.8591248079020425, "num_intersection": 8873096, "num_union": 11783032, "num_only_computed": 1454968, "num_only_roped": 1454968, "total_diff": 2909936, "diff_percentage": 0.24695986567803602, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:15:53.484311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.4385026737967914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:17:16.803338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7461067153301678, "overlap_percentage": 0.8545946347718937, "num_intersection": 9543019, "num_union": 12790421, "num_only_computed": 1623701, "num_only_roped": 1623701, "total_diff": 3247402, "diff_percentage": 0.2538932846698322, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:17:22.071039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.38860103626943004}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:18:53.911515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7390230415147061, "overlap_percentage": 0.8499289818161464, "num_intersection": 10203717, "num_union": 13807035, "num_only_computed": 1801659, "num_only_roped": 1801659, "total_diff": 3603318, "diff_percentage": 0.2609769584852939, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:18:59.206540", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.38990825688073394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:20:32.284740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6981023897307671, "overlap_percentage": 0.8222147191506523, "num_intersection": 1490339, "num_union": 2134843, "num_only_computed": 322252, "num_only_roped": 322252, "total_diff": 644504, "diff_percentage": 0.3018976102692329, "num_computed": 1812591, "num_roped": 1812591}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:20:36.392807", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.22837837837837838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:22:05.522274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6915533406788571, "overlap_percentage": 0.8176547839766279, "num_intersection": 232855, "num_union": 336713, "num_only_computed": 51929, "num_only_roped": 51929, "total_diff": 103858, "diff_percentage": 0.30844665932114296, "num_computed": 284784, "num_roped": 284784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:22:08.397859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.777576446533203e-05, "l2_diff": 0.1669921875, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:23:34.797791", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6851746662879864, "overlap_percentage": 0.8131794050728912, "num_intersection": 9650, "num_union": 14084, "num_only_computed": 2217, "num_only_roped": 2217, "total_diff": 4434, "diff_percentage": 0.31482533371201366, "num_computed": 11867, "num_roped": 11867}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:23:37.453480", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013916015625, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.019287109375, "l2_diff_relative": 0.06539735099337748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:23.860951", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:23.875680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0030623070987654323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:29.899610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891454919177993, "overlap_percentage": 0.9426129167967802, "num_intersection": 1738691, "num_union": 1950397, "num_only_computed": 200765, "num_only_roped": 10941, "total_diff": 211706, "diff_percentage": 0.108545080822007, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:30.287644", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.015316611842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:45.362074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9110992926060438, "overlap_percentage": 0.9534819003188851, "num_intersection": 2583402, "num_union": 2835478, "num_only_computed": 194710, "num_only_roped": 57366, "total_diff": 252076, "diff_percentage": 0.08890070739395615, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:24:45.919367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.015517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:25:07.782969", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9039967655339732, "overlap_percentage": 0.9495780475030887, "num_intersection": 3394111, "num_union": 3754561, "num_only_computed": 222657, "num_only_roped": 137793, "total_diff": 360450, "diff_percentage": 0.0960032344660268, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:25:10.534032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.2197265625, "l2_diff_relative": 0.025475543478260868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:25:37.877590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.88748972591166, "overlap_percentage": 0.9403915833057065, "num_intersection": 4175459, "num_union": 4704797, "num_only_computed": 280989, "num_only_roped": 248349, "total_diff": 529338, "diff_percentage": 0.11251027408834005, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:25:39.781664", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017974624060150376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:26:12.843791", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8610008624033443, "overlap_percentage": 0.9253094716908682, "num_intersection": 4899020, "num_union": 5689913, "num_only_computed": 396084, "num_only_roped": 394809, "total_diff": 790893, "diff_percentage": 0.1389991375966557, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:26:13.977940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.015404929577464789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:26:54.692653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8280877570103903, "overlap_percentage": 0.9059606179570117, "num_intersection": 5556945, "num_union": 6710575, "num_only_computed": 576815, "num_only_roped": 576815, "total_diff": 1153630, "diff_percentage": 0.1719122429896097, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:26:56.025231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.5033950805664062e-06, "l2_diff": 0.15625, "l2_diff_relative": 0.017361111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:27:42.121553", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8065916970662256, "overlap_percentage": 0.8929429913533559, "num_intersection": 6225970, "num_union": 7718862, "num_only_computed": 746446, "num_only_roped": 746446, "total_diff": 1492892, "diff_percentage": 0.19340830293377442, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:27:45.062941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.115964889526367e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.015518707482993197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:28:38.490241", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.78883614849333, "overlap_percentage": 0.8819546151923833, "num_intersection": 6889011, "num_union": 8733133, "num_only_computed": 922061, "num_only_roped": 922061, "total_diff": 1844122, "diff_percentage": 0.21116385150667005, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:28:40.561067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.546875, "l2_diff_relative": 0.2053941908713693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:29:40.819616", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7730513272185119, "overlap_percentage": 0.8720010699647845, "num_intersection": 7543465, "num_union": 9758039, "num_only_computed": 1107287, "num_only_roped": 1107287, "total_diff": 2214574, "diff_percentage": 0.22694867278148817, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:29:42.886359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 6.628036499023438e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.5188172043010753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:30:50.028076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7602905977737334, "overlap_percentage": 0.8638239603566419, "num_intersection": 8197178, "num_union": 10781638, "num_only_computed": 1292230, "num_only_roped": 1292230, "total_diff": 2584460, "diff_percentage": 0.23970940222626655, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:30:52.348188", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 5.245208740234375e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.38235294117647056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:32:09.301006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7498337727515737, "overlap_percentage": 0.8570342902600139, "num_intersection": 8851505, "num_union": 11804623, "num_only_computed": 1476559, "num_only_roped": 1476559, "total_diff": 2953118, "diff_percentage": 0.2501662272484263, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:32:11.870310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 4.935264587402344e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.3958333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:33:35.500085", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7448339424727871, "overlap_percentage": 0.8537591163743695, "num_intersection": 9533689, "num_union": 12799751, "num_only_computed": 1633031, "num_only_roped": 1633031, "total_diff": 3266062, "diff_percentage": 0.25516605752721283, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:33:38.342363", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 4.506111145019531e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.38613861386138615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:35:12.005320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7355717676927904, "overlap_percentage": 0.8476420063811413, "num_intersection": 10176261, "num_union": 13834491, "num_only_computed": 1829115, "num_only_roped": 1829115, "total_diff": 3658230, "diff_percentage": 0.2644282323072096, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:35:15.082724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 4.100799560546875e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.3962765957446808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:36:48.247178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7007399191323564, "overlap_percentage": 0.8240412437544753, "num_intersection": 2476534, "num_union": 3534170, "num_only_computed": 528818, "num_only_roped": 528818, "total_diff": 1057636, "diff_percentage": 0.2992600808676436, "num_computed": 3005352, "num_roped": 3005352}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:36:51.252056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09423828125, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.3285024154589372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:38:21.033184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6887393533175261, "overlap_percentage": 0.8156846134538153, "num_intersection": 311970, "num_union": 452958, "num_only_computed": 70494, "num_only_roped": 70494, "total_diff": 140988, "diff_percentage": 0.3112606466824739, "num_computed": 382464, "num_roped": 382464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:38:23.876995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.1650390625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:39:50.539115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7054794520547946, "overlap_percentage": 0.8273092369477911, "num_intersection": 9888, "num_union": 14016, "num_only_computed": 2064, "num_only_roped": 2064, "total_diff": 4128, "diff_percentage": 0.2945205479452055, "num_computed": 11952, "num_roped": 11952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:39:53.229547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 4.4345855712890625e-05, "l2_diff": 0.04833984375, "l2_diff_relative": 0.2551546391752577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:40:41.680683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:40:41.693328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.0030137624172185433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:40:47.766575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8909497990176932, "overlap_percentage": 0.9423304621630061, "num_intersection": 1738170, "num_union": 1950918, "num_only_computed": 201286, "num_only_roped": 11462, "total_diff": 212748, "diff_percentage": 0.10905020098230679, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:40:48.153154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.8710575103759766e-06, "l2_diff": 0.12060546875, "l2_diff_relative": 0.013400607638888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:03.402640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9127587611515352, "overlap_percentage": 0.9543898370142908, "num_intersection": 2585862, "num_union": 2833018, "num_only_computed": 192250, "num_only_roped": 54906, "total_diff": 247156, "diff_percentage": 0.08724123884846478, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:03.951699", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.015294894366197184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:24.448624", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.903809151220089, "overlap_percentage": 0.9494745317731741, "num_intersection": 3393741, "num_union": 3754931, "num_only_computed": 223027, "num_only_roped": 138163, "total_diff": 361190, "diff_percentage": 0.096190848779911, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:25.187744", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.751848220825195e-06, "l2_diff": 0.228515625, "l2_diff_relative": 0.027083333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:51.638730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8817996860790889, "overlap_percentage": 0.9371876216181155, "num_intersection": 4161233, "num_union": 4719023, "num_only_computed": 295215, "num_only_roped": 262575, "total_diff": 557790, "diff_percentage": 0.11820031392091117, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:41:52.558779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.844499588012695e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.019667832167832168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:25.114875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8566502304126458, "overlap_percentage": 0.9227911820766077, "num_intersection": 4885687, "num_union": 5703246, "num_only_computed": 409417, "num_only_roped": 408142, "total_diff": 817559, "diff_percentage": 0.1433497695873543, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:42:26.247403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.7418136596679688e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.014406028368794326}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:06.731662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8288813853647686, "overlap_percentage": 0.9064353675396494, "num_intersection": 5559857, "num_union": 6707663, "num_only_computed": 573903, "num_only_roped": 573903, "total_diff": 1147806, "diff_percentage": 0.17111861463523137, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:08.052839", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.01893248175182482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:53.719930", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8069702335483712, "overlap_percentage": 0.8931749052265384, "num_intersection": 6227587, "num_union": 7717245, "num_only_computed": 744829, "num_only_roped": 744829, "total_diff": 1489658, "diff_percentage": 0.19302976645162878, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:43:57.207061", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.175569534301758e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.01584663120567376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:50.514616", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7833294140477849, "overlap_percentage": 0.878502208147614, "num_intersection": 6862044, "num_union": 8760100, "num_only_computed": 949028, "num_only_roped": 949028, "total_diff": 1898056, "diff_percentage": 0.21667058595221517, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:44:52.602800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.22380952380952382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:51.777179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7719184152683896, "overlap_percentage": 0.8712798609878077, "num_intersection": 7537226, "num_union": 9764278, "num_only_computed": 1113526, "num_only_roped": 1113526, "total_diff": 2227052, "diff_percentage": 0.22808158473161047, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:45:53.793609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 5.602836608886719e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.4}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:47:01.661006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.766932138869793, "overlap_percentage": 0.8680946166504802, "num_intersection": 8237704, "num_union": 10741112, "num_only_computed": 1251704, "num_only_roped": 1251704, "total_diff": 2503408, "diff_percentage": 0.233067861130207, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:47:03.928687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 5.030632019042969e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.40476190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:48:17.694748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7553395140911097, "overlap_percentage": 0.8606192796636427, "num_intersection": 8888531, "num_union": 11767597, "num_only_computed": 1439533, "num_only_roped": 1439533, "total_diff": 2879066, "diff_percentage": 0.2446604859088903, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:48:21.752218", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10009765625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.3903061224489796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:49:43.083384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7387312844636953, "overlap_percentage": 0.8497360012608896, "num_intersection": 9488764, "num_union": 12844676, "num_only_computed": 1677956, "num_only_roped": 1677956, "total_diff": 3355912, "diff_percentage": 0.2612687155363047, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:49:45.863730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.3343195266272189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:51:17.166745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7331746744985518, "overlap_percentage": 0.846048220397262, "num_intersection": 10157127, "num_union": 13853625, "num_only_computed": 1848249, "num_only_roped": 1848249, "total_diff": 3696498, "diff_percentage": 0.26682532550144816, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:51:20.308742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.363059997558594e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.3743718592964824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:53:01.871661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7389340076405815, "overlap_percentage": 0.8498700978804608, "num_intersection": 10916629, "num_union": 14773483, "num_only_computed": 1928427, "num_only_roped": 1928427, "total_diff": 3856854, "diff_percentage": 0.2610659923594186, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:53:05.239927", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.24879227053140096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:54:51.063593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7146687048033394, "overlap_percentage": 0.8335939214395436, "num_intersection": 4740762, "num_union": 6633510, "num_only_computed": 946374, "num_only_roped": 946374, "total_diff": 1892748, "diff_percentage": 0.2853312951966606, "num_computed": 5687136, "num_roped": 5687136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 441, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:54:54.427575", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.3253424657534247}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 441, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:56:35.999423", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.704857444561774, "overlap_percentage": 0.8268813874264478, "num_intersection": 256320, "num_union": 363648, "num_only_computed": 53664, "num_only_roped": 53664, "total_diff": 107328, "diff_percentage": 0.295142555438226, "num_computed": 309984, "num_roped": 309984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:56:41.700566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.12890625, "l2_diff_relative": 0.1}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:58:17.056643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7086916258764386, "overlap_percentage": 0.8295137813564571, "num_intersection": 10714, "num_union": 15118, "num_only_computed": 2202, "num_only_roped": 2202, "total_diff": 4404, "diff_percentage": 0.2913083741235613, "num_computed": 12916, "num_roped": 12916}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:58:19.979451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00537109375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.01422119140625, "l2_diff_relative": 0.060175619834710745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:59:50.326767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7139255622636502, "overlap_percentage": 0.8330881783695905, "num_intersection": 10761, "num_union": 15073, "num_only_computed": 2156, "num_only_roped": 2156, "total_diff": 4312, "diff_percentage": 0.2860744377363498, "num_computed": 12917, "num_roped": 12917}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T20:59:53.254501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00946044921875, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.0242919921875, "l2_diff_relative": 0.10364583333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:01:24.493917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7048963969908935, "overlap_percentage": 0.82690819012231, "num_intersection": 10682, "num_union": 15154, "num_only_computed": 2236, "num_only_roped": 2236, "total_diff": 4472, "diff_percentage": 0.2951036030091065, "num_computed": 12918, "num_roped": 12918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:01:27.441585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.01544189453125, "l2_diff_relative": 0.053784013605442174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:02:58.309971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7040163556024533, "overlap_percentage": 0.8263023453827696, "num_intersection": 10675, "num_union": 15163, "num_only_computed": 2244, "num_only_roped": 2244, "total_diff": 4488, "diff_percentage": 0.29598364439754665, "num_computed": 12919, "num_roped": 12919}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "mask_shape": [1, 32, 1, 15829], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:03:01.262406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.19977678571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "attention_shape": [1, 32, 1, 15829]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:04:33.080045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7022397891963109, "overlap_percentage": 0.8250773993808049, "num_intersection": 10660, "num_union": 15180, "num_only_computed": 2260, "num_only_roped": 2260, "total_diff": 4520, "diff_percentage": 0.2977602108036891, "num_computed": 12920, "num_roped": 12920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "mask_shape": [1, 32, 1, 15830], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:04:36.030138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.4185905456542969e-05, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.10026041666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "attention_shape": [1, 32, 1, 15830]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:25.580865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:26.244311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030967310855263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:32.241737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916479249799251, "overlap_percentage": 0.9427208025398147, "num_intersection": 1738890, "num_union": 1950198, "num_only_computed": 200566, "num_only_roped": 10742, "total_diff": 211308, "diff_percentage": 0.10835207502007488, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:32.632671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.3478946685791016e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014539930555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:44.967809", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9179647042099064, "overlap_percentage": 0.9572279429282368, "num_intersection": 361612, "num_union": 393928, "num_only_computed": 16158, "num_only_roped": 16158, "total_diff": 32316, "diff_percentage": 0.08203529579009362, "num_computed": 377770, "num_roped": 377770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:45.374550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 7.68899917602539e-06, "l2_diff": 0.06689453125, "l2_diff_relative": 0.02009976525821596}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:57.487576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8589639566542255, "overlap_percentage": 0.9241319107662463, "num_intersection": 47639, "num_union": 55461, "num_only_computed": 3911, "num_only_roped": 3911, "total_diff": 7822, "diff_percentage": 0.14103604334577452, "num_computed": 51550, "num_roped": 51550}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:05:57.878081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.01556396484375, "l2_diff_relative": 0.012222009202453988}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:09.761892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8419642857142857, "overlap_percentage": 0.9142026175472613, "num_intersection": 1886, "num_union": 2240, "num_only_computed": 177, "num_only_roped": 177, "total_diff": 354, "diff_percentage": 0.15803571428571428, "num_computed": 2063, "num_roped": 2063}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:10.143955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.4836273193359375e-06, "l2_diff": 0.003265380859375, "l2_diff_relative": 0.012762404580152672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:21.890859", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8469798657718121, "overlap_percentage": 0.9171511627906976, "num_intersection": 1893, "num_union": 2235, "num_only_computed": 171, "num_only_roped": 171, "total_diff": 342, "diff_percentage": 0.15302013422818792, "num_computed": 2064, "num_roped": 2064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:22.262954", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.0040283203125, "l2_diff_relative": 0.018497757847533634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:34.022308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8453285650424676, "overlap_percentage": 0.9161821705426356, "num_intersection": 1891, "num_union": 2237, "num_only_computed": 173, "num_only_roped": 173, "total_diff": 346, "diff_percentage": 0.1546714349575324, "num_computed": 2064, "num_roped": 2064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "mask_shape": [1, 32, 1, 2261], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:35.779800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00146484375, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.003021240234375, "l2_diff_relative": 0.01345108695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "attention_shape": [1, 32, 1, 2261]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:47.517801", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8453976764968723, "overlap_percentage": 0.9162227602905569, "num_intersection": 1892, "num_union": 2238, "num_only_computed": 173, "num_only_roped": 173, "total_diff": 346, "diff_percentage": 0.1546023235031278, "num_computed": 2065, "num_roped": 2065}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "mask_shape": [1, 32, 1, 2262], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:50.294670", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.632638931274414e-06, "l2_diff": 0.0028228759765625, "l2_diff_relative": 0.011032919847328244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "attention_shape": [1, 32, 1, 2262]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:59.582640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:06:59.595338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031105324074074073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:05.533507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915974875016024, "overlap_percentage": 0.9426926112903785, "num_intersection": 1738838, "num_union": 1950250, "num_only_computed": 200618, "num_only_roped": 10794, "total_diff": 211412, "diff_percentage": 0.10840251249839764, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:05.922530", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.67572021484375e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015848214285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:20.847781", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9111532137639936, "overlap_percentage": 0.9535114267154836, "num_intersection": 2583482, "num_union": 2835398, "num_only_computed": 194630, "num_only_roped": 57286, "total_diff": 251916, "diff_percentage": 0.08884678623600638, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:21.404083", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.014865451388888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:42.694582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9040900793926662, "overlap_percentage": 0.9496295255958029, "num_intersection": 3394295, "num_union": 3754377, "num_only_computed": 222473, "num_only_roped": 137609, "total_diff": 360082, "diff_percentage": 0.09590992060733379, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:07:45.446015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.5730342864990234e-06, "l2_diff": 0.251953125, "l2_diff_relative": 0.0274234693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:12.708706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8860982424959667, "overlap_percentage": 0.9396098490854318, "num_intersection": 4171988, "num_union": 4708268, "num_only_computed": 284460, "num_only_roped": 251820, "total_diff": 536280, "diff_percentage": 0.11390175750403334, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:14.722322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.017899525316455698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:47.514356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8596134845573306, "overlap_percentage": 0.9245076911904155, "num_intersection": 4894775, "num_union": 5694158, "num_only_computed": 400329, "num_only_roped": 399054, "total_diff": 799383, "diff_percentage": 0.14038651544266947, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:08:48.640996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.4586915969848633e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.01357421875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:29.438263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8305346256605693, "overlap_percentage": 0.9074230162249582, "num_intersection": 5565915, "num_union": 6701605, "num_only_computed": 567845, "num_only_roped": 567845, "total_diff": 1135690, "diff_percentage": 0.16946537433943062, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:09:30.750167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.177734375, "l2_diff_relative": 0.018586601307189542}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:16.429281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8062289939966935, "overlap_percentage": 0.8927206867748568, "num_intersection": 6224420, "num_union": 7720412, "num_only_computed": 747996, "num_only_roped": 747996, "total_diff": 1495992, "diff_percentage": 0.19377100600330657, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:10:19.475346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.017299107142857144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:12.471445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7873875127270955, "overlap_percentage": 0.8810484655627294, "num_intersection": 6881933, "num_union": 8740211, "num_only_computed": 929139, "num_only_roped": 929139, "total_diff": 1858278, "diff_percentage": 0.21261248727290452, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:11:14.865408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.17116182572614108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:12:14.739272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7751653992266697, "overlap_percentage": 0.8733444213867188, "num_intersection": 7555086, "num_union": 9746418, "num_only_computed": 1095666, "num_only_roped": 1095666, "total_diff": 2191332, "diff_percentage": 0.22483460077333026, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:12:16.809314", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.532669067382812e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:13:24.334679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7648559367394512, "overlap_percentage": 0.8667630267346498, "num_intersection": 8225068, "num_union": 10753748, "num_only_computed": 1264340, "num_only_roped": 1264340, "total_diff": 2528680, "diff_percentage": 0.2351440632605488, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:13:26.622348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.4216589861751152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:14:40.314087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7454239858053731, "overlap_percentage": 0.8541466049137851, "num_intersection": 7267169, "num_union": 9749041, "num_only_computed": 1240936, "num_only_roped": 1240936, "total_diff": 2481872, "diff_percentage": 0.25457601419462694, "num_computed": 8508105, "num_roped": 8508105}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 855, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:14:43.882095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.009506225585938e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.6225806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 855, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:15:57.641242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7190668660576832, "overlap_percentage": 0.8365781229984511, "num_intersection": 359189, "num_union": 499521, "num_only_computed": 70166, "num_only_roped": 70166, "total_diff": 140332, "diff_percentage": 0.2809331339423167, "num_computed": 429355, "num_roped": 429355}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:16:00.051119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.3828125, "l2_diff_relative": 0.2737430167597765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:17:08.420572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7089073329340293, "overlap_percentage": 0.8296615261365913, "num_intersection": 8285, "num_union": 11687, "num_only_computed": 1701, "num_only_roped": 1701, "total_diff": 3402, "diff_percentage": 0.29109266706597076, "num_computed": 9986, "num_roped": 9986}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:17:10.552029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 5.364418029785156e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.42441860465116277}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:18:16.664136", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7164217581850992, "overlap_percentage": 0.8347852207870231, "num_intersection": 8337, "num_union": 11637, "num_only_computed": 1650, "num_only_roped": 1650, "total_diff": 3300, "diff_percentage": 0.28357824181490077, "num_computed": 9987, "num_roped": 9987}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:18:18.783731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.06640625, "l2_diff_relative": 0.34}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:19:24.896730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7080803762291578, "overlap_percentage": 0.829094913896676, "num_intersection": 8281, "num_union": 11695, "num_only_computed": 1707, "num_only_roped": 1707, "total_diff": 3414, "diff_percentage": 0.29191962377084224, "num_computed": 9988, "num_roped": 9988}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:19:27.029273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010009765625, "mean_diff": 1.3053417205810547e-05, "l2_diff": 0.020263671875, "l2_diff_relative": 0.06650641025641026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:03.345189", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:03.370351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.002972146739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:09.375330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915412334872236, "overlap_percentage": 0.9426611672044689, "num_intersection": 1738780, "num_union": 1950308, "num_only_computed": 200676, "num_only_roped": 10852, "total_diff": 211528, "diff_percentage": 0.10845876651277644, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:09.761354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.288290023803711e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.014762931034482759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:24.671011", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9116595470264904, "overlap_percentage": 0.9537886057635526, "num_intersection": 2584233, "num_union": 2834647, "num_only_computed": 193879, "num_only_roped": 56535, "total_diff": 250414, "diff_percentage": 0.08834045297350958, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:25.222073", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.015391791044776119}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:48.155672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9035911594118382, "overlap_percentage": 0.9493542297086788, "num_intersection": 3393311, "num_union": 3755361, "num_only_computed": 223457, "num_only_roped": 138593, "total_diff": 362050, "diff_percentage": 0.09640884058816183, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:20:48.892461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.2177734375, "l2_diff_relative": 0.02436625874125874}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:15.990469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8881519119006912, "overlap_percentage": 0.9407631942142208, "num_intersection": 4177109, "num_union": 4703147, "num_only_computed": 279339, "num_only_roped": 246699, "total_diff": 526038, "diff_percentage": 0.11184808809930882, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:16.922816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.017780172413793104}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:49.788657", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8616683248729358, "overlap_percentage": 0.9256947796345486, "num_intersection": 4901060, "num_union": 5687873, "num_only_computed": 394044, "num_only_roped": 392769, "total_diff": 786813, "diff_percentage": 0.1383316751270642, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:21:52.141509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.4586915969848633e-06, "l2_diff": 0.12060546875, "l2_diff_relative": 0.01368572695035461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:22:30.987498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8342098302721355, "overlap_percentage": 0.9096122117591819, "num_intersection": 5579343, "num_union": 6688177, "num_only_computed": 554417, "num_only_roped": 554417, "total_diff": 1108834, "diff_percentage": 0.16579016972786456, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:22:33.937325", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.01763392857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:23:19.248313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8139637738810005, "overlap_percentage": 0.8974421491775592, "num_intersection": 6257340, "num_union": 7687492, "num_only_computed": 715076, "num_only_roped": 715076, "total_diff": 1430152, "diff_percentage": 0.18603622611899953, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:23:20.784500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.3543834686279297e-06, "l2_diff": 0.125, "l2_diff_relative": 0.01639344262295082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:24:10.332491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7634577634054714, "overlap_percentage": 0.8658645296172368, "num_intersection": 3299582, "num_union": 4321892, "num_only_computed": 511155, "num_only_roped": 511155, "total_diff": 1022310, "diff_percentage": 0.2365422365945285, "num_computed": 3810737, "num_roped": 3810737}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 527, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:24:11.947408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.09913793103448276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 527, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:25:00.994203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7306041335453101, "overlap_percentage": 0.844334206053925, "num_intersection": 202202, "num_union": 276760, "num_only_computed": 37279, "num_only_roped": 37279, "total_diff": 74558, "diff_percentage": 0.26939586645469, "num_computed": 239481, "num_roped": 239481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:25:02.560946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.288818359375e-05, "l2_diff": 0.0927734375, "l2_diff_relative": 0.06944444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:25:49.654612", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7278895369598857, "overlap_percentage": 0.8425186001653348, "num_intersection": 6115, "num_union": 8401, "num_only_computed": 1143, "num_only_roped": 1143, "total_diff": 2286, "diff_percentage": 0.27211046304011427, "num_computed": 7258, "num_roped": 7258}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:25:51.118503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.01019287109375, "l2_diff_relative": 0.04638888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:26:36.263527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7397243858597963, "overlap_percentage": 0.8503926160628186, "num_intersection": 6173, "num_union": 8345, "num_only_computed": 1086, "num_only_roped": 1086, "total_diff": 2172, "diff_percentage": 0.2602756141402037, "num_computed": 7259, "num_roped": 7259}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:26:37.708069", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.009521484375, "l2_diff_relative": 0.045990566037735846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:27:23.107607", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7368421052631579, "overlap_percentage": 0.8484848484848485, "num_intersection": 6160, "num_union": 8360, "num_only_computed": 1100, "num_only_roped": 1100, "total_diff": 2200, "diff_percentage": 0.2631578947368421, "num_computed": 7260, "num_roped": 7260}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:27:26.190994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 1.245737075805664e-05, "l2_diff": 0.008056640625, "l2_diff_relative": 0.026785714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:27:54.096967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:27:54.110635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030565137987012985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:00.111346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8918002236876045, "overlap_percentage": 0.9428059184275355, "num_intersection": 1739047, "num_union": 1950041, "num_only_computed": 200409, "num_only_roped": 10585, "total_diff": 210994, "diff_percentage": 0.10819977631239548, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:00.515791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.014533547794117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:15.872398", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.911281288709682, "overlap_percentage": 0.9535815519074052, "num_intersection": 2583672, "num_union": 2835208, "num_only_computed": 194440, "num_only_roped": 57096, "total_diff": 251536, "diff_percentage": 0.08871871129031803, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:16.443822", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.01528033088235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:37.662569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9041712293135958, "overlap_percentage": 0.949674289154685, "num_intersection": 3394455, "num_union": 3754217, "num_only_computed": 222313, "num_only_roped": 137449, "total_diff": 359762, "diff_percentage": 0.09582877068640412, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:28:38.433141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.2021484375, "l2_diff_relative": 0.023958333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:29:05.827558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8841385777922055, "overlap_percentage": 0.9385069529527077, "num_intersection": 4167091, "num_union": 4713165, "num_only_computed": 289357, "num_only_roped": 256717, "total_diff": 546074, "diff_percentage": 0.11586142220779455, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:29:06.781279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.4570693969726562e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.018345141700404858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:29:40.721559", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8568706490004768, "overlap_percentage": 0.9229190514285056, "num_intersection": 4886364, "num_union": 5702569, "num_only_computed": 408740, "num_only_roped": 407465, "total_diff": 816205, "diff_percentage": 0.1431293509995232, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:29:43.491891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.11279296875, "l2_diff_relative": 0.013671875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:30:22.675252", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8281046471409861, "overlap_percentage": 0.9059707259494991, "num_intersection": 5557007, "num_union": 6710513, "num_only_computed": 576753, "num_only_roped": 576753, "total_diff": 1153506, "diff_percentage": 0.17189535285901392, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:30:26.454783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.01951581027667984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:31:11.554790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.806371483831906, "overlap_percentage": 0.8928080309608606, "num_intersection": 6225029, "num_union": 7719803, "num_only_computed": 747387, "num_only_roped": 747387, "total_diff": 1494774, "diff_percentage": 0.19362851616809393, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:31:13.081781", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017075892857142855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:32:05.138346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7880691720693397, "overlap_percentage": 0.8814750395336262, "num_intersection": 6885265, "num_union": 8736879, "num_only_computed": 925807, "num_only_roped": 925807, "total_diff": 1851614, "diff_percentage": 0.21193082793066037, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:32:06.882641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.4557113647460938e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.13654618473895583}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:33:05.961538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7708806550665301, "overlap_percentage": 0.8706184156013258, "num_intersection": 7531504, "num_union": 9770000, "num_only_computed": 1119248, "num_only_roped": 1119248, "total_diff": 2238496, "diff_percentage": 0.2291193449334698, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:33:07.985143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.125, "l2_diff_relative": 0.3177570093457944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:34:16.872905", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7577801907856934, "overlap_percentage": 0.8622013090806087, "num_intersection": 8181780, "num_union": 10797036, "num_only_computed": 1307628, "num_only_roped": 1307628, "total_diff": 2615256, "diff_percentage": 0.24221980921430658, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:34:21.180322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.8125, "l2_diff_relative": 0.24786324786324787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:35:36.127392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7511653239538281, "overlap_percentage": 0.8579033786002875, "num_intersection": 8860481, "num_union": 11795647, "num_only_computed": 1467583, "num_only_roped": 1467583, "total_diff": 2935166, "diff_percentage": 0.24883467604617196, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:35:38.705633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.3788659793814433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:37:02.318083", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7424453845455871, "overlap_percentage": 0.8521878402968822, "num_intersection": 9516143, "num_union": 12817297, "num_only_computed": 1650577, "num_only_roped": 1650577, "total_diff": 3301154, "diff_percentage": 0.2575546154544129, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:37:05.176002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.3972972972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:38:37.012937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7336391932570262, "overlap_percentage": 0.8463574152113187, "num_intersection": 10160839, "num_union": 13849913, "num_only_computed": 1844537, "num_only_roped": 1844537, "total_diff": 3689074, "diff_percentage": 0.26636080674297374, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:38:40.100957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.4067357512953368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:40:22.146145", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7300804729719037, "overlap_percentage": 0.8439844092544244, "num_intersection": 10841027, "num_union": 14849085, "num_only_computed": 2004029, "num_only_roped": 2004029, "total_diff": 4008058, "diff_percentage": 0.26991952702809635, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:40:26.097578", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.3056872037914692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:42:14.491965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7219943019985562, "overlap_percentage": 0.838555971016403, "num_intersection": 9670261, "num_union": 13393819, "num_only_computed": 1861779, "num_only_roped": 1861779, "total_diff": 3723558, "diff_percentage": 0.2780056980014438, "num_computed": 11532040, "num_roped": 11532040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 871, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:42:18.054846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 4.029273986816406e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.43157894736842106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 871, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:44:04.918524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6882428669800306, "overlap_percentage": 0.8153363244604445, "num_intersection": 367808, "num_union": 534416, "num_only_computed": 83304, "num_only_roped": 83304, "total_diff": 166608, "diff_percentage": 0.31175713301996943, "num_computed": 451112, "num_roped": 451112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:44:08.665567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.25, "l2_diff_relative": 0.1871345029239766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:45:46.711425", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6854674796747967, "overlap_percentage": 0.8133855893880012, "num_intersection": 10792, "num_union": 15744, "num_only_computed": 2476, "num_only_roped": 2476, "total_diff": 4952, "diff_percentage": 0.31453252032520324, "num_computed": 13268, "num_roped": 13268}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:45:49.934051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.019287109375, "l2_diff_relative": 0.07995951417004049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:47:24.328044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6776028826095202, "overlap_percentage": 0.8078227447433869, "num_intersection": 10719, "num_union": 15819, "num_only_computed": 2550, "num_only_roped": 2550, "total_diff": 5100, "diff_percentage": 0.3223971173904798, "num_computed": 13269, "num_roped": 13269}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:47:27.427489", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009033203125, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.0191650390625, "l2_diff_relative": 0.1016839378238342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:49:02.439671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6932499681000382, "overlap_percentage": 0.8188394875659382, "num_intersection": 10866, "num_union": 15674, "num_only_computed": 2404, "num_only_roped": 2404, "total_diff": 4808, "diff_percentage": 0.3067500318999617, "num_computed": 13270, "num_roped": 13270}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:49:05.544612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.5079975128173828e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.11935483870967742}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:50:39.735429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6947832194623588, "overlap_percentage": 0.8199080702283174, "num_intersection": 10881, "num_union": 15661, "num_only_computed": 2390, "num_only_roped": 2390, "total_diff": 4780, "diff_percentage": 0.3052167805376413, "num_computed": 13271, "num_roped": 13271}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:50:42.823867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023681640625, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.17261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:17.654367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6841570966309244, "overlap_percentage": 0.812462326702833, "num_intersection": 10783, "num_union": 15761, "num_only_computed": 2489, "num_only_roped": 2489, "total_diff": 4978, "diff_percentage": 0.31584290336907556, "num_computed": 13272, "num_roped": 13272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:52:20.729619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00830078125, "mean_diff": 2.86102294921875e-05, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.12002487562189054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:55.493460", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6809575074409474, "overlap_percentage": 0.810201928872815, "num_intersection": 10753, "num_union": 15791, "num_only_computed": 2519, "num_only_roped": 2519, "total_diff": 5038, "diff_percentage": 0.31904249255905265, "num_computed": 13272, "num_roped": 13272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:53:58.587708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 3.0040740966796875e-05, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.13477653631284917}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:34.801303", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6944976381973701, "overlap_percentage": 0.8197091840578619, "num_intersection": 10880, "num_union": 15666, "num_only_computed": 2393, "num_only_roped": 2393, "total_diff": 4786, "diff_percentage": 0.3055023618026299, "num_computed": 13273, "num_roped": 13273}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:55:38.032295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.3768672943115234e-05, "l2_diff": 0.0244140625, "l2_diff_relative": 0.09328358208955224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:31.986661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:31.999352", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0029829545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:37.967263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8917924626509385, "overlap_percentage": 0.9428015813122376, "num_intersection": 1739039, "num_union": 1950049, "num_only_computed": 200417, "num_only_roped": 10593, "total_diff": 211010, "diff_percentage": 0.10820753734906148, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:38.347835", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.016036184210526317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:53.296604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9118281595697427, "overlap_percentage": 0.9538808757529231, "num_intersection": 2584483, "num_union": 2834397, "num_only_computed": 193629, "num_only_roped": 56285, "total_diff": 249914, "diff_percentage": 0.0881718404302573, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:56:53.850491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.678964614868164e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.014213709677419355}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:15.623615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9037893778112741, "overlap_percentage": 0.9494636206556966, "num_intersection": 3393702, "num_union": 3754970, "num_only_computed": 223066, "num_only_roped": 138202, "total_diff": 361268, "diff_percentage": 0.09621062218872588, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:18.791253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.220703125, "l2_diff_relative": 0.024867957746478875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:46.457743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8861122633480544, "overlap_percentage": 0.9396177317410669, "num_intersection": 4172023, "num_union": 4708233, "num_only_computed": 284425, "num_only_roped": 251785, "total_diff": 536210, "diff_percentage": 0.11388773665194564, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:57:48.046795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.017658390410958905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:20.961287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8593493166861195, "overlap_percentage": 0.9243548901480442, "num_intersection": 4893966, "num_union": 5694967, "num_only_computed": 401138, "num_only_roped": 399863, "total_diff": 801001, "diff_percentage": 0.14065068331388048, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:58:22.084241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.592802047729492e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.01552013422818792}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:02.252501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8279872399471669, "overlap_percentage": 0.9059004590984975, "num_intersection": 5556576, "num_union": 6710944, "num_only_computed": 577184, "num_only_roped": 577184, "total_diff": 1154368, "diff_percentage": 0.1720127600528331, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:03.587302", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.019639328063241108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:49.743811", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8048100027929916, "overlap_percentage": 0.8918501133609928, "num_intersection": 6218350, "num_union": 7726482, "num_only_computed": 754066, "num_only_roped": 754066, "total_diff": 1508132, "diff_percentage": 0.1951899972070083, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T21:59:53.235968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.3543834686279297e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.01760204081632653}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:46.678901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7866007323828976, "overlap_percentage": 0.8805557034937074, "num_intersection": 6878084, "num_union": 8744060, "num_only_computed": 932988, "num_only_roped": 932988, "total_diff": 1865976, "diff_percentage": 0.21339926761710235, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:00:48.799431", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.20484581497797358}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:48.576398", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.774656295369042, "overlap_percentage": 0.8730212124911222, "num_intersection": 7552290, "num_union": 9749214, "num_only_computed": 1098462, "num_only_roped": 1098462, "total_diff": 2196924, "diff_percentage": 0.22534370463095793, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:01:50.640588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.953125, "l2_diff_relative": 0.48711340206185566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:02:58.219837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7642799155435414, "overlap_percentage": 0.8663930352662674, "num_intersection": 8221557, "num_union": 10757259, "num_only_computed": 1267851, "num_only_roped": 1267851, "total_diff": 2535702, "diff_percentage": 0.23572008445645865, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:03:00.547492", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.982948303222656e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.4272300469483568}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:04:17.903926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7578283125701646, "overlap_percentage": 0.8622324571187785, "num_intersection": 8905192, "num_union": 11750936, "num_only_computed": 1422872, "num_only_roped": 1422872, "total_diff": 2845744, "diff_percentage": 0.24217168742983539, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:04:20.667930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.4052132701421801}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:05:44.134690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7514975624760117, "overlap_percentage": 0.8581200209193031, "num_intersection": 9582386, "num_union": 12751054, "num_only_computed": 1584334, "num_only_roped": 1584334, "total_diff": 3168668, "diff_percentage": 0.2485024375239882, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:05:47.007535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.39502762430939226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:07:20.673833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7421348268545627, "overlap_percentage": 0.8519832281804418, "num_intersection": 10228379, "num_union": 13782373, "num_only_computed": 1776997, "num_only_roped": 1776997, "total_diff": 3553994, "diff_percentage": 0.2578651731454373, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:07:23.750227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.4256410256410256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:09:05.663621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7311950348815073, "overlap_percentage": 0.8447286644760443, "num_intersection": 10850587, "num_union": 14839525, "num_only_computed": 1994469, "num_only_roped": 1994469, "total_diff": 3988938, "diff_percentage": 0.26880496511849267, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:09:09.936581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.45108695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:10:53.572232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7036831539431757, "overlap_percentage": 0.8260727968278616, "num_intersection": 5324135, "num_union": 7566097, "num_only_computed": 1120981, "num_only_roped": 1120981, "total_diff": 2241962, "diff_percentage": 0.2963168460568243, "num_computed": 6445116, "num_roped": 6445116}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 498, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:10:57.845089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.3476027397260274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 498, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:12:42.530933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6834896754278179, "overlap_percentage": 0.811991526178057, "num_intersection": 273672, "num_union": 400404, "num_only_computed": 63366, "num_only_roped": 63366, "total_diff": 126732, "diff_percentage": 0.3165103245721821, "num_computed": 337038, "num_roped": 337038}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:12:45.770348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.130859375, "l2_diff_relative": 0.11394557823129252}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:14:21.440637", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6796009587355056, "overlap_percentage": 0.8092409750077136, "num_intersection": 10491, "num_union": 15437, "num_only_computed": 2473, "num_only_roped": 2473, "total_diff": 4946, "diff_percentage": 0.3203990412644944, "num_computed": 12964, "num_roped": 12964}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:14:25.526357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.11039719626168225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:15:57.558739", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6809076175040518, "overlap_percentage": 0.8101666152422092, "num_intersection": 10503, "num_union": 15425, "num_only_computed": 2461, "num_only_roped": 2461, "total_diff": 4922, "diff_percentage": 0.3190923824959481, "num_computed": 12964, "num_roped": 12964}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 1, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:16:01.444105", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.15092165898617513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 1, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:16:54.689411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:16:54.704175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.002877058383233533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:00.610735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891449100519226, "overlap_percentage": 0.9426096639603068, "num_intersection": 1738685, "num_union": 1950403, "num_only_computed": 200771, "num_only_roped": 10947, "total_diff": 211718, "diff_percentage": 0.10855089948077397, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:00.995812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.014547413793103448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:15.826369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9116750581382222, "overlap_percentage": 0.9537970946025747, "num_intersection": 2584256, "num_union": 2834624, "num_only_computed": 193856, "num_only_roped": 56512, "total_diff": 250368, "diff_percentage": 0.08832494186177779, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:16.373817", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.014930555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:37.630603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9067757527228615, "overlap_percentage": 0.9511089612168526, "num_intersection": 3399583, "num_union": 3749089, "num_only_computed": 217185, "num_only_roped": 132321, "total_diff": 349506, "diff_percentage": 0.09322424727713853, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:17:40.884053", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.2080078125, "l2_diff_relative": 0.024652777777777777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:18:08.100950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8895444180147546, "overlap_percentage": 0.9415438023408335, "num_intersection": 4180575, "num_union": 4699681, "num_only_computed": 275873, "num_only_roped": 243233, "total_diff": 519106, "diff_percentage": 0.11045558198524538, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:18:09.561455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.017423561151079136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:18:42.093767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8633813766971853, "overlap_percentage": 0.9266824145548942, "num_intersection": 4906289, "num_union": 5682644, "num_only_computed": 388815, "num_only_roped": 387540, "total_diff": 776355, "diff_percentage": 0.13661862330281468, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:18:43.212301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.014973958333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:19:22.149228", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8358507431460811, "overlap_percentage": 0.9105868178735392, "num_intersection": 5585321, "num_union": 6682199, "num_only_computed": 548439, "num_only_roped": 548439, "total_diff": 1096878, "diff_percentage": 0.1641492568539189, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:19:23.467284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.592802047729492e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.018138111888111888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:20:09.875689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8102187658533977, "overlap_percentage": 0.8951611607798502, "num_intersection": 6241436, "num_union": 7703396, "num_only_computed": 730980, "num_only_roped": 730980, "total_diff": 1461960, "diff_percentage": 0.18978123414660236, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:20:11.407571", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.115964889526367e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:21:05.275419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7892721399197458, "overlap_percentage": 0.8822270489889223, "num_intersection": 6891139, "num_union": 8731005, "num_only_computed": 919933, "num_only_roped": 919933, "total_diff": 1839866, "diff_percentage": 0.2107278600802542, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:21:07.020713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 2.5153160095214844e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:22:08.583420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7709692941642626, "overlap_percentage": 0.8706749424789891, "num_intersection": 7531993, "num_union": 9769511, "num_only_computed": 1118759, "num_only_roped": 1118759, "total_diff": 2237518, "diff_percentage": 0.2290307058357373, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:22:10.650402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.27209302325581397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:23:18.537317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7642033269856473, "overlap_percentage": 0.8663438225018885, "num_intersection": 8221090, "num_union": 10757726, "num_only_computed": 1268318, "num_only_roped": 1268318, "total_diff": 2536636, "diff_percentage": 0.23579667301435267, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:23:20.866353", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.602836608886719e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.4673913043478261}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:24:36.755516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7586870821590236, "overlap_percentage": 0.8627880307480666, "num_intersection": 8910930, "num_union": 11745198, "num_only_computed": 1417134, "num_only_roped": 1417134, "total_diff": 2834268, "diff_percentage": 0.24131291784097636, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:24:40.548556", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 5.078315734863281e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.41089108910891087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:26:03.904996", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7454014817137374, "overlap_percentage": 0.8541318310121504, "num_intersection": 9537851, "num_union": 12795589, "num_only_computed": 1628869, "num_only_roped": 1628869, "total_diff": 3257738, "diff_percentage": 0.25459851828626257, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:26:06.757122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.294921875, "mean_diff": 5.4836273193359375e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.478494623655914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:27:37.594125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7378512189728904, "overlap_percentage": 0.8491534959005033, "num_intersection": 10194407, "num_union": 13816345, "num_only_computed": 1810969, "num_only_roped": 1810969, "total_diff": 3621938, "diff_percentage": 0.26214878102710953, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:27:41.083832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 4.3392181396484375e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.39572192513368987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:29:19.515444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7323540214882441, "overlap_percentage": 0.8455015688526387, "num_intersection": 10860515, "num_union": 14829597, "num_only_computed": 1984541, "num_only_roped": 1984541, "total_diff": 3969082, "diff_percentage": 0.2676459785117559, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:29:22.820975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.076957702636719e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.3961352657004831}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:31:01.782312", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6954178742771135, "overlap_percentage": 0.8203498203339674, "num_intersection": 931458, "num_union": 1339422, "num_only_computed": 203982, "num_only_roped": 203982, "total_diff": 407964, "diff_percentage": 0.30458212572288645, "num_computed": 1135440, "num_roped": 1135440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:31:05.796437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 4.57763671875e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.31203007518796994}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:32:42.306685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6931355749727229, "overlap_percentage": 0.8187596849518558, "num_intersection": 383069, "num_union": 552661, "num_only_computed": 84796, "num_only_roped": 84796, "total_diff": 169592, "diff_percentage": 0.3068644250272771, "num_computed": 467865, "num_roped": 467865}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:32:46.399632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.22265625, "l2_diff_relative": 0.17484662576687116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:34:18.481912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6881591242824723, "overlap_percentage": 0.815277558121145, "num_intersection": 10310, "num_union": 14982, "num_only_computed": 2336, "num_only_roped": 2336, "total_diff": 4672, "diff_percentage": 0.3118408757175277, "num_computed": 12646, "num_roped": 12646}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:34:22.839261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.28104575163398693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:35:51.150553", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6896459585838344, "overlap_percentage": 0.8163200759073298, "num_intersection": 10324, "num_union": 14970, "num_only_computed": 2323, "num_only_roped": 2323, "total_diff": 4646, "diff_percentage": 0.3103540414161657, "num_computed": 12647, "num_roped": 12647}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:35:54.038663", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.14130434782608695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:37:23.800327", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6898924443850625, "overlap_percentage": 0.8164927261227072, "num_intersection": 10327, "num_union": 14969, "num_only_computed": 2321, "num_only_roped": 2321, "total_diff": 4642, "diff_percentage": 0.3101075556149375, "num_computed": 12648, "num_roped": 12648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-12T22:37:26.683084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.011962890625, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.02587890625, "l2_diff_relative": 0.09137931034482759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
